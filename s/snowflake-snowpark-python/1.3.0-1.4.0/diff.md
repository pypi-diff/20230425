# Comparing `tmp/snowflake-snowpark-python-1.3.0.tar.gz` & `tmp/snowflake-snowpark-python-1.4.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "snowflake-snowpark-python-1.3.0.tar", last modified: Wed Mar 29 01:00:35 2023, max compression
+gzip compressed data, was "snowflake-snowpark-python-1.4.0.tar", last modified: Mon Apr 24 22:22:29 2023, max compression
```

## Comparing `snowflake-snowpark-python-1.3.0.tar` & `snowflake-snowpark-python-1.4.0.tar`

### file list

```diff
@@ -1,73 +1,73 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.870896 snowflake-snowpark-python-1.3.0/
--rw-r--r--   0 runner    (1001) docker     (123)    27683 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/CHANGELOG.md
--rw-r--r--   0 runner    (1001) docker     (123)    11365 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/LICENSE.txt
--rw-r--r--   0 runner    (1001) docker     (123)      242 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)    34236 2023-03-29 01:00:35.870896 snowflake-snowpark-python-1.3.0/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     4772 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/README.md
--rw-r--r--   0 runner    (1001) docker     (123)       38 2023-03-29 01:00:35.870896 snowflake-snowpark-python-1.3.0/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     3864 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.862896 snowflake-snowpark-python-1.3.0/src/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.862896 snowflake-snowpark-python-1.3.0/src/snowflake/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.866896 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/
--rw-r--r--   0 runner    (1001) docker     (123)     1838 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.866896 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/
--rw-r--r--   0 runner    (1001) docker     (123)       76 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.870896 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/
--rw-r--r--   0 runner    (1001) docker     (123)       76 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    28143 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py
--rw-r--r--   0 runner    (1001) docker     (123)    34669 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     2053 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3742 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     6322 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py
--rw-r--r--   0 runner    (1001) docker     (123)    11178 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/expression.py
--rw-r--r--   0 runner    (1001) docker     (123)      986 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py
--rw-r--r--   0 runner    (1001) docker     (123)     3485 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    38778 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py
--rw-r--r--   0 runner    (1001) docker     (123)    37306 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py
--rw-r--r--   0 runner    (1001) docker     (123)     4548 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     1198 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3418 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/table_function.py
--rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     2112 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     2855 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     2970 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)    26725 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/code_generation.py
--rw-r--r--   0 runner    (1001) docker     (123)    15385 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/error_message.py
--rw-r--r--   0 runner    (1001) docker     (123)    24602 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/server_connection.py
--rw-r--r--   0 runner    (1001) docker     (123)    11337 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/telemetry.py
--rw-r--r--   0 runner    (1001) docker     (123)    20932 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/type_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    26869 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/udf_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    22628 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    15640 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/async_job.py
--rw-r--r--   0 runner    (1001) docker     (123)    32954 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/column.py
--rw-r--r--   0 runner    (1001) docker     (123)      550 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/context.py
--rw-r--r--   0 runner    (1001) docker     (123)   143470 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    23447 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_na_functions.py
--rw-r--r--   0 runner    (1001) docker     (123)    25795 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_reader.py
--rw-r--r--   0 runner    (1001) docker     (123)    11120 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_stat_functions.py
--rw-r--r--   0 runner    (1001) docker     (123)    14707 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_writer.py
--rw-r--r--   0 runner    (1001) docker     (123)     6164 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/exceptions.py
--rw-r--r--   0 runner    (1001) docker     (123)    17528 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/file_operation.py
--rw-r--r--   0 runner    (1001) docker     (123)     6169 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/files.py
--rw-r--r--   0 runner    (1001) docker     (123)   228593 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/functions.py
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/py.typed
--rw-r--r--   0 runner    (1001) docker     (123)     1023 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/query_history.py
--rw-r--r--   0 runner    (1001) docker     (123)    12582 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/relational_grouped_dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    12072 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/row.py
--rw-r--r--   0 runner    (1001) docker     (123)    88176 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/session.py
--rw-r--r--   0 runner    (1001) docker     (123)    36586 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/stored_procedure.py
--rw-r--r--   0 runner    (1001) docker     (123)    29410 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/table.py
--rw-r--r--   0 runner    (1001) docker     (123)     9647 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/table_function.py
--rw-r--r--   0 runner    (1001) docker     (123)    10501 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/types.py
--rw-r--r--   0 runner    (1001) docker     (123)    45212 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/udf.py
--rw-r--r--   0 runner    (1001) docker     (123)    35142 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/udtf.py
--rw-r--r--   0 runner    (1001) docker     (123)      151 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/version.py
--rw-r--r--   0 runner    (1001) docker     (123)     9474 2023-03-29 01:00:21.000000 snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/window.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-03-29 01:00:35.870896 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)    34236 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     2876 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       10 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/namespace_packages.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (123)      341 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)       10 2023-03-29 01:00:35.000000 snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/
+-rw-r--r--   0 runner    (1001) docker     (123)    29338 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/CHANGELOG.md
+-rw-r--r--   0 runner    (1001) docker     (123)    11365 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      242 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)    35891 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     4772 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)       38 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     3864 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.108605 snowflake-snowpark-python-1.4.0/src/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.108605 snowflake-snowpark-python-1.4.0/src/snowflake/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.116605 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/
+-rw-r--r--   0 runner    (1001) docker     (123)     1838 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.116605 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/
+-rw-r--r--   0 runner    (1001) docker     (123)       76 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/
+-rw-r--r--   0 runner    (1001) docker     (123)       76 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28487 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35117 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2053 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3742 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6322 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11178 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)      986 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3485 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    41037 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39377 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4599 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1198 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3418 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2112 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3152 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2970 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26725 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/code_generation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16036 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/error_message.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26038 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/server_connection.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11337 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/telemetry.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20932 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/type_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27070 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/udf_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23650 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16167 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/async_job.py
+-rw-r--r--   0 runner    (1001) docker     (123)    32981 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/column.py
+-rw-r--r--   0 runner    (1001) docker     (123)      550 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/context.py
+-rw-r--r--   0 runner    (1001) docker     (123)   147089 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23447 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_na_functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25795 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_reader.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11120 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_stat_functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14434 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_writer.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6357 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/exceptions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17528 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/file_operation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6169 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/files.py
+-rw-r--r--   0 runner    (1001) docker     (123)   262369 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/py.typed
+-rw-r--r--   0 runner    (1001) docker     (123)     1023 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/query_history.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12582 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/relational_grouped_dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12072 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/row.py
+-rw-r--r--   0 runner    (1001) docker     (123)    89764 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/session.py
+-rw-r--r--   0 runner    (1001) docker     (123)    37131 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/stored_procedure.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29569 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11516 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10501 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/types.py
+-rw-r--r--   0 runner    (1001) docker     (123)    45757 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udf.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35687 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udtf.py
+-rw-r--r--   0 runner    (1001) docker     (123)      151 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/version.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9474 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/window.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)    35891 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     2876 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       10 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/namespace_packages.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-24 22:22:28.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (123)      341 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       10 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/top_level.txt
```

### Comparing `snowflake-snowpark-python-1.3.0/CHANGELOG.md` & `snowflake-snowpark-python-1.4.0/CHANGELOG.md`

 * *Files 2% similar despite different names*

```diff
@@ -1,15 +1,44 @@
 # Release History
 
+## 1.4.0 (2023-04-24)
+
+### New Features
+
+- Added support for `session.getOrCreate`.
+- Added support for alias `Column.getField`.
+- Added support for new functions in `snowflake.snowpark.functions`:
+  - `date_add` and `date_sub` to make add and subtract operations easier.
+  - `daydiff`
+  - `explode`
+  - `array_distinct`.
+  - `regexp_extract`.
+  - `struct`.
+  - `format_number`.
+  - `bround`.
+  - `substring_index`
+- Added parameter `skip_upload_on_content_match` when creating UDFs, UDTFs and stored procedures using `register_from_file` to skip uploading files to a stage if the same version of the files are already on the stage.
+- Added support for `DataFrame.save_as_table` method to take table names that contain dots.
+- Flattened generated SQL when `DataFrame.filter()` or `DataFrame.order_by()` is followed by a projection statement (e.g. `DataFrame.select()`, `DataFrame.with_column()`).
+- Added support for creating dynamic tables _(in private preview)_ using `Dataframe.create_or_replace_dynamic_table`.
+- Added an optional argument `params` in `session.sql()` to support binding variables. Note that this is not supported in stored procedures yet.
+
+### Bug Fixes
+
+- Fixed a bug in `strtok_to_array` where an exception was thrown when a delimiter was passed in.
+- Fixed a bug in `session.add_import` where the module had the same namespace as other dependencies.
+
 ## 1.3.0 (2023-03-28)
 
 ### New Features
 
 - Added support for `delimiters` parameter in `functions.initcap()`.
 - Added support for `functions.hash()` to accept a variable number of input expressions.
+- Added API `Session.RuntimeConfig` for getting/setting/checking the mutability of any runtime configuration.
+- Added support managing case sensitivity in `Row` results from `DataFrame.collect` using `case_sensitive` parameter.
 - Added API `Session.conf` for getting, setting or checking the mutability of any runtime configuration.
 - Added support for managing case sensitivity in `Row` results from `DataFrame.collect` using `case_sensitive` parameter.
 - Added indexer support for `snowflake.snowpark.types.StructType`.
 - Added a keyword argument `log_on_exception` to `Dataframe.collect` and `Dataframe.collect_no_wait` to optionally disable error logging for SQL exceptions.
 
 ### Bug Fixes
 
@@ -18,263 +47,295 @@
 
 ### Improvements
 
 - Simplified JOIN queries to use constant subquery aliases (`SNOWPARK_LEFT`, `SNOWPARK_RIGHT`) by default. Users can disable this at runtime with `session.conf.set('use_constant_subquery_alias', False)` to use randomly generated alias names instead.
 - Allowed specifying statement parameters in `session.call()`.
 - Enabled the uploading of large pandas DataFrames in stored procedures by defaulting to a chunk size of 100,000 rows.
 
-
 ## 1.2.0 (2023-03-02)
 
 ### New Features
 
 - Added support for displaying source code as comments in the generated scripts when registering stored procedures. This
-is enabled by default, turn off by specifying `source_code_display=False` at registration.
+  is enabled by default, turn off by specifying `source_code_display=False` at registration.
 - Added a parameter `if_not_exists` when creating a UDF, UDTF or Stored Procedure from Snowpark Python to ignore creating the specified function or procedure if it already exists.
 - Accept integers when calling `snowflake.snowpark.functions.get` to extract value from array.
 - Added `functions.reverse` in functions to open access to Snowflake built-in function
-[reverse](https://docs.snowflake.com/en/sql-reference/functions/reverse).
+  [reverse](https://docs.snowflake.com/en/sql-reference/functions/reverse).
 - Added parameter `require_scoped_url` in snowflake.snowflake.files.SnowflakeFile.open() `(in Private Preview)` to replace `is_owner_file` is marked for deprecation.
 
 ### Bug Fixes
 
 - Fixed a bug that overwrote `paramstyle` to `qmark` when creating a Snowpark session.
 - Fixed a bug where `df.join(..., how="cross")` fails with `SnowparkJoinException: (1112): Unsupported using join type 'Cross'`.
 - Fixed a bug where querying a `DataFrame` column created from chained function calls used a wrong column name.
 
 ## 1.1.0 (2023-01-26)
 
 ### New Features:
+
 - Added `asc`, `asc_nulls_first`, `asc_nulls_last`, `desc`, `desc_nulls_first`, `desc_nulls_last`, `date_part` and `unix_timestamp` in functions.
 - Added the property `DataFrame.dtypes` to return a list of column name and data type pairs.
 - Added the following aliases:
   - `functions.expr()` for `functions.sql_expr()`.
   - `functions.date_format()` for `functions.to_date()`.
   - `functions.monotonically_increasing_id()` for `functions.seq8()`
   - `functions.from_unixtime()` for `functions.to_timestamp()`
 
 ### Bug Fixes:
+
 - Fixed a bug in SQL simplifier that didn’t handle Column alias and join well in some cases. See https://github.com/snowflakedb/snowpark-python/issues/658 for details.
 - Fixed a bug in SQL simplifier that generated wrong column names for function calls, NaN and INF.
 
 ### Improvements
-- The session parameter `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` is `True` after Snowflake 7.3 was released. In snowpark-python, `session.sql_simplifier_enabled` reads the value of `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` by default, meaning that the SQL simplfier is enabled by default after the Snowflake 7.3 release. To turn this off, set `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` in Snowflake to `False` or run `session.sql_simplifier_enabled = False` from Snowpark. It is recommended to use the SQL simplifier because it helps to generate more concise SQL.
 
+- The session parameter `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` is `True` after Snowflake 7.3 was released. In snowpark-python, `session.sql_simplifier_enabled` reads the value of `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` by default, meaning that the SQL simplfier is enabled by default after the Snowflake 7.3 release. To turn this off, set `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` in Snowflake to `False` or run `session.sql_simplifier_enabled = False` from Snowpark. It is recommended to use the SQL simplifier because it helps to generate more concise SQL.
 
 ## 1.0.0 (2022-11-01)
+
 ### New Features
+
 - Added `Session.generator()` to create a new `DataFrame` using the Generator table function.
 - Added a parameter `secure` to the functions that create a secure UDF or UDTF.
 
-
 ## 0.12.0 (2022-10-14)
+
 ### New Features
+
 - Added new APIs for async job:
   - `Session.create_async_job()` to create an `AsyncJob` instance from a query id.
   - `AsyncJob.result()` now accepts argument `result_type` to return the results in different formats.
   - `AsyncJob.to_df()` returns a `DataFrame` built from the result of this asynchronous job.
   - `AsyncJob.query()` returns the SQL text of the executed query.
 - `DataFrame.agg()` and `RelationalGroupedDataFrame.agg()` now accept variable-length arguments.
 - Added parameters `lsuffix` and `rsuffix` to `DataFram.join()` and `DataFrame.cross_join()` to conveniently rename overlapping columns.
 - Added `Table.drop_table()` so you can drop the temp table after `DataFrame.cache_result()`. `Table` is also a context manager so you can use the `with` statement to drop the cache temp table after use.
 - Added `Session.use_secondary_roles()`.
 - Added functions `first_value()` and `last_value()`. (contributed by @chasleslr)
 - Added `on` as an alias for `using_columns` and `how` as an alias for `join_type` in `DataFrame.join()`.
 
 ### Bug Fixes
+
 - Fixed a bug in `Session.create_dataframe()` that raised an error when `schema` names had special characters.
 - Fixed a bug in which options set in `Session.read.option()` were not passed to `DataFrame.copy_into_table()` as default values.
 - Fixed a bug in which `DataFrame.copy_into_table()` raises an error when a copy option has single quotes in the value.
 
 ## 0.11.0 (2022-09-28)
 
 ### Behavior Changes
+
 - `Session.add_packages()` now raises `ValueError` when the version of a package cannot be found in Snowflake Anaconda channel. Previously, `Session.add_packages()` succeeded, and a `SnowparkSQLException` exception was raised later in the UDF/SP registration step.
 
 ### New Features:
+
 - Added method `FileOperation.get_stream()` to support downloading stage files as stream.
 - Added support in `functions.ntiles()` to accept int argument.
 - Added the following aliases:
   - `functions.call_function()` for `functions.call_builtin()`.
   - `functions.function()` for `functions.builtin()`.
   - `DataFrame.order_by()` for `DataFrame.sort()`
   - `DataFrame.orderBy()` for `DataFrame.sort()`
 - Improved `DataFrame.cache_result()` to return a more accurate `Table` class instead of a `DataFrame` class.
 - Added support to allow `session` as the first argument when calling `StoredProcedure`.
 
 ### Improvements
+
 - Improved nested query generation by flattening queries when applicable.
   - This improvement could be enabled by setting `Session.sql_simplifier_enabled = True`.
   - `DataFrame.select()`, `DataFrame.with_column()`, `DataFrame.drop()` and other select-related APIs have more flattened SQLs.
   - `DataFrame.union()`, `DataFrame.union_all()`, `DataFrame.except_()`, `DataFrame.intersect()`, `DataFrame.union_by_name()` have flattened SQLs generated when multiple set operators are chained.
 - Improved type annotations for async job APIs.
 
 ### Bug Fixes
+
 - Fixed a bug in which `Table.update()`, `Table.delete()`, `Table.merge()` try to reference a temp table that does not exist.
 
 ## 0.10.0 (2022-09-16)
 
 ### New Features:
+
 - Added experimental APIs for evaluating Snowpark dataframes with asynchronous queries:
   - Added keyword argument `block` to the following action APIs on Snowpark dataframes (which execute queries) to allow asynchronous evaluations:
     - `DataFrame.collect()`, `DataFrame.to_local_iterator()`, `DataFrame.to_pandas()`, `DataFrame.to_pandas_batches()`, `DataFrame.count()`, `DataFrame.first()`.
     - `DataFrameWriter.save_as_table()`, `DataFrameWriter.copy_into_location()`.
     - `Table.delete()`, `Table.update()`, `Table.merge()`.
   - Added method `DataFrame.collect_nowait()` to allow asynchronous evaluations.
   - Added class `AsyncJob` to retrieve results from asynchronously executed queries and check their status.
 - Added support for `table_type` in `Session.write_pandas()`. You can now choose from these `table_type` options: `"temporary"`, `"temp"`, and `"transient"`.
 - Added support for using Python structured data (`list`, `tuple` and `dict`) as literal values in Snowpark.
 - Added keyword argument `execute_as` to `functions.sproc()` and `session.sproc.register()` to allow registering a stored procedure as a caller or owner.
 - Added support for specifying a pre-configured file format when reading files from a stage in Snowflake.
 
 ### Improvements:
+
 - Added support for displaying details of a Snowpark session.
 
 ### Bug Fixes:
+
 - Fixed a bug in which `DataFrame.copy_into_table()` and `DataFrameWriter.save_as_table()` mistakenly created a new table if the table name is fully qualified, and the table already exists.
 
 ### Deprecations:
+
 - Deprecated keyword argument `create_temp_table` in `Session.write_pandas()`.
 - Deprecated invoking UDFs using arguments wrapped in a Python list or tuple. You can use variable-length arguments without a list or tuple.
 
 ### Dependency updates
+
 - Updated ``snowflake-connector-python`` to 2.7.12.
 
 ## 0.9.0 (2022-08-30)
 
 ### New Features:
+
 - Added support for displaying source code as comments in the generated scripts when registering UDFs.
-This feature is turned on by default. To turn it off, pass the new keyword argument `source_code_display` as `False` when calling `register()` or `@udf()`.
+  This feature is turned on by default. To turn it off, pass the new keyword argument `source_code_display` as `False` when calling `register()` or `@udf()`.
 - Added support for calling table functions from `DataFrame.select()`, `DataFrame.with_column()` and `DataFrame.with_columns()` which now take parameters of type `table_function.TableFunctionCall` for columns.
 - Added keyword argument `overwrite` to `session.write_pandas()` to allow overwriting contents of a Snowflake table with that of a Pandas DataFrame.
 - Added keyword argument `column_order` to `df.write.save_as_table()` to specify the matching rules when inserting data into table in append mode.
 - Added method `FileOperation.put_stream()` to upload local files to a stage via file stream.
 - Added methods `TableFunctionCall.alias()` and `TableFunctionCall.as_()` to allow aliasing the names of columns that come from the output of table function joins.
 - Added function `get_active_session()` in module `snowflake.snowpark.context` to get the current active Snowpark session.
 
 ### Bug Fixes:
+
 - Fixed a bug in which batch insert should not raise an error when `statement_params` is not passed to the function.
 - Fixed a bug in which column names should be quoted when `session.create_dataframe()` is called with dicts and a given schema.
 - Fixed a bug in which creation of table should be skipped if the table already exists and is in append mode when calling `df.write.save_as_table()`.
 - Fixed a bug in which third-party packages with underscores cannot be added when registering UDFs.
 
 ### Improvements:
+
 - Improved function `function.uniform()` to infer the types of inputs `max_` and `min_` and cast the limits to `IntegerType` or `FloatType` correspondingly.
 
 ## 0.8.0 (2022-07-22)
 
 ### New Features:
+
 - Added keyword only argument `statement_params` to the following methods to allow for specifying statement level parameters:
   - `collect`, `to_local_iterator`, `to_pandas`, `to_pandas_batches`,
-  `count`, `copy_into_table`, `show`, `create_or_replace_view`, `create_or_replace_temp_view`, `first`, `cache_result`
-  and `random_split` on class `snowflake.snowpark.Dateframe`.
+    `count`, `copy_into_table`, `show`, `create_or_replace_view`, `create_or_replace_temp_view`, `first`, `cache_result`
+    and `random_split` on class `snowflake.snowpark.Dateframe`.
   - `update`, `delete` and `merge` on class `snowflake.snowpark.Table`.
   - `save_as_table` and `copy_into_location` on class `snowflake.snowpark.DataFrameWriter`.
   - `approx_quantile`, `statement_params`, `cov` and `crosstab` on class `snowflake.snowpark.DataFrameStatFunctions`.
   - `register` and `register_from_file` on class `snowflake.snowpark.udf.UDFRegistration`.
   - `register` and `register_from_file` on class `snowflake.snowpark.udtf.UDTFRegistration`.
   - `register` and `register_from_file` on class `snowflake.snowpark.stored_procedure.StoredProcedureRegistration`.
   - `udf`, `udtf` and `sproc` in `snowflake.snowpark.functions`.
 - Added support for `Column` as an input argument to `session.call()`.
 - Added support for `table_type` in `df.write.save_as_table()`. You can now choose from these `table_type` options: `"temporary"`, `"temp"`, and `"transient"`.
 
 ### Improvements:
+
 - Added validation of object name in `session.use_*` methods.
 - Updated the query tag in SQL to escape it when it has special characters.
 - Added a check to see if Anaconda terms are acknowledged when adding missing packages.
 
 ### Bug Fixes:
+
 - Fixed the limited length of the string column in `session.create_dataframe()`.
 - Fixed a bug in which `session.create_dataframe()` mistakenly converted 0 and `False` to `None` when the input data was only a list.
 - Fixed a bug in which calling `session.create_dataframe()` using a large local dataset sometimes created a temp table twice.
 - Aligned the definition of `function.trim()` with the SQL function definition.
 - Fixed an issue where snowpark-python would hang when using the Python system-defined (built-in function) `sum` vs. the Snowpark `function.sum()`.
 
 ### Deprecations:
-- Deprecated keyword argument `create_temp_table` in `df.write.save_as_table()`.
 
+- Deprecated keyword argument `create_temp_table` in `df.write.save_as_table()`.
 
 ## 0.7.0 (2022-05-25)
 
 ### New Features:
+
 - Added support for user-defined table functions (UDTFs).
   - Use function `snowflake.snowpark.functions.udtf()` to register a UDTF, or use it as a decorator to register the UDTF.
     - You can also use `Session.udtf.register()` to register a UDTF.
   - Use `Session.udtf.register_from_file()` to register a UDTF from a Python file.
 - Updated APIs to query a table function, including both Snowflake built-in table functions and UDTFs.
   - Use function `snowflake.snowpark.functions.table_function()` to create a callable representing a table function and use it to call the table function in a query.
   - Alternatively, use function `snowflake.snowpark.functions.call_table_function()` to call a table function.
   - Added support for `over` clause that specifies `partition by` and `order by` when lateral joining a table function.
   - Updated `Session.table_function()` and `DataFrame.join_table_function()` to accept `TableFunctionCall` instances.
 
 ### Breaking Changes:
+
 - When creating a function with `functions.udf()` and `functions.sproc()`, you can now specify an empty list for the `imports` or `packages` argument to indicate that no import or package is used for this UDF or stored procedure. Previously, specifying an empty list meant that the function would use session-level imports or packages.
 - Improved the `__repr__` implementation of data types in `types.py`. The unused `type_name` property has been removed.
 - Added a Snowpark-specific exception class for SQL errors. This replaces the previous `ProgrammingError` from the Python connector.
 
 ### Improvements:
+
 - Added a lock to a UDF or UDTF when it is called for the first time per thread.
 - Improved the error message for pickling errors that occurred during UDF creation.
 - Included the query ID when logging the failed query.
 
 ### Bug Fixes:
+
 - Fixed a bug in which non-integral data (such as timestamps) was occasionally converted to integer when calling `DataFrame.to_pandas()`.
 - Fixed a bug in which `DataFrameReader.parquet()` failed to read a parquet file when its column contained spaces.
 - Fixed a bug in which `DataFrame.copy_into_table()` failed when the dataframe is created by reading a file with inferred schemas.
 
 ### Deprecations
+
 `Session.flatten()` and `DataFrame.flatten()`.
 
 ### Dependency Updates:
-- Restricted the version of `cloudpickle` <= `2.0.0`.
 
+- Restricted the version of `cloudpickle` <= `2.0.0`.
 
 ## 0.6.0 (2022-04-27)
 
 ### New Features:
+
 - Added support for vectorized UDFs with the input as a Pandas DataFrame or Pandas Series and the output as a Pandas Series. This improves the performance of UDFs in Snowpark.
 - Added support for inferring the schema of a DataFrame by default when it is created by reading a Parquet, Avro, or ORC file in the stage.
 - Added functions `current_session()`, `current_statement()`, `current_user()`, `current_version()`, `current_warehouse()`, `date_from_parts()`, `date_trunc()`, `dayname()`, `dayofmonth()`, `dayofweek()`, `dayofyear()`, `grouping()`, `grouping_id()`, `hour()`, `last_day()`, `minute()`, `next_day()`, `previous_day()`, `second()`, `month()`, `monthname()`, `quarter()`, `year()`, `current_database()`, `current_role()`, `current_schema()`, `current_schemas()`, `current_region()`, `current_avaliable_roles()`, `add_months()`, `any_value()`, `bitnot()`, `bitshiftleft()`, `bitshiftright()`, `convert_timezone()`, `uniform()`, `strtok_to_array()`, `sysdate()`, `time_from_parts()`,  `timestamp_from_parts()`, `timestamp_ltz_from_parts()`, `timestamp_ntz_from_parts()`, `timestamp_tz_from_parts()`, `weekofyear()`, `percentile_cont()` to `snowflake.snowflake.functions`.
 
 ### Breaking Changes:
+
 - Expired deprecations:
   - Removed the following APIs that were deprecated in 0.4.0: `DataFrame.groupByGroupingSets()`, `DataFrame.naturalJoin()`, `DataFrame.joinTableFunction`, `DataFrame.withColumns()`, `Session.getImports()`, `Session.addImport()`, `Session.removeImport()`, `Session.clearImports()`, `Session.getSessionStage()`, `Session.getDefaultDatabase()`, `Session.getDefaultSchema()`, `Session.getCurrentDatabase()`, `Session.getCurrentSchema()`, `Session.getFullyQualifiedCurrentSchema()`.
 
 ### Improvements:
+
 - Added support for creating an empty `DataFrame` with a specific schema using the `Session.create_dataframe()` method.
 - Changed the logging level from `INFO` to `DEBUG` for several logs (e.g., the executed query) when evaluating a dataframe.
 - Improved the error message when failing to create a UDF due to pickle errors.
 
 ### Bug Fixes:
+
 - Removed pandas hard dependencies in the `Session.create_dataframe()` method.
 
 ### Dependency Updates:
-- Added `typing-extension` as a new dependency with the version >= `4.1.0`.
 
+- Added `typing-extension` as a new dependency with the version >= `4.1.0`.
 
 ## 0.5.0 (2022-03-22)
 
 ### New Features
+
 - Added stored procedures API.
   - Added `Session.sproc` property and `sproc()` to `snowflake.snowpark.functions`, so you can register stored procedures.
   - Added `Session.call` to call stored procedures by name.
 - Added `UDFRegistration.register_from_file()` to allow registering UDFs from Python source files or zip files directly.
 - Added `UDFRegistration.describe()` to describe a UDF.
 - Added `DataFrame.random_split()` to provide a way to randomly split a dataframe.
 - Added functions `md5()`, `sha1()`, `sha2()`, `ascii()`, `initcap()`, `length()`, `lower()`, `lpad()`, `ltrim()`, `rpad()`, `rtrim()`, `repeat()`, `soundex()`, `regexp_count()`, `replace()`, `charindex()`, `collate()`, `collation()`, `insert()`, `left()`, `right()`, `endswith()` to `snowflake.snowpark.functions`.
 - Allowed `call_udf()` to accept literal values.
 - Provided a `distinct` keyword in `array_agg()`.
 
 ### Bug Fixes:
+
 - Fixed an issue that caused `DataFrame.to_pandas()` to have a string column if `Column.cast(IntegerType())` was used.
 - Fixed a bug in `DataFrame.describe()` when there is more than one string column.
 
 ## 0.4.0 (2022-02-15)
 
 ### New Features
+
 - You can now specify which Anaconda packages to use when defining UDFs.
   - Added `add_packages()`, `get_packages()`, `clear_packages()`, and `remove_package()`, to class `Session`.
   - Added `add_requirements()` to `Session` so you can use a requirements file to specify which packages this session will use.
   - Added parameter `packages` to function `snowflake.snowpark.functions.udf()` and method `UserDefinedFunction.register()` to indicate UDF-level Anaconda package dependencies when creating a UDF.
   - Added parameter `imports` to `snowflake.snowpark.functions.udf()` and `UserDefinedFunction.register()` to specify UDF-level code imports.
 - Added a parameter `session` to function `udf()` and `UserDefinedFunction.register()` so you can specify which session to use to create a UDF if you have multiple sessions.
 - Added types `Geography` and `Variant` to `snowflake.snowpark.types` to be used as type hints for Geography and Variant data when defining a UDF.
@@ -294,49 +355,57 @@
 - Added `DataFrame.unpivot()`.
 - Added `Column.within_group()` for sorting the rows by columns with some aggregation functions.
 - Added functions `listagg()`, `mode()`, `div0()`, `acos()`, `asin()`, `atan()`, `atan2()`, `cos()`, `cosh()`, `sin()`, `sinh()`, `tan()`, `tanh()`, `degrees()`, `radians()`, `round()`, `trunc()`, and `factorial()` to `snowflake.snowflake.functions`.
 - Added an optional argument `ignore_nulls` in function `lead()` and `lag()`.
 - The `condition` parameter of function `when()` and `iff()` now accepts SQL expressions.
 
 ### Improvements
+
 - All function and method names have been renamed to use the snake case naming style, which is more Pythonic. For convenience, some camel case names are kept as aliases to the snake case APIs. It is recommended to use the snake case APIs.
   - Deprecated these methods on class `Session` and replaced them with their snake case equivalents: `getImports()`, `addImports()`, `removeImport()`, `clearImports()`, `getSessionStage()`, `getDefaultSchema()`, `getDefaultSchema()`, `getCurrentDatabase()`, `getFullyQualifiedCurrentSchema()`.
   - Deprecated these methods on class `DataFrame` and replaced them with their snake case equivalents: `groupingByGroupingSets()`, `naturalJoin()`, `withColumns()`, `joinTableFunction()`.
 - Property `DataFrame.columns` is now consistent with `DataFrame.schema.names` and the Snowflake database `Identifier Requirements`.
 - `Column.__bool__()` now raises a `TypeError`. This will ban the use of logical operators `and`, `or`, `not` on `Column` object, for instance `col("a") > 1 and col("b") > 2` will raise the `TypeError`. Use `(col("a") > 1) & (col("b") > 2)` instead.
 - Changed `PutResult` and `GetResult` to subclass `NamedTuple`.
 - Fixed a bug which raised an error when the local path or stage location has a space or other special characters.
 - Changed `DataFrame.describe()` so that non-numeric and non-string columns are ignored instead of raising an exception.
 
 ### Dependency updates
+
 - Updated ``snowflake-connector-python`` to 2.7.4.
 
 ## 0.3.0 (2022-01-09)
+
 ### New Features
+
 - Added `Column.isin()`, with an alias `Column.in_()`.
 - Added `Column.try_cast()`, which is a special version of `cast()`. It tries to cast a string expression to other types and returns `null` if the cast is not possible.
 - Added `Column.startswith()` and `Column.substr()` to process string columns.
 - `Column.cast()` now also accepts a `str` value to indicate the cast type in addition to a `DataType` instance.
 - Added `DataFrame.describe()` to summarize stats of a `DataFrame`.
 - Added `DataFrame.explain()` to print the query plan of a `DataFrame`.
 - `DataFrame.filter()` and `DataFrame.select_expr()` now accepts a sql expression.
 - Added a new `bool` parameter `create_temp_table` to methods `DataFrame.saveAsTable()` and `Session.write_pandas()` to optionally create a temp table.
 - Added `DataFrame.minus()` and `DataFrame.subtract()` as aliases to `DataFrame.except_()`.
 - Added `regexp_replace()`, `concat()`, `concat_ws()`, `to_char()`, `current_timestamp()`, `current_date()`, `current_time()`, `months_between()`, `cast()`, `try_cast()`, `greatest()`, `least()`, and `hash()` to module `snowflake.snowpark.functions`.
 
 ### Bug Fixes
+
 - Fixed an issue where `Session.createDataFrame(pandas_df)` and `Session.write_pandas(pandas_df)` raise an exception when the `Pandas DataFrame` has spaces in the column name.
 - `DataFrame.copy_into_table()` sometimes prints an `error` level log entry while it actually works. It's fixed now.
 - Fixed an API docs issue where some `DataFrame` APIs are missing from the docs.
 
 ### Dependency updates
+
 - Update ``snowflake-connector-python`` to 2.7.2, which upgrades ``pyarrow`` dependency to 6.0.x. Refer to the [python connector 2.7.2 release notes](https://pypi.org/project/snowflake-connector-python/2.7.2/) for more details.
 
 ## 0.2.0 (2021-12-02)
+
 ### New Features
+
 - Updated the `Session.createDataFrame()` method for creating a `DataFrame` from a Pandas DataFrame.
 - Added the `Session.write_pandas()` method for writing a `Pandas DataFrame` to a table in Snowflake and getting a `Snowpark DataFrame` object back.
 - Added new classes and methods for calling window functions.
 - Added the new functions `cume_dist()`, to find the cumulative distribution of a value with regard to other values within a window partition,
   and `row_number()`, which returns a unique row number for each row within a window partition.
 - Added functions for computing statistics for DataFrames in the `DataFrameStatFunctions` class.
 - Added functions for handling missing values in a DataFrame in the `DataFrameNaFunctions` class.
@@ -347,18 +416,20 @@
 - Added the `DataFrame.copy_into_table()`
   method for loading data from files in a stage into a table.
 - In CASE expressions, the functions `when()` and `otherwise()`
   now accept Python types in addition to `Column` objects.
 - When you register a UDF you can now optionally set the `replace` parameter to `True` to overwrite an existing UDF with the same name.
 
 ### Improvements
+
 - UDFs are now compressed before they are uploaded to the server. This makes them about 10 times smaller, which can help
   when you are using large ML model files.
 - When the size of a UDF is less than 8196 bytes, it will be uploaded as in-line code instead of uploaded to a stage.
 
 ### Bug Fixes
+
 - Fixed an issue where the statement `df.select(when(col("a") == 1, 4).otherwise(col("a"))), [Row(4), Row(2), Row(3)]` raised an exception.
 - Fixed an issue where `df.toPandas()` raised an exception when a DataFrame was created from large local data.
 
 ## 0.1.0 (2021-10-26)
 
 Start of Private Preview
```

### Comparing `snowflake-snowpark-python-1.3.0/LICENSE.txt` & `snowflake-snowpark-python-1.4.0/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/PKG-INFO` & `snowflake-snowpark-python-1.4.0/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: snowflake-snowpark-python
-Version: 1.3.0
+Version: 1.4.0
 Summary: Snowflake Snowpark for Python
 Home-page: https://www.snowflake.com/
 Author: Snowflake, Inc
 Author-email: snowflake-python-libraries-dl@snowflake.com
 License: Apache License, Version 2.0
 Project-URL: Documentation, https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html
 Project-URL: Source, https://github.com/snowflakedb/snowpark-python
@@ -130,20 +130,49 @@
 [snowflake lab sample code]: https://github.com/Snowflake-Labs/snowpark-python-demos
 [samples]: https://github.com/snowflakedb/snowpark-python/blob/main/README.md#samples
 [contributing]: https://github.com/snowflakedb/snowpark-python/blob/main/CONTRIBUTING.md
 
 
 # Release History
 
+## 1.4.0 (2023-04-24)
+
+### New Features
+
+- Added support for `session.getOrCreate`.
+- Added support for alias `Column.getField`.
+- Added support for new functions in `snowflake.snowpark.functions`:
+  - `date_add` and `date_sub` to make add and subtract operations easier.
+  - `daydiff`
+  - `explode`
+  - `array_distinct`.
+  - `regexp_extract`.
+  - `struct`.
+  - `format_number`.
+  - `bround`.
+  - `substring_index`
+- Added parameter `skip_upload_on_content_match` when creating UDFs, UDTFs and stored procedures using `register_from_file` to skip uploading files to a stage if the same version of the files are already on the stage.
+- Added support for `DataFrame.save_as_table` method to take table names that contain dots.
+- Flattened generated SQL when `DataFrame.filter()` or `DataFrame.order_by()` is followed by a projection statement (e.g. `DataFrame.select()`, `DataFrame.with_column()`).
+- Added support for creating dynamic tables _(in private preview)_ using `Dataframe.create_or_replace_dynamic_table`.
+- Added an optional argument `params` in `session.sql()` to support binding variables. Note that this is not supported in stored procedures yet.
+
+### Bug Fixes
+
+- Fixed a bug in `strtok_to_array` where an exception was thrown when a delimiter was passed in.
+- Fixed a bug in `session.add_import` where the module had the same namespace as other dependencies.
+
 ## 1.3.0 (2023-03-28)
 
 ### New Features
 
 - Added support for `delimiters` parameter in `functions.initcap()`.
 - Added support for `functions.hash()` to accept a variable number of input expressions.
+- Added API `Session.RuntimeConfig` for getting/setting/checking the mutability of any runtime configuration.
+- Added support managing case sensitivity in `Row` results from `DataFrame.collect` using `case_sensitive` parameter.
 - Added API `Session.conf` for getting, setting or checking the mutability of any runtime configuration.
 - Added support for managing case sensitivity in `Row` results from `DataFrame.collect` using `case_sensitive` parameter.
 - Added indexer support for `snowflake.snowpark.types.StructType`.
 - Added a keyword argument `log_on_exception` to `Dataframe.collect` and `Dataframe.collect_no_wait` to optionally disable error logging for SQL exceptions.
 
 ### Bug Fixes
 
@@ -152,263 +181,295 @@
 
 ### Improvements
 
 - Simplified JOIN queries to use constant subquery aliases (`SNOWPARK_LEFT`, `SNOWPARK_RIGHT`) by default. Users can disable this at runtime with `session.conf.set('use_constant_subquery_alias', False)` to use randomly generated alias names instead.
 - Allowed specifying statement parameters in `session.call()`.
 - Enabled the uploading of large pandas DataFrames in stored procedures by defaulting to a chunk size of 100,000 rows.
 
-
 ## 1.2.0 (2023-03-02)
 
 ### New Features
 
 - Added support for displaying source code as comments in the generated scripts when registering stored procedures. This
-is enabled by default, turn off by specifying `source_code_display=False` at registration.
+  is enabled by default, turn off by specifying `source_code_display=False` at registration.
 - Added a parameter `if_not_exists` when creating a UDF, UDTF or Stored Procedure from Snowpark Python to ignore creating the specified function or procedure if it already exists.
 - Accept integers when calling `snowflake.snowpark.functions.get` to extract value from array.
 - Added `functions.reverse` in functions to open access to Snowflake built-in function
-[reverse](https://docs.snowflake.com/en/sql-reference/functions/reverse).
+  [reverse](https://docs.snowflake.com/en/sql-reference/functions/reverse).
 - Added parameter `require_scoped_url` in snowflake.snowflake.files.SnowflakeFile.open() `(in Private Preview)` to replace `is_owner_file` is marked for deprecation.
 
 ### Bug Fixes
 
 - Fixed a bug that overwrote `paramstyle` to `qmark` when creating a Snowpark session.
 - Fixed a bug where `df.join(..., how="cross")` fails with `SnowparkJoinException: (1112): Unsupported using join type 'Cross'`.
 - Fixed a bug where querying a `DataFrame` column created from chained function calls used a wrong column name.
 
 ## 1.1.0 (2023-01-26)
 
 ### New Features:
+
 - Added `asc`, `asc_nulls_first`, `asc_nulls_last`, `desc`, `desc_nulls_first`, `desc_nulls_last`, `date_part` and `unix_timestamp` in functions.
 - Added the property `DataFrame.dtypes` to return a list of column name and data type pairs.
 - Added the following aliases:
   - `functions.expr()` for `functions.sql_expr()`.
   - `functions.date_format()` for `functions.to_date()`.
   - `functions.monotonically_increasing_id()` for `functions.seq8()`
   - `functions.from_unixtime()` for `functions.to_timestamp()`
 
 ### Bug Fixes:
+
 - Fixed a bug in SQL simplifier that didn’t handle Column alias and join well in some cases. See https://github.com/snowflakedb/snowpark-python/issues/658 for details.
 - Fixed a bug in SQL simplifier that generated wrong column names for function calls, NaN and INF.
 
 ### Improvements
-- The session parameter `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` is `True` after Snowflake 7.3 was released. In snowpark-python, `session.sql_simplifier_enabled` reads the value of `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` by default, meaning that the SQL simplfier is enabled by default after the Snowflake 7.3 release. To turn this off, set `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` in Snowflake to `False` or run `session.sql_simplifier_enabled = False` from Snowpark. It is recommended to use the SQL simplifier because it helps to generate more concise SQL.
 
+- The session parameter `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` is `True` after Snowflake 7.3 was released. In snowpark-python, `session.sql_simplifier_enabled` reads the value of `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` by default, meaning that the SQL simplfier is enabled by default after the Snowflake 7.3 release. To turn this off, set `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` in Snowflake to `False` or run `session.sql_simplifier_enabled = False` from Snowpark. It is recommended to use the SQL simplifier because it helps to generate more concise SQL.
 
 ## 1.0.0 (2022-11-01)
+
 ### New Features
+
 - Added `Session.generator()` to create a new `DataFrame` using the Generator table function.
 - Added a parameter `secure` to the functions that create a secure UDF or UDTF.
 
-
 ## 0.12.0 (2022-10-14)
+
 ### New Features
+
 - Added new APIs for async job:
   - `Session.create_async_job()` to create an `AsyncJob` instance from a query id.
   - `AsyncJob.result()` now accepts argument `result_type` to return the results in different formats.
   - `AsyncJob.to_df()` returns a `DataFrame` built from the result of this asynchronous job.
   - `AsyncJob.query()` returns the SQL text of the executed query.
 - `DataFrame.agg()` and `RelationalGroupedDataFrame.agg()` now accept variable-length arguments.
 - Added parameters `lsuffix` and `rsuffix` to `DataFram.join()` and `DataFrame.cross_join()` to conveniently rename overlapping columns.
 - Added `Table.drop_table()` so you can drop the temp table after `DataFrame.cache_result()`. `Table` is also a context manager so you can use the `with` statement to drop the cache temp table after use.
 - Added `Session.use_secondary_roles()`.
 - Added functions `first_value()` and `last_value()`. (contributed by @chasleslr)
 - Added `on` as an alias for `using_columns` and `how` as an alias for `join_type` in `DataFrame.join()`.
 
 ### Bug Fixes
+
 - Fixed a bug in `Session.create_dataframe()` that raised an error when `schema` names had special characters.
 - Fixed a bug in which options set in `Session.read.option()` were not passed to `DataFrame.copy_into_table()` as default values.
 - Fixed a bug in which `DataFrame.copy_into_table()` raises an error when a copy option has single quotes in the value.
 
 ## 0.11.0 (2022-09-28)
 
 ### Behavior Changes
+
 - `Session.add_packages()` now raises `ValueError` when the version of a package cannot be found in Snowflake Anaconda channel. Previously, `Session.add_packages()` succeeded, and a `SnowparkSQLException` exception was raised later in the UDF/SP registration step.
 
 ### New Features:
+
 - Added method `FileOperation.get_stream()` to support downloading stage files as stream.
 - Added support in `functions.ntiles()` to accept int argument.
 - Added the following aliases:
   - `functions.call_function()` for `functions.call_builtin()`.
   - `functions.function()` for `functions.builtin()`.
   - `DataFrame.order_by()` for `DataFrame.sort()`
   - `DataFrame.orderBy()` for `DataFrame.sort()`
 - Improved `DataFrame.cache_result()` to return a more accurate `Table` class instead of a `DataFrame` class.
 - Added support to allow `session` as the first argument when calling `StoredProcedure`.
 
 ### Improvements
+
 - Improved nested query generation by flattening queries when applicable.
   - This improvement could be enabled by setting `Session.sql_simplifier_enabled = True`.
   - `DataFrame.select()`, `DataFrame.with_column()`, `DataFrame.drop()` and other select-related APIs have more flattened SQLs.
   - `DataFrame.union()`, `DataFrame.union_all()`, `DataFrame.except_()`, `DataFrame.intersect()`, `DataFrame.union_by_name()` have flattened SQLs generated when multiple set operators are chained.
 - Improved type annotations for async job APIs.
 
 ### Bug Fixes
+
 - Fixed a bug in which `Table.update()`, `Table.delete()`, `Table.merge()` try to reference a temp table that does not exist.
 
 ## 0.10.0 (2022-09-16)
 
 ### New Features:
+
 - Added experimental APIs for evaluating Snowpark dataframes with asynchronous queries:
   - Added keyword argument `block` to the following action APIs on Snowpark dataframes (which execute queries) to allow asynchronous evaluations:
     - `DataFrame.collect()`, `DataFrame.to_local_iterator()`, `DataFrame.to_pandas()`, `DataFrame.to_pandas_batches()`, `DataFrame.count()`, `DataFrame.first()`.
     - `DataFrameWriter.save_as_table()`, `DataFrameWriter.copy_into_location()`.
     - `Table.delete()`, `Table.update()`, `Table.merge()`.
   - Added method `DataFrame.collect_nowait()` to allow asynchronous evaluations.
   - Added class `AsyncJob` to retrieve results from asynchronously executed queries and check their status.
 - Added support for `table_type` in `Session.write_pandas()`. You can now choose from these `table_type` options: `"temporary"`, `"temp"`, and `"transient"`.
 - Added support for using Python structured data (`list`, `tuple` and `dict`) as literal values in Snowpark.
 - Added keyword argument `execute_as` to `functions.sproc()` and `session.sproc.register()` to allow registering a stored procedure as a caller or owner.
 - Added support for specifying a pre-configured file format when reading files from a stage in Snowflake.
 
 ### Improvements:
+
 - Added support for displaying details of a Snowpark session.
 
 ### Bug Fixes:
+
 - Fixed a bug in which `DataFrame.copy_into_table()` and `DataFrameWriter.save_as_table()` mistakenly created a new table if the table name is fully qualified, and the table already exists.
 
 ### Deprecations:
+
 - Deprecated keyword argument `create_temp_table` in `Session.write_pandas()`.
 - Deprecated invoking UDFs using arguments wrapped in a Python list or tuple. You can use variable-length arguments without a list or tuple.
 
 ### Dependency updates
+
 - Updated ``snowflake-connector-python`` to 2.7.12.
 
 ## 0.9.0 (2022-08-30)
 
 ### New Features:
+
 - Added support for displaying source code as comments in the generated scripts when registering UDFs.
-This feature is turned on by default. To turn it off, pass the new keyword argument `source_code_display` as `False` when calling `register()` or `@udf()`.
+  This feature is turned on by default. To turn it off, pass the new keyword argument `source_code_display` as `False` when calling `register()` or `@udf()`.
 - Added support for calling table functions from `DataFrame.select()`, `DataFrame.with_column()` and `DataFrame.with_columns()` which now take parameters of type `table_function.TableFunctionCall` for columns.
 - Added keyword argument `overwrite` to `session.write_pandas()` to allow overwriting contents of a Snowflake table with that of a Pandas DataFrame.
 - Added keyword argument `column_order` to `df.write.save_as_table()` to specify the matching rules when inserting data into table in append mode.
 - Added method `FileOperation.put_stream()` to upload local files to a stage via file stream.
 - Added methods `TableFunctionCall.alias()` and `TableFunctionCall.as_()` to allow aliasing the names of columns that come from the output of table function joins.
 - Added function `get_active_session()` in module `snowflake.snowpark.context` to get the current active Snowpark session.
 
 ### Bug Fixes:
+
 - Fixed a bug in which batch insert should not raise an error when `statement_params` is not passed to the function.
 - Fixed a bug in which column names should be quoted when `session.create_dataframe()` is called with dicts and a given schema.
 - Fixed a bug in which creation of table should be skipped if the table already exists and is in append mode when calling `df.write.save_as_table()`.
 - Fixed a bug in which third-party packages with underscores cannot be added when registering UDFs.
 
 ### Improvements:
+
 - Improved function `function.uniform()` to infer the types of inputs `max_` and `min_` and cast the limits to `IntegerType` or `FloatType` correspondingly.
 
 ## 0.8.0 (2022-07-22)
 
 ### New Features:
+
 - Added keyword only argument `statement_params` to the following methods to allow for specifying statement level parameters:
   - `collect`, `to_local_iterator`, `to_pandas`, `to_pandas_batches`,
-  `count`, `copy_into_table`, `show`, `create_or_replace_view`, `create_or_replace_temp_view`, `first`, `cache_result`
-  and `random_split` on class `snowflake.snowpark.Dateframe`.
+    `count`, `copy_into_table`, `show`, `create_or_replace_view`, `create_or_replace_temp_view`, `first`, `cache_result`
+    and `random_split` on class `snowflake.snowpark.Dateframe`.
   - `update`, `delete` and `merge` on class `snowflake.snowpark.Table`.
   - `save_as_table` and `copy_into_location` on class `snowflake.snowpark.DataFrameWriter`.
   - `approx_quantile`, `statement_params`, `cov` and `crosstab` on class `snowflake.snowpark.DataFrameStatFunctions`.
   - `register` and `register_from_file` on class `snowflake.snowpark.udf.UDFRegistration`.
   - `register` and `register_from_file` on class `snowflake.snowpark.udtf.UDTFRegistration`.
   - `register` and `register_from_file` on class `snowflake.snowpark.stored_procedure.StoredProcedureRegistration`.
   - `udf`, `udtf` and `sproc` in `snowflake.snowpark.functions`.
 - Added support for `Column` as an input argument to `session.call()`.
 - Added support for `table_type` in `df.write.save_as_table()`. You can now choose from these `table_type` options: `"temporary"`, `"temp"`, and `"transient"`.
 
 ### Improvements:
+
 - Added validation of object name in `session.use_*` methods.
 - Updated the query tag in SQL to escape it when it has special characters.
 - Added a check to see if Anaconda terms are acknowledged when adding missing packages.
 
 ### Bug Fixes:
+
 - Fixed the limited length of the string column in `session.create_dataframe()`.
 - Fixed a bug in which `session.create_dataframe()` mistakenly converted 0 and `False` to `None` when the input data was only a list.
 - Fixed a bug in which calling `session.create_dataframe()` using a large local dataset sometimes created a temp table twice.
 - Aligned the definition of `function.trim()` with the SQL function definition.
 - Fixed an issue where snowpark-python would hang when using the Python system-defined (built-in function) `sum` vs. the Snowpark `function.sum()`.
 
 ### Deprecations:
-- Deprecated keyword argument `create_temp_table` in `df.write.save_as_table()`.
 
+- Deprecated keyword argument `create_temp_table` in `df.write.save_as_table()`.
 
 ## 0.7.0 (2022-05-25)
 
 ### New Features:
+
 - Added support for user-defined table functions (UDTFs).
   - Use function `snowflake.snowpark.functions.udtf()` to register a UDTF, or use it as a decorator to register the UDTF.
     - You can also use `Session.udtf.register()` to register a UDTF.
   - Use `Session.udtf.register_from_file()` to register a UDTF from a Python file.
 - Updated APIs to query a table function, including both Snowflake built-in table functions and UDTFs.
   - Use function `snowflake.snowpark.functions.table_function()` to create a callable representing a table function and use it to call the table function in a query.
   - Alternatively, use function `snowflake.snowpark.functions.call_table_function()` to call a table function.
   - Added support for `over` clause that specifies `partition by` and `order by` when lateral joining a table function.
   - Updated `Session.table_function()` and `DataFrame.join_table_function()` to accept `TableFunctionCall` instances.
 
 ### Breaking Changes:
+
 - When creating a function with `functions.udf()` and `functions.sproc()`, you can now specify an empty list for the `imports` or `packages` argument to indicate that no import or package is used for this UDF or stored procedure. Previously, specifying an empty list meant that the function would use session-level imports or packages.
 - Improved the `__repr__` implementation of data types in `types.py`. The unused `type_name` property has been removed.
 - Added a Snowpark-specific exception class for SQL errors. This replaces the previous `ProgrammingError` from the Python connector.
 
 ### Improvements:
+
 - Added a lock to a UDF or UDTF when it is called for the first time per thread.
 - Improved the error message for pickling errors that occurred during UDF creation.
 - Included the query ID when logging the failed query.
 
 ### Bug Fixes:
+
 - Fixed a bug in which non-integral data (such as timestamps) was occasionally converted to integer when calling `DataFrame.to_pandas()`.
 - Fixed a bug in which `DataFrameReader.parquet()` failed to read a parquet file when its column contained spaces.
 - Fixed a bug in which `DataFrame.copy_into_table()` failed when the dataframe is created by reading a file with inferred schemas.
 
 ### Deprecations
+
 `Session.flatten()` and `DataFrame.flatten()`.
 
 ### Dependency Updates:
-- Restricted the version of `cloudpickle` <= `2.0.0`.
 
+- Restricted the version of `cloudpickle` <= `2.0.0`.
 
 ## 0.6.0 (2022-04-27)
 
 ### New Features:
+
 - Added support for vectorized UDFs with the input as a Pandas DataFrame or Pandas Series and the output as a Pandas Series. This improves the performance of UDFs in Snowpark.
 - Added support for inferring the schema of a DataFrame by default when it is created by reading a Parquet, Avro, or ORC file in the stage.
 - Added functions `current_session()`, `current_statement()`, `current_user()`, `current_version()`, `current_warehouse()`, `date_from_parts()`, `date_trunc()`, `dayname()`, `dayofmonth()`, `dayofweek()`, `dayofyear()`, `grouping()`, `grouping_id()`, `hour()`, `last_day()`, `minute()`, `next_day()`, `previous_day()`, `second()`, `month()`, `monthname()`, `quarter()`, `year()`, `current_database()`, `current_role()`, `current_schema()`, `current_schemas()`, `current_region()`, `current_avaliable_roles()`, `add_months()`, `any_value()`, `bitnot()`, `bitshiftleft()`, `bitshiftright()`, `convert_timezone()`, `uniform()`, `strtok_to_array()`, `sysdate()`, `time_from_parts()`,  `timestamp_from_parts()`, `timestamp_ltz_from_parts()`, `timestamp_ntz_from_parts()`, `timestamp_tz_from_parts()`, `weekofyear()`, `percentile_cont()` to `snowflake.snowflake.functions`.
 
 ### Breaking Changes:
+
 - Expired deprecations:
   - Removed the following APIs that were deprecated in 0.4.0: `DataFrame.groupByGroupingSets()`, `DataFrame.naturalJoin()`, `DataFrame.joinTableFunction`, `DataFrame.withColumns()`, `Session.getImports()`, `Session.addImport()`, `Session.removeImport()`, `Session.clearImports()`, `Session.getSessionStage()`, `Session.getDefaultDatabase()`, `Session.getDefaultSchema()`, `Session.getCurrentDatabase()`, `Session.getCurrentSchema()`, `Session.getFullyQualifiedCurrentSchema()`.
 
 ### Improvements:
+
 - Added support for creating an empty `DataFrame` with a specific schema using the `Session.create_dataframe()` method.
 - Changed the logging level from `INFO` to `DEBUG` for several logs (e.g., the executed query) when evaluating a dataframe.
 - Improved the error message when failing to create a UDF due to pickle errors.
 
 ### Bug Fixes:
+
 - Removed pandas hard dependencies in the `Session.create_dataframe()` method.
 
 ### Dependency Updates:
-- Added `typing-extension` as a new dependency with the version >= `4.1.0`.
 
+- Added `typing-extension` as a new dependency with the version >= `4.1.0`.
 
 ## 0.5.0 (2022-03-22)
 
 ### New Features
+
 - Added stored procedures API.
   - Added `Session.sproc` property and `sproc()` to `snowflake.snowpark.functions`, so you can register stored procedures.
   - Added `Session.call` to call stored procedures by name.
 - Added `UDFRegistration.register_from_file()` to allow registering UDFs from Python source files or zip files directly.
 - Added `UDFRegistration.describe()` to describe a UDF.
 - Added `DataFrame.random_split()` to provide a way to randomly split a dataframe.
 - Added functions `md5()`, `sha1()`, `sha2()`, `ascii()`, `initcap()`, `length()`, `lower()`, `lpad()`, `ltrim()`, `rpad()`, `rtrim()`, `repeat()`, `soundex()`, `regexp_count()`, `replace()`, `charindex()`, `collate()`, `collation()`, `insert()`, `left()`, `right()`, `endswith()` to `snowflake.snowpark.functions`.
 - Allowed `call_udf()` to accept literal values.
 - Provided a `distinct` keyword in `array_agg()`.
 
 ### Bug Fixes:
+
 - Fixed an issue that caused `DataFrame.to_pandas()` to have a string column if `Column.cast(IntegerType())` was used.
 - Fixed a bug in `DataFrame.describe()` when there is more than one string column.
 
 ## 0.4.0 (2022-02-15)
 
 ### New Features
+
 - You can now specify which Anaconda packages to use when defining UDFs.
   - Added `add_packages()`, `get_packages()`, `clear_packages()`, and `remove_package()`, to class `Session`.
   - Added `add_requirements()` to `Session` so you can use a requirements file to specify which packages this session will use.
   - Added parameter `packages` to function `snowflake.snowpark.functions.udf()` and method `UserDefinedFunction.register()` to indicate UDF-level Anaconda package dependencies when creating a UDF.
   - Added parameter `imports` to `snowflake.snowpark.functions.udf()` and `UserDefinedFunction.register()` to specify UDF-level code imports.
 - Added a parameter `session` to function `udf()` and `UserDefinedFunction.register()` so you can specify which session to use to create a UDF if you have multiple sessions.
 - Added types `Geography` and `Variant` to `snowflake.snowpark.types` to be used as type hints for Geography and Variant data when defining a UDF.
@@ -428,49 +489,57 @@
 - Added `DataFrame.unpivot()`.
 - Added `Column.within_group()` for sorting the rows by columns with some aggregation functions.
 - Added functions `listagg()`, `mode()`, `div0()`, `acos()`, `asin()`, `atan()`, `atan2()`, `cos()`, `cosh()`, `sin()`, `sinh()`, `tan()`, `tanh()`, `degrees()`, `radians()`, `round()`, `trunc()`, and `factorial()` to `snowflake.snowflake.functions`.
 - Added an optional argument `ignore_nulls` in function `lead()` and `lag()`.
 - The `condition` parameter of function `when()` and `iff()` now accepts SQL expressions.
 
 ### Improvements
+
 - All function and method names have been renamed to use the snake case naming style, which is more Pythonic. For convenience, some camel case names are kept as aliases to the snake case APIs. It is recommended to use the snake case APIs.
   - Deprecated these methods on class `Session` and replaced them with their snake case equivalents: `getImports()`, `addImports()`, `removeImport()`, `clearImports()`, `getSessionStage()`, `getDefaultSchema()`, `getDefaultSchema()`, `getCurrentDatabase()`, `getFullyQualifiedCurrentSchema()`.
   - Deprecated these methods on class `DataFrame` and replaced them with their snake case equivalents: `groupingByGroupingSets()`, `naturalJoin()`, `withColumns()`, `joinTableFunction()`.
 - Property `DataFrame.columns` is now consistent with `DataFrame.schema.names` and the Snowflake database `Identifier Requirements`.
 - `Column.__bool__()` now raises a `TypeError`. This will ban the use of logical operators `and`, `or`, `not` on `Column` object, for instance `col("a") > 1 and col("b") > 2` will raise the `TypeError`. Use `(col("a") > 1) & (col("b") > 2)` instead.
 - Changed `PutResult` and `GetResult` to subclass `NamedTuple`.
 - Fixed a bug which raised an error when the local path or stage location has a space or other special characters.
 - Changed `DataFrame.describe()` so that non-numeric and non-string columns are ignored instead of raising an exception.
 
 ### Dependency updates
+
 - Updated ``snowflake-connector-python`` to 2.7.4.
 
 ## 0.3.0 (2022-01-09)
+
 ### New Features
+
 - Added `Column.isin()`, with an alias `Column.in_()`.
 - Added `Column.try_cast()`, which is a special version of `cast()`. It tries to cast a string expression to other types and returns `null` if the cast is not possible.
 - Added `Column.startswith()` and `Column.substr()` to process string columns.
 - `Column.cast()` now also accepts a `str` value to indicate the cast type in addition to a `DataType` instance.
 - Added `DataFrame.describe()` to summarize stats of a `DataFrame`.
 - Added `DataFrame.explain()` to print the query plan of a `DataFrame`.
 - `DataFrame.filter()` and `DataFrame.select_expr()` now accepts a sql expression.
 - Added a new `bool` parameter `create_temp_table` to methods `DataFrame.saveAsTable()` and `Session.write_pandas()` to optionally create a temp table.
 - Added `DataFrame.minus()` and `DataFrame.subtract()` as aliases to `DataFrame.except_()`.
 - Added `regexp_replace()`, `concat()`, `concat_ws()`, `to_char()`, `current_timestamp()`, `current_date()`, `current_time()`, `months_between()`, `cast()`, `try_cast()`, `greatest()`, `least()`, and `hash()` to module `snowflake.snowpark.functions`.
 
 ### Bug Fixes
+
 - Fixed an issue where `Session.createDataFrame(pandas_df)` and `Session.write_pandas(pandas_df)` raise an exception when the `Pandas DataFrame` has spaces in the column name.
 - `DataFrame.copy_into_table()` sometimes prints an `error` level log entry while it actually works. It's fixed now.
 - Fixed an API docs issue where some `DataFrame` APIs are missing from the docs.
 
 ### Dependency updates
+
 - Update ``snowflake-connector-python`` to 2.7.2, which upgrades ``pyarrow`` dependency to 6.0.x. Refer to the [python connector 2.7.2 release notes](https://pypi.org/project/snowflake-connector-python/2.7.2/) for more details.
 
 ## 0.2.0 (2021-12-02)
+
 ### New Features
+
 - Updated the `Session.createDataFrame()` method for creating a `DataFrame` from a Pandas DataFrame.
 - Added the `Session.write_pandas()` method for writing a `Pandas DataFrame` to a table in Snowflake and getting a `Snowpark DataFrame` object back.
 - Added new classes and methods for calling window functions.
 - Added the new functions `cume_dist()`, to find the cumulative distribution of a value with regard to other values within a window partition,
   and `row_number()`, which returns a unique row number for each row within a window partition.
 - Added functions for computing statistics for DataFrames in the `DataFrameStatFunctions` class.
 - Added functions for handling missing values in a DataFrame in the `DataFrameNaFunctions` class.
@@ -481,18 +550,20 @@
 - Added the `DataFrame.copy_into_table()`
   method for loading data from files in a stage into a table.
 - In CASE expressions, the functions `when()` and `otherwise()`
   now accept Python types in addition to `Column` objects.
 - When you register a UDF you can now optionally set the `replace` parameter to `True` to overwrite an existing UDF with the same name.
 
 ### Improvements
+
 - UDFs are now compressed before they are uploaded to the server. This makes them about 10 times smaller, which can help
   when you are using large ML model files.
 - When the size of a UDF is less than 8196 bytes, it will be uploaded as in-line code instead of uploaded to a stage.
 
 ### Bug Fixes
+
 - Fixed an issue where the statement `df.select(when(col("a") == 1, 4).otherwise(col("a"))), [Row(4), Row(2), Row(3)]` raised an exception.
 - Fixed an issue where `df.toPandas()` raised an exception when a DataFrame was created from large local data.
 
 ## 0.1.0 (2021-10-26)
 
 Start of Private Preview
```

### Comparing `snowflake-snowpark-python-1.3.0/README.md` & `snowflake-snowpark-python-1.4.0/README.md`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/setup.py` & `snowflake-snowpark-python-1.4.0/setup.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/__init__.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/__init__.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py`

 * *Files 0% similar despite different names*

```diff
@@ -115,14 +115,15 @@
     Alias,
     Cast,
     UnaryExpression,
     UnresolvedAlias,
 )
 from snowflake.snowpark._internal.analyzer.unary_plan_node import (
     Aggregate,
+    CreateDynamicTableCommand,
     CreateViewCommand,
     Filter,
     LocalTempView,
     PersistedView,
     Pivot,
     Project,
     Sample,
@@ -676,14 +677,22 @@
                     str(logical_plan.view_type)
                 )
 
             return self.plan_builder.create_or_replace_view(
                 logical_plan.name, resolved_children[logical_plan.child], is_temp
             )
 
+        if isinstance(logical_plan, CreateDynamicTableCommand):
+            return self.plan_builder.create_or_replace_dynamic_table(
+                logical_plan.name,
+                logical_plan.warehouse,
+                logical_plan.lag,
+                resolved_children[logical_plan.child],
+            )
+
         if isinstance(logical_plan, CopyIntoTableNode):
             format_type_options = (
                 logical_plan.format_type_options.copy()
                 if logical_plan.format_type_options
                 else {}
             )
             format_name = logical_plan.cur_options.get("FORMAT_NAME")
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -78,14 +78,17 @@
 JOIN = " JOIN "
 NATURAL = " NATURAL "
 EXISTS = " EXISTS "
 CREATE = " CREATE "
 TABLE = " TABLE "
 REPLACE = " REPLACE "
 VIEW = " VIEW "
+DYNAMIC = " DYNAMIC "
+LAG = " LAG "
+WAREHOUSE = " WAREHOUSE "
 TEMPORARY = " TEMPORARY "
 IF = " If "
 INSERT = " INSERT "
 INTO = " INTO "
 VALUES = " VALUES "
 SEQ8 = " SEQ8() "
 ROW_NUMBER = " ROW_NUMBER() "
@@ -880,14 +883,31 @@
         + VIEW
         + name
         + AS
         + project_statement([], child)
     )
 
 
+def create_or_replace_dynamic_table_statement(
+    name: str, warehouse: str, lag: str, child: str
+) -> str:
+    return (
+        CREATE
+        + OR
+        + REPLACE
+        + DYNAMIC
+        + TABLE
+        + name
+        + f"{LAG + EQUALS + convert_value_to_sql_option(lag)}"
+        + f"{WAREHOUSE + EQUALS + warehouse}"
+        + AS
+        + project_statement([], child)
+    )
+
+
 def pivot_statement(
     pivot_column: str, pivot_values: List[str], aggregate: str, child: str
 ) -> str:
     return (
         SELECT
         + STAR
         + FROM
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/expression.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py`

 * *Files 4% similar despite different names*

```diff
@@ -2,15 +2,15 @@
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 from abc import ABC, abstractmethod
 from collections import UserDict
 from copy import copy
 from enum import Enum
-from typing import TYPE_CHECKING, Any, Dict, List, Optional, Set, Union
+from typing import TYPE_CHECKING, Any, Dict, List, Optional, Sequence, Set, Union
 
 from snowflake.snowpark._internal.analyzer.table_function import (
     TableFunctionExpression,
     TableFunctionJoin,
     TableFunctionRelation,
 )
 
@@ -168,14 +168,20 @@
     @property
     @abstractmethod
     def sql_query(self) -> str:
         """Returns the sql query of this Selectable logical plan."""
         pass
 
     @property
+    @abstractmethod
+    def query_params(self) -> Optional[Sequence[Any]]:
+        """Returns the sql query of this Selectable logical plan."""
+        pass  # pragma: no cover
+
+    @property
     def sql_in_subquery(self) -> str:
         """Return the sql when this Selectable is used in a subquery."""
         return f"{analyzer_utils.LEFT_PARENTHESIS}{self.sql_query}{analyzer_utils.RIGHT_PARENTHESIS}"
 
     @property
     @abstractmethod
     def schema_query(self) -> str:
@@ -197,15 +203,15 @@
         if self._snowflake_plan:
             self._snowflake_plan.api_calls = value
 
     @property
     def snowflake_plan(self):
         """Convert to a SnowflakePlan"""
         if self._snowflake_plan is None:
-            query = Query(self.sql_query)
+            query = Query(self.sql_query, params=self.query_params)
             queries = [*self.pre_actions, query] if self.pre_actions else [query]
             self._snowflake_plan = SnowflakePlan(
                 queries,
                 self.schema_query,
                 post_actions=self.post_actions,
                 session=self.analyzer.session,
                 expr_to_alias=self.expr_to_alias,
@@ -246,55 +252,75 @@
     def sql_in_subquery(self) -> str:
         return self.entity_name
 
     @property
     def schema_query(self) -> str:
         return self.sql_query
 
+    @property
+    def query_params(self) -> Optional[Sequence[Any]]:
+        return None
+
 
 class SelectSQL(Selectable):
     """Query from a SQL. Mainly used by session.sql()"""
 
     def __init__(
-        self, sql: str, *, convert_to_select: bool = False, analyzer: "Analyzer"
+        self,
+        sql: str,
+        *,
+        convert_to_select: bool = False,
+        analyzer: "Analyzer",
+        params: Optional[Sequence[Any]] = None,
     ) -> None:
         """
         convert_to_select: If true the passed-in ``sql`` is not a select SQL, convert it to two SQLs in the logical plan.
         One is to execute the ``sql``. Another one is to `select * from result_scan(<query_id_of_the_first_sql>)`.
         So the query can be used in a subquery.
         """
         super().__init__(analyzer)
         self.convert_to_select = convert_to_select
         self.original_sql = sql
         is_select = is_sql_select_statement(sql)
         if not is_select and convert_to_select:
-            self.pre_actions = [Query(sql)]
+            self.pre_actions = [Query(sql, params)]
             self._sql_query = result_scan_statement(
                 self.pre_actions[0].query_id_place_holder
             )
             self._schema_query = analyzer_utils.schema_value_statement(
                 analyze_attributes(sql, self.analyzer.session)
             )  # Change to subqueryable schema query so downstream query plan can describe the SQL
+            self._query_param = None
         else:
             self._sql_query = sql
             self._schema_query = sql
+            self._query_param = params
 
     @property
     def sql_query(self) -> str:
         return self._sql_query
 
     @property
+    def query_params(self) -> Optional[Sequence[Any]]:
+        return self._query_param
+
+    @property
     def schema_query(self) -> str:
         return self._schema_query
 
     def to_subqueryable(self) -> "SelectSQL":
         """Convert this SelectSQL to a new one that can be used as a subquery. Refer to __init__."""
         if self.convert_to_select:
             return self
-        new = SelectSQL(self._sql_query, convert_to_select=True, analyzer=self.analyzer)
+        new = SelectSQL(
+            self._sql_query,
+            convert_to_select=True,
+            analyzer=self.analyzer,
+            params=self.query_params,
+        )
         new._column_states = self.column_states
         new._api_calls = self._api_calls
         return new
 
 
 class SelectSnowflakePlan(Selectable):
     """Wrap a SnowflakePlan to a subclass of Selectable."""
@@ -306,27 +332,35 @@
             if isinstance(snowflake_plan, SnowflakePlan)
             else analyzer.resolve(snowflake_plan)
         )
         self.expr_to_alias.update(self._snowflake_plan.expr_to_alias)
         self.pre_actions = self._snowflake_plan.queries[:-1]
         self.post_actions = self._snowflake_plan.post_actions
         self._api_calls = self._snowflake_plan.api_calls
+        self._query_params = []
+        for query in self._snowflake_plan.queries:
+            if query.params:
+                self._query_params.extend(query.params)
 
     @property
     def snowflake_plan(self):
         return self._snowflake_plan
 
     @property
     def sql_query(self) -> str:
         return self._snowflake_plan.queries[-1].sql
 
     @property
     def schema_query(self) -> str:
         return self.snowflake_plan.schema_query
 
+    @property
+    def query_params(self) -> Optional[Sequence[Any]]:
+        return self._query_params
+
 
 class SelectStatement(Selectable):
     """The main logic plan to be used by a DataFrame.
     It structurally has the parts of a query and uses the ColumnState to decide whether a query can be flattened."""
 
     def __init__(
         self,
@@ -347,14 +381,15 @@
         self.limit_: Optional[int] = limit_
         self.offset = offset
         self.pre_actions = self.from_.pre_actions
         self.post_actions = self.from_.post_actions
         self._sql_query = None
         self._schema_query = None
         self._projection_in_str = None
+        self._query_params = None
         self.expr_to_alias.update(self.from_.expr_to_alias)
         self.api_calls = (
             self.from_.api_calls.copy() if self.from_.api_calls is not None else None
         )  # will be replaced by new api calls if any operation.
 
     def __copy__(self):
         new = SelectStatement(
@@ -438,14 +473,18 @@
             if self.offset
             else analyzer_utils.EMPTY_STRING
         )
         self._sql_query = f"{analyzer_utils.SELECT}{self.projection_in_str}{analyzer_utils.FROM}{from_clause}{where_clause}{order_by_clause}{limit_clause}{offset_clause}"
         return self._sql_query
 
     @property
+    def query_params(self) -> Optional[Sequence[Any]]:
+        return self.from_.query_params
+
+    @property
     def schema_query(self) -> str:
         if self._schema_query:
             return self._schema_query
         if not self.projection:
             self._schema_query = self.from_.schema_query
             return self._schema_query
         self._schema_query = f"{analyzer_utils.SELECT}{self.projection_in_str}{analyzer_utils.FROM}({self.from_.schema_query})"
@@ -481,68 +520,74 @@
             new = copy(self)  # it copies the api_calls
             new._projection_in_str = self._projection_in_str
             new._schema_query = self._schema_query
             new._column_states = self._column_states
             new._snowflake_plan = self._snowflake_plan
             new.flatten_disabled = self.flatten_disabled
             return new
-        final_projection = []
         disable_next_level_flatten = False
         new_column_states = derive_column_states_from_subquery(cols, self)
         if new_column_states is None:
             can_be_flattened = False
             disable_next_level_flatten = True
         elif len(new_column_states.active_columns) != len(new_column_states.projection):
             # There must be duplicate columns in the projection.
             # We don't flatten when there are duplicate columns.
             can_be_flattened = False
             disable_next_level_flatten = True
-        elif self.flatten_disabled or self.has_clause_using_columns:
+        elif self.flatten_disabled:
+            can_be_flattened = False
+        elif self.has_clause_using_columns and not self.snowflake_plan.session.conf.get(
+            "flatten_select_after_filter_and_orderby"
+        ):
+            # TODO: Clean up, this entire if case is parameter protection
+            can_be_flattened = False
+        elif self.where and (
+            (subquery_dependent_columns := derive_dependent_columns(self.where))
+            in (COLUMN_DEPENDENCY_DOLLAR, COLUMN_DEPENDENCY_ALL)
+            or any(
+                new_column_states[_col].change_state == ColumnChangeState.NEW
+                for _col in subquery_dependent_columns.intersection(
+                    new_column_states.active_columns
+                )
+            )
+        ):
+            can_be_flattened = False
+        elif self.order_by and (
+            (subquery_dependent_columns := derive_dependent_columns(*self.order_by))
+            in (COLUMN_DEPENDENCY_DOLLAR, COLUMN_DEPENDENCY_ALL)
+            or any(
+                new_column_states[_col].change_state
+                in (ColumnChangeState.CHANGED_EXP, ColumnChangeState.NEW)
+                for _col in subquery_dependent_columns.intersection(
+                    new_column_states.active_columns
+                )
+            )
+        ):
             can_be_flattened = False
         else:
-            can_be_flattened = True
-            subquery_column_states = self.column_states
+            can_be_flattened = can_select_statement_be_flattened(
+                self.column_states, new_column_states
+            )
+
+        if can_be_flattened:
+            new = copy(self)
+            final_projection = []
+
             for col, state in new_column_states.items():
-                dependent_columns = state.dependent_columns
-                if dependent_columns == COLUMN_DEPENDENCY_DOLLAR:
-                    can_be_flattened = False
-                    break
-                subquery_state = subquery_column_states.get(col)
                 if state.change_state in (
                     ColumnChangeState.CHANGED_EXP,
                     ColumnChangeState.NEW,
                 ):
-                    can_be_flattened = can_projection_dependent_columns_be_flattened(
-                        dependent_columns, subquery_column_states
-                    )
-                    if not can_be_flattened:
-                        break
                     final_projection.append(copy(state.expression))
                 elif state.change_state == ColumnChangeState.UNCHANGED_EXP:
-                    # query may change sequence of columns. If subquery has same-level reference, flattened sql may not work.
-                    if (
-                        col not in subquery_column_states
-                        or subquery_column_states[col].depend_on_same_level
-                    ):
-                        can_be_flattened = False
-                        break
                     final_projection.append(
-                        copy(subquery_column_states[col].expression)
+                        copy(self.column_states[col].expression)
                     )  # add subquery's expression for this column name
-                elif state.change_state == ColumnChangeState.DROPPED:
-                    if (
-                        subquery_state.change_state == ColumnChangeState.NEW
-                        and subquery_state.is_referenced_by_same_level_column
-                    ):
-                        can_be_flattened = False
-                        break
-                else:  # pragma: no cover
-                    raise ValueError(f"Invalid column state {state}.")
-        if can_be_flattened:
-            new = copy(self)
+
             new.projection = final_projection
             new.from_ = self.from_.to_subqueryable()
             new.pre_actions = new.from_.pre_actions
             new.post_actions = new.from_.post_actions
         else:
             new = SelectStatement(
                 projection=cols, from_=self.to_subqueryable(), analyzer=self.analyzer
@@ -553,52 +598,51 @@
         )
         # If new._column_states is None, when property `column_states` is called later,
         # a query will be described and an error like "invalid identifier" will be thrown.
 
         return new
 
     def filter(self, col: Expression) -> "SelectStatement":
-        if self.flatten_disabled:
-            can_be_flattened = False
-        else:
-            dependent_columns = derive_dependent_columns(col)
-            can_be_flattened = can_clause_dependent_columns_flatten(
-                dependent_columns, self.column_states
-            )
+        can_be_flattened = (
+            not self.flatten_disabled
+        ) and can_clause_dependent_columns_flatten(
+            derive_dependent_columns(col), self.column_states
+        )
         if can_be_flattened:
             new = copy(self)
             new.from_ = self.from_.to_subqueryable()
             new.pre_actions = new.from_.pre_actions
             new.post_actions = new.from_.post_actions
-            new.where = And(self.where, col) if self.where is not None else col
             new._column_states = self._column_states
+            new.where = And(self.where, col) if self.where is not None else col
         else:
             new = SelectStatement(
                 from_=self.to_subqueryable(), where=col, analyzer=self.analyzer
             )
+
         return new
 
     def sort(self, cols: List[Expression]) -> "SelectStatement":
-        if self.flatten_disabled:
-            can_be_flattened = False
-        else:
-            dependent_columns = derive_dependent_columns(*cols)
-            can_be_flattened = can_clause_dependent_columns_flatten(
-                dependent_columns, self.column_states
-            )
+        can_be_flattened = (
+            not self.flatten_disabled
+        ) and can_clause_dependent_columns_flatten(
+            derive_dependent_columns(*cols), self.column_states
+        )
         if can_be_flattened:
             new = copy(self)
             new.from_ = self.from_.to_subqueryable()
             new.pre_actions = new.from_.pre_actions
             new.post_actions = new.from_.post_actions
             new.order_by = cols + (self.order_by or [])
             new._column_states = self._column_states
         else:
             new = SelectStatement(
-                from_=self.to_subqueryable(), order_by=cols, analyzer=self.analyzer
+                from_=self.to_subqueryable(),
+                order_by=cols,
+                analyzer=self.analyzer,
             )
         return new
 
     def set_operator(
         self,
         *selectables: Union[
             SelectSnowflakePlan,
@@ -695,14 +739,18 @@
     def sql_query(self) -> str:
         return self._snowflake_plan.queries[-1].sql
 
     @property
     def schema_query(self) -> str:
         return self._snowflake_plan.schema_query
 
+    @property
+    def query_params(self) -> Optional[Sequence[Any]]:
+        return self.snowflake_plan.queries[-1].params
+
 
 class SetOperand:
     def __init__(self, selectable: Selectable, operator: Optional[str] = None) -> None:
         super().__init__()
         self.selectable = selectable
         self.operator = operator
 
@@ -740,14 +788,24 @@
     def column_states(self) -> Optional[ColumnStateDict]:
         if not self._column_states:
             self._column_states = initiate_column_states(
                 self.set_operands[0].selectable.column_states.projection, self.analyzer
             )
         return self._column_states
 
+    @property
+    def query_params(self) -> Optional[Sequence[Any]]:
+        query_params = None
+        for operand in self.set_operands:
+            if operand.selectable.query_params:
+                if query_params is None:
+                    query_params = []
+                query_params.extend(operand.selectable.query_params)
+        return query_params
+
 
 class DeriveColumnDependencyError(Exception):
     """When deriving column dependencies from the subquery."""
 
 
 def parse_column_name(column: Expression, analyzer: "Analyzer") -> Optional[str]:
     if isinstance(column, Expression):
@@ -770,72 +828,96 @@
             return column.name
     # We can parse column name from a column's SQL expression in the future.
     # When parsing column name isn't possible, the SelectStatement.select won't flatten and
     # disables the next level SelectStatement to flatten
     return None
 
 
+def can_select_statement_be_flattened(
+    subquery_column_states: ColumnStateDict, new_column_states: ColumnStateDict
+) -> bool:
+    for col, state in new_column_states.items():
+        dependent_columns = state.dependent_columns
+        if dependent_columns == COLUMN_DEPENDENCY_DOLLAR:
+            return False
+        subquery_state = subquery_column_states.get(col)
+        if state.change_state in (
+            ColumnChangeState.CHANGED_EXP,
+            ColumnChangeState.NEW,
+        ) and not can_projection_dependent_columns_be_flattened(
+            dependent_columns, subquery_column_states
+        ):
+            return False
+        elif state.change_state == ColumnChangeState.UNCHANGED_EXP and (
+            col not in subquery_column_states
+            or subquery_column_states[col].depend_on_same_level
+        ):
+            # query may change sequence of columns. If subquery has same-level reference, flattened sql may not work.
+            return False
+        elif state.change_state == ColumnChangeState.DROPPED and (
+            subquery_state.change_state == ColumnChangeState.NEW
+            and subquery_state.is_referenced_by_same_level_column
+        ):
+            return False
+    return True
+
+
 def can_projection_dependent_columns_be_flattened(
     dependent_columns: Optional[Set[str]], subquery_column_states: ColumnStateDict
 ) -> bool:
-    can_be_flattened = True
     # COLUMN_DEPENDENCY_DOLLAR should already be handled before calling this function
     if dependent_columns == COLUMN_DEPENDENCY_DOLLAR:  # pragma: no cover
-        can_be_flattened = False
+        return False
     elif (
         subquery_column_states.has_changed_columns
         or subquery_column_states.has_dropped_columns
         or subquery_column_states.has_new_columns
     ):
         if dependent_columns == COLUMN_DEPENDENCY_ALL:
-            can_be_flattened = False
+            return False
         else:
             for dc in dependent_columns:
                 dc_state = subquery_column_states.get(dc)
                 if dc_state and dc_state.change_state in (
                     (
                         ColumnChangeState.CHANGED_EXP,
                         ColumnChangeState.DROPPED,
                         ColumnChangeState.NEW,
                     )
                 ):
-                    can_be_flattened = False
-                    break
-    return can_be_flattened
+                    return False
+    return True
 
 
 def can_clause_dependent_columns_flatten(
     dependent_columns: Optional[Set[str]], subquery_column_states: ColumnStateDict
 ) -> bool:
-    can_be_flattened = True
     if dependent_columns == COLUMN_DEPENDENCY_DOLLAR:
-        can_be_flattened = False
+        return False
     elif (
         subquery_column_states.has_changed_columns
         or subquery_column_states.has_new_columns
     ):
         if dependent_columns == COLUMN_DEPENDENCY_ALL:
-            can_be_flattened = False
-        else:
-            for dc in dependent_columns:
-                dc_state = subquery_column_states.get(dc)
-                if dc_state:
-                    if dc_state.change_state == ColumnChangeState.CHANGED_EXP:
-                        can_be_flattened = False
-                        break
-                    elif dc_state.change_state == ColumnChangeState.NEW:
-                        # Most of the time this can be flatten. But if a new column uses window function and this column
-                        # is used in a clause, the sql doesn't work in Snowflake.
-                        # For instance `select a, rank() over(order by b) as d from test_table where d = 1` doesn't work.
-                        # But `select a, b as d from test_table where d = 1` works
-                        # We can inspect whether the referenced new column uses window function. Here we are being
-                        # conservative for now to not flatten the SQL.
-                        can_be_flattened = False
-                        break
-    return can_be_flattened
+            return False
+
+        for dc in dependent_columns:
+            dc_state = subquery_column_states.get(dc)
+            if dc_state:
+                if dc_state.change_state == ColumnChangeState.CHANGED_EXP:
+                    return False
+                elif dc_state.change_state == ColumnChangeState.NEW:
+                    # Most of the time this can be flattened. But if a new column uses window function and this column
+                    # is used in a clause, the sql doesn't work in Snowflake.
+                    # For instance `select a, rank() over(order by b) as d from test_table where d = 1` doesn't work.
+                    # But `select a, b as d from test_table where d = 1` works
+                    # We can inspect whether the referenced new column uses window function. Here we are being
+                    # conservative for now to not flatten the SQL.
+                    return False
+    return True
 
 
 def initiate_column_states(
     column_attrs: List[Attribute], analyzer: "Analyzer"
 ) -> ColumnStateDict:
     column_states = ColumnStateDict()
     for attr in column_attrs:
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py`

 * *Files 3% similar despite different names*

```diff
@@ -3,15 +3,25 @@
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import re
 import sys
 import uuid
 from functools import cached_property
-from typing import TYPE_CHECKING, Any, Callable, Dict, List, Optional, Tuple
+from typing import (
+    TYPE_CHECKING,
+    Any,
+    Callable,
+    Dict,
+    List,
+    Optional,
+    Sequence,
+    Tuple,
+    Union,
+)
 
 from snowflake.snowpark._internal.analyzer.table_function import GeneratorTableFunction
 
 if TYPE_CHECKING:
     from snowflake.snowpark._internal.analyzer.select_statement import (
         Selectable,
     )  # pragma: no cover
@@ -21,14 +31,15 @@
 from snowflake.snowpark._internal.analyzer.analyzer_utils import (
     aggregate_statement,
     attribute_to_schema_string,
     batch_insert_into_statement,
     copy_into_location,
     copy_into_table,
     create_file_format_statement,
+    create_or_replace_dynamic_table_statement,
     create_or_replace_view_statement,
     create_table_as_select_statement,
     create_table_statement,
     delete_statement,
     drop_file_format_if_exists_statement,
     drop_table_if_exists_statement,
     file_operation_statement,
@@ -187,14 +198,15 @@
         self.expr_to_alias = expr_to_alias if expr_to_alias else {}
         self.session = session
         self.source_plan = source_plan
         self.is_ddl_on_temp_object = is_ddl_on_temp_object
         # We need to copy this list since we don't want to change it for the
         # previous SnowflakePlan objects
         self.api_calls = api_calls.copy() if api_calls else []
+        self._output_dict = None
 
     def with_subqueries(self, subquery_plans: List["SnowflakePlan"]) -> "SnowflakePlan":
         pre_queries = self.queries[:-1]
         new_schema_query = self.schema_query
         new_post_actions = [*self.post_actions]
         api_calls = [*self.api_calls]
 
@@ -226,14 +238,22 @@
         self.schema_query = schema_value_statement(output)
         return output
 
     @cached_property
     def output(self) -> List[Attribute]:
         return [Attribute(a.name, a.datatype, a.nullable) for a in self.attributes]
 
+    @property
+    def output_dict(self) -> Dict[str, Any]:
+        if self._output_dict is None:
+            self._output_dict = {
+                attr.name: (attr.datatype, attr.nullable) for attr in self.output
+            }
+        return self._output_dict
+
     def __copy__(self) -> "SnowflakePlan":
         return SnowflakePlan(
             self.queries.copy() if self.queries else [],
             self.schema_query,
             self.post_actions.copy() if self.post_actions else None,
             dict(self.expr_to_alias) if self.expr_to_alias else None,
             self.session,
@@ -261,14 +281,15 @@
     ) -> SnowflakePlan:
         select_child = self.add_result_scan_if_not_select(child)
         queries = select_child.queries[:-1] + [
             Query(
                 sql_generator(select_child.queries[-1].sql),
                 query_id_place_holder="",
                 is_ddl_on_temp_object=is_ddl_on_temp_object,
+                params=select_child.queries[-1].params,
             )
         ]
         new_schema_query = (
             schema_query if schema_query else sql_generator(child.schema_query)
         )
 
         return SnowflakePlan(
@@ -281,29 +302,33 @@
             is_ddl_on_temp_object,
             api_calls=select_child.api_calls,
         )
 
     @SnowflakePlan.Decorator.wrap_exception
     def build_from_multiple_queries(
         self,
-        multi_sql_generator: Callable[[str], str],
+        multi_sql_generator: Callable[["Query"], List["Query"]],
         child: SnowflakePlan,
         source_plan: Optional[LogicalPlan],
-        schema_query: Optional[str] = None,
+        schema_query: Optional["query"] = None,
         is_ddl_on_temp_object: bool = False,
     ) -> SnowflakePlan:
         select_child = self.add_result_scan_if_not_select(child)
         queries = select_child.queries[0:-1] + [
-            Query(msg, is_ddl_on_temp_object=is_ddl_on_temp_object)
-            for msg in multi_sql_generator(select_child.queries[-1].sql)
+            Query(
+                query.sql,
+                is_ddl_on_temp_object=is_ddl_on_temp_object,
+                params=query.params,
+            )
+            for query in multi_sql_generator(select_child.queries[-1])
         ]
         new_schema_query = (
             schema_query
             if schema_query is not None
-            else multi_sql_generator(child.schema_query)[-1]
+            else multi_sql_generator(Query(child.schema_query))[-1].sql
         )
 
         return SnowflakePlan(
             queries,
             new_schema_query,
             select_child.post_actions,
             select_child.expr_to_alias,
@@ -326,15 +351,18 @@
             select_left.queries[:-1]
             + select_right.queries[:-1]
             + [
                 Query(
                     sql_generator(
                         select_left.queries[-1].sql, select_right.queries[-1].sql
                     ),
-                    None,
+                    params=[
+                        *select_left.queries[-1].params,
+                        *select_right.queries[-1].params,
+                    ],
                 )
             ]
         )
 
         left_schema_query = schema_value_statement(select_left.attributes)
         right_schema_query = schema_value_statement(select_right.attributes)
         schema_query = sql_generator(left_schema_query, right_schema_query)
@@ -363,17 +391,18 @@
         )
 
     def query(
         self,
         sql: str,
         source_plan: Optional[LogicalPlan],
         api_calls: Optional[List[Dict]] = None,
+        params: Optional[Sequence[Any]] = None,
     ) -> SnowflakePlan:
         return SnowflakePlan(
-            queries=[Query(sql)],
+            queries=[Query(sql, params=params)],
             schema_query=sql,
             session=self.session,
             source_plan=source_plan,
             api_calls=api_calls,
         )
 
     def large_local_relation_plan(
@@ -506,78 +535,82 @@
             left,
             right,
             source_plan,
         )
 
     def save_as_table(
         self,
-        table_name: str,
+        table_name: Union[str, Iterable[str]],
         column_names: Optional[Iterable[str]],
         mode: SaveMode,
         table_type: str,
         child: SnowflakePlan,
     ) -> SnowflakePlan:
+        full_table_name = (
+            table_name if isinstance(table_name, str) else ".".join(table_name)
+        )
         if mode == SaveMode.APPEND:
             if self.session._table_exists(table_name):
                 return self.build(
                     lambda x: insert_into_statement(
-                        table_name=table_name,
+                        table_name=full_table_name,
                         child=x,
                         column_names=column_names,
                     ),
                     child,
                     None,
                 )
             else:
                 create_table = create_table_statement(
-                    table_name,
+                    full_table_name,
                     attribute_to_schema_string(child.attributes),
                     error=False,
                     table_type=table_type,
                 )
 
                 return SnowflakePlan(
                     [
                         *child.queries[0:-1],
                         Query(create_table),
                         Query(
                             insert_into_statement(
-                                table_name=table_name,
+                                table_name=full_table_name,
                                 child=child.queries[-1].sql,
                                 column_names=column_names,
-                            )
+                            ),
+                            params=child.queries[-1].params,
                         ),
                     ],
                     create_table,
                     child.post_actions,
                     {},
                     self.session,
                     None,
                     api_calls=child.api_calls,
                 )
         elif mode == SaveMode.OVERWRITE:
             return self.build(
                 lambda x: create_table_as_select_statement(
-                    table_name, x, replace=True, table_type=table_type
+                    full_table_name, x, replace=True, table_type=table_type
                 ),
                 child,
                 None,
             )
         elif mode == SaveMode.IGNORE:
             return self.build(
                 lambda x: create_table_as_select_statement(
-                    table_name, x, error=False, table_type=table_type
+                    full_table_name, x, error=False, table_type=table_type
                 ),
                 child,
                 None,
             )
         elif mode == SaveMode.ERROR_IF_EXISTS:
             return self.build(
                 lambda x: create_table_as_select_statement(
-                    table_name, x, table_type=table_type
+                    full_table_name, x, table_type=table_type
                 ),
                 child,
                 None,
             )
 
     def limit(
         self,
@@ -632,14 +665,35 @@
 
         return self.build(
             lambda x: create_or_replace_view_statement(name, x, is_temp),
             child,
             None,
         )
 
+    def create_or_replace_dynamic_table(
+        self,
+        name: str,
+        warehouse: str,
+        lag: str,
+        child: SnowflakePlan,
+    ) -> SnowflakePlan:
+        if len(child.queries) != 1:
+            raise SnowparkClientExceptionMessages.PLAN_CREATE_DYNAMIC_TABLE_FROM_DDL_DML_OPERATIONS()
+
+        if not is_sql_select_statement(child.queries[0].sql.lower().strip()):
+            raise SnowparkClientExceptionMessages.PLAN_CREATE_DYNAMIC_TABLE_FROM_SELECT_ONLY()
+
+        return self.build(
+            lambda x: create_or_replace_dynamic_table_statement(
+                name, warehouse, lag, x
+            ),
+            child,
+            None,
+        )
+
     def create_temp_table(
         self,
         name: str,
         child: SnowflakePlan,
         *,
         use_scoped_temp_objects: bool = False,
         is_generated: bool = False,
@@ -660,31 +714,36 @@
         )
 
     def create_table_and_insert(
         self,
         session,
         name: str,
         schema_query: str,
-        query: str,
+        query: "Query",
         *,
         use_scoped_temp_objects: bool = False,
         is_generated: bool = False,
-    ) -> List[str]:
+    ) -> List["Query"]:
         attributes = session._get_result_attributes(schema_query)
         create_table = create_table_statement(
             name,
             attribute_to_schema_string(attributes),
             table_type="temporary",
             use_scoped_temp_objects=use_scoped_temp_objects,
             is_generated=is_generated,
         )
 
         return [
-            create_table,
-            insert_into_statement(table_name=name, column_names=None, child=query),
+            Query(create_table),
+            Query(
+                insert_into_statement(
+                    table_name=name, column_names=None, child=query.sql
+                ),
+                params=query.params,
+            ),
         ]
 
     def read_file(
         self,
         path: str,
         format: str,
         options: Dict[str, str],
@@ -833,15 +892,15 @@
                 self.session,
                 None,
             )
 
     def copy_into_table(
         self,
         file_format: str,
-        table_name: str,
+        table_name: Union[str, Iterable[str]],
         path: Optional[str] = None,
         files: Optional[str] = None,
         pattern: Optional[str] = None,
         format_type_options: Optional[Dict[str, Any]] = None,
         copy_options: Optional[Dict[str, Any]] = None,
         validation_mode: Optional[str] = None,
         column_names: Optional[List[str]] = None,
@@ -849,16 +908,19 @@
         user_schema: Optional[StructType] = None,
         create_table_from_infer_schema: bool = False,
     ) -> SnowflakePlan:
         # tracking usage of pattern, will refactor this function in future
         if pattern:
             self.session._conn._telemetry_client.send_copy_pattern_telemetry()
 
+        full_table_name = (
+            table_name if isinstance(table_name, str) else ".".join(table_name)
+        )
         copy_command = copy_into_table(
-            table_name=table_name,
+            table_name=full_table_name,
             file_path=path,
             files=files,
             file_format_type=file_format,
             format_type_options=format_type_options,
             copy_options=copy_options,
             pattern=pattern,
             validation_mode=validation_mode,
@@ -874,27 +936,27 @@
                 and file_format.upper() in INFER_SCHEMA_FORMAT_TYPES
             )
         ):
             attributes = user_schema._to_attributes()
             queries = [
                 Query(
                     create_table_statement(
-                        table_name,
+                        full_table_name,
                         attribute_to_schema_string(attributes),
                     ),
                     # This is an exception. The principle is to avoid surprising behavior and most of the time
                     # it applies to temp object. But this perm table creation is also one place where we create
                     # table on behalf of the user automatically.
                     is_ddl_on_temp_object=True,
                 ),
                 Query(copy_command),
             ]
         else:
             raise SnowparkClientExceptionMessages.DF_COPY_INTO_CANNOT_CREATE_TABLE(
-                table_name
+                full_table_name
             )
         return SnowflakePlan(queries, copy_command, [], {}, self.session, None)
 
     def copy_into_location(
         self,
         query: SnowflakePlan,
         stage_location: str,
@@ -1051,25 +1113,27 @@
 
 class Query:
     def __init__(
         self,
         sql: str,
         query_id_place_holder: Optional[str] = None,
         is_ddl_on_temp_object: bool = False,
+        params: Optional[Sequence[Any]] = None,
     ) -> None:
         self.sql = sql
         self.query_id_place_holder = (
             query_id_place_holder
             if query_id_place_holder
             else f"query_id_place_holder_{generate_random_alphanumeric()}"
         )
         self.is_ddl_on_temp_object = is_ddl_on_temp_object
+        self.params = params or []
 
     def __repr__(self) -> str:
-        return f"Query({self.sql!r}, {self.query_id_place_holder!r}, {self.is_ddl_on_temp_object})"
+        return f"Query({self.sql!r}, {self.query_id_place_holder!r}, {self.is_ddl_on_temp_object}, {self.params})"
 
     def __eq__(self, other: "Query") -> bool:
         return (
             self.sql == other.sql
             and self.query_id_place_holder == other.query_id_place_holder
             and self.is_ddl_on_temp_object == other.is_ddl_on_temp_object
         )
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 from enum import Enum
-from typing import Any, Dict, List, Optional
+from typing import Any, Dict, List, Optional, Union
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.expression import Attribute, Expression
 from snowflake.snowpark.row import Row
 from snowflake.snowpark.types import StructType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
@@ -59,15 +59,15 @@
     ERROR_IF_EXISTS = "errorifexists"
     IGNORE = "ignore"
 
 
 class SnowflakeCreateTable(LogicalPlan):
     def __init__(
         self,
-        table_name: str,
+        table_name: Union[str, Iterable[str]],
         column_names: Optional[Iterable[str]],
         mode: SaveMode,
         query: Optional[LogicalPlan],
         table_type: str = "",
     ) -> None:
         super().__init__()
         self.table_name = table_name
@@ -88,15 +88,15 @@
         self.child = child
         self.children.append(child)
 
 
 class CopyIntoTableNode(LeafNode):
     def __init__(
         self,
-        table_name: str,
+        table_name: Union[str, Iterable[str]],
         *,
         file_path: Optional[str] = None,
         files: Optional[str] = None,
         pattern: Optional[str] = None,
         file_format: Optional[str] = None,
         format_type_options: Optional[Dict[str, Any]],
         column_names: Optional[List[str]] = None,
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/table_function.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_function.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py`

 * *Files 9% similar despite different names*

```diff
@@ -105,7 +105,21 @@
         name: str,
         view_type: ViewType,
         child: LogicalPlan,
     ) -> None:
         super().__init__(child)
         self.name = name
         self.view_type = view_type
+
+
+class CreateDynamicTableCommand(UnaryNode):
+    def __init__(
+        self,
+        name: str,
+        warehouse: str,
+        lag: str,
+        child: LogicalPlan,
+    ) -> None:
+        super().__init__(child)
+        self.name = name
+        self.warehouse = warehouse
+        self.lag = lag
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/code_generation.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/code_generation.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/error_message.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/error_message.py`

 * *Files 6% similar despite different names*

```diff
@@ -4,14 +4,15 @@
 #
 
 from typing import Optional
 
 from snowflake.connector import OperationalError, ProgrammingError
 from snowflake.snowpark.exceptions import (
     SnowparkColumnException,
+    SnowparkCreateDynamicTableException,
     SnowparkCreateViewException,
     SnowparkDataframeException,
     SnowparkDataframeReaderException,
     SnowparkFetchDataException,
     SnowparkInvalidObjectNameException,
     SnowparkJoinException,
     SnowparkMissingDbOrSchemaException,
@@ -223,14 +224,28 @@
     def PLAN_INVALID_TYPE(type: str) -> SnowparkPlanException:
         return SnowparkPlanException(f"Invalid type, analyze. {type}", "1205")
 
     @staticmethod
     def PLAN_CANNOT_CREATE_LITERAL(type: str) -> SnowparkPlanException:
         return SnowparkPlanException(f"Cannot create a Literal for {type}", "1206")
 
+    @staticmethod
+    def PLAN_CREATE_DYNAMIC_TABLE_FROM_DDL_DML_OPERATIONS() -> SnowparkCreateDynamicTableException:
+        return SnowparkCreateDynamicTableException(
+            "Your dataframe may include DDL or DML operations. Creating a dynamic table from "
+            "this DataFrame is currently not supported.",
+            "1207",
+        )
+
+    @staticmethod
+    def PLAN_CREATE_DYNAMIC_TABLE_FROM_SELECT_ONLY() -> SnowparkCreateDynamicTableException:
+        return SnowparkCreateDynamicTableException(
+            "Creating dynamic tables from SELECT queries supported only.", "1208"
+        )
+
     # SQL Execution error codes 03XX
 
     @staticmethod
     def SQL_LAST_QUERY_RETURN_RESULTSET() -> SnowparkSQLException:
         return SnowparkSQLException(
             "Internal error: The execution for the last query "
             "in the Snowflake plan doesn't return a ResultSet.",
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/server_connection.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/server_connection.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,18 +1,19 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import functools
+import inspect
 import os
 import sys
 import time
 from logging import getLogger
-from typing import IO, Any, Dict, Iterator, List, Optional, Set, Tuple, Union
+from typing import IO, Any, Dict, Iterator, List, Optional, Sequence, Set, Tuple, Union
 
 from snowflake.connector import SnowflakeConnection, connect
 from snowflake.connector.constants import ENV_VAR_PARTNER, FIELD_ID_TO_NAME
 from snowflake.connector.cursor import ResultMetadata, SnowflakeCursor
 from snowflake.connector.errors import NotSupportedError, ProgrammingError
 from snowflake.connector.network import ReauthenticationRequest
 from snowflake.connector.options import pandas
@@ -138,14 +139,20 @@
         self._cursor = self._conn.cursor()
         self._telemetry_client = TelemetryClient(self._conn)
         self._query_listener: Set[QueryHistory] = set()
         # The session in this case refers to a Snowflake session, not a
         # Snowpark session
         self._telemetry_client.send_session_created_telemetry(not bool(conn))
 
+        # check if cursor.execute supports _skip_upload_on_content_match
+        signature = inspect.signature(self._cursor.execute)
+        self._supports_skip_upload_on_content_match = (
+            "_skip_upload_on_content_match" in signature.parameters
+        )
+
     def _add_application_name(self) -> None:
         if PARAM_APPLICATION not in self._lower_case_parameters:
             # Mirrored from snowflake-connector-python/src/snowflake/connector/connection.py#L295
             if ENV_VAR_PARTNER in os.environ.keys():
                 self._lower_case_parameters[PARAM_APPLICATION] = os.environ[
                     ENV_VAR_PARTNER
                 ]
@@ -204,14 +211,15 @@
         path: str,
         stage_location: str,
         dest_prefix: str = "",
         parallel: int = 4,
         compress_data: bool = True,
         source_compression: str = "AUTO_DETECT",
         overwrite: bool = False,
+        skip_upload_on_content_match: bool = False,
     ) -> Optional[Dict[str, Any]]:
         if is_in_stored_procedure():  # pragma: no cover
             file_name = os.path.basename(path)
             target_path = _build_target_path(stage_location, dest_prefix)
             try:
                 # upload_stream directly consume stage path, so we don't need to normalize it
                 self._cursor.upload_stream(
@@ -221,38 +229,44 @@
                 tb = sys.exc_info()[2]
                 ne = SnowparkClientExceptionMessages.SQL_EXCEPTION_FROM_PROGRAMMING_ERROR(
                     pe
                 )
                 raise ne.with_traceback(tb) from None
         else:
             uri = normalize_local_file(path)
+            if self._supports_skip_upload_on_content_match:
+                kwargs = {"_skip_upload_on_content_match": skip_upload_on_content_match}
+            else:
+                kwargs = {}
             return self.run_query(
                 _build_put_statement(
                     uri,
                     stage_location,
                     dest_prefix,
                     parallel,
                     compress_data,
                     source_compression,
                     overwrite,
-                )
+                ),
+                **kwargs,
             )
 
     @_Decorator.log_msg_and_perf_telemetry("Uploading stream to stage")
     def upload_stream(
         self,
         input_stream: IO[bytes],
         stage_location: str,
         dest_filename: str,
         dest_prefix: str = "",
         parallel: int = 4,
         compress_data: bool = True,
         source_compression: str = "AUTO_DETECT",
         overwrite: bool = False,
         is_in_udf: bool = False,
+        skip_upload_on_content_match: bool = False,
     ) -> Optional[Dict[str, Any]]:
         uri = normalize_local_file(f"/tmp/placeholder/{dest_filename}")
         try:
             if is_in_stored_procedure():  # pragma: no cover
                 input_stream.seek(0)
                 target_path = _build_target_path(stage_location, dest_prefix)
                 try:
@@ -263,25 +277,32 @@
                 except ProgrammingError as pe:
                     tb = sys.exc_info()[2]
                     ne = SnowparkClientExceptionMessages.SQL_EXCEPTION_FROM_PROGRAMMING_ERROR(
                         pe
                     )
                     raise ne.with_traceback(tb) from None
             else:
+                if self._supports_skip_upload_on_content_match:
+                    kwargs = {
+                        "_skip_upload_on_content_match": skip_upload_on_content_match,
+                        "file_stream": input_stream,
+                    }
+                else:
+                    kwargs = {"file_stream": input_stream}
                 return self.run_query(
                     _build_put_statement(
                         uri,
                         stage_location,
                         dest_prefix,
                         parallel,
                         compress_data,
                         source_compression,
                         overwrite,
                     ),
-                    file_stream=input_stream,
+                    **kwargs,
                 )
         # If ValueError is raised and the stream is closed, we throw the error.
         # https://docs.python.org/3/library/io.html#io.IOBase.close
         except ValueError as ex:
             if input_stream.closed:
                 if is_in_udf:
                     raise SnowparkClientExceptionMessages.SERVER_UDF_UPLOAD_FILE_STREAM_CLOSED(
@@ -308,30 +329,33 @@
         block: bool = True,
         data_type: _AsyncResultType = _AsyncResultType.ROW,
         async_job_plan: Optional[
             SnowflakePlan
         ] = None,  # this argument is currently only used by AsyncJob
         log_on_exception: bool = False,
         case_sensitive: bool = True,
+        params: Optional[Sequence[Any]] = None,
         **kwargs,
     ) -> Union[Dict[str, Any], AsyncJob]:
         try:
             # Set SNOWPARK_SKIP_TXN_COMMIT_IN_DDL to True to avoid DDL commands to commit the open transaction
             if is_ddl_on_temp_object:
                 if not kwargs.get("_statement_params"):
                     kwargs["_statement_params"] = {}
                 kwargs["_statement_params"]["SNOWPARK_SKIP_TXN_COMMIT_IN_DDL"] = True
             if block:
-                results_cursor = self._cursor.execute(query, **kwargs)
+                results_cursor = self._cursor.execute(query, params=params, **kwargs)
                 self.notify_query_listeners(
                     QueryRecord(results_cursor.sfqid, results_cursor.query)
                 )
                 logger.debug(f"Execute query [queryID: {results_cursor.sfqid}] {query}")
             else:
-                results_cursor = self._cursor.execute_async(query, **kwargs)
+                results_cursor = self._cursor.execute_async(
+                    query, params=params, **kwargs
+                )
                 self.notify_query_listeners(
                     QueryRecord(results_cursor["queryId"], query)
                 )
                 logger.debug(
                     f"Execute async query [queryID: {results_cursor['queryId']}] {query}"
                 )
         except Exception as ex:
@@ -486,14 +510,19 @@
 $$"""
                 # In multiple queries scenario, we are unable to get the query id of former query, so we replace
                 # place holder with fucntion last_query_id() here
                 for q in plan.queries:
                     final_query = final_query.replace(
                         f"'{q.query_id_place_holder}'", "LAST_QUERY_ID()"
                     )
+                    if q.params:
+                        # TODO(SNOW-791242): Support this use case after migrating to use multi-statement from connector
+                        raise NotImplementedError(
+                            "Async multi-query dataframe using bind variable is not supported yet"
+                        )
 
                 result = self.run_query(
                     final_query,
                     to_pandas,
                     to_iter,
                     is_ddl_on_temp_object=plan.queries[0].is_ddl_on_temp_object,
                     block=block,
@@ -524,14 +553,15 @@
                             to_iter and (i == len(plan.queries) - 1),
                             is_ddl_on_temp_object=query.is_ddl_on_temp_object,
                             block=not is_last,
                             data_type=data_type,
                             async_job_plan=plan,
                             log_on_exception=log_on_exception,
                             case_sensitive=case_sensitive,
+                            params=query.params,
                             **kwargs,
                         )
                         placeholders[query.query_id_place_holder] = (
                             result["sfqid"] if not is_last else result.query_id
                         )
                         result_meta = self._cursor.description
                     if action_id < plan.session._last_canceled_id:
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/telemetry.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/telemetry.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/type_utils.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/type_utils.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/udf_utils.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/udf_utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -518,14 +518,15 @@
     parallel: int = 4,
     is_pandas_udf: bool = False,
     is_dataframe_input: bool = False,
     max_batch_size: Optional[int] = None,
     *,
     statement_params: Optional[Dict[str, str]] = None,
     source_code_display: bool = False,
+    skip_upload_on_content_match: bool = False,
 ) -> Tuple[str, str, str, str, str]:
     upload_stage = (
         unwrap_stage_location_single_quote(stage_location)
         if stage_location
         else session.get_session_stage()
     )
 
@@ -598,14 +599,15 @@
                     dest_filename=udf_file_name,
                     dest_prefix=dest_prefix,
                     parallel=parallel,
                     source_compression="DEFLATE",
                     compress_data=False,
                     overwrite=True,
                     is_in_udf=True,
+                    skip_upload_on_content_match=skip_upload_on_content_match
                 )
             all_urls.append(upload_file_stage_location)
             inline_code = None
             handler = f"{udf_file_name_base}.{_DEFAULT_HANDLER_NAME}"
         else:
             inline_code = code
             upload_file_stage_location = None
@@ -628,14 +630,15 @@
             session._conn.upload_file(
                 path=func[0],
                 stage_location=upload_stage,
                 dest_prefix=dest_prefix,
                 parallel=parallel,
                 compress_data=False,
                 overwrite=True,
+                skip_upload_on_content_match=skip_upload_on_content_match,
             )
             all_urls.append(upload_file_stage_location)
 
     # build imports and packages string
     all_imports = ",".join(
         [url if is_single_quoted(url) else f"'{url}'" for url in all_urls]
     )
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/_internal/utils.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -81,14 +81,19 @@
 ALPHANUMERIC = string.digits + string.ascii_lowercase
 
 # select and CTE (https://docs.snowflake.com/en/sql-reference/constructs/with.html) are select statements in Snowflake.
 SNOWFLAKE_SELECT_SQL_PREFIX_PATTERN = re.compile(
     r"^(\s|\()*(select|with)", re.IGNORECASE
 )
 
+# Anonymous stored procedures: https://docs.snowflake.com/en/sql-reference/sql/call-with
+SNOWFLAKE_ANONYMOUS_CALL_WITH_PATTERN = re.compile(
+    r"^\s*with\s+\w+\s+as\s+procedure", re.IGNORECASE
+)
+
 # A set of widely-used packages,
 # whose names in pypi are different from their package name
 PACKAGE_NAME_TO_MODULE_NAME_MAP = {
     "absl-py": "absl",
     "async-timeout": "async_timeout",
     "attrs": "attr",
     "brotlipy": "brotli",
@@ -169,14 +174,15 @@
     STAGE = "STAGE"
     FUNCTION = "FUNCTION"
     FILE_FORMAT = "FILE_FORMAT"
     QUERY_TAG = "QUERY_TAG"
     COLUMN = "COLUMN"
     PROCEDURE = "PROCEDURE"
     TABLE_FUNCTION = "TABLE_FUNCTION"
+    DYNAMIC_TABLE = "DYNAMIC_TABLE"
 
 
 def validate_object_name(name: str):
     if not SNOWFLAKE_OBJECT_RE_PATTERN.match(name):
         raise SnowparkClientExceptionMessages.GENERAL_INVALID_OBJECT_NAME(name)
 
 
@@ -220,15 +226,18 @@
     if is_single_quoted(new_name):
         new_name = new_name[1:-1]
     new_name = new_name.replace("\\'", "'")
     return new_name
 
 
 def is_sql_select_statement(sql: str) -> bool:
-    return SNOWFLAKE_SELECT_SQL_PREFIX_PATTERN.match(sql) is not None
+    return (
+        SNOWFLAKE_SELECT_SQL_PREFIX_PATTERN.match(sql) is not None
+        and SNOWFLAKE_ANONYMOUS_CALL_WITH_PATTERN.match(sql) is None
+    )
 
 
 def normalize_path(path: str, is_local: bool) -> str:
     """
     Get a normalized path of a local file or remote stage location for PUT/GET commands.
     If there are any special characters including spaces in the path, it needs to be
     quoted with single quote. For example, 'file:///tmp/load data' for a path containing
@@ -295,16 +304,16 @@
         path: The absolute path to a file or directory.
         leading_path: This argument is used to determine where directory should
             start in the zip file. Basically, this argument works as the role
             of `start` argument in os.path.relpath(path, start), i.e.,
             absolute path = [leading path]/[relative path]. For example,
             when the path is "/tmp/dir1/dir2/test.py", and the leading path
             is "/tmp/dir1", the generated filesystem structure in the zip file
-            will be "dir2/test.py".
-        add_init_py: Whether to add __init__.py along the compressed path.
+            will be "dir2/test.py". The leading path will compose a namespace package
+            that is used for zipimport on the server side.
         ignore_generated_py_file: Whether to ignore some generated python files
             in the directory.
 
     Returns:
         A byte stream.
     """
     if not os.path.exists(path):
@@ -315,14 +324,21 @@
     # and the compression will start from the parent directory
     start_path = leading_path if leading_path else os.path.join(path, "..")
 
     input_stream = io.BytesIO()
     with zipfile.ZipFile(
         input_stream, mode="w", compression=zipfile.ZIP_DEFLATED
     ) as zf:
+        # Write the folders on the leading path to the zip file to build a namespace package
+        cur_path = os.path.dirname(path)
+        while os.path.realpath(cur_path) != os.path.realpath(start_path):
+            # according to .zip file format specification, only / is valid
+            zf.writestr(f"{os.path.relpath(cur_path, start_path)}/", "")
+            cur_path = os.path.dirname(cur_path)
+
         if os.path.isdir(path):
             for dirname, _, files in os.walk(path):
                 # ignore __pycache__
                 if ignore_generated_py_file and "__pycache__" in dirname:
                     continue
                 zf.write(dirname, os.path.relpath(dirname, start_path))
                 for file in files:
@@ -332,23 +348,14 @@
                     ):
                         continue
                     filename = os.path.join(dirname, file)
                     zf.write(filename, os.path.relpath(filename, start_path))
         else:
             zf.write(path, os.path.relpath(path, start_path))
 
-        # __init__.py is needed for all directories along the import path
-        # when importing a module as a zip file
-        if add_init_py:
-            relative_path = os.path.relpath(path, start_path)
-            head, _ = os.path.split(relative_path)
-            while head and head != os.sep:
-                zf.writestr(os.path.join(head, "__init__.py"), "")
-                head, _ = os.path.split(head)
-
     yield input_stream
     input_stream.close()
 
 
 def parse_positional_args_to_list(*inputs: Any) -> List:
     """Convert the positional arguments to a list."""
     if len(inputs) == 1:
@@ -675,7 +682,24 @@
     copy_options = options.get("COPY_OPTIONS", {})
     for k, v in options.items():
         if k in COPY_OPTIONS:
             copy_options[k] = v
         elif k not in NON_FORMAT_TYPE_OPTIONS:
             file_format_type_options[k] = v
     return file_format_type_options, copy_options
+
+
+def strip_double_quotes_in_like_statement_in_table_name(table_name: str) -> str:
+    """
+    this function is used by method _table_exists to handle double quotes in table name when calling
+    SHOW TABLES LIKE
+    """
+    if not table_name or len(table_name) < 2:
+        return table_name
+
+    # escape double quotes, e.g. users pass """a.b""" as table name:
+    # df.write.save_as_table('"""a.b"""', mode="append")
+    # and we should call SHOW TABLES LIKE '"a.b"'
+    table_name = table_name.replace('""', '"')
+
+    # if table_name == '"a.b"', then we should call SHOW TABLES LIKE 'a.b'
+    return table_name[1:-1] if table_name[0] == table_name[-1] == '"' else table_name
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/async_job.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/async_job.py`

 * *Files 6% similar despite different names*

```diff
@@ -8,15 +8,14 @@
 
 import snowflake.snowpark
 from snowflake.connector.options import pandas
 from snowflake.snowpark._internal.analyzer.analyzer_utils import result_scan_statement
 from snowflake.snowpark._internal.analyzer.snowflake_plan import Query
 from snowflake.snowpark._internal.utils import (
     check_is_pandas_dataframe_in_to_pandas,
-    experimental,
     result_set_to_iter,
     result_set_to_rows,
 )
 from snowflake.snowpark.exceptions import SnowparkSQLException
 from snowflake.snowpark.functions import col
 from snowflake.snowpark.row import Row
 
@@ -122,14 +121,29 @@
         Cancel the running query associated with the dataframe::
 
             >>> df = session.sql("select SYSTEM$WAIT(3)")
             >>> async_job = df.collect_nowait()
             >>> async_job.cancel()
 
     Example 9
+        Executing queries asynchronously is faster than executing queries one by one::
+
+            >>> from time import time
+            >>> dfs = [session.sql("select SYSTEM$WAIT(1)") for _ in range(10)]
+            >>> start = time()
+            >>> res = [df.collect() for df in dfs]
+            >>> time1 = time() - start
+            >>> start = time()
+            >>> async_jobs = [df.collect_nowait() for df in dfs]
+            >>> res = [async_job.result() for async_job in async_jobs]
+            >>> time2 = time() - start
+            >>> time2 < time1
+            True
+
+    Example 10
         Creating an :class:`AsyncJob` from an existing query ID, retrieving results and converting it back to a :class:`DataFrame`:
 
             >>> from snowflake.snowpark.functions import col
             >>> query_id = session.sql("select 1 as A, 2 as B, 3 as C").collect_nowait().query_id
             >>> async_job = session.create_async_job(query_id)
             >>> async_job.query
             'select 1 as A, 2 as B, 3 as C'
@@ -212,15 +226,14 @@
                         self._can_query_be_retrieved = False
                         return None
                     else:
                         self._query = str(result[0][0])
 
             return self._query
 
-    @experimental(version="0.12.0")
     def to_df(self) -> "snowflake.snowpark.dataframe.DataFrame":
         """
         Returns a :class:`DataFrame` built from the result of this asynchronous job.
         """
         return self._session.sql(result_scan_statement(self.query_id))
 
     def is_done(self) -> bool:
@@ -287,15 +300,15 @@
         Blocks and waits until the query associated with this instance finishes, then returns query
         results. This acts like executing query in a synchronous way. The data type of returned
         query results is determined by how you create this :class:`AsyncJob` instance. For example,
         if this instance is returned by :meth:`DataFrame.collect_nowait`, you will get a list of
         :class:`Row` s from this method.
 
         Args:
-            result_type: (Experimental) specifies the data type of returned query results. Currently
+            result_type: Specifies the data type of returned query results. Currently
                 it only supports the following return data types:
 
                 - "row": returns a list of :class:`Row` objects, which is the same as the return
                   type of :meth:`DataFrame.collect`.
                 - "row_iterator": returns an iterator of :class:`Row` objects, which is the same as
                   the return type of :meth:`DataFrame.to_local_iterator`.
                 - "row": returns a ``pandas.DataFrame``, which is the same as the return type of
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/column.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/column.py`

 * *Files 0% similar despite different names*

```diff
@@ -732,14 +732,15 @@
     bitwiseOR = bitor
     bitwiseXOR = bitxor
     isNotNull = is_not_null
     isNull = is_null
     eqNullSafe = equal_null
     getName = get_name
     getItem = __getitem__
+    getField = __getitem__
 
 
 class CaseExpr(Column):
     """
     Represents a `CASE <https://docs.snowflake.com/en/sql-reference/functions/case.html>`_
     expression.
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/context.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/context.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe.py`

 * *Files 4% similar despite different names*

```diff
@@ -69,14 +69,15 @@
 from snowflake.snowpark._internal.analyzer.table_function import (
     FlattenFunction,
     Lateral,
     TableFunctionExpression,
     TableFunctionJoin,
 )
 from snowflake.snowpark._internal.analyzer.unary_plan_node import (
+    CreateDynamicTableCommand,
     CreateViewCommand,
     Filter,
     LocalTempView,
     PersistedView,
     Project,
     Sample,
     Sort,
@@ -107,14 +108,15 @@
     deprecated,
     generate_random_alphanumeric,
     get_copy_into_table_options,
     is_snowflake_quoted_id_case_insensitive,
     is_snowflake_unquoted_suffix_case_insensitive,
     is_sql_select_statement,
     parse_positional_args_to_list,
+    private_preview,
     random_name_for_temp_object,
     validate_object_name,
 )
 from snowflake.snowpark.async_job import AsyncJob, _AsyncResultType
 from snowflake.snowpark.column import Column, _to_col_if_sql_expr, _to_col_if_str
 from snowflake.snowpark.dataframe_na_functions import DataFrameNaFunctions
 from snowflake.snowpark.dataframe_stat_functions import DataFrameStatFunctions
@@ -134,14 +136,16 @@
     stddev,
     to_char,
 )
 from snowflake.snowpark.row import Row
 from snowflake.snowpark.table_function import (
     TableFunctionCall,
     _create_table_function_expression,
+    _ExplodeFunctionCall,
+    _get_cols_after_explode_join,
     _get_cols_after_join_table,
 )
 from snowflake.snowpark.types import StringType, StructType, _NumericType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
@@ -498,14 +502,15 @@
         self._session = session
         self._plan = self._session._analyzer.resolve(plan)
         if isinstance(plan, SelectStatement):
             self._select_statement = plan
             plan.expr_to_alias.update(self._plan.expr_to_alias)
         else:
             self._select_statement = None
+        self._statement_params = None
         self.is_cached: bool = is_cached  #: Whether the dataframe is cached.
 
         self._reader: Optional["snowflake.snowpark.DataFrameReader"] = None
         self._writer = DataFrameWriter(self)
 
         self._stat = DataFrameStatFunctions(self)
         self.approxQuantile = self.approx_quantile = self._stat.approx_quantile
@@ -616,15 +621,17 @@
         # we should always call this method instead of collect(), to make sure the
         # query tag is set properly.
         return self._session._conn.execute(
             self._plan,
             block=block,
             data_type=data_type,
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_THREE
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_THREE,
             ),
             log_on_exception=log_on_exception,
             case_sensitive=case_sensitive,
         )
 
     _internal_collect_with_tag = df_collect_api_telemetry(
         _internal_collect_with_tag_no_telemetry
@@ -634,15 +641,17 @@
     def _execute_and_get_query_id(
         self, *, statement_params: Optional[Dict[str, str]] = None
     ) -> str:
         """This method is only used in stored procedures."""
         return self._session._conn.get_result_query_id(
             self._plan,
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_THREE
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_THREE,
             ),
         )
 
     @overload
     def to_local_iterator(
         self, *, statement_params: Optional[Dict[str, str]] = None, block: bool = True
     ) -> Iterator[Row]:
@@ -680,15 +689,17 @@
         """
         return self._session._conn.execute(
             self._plan,
             to_iter=True,
             block=block,
             data_type=_AsyncResultType.ITERATOR,
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_THREE
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_THREE,
             ),
         )
 
     def __copy__(self) -> "DataFrame":
         return DataFrame(self._session, copy.copy(self._plan))
 
     if installed_pandas:
@@ -742,15 +753,17 @@
         """
         result = self._session._conn.execute(
             self._plan,
             to_pandas=True,
             block=block,
             data_type=_AsyncResultType.PANDAS,
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_TWO
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_TWO,
             ),
             **kwargs,
         )
 
         # if the returned result is not a pandas dataframe, raise Exception
         # this might happen when calling this method with non-select commands
         # e.g., session.sql("create ...").to_pandas()
@@ -822,15 +835,17 @@
         return self._session._conn.execute(
             self._plan,
             to_pandas=True,
             to_iter=True,
             block=block,
             data_type=_AsyncResultType.PANDAS_BATCH,
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_TWO
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_TWO,
             ),
             **kwargs,
         )
 
     @df_api_usage
     def to_df(self, *names: Union[str, Iterable[str]]) -> "DataFrame":
         """
@@ -976,24 +991,28 @@
                 names.append(e._named())
             elif isinstance(e, str):
                 names.append(Column(e)._named())
             elif isinstance(e, TableFunctionCall):
                 if table_func:
                     raise ValueError(
                         f"At most one table function can be called inside a select(). "
-                        f"Called '{table_func.name}' and '{e.name}'."
+                        f"Called '{table_func.user_visible_name}' and '{e.user_visible_name}'."
                     )
                 table_func = e
                 func_expr = _create_table_function_expression(func=table_func)
                 join_plan = self._session._analyzer.resolve(
                     TableFunctionJoin(self._plan, func_expr)
                 )
-                _, new_cols = _get_cols_after_join_table(
-                    func_expr, self._plan, join_plan
-                )
+
+                if isinstance(e, _ExplodeFunctionCall):
+                    new_cols = _get_cols_after_explode_join(e, self._plan)
+                else:
+                    _, new_cols = _get_cols_after_join_table(
+                        func_expr, self._plan, join_plan
+                    )
                 names.extend(new_cols)
             else:
                 raise TypeError(
                     "The input of select() must be Column, column name, TableFunctionCall, or a list of them"
                 )
         if self._select_statement:
             if join_plan:
@@ -2584,16 +2603,17 @@
             |id2           | Product B      |
             ---------------------------------
             <BLANKLINE>
 
         The arguments of this function match the optional parameters of the `COPY INTO <table> <https://docs.snowflake.com/en/sql-reference/sql/copy-into-table.html#optional-parameters>`__.
 
         Args:
-            table_name: A string or list of strings that specify the table name or fully-qualified object identifier
-                (database name, schema name, and table name).
+            table_name: A string or list of strings representing table name.
+                If input is a string, it represents the table name; if input is of type iterable of strings,
+                it represents the fully-qualified object identifier (database name, schema name, and table name).
             files: Specific files to load from the stage location.
             pattern: The regular expression that is used to match file names of the stage location.
             validation_mode: A ``str`` that instructs the ``COPY INTO <table>`` command to validate the data files instead of loading them into the specified table.
                 Values can be "RETURN_n_ROWS", "RETURN_ERRORS", or "RETURN_ALL_ERRORS". Refer to the above mentioned ``COPY INTO <table>`` command optional parameters for more details.
             target_columns: Name of the columns in the table where the data should be saved.
             transformations: A list of column transformations.
             format_type_options: A dict that contains the ``formatTypeOptions`` of the ``COPY INTO <table>`` command.
@@ -2659,15 +2679,15 @@
             ]
             if transformations
             else None
         )
         return DataFrame(
             self._session,
             CopyIntoTableNode(
-                full_table_name,
+                table_name,
                 file_path=self._reader._file_path,
                 files=files,
                 file_format=self._reader._file_type,
                 pattern=pattern,
                 column_names=normalized_column_names,
                 transformations=transformation_exps,
                 copy_options=copy_options,
@@ -2698,15 +2718,17 @@
             statement_params: Dictionary of statement level parameters to be set while executing this action.
         """
         print(
             self._show_string(
                 n,
                 max_width,
                 _statement_params=create_or_update_statement_params_with_query_tag(
-                    statement_params, self._session.query_tag, SKIP_LEVELS_TWO
+                    statement_params or self._statement_params,
+                    self._session.query_tag,
+                    SKIP_LEVELS_TWO,
                 ),
             )
         )
 
     @deprecated(
         version="0.7.0",
         extra_warning_text="Use `DataFrame.join_table_function()` instead.",
@@ -2915,14 +2937,69 @@
                 "The input of create_or_replace_view() can only a str or list of strs."
             )
 
         return self._do_create_or_replace_view(
             formatted_name,
             PersistedView(),
             _statement_params=create_or_update_statement_params_with_query_tag(
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_TWO,
+            ),
+        )
+
+    @df_collect_api_telemetry
+    @private_preview(version="1.4.0")
+    def create_or_replace_dynamic_table(
+        self,
+        name: Union[str, Iterable[str]],
+        *,
+        warehouse: str,
+        lag: str,
+        statement_params: Optional[Dict[str, str]] = None,
+    ) -> List[Row]:
+        """Creates a dynamic table that captures the computation expressed by this DataFrame.
+
+        For ``name``, you can include the database and schema name (i.e. specify a
+        fully-qualified name). If no database name or schema name are specified, the
+        dynamic table will be created in the current database or schema.
+
+        ``name`` must be a valid `Snowflake identifier <https://docs.snowflake.com/en/sql-reference/identifiers-syntax.html>`_.
+
+        Args:
+            name: The name of the dynamic table to create or replace. Can be a list of strings
+                that specifies the database name, schema name, and view name.
+            warehouse: The name of the warehouse used to refresh the dynamic table.
+            lag: specifies the target data freshness
+            statement_params: Dictionary of statement level parameters to be set while executing this action.
+        """
+        if isinstance(name, str):
+            formatted_name = name
+        elif isinstance(name, (list, tuple)) and all(isinstance(n, str) for n in name):
+            formatted_name = ".".join(name)
+        else:
+            raise TypeError(
+                "The name input of create_or_replace_dynamic_table() can only be a str or list of strs."
+            )
+
+        if not isinstance(warehouse, str):
+            raise TypeError(
+                "The warehouse input of create_or_replace_dynamic_table() can only be a str."
+            )
+
+        if not isinstance(lag, str):
+            raise TypeError(
+                "The lag input of create_or_replace_dynamic_table() can only be a str."
+            )
+
+        return self._do_create_or_replace_dynamic_table(
+            formatted_name,
+            warehouse,
+            lag,
+            _statement_params=create_or_update_statement_params_with_query_tag(
                 statement_params, self._session.query_tag, SKIP_LEVELS_TWO
             ),
         )
 
     @df_collect_api_telemetry
     def create_or_replace_temp_view(
         self,
@@ -2956,15 +3033,17 @@
                 "The input of create_or_replace_temp_view() can only a str or list of strs."
             )
 
         return self._do_create_or_replace_view(
             formatted_name,
             LocalTempView(),
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_TWO
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_TWO,
             ),
         )
 
     def _do_create_or_replace_view(self, view_name: str, view_type: ViewType, **kwargs):
         validate_object_name(view_name)
         cmd = CreateViewCommand(
             view_name,
@@ -2972,14 +3051,29 @@
             self._plan,
         )
 
         return self._session._conn.execute(
             self._session._analyzer.resolve(cmd), **kwargs
         )
 
+    def _do_create_or_replace_dynamic_table(
+        self, name: str, warehouse: str, lag: str, **kwargs
+    ):
+        validate_object_name(name)
+        cmd = CreateDynamicTableCommand(
+            name,
+            warehouse,
+            lag,
+            self._plan,
+        )
+
+        return self._session._conn.execute(
+            self._session._analyzer.resolve(cmd), **kwargs
+        )
+
     @overload
     def first(
         self,
         n: Optional[int] = None,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         block: bool = True,
@@ -3302,15 +3396,17 @@
             self._plan,
             use_scoped_temp_objects=self._session._use_scoped_temp_objects,
             is_generated=True,
         )
         self._session._conn.execute(
             create_temp_table,
             _statement_params=create_or_update_statement_params_with_query_tag(
-                statement_params, self._session.query_tag, SKIP_LEVELS_TWO
+                statement_params or self._statement_params,
+                self._session.query_tag,
+                SKIP_LEVELS_TWO,
             ),
         )
         cached_df = self._session.table(temp_table_name)
         cached_df.is_cached = True
         return cached_df
 
     @df_collect_api_telemetry
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_na_functions.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_na_functions.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_reader.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_reader.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_stat_functions.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_stat_functions.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/dataframe_writer.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_writer.py`

 * *Files 6% similar despite different names*

```diff
@@ -114,16 +114,17 @@
         table_type: Literal["", "temp", "temporary", "transient"] = "",
         statement_params: Optional[Dict[str, str]] = None,
         block: bool = True,
     ) -> Optional[AsyncJob]:
         """Writes the data to the specified table in a Snowflake database.
 
         Args:
-            table_name: A string or list of strings that specify the table name or fully-qualified object identifier
-                (database name, schema name, and table name).
+            table_name: A string or list of strings representing table name.
+                If input is a string, it represents the table name; if input is of type iterable of strings,
+                it represents the fully-qualified object identifier (database name, schema name, and table name).
             mode: One of the following values. When it's ``None`` or not provided,
                 the save mode set by :meth:`mode` is used.
 
                 "append": Append data of this DataFrame to existing data.
 
                 "overwrite": Overwrite existing data.
 
@@ -137,15 +138,15 @@
                 "name": Data will be inserted into the target table by matching column names. If the target table has more columns than the source DataFrame, use this one.
 
             create_temp_table: (Deprecated) The to-be-created table will be temporary if this is set to ``True``.
             table_type: The table type of table to be created. The supported values are: ``temp``, ``temporary``,
                         and ``transient``. An empty string means to create a permanent table. Learn more about table
                         types `here <https://docs.snowflake.com/en/user-guide/tables-temp-transient.html>`_.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
-            block: (Experimental) A bool value indicating whether this function will wait until the result is available.
+            block: A bool value indicating whether this function will wait until the result is available.
                 When it is ``False``, this function executes the underlying queries of the dataframe
                 asynchronously and returns an :class:`AsyncJob`.
 
         Examples::
 
             >>> df = session.create_dataframe([[1,2],[3,4]], schema=["a", "b"])
             >>> df.write.mode("overwrite").save_as_table("my_table", table_type="temporary")
@@ -154,20 +155,14 @@
             >>> df.write.save_as_table("my_table", mode="append", table_type="temporary")
             >>> session.table("my_table").collect()
             [Row(A=1, B=2), Row(A=3, B=4), Row(A=1, B=2), Row(A=3, B=4)]
             >>> df.write.mode("overwrite").save_as_table("my_transient_table", table_type="transient")
             >>> session.table("my_transient_table").collect()
             [Row(A=1, B=2), Row(A=3, B=4)]
         """
-        if not block:
-            warning(
-                "save_as_table.block",
-                "block argument is experimental. Do not use it in production.",
-            )
-
         save_mode = (
             str_to_enum(mode.lower(), SaveMode, "'mode'") if mode else self._save_mode
         )
         full_table_name = (
             table_name if isinstance(table_name, str) else ".".join(table_name)
         )
         validate_object_name(full_table_name)
@@ -187,15 +182,15 @@
 
         if table_type and table_type.lower() not in SUPPORTED_TABLE_TYPES:
             raise ValueError(
                 f"Unsupported table type. Expected table types: {SUPPORTED_TABLE_TYPES}"
             )
 
         create_table_logic_plan = SnowflakeCreateTable(
-            full_table_name,
+            table_name,
             column_names,
             save_mode,
             self._dataframe._plan,
             table_type,
         )
         session = self._dataframe._session
         snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
@@ -259,15 +254,15 @@
             partition_by: Specifies an expression used to partition the unloaded table rows into separate files. It can be a :class:`Column`, a column name, or a SQL expression.
             file_format_name: Specifies an existing named file format to use for unloading data from the table. The named file format determines the format type (CSV, JSON, PARQUET), as well as any other format options, for the data files.
             file_format_type: Specifies the type of files unloaded from the table. If a format type is specified, additional format-specific options can be specified in ``format_type_options``.
             format_type_options: Depending on the ``file_format_type`` specified, you can include more format specific options. Use the options documented in the `Format Type Options <https://docs.snowflake.com/en/sql-reference/sql/copy-into-location.html#format-type-options-formattypeoptions>`__.
             header: Specifies whether to include the table column headings in the output files.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
             copy_options: The kwargs that are used to specify the copy options. Use the options documented in the `Copy Options <https://docs.snowflake.com/en/sql-reference/sql/copy-into-location.html#copy-options-copyoptions>`__.
-            block: (Experimental) A bool value indicating whether this function will wait until the result is available.
+            block: A bool value indicating whether this function will wait until the result is available.
                 When it is ``False``, this function executes the underlying queries of the dataframe
                 asynchronously and returns an :class:`AsyncJob`.
 
         Returns:
             A list of :class:`Row` objects containing unloading results.
 
         Example::
@@ -289,20 +284,14 @@
             pyarrow.Table
             FIRST_NAME: string not null
             LAST_NAME: string not null
             ----
             FIRST_NAME: [["John","Rick","Anthony"]]
             LAST_NAME: [["Berry","Berry","Davis"]]
         """
-        if not block:
-            warning(
-                "copy_into_location.block",
-                "block argument is experimental. Do not use it in production.",
-            )
-
         stage_location = normalize_remote_file_or_dir(location)
         if isinstance(partition_by, str):
             partition_by = sql_expr(partition_by)._expression
         elif isinstance(partition_by, Column):
             partition_by = partition_by._expression
         elif partition_by is not None:
             raise TypeError(  # pragma: no cover
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/exceptions.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/exceptions.py`

 * *Files 1% similar despite different names*

```diff
@@ -162,14 +162,23 @@
 
     Includes error codes: 1203, 1204, 1205, 1206.
     """
 
     pass
 
 
+class SnowparkCreateDynamicTableException(SnowparkPlanException):
+    """Exception for errors while trying to create a dynamic table.
+
+    Includes error codes: 1207, 1208.
+    """
+
+    pass
+
+
 class SnowparkSQLAmbiguousJoinException(SnowparkSQLException):
     """Exception for ambiguous joins that are created from the
     translated SQL statement.
 
     Includes error codes: 1303.
     """
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/file_operation.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/file_operation.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/files.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/files.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/functions.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/functions.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,14288 +1,16399 @@
 00000000: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
 00000010: 7974 686f 6e33 0a23 0a23 2043 6f70 7972  ython3.#.# Copyr
 00000020: 6967 6874 2028 6329 2032 3031 322d 3230  ight (c) 2012-20
 00000030: 3233 2053 6e6f 7766 6c61 6b65 2043 6f6d  23 Snowflake Com
 00000040: 7075 7469 6e67 2049 6e63 2e20 416c 6c20  puting Inc. All 
 00000050: 7269 6768 7473 2072 6573 6572 7665 642e  rights reserved.
-00000060: 0a23 0a0a 2222 220a 5072 6f76 6964 6573  .#..""".Provides
-00000070: 2075 7469 6c69 7479 2061 6e64 2053 514c   utility and SQL
-00000080: 2066 756e 6374 696f 6e73 2074 6861 7420   functions that 
-00000090: 6765 6e65 7261 7465 203a 636c 6173 733a  generate :class:
-000000a0: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-000000b0: 7061 726b 2e43 6f6c 756d 6e60 2065 7870  park.Column` exp
-000000c0: 7265 7373 696f 6e73 2074 6861 7420 796f  ressions that yo
-000000d0: 7520 6361 6e20 7061 7373 2074 6f20 3a63  u can pass to :c
-000000e0: 6c61 7373 3a60 7e73 6e6f 7766 6c61 6b65  lass:`~snowflake
-000000f0: 2e73 6e6f 7770 6172 6b2e 4461 7461 4672  .snowpark.DataFr
-00000100: 616d 6560 2074 7261 6e73 666f 726d 6174  ame` transformat
-00000110: 696f 6e20 6d65 7468 6f64 732e 0a0a 5468  ion methods...Th
-00000120: 6573 6520 7574 696c 6974 7920 6675 6e63  ese utility func
-00000130: 7469 6f6e 7320 6765 6e65 7261 7465 2072  tions generate r
-00000140: 6566 6572 656e 6365 7320 746f 2063 6f6c  eferences to col
-00000150: 756d 6e73 2c20 6c69 7465 7261 6c73 2c20  umns, literals, 
-00000160: 616e 6420 5351 4c20 6578 7072 6573 7369  and SQL expressi
-00000170: 6f6e 7320 2865 2e67 2e20 2263 202b 2031  ons (e.g. "c + 1
-00000180: 2229 2e0a 0a20 202d 2055 7365 203a 6675  ")...  - Use :fu
-00000190: 6e63 3a60 636f 6c28 2960 2074 6f20 636f  nc:`col()` to co
-000001a0: 6e76 6572 7420 6120 636f 6c75 6d6e 206e  nvert a column n
-000001b0: 616d 6520 746f 2061 203a 636c 6173 733a  ame to a :class:
-000001c0: 6043 6f6c 756d 6e60 206f 626a 6563 742e  `Column` object.
-000001d0: 2052 6566 6572 2074 6f20 7468 6520 4150   Refer to the AP
-000001e0: 4920 646f 6373 206f 6620 3a63 6c61 7373  I docs of :class
-000001f0: 3a60 436f 6c75 6d6e 6020 746f 206b 6e6f  :`Column` to kno
-00000200: 7720 6d6f 7265 2077 6179 7320 6f66 2072  w more ways of r
-00000210: 6566 6572 656e 6369 6e67 2061 2063 6f6c  eferencing a col
-00000220: 756d 6e2e 0a20 202d 2055 7365 203a 6675  umn..  - Use :fu
-00000230: 6e63 3a60 6c69 7428 2960 2074 6f20 636f  nc:`lit()` to co
-00000240: 6e76 6572 7420 6120 5079 7468 6f6e 2076  nvert a Python v
-00000250: 616c 7565 2074 6f20 6120 3a63 6c61 7373  alue to a :class
-00000260: 3a60 436f 6c75 6d6e 6020 6f62 6a65 6374  :`Column` object
-00000270: 2074 6861 7420 7265 7072 6573 656e 7473   that represents
-00000280: 2061 2063 6f6e 7374 616e 7420 7661 6c75   a constant valu
-00000290: 6520 696e 2053 6e6f 7766 6c61 6b65 2053  e in Snowflake S
-000002a0: 514c 2e0a 2020 2d20 5573 6520 3a66 756e  QL..  - Use :fun
-000002b0: 633a 6073 716c 5f65 7870 7228 2960 2074  c:`sql_expr()` t
-000002c0: 6f20 636f 6e76 6572 7420 6120 536e 6f77  o convert a Snow
-000002d0: 666c 616b 6520 5351 4c20 6578 7072 6573  flake SQL expres
-000002e0: 7369 6f6e 2074 6f20 6120 3a63 6c61 7373  sion to a :class
-000002f0: 3a60 436f 6c75 6d6e 602e 0a0a 2020 2020  :`Column`...    
-00000300: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00000310: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00000320: 6528 5b5b 312c 2027 6127 2c20 5472 7565  e([[1, 'a', True
-00000330: 2c20 2732 3032 322d 3033 2d31 3627 5d2c  , '2022-03-16'],
-00000340: 205b 332c 2027 6227 2c20 4661 6c73 652c   [3, 'b', False,
-00000350: 2027 3230 3233 2d30 342d 3137 275d 5d2c   '2023-04-17']],
-00000360: 2073 6368 656d 613d 5b22 6122 2c20 2262   schema=["a", "b
-00000370: 222c 2022 6322 2c20 2264 225d 290a 2020  ", "c", "d"]).  
-00000380: 2020 3e3e 3e20 7265 7331 203d 2064 662e    >>> res1 = df.
-00000390: 6669 6c74 6572 2863 6f6c 2822 6122 2920  filter(col("a") 
-000003a0: 3d3d 2031 292e 636f 6c6c 6563 7428 290a  == 1).collect().
-000003b0: 2020 2020 3e3e 3e20 7265 7332 203d 2064      >>> res2 = d
-000003c0: 662e 6669 6c74 6572 286c 6974 2831 2920  f.filter(lit(1) 
-000003d0: 3d3d 2063 6f6c 2822 6122 2929 2e63 6f6c  == col("a")).col
-000003e0: 6c65 6374 2829 0a20 2020 203e 3e3e 2072  lect().    >>> r
-000003f0: 6573 3320 3d20 6466 2e66 696c 7465 7228  es3 = df.filter(
-00000400: 7371 6c5f 6578 7072 2822 6120 3d20 3122  sql_expr("a = 1"
-00000410: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00000420: 203e 3e3e 2061 7373 6572 7420 7265 7331   >>> assert res1
-00000430: 203d 3d20 7265 7332 203d 3d20 7265 7333   == res2 == res3
-00000440: 0a20 2020 203e 3e3e 2072 6573 310a 2020  .    >>> res1.  
-00000450: 2020 5b52 6f77 2841 3d31 2c20 423d 2761    [Row(A=1, B='a
-00000460: 272c 2043 3d54 7275 652c 2044 3d27 3230  ', C=True, D='20
-00000470: 3232 2d30 332d 3136 2729 5d0a 0a53 6f6d  22-03-16')]..Som
-00000480: 6520 3a63 6c61 7373 3a60 4461 7461 4672  e :class:`DataFr
-00000490: 616d 6560 206d 6574 686f 6473 2061 6363  ame` methods acc
-000004a0: 6570 7420 636f 6c75 6d6e 206e 616d 6573  ept column names
-000004b0: 206f 7220 5351 4c20 6578 7072 6573 7369   or SQL expressi
-000004c0: 6f6e 7320 7465 7874 2061 7369 6465 2066  ons text aside f
-000004d0: 726f 6d20 6120 436f 6c75 6d6e 206f 626a  rom a Column obj
-000004e0: 6563 7420 666f 7220 636f 6e76 656e 6965  ect for convenie
-000004f0: 6e63 652e 0a46 6f72 2069 6e73 7461 6e63  nce..For instanc
-00000500: 653a 0a0a 2020 2020 3e3e 3e20 6466 2e66  e:..    >>> df.f
-00000510: 696c 7465 7228 2261 203d 2031 2229 2e63  ilter("a = 1").c
-00000520: 6f6c 6c65 6374 2829 2020 2320 7573 6520  ollect()  # use 
-00000530: 7468 6520 5351 4c20 6578 7072 6573 7369  the SQL expressi
-00000540: 6f6e 2064 6972 6563 746c 7920 696e 2066  on directly in f
-00000550: 696c 7465 720a 2020 2020 5b52 6f77 2841  ilter.    [Row(A
-00000560: 3d31 2c20 423d 2761 272c 2043 3d54 7275  =1, B='a', C=Tru
-00000570: 652c 2044 3d27 3230 3232 2d30 332d 3136  e, D='2022-03-16
-00000580: 2729 5d0a 2020 2020 3e3e 3e20 6466 2e73  ')].    >>> df.s
-00000590: 656c 6563 7428 2261 2229 2e63 6f6c 6c65  elect("a").colle
-000005a0: 6374 2829 0a20 2020 205b 526f 7728 413d  ct().    [Row(A=
-000005b0: 3129 2c20 526f 7728 413d 3329 5d0a 0a77  1), Row(A=3)]..w
-000005c0: 6865 7265 6173 203a 636c 6173 733a 6043  hereas :class:`C
-000005d0: 6f6c 756d 6e60 206f 626a 6563 7473 2065  olumn` objects e
-000005e0: 6e61 626c 6520 796f 7520 746f 2075 7365  nable you to use
-000005f0: 2063 6861 696e 6564 2063 6f6c 756d 6e20   chained column 
-00000600: 6f70 6572 6174 6f72 7320 616e 6420 7472  operators and tr
-00000610: 616e 7366 6f72 6d61 7469 6f6e 7320 7769  ansformations wi
-00000620: 7468 0a50 7974 686f 6e20 636f 6465 2066  th.Python code f
-00000630: 6c75 656e 746c 793a 0a0a 2020 2020 3e3e  luently:..    >>
-00000640: 3e20 2320 5573 6520 636f 6c75 6d6e 7320  > # Use columns 
-00000650: 616e 6420 6c69 7465 7261 6c73 2069 6e20  and literals in 
-00000660: 6578 7072 6573 7369 6f6e 732e 0a20 2020  expressions..   
-00000670: 203e 3e3e 2064 662e 7365 6c65 6374 2828   >>> df.select((
-00000680: 2863 6f6c 2822 6122 2920 2b20 3129 2e63  (col("a") + 1).c
-00000690: 6173 7428 2273 7472 696e 6722 2929 2e61  ast("string")).a
-000006a0: 6c69 6173 2822 6164 645f 6f6e 6522 2929  lias("add_one"))
-000006b0: 2e73 686f 7728 290a 2020 2020 2d2d 2d2d  .show().    ----
-000006c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22  ---------.    |"
-000006d0: 4144 445f 4f4e 4522 2020 7c0a 2020 2020  ADD_ONE"  |.    
-000006e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000006f0: 2020 7c32 2020 2020 2020 2020 2020 7c0a    |2          |.
-00000700: 2020 2020 7c34 2020 2020 2020 2020 2020      |4          
-00000710: 7c0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  |.    ----------
-00000720: 2d2d 2d0a 2020 2020 3c42 4c41 4e4b 4c49  ---.    <BLANKLI
-00000730: 4e45 3e0a 0a54 6865 2053 6e6f 7766 6c61  NE>..The Snowfla
-00000740: 6b65 2064 6174 6162 6173 6520 6861 7320  ke database has 
-00000750: 6875 6e64 7265 6473 206f 6620 6053 514c  hundreds of `SQL
-00000760: 2066 756e 6374 696f 6e73 203c 6874 7470   functions <http
-00000770: 733a 2f2f 646f 6373 2e73 6e6f 7766 6c61  s://docs.snowfla
-00000780: 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d 7265  ke.com/en/sql-re
-00000790: 6665 7265 6e63 652d 6675 6e63 7469 6f6e  ference-function
-000007a0: 732e 6874 6d6c 3e60 5f0a 5468 6973 206d  s.html>`_.This m
-000007b0: 6f64 756c 6520 7072 6f76 6964 6573 2050  odule provides P
-000007c0: 7974 686f 6e20 6675 6e63 7469 6f6e 7320  ython functions 
-000007d0: 7468 6174 2063 6f72 7265 7370 6f6e 6420  that correspond 
-000007e0: 746f 2074 6865 2053 6e6f 7766 6c61 6b65  to the Snowflake
-000007f0: 2053 514c 2066 756e 6374 696f 6e73 2e20   SQL functions. 
-00000800: 5468 6579 2074 7970 6963 616c 6c79 2061  They typically a
-00000810: 6363 6570 7420 3a63 6c61 7373 3a60 436f  ccept :class:`Co
-00000820: 6c75 6d6e 600a 6f62 6a65 6374 7320 6f72  lumn`.objects or
-00000830: 2063 6f6c 756d 6e20 6e61 6d65 7320 6173   column names as
-00000840: 2069 6e70 7574 2070 6172 616d 6574 6572   input parameter
-00000850: 7320 616e 6420 7265 7475 726e 2061 206e  s and return a n
-00000860: 6577 203a 636c 6173 733a 6043 6f6c 756d  ew :class:`Colum
-00000870: 6e60 206f 626a 6563 7473 2e0a 5468 6520  n` objects..The 
-00000880: 666f 6c6c 6f77 696e 6720 6578 616d 706c  following exampl
-00000890: 6573 2064 656d 6f6e 7374 7261 7465 2074  es demonstrate t
-000008a0: 6865 2075 7365 206f 6620 736f 6d65 206f  he use of some o
-000008b0: 6620 7468 6573 6520 6675 6e63 7469 6f6e  f these function
-000008c0: 733a 0a0a 2020 2020 3e3e 3e20 2320 5468  s:..    >>> # Th
-000008d0: 6973 2065 7861 6d70 6c65 2063 616c 6c73  is example calls
-000008e0: 2074 6865 2066 756e 6374 696f 6e20 7468   the function th
-000008f0: 6174 2063 6f72 7265 7370 6f6e 6473 2074  at corresponds t
-00000900: 6f20 7468 6520 544f 5f44 4154 4528 2920  o the TO_DATE() 
-00000910: 5351 4c20 6675 6e63 7469 6f6e 2e0a 2020  SQL function..  
-00000920: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00000930: 6461 7465 6164 6428 2764 6179 272c 206c  dateadd('day', l
-00000940: 6974 2831 292c 2074 6f5f 6461 7465 2863  it(1), to_date(c
-00000950: 6f6c 2822 6422 2929 2929 2e73 686f 7728  ol("d")))).show(
-00000960: 290a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ).    ----------
-00000970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00000990: 2020 7c22 4441 5445 4144 4428 2744 4159    |"DATEADD('DAY
-000009a0: 272c 2031 2c20 544f 5f44 4154 4528 2222  ', 1, TO_DATE(""
-000009b0: 4422 2229 2922 2020 7c0a 2020 2020 2d2d  D""))"  |.    --
+00000060: 0a23 0a0a 6672 6f6d 2073 6e6f 7766 6c61  .#..from snowfla
+00000070: 6b65 2e73 6e6f 7770 6172 6b2e 7461 626c  ke.snowpark.tabl
+00000080: 655f 6675 6e63 7469 6f6e 2069 6d70 6f72  e_function impor
+00000090: 7420 5461 626c 6546 756e 6374 696f 6e43  t TableFunctionC
+000000a0: 616c 6c2c 205f 4578 706c 6f64 6546 756e  all, _ExplodeFun
+000000b0: 6374 696f 6e43 616c 6c0a 0a22 2222 0a50  ctionCall..""".P
+000000c0: 726f 7669 6465 7320 7574 696c 6974 7920  rovides utility 
+000000d0: 616e 6420 5351 4c20 6675 6e63 7469 6f6e  and SQL function
+000000e0: 7320 7468 6174 2067 656e 6572 6174 6520  s that generate 
+000000f0: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
+00000100: 6b65 2e73 6e6f 7770 6172 6b2e 436f 6c75  ke.snowpark.Colu
+00000110: 6d6e 6020 6578 7072 6573 7369 6f6e 7320  mn` expressions 
+00000120: 7468 6174 2079 6f75 2063 616e 2070 6173  that you can pas
+00000130: 7320 746f 203a 636c 6173 733a 607e 736e  s to :class:`~sn
+00000140: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00000150: 2e44 6174 6146 7261 6d65 6020 7472 616e  .DataFrame` tran
+00000160: 7366 6f72 6d61 7469 6f6e 206d 6574 686f  sformation metho
+00000170: 6473 2e0a 0a54 6865 7365 2075 7469 6c69  ds...These utili
+00000180: 7479 2066 756e 6374 696f 6e73 2067 656e  ty functions gen
+00000190: 6572 6174 6520 7265 6665 7265 6e63 6573  erate references
+000001a0: 2074 6f20 636f 6c75 6d6e 732c 206c 6974   to columns, lit
+000001b0: 6572 616c 732c 2061 6e64 2053 514c 2065  erals, and SQL e
+000001c0: 7870 7265 7373 696f 6e73 2028 652e 672e  xpressions (e.g.
+000001d0: 2022 6320 2b20 3122 292e 0a0a 2020 2d20   "c + 1")...  - 
+000001e0: 5573 6520 3a66 756e 633a 6063 6f6c 2829  Use :func:`col()
+000001f0: 6020 746f 2063 6f6e 7665 7274 2061 2063  ` to convert a c
+00000200: 6f6c 756d 6e20 6e61 6d65 2074 6f20 6120  olumn name to a 
+00000210: 3a63 6c61 7373 3a60 436f 6c75 6d6e 6020  :class:`Column` 
+00000220: 6f62 6a65 6374 2e20 5265 6665 7220 746f  object. Refer to
+00000230: 2074 6865 2041 5049 2064 6f63 7320 6f66   the API docs of
+00000240: 203a 636c 6173 733a 6043 6f6c 756d 6e60   :class:`Column`
+00000250: 2074 6f20 6b6e 6f77 206d 6f72 6520 7761   to know more wa
+00000260: 7973 206f 6620 7265 6665 7265 6e63 696e  ys of referencin
+00000270: 6720 6120 636f 6c75 6d6e 2e0a 2020 2d20  g a column..  - 
+00000280: 5573 6520 3a66 756e 633a 606c 6974 2829  Use :func:`lit()
+00000290: 6020 746f 2063 6f6e 7665 7274 2061 2050  ` to convert a P
+000002a0: 7974 686f 6e20 7661 6c75 6520 746f 2061  ython value to a
+000002b0: 203a 636c 6173 733a 6043 6f6c 756d 6e60   :class:`Column`
+000002c0: 206f 626a 6563 7420 7468 6174 2072 6570   object that rep
+000002d0: 7265 7365 6e74 7320 6120 636f 6e73 7461  resents a consta
+000002e0: 6e74 2076 616c 7565 2069 6e20 536e 6f77  nt value in Snow
+000002f0: 666c 616b 6520 5351 4c2e 0a20 202d 2055  flake SQL..  - U
+00000300: 7365 203a 6675 6e63 3a60 7371 6c5f 6578  se :func:`sql_ex
+00000310: 7072 2829 6020 746f 2063 6f6e 7665 7274  pr()` to convert
+00000320: 2061 2053 6e6f 7766 6c61 6b65 2053 514c   a Snowflake SQL
+00000330: 2065 7870 7265 7373 696f 6e20 746f 2061   expression to a
+00000340: 203a 636c 6173 733a 6043 6f6c 756d 6e60   :class:`Column`
+00000350: 2e0a 0a20 2020 203e 3e3e 2064 6620 3d20  ...    >>> df = 
+00000360: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00000370: 6174 6166 7261 6d65 285b 5b31 2c20 2761  ataframe([[1, 'a
+00000380: 272c 2054 7275 652c 2027 3230 3232 2d30  ', True, '2022-0
+00000390: 332d 3136 275d 2c20 5b33 2c20 2762 272c  3-16'], [3, 'b',
+000003a0: 2046 616c 7365 2c20 2732 3032 332d 3034   False, '2023-04
+000003b0: 2d31 3727 5d5d 2c20 7363 6865 6d61 3d5b  -17']], schema=[
+000003c0: 2261 222c 2022 6222 2c20 2263 222c 2022  "a", "b", "c", "
+000003d0: 6422 5d29 0a20 2020 203e 3e3e 2072 6573  d"]).    >>> res
+000003e0: 3120 3d20 6466 2e66 696c 7465 7228 636f  1 = df.filter(co
+000003f0: 6c28 2261 2229 203d 3d20 3129 2e63 6f6c  l("a") == 1).col
+00000400: 6c65 6374 2829 0a20 2020 203e 3e3e 2072  lect().    >>> r
+00000410: 6573 3220 3d20 6466 2e66 696c 7465 7228  es2 = df.filter(
+00000420: 6c69 7428 3129 203d 3d20 636f 6c28 2261  lit(1) == col("a
+00000430: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00000440: 2020 3e3e 3e20 7265 7333 203d 2064 662e    >>> res3 = df.
+00000450: 6669 6c74 6572 2873 716c 5f65 7870 7228  filter(sql_expr(
+00000460: 2261 203d 2031 2229 292e 636f 6c6c 6563  "a = 1")).collec
+00000470: 7428 290a 2020 2020 3e3e 3e20 6173 7365  t().    >>> asse
+00000480: 7274 2072 6573 3120 3d3d 2072 6573 3220  rt res1 == res2 
+00000490: 3d3d 2072 6573 330a 2020 2020 3e3e 3e20  == res3.    >>> 
+000004a0: 7265 7331 0a20 2020 205b 526f 7728 413d  res1.    [Row(A=
+000004b0: 312c 2042 3d27 6127 2c20 433d 5472 7565  1, B='a', C=True
+000004c0: 2c20 443d 2732 3032 322d 3033 2d31 3627  , D='2022-03-16'
+000004d0: 295d 0a0a 536f 6d65 203a 636c 6173 733a  )]..Some :class:
+000004e0: 6044 6174 6146 7261 6d65 6020 6d65 7468  `DataFrame` meth
+000004f0: 6f64 7320 6163 6365 7074 2063 6f6c 756d  ods accept colum
+00000500: 6e20 6e61 6d65 7320 6f72 2053 514c 2065  n names or SQL e
+00000510: 7870 7265 7373 696f 6e73 2074 6578 7420  xpressions text 
+00000520: 6173 6964 6520 6672 6f6d 2061 2043 6f6c  aside from a Col
+00000530: 756d 6e20 6f62 6a65 6374 2066 6f72 2063  umn object for c
+00000540: 6f6e 7665 6e69 656e 6365 2e0a 466f 7220  onvenience..For 
+00000550: 696e 7374 616e 6365 3a0a 0a20 2020 203e  instance:..    >
+00000560: 3e3e 2064 662e 6669 6c74 6572 2822 6120  >> df.filter("a 
+00000570: 3d20 3122 292e 636f 6c6c 6563 7428 2920  = 1").collect() 
+00000580: 2023 2075 7365 2074 6865 2053 514c 2065   # use the SQL e
+00000590: 7870 7265 7373 696f 6e20 6469 7265 6374  xpression direct
+000005a0: 6c79 2069 6e20 6669 6c74 6572 0a20 2020  ly in filter.   
+000005b0: 205b 526f 7728 413d 312c 2042 3d27 6127   [Row(A=1, B='a'
+000005c0: 2c20 433d 5472 7565 2c20 443d 2732 3032  , C=True, D='202
+000005d0: 322d 3033 2d31 3627 295d 0a20 2020 203e  2-03-16')].    >
+000005e0: 3e3e 2064 662e 7365 6c65 6374 2822 6122  >> df.select("a"
+000005f0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00000600: 5b52 6f77 2841 3d31 292c 2052 6f77 2841  [Row(A=1), Row(A
+00000610: 3d33 295d 0a0a 7768 6572 6561 7320 3a63  =3)]..whereas :c
+00000620: 6c61 7373 3a60 436f 6c75 6d6e 6020 6f62  lass:`Column` ob
+00000630: 6a65 6374 7320 656e 6162 6c65 2079 6f75  jects enable you
+00000640: 2074 6f20 7573 6520 6368 6169 6e65 6420   to use chained 
+00000650: 636f 6c75 6d6e 206f 7065 7261 746f 7273  column operators
+00000660: 2061 6e64 2074 7261 6e73 666f 726d 6174   and transformat
+00000670: 696f 6e73 2077 6974 680a 5079 7468 6f6e  ions with.Python
+00000680: 2063 6f64 6520 666c 7565 6e74 6c79 3a0a   code fluently:.
+00000690: 0a20 2020 203e 3e3e 2023 2055 7365 2063  .    >>> # Use c
+000006a0: 6f6c 756d 6e73 2061 6e64 206c 6974 6572  olumns and liter
+000006b0: 616c 7320 696e 2065 7870 7265 7373 696f  als in expressio
+000006c0: 6e73 2e0a 2020 2020 3e3e 3e20 6466 2e73  ns..    >>> df.s
+000006d0: 656c 6563 7428 2828 636f 6c28 2261 2229  elect(((col("a")
+000006e0: 202b 2031 292e 6361 7374 2822 7374 7269   + 1).cast("stri
+000006f0: 6e67 2229 292e 616c 6961 7328 2261 6464  ng")).alias("add
+00000700: 5f6f 6e65 2229 292e 7368 6f77 2829 0a20  _one")).show(). 
+00000710: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00000720: 0a20 2020 207c 2241 4444 5f4f 4e45 2220  .    |"ADD_ONE" 
+00000730: 207c 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   |.    ---------
+00000740: 2d2d 2d2d 0a20 2020 207c 3220 2020 2020  ----.    |2     
+00000750: 2020 2020 207c 0a20 2020 207c 3420 2020       |.    |4   
+00000760: 2020 2020 2020 207c 0a20 2020 202d 2d2d         |.    ---
+00000770: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 203c  ----------.    <
+00000780: 424c 414e 4b4c 494e 453e 0a0a 5468 6520  BLANKLINE>..The 
+00000790: 536e 6f77 666c 616b 6520 6461 7461 6261  Snowflake databa
+000007a0: 7365 2068 6173 2068 756e 6472 6564 7320  se has hundreds 
+000007b0: 6f66 2060 5351 4c20 6675 6e63 7469 6f6e  of `SQL function
+000007c0: 7320 3c68 7474 7073 3a2f 2f64 6f63 732e  s <https://docs.
+000007d0: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
+000007e0: 2f73 716c 2d72 6566 6572 656e 6365 2d66  /sql-reference-f
+000007f0: 756e 6374 696f 6e73 2e68 746d 6c3e 605f  unctions.html>`_
+00000800: 0a54 6869 7320 6d6f 6475 6c65 2070 726f  .This module pro
+00000810: 7669 6465 7320 5079 7468 6f6e 2066 756e  vides Python fun
+00000820: 6374 696f 6e73 2074 6861 7420 636f 7272  ctions that corr
+00000830: 6573 706f 6e64 2074 6f20 7468 6520 536e  espond to the Sn
+00000840: 6f77 666c 616b 6520 5351 4c20 6675 6e63  owflake SQL func
+00000850: 7469 6f6e 732e 2054 6865 7920 7479 7069  tions. They typi
+00000860: 6361 6c6c 7920 6163 6365 7074 203a 636c  cally accept :cl
+00000870: 6173 733a 6043 6f6c 756d 6e60 0a6f 626a  ass:`Column`.obj
+00000880: 6563 7473 206f 7220 636f 6c75 6d6e 206e  ects or column n
+00000890: 616d 6573 2061 7320 696e 7075 7420 7061  ames as input pa
+000008a0: 7261 6d65 7465 7273 2061 6e64 2072 6574  rameters and ret
+000008b0: 7572 6e20 6120 6e65 7720 3a63 6c61 7373  urn a new :class
+000008c0: 3a60 436f 6c75 6d6e 6020 6f62 6a65 6374  :`Column` object
+000008d0: 732e 0a54 6865 2066 6f6c 6c6f 7769 6e67  s..The following
+000008e0: 2065 7861 6d70 6c65 7320 6465 6d6f 6e73   examples demons
+000008f0: 7472 6174 6520 7468 6520 7573 6520 6f66  trate the use of
+00000900: 2073 6f6d 6520 6f66 2074 6865 7365 2066   some of these f
+00000910: 756e 6374 696f 6e73 3a0a 0a20 2020 203e  unctions:..    >
+00000920: 3e3e 2023 2054 6869 7320 6578 616d 706c  >> # This exampl
+00000930: 6520 6361 6c6c 7320 7468 6520 6675 6e63  e calls the func
+00000940: 7469 6f6e 2074 6861 7420 636f 7272 6573  tion that corres
+00000950: 706f 6e64 7320 746f 2074 6865 2054 4f5f  ponds to the TO_
+00000960: 4441 5445 2829 2053 514c 2066 756e 6374  DATE() SQL funct
+00000970: 696f 6e2e 0a20 2020 203e 3e3e 2064 662e  ion..    >>> df.
+00000980: 7365 6c65 6374 2864 6174 6561 6464 2827  select(dateadd('
+00000990: 6461 7927 2c20 6c69 7428 3129 2c20 746f  day', lit(1), to
+000009a0: 5f64 6174 6528 636f 6c28 2264 2229 2929  _date(col("d")))
+000009b0: 292e 7368 6f77 2829 0a20 2020 202d 2d2d  ).show().    ---
 000009c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000009d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000009e0: 2d2d 2d2d 2d0a 2020 2020 7c32 3032 322d  -----.    |2022-
-000009f0: 3033 2d31 3720 2020 2020 2020 2020 2020  03-17           
-00000a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a10: 7c0a 2020 2020 7c32 3032 332d 3034 2d31  |.    |2023-04-1
-00000a20: 3820 2020 2020 2020 2020 2020 2020 2020  8               
-00000a30: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00000a40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00000a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000a60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 3c42  ---------.    <B
-00000a70: 4c41 4e4b 4c49 4e45 3e0a 0a49 6620 796f  LANKLINE>..If yo
-00000a80: 7520 7761 6e74 2074 6f20 7573 6520 6120  u want to use a 
-00000a90: 5351 4c20 6675 6e63 7469 6f6e 2069 6e20  SQL function in 
-00000aa0: 536e 6f77 666c 616b 6520 6275 7420 6361  Snowflake but ca
-00000ab0: 6e27 7420 6669 6e64 2074 6865 2063 6f72  n't find the cor
-00000ac0: 7265 7370 6f6e 6469 6e67 2050 7974 686f  responding Pytho
-00000ad0: 6e20 6675 6e63 7469 6f6e 2068 6572 652c  n function here,
-00000ae0: 0a79 6f75 2063 616e 2063 7265 6174 6520  .you can create 
-00000af0: 796f 7572 206f 776e 2050 7974 686f 6e20  your own Python 
-00000b00: 6675 6e63 7469 6f6e 2077 6974 6820 3a66  function with :f
-00000b10: 756e 633a 6066 756e 6374 696f 6e60 3a0a  unc:`function`:.
-00000b20: 0a20 2020 203e 3e3e 206d 795f 7261 6469  .    >>> my_radi
-00000b30: 616e 7320 3d20 6675 6e63 7469 6f6e 2822  ans = function("
-00000b40: 7261 6469 616e 7322 2920 2023 2022 7261  radians")  # "ra
-00000b50: 6469 616e 7322 2069 7320 7468 6520 5351  dians" is the SQ
-00000b60: 4c20 6675 6e63 7469 6f6e 206e 616d 652e  L function name.
-00000b70: 0a20 2020 203e 3e3e 2064 662e 7365 6c65  .    >>> df.sele
-00000b80: 6374 286d 795f 7261 6469 616e 7328 636f  ct(my_radians(co
-00000b90: 6c28 2261 2229 292e 616c 6961 7328 226d  l("a")).alias("m
-00000ba0: 795f 7261 6469 616e 7322 2929 2e73 686f  y_radians")).sho
-00000bb0: 7728 290a 2020 2020 2d2d 2d2d 2d2d 2d2d  w().    --------
-00000bc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000bd0: 0a20 2020 207c 224d 595f 5241 4449 414e  .    |"MY_RADIAN
-00000be0: 5322 2020 2020 2020 2020 2020 7c0a 2020  S"          |.  
-00000bf0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00000c00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 207c  ----------.    |
-00000c10: 302e 3031 3734 3533 3239 3235 3139 3934  0.01745329251994
-00000c20: 3332 3935 2020 7c0a 2020 2020 7c30 2e30  3295  |.    |0.0
-00000c30: 3532 3335 3938 3737 3535 3938 3239 3838  5235987755982988
+000009e0: 2d2d 2d2d 0a20 2020 207c 2244 4154 4541  ----.    |"DATEA
+000009f0: 4444 2827 4441 5927 2c20 312c 2054 4f5f  DD('DAY', 1, TO_
+00000a00: 4441 5445 2822 2244 2222 2929 2220 207c  DATE(""D""))"  |
+00000a10: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+00000a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00000a40: 207c 3230 3232 2d30 332d 3137 2020 2020   |2022-03-17    
+00000a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000a60: 2020 2020 2020 207c 0a20 2020 207c 3230         |.    |20
+00000a70: 3233 2d30 342d 3138 2020 2020 2020 2020  23-04-18        
+00000a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000a90: 2020 207c 0a20 2020 202d 2d2d 2d2d 2d2d     |.    -------
+00000aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000ac0: 0a20 2020 203c 424c 414e 4b4c 494e 453e  .    <BLANKLINE>
+00000ad0: 0a0a 4966 2079 6f75 2077 616e 7420 746f  ..If you want to
+00000ae0: 2075 7365 2061 2053 514c 2066 756e 6374   use a SQL funct
+00000af0: 696f 6e20 696e 2053 6e6f 7766 6c61 6b65  ion in Snowflake
+00000b00: 2062 7574 2063 616e 2774 2066 696e 6420   but can't find 
+00000b10: 7468 6520 636f 7272 6573 706f 6e64 696e  the correspondin
+00000b20: 6720 5079 7468 6f6e 2066 756e 6374 696f  g Python functio
+00000b30: 6e20 6865 7265 2c0a 796f 7520 6361 6e20  n here,.you can 
+00000b40: 6372 6561 7465 2079 6f75 7220 6f77 6e20  create your own 
+00000b50: 5079 7468 6f6e 2066 756e 6374 696f 6e20  Python function 
+00000b60: 7769 7468 203a 6675 6e63 3a60 6675 6e63  with :func:`func
+00000b70: 7469 6f6e 603a 0a0a 2020 2020 3e3e 3e20  tion`:..    >>> 
+00000b80: 6d79 5f72 6164 6961 6e73 203d 2066 756e  my_radians = fun
+00000b90: 6374 696f 6e28 2272 6164 6961 6e73 2229  ction("radians")
+00000ba0: 2020 2320 2272 6164 6961 6e73 2220 6973    # "radians" is
+00000bb0: 2074 6865 2053 514c 2066 756e 6374 696f   the SQL functio
+00000bc0: 6e20 6e61 6d65 2e0a 2020 2020 3e3e 3e20  n name..    >>> 
+00000bd0: 6466 2e73 656c 6563 7428 6d79 5f72 6164  df.select(my_rad
+00000be0: 6961 6e73 2863 6f6c 2822 6122 2929 2e61  ians(col("a")).a
+00000bf0: 6c69 6173 2822 6d79 5f72 6164 6961 6e73  lias("my_radians
+00000c00: 2229 292e 7368 6f77 2829 0a20 2020 202d  ")).show().    -
+00000c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000c20: 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22 4d59  -------.    |"MY
+00000c30: 5f52 4144 4941 4e53 2220 2020 2020 2020  _RADIANS"       
 00000c40: 2020 207c 0a20 2020 202d 2d2d 2d2d 2d2d     |.    -------
 00000c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000c60: 2d0a 2020 2020 3c42 4c41 4e4b 4c49 4e45  -.    <BLANKLINE
-00000c70: 3e0a 0a6f 7220 6361 6c6c 2074 6865 2053  >..or call the S
-00000c80: 514c 2066 756e 6374 696f 6e20 6469 7265  QL function dire
-00000c90: 6374 6c79 3a0a 0a20 2020 203e 3e3e 2064  ctly:..    >>> d
-00000ca0: 662e 7365 6c65 6374 2863 616c 6c5f 6675  f.select(call_fu
-00000cb0: 6e63 7469 6f6e 2822 7261 6469 616e 7322  nction("radians"
-00000cc0: 2c20 636f 6c28 2261 2229 292e 6173 5f28  , col("a")).as_(
-00000cd0: 2263 616c 6c5f 6675 6e63 7469 6f6e 5f72  "call_function_r
-00000ce0: 6164 6961 6e73 2229 292e 7368 6f77 2829  adians")).show()
-00000cf0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-00000d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d10: 0a20 2020 207c 2243 414c 4c5f 4655 4e43  .    |"CALL_FUNC
-00000d20: 5449 4f4e 5f52 4144 4941 4e53 2220 207c  TION_RADIANS"  |
-00000d30: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-00000d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d50: 0a20 2020 207c 302e 3031 3734 3533 3239  .    |0.01745329
-00000d60: 3235 3139 3934 3332 3935 2020 2020 207c  2519943295     |
-00000d70: 0a20 2020 207c 302e 3035 3233 3539 3837  .    |0.05235987
-00000d80: 3735 3539 3832 3938 3820 2020 2020 207c  755982988      |
-00000d90: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-00000da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000db0: 0a20 2020 203c 424c 414e 4b4c 494e 453e  .    <BLANKLINE>
-00000dc0: 0a0a 5369 6d69 6c61 726c 792c 2074 6f20  ..Similarly, to 
-00000dd0: 6361 6c6c 2061 2074 6162 6c65 2066 756e  call a table fun
-00000de0: 6374 696f 6e2c 2079 6f75 2063 616e 2075  ction, you can u
-00000df0: 7365 203a 6675 6e63 3a60 7e73 6e6f 7766  se :func:`~snowf
-00000e00: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-00000e10: 6e63 7469 6f6e 732e 7461 626c 655f 6675  nctions.table_fu
-00000e20: 6e63 7469 6f6e 602c 206f 7220 3a66 756e  nction`, or :fun
-00000e30: 633a 607e 736e 6f77 666c 616b 652e 736e  c:`~snowflake.sn
-00000e40: 6f77 7061 726b 2e66 756e 6374 696f 6e73  owpark.functions
-00000e50: 2e63 616c 6c5f 7461 626c 655f 6675 6e63  .call_table_func
-00000e60: 7469 6f6e 602e 0a0a 2a2a 486f 7720 746f  tion`...**How to
-00000e70: 2066 696e 6420 6865 6c70 206f 6e20 696e   find help on in
-00000e80: 7075 7420 7061 7261 6d65 7465 7273 206f  put parameters o
-00000e90: 6620 7468 6520 5079 7468 6f6e 2066 756e  f the Python fun
-00000ea0: 6374 696f 6e73 2066 6f72 2053 514c 2066  ctions for SQL f
-00000eb0: 756e 6374 696f 6e73 2a2a 0a54 6865 2050  unctions**.The P
-00000ec0: 7974 686f 6e20 6675 6e63 7469 6f6e 7320  ython functions 
-00000ed0: 6861 7665 2074 6865 2073 616d 6520 6e61  have the same na
-00000ee0: 6d65 2061 7320 7468 6520 636f 7272 6573  me as the corres
-00000ef0: 706f 6e64 696e 6720 6053 514c 2066 756e  ponding `SQL fun
-00000f00: 6374 696f 6e73 203c 6874 7470 733a 2f2f  ctions <https://
-00000f10: 646f 6373 2e73 6e6f 7766 6c61 6b65 2e63  docs.snowflake.c
-00000f20: 6f6d 2f65 6e2f 7371 6c2d 7265 6665 7265  om/en/sql-refere
-00000f30: 6e63 652d 6675 6e63 7469 6f6e 732e 6874  nce-functions.ht
-00000f40: 6d6c 3e60 5f2e 0a0a 4279 2072 6561 6469  ml>`_...By readi
-00000f50: 6e67 2074 6865 2041 5049 2064 6f63 7320  ng the API docs 
-00000f60: 6f72 2074 6865 2073 6f75 7263 6520 636f  or the source co
-00000f70: 6465 206f 6620 6120 5079 7468 6f6e 2066  de of a Python f
-00000f80: 756e 6374 696f 6e20 6465 6669 6e65 6420  unction defined 
-00000f90: 696e 2074 6869 7320 6d6f 6475 6c65 2c20  in this module, 
-00000fa0: 796f 7527 6c6c 2073 6565 2074 6865 2074  you'll see the t
-00000fb0: 7970 6520 6869 6e74 7320 6f66 2074 6865  ype hints of the
-00000fc0: 2069 6e70 7574 2070 6172 616d 6574 6572   input parameter
-00000fd0: 7320 616e 6420 7265 7475 726e 2074 7970  s and return typ
-00000fe0: 652e 0a54 6865 2072 6574 7572 6e20 7479  e..The return ty
-00000ff0: 7065 2069 7320 616c 7761 7973 2060 6043  pe is always ``C
-00001000: 6f6c 756d 6e60 602e 2054 6865 2069 6e70  olumn``. The inp
-00001010: 7574 2074 7970 6573 2074 656c 6c20 796f  ut types tell yo
-00001020: 7520 7468 6520 6163 6365 7074 6162 6c65  u the acceptable
-00001030: 2076 616c 7565 733a 0a0a 2020 2d20 6060   values:..  - ``
-00001040: 436f 6c75 6d6e 4f72 4e61 6d65 6060 2061  ColumnOrName`` a
-00001050: 6363 6570 7473 2061 203a 636c 6173 733a  ccepts a :class:
-00001060: 6043 6f6c 756d 6e60 206f 626a 6563 742c  `Column` object,
-00001070: 206f 7220 6120 636f 6c75 6d6e 206e 616d   or a column nam
-00001080: 6520 696e 2073 7472 2e20 4d6f 7374 2066  e in str. Most f
-00001090: 756e 6374 696f 6e73 2061 6363 6570 7420  unctions accept 
-000010a0: 7468 6973 2074 7970 652e 0a20 2020 2049  this type..    I
-000010b0: 6620 796f 7520 7374 696c 6c20 7761 6e74  f you still want
-000010c0: 2074 6f20 7061 7373 2061 206c 6974 6572   to pass a liter
-000010d0: 616c 2074 6f20 6974 2c20 7573 6520 606c  al to it, use `l
-000010e0: 6974 2876 616c 7565 2960 2c20 7768 6963  it(value)`, whic
-000010f0: 6820 7265 7475 726e 7320 6120 6060 436f  h returns a ``Co
-00001100: 6c75 6d6e 6060 206f 626a 6563 7420 7468  lumn`` object th
-00001110: 6174 2072 6570 7265 7365 6e74 7320 6120  at represents a 
-00001120: 6c69 7465 7261 6c20 7661 6c75 652e 0a0a  literal value...
-00001130: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00001140: 7428 6176 6728 2261 2229 292e 7368 6f77  t(avg("a")).show
-00001150: 2829 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  ().    ---------
-00001160: 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22 4156  -------.    |"AV
-00001170: 4728 2222 4122 2229 2220 207c 0a20 2020  G(""A"")"  |.   
-00001180: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00001190: 2d0a 2020 2020 7c32 2e30 3030 3030 3020  -.    |2.000000 
-000011a0: 2020 2020 207c 0a20 2020 202d 2d2d 2d2d       |.    -----
-000011b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000011c0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-000011d0: 3e3e 3e20 6466 2e73 656c 6563 7428 6176  >>> df.select(av
-000011e0: 6728 636f 6c28 2261 2229 2929 2e73 686f  g(col("a"))).sho
-000011f0: 7728 290a 2020 2020 2d2d 2d2d 2d2d 2d2d  w().    --------
-00001200: 2d2d 2d2d 2d2d 2d2d 0a20 2020 207c 2241  --------.    |"A
-00001210: 5647 2822 2241 2222 2922 2020 7c0a 2020  VG(""A"")"  |.  
-00001220: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00001230: 2d2d 0a20 2020 207c 322e 3030 3030 3030  --.    |2.000000
-00001240: 2020 2020 2020 7c0a 2020 2020 2d2d 2d2d        |.    ----
-00001250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00001260: 203c 424c 414e 4b4c 494e 453e 0a0a 2020   <BLANKLINE>..  
-00001270: 2d20 6060 4c69 7465 7261 6c54 7970 6560  - ``LiteralType`
-00001280: 6020 6163 6365 7074 7320 6120 7661 6c75  ` accepts a valu
-00001290: 6520 6f66 2074 7970 6520 6060 626f 6f6c  e of type ``bool
-000012a0: 6060 2c20 6060 696e 7460 602c 2060 6066  ``, ``int``, ``f
-000012b0: 6c6f 6174 6060 2c20 6060 7374 7260 602c  loat``, ``str``,
-000012c0: 2060 6062 7974 6561 7272 6179 6060 2c20   ``bytearray``, 
-000012d0: 6060 6465 6369 6d61 6c2e 4465 6369 6d61  ``decimal.Decima
-000012e0: 6c60 602c 0a20 2020 2060 6064 6174 6574  l``,.    ``datet
-000012f0: 696d 652e 6461 7465 6060 2c20 6060 6461  ime.date``, ``da
-00001300: 7465 7469 6d65 2e64 6174 6574 696d 6560  tetime.datetime`
-00001310: 602c 2060 6064 6174 6574 696d 652e 7469  `, ``datetime.ti
-00001320: 6d65 6060 2c20 6f72 2060 6062 7974 6573  me``, or ``bytes
-00001330: 6060 2e20 416e 2065 7861 6d70 6c65 2069  ``. An example i
-00001340: 7320 7468 6520 7468 6972 6420 7061 7261  s the third para
-00001350: 6d65 7465 7220 6f66 203a 6675 6e63 3a60  meter of :func:`
-00001360: 6c65 6164 602e 0a0a 2020 2020 3e3e 3e20  lead`...    >>> 
-00001370: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-00001380: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00001390: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000013a0: 7769 6e64 6f77 2069 6d70 6f72 7420 5769  window import Wi
-000013b0: 6e64 6f77 0a20 2020 203e 3e3e 2064 662e  ndow.    >>> df.
-000013c0: 7365 6c65 6374 2863 6f6c 2822 6422 292c  select(col("d"),
-000013d0: 206c 6561 6428 2264 222c 2031 2c20 6461   lead("d", 1, da
-000013e0: 7465 7469 6d65 2e64 6174 6528 3230 3234  tetime.date(2024
-000013f0: 2c20 352c 2031 3829 2c20 4661 6c73 6529  , 5, 18), False)
-00001400: 2e6f 7665 7228 5769 6e64 6f77 2e6f 7264  .over(Window.ord
-00001410: 6572 5f62 7928 2264 2229 292e 616c 6961  er_by("d")).alia
-00001420: 7328 226c 6561 645f 6461 7922 2929 2e73  s("lead_day")).s
-00001430: 686f 7728 290a 2020 2020 2d2d 2d2d 2d2d  how().    ------
-00001440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001450: 2d2d 2d2d 2d0a 2020 2020 7c22 4422 2020  -----.    |"D"  
-00001460: 2020 2020 2020 207c 224c 4541 445f 4441         |"LEAD_DA
-00001470: 5922 2020 7c0a 2020 2020 2d2d 2d2d 2d2d  Y"  |.    ------
-00001480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001490: 2d2d 2d2d 2d0a 2020 2020 7c32 3032 322d  -----.    |2022-
-000014a0: 3033 2d31 3620 207c 3230 3233 2d30 342d  03-16  |2023-04-
-000014b0: 3137 2020 7c0a 2020 2020 7c32 3032 332d  17  |.    |2023-
-000014c0: 3034 2d31 3720 207c 3230 3234 2d30 352d  04-17  |2024-05-
-000014d0: 3138 2020 7c0a 2020 2020 2d2d 2d2d 2d2d  18  |.    ------
-000014e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000014f0: 2d2d 2d2d 2d0a 2020 2020 3c42 4c41 4e4b  -----.    <BLANK
-00001500: 4c49 4e45 3e0a 0a20 202d 2060 6043 6f6c  LINE>..  - ``Col
-00001510: 756d 6e4f 724c 6974 6572 616c 6060 2061  umnOrLiteral`` a
-00001520: 6363 6570 7473 2061 2060 6043 6f6c 756d  ccepts a ``Colum
-00001530: 6e60 6020 6f62 6a65 6374 2c20 6f72 2061  n`` object, or a
-00001540: 2076 616c 7565 206f 6620 6060 4c69 7465   value of ``Lite
-00001550: 7261 6c54 7970 6560 6020 6d65 6e74 696f  ralType`` mentio
-00001560: 6e65 6420 6162 6f76 652e 0a20 2020 2054  ned above..    T
-00001570: 6865 2064 6966 6665 7265 6e63 6520 6672  he difference fr
-00001580: 6f6d 2060 6043 6f6c 756d 6e4f 724c 6974  om ``ColumnOrLit
-00001590: 6572 616c 6060 2069 7320 6060 436f 6c75  eral`` is ``Colu
-000015a0: 6d6e 4f72 4c69 7465 7261 6c60 6020 7265  mnOrLiteral`` re
-000015b0: 6761 7264 7320 6120 7374 7220 7661 6c75  gards a str valu
-000015c0: 6520 6173 2061 2053 514c 2073 7472 696e  e as a SQL strin
-000015d0: 6720 7661 6c75 6520 696e 7374 6561 6420  g value instead 
-000015e0: 6f66 0a20 2020 2061 2063 6f6c 756d 6e20  of.    a column 
-000015f0: 6e61 6d65 2e20 5768 656e 2061 2066 756e  name. When a fun
-00001600: 6374 696f 6e20 6973 206d 7563 6820 6d6f  ction is much mo
-00001610: 7265 206c 696b 656c 7920 746f 2061 6363  re likely to acc
-00001620: 6570 7420 6120 5351 4c20 636f 6e73 7461  ept a SQL consta
-00001630: 6e74 2076 616c 7565 2074 6861 6e20 6120  nt value than a 
-00001640: 636f 6c75 6d6e 2065 7870 7265 7373 696f  column expressio
-00001650: 6e2c 2060 6043 6f6c 756d 6e4f 724c 6974  n, ``ColumnOrLit
-00001660: 6572 616c 6060 0a20 2020 2069 7320 7573  eral``.    is us
-00001670: 6564 2e20 5965 7420 796f 7520 6361 6e20  ed. Yet you can 
-00001680: 7374 696c 6c20 7061 7373 2069 6e20 6120  still pass in a 
-00001690: 6060 436f 6c75 6d6e 6060 206f 626a 6563  ``Column`` objec
-000016a0: 7420 6966 2079 6f75 206e 6565 6420 746f  t if you need to
-000016b0: 2e20 416e 2065 7861 6d70 6c65 2069 7320  . An example is 
-000016c0: 7468 6520 7365 636f 6e64 2070 6172 616d  the second param
-000016d0: 6574 6572 206f 660a 2020 2020 3a66 756e  eter of.    :fun
-000016e0: 633a 6060 7768 656e 6060 2e0a 0a20 2020  c:``when``...   
-000016f0: 203e 3e3e 2064 662e 7365 6c65 6374 2877   >>> df.select(w
-00001700: 6865 6e28 6466 5b22 6122 5d20 3e20 322c  hen(df["a"] > 2,
-00001710: 2022 4772 6561 7465 7220 7468 616e 2032   "Greater than 2
-00001720: 2229 2e65 6c73 655f 2822 4c65 7373 2074  ").else_("Less t
-00001730: 6861 6e20 3222 292e 616c 6961 7328 2263  han 2").alias("c
-00001740: 6f6d 7061 7265 5f77 6974 685f 3222 2929  ompare_with_2"))
-00001750: 2e73 686f 7728 290a 2020 2020 2d2d 2d2d  .show().    ----
-00001760: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001770: 0a20 2020 207c 2243 4f4d 5041 5245 5f57  .    |"COMPARE_W
-00001780: 4954 485f 3222 2020 7c0a 2020 2020 2d2d  ITH_2"  |.    --
-00001790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000017a0: 2d2d 0a20 2020 207c 4c65 7373 2074 6861  --.    |Less tha
-000017b0: 6e20 3220 2020 2020 2020 7c0a 2020 2020  n 2       |.    
-000017c0: 7c47 7265 6174 6572 2074 6861 6e20 3220  |Greater than 2 
-000017d0: 2020 207c 0a20 2020 202d 2d2d 2d2d 2d2d     |.    -------
-000017e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000017f0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20    <BLANKLINE>.. 
-00001800: 202d 2060 6069 6e74 6060 2c20 6060 626f   - ``int``, ``bo
-00001810: 6f6c 6060 2c20 6060 7374 7260 602c 206f  ol``, ``str``, o
-00001820: 7220 616e 6f74 6865 7220 7370 6563 6966  r another specif
-00001830: 6963 2074 7970 6520 6163 6365 7074 7320  ic type accepts 
-00001840: 6120 7661 6c75 6520 6f66 2074 6861 7420  a value of that 
-00001850: 7479 7065 2e20 416e 2065 7861 6d70 6c65  type. An example
-00001860: 2069 7320 3a66 756e 633a 6074 6f5f 6465   is :func:`to_de
-00001870: 6369 6d61 6c60 2e0a 0a20 2020 203e 3e3e  cimal`...    >>>
-00001880: 2064 662e 7769 7468 5f63 6f6c 756d 6e28   df.with_column(
-00001890: 2265 222c 206c 6974 2822 312e 3222 2929  "e", lit("1.2"))
-000018a0: 2e73 656c 6563 7428 746f 5f64 6563 696d  .select(to_decim
-000018b0: 616c 2822 6522 2c20 352c 2032 2929 2e73  al("e", 5, 2)).s
-000018c0: 686f 7728 290a 2020 2020 2d2d 2d2d 2d2d  how().    ------
-000018d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000018e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22 544f  -------.    |"TO
-000018f0: 5f44 4543 494d 414c 2822 2245 2222 2c20  _DECIMAL(""E"", 
-00001900: 352c 2032 2922 2020 7c0a 2020 2020 2d2d  5, 2)"  |.    --
-00001910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00001930: 7c31 2e32 3020 2020 2020 2020 2020 2020  |1.20           
-00001940: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00001950: 2020 7c31 2e32 3020 2020 2020 2020 2020    |1.20         
-00001960: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00001970: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00001980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001990: 2d0a 2020 2020 3c42 4c41 4e4b 4c49 4e45  -.    <BLANKLINE
-000019a0: 3e0a 0a20 202d 2060 6043 6f6c 756d 6e4f  >..  - ``ColumnO
-000019b0: 7253 716c 4578 7072 6060 2061 6363 6570  rSqlExpr`` accep
-000019c0: 7473 2061 2060 6043 6f6c 756d 6e60 6020  ts a ``Column`` 
-000019d0: 6f62 6a65 6374 2c20 6f72 2061 2053 514c  object, or a SQL
-000019e0: 2065 7870 7265 7373 696f 6e2e 2046 6f72   expression. For
-000019f0: 2069 6e73 7461 6e63 652c 2074 6865 2066   instance, the f
-00001a00: 6972 7374 2070 6172 616d 6574 6572 2069  irst parameter i
-00001a10: 6e20 3a66 756e 633a 6060 7768 656e 6060  n :func:``when``
-00001a20: 2e0a 0a20 2020 203e 3e3e 2064 662e 7365  ...    >>> df.se
-00001a30: 6c65 6374 2877 6865 6e28 2261 203e 2032  lect(when("a > 2
-00001a40: 222c 2022 4772 6561 7465 7220 7468 616e  ", "Greater than
-00001a50: 2032 2229 2e65 6c73 655f 2822 4c65 7373   2").else_("Less
-00001a60: 2074 6861 6e20 3222 292e 616c 6961 7328   than 2").alias(
-00001a70: 2263 6f6d 7061 7265 5f77 6974 685f 3222  "compare_with_2"
-00001a80: 2929 2e73 686f 7728 290a 2020 2020 2d2d  )).show().    --
-00001a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001aa0: 2d2d 0a20 2020 207c 2243 4f4d 5041 5245  --.    |"COMPARE
-00001ab0: 5f57 4954 485f 3222 2020 7c0a 2020 2020  _WITH_2"  |.    
-00001ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001ad0: 2d2d 2d2d 0a20 2020 207c 4c65 7373 2074  ----.    |Less t
-00001ae0: 6861 6e20 3220 2020 2020 2020 7c0a 2020  han 2       |.  
-00001af0: 2020 7c47 7265 6174 6572 2074 6861 6e20    |Greater than 
-00001b00: 3220 2020 207c 0a20 2020 202d 2d2d 2d2d  2    |.    -----
-00001b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-00001b20: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00001b30: 2222 220a 696d 706f 7274 2066 756e 6374  """.import funct
-00001b40: 6f6f 6c73 0a69 6d70 6f72 7420 7479 7069  ools.import typi
-00001b50: 6e67 0a66 726f 6d20 7261 6e64 6f6d 2069  ng.from random i
-00001b60: 6d70 6f72 7420 7261 6e64 696e 740a 6672  mport randint.fr
-00001b70: 6f6d 2074 7970 6573 2069 6d70 6f72 7420  om types import 
-00001b80: 4d6f 6475 6c65 5479 7065 0a66 726f 6d20  ModuleType.from 
-00001b90: 7479 7069 6e67 2069 6d70 6f72 7420 4361  typing import Ca
-00001ba0: 6c6c 6162 6c65 2c20 4469 6374 2c20 4c69  llable, Dict, Li
-00001bb0: 7374 2c20 4f70 7469 6f6e 616c 2c20 5475  st, Optional, Tu
-00001bc0: 706c 652c 2055 6e69 6f6e 2c20 6f76 6572  ple, Union, over
-00001bd0: 6c6f 6164 0a0a 696d 706f 7274 2073 6e6f  load..import sno
-00001be0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b0a  wflake.snowpark.
-00001bf0: 696d 706f 7274 2073 6e6f 7766 6c61 6b65  import snowflake
-00001c00: 2e73 6e6f 7770 6172 6b2e 7461 626c 655f  .snowpark.table_
-00001c10: 6675 6e63 7469 6f6e 0a66 726f 6d20 736e  function.from sn
-00001c20: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00001c30: 2e5f 696e 7465 726e 616c 2e61 6e61 6c79  ._internal.analy
-00001c40: 7a65 722e 6578 7072 6573 7369 6f6e 2069  zer.expression i
-00001c50: 6d70 6f72 7420 280a 2020 2020 4361 7365  mport (.    Case
-00001c60: 5768 656e 2c0a 2020 2020 4675 6e63 7469  When,.    Functi
-00001c70: 6f6e 4578 7072 6573 7369 6f6e 2c0a 2020  onExpression,.  
-00001c80: 2020 4c69 7374 4167 672c 0a20 2020 204c    ListAgg,.    L
-00001c90: 6974 6572 616c 2c0a 2020 2020 4d75 6c74  iteral,.    Mult
-00001ca0: 6970 6c65 4578 7072 6573 7369 6f6e 2c0a  ipleExpression,.
-00001cb0: 2020 2020 5374 6172 2c0a 290a 6672 6f6d      Star,.).from
-00001cc0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00001cd0: 6172 6b2e 5f69 6e74 6572 6e61 6c2e 616e  ark._internal.an
-00001ce0: 616c 797a 6572 2e77 696e 646f 775f 6578  alyzer.window_ex
-00001cf0: 7072 6573 7369 6f6e 2069 6d70 6f72 7420  pression import 
-00001d00: 280a 2020 2020 4669 7273 7456 616c 7565  (.    FirstValue
-00001d10: 2c0a 2020 2020 4c61 672c 0a20 2020 204c  ,.    Lag,.    L
-00001d20: 6173 7456 616c 7565 2c0a 2020 2020 4c65  astValue,.    Le
-00001d30: 6164 2c0a 290a 6672 6f6d 2073 6e6f 7766  ad,.).from snowf
-00001d40: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5f69  lake.snowpark._i
-00001d50: 6e74 6572 6e61 6c2e 7479 7065 5f75 7469  nternal.type_uti
-00001d60: 6c73 2069 6d70 6f72 7420 280a 2020 2020  ls import (.    
-00001d70: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c2c  ColumnOrLiteral,
-00001d80: 0a20 2020 2043 6f6c 756d 6e4f 724c 6974  .    ColumnOrLit
-00001d90: 6572 616c 5374 722c 0a20 2020 2043 6f6c  eralStr,.    Col
-00001da0: 756d 6e4f 724e 616d 652c 0a20 2020 2043  umnOrName,.    C
-00001db0: 6f6c 756d 6e4f 7253 716c 4578 7072 2c0a  olumnOrSqlExpr,.
-00001dc0: 2020 2020 4c69 7465 7261 6c54 7970 652c      LiteralType,
-00001dd0: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
-00001de0: 652e 736e 6f77 7061 726b 2e5f 696e 7465  e.snowpark._inte
-00001df0: 726e 616c 2e75 7469 6c73 2069 6d70 6f72  rnal.utils impor
-00001e00: 7420 280a 2020 2020 7061 7273 655f 706f  t (.    parse_po
-00001e10: 7369 7469 6f6e 616c 5f61 7267 735f 746f  sitional_args_to
-00001e20: 5f6c 6973 742c 0a20 2020 2076 616c 6964  _list,.    valid
-00001e30: 6174 655f 6f62 6a65 6374 5f6e 616d 652c  ate_object_name,
-00001e40: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
-00001e50: 652e 736e 6f77 7061 726b 2e63 6f6c 756d  e.snowpark.colum
-00001e60: 6e20 696d 706f 7274 2028 0a20 2020 2043  n import (.    C
-00001e70: 6173 6545 7870 722c 0a20 2020 2043 6f6c  aseExpr,.    Col
-00001e80: 756d 6e2c 0a20 2020 205f 746f 5f63 6f6c  umn,.    _to_col
-00001e90: 5f69 665f 7371 6c5f 6578 7072 2c0a 2020  _if_sql_expr,.  
-00001ea0: 2020 5f74 6f5f 636f 6c5f 6966 5f73 7472    _to_col_if_str
-00001eb0: 2c0a 2020 2020 5f74 6f5f 636f 6c5f 6966  ,.    _to_col_if
-00001ec0: 5f73 7472 5f6f 725f 696e 742c 0a29 0a66  _str_or_int,.).f
-00001ed0: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00001ee0: 6f77 7061 726b 2e73 746f 7265 645f 7072  owpark.stored_pr
-00001ef0: 6f63 6564 7572 6520 696d 706f 7274 2053  ocedure import S
-00001f00: 746f 7265 6450 726f 6365 6475 7265 0a66  toredProcedure.f
-00001f10: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00001f20: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-00001f30: 6f72 7420 4461 7461 5479 7065 2c20 466c  ort DataType, Fl
-00001f40: 6f61 7454 7970 652c 2053 7472 7563 7454  oatType, StructT
-00001f50: 7970 650a 6672 6f6d 2073 6e6f 7766 6c61  ype.from snowfla
-00001f60: 6b65 2e73 6e6f 7770 6172 6b2e 7564 6620  ke.snowpark.udf 
-00001f70: 696d 706f 7274 2055 7365 7244 6566 696e  import UserDefin
-00001f80: 6564 4675 6e63 7469 6f6e 0a66 726f 6d20  edFunction.from 
-00001f90: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00001fa0: 726b 2e75 6474 6620 696d 706f 7274 2055  rk.udtf import U
-00001fb0: 7365 7244 6566 696e 6564 5461 626c 6546  serDefinedTableF
-00001fc0: 756e 6374 696f 6e0a 0a23 2050 7974 686f  unction..# Pytho
-00001fd0: 6e20 332e 3820 6e65 6564 7320 746f 2075  n 3.8 needs to u
-00001fe0: 7365 2074 7970 696e 672e 4974 6572 6162  se typing.Iterab
-00001ff0: 6c65 2062 6563 6175 7365 2063 6f6c 6c65  le because colle
-00002000: 6374 696f 6e73 2e61 6263 2e49 7465 7261  ctions.abc.Itera
-00002010: 626c 6520 6973 206e 6f74 2073 7562 7363  ble is not subsc
-00002020: 7269 7074 6162 6c65 0a23 2050 7974 686f  riptable.# Pytho
-00002030: 6e20 332e 3920 6361 6e20 7573 6520 626f  n 3.9 can use bo
-00002040: 7468 0a23 2050 7974 686f 6e20 332e 3130  th.# Python 3.10
-00002050: 206e 6565 6473 2074 6f20 7573 6520 636f   needs to use co
-00002060: 6c6c 6563 7469 6f6e 732e 6162 632e 4974  llections.abc.It
-00002070: 6572 6162 6c65 2062 6563 6175 7365 2074  erable because t
-00002080: 7970 696e 672e 4974 6572 6162 6c65 2069  yping.Iterable i
-00002090: 7320 7265 6d6f 7665 640a 7472 793a 0a20  s removed.try:. 
-000020a0: 2020 2066 726f 6d20 7479 7069 6e67 2069     from typing i
-000020b0: 6d70 6f72 7420 4974 6572 6162 6c65 0a65  mport Iterable.e
-000020c0: 7863 6570 7420 496d 706f 7274 4572 726f  xcept ImportErro
-000020d0: 723a 0a20 2020 2066 726f 6d20 636f 6c6c  r:.    from coll
-000020e0: 6563 7469 6f6e 732e 6162 6320 696d 706f  ections.abc impo
-000020f0: 7274 2049 7465 7261 626c 650a 0a0a 6465  rt Iterable...de
-00002100: 6620 636f 6c28 636f 6c5f 6e61 6d65 3a20  f col(col_name: 
-00002110: 7374 7229 202d 3e20 436f 6c75 6d6e 3a0a  str) -> Column:.
-00002120: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-00002130: 6865 203a 636c 6173 733a 607e 736e 6f77  he :class:`~snow
-00002140: 666c 616b 652e 736e 6f77 7061 726b 2e43  flake.snowpark.C
-00002150: 6f6c 756d 6e60 2077 6974 6820 7468 6520  olumn` with the 
-00002160: 7370 6563 6966 6965 6420 6e61 6d65 2e0a  specified name..
-00002170: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00002180: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00002190: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
-000021a0: 6563 7420 3120 6173 2061 2229 0a20 2020  ect 1 as a").   
-000021b0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-000021c0: 6374 2863 6f6c 2822 6122 2929 2e63 6f6c  ct(col("a")).col
-000021d0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000021e0: 526f 7728 413d 3129 5d0a 2020 2020 2222  Row(A=1)].    ""
-000021f0: 220a 2020 2020 7265 7475 726e 2043 6f6c  ".    return Col
-00002200: 756d 6e28 636f 6c5f 6e61 6d65 290a 0a0a  umn(col_name)...
-00002210: 6465 6620 636f 6c75 6d6e 2863 6f6c 5f6e  def column(col_n
-00002220: 616d 653a 2073 7472 2920 2d3e 2043 6f6c  ame: str) -> Col
-00002230: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00002240: 726e 7320 6120 3a63 6c61 7373 3a60 7e73  rns a :class:`~s
-00002250: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00002260: 6b2e 436f 6c75 6d6e 6020 7769 7468 2074  k.Column` with t
-00002270: 6865 2073 7065 6369 6669 6564 206e 616d  he specified nam
-00002280: 652e 2041 6c69 6173 2066 6f72 2063 6f6c  e. Alias for col
-00002290: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-000022a0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000022b0: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-000022c0: 656c 6563 7420 3120 6173 2061 2229 0a20  elect 1 as a"). 
-000022d0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-000022e0: 6c65 6374 2863 6f6c 756d 6e28 2261 2229  lect(column("a")
-000022f0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00002300: 2020 2020 5b52 6f77 2841 3d31 295d 0a20      [Row(A=1)]. 
-00002310: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-00002320: 6e20 436f 6c75 6d6e 2863 6f6c 5f6e 616d  n Column(col_nam
-00002330: 6529 0a0a 0a64 6566 206c 6974 286c 6974  e)...def lit(lit
-00002340: 6572 616c 3a20 4c69 7465 7261 6c54 7970  eral: LiteralTyp
-00002350: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00002360: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-00002370: 7320 6120 3a63 6c61 7373 3a60 7e73 6e6f  s a :class:`~sno
-00002380: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00002390: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
-000023a0: 6f6e 2066 6f72 2061 206c 6974 6572 616c  on for a literal
-000023b0: 2076 616c 7565 2e0a 2020 2020 4974 2073   value..    It s
-000023c0: 7570 706f 7274 7320 6261 7369 6320 5079  upports basic Py
-000023d0: 7468 6f6e 2064 6174 6120 7479 7065 732c  thon data types,
-000023e0: 2069 6e63 6c75 6469 6e67 2060 6069 6e74   including ``int
-000023f0: 6060 2c20 6060 666c 6f61 7460 602c 2060  ``, ``float``, `
-00002400: 6073 7472 6060 2c0a 2020 2020 6060 626f  `str``,.    ``bo
-00002410: 6f6c 6060 2c20 6060 6279 7465 7360 602c  ol``, ``bytes``,
-00002420: 2060 6062 7974 6561 7272 6179 6060 2c20   ``bytearray``, 
-00002430: 6060 6461 7465 7469 6d65 2e74 696d 6560  ``datetime.time`
-00002440: 602c 2060 6064 6174 6574 696d 652e 6461  `, ``datetime.da
-00002450: 7465 6060 2c0a 2020 2020 6060 6461 7465  te``,.    ``date
-00002460: 7469 6d65 2e64 6174 6574 696d 6560 6020  time.datetime`` 
-00002470: 616e 6420 6060 6465 6369 6d61 6c2e 4465  and ``decimal.De
-00002480: 6369 6d61 6c60 602e 2041 6c73 6f2c 2069  cimal``. Also, i
-00002490: 7420 7375 7070 6f72 7473 2050 7974 686f  t supports Pytho
-000024a0: 6e20 7374 7275 6374 7572 6564 2064 6174  n structured dat
-000024b0: 6120 7479 7065 732c 0a20 2020 2069 6e63  a types,.    inc
-000024c0: 6c75 6469 6e67 2060 606c 6973 7460 602c  luding ``list``,
-000024d0: 2060 6074 7570 6c65 6060 2061 6e64 2060   ``tuple`` and `
-000024e0: 6064 6963 7460 602c 2062 7574 2074 6869  `dict``, but thi
-000024f0: 7320 636f 6e74 6169 6e65 7220 6d75 7374  s container must
-00002500: 0a20 2020 2062 6520 4a53 4f4e 2073 6572  .    be JSON ser
-00002510: 6961 6c69 7a61 626c 652e 0a0a 2020 2020  ializable...    
-00002520: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00002530: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00002540: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-00002550: 3e3e 2063 6f6c 756d 6e73 203d 205b 6c69  >> columns = [li
-00002560: 7428 3129 2c20 6c69 7428 2231 2229 2c20  t(1), lit("1"), 
-00002570: 6c69 7428 312e 3029 2c20 6c69 7428 5472  lit(1.0), lit(Tr
-00002580: 7565 292c 206c 6974 2862 2773 6e6f 7727  ue), lit(b'snow'
-00002590: 292c 206c 6974 2864 6174 6574 696d 652e  ), lit(datetime.
-000025a0: 6461 7465 2832 3032 332c 2032 2c20 3229  date(2023, 2, 2)
-000025b0: 292c 206c 6974 285b 312c 2032 5d29 2c20  ), lit([1, 2]), 
-000025c0: 6c69 7428 7b22 736e 6f77 223a 2022 666c  lit({"snow": "fl
-000025d0: 616b 6522 7d29 5d0a 2020 2020 2020 2020  ake"})].        
-000025e0: 3e3e 3e20 7365 7373 696f 6e2e 6372 6561  >>> session.crea
-000025f0: 7465 5f64 6174 6166 7261 6d65 285b 5b5d  te_dataframe([[]
-00002600: 5d29 2e73 656c 6563 7428 5b63 2e61 735f  ]).select([c.as_
-00002610: 2873 7472 2869 2929 2066 6f72 2069 2c20  (str(i)) for i, 
-00002620: 6320 696e 2065 6e75 6d65 7261 7465 2863  c in enumerate(c
-00002630: 6f6c 756d 6e73 295d 292e 7368 6f77 2829  olumns)]).show()
-00002640: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00002650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002670: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000026a0: 0a20 2020 2020 2020 207c 2230 2220 207c  .        |"0"  |
-000026b0: 2231 2220 207c 2232 2220 207c 2233 2220  "1"  |"2"  |"3" 
-000026c0: 2020 7c22 3422 2020 2020 2020 2020 2020    |"4"          
-000026d0: 2020 2020 2020 207c 2235 2220 2020 2020         |"5"     
-000026e0: 2020 2020 7c22 3622 2020 207c 2237 2220      |"6"   |"7" 
-000026f0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00000c60: 2d0a 2020 2020 7c30 2e30 3137 3435 3332  -.    |0.0174532
+00000c70: 3932 3531 3939 3433 3239 3520 207c 0a20  92519943295  |. 
+00000c80: 2020 207c 302e 3035 3233 3539 3837 3735     |0.0523598775
+00000c90: 3539 3832 3938 3820 2020 7c0a 2020 2020  5982988   |.    
+00000ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000cb0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203c 424c  --------.    <BL
+00000cc0: 414e 4b4c 494e 453e 0a0a 6f72 2063 616c  ANKLINE>..or cal
+00000cd0: 6c20 7468 6520 5351 4c20 6675 6e63 7469  l the SQL functi
+00000ce0: 6f6e 2064 6972 6563 746c 793a 0a0a 2020  on directly:..  
+00000cf0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00000d00: 6361 6c6c 5f66 756e 6374 696f 6e28 2272  call_function("r
+00000d10: 6164 6961 6e73 222c 2063 6f6c 2822 6122  adians", col("a"
+00000d20: 2929 2e61 735f 2822 6361 6c6c 5f66 756e  )).as_("call_fun
+00000d30: 6374 696f 6e5f 7261 6469 616e 7322 2929  ction_radians"))
+00000d40: 2e73 686f 7728 290a 2020 2020 2d2d 2d2d  .show().    ----
+00000d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000d60: 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22 4341  -------.    |"CA
+00000d70: 4c4c 5f46 554e 4354 494f 4e5f 5241 4449  LL_FUNCTION_RADI
+00000d80: 414e 5322 2020 7c0a 2020 2020 2d2d 2d2d  ANS"  |.    ----
+00000d90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000da0: 2d2d 2d2d 2d2d 2d0a 2020 2020 7c30 2e30  -------.    |0.0
+00000db0: 3137 3435 3332 3932 3531 3939 3433 3239  1745329251994329
+00000dc0: 3520 2020 2020 7c0a 2020 2020 7c30 2e30  5     |.    |0.0
+00000dd0: 3532 3335 3938 3737 3535 3938 3239 3838  5235987755982988
+00000de0: 2020 2020 2020 7c0a 2020 2020 2d2d 2d2d        |.    ----
+00000df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000e00: 2d2d 2d2d 2d2d 2d0a 2020 2020 3c42 4c41  -------.    <BLA
+00000e10: 4e4b 4c49 4e45 3e0a 0a53 696d 696c 6172  NKLINE>..Similar
+00000e20: 6c79 2c20 746f 2063 616c 6c20 6120 7461  ly, to call a ta
+00000e30: 626c 6520 6675 6e63 7469 6f6e 2c20 796f  ble function, yo
+00000e40: 7520 6361 6e20 7573 6520 3a66 756e 633a  u can use :func:
+00000e50: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+00000e60: 7061 726b 2e66 756e 6374 696f 6e73 2e74  park.functions.t
+00000e70: 6162 6c65 5f66 756e 6374 696f 6e60 2c20  able_function`, 
+00000e80: 6f72 203a 6675 6e63 3a60 7e73 6e6f 7766  or :func:`~snowf
+00000e90: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+00000ea0: 6e63 7469 6f6e 732e 6361 6c6c 5f74 6162  nctions.call_tab
+00000eb0: 6c65 5f66 756e 6374 696f 6e60 2e0a 0a2a  le_function`...*
+00000ec0: 2a48 6f77 2074 6f20 6669 6e64 2068 656c  *How to find hel
+00000ed0: 7020 6f6e 2069 6e70 7574 2070 6172 616d  p on input param
+00000ee0: 6574 6572 7320 6f66 2074 6865 2050 7974  eters of the Pyt
+00000ef0: 686f 6e20 6675 6e63 7469 6f6e 7320 666f  hon functions fo
+00000f00: 7220 5351 4c20 6675 6e63 7469 6f6e 732a  r SQL functions*
+00000f10: 2a0a 5468 6520 5079 7468 6f6e 2066 756e  *.The Python fun
+00000f20: 6374 696f 6e73 2068 6176 6520 7468 6520  ctions have the 
+00000f30: 7361 6d65 206e 616d 6520 6173 2074 6865  same name as the
+00000f40: 2063 6f72 7265 7370 6f6e 6469 6e67 2060   corresponding `
+00000f50: 5351 4c20 6675 6e63 7469 6f6e 7320 3c68  SQL functions <h
+00000f60: 7474 7073 3a2f 2f64 6f63 732e 736e 6f77  ttps://docs.snow
+00000f70: 666c 616b 652e 636f 6d2f 656e 2f73 716c  flake.com/en/sql
+00000f80: 2d72 6566 6572 656e 6365 2d66 756e 6374  -reference-funct
+00000f90: 696f 6e73 2e68 746d 6c3e 605f 2e0a 0a42  ions.html>`_...B
+00000fa0: 7920 7265 6164 696e 6720 7468 6520 4150  y reading the AP
+00000fb0: 4920 646f 6373 206f 7220 7468 6520 736f  I docs or the so
+00000fc0: 7572 6365 2063 6f64 6520 6f66 2061 2050  urce code of a P
+00000fd0: 7974 686f 6e20 6675 6e63 7469 6f6e 2064  ython function d
+00000fe0: 6566 696e 6564 2069 6e20 7468 6973 206d  efined in this m
+00000ff0: 6f64 756c 652c 2079 6f75 276c 6c20 7365  odule, you'll se
+00001000: 6520 7468 6520 7479 7065 2068 696e 7473  e the type hints
+00001010: 206f 6620 7468 6520 696e 7075 7420 7061   of the input pa
+00001020: 7261 6d65 7465 7273 2061 6e64 2072 6574  rameters and ret
+00001030: 7572 6e20 7479 7065 2e0a 5468 6520 7265  urn type..The re
+00001040: 7475 726e 2074 7970 6520 6973 2061 6c77  turn type is alw
+00001050: 6179 7320 6060 436f 6c75 6d6e 6060 2e20  ays ``Column``. 
+00001060: 5468 6520 696e 7075 7420 7479 7065 7320  The input types 
+00001070: 7465 6c6c 2079 6f75 2074 6865 2061 6363  tell you the acc
+00001080: 6570 7461 626c 6520 7661 6c75 6573 3a0a  eptable values:.
+00001090: 0a20 202d 2060 6043 6f6c 756d 6e4f 724e  .  - ``ColumnOrN
+000010a0: 616d 6560 6020 6163 6365 7074 7320 6120  ame`` accepts a 
+000010b0: 3a63 6c61 7373 3a60 436f 6c75 6d6e 6020  :class:`Column` 
+000010c0: 6f62 6a65 6374 2c20 6f72 2061 2063 6f6c  object, or a col
+000010d0: 756d 6e20 6e61 6d65 2069 6e20 7374 722e  umn name in str.
+000010e0: 204d 6f73 7420 6675 6e63 7469 6f6e 7320   Most functions 
+000010f0: 6163 6365 7074 2074 6869 7320 7479 7065  accept this type
+00001100: 2e0a 2020 2020 4966 2079 6f75 2073 7469  ..    If you sti
+00001110: 6c6c 2077 616e 7420 746f 2070 6173 7320  ll want to pass 
+00001120: 6120 6c69 7465 7261 6c20 746f 2069 742c  a literal to it,
+00001130: 2075 7365 2060 6c69 7428 7661 6c75 6529   use `lit(value)
+00001140: 602c 2077 6869 6368 2072 6574 7572 6e73  `, which returns
+00001150: 2061 2060 6043 6f6c 756d 6e60 6020 6f62   a ``Column`` ob
+00001160: 6a65 6374 2074 6861 7420 7265 7072 6573  ject that repres
+00001170: 656e 7473 2061 206c 6974 6572 616c 2076  ents a literal v
+00001180: 616c 7565 2e0a 0a20 2020 203e 3e3e 2064  alue...    >>> d
+00001190: 662e 7365 6c65 6374 2861 7667 2822 6122  f.select(avg("a"
+000011a0: 2929 2e73 686f 7728 290a 2020 2020 2d2d  )).show().    --
+000011b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+000011c0: 2020 207c 2241 5647 2822 2241 2222 2922     |"AVG(""A"")"
+000011d0: 2020 7c0a 2020 2020 2d2d 2d2d 2d2d 2d2d    |.    --------
+000011e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 207c 322e  --------.    |2.
+000011f0: 3030 3030 3030 2020 2020 2020 7c0a 2020  000000      |.  
+00001200: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00001210: 2d2d 0a20 2020 203c 424c 414e 4b4c 494e  --.    <BLANKLIN
+00001220: 453e 0a20 2020 203e 3e3e 2064 662e 7365  E>.    >>> df.se
+00001230: 6c65 6374 2861 7667 2863 6f6c 2822 6122  lect(avg(col("a"
+00001240: 2929 292e 7368 6f77 2829 0a20 2020 202d  ))).show().    -
+00001250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00001260: 2020 2020 7c22 4156 4728 2222 4122 2229      |"AVG(""A"")
+00001270: 2220 207c 0a20 2020 202d 2d2d 2d2d 2d2d  "  |.    -------
+00001280: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7c32  ---------.    |2
+00001290: 2e30 3030 3030 3020 2020 2020 207c 0a20  .000000      |. 
+000012a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+000012b0: 2d2d 2d0a 2020 2020 3c42 4c41 4e4b 4c49  ---.    <BLANKLI
+000012c0: 4e45 3e0a 0a20 202d 2060 604c 6974 6572  NE>..  - ``Liter
+000012d0: 616c 5479 7065 6060 2061 6363 6570 7473  alType`` accepts
+000012e0: 2061 2076 616c 7565 206f 6620 7479 7065   a value of type
+000012f0: 2060 6062 6f6f 6c60 602c 2060 6069 6e74   ``bool``, ``int
+00001300: 6060 2c20 6060 666c 6f61 7460 602c 2060  ``, ``float``, `
+00001310: 6073 7472 6060 2c20 6060 6279 7465 6172  `str``, ``bytear
+00001320: 7261 7960 602c 2060 6064 6563 696d 616c  ray``, ``decimal
+00001330: 2e44 6563 696d 616c 6060 2c0a 2020 2020  .Decimal``,.    
+00001340: 6060 6461 7465 7469 6d65 2e64 6174 6560  ``datetime.date`
+00001350: 602c 2060 6064 6174 6574 696d 652e 6461  `, ``datetime.da
+00001360: 7465 7469 6d65 6060 2c20 6060 6461 7465  tetime``, ``date
+00001370: 7469 6d65 2e74 696d 6560 602c 206f 7220  time.time``, or 
+00001380: 6060 6279 7465 7360 602e 2041 6e20 6578  ``bytes``. An ex
+00001390: 616d 706c 6520 6973 2074 6865 2074 6869  ample is the thi
+000013a0: 7264 2070 6172 616d 6574 6572 206f 6620  rd parameter of 
+000013b0: 3a66 756e 633a 606c 6561 6460 2e0a 0a20  :func:`lead`... 
+000013c0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+000013d0: 7465 7469 6d65 0a20 2020 203e 3e3e 2066  tetime.    >>> f
+000013e0: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+000013f0: 6f77 7061 726b 2e77 696e 646f 7720 696d  owpark.window im
+00001400: 706f 7274 2057 696e 646f 770a 2020 2020  port Window.    
+00001410: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
+00001420: 6c28 2264 2229 2c20 6c65 6164 2822 6422  l("d"), lead("d"
+00001430: 2c20 312c 2064 6174 6574 696d 652e 6461  , 1, datetime.da
+00001440: 7465 2832 3032 342c 2035 2c20 3138 292c  te(2024, 5, 18),
+00001450: 2046 616c 7365 292e 6f76 6572 2857 696e   False).over(Win
+00001460: 646f 772e 6f72 6465 725f 6279 2822 6422  dow.order_by("d"
+00001470: 2929 2e61 6c69 6173 2822 6c65 6164 5f64  )).alias("lead_d
+00001480: 6179 2229 292e 7368 6f77 2829 0a20 2020  ay")).show().   
+00001490: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+000014a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000014b0: 207c 2244 2220 2020 2020 2020 2020 7c22   |"D"         |"
+000014c0: 4c45 4144 5f44 4159 2220 207c 0a20 2020  LEAD_DAY"  |.   
+000014d0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+000014e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000014f0: 207c 3230 3232 2d30 332d 3136 2020 7c32   |2022-03-16  |2
+00001500: 3032 332d 3034 2d31 3720 207c 0a20 2020  023-04-17  |.   
+00001510: 207c 3230 3233 2d30 342d 3137 2020 7c32   |2023-04-17  |2
+00001520: 3032 342d 3035 2d31 3820 207c 0a20 2020  024-05-18  |.   
+00001530: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00001540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00001550: 203c 424c 414e 4b4c 494e 453e 0a0a 2020   <BLANKLINE>..  
+00001560: 2d20 6060 436f 6c75 6d6e 4f72 4c69 7465  - ``ColumnOrLite
+00001570: 7261 6c60 6020 6163 6365 7074 7320 6120  ral`` accepts a 
+00001580: 6060 436f 6c75 6d6e 6060 206f 626a 6563  ``Column`` objec
+00001590: 742c 206f 7220 6120 7661 6c75 6520 6f66  t, or a value of
+000015a0: 2060 604c 6974 6572 616c 5479 7065 6060   ``LiteralType``
+000015b0: 206d 656e 7469 6f6e 6564 2061 626f 7665   mentioned above
+000015c0: 2e0a 2020 2020 5468 6520 6469 6666 6572  ..    The differ
+000015d0: 656e 6365 2066 726f 6d20 6060 436f 6c75  ence from ``Colu
+000015e0: 6d6e 4f72 4c69 7465 7261 6c60 6020 6973  mnOrLiteral`` is
+000015f0: 2060 6043 6f6c 756d 6e4f 724c 6974 6572   ``ColumnOrLiter
+00001600: 616c 6060 2072 6567 6172 6473 2061 2073  al`` regards a s
+00001610: 7472 2076 616c 7565 2061 7320 6120 5351  tr value as a SQ
+00001620: 4c20 7374 7269 6e67 2076 616c 7565 2069  L string value i
+00001630: 6e73 7465 6164 206f 660a 2020 2020 6120  nstead of.    a 
+00001640: 636f 6c75 6d6e 206e 616d 652e 2057 6865  column name. Whe
+00001650: 6e20 6120 6675 6e63 7469 6f6e 2069 7320  n a function is 
+00001660: 6d75 6368 206d 6f72 6520 6c69 6b65 6c79  much more likely
+00001670: 2074 6f20 6163 6365 7074 2061 2053 514c   to accept a SQL
+00001680: 2063 6f6e 7374 616e 7420 7661 6c75 6520   constant value 
+00001690: 7468 616e 2061 2063 6f6c 756d 6e20 6578  than a column ex
+000016a0: 7072 6573 7369 6f6e 2c20 6060 436f 6c75  pression, ``Colu
+000016b0: 6d6e 4f72 4c69 7465 7261 6c60 600a 2020  mnOrLiteral``.  
+000016c0: 2020 6973 2075 7365 642e 2059 6574 2079    is used. Yet y
+000016d0: 6f75 2063 616e 2073 7469 6c6c 2070 6173  ou can still pas
+000016e0: 7320 696e 2061 2060 6043 6f6c 756d 6e60  s in a ``Column`
+000016f0: 6020 6f62 6a65 6374 2069 6620 796f 7520  ` object if you 
+00001700: 6e65 6564 2074 6f2e 2041 6e20 6578 616d  need to. An exam
+00001710: 706c 6520 6973 2074 6865 2073 6563 6f6e  ple is the secon
+00001720: 6420 7061 7261 6d65 7465 7220 6f66 0a20  d parameter of. 
+00001730: 2020 203a 6675 6e63 3a60 6077 6865 6e60     :func:``when`
+00001740: 602e 0a0a 2020 2020 3e3e 3e20 6466 2e73  `...    >>> df.s
+00001750: 656c 6563 7428 7768 656e 2864 665b 2261  elect(when(df["a
+00001760: 225d 203e 2032 2c20 2247 7265 6174 6572  "] > 2, "Greater
+00001770: 2074 6861 6e20 3222 292e 656c 7365 5f28   than 2").else_(
+00001780: 224c 6573 7320 7468 616e 2032 2229 2e61  "Less than 2").a
+00001790: 6c69 6173 2822 636f 6d70 6172 655f 7769  lias("compare_wi
+000017a0: 7468 5f32 2229 292e 7368 6f77 2829 0a20  th_2")).show(). 
+000017b0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+000017c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22 434f  -------.    |"CO
+000017d0: 4d50 4152 455f 5749 5448 5f32 2220 207c  MPARE_WITH_2"  |
+000017e0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+000017f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7c4c  ---------.    |L
+00001800: 6573 7320 7468 616e 2032 2020 2020 2020  ess than 2      
+00001810: 207c 0a20 2020 207c 4772 6561 7465 7220   |.    |Greater 
+00001820: 7468 616e 2032 2020 2020 7c0a 2020 2020  than 2    |.    
+00001830: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001840: 2d2d 2d2d 0a20 2020 203c 424c 414e 4b4c  ----.    <BLANKL
+00001850: 494e 453e 0a0a 2020 2d20 6060 696e 7460  INE>..  - ``int`
+00001860: 602c 2060 6062 6f6f 6c60 602c 2060 6073  `, ``bool``, ``s
+00001870: 7472 6060 2c20 6f72 2061 6e6f 7468 6572  tr``, or another
+00001880: 2073 7065 6369 6669 6320 7479 7065 2061   specific type a
+00001890: 6363 6570 7473 2061 2076 616c 7565 206f  ccepts a value o
+000018a0: 6620 7468 6174 2074 7970 652e 2041 6e20  f that type. An 
+000018b0: 6578 616d 706c 6520 6973 203a 6675 6e63  example is :func
+000018c0: 3a60 746f 5f64 6563 696d 616c 602e 0a0a  :`to_decimal`...
+000018d0: 2020 2020 3e3e 3e20 6466 2e77 6974 685f      >>> df.with_
+000018e0: 636f 6c75 6d6e 2822 6522 2c20 6c69 7428  column("e", lit(
+000018f0: 2231 2e32 2229 292e 7365 6c65 6374 2874  "1.2")).select(t
+00001900: 6f5f 6465 6369 6d61 6c28 2265 222c 2035  o_decimal("e", 5
+00001910: 2c20 3229 292e 7368 6f77 2829 0a20 2020  , 2)).show().   
+00001920: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00001930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00001940: 2020 207c 2254 4f5f 4445 4349 4d41 4c28     |"TO_DECIMAL(
+00001950: 2222 4522 222c 2035 2c20 3229 2220 207c  ""E"", 5, 2)"  |
+00001960: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+00001970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001980: 2d2d 0a20 2020 207c 312e 3230 2020 2020  --.    |1.20    
+00001990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019a0: 2020 207c 0a20 2020 207c 312e 3230 2020     |.    |1.20  
+000019b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019c0: 2020 2020 207c 0a20 2020 202d 2d2d 2d2d       |.    -----
+000019d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000019e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203c 424c  --------.    <BL
+000019f0: 414e 4b4c 494e 453e 0a0a 2020 2d20 6060  ANKLINE>..  - ``
+00001a00: 436f 6c75 6d6e 4f72 5371 6c45 7870 7260  ColumnOrSqlExpr`
+00001a10: 6020 6163 6365 7074 7320 6120 6060 436f  ` accepts a ``Co
+00001a20: 6c75 6d6e 6060 206f 626a 6563 742c 206f  lumn`` object, o
+00001a30: 7220 6120 5351 4c20 6578 7072 6573 7369  r a SQL expressi
+00001a40: 6f6e 2e20 466f 7220 696e 7374 616e 6365  on. For instance
+00001a50: 2c20 7468 6520 6669 7273 7420 7061 7261  , the first para
+00001a60: 6d65 7465 7220 696e 203a 6675 6e63 3a60  meter in :func:`
+00001a70: 6077 6865 6e60 602e 0a0a 2020 2020 3e3e  `when``...    >>
+00001a80: 3e20 6466 2e73 656c 6563 7428 7768 656e  > df.select(when
+00001a90: 2822 6120 3e20 3222 2c20 2247 7265 6174  ("a > 2", "Great
+00001aa0: 6572 2074 6861 6e20 3222 292e 656c 7365  er than 2").else
+00001ab0: 5f28 224c 6573 7320 7468 616e 2032 2229  _("Less than 2")
+00001ac0: 2e61 6c69 6173 2822 636f 6d70 6172 655f  .alias("compare_
+00001ad0: 7769 7468 5f32 2229 292e 7368 6f77 2829  with_2")).show()
+00001ae0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+00001af0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7c22  ---------.    |"
+00001b00: 434f 4d50 4152 455f 5749 5448 5f32 2220  COMPARE_WITH_2" 
+00001b10: 207c 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   |.    ---------
+00001b20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00001b30: 7c4c 6573 7320 7468 616e 2032 2020 2020  |Less than 2    
+00001b40: 2020 207c 0a20 2020 207c 4772 6561 7465     |.    |Greate
+00001b50: 7220 7468 616e 2032 2020 2020 7c0a 2020  r than 2    |.  
+00001b60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00001b70: 2d2d 2d2d 2d2d 0a20 2020 203c 424c 414e  ------.    <BLAN
+00001b80: 4b4c 494e 453e 0a22 2222 0a69 6d70 6f72  KLINE>.""".impor
+00001b90: 7420 6675 6e63 746f 6f6c 730a 696d 706f  t functools.impo
+00001ba0: 7274 2074 7970 696e 670a 6672 6f6d 2072  rt typing.from r
+00001bb0: 616e 646f 6d20 696d 706f 7274 2072 616e  andom import ran
+00001bc0: 6469 6e74 0a66 726f 6d20 7479 7065 7320  dint.from types 
+00001bd0: 696d 706f 7274 204d 6f64 756c 6554 7970  import ModuleTyp
+00001be0: 650a 6672 6f6d 2074 7970 696e 6720 696d  e.from typing im
+00001bf0: 706f 7274 2043 616c 6c61 626c 652c 2044  port Callable, D
+00001c00: 6963 742c 204c 6973 742c 204f 7074 696f  ict, List, Optio
+00001c10: 6e61 6c2c 2054 7570 6c65 2c20 556e 696f  nal, Tuple, Unio
+00001c20: 6e2c 206f 7665 726c 6f61 640a 0a69 6d70  n, overload..imp
+00001c30: 6f72 7420 736e 6f77 666c 616b 652e 736e  ort snowflake.sn
+00001c40: 6f77 7061 726b 0a69 6d70 6f72 7420 736e  owpark.import sn
+00001c50: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00001c60: 2e74 6162 6c65 5f66 756e 6374 696f 6e0a  .table_function.
+00001c70: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00001c80: 6e6f 7770 6172 6b2e 5f69 6e74 6572 6e61  nowpark._interna
+00001c90: 6c2e 616e 616c 797a 6572 2e65 7870 7265  l.analyzer.expre
+00001ca0: 7373 696f 6e20 696d 706f 7274 2028 0a20  ssion import (. 
+00001cb0: 2020 2043 6173 6557 6865 6e2c 0a20 2020     CaseWhen,.   
+00001cc0: 2046 756e 6374 696f 6e45 7870 7265 7373   FunctionExpress
+00001cd0: 696f 6e2c 0a20 2020 204c 6973 7441 6767  ion,.    ListAgg
+00001ce0: 2c0a 2020 2020 4c69 7465 7261 6c2c 0a20  ,.    Literal,. 
+00001cf0: 2020 204d 756c 7469 706c 6545 7870 7265     MultipleExpre
+00001d00: 7373 696f 6e2c 0a20 2020 2053 7461 722c  ssion,.    Star,
+00001d10: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
+00001d20: 652e 736e 6f77 7061 726b 2e5f 696e 7465  e.snowpark._inte
+00001d30: 726e 616c 2e61 6e61 6c79 7a65 722e 756e  rnal.analyzer.un
+00001d40: 6172 795f 6578 7072 6573 7369 6f6e 2069  ary_expression i
+00001d50: 6d70 6f72 7420 416c 6961 730a 6672 6f6d  mport Alias.from
+00001d60: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00001d70: 6172 6b2e 5f69 6e74 6572 6e61 6c2e 616e  ark._internal.an
+00001d80: 616c 797a 6572 2e77 696e 646f 775f 6578  alyzer.window_ex
+00001d90: 7072 6573 7369 6f6e 2069 6d70 6f72 7420  pression import 
+00001da0: 280a 2020 2020 4669 7273 7456 616c 7565  (.    FirstValue
+00001db0: 2c0a 2020 2020 4c61 672c 0a20 2020 204c  ,.    Lag,.    L
+00001dc0: 6173 7456 616c 7565 2c0a 2020 2020 4c65  astValue,.    Le
+00001dd0: 6164 2c0a 290a 6672 6f6d 2073 6e6f 7766  ad,.).from snowf
+00001de0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5f69  lake.snowpark._i
+00001df0: 6e74 6572 6e61 6c2e 7479 7065 5f75 7469  nternal.type_uti
+00001e00: 6c73 2069 6d70 6f72 7420 280a 2020 2020  ls import (.    
+00001e10: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c2c  ColumnOrLiteral,
+00001e20: 0a20 2020 2043 6f6c 756d 6e4f 724c 6974  .    ColumnOrLit
+00001e30: 6572 616c 5374 722c 0a20 2020 2043 6f6c  eralStr,.    Col
+00001e40: 756d 6e4f 724e 616d 652c 0a20 2020 2043  umnOrName,.    C
+00001e50: 6f6c 756d 6e4f 7253 716c 4578 7072 2c0a  olumnOrSqlExpr,.
+00001e60: 2020 2020 4c69 7465 7261 6c54 7970 652c      LiteralType,
+00001e70: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
+00001e80: 652e 736e 6f77 7061 726b 2e5f 696e 7465  e.snowpark._inte
+00001e90: 726e 616c 2e75 7469 6c73 2069 6d70 6f72  rnal.utils impor
+00001ea0: 7420 280a 2020 2020 7061 7273 655f 706f  t (.    parse_po
+00001eb0: 7369 7469 6f6e 616c 5f61 7267 735f 746f  sitional_args_to
+00001ec0: 5f6c 6973 742c 0a20 2020 2076 616c 6964  _list,.    valid
+00001ed0: 6174 655f 6f62 6a65 6374 5f6e 616d 652c  ate_object_name,
+00001ee0: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
+00001ef0: 652e 736e 6f77 7061 726b 2e63 6f6c 756d  e.snowpark.colum
+00001f00: 6e20 696d 706f 7274 2028 0a20 2020 2043  n import (.    C
+00001f10: 6173 6545 7870 722c 0a20 2020 2043 6f6c  aseExpr,.    Col
+00001f20: 756d 6e2c 0a20 2020 205f 746f 5f63 6f6c  umn,.    _to_col
+00001f30: 5f69 665f 6c69 742c 0a20 2020 205f 746f  _if_lit,.    _to
+00001f40: 5f63 6f6c 5f69 665f 7371 6c5f 6578 7072  _col_if_sql_expr
+00001f50: 2c0a 2020 2020 5f74 6f5f 636f 6c5f 6966  ,.    _to_col_if
+00001f60: 5f73 7472 2c0a 2020 2020 5f74 6f5f 636f  _str,.    _to_co
+00001f70: 6c5f 6966 5f73 7472 5f6f 725f 696e 742c  l_if_str_or_int,
+00001f80: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
+00001f90: 652e 736e 6f77 7061 726b 2e73 746f 7265  e.snowpark.store
+00001fa0: 645f 7072 6f63 6564 7572 6520 696d 706f  d_procedure impo
+00001fb0: 7274 2053 746f 7265 6450 726f 6365 6475  rt StoredProcedu
+00001fc0: 7265 0a66 726f 6d20 736e 6f77 666c 616b  re.from snowflak
+00001fd0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00001fe0: 2069 6d70 6f72 7420 4461 7461 5479 7065   import DataType
+00001ff0: 2c20 466c 6f61 7454 7970 652c 2053 7472  , FloatType, Str
+00002000: 696e 6754 7970 652c 2053 7472 7563 7454  ingType, StructT
+00002010: 7970 650a 6672 6f6d 2073 6e6f 7766 6c61  ype.from snowfla
+00002020: 6b65 2e73 6e6f 7770 6172 6b2e 7564 6620  ke.snowpark.udf 
+00002030: 696d 706f 7274 2055 7365 7244 6566 696e  import UserDefin
+00002040: 6564 4675 6e63 7469 6f6e 0a66 726f 6d20  edFunction.from 
+00002050: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00002060: 726b 2e75 6474 6620 696d 706f 7274 2055  rk.udtf import U
+00002070: 7365 7244 6566 696e 6564 5461 626c 6546  serDefinedTableF
+00002080: 756e 6374 696f 6e0a 0a23 2050 7974 686f  unction..# Pytho
+00002090: 6e20 332e 3820 6e65 6564 7320 746f 2075  n 3.8 needs to u
+000020a0: 7365 2074 7970 696e 672e 4974 6572 6162  se typing.Iterab
+000020b0: 6c65 2062 6563 6175 7365 2063 6f6c 6c65  le because colle
+000020c0: 6374 696f 6e73 2e61 6263 2e49 7465 7261  ctions.abc.Itera
+000020d0: 626c 6520 6973 206e 6f74 2073 7562 7363  ble is not subsc
+000020e0: 7269 7074 6162 6c65 0a23 2050 7974 686f  riptable.# Pytho
+000020f0: 6e20 332e 3920 6361 6e20 7573 6520 626f  n 3.9 can use bo
+00002100: 7468 0a23 2050 7974 686f 6e20 332e 3130  th.# Python 3.10
+00002110: 206e 6565 6473 2074 6f20 7573 6520 636f   needs to use co
+00002120: 6c6c 6563 7469 6f6e 732e 6162 632e 4974  llections.abc.It
+00002130: 6572 6162 6c65 2062 6563 6175 7365 2074  erable because t
+00002140: 7970 696e 672e 4974 6572 6162 6c65 2069  yping.Iterable i
+00002150: 7320 7265 6d6f 7665 640a 7472 793a 0a20  s removed.try:. 
+00002160: 2020 2066 726f 6d20 7479 7069 6e67 2069     from typing i
+00002170: 6d70 6f72 7420 4974 6572 6162 6c65 0a65  mport Iterable.e
+00002180: 7863 6570 7420 496d 706f 7274 4572 726f  xcept ImportErro
+00002190: 723a 0a20 2020 2066 726f 6d20 636f 6c6c  r:.    from coll
+000021a0: 6563 7469 6f6e 732e 6162 6320 696d 706f  ections.abc impo
+000021b0: 7274 2049 7465 7261 626c 650a 0a0a 6465  rt Iterable...de
+000021c0: 6620 636f 6c28 636f 6c5f 6e61 6d65 3a20  f col(col_name: 
+000021d0: 7374 7229 202d 3e20 436f 6c75 6d6e 3a0a  str) -> Column:.
+000021e0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+000021f0: 6865 203a 636c 6173 733a 607e 736e 6f77  he :class:`~snow
+00002200: 666c 616b 652e 736e 6f77 7061 726b 2e43  flake.snowpark.C
+00002210: 6f6c 756d 6e60 2077 6974 6820 7468 6520  olumn` with the 
+00002220: 7370 6563 6966 6965 6420 6e61 6d65 2e0a  specified name..
+00002230: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00002240: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00002250: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
+00002260: 6563 7420 3120 6173 2061 2229 0a20 2020  ect 1 as a").   
+00002270: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00002280: 6374 2863 6f6c 2822 6122 2929 2e63 6f6c  ct(col("a")).col
+00002290: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000022a0: 526f 7728 413d 3129 5d0a 2020 2020 2222  Row(A=1)].    ""
+000022b0: 220a 2020 2020 7265 7475 726e 2043 6f6c  ".    return Col
+000022c0: 756d 6e28 636f 6c5f 6e61 6d65 290a 0a0a  umn(col_name)...
+000022d0: 6465 6620 636f 6c75 6d6e 2863 6f6c 5f6e  def column(col_n
+000022e0: 616d 653a 2073 7472 2920 2d3e 2043 6f6c  ame: str) -> Col
+000022f0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00002300: 726e 7320 6120 3a63 6c61 7373 3a60 7e73  rns a :class:`~s
+00002310: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00002320: 6b2e 436f 6c75 6d6e 6020 7769 7468 2074  k.Column` with t
+00002330: 6865 2073 7065 6369 6669 6564 206e 616d  he specified nam
+00002340: 652e 2041 6c69 6173 2066 6f72 2063 6f6c  e. Alias for col
+00002350: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00002360: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00002370: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
+00002380: 656c 6563 7420 3120 6173 2061 2229 0a20  elect 1 as a"). 
+00002390: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+000023a0: 6c65 6374 2863 6f6c 756d 6e28 2261 2229  lect(column("a")
+000023b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000023c0: 2020 2020 5b52 6f77 2841 3d31 295d 0a20      [Row(A=1)]. 
+000023d0: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+000023e0: 6e20 436f 6c75 6d6e 2863 6f6c 5f6e 616d  n Column(col_nam
+000023f0: 6529 0a0a 0a64 6566 206c 6974 286c 6974  e)...def lit(lit
+00002400: 6572 616c 3a20 4c69 7465 7261 6c54 7970  eral: LiteralTyp
+00002410: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00002420: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
+00002430: 7320 6120 3a63 6c61 7373 3a60 7e73 6e6f  s a :class:`~sno
+00002440: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00002450: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
+00002460: 6f6e 2066 6f72 2061 206c 6974 6572 616c  on for a literal
+00002470: 2076 616c 7565 2e0a 2020 2020 4974 2073   value..    It s
+00002480: 7570 706f 7274 7320 6261 7369 6320 5079  upports basic Py
+00002490: 7468 6f6e 2064 6174 6120 7479 7065 732c  thon data types,
+000024a0: 2069 6e63 6c75 6469 6e67 2060 6069 6e74   including ``int
+000024b0: 6060 2c20 6060 666c 6f61 7460 602c 2060  ``, ``float``, `
+000024c0: 6073 7472 6060 2c0a 2020 2020 6060 626f  `str``,.    ``bo
+000024d0: 6f6c 6060 2c20 6060 6279 7465 7360 602c  ol``, ``bytes``,
+000024e0: 2060 6062 7974 6561 7272 6179 6060 2c20   ``bytearray``, 
+000024f0: 6060 6461 7465 7469 6d65 2e74 696d 6560  ``datetime.time`
+00002500: 602c 2060 6064 6174 6574 696d 652e 6461  `, ``datetime.da
+00002510: 7465 6060 2c0a 2020 2020 6060 6461 7465  te``,.    ``date
+00002520: 7469 6d65 2e64 6174 6574 696d 6560 6020  time.datetime`` 
+00002530: 616e 6420 6060 6465 6369 6d61 6c2e 4465  and ``decimal.De
+00002540: 6369 6d61 6c60 602e 2041 6c73 6f2c 2069  cimal``. Also, i
+00002550: 7420 7375 7070 6f72 7473 2050 7974 686f  t supports Pytho
+00002560: 6e20 7374 7275 6374 7572 6564 2064 6174  n structured dat
+00002570: 6120 7479 7065 732c 0a20 2020 2069 6e63  a types,.    inc
+00002580: 6c75 6469 6e67 2060 606c 6973 7460 602c  luding ``list``,
+00002590: 2060 6074 7570 6c65 6060 2061 6e64 2060   ``tuple`` and `
+000025a0: 6064 6963 7460 602c 2062 7574 2074 6869  `dict``, but thi
+000025b0: 7320 636f 6e74 6169 6e65 7220 6d75 7374  s container must
+000025c0: 0a20 2020 2062 6520 4a53 4f4e 2073 6572  .    be JSON ser
+000025d0: 6961 6c69 7a61 626c 652e 0a0a 2020 2020  ializable...    
+000025e0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000025f0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00002600: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+00002610: 3e3e 2063 6f6c 756d 6e73 203d 205b 6c69  >> columns = [li
+00002620: 7428 3129 2c20 6c69 7428 2231 2229 2c20  t(1), lit("1"), 
+00002630: 6c69 7428 312e 3029 2c20 6c69 7428 5472  lit(1.0), lit(Tr
+00002640: 7565 292c 206c 6974 2862 2773 6e6f 7727  ue), lit(b'snow'
+00002650: 292c 206c 6974 2864 6174 6574 696d 652e  ), lit(datetime.
+00002660: 6461 7465 2832 3032 332c 2032 2c20 3229  date(2023, 2, 2)
+00002670: 292c 206c 6974 285b 312c 2032 5d29 2c20  ), lit([1, 2]), 
+00002680: 6c69 7428 7b22 736e 6f77 223a 2022 666c  lit({"snow": "fl
+00002690: 616b 6522 7d29 5d0a 2020 2020 2020 2020  ake"})].        
+000026a0: 3e3e 3e20 7365 7373 696f 6e2e 6372 6561  >>> session.crea
+000026b0: 7465 5f64 6174 6166 7261 6d65 285b 5b5d  te_dataframe([[]
+000026c0: 5d29 2e73 656c 6563 7428 5b63 2e61 735f  ]).select([c.as_
+000026d0: 2873 7472 2869 2929 2066 6f72 2069 2c20  (str(i)) for i, 
+000026e0: 6320 696e 2065 6e75 6d65 7261 7465 2863  c in enumerate(c
+000026f0: 6f6c 756d 6e73 295d 292e 7368 6f77 2829  olumns)]).show()
 00002700: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
 00002710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00002720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00002730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00002740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00002750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002760: 0a20 2020 2020 2020 207c 3120 2020 207c  .        |1    |
-00002770: 3120 2020 207c 312e 3020 207c 5472 7565  1    |1.0  |True
-00002780: 2020 7c62 7974 6561 7272 6179 2862 2773    |bytearray(b's
-00002790: 6e6f 7727 2920 207c 3230 3233 2d30 322d  now')  |2023-02-
-000027a0: 3032 2020 7c5b 2020 2020 207c 7b20 2020  02  |[     |{   
+00002760: 0a20 2020 2020 2020 207c 2230 2220 207c  .        |"0"  |
+00002770: 2231 2220 207c 2232 2220 207c 2233 2220  "1"  |"2"  |"3" 
+00002780: 2020 7c22 3422 2020 2020 2020 2020 2020    |"4"          
+00002790: 2020 2020 2020 207c 2235 2220 2020 2020         |"5"     
+000027a0: 2020 2020 7c22 3622 2020 207c 2237 2220      |"6"   |"7" 
 000027b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000027c0: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
-000027d0: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
-000027e0: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
-000027f0: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-00002800: 2020 2020 7c20 2031 2c20 207c 2020 2273      |  1,  |  "s
-00002810: 6e6f 7722 3a20 2266 6c61 6b65 2220 207c  now": "flake"  |
-00002820: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
-00002830: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
-00002840: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
-00002850: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-00002860: 2020 2020 7c20 2032 2020 207c 7d20 2020      |  2   |}   
+000027c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000027d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000027e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000027f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002820: 0a20 2020 2020 2020 207c 3120 2020 207c  .        |1    |
+00002830: 3120 2020 207c 312e 3020 207c 5472 7565  1    |1.0  |True
+00002840: 2020 7c62 7974 6561 7272 6179 2862 2773    |bytearray(b's
+00002850: 6e6f 7727 2920 207c 3230 3233 2d30 322d  now')  |2023-02-
+00002860: 3032 2020 7c5b 2020 2020 207c 7b20 2020  02  |[     |{   
 00002870: 2020 2020 2020 2020 2020 2020 2020 207c                 |
 00002880: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
 00002890: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
 000028a0: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
 000028b0: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-000028c0: 2020 2020 7c5d 2020 2020 207c 2020 2020      |]     |    
-000028d0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000028e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000028f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002940: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00002950: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00002960: 2072 6574 7572 6e20 6c69 7465 7261 6c20   return literal 
-00002970: 6966 2069 7369 6e73 7461 6e63 6528 6c69  if isinstance(li
-00002980: 7465 7261 6c2c 2043 6f6c 756d 6e29 2065  teral, Column) e
-00002990: 6c73 6520 436f 6c75 6d6e 284c 6974 6572  lse Column(Liter
-000029a0: 616c 286c 6974 6572 616c 2929 0a0a 0a64  al(literal))...d
-000029b0: 6566 2073 716c 5f65 7870 7228 7371 6c3a  ef sql_expr(sql:
-000029c0: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
-000029d0: 0a20 2020 2022 2222 4372 6561 7465 7320  .    """Creates 
-000029e0: 6120 3a63 6c61 7373 3a60 7e73 6e6f 7766  a :class:`~snowf
-000029f0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 436f  lake.snowpark.Co
-00002a00: 6c75 6d6e 6020 6578 7072 6573 7369 6f6e  lumn` expression
-00002a10: 2066 726f 6d20 7261 7720 5351 4c20 7465   from raw SQL te
-00002a20: 7874 2e0a 2020 2020 4e6f 7465 2074 6861  xt..    Note tha
-00002a30: 7420 7468 6520 6675 6e63 7469 6f6e 2064  t the function d
-00002a40: 6f65 7320 6e6f 7420 696e 7465 7270 7265  oes not interpre
-00002a50: 7420 6f72 2063 6865 636b 2074 6865 2053  t or check the S
-00002a60: 514c 2074 6578 742e 2222 220a 2020 2020  QL text.""".    
-00002a70: 7265 7475 726e 2043 6f6c 756d 6e2e 5f65  return Column._e
-00002a80: 7870 7228 7371 6c29 0a0a 0a64 6566 2063  xpr(sql)...def c
-00002a90: 7572 7265 6e74 5f73 6573 7369 6f6e 2829  urrent_session()
-00002aa0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00002ab0: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
-00002ac0: 6120 756e 6971 7565 2073 7973 7465 6d20  a unique system 
-00002ad0: 6964 656e 7469 6669 6572 2066 6f72 2074  identifier for t
-00002ae0: 6865 2053 6e6f 7766 6c61 6b65 2073 6573  he Snowflake ses
-00002af0: 7369 6f6e 2063 6f72 7265 7370 6f6e 6469  sion correspondi
-00002b00: 6e67 2074 6f20 7468 6520 7072 6573 656e  ng to the presen
-00002b10: 7420 636f 6e6e 6563 7469 6f6e 2e0a 2020  t connection..  
-00002b20: 2020 5468 6973 2077 696c 6c20 6765 6e65    This will gene
-00002b30: 7261 6c6c 7920 6265 2061 2073 7973 7465  rally be a syste
-00002b40: 6d2d 6765 6e65 7261 7465 6420 616c 7068  m-generated alph
-00002b50: 616e 756d 6572 6963 2073 7472 696e 672e  anumeric string.
-00002b60: 2049 7420 6973 204e 4f54 2064 6572 6976   It is NOT deriv
-00002b70: 6564 2066 726f 6d20 7468 6520 7573 6572  ed from the user
-00002b80: 206e 616d 6520 6f72 2075 7365 7220 6163   name or user ac
-00002b90: 636f 756e 742e 0a0a 2020 2020 4578 616d  count...    Exam
-00002ba0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00002bb0: 2023 2052 6574 7572 6e20 7265 7375 6c74   # Return result
-00002bc0: 2069 7320 7469 6564 2074 6f20 7365 7373   is tied to sess
-00002bd0: 696f 6e2c 2073 6f20 7765 206f 6e6c 7920  ion, so we only 
-00002be0: 7465 7374 2069 6620 7468 6520 7265 7375  test if the resu
-00002bf0: 6c74 2065 7869 7374 730a 2020 2020 2020  lt exists.      
-00002c00: 2020 3e3e 3e20 7265 7375 6c74 203d 2073    >>> result = s
-00002c10: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00002c20: 7461 6672 616d 6528 5b31 5d29 2e73 656c  taframe([1]).sel
-00002c30: 6563 7428 6375 7272 656e 745f 7365 7373  ect(current_sess
-00002c40: 696f 6e28 2929 2e63 6f6c 6c65 6374 2829  ion()).collect()
-00002c50: 0a20 2020 2020 2020 203e 3e3e 2061 7373  .        >>> ass
-00002c60: 6572 7420 7265 7375 6c74 5b30 5d5b 2743  ert result[0]['C
-00002c70: 5552 5245 4e54 5f53 4553 5349 4f4e 2829  URRENT_SESSION()
-00002c80: 275d 2069 7320 6e6f 7420 4e6f 6e65 0a20  '] is not None. 
-00002c90: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-00002ca0: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
-00002cb0: 6e74 5f73 6573 7369 6f6e 2229 2829 0a0a  nt_session")()..
-00002cc0: 0a64 6566 2063 7572 7265 6e74 5f73 7461  .def current_sta
-00002cd0: 7465 6d65 6e74 2829 202d 3e20 436f 6c75  tement() -> Colu
-00002ce0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00002cf0: 5265 7475 726e 7320 7468 6520 5351 4c20  Returns the SQL 
-00002d00: 7465 7874 206f 6620 7468 6520 7374 6174  text of the stat
-00002d10: 656d 656e 7420 7468 6174 2069 7320 6375  ement that is cu
-00002d20: 7272 656e 746c 7920 6578 6563 7574 696e  rrently executin
-00002d30: 672e 0a0a 2020 2020 4578 616d 706c 653a  g...    Example:
-00002d40: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
-00002d50: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
-00002d60: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
-00002d70: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
-00002d80: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
-00002d90: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
-00002da0: 3e20 7365 7373 696f 6e2e 6372 6561 7465  > session.create
-00002db0: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
-00002dc0: 7365 6c65 6374 2863 7572 7265 6e74 5f73  select(current_s
-00002dd0: 7461 7465 6d65 6e74 2829 292e 636f 6c6c  tatement()).coll
-00002de0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00002df0: 6f77 2843 5552 5245 4e54 5f53 5441 5445  ow(CURRENT_STATE
-00002e00: 4d45 4e54 2829 3d27 5345 4c45 4354 2063  MENT()='SELECT c
-00002e10: 7572 7265 6e74 5f73 7461 7465 6d65 6e74  urrent_statement
-00002e20: 2829 2046 524f 4d20 2820 5345 4c45 4354  () FROM ( SELECT
-00002e30: 2022 5f31 2220 4652 4f4d 2028 2053 454c   "_1" FROM ( SEL
-00002e40: 4543 5420 2431 2041 5320 225f 3122 2046  ECT $1 AS "_1" F
-00002e50: 524f 4d20 2056 414c 5545 5320 2831 203a  ROM  VALUES (1 :
-00002e60: 3a20 494e 5429 2929 2729 5d0a 2020 2020  : INT)))')].    
-00002e70: 2222 220a 2020 2020 7265 7475 726e 2062  """.    return b
-00002e80: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
-00002e90: 7374 6174 656d 656e 7422 2928 290a 0a0a  statement")()...
-00002ea0: 6465 6620 6375 7272 656e 745f 7573 6572  def current_user
-00002eb0: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-00002ec0: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-00002ed0: 7320 7468 6520 6e61 6d65 206f 6620 7468  s the name of th
-00002ee0: 6520 7573 6572 2063 7572 7265 6e74 6c79  e user currently
-00002ef0: 206c 6f67 6765 6420 696e 746f 2074 6865   logged into the
-00002f00: 2073 7973 7465 6d2e 0a0a 2020 2020 4578   system...    Ex
-00002f10: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00002f20: 3e3e 2023 2052 6574 7572 6e20 7265 7375  >> # Return resu
-00002f30: 6c74 2069 7320 7469 6564 2074 6f20 7365  lt is tied to se
-00002f40: 7373 696f 6e2c 2073 6f20 7765 206f 6e6c  ssion, so we onl
-00002f50: 7920 7465 7374 2069 6620 7468 6520 7265  y test if the re
-00002f60: 7375 6c74 2065 7869 7374 730a 2020 2020  sult exists.    
-00002f70: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
-00002f80: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00002f90: 6461 7461 6672 616d 6528 5b31 5d29 2e73  dataframe([1]).s
-00002fa0: 656c 6563 7428 6375 7272 656e 745f 7573  elect(current_us
-00002fb0: 6572 2829 292e 636f 6c6c 6563 7428 290a  er()).collect().
-00002fc0: 2020 2020 2020 2020 3e3e 3e20 6173 7365          >>> asse
-00002fd0: 7274 2072 6573 756c 745b 305d 5b27 4355  rt result[0]['CU
-00002fe0: 5252 454e 545f 5553 4552 2829 275d 2069  RRENT_USER()'] i
-00002ff0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2022  s not None.    "
-00003000: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00003010: 696c 7469 6e28 2263 7572 7265 6e74 5f75  iltin("current_u
-00003020: 7365 7222 2928 290a 0a0a 6465 6620 6375  ser")()...def cu
-00003030: 7272 656e 745f 7665 7273 696f 6e28 2920  rrent_version() 
-00003040: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00003050: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-00003060: 6865 2063 7572 7265 6e74 2053 6e6f 7766  he current Snowf
-00003070: 6c61 6b65 2076 6572 7369 6f6e 2e0a 0a20  lake version... 
-00003080: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00003090: 2020 2020 3e3e 3e20 2320 5265 7475 726e      >>> # Return
-000030a0: 2072 6573 756c 7420 6973 2074 6965 6420   result is tied 
-000030b0: 746f 2073 6573 7369 6f6e 2c20 736f 2077  to session, so w
-000030c0: 6520 6f6e 6c79 2074 6573 7420 6966 2074  e only test if t
-000030d0: 6865 2072 6573 756c 7420 6578 6973 7473  he result exists
-000030e0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-000030f0: 756c 7420 3d20 7365 7373 696f 6e2e 6372  ult = session.cr
-00003100: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00003110: 315d 292e 7365 6c65 6374 2863 7572 7265  1]).select(curre
-00003120: 6e74 5f76 6572 7369 6f6e 2829 292e 636f  nt_version()).co
-00003130: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00003140: 3e3e 3e20 6173 7365 7274 2072 6573 756c  >>> assert resul
-00003150: 745b 305d 5b27 4355 5252 454e 545f 5645  t[0]['CURRENT_VE
-00003160: 5253 494f 4e28 2927 5d20 6973 206e 6f74  RSION()'] is not
-00003170: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
-00003180: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00003190: 2822 6375 7272 656e 745f 7665 7273 696f  ("current_versio
-000031a0: 6e22 2928 290a 0a0a 6465 6620 6375 7272  n")()...def curr
-000031b0: 656e 745f 7761 7265 686f 7573 6528 2920  ent_warehouse() 
-000031c0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-000031d0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-000031e0: 6865 206e 616d 6520 6f66 2074 6865 2077  he name of the w
-000031f0: 6172 6568 6f75 7365 2069 6e20 7573 6520  arehouse in use 
-00003200: 666f 7220 7468 6520 6375 7272 656e 7420  for the current 
-00003210: 7365 7373 696f 6e2e 0a0a 2020 2020 4578  session...    Ex
-00003220: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00003230: 3e3e 2023 2052 6574 7572 6e20 7265 7375  >> # Return resu
-00003240: 6c74 2069 7320 7469 6564 2074 6f20 7365  lt is tied to se
-00003250: 7373 696f 6e2c 2073 6f20 7765 206f 6e6c  ssion, so we onl
-00003260: 7920 7465 7374 2069 6620 7468 6520 7265  y test if the re
-00003270: 7375 6c74 2065 7869 7374 730a 2020 2020  sult exists.    
-00003280: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
-00003290: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-000032a0: 6461 7461 6672 616d 6528 5b31 5d29 2e73  dataframe([1]).s
-000032b0: 656c 6563 7428 6375 7272 656e 745f 7761  elect(current_wa
-000032c0: 7265 686f 7573 6528 2929 2e63 6f6c 6c65  rehouse()).colle
-000032d0: 6374 2829 0a20 2020 2020 2020 203e 3e3e  ct().        >>>
-000032e0: 2061 7373 6572 7420 7265 7375 6c74 5b30   assert result[0
-000032f0: 5d5b 2743 5552 5245 4e54 5f57 4152 4548  ]['CURRENT_WAREH
-00003300: 4f55 5345 2829 275d 2069 7320 6e6f 7420  OUSE()'] is not 
-00003310: 4e6f 6e65 0a20 2020 2022 2222 0a20 2020  None.    """.   
-00003320: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00003330: 2263 7572 7265 6e74 5f77 6172 6568 6f75  "current_warehou
-00003340: 7365 2229 2829 0a0a 0a64 6566 2063 7572  se")()...def cur
-00003350: 7265 6e74 5f64 6174 6162 6173 6528 2920  rent_database() 
-00003360: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00003370: 2222 5265 7475 726e 7320 7468 6520 6e61  ""Returns the na
-00003380: 6d65 206f 6620 7468 6520 6461 7461 6261  me of the databa
-00003390: 7365 2069 6e20 7573 6520 666f 7220 7468  se in use for th
-000033a0: 6520 6375 7272 656e 7420 7365 7373 696f  e current sessio
-000033b0: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
-000033c0: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
-000033d0: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
-000033e0: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
-000033f0: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
-00003400: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
-00003410: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
-00003420: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
-00003430: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00003440: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
-00003450: 6375 7272 656e 745f 6461 7461 6261 7365  current_database
-00003460: 2829 292e 636f 6c6c 6563 7428 290a 2020  ()).collect().  
-00003470: 2020 2020 2020 3e3e 3e20 6173 7365 7274        >>> assert
-00003480: 2072 6573 756c 745b 305d 5b27 4355 5252   result[0]['CURR
-00003490: 454e 545f 4441 5441 4241 5345 2829 275d  ENT_DATABASE()']
-000034a0: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
-000034b0: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
-000034c0: 6275 696c 7469 6e28 2263 7572 7265 6e74  builtin("current
-000034d0: 5f64 6174 6162 6173 6522 2928 290a 0a0a  _database")()...
-000034e0: 6465 6620 6375 7272 656e 745f 726f 6c65  def current_role
-000034f0: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-00003500: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00003510: 206e 616d 6520 6f66 2074 6865 2072 6f6c   name of the rol
-00003520: 6520 696e 2075 7365 2066 6f72 2074 6865  e in use for the
-00003530: 2063 7572 7265 6e74 2073 6573 7369 6f6e   current session
-00003540: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
-00003550: 2020 2020 2020 2020 3e3e 3e20 2320 5265          >>> # Re
-00003560: 7475 726e 2072 6573 756c 7420 6973 2074  turn result is t
-00003570: 6965 6420 746f 2073 6573 7369 6f6e 2c20  ied to session, 
-00003580: 736f 2077 6520 6f6e 6c79 2074 6573 7420  so we only test 
-00003590: 6966 2074 6865 2072 6573 756c 7420 6578  if the result ex
-000035a0: 6973 7473 0a20 2020 2020 2020 203e 3e3e  ists.        >>>
-000035b0: 2072 6573 756c 7420 3d20 7365 7373 696f   result = sessio
-000035c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000035d0: 6d65 285b 315d 292e 7365 6c65 6374 2863  me([1]).select(c
-000035e0: 7572 7265 6e74 5f72 6f6c 6528 2929 2e63  urrent_role()).c
-000035f0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00003600: 203e 3e3e 2061 7373 6572 7420 7265 7375   >>> assert resu
-00003610: 6c74 5b30 5d5b 2743 5552 5245 4e54 5f52  lt[0]['CURRENT_R
-00003620: 4f4c 4528 2927 5d20 6973 206e 6f74 204e  OLE()'] is not N
-00003630: 6f6e 650a 2020 2020 2222 220a 2020 2020  one.    """.    
-00003640: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00003650: 6375 7272 656e 745f 726f 6c65 2229 2829  current_role")()
-00003660: 0a0a 0a64 6566 2063 7572 7265 6e74 5f73  ...def current_s
-00003670: 6368 656d 6128 2920 2d3e 2043 6f6c 756d  chema() -> Colum
-00003680: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00003690: 7320 7468 6520 6e61 6d65 206f 6620 7468  s the name of th
-000036a0: 6520 7363 6865 6d61 2069 6e20 7573 6520  e schema in use 
-000036b0: 666f 7220 7468 6520 6375 7272 656e 7420  for the current 
-000036c0: 7365 7373 696f 6e2e 0a0a 2020 2020 4578  session...    Ex
-000036d0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-000036e0: 3e3e 2023 2052 6574 7572 6e20 7265 7375  >> # Return resu
-000036f0: 6c74 2069 7320 7469 6564 2074 6f20 7365  lt is tied to se
-00003700: 7373 696f 6e2c 2073 6f20 7765 206f 6e6c  ssion, so we onl
-00003710: 7920 7465 7374 2069 6620 7468 6520 7265  y test if the re
-00003720: 7375 6c74 2065 7869 7374 730a 2020 2020  sult exists.    
-00003730: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
-00003740: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00003750: 6461 7461 6672 616d 6528 5b31 5d29 2e73  dataframe([1]).s
-00003760: 656c 6563 7428 6375 7272 656e 745f 7363  elect(current_sc
-00003770: 6865 6d61 2829 292e 636f 6c6c 6563 7428  hema()).collect(
-00003780: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
-00003790: 7365 7274 2072 6573 756c 745b 305d 5b27  sert result[0]['
-000037a0: 4355 5252 454e 545f 5343 4845 4d41 2829  CURRENT_SCHEMA()
-000037b0: 275d 2069 7320 6e6f 7420 4e6f 6e65 0a20  '] is not None. 
-000037c0: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-000037d0: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
-000037e0: 6e74 5f73 6368 656d 6122 2928 290a 0a0a  nt_schema")()...
-000037f0: 6465 6620 6375 7272 656e 745f 7363 6865  def current_sche
-00003800: 6d61 7328 2920 2d3e 2043 6f6c 756d 6e3a  mas() -> Column:
-00003810: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00003820: 6163 7469 7665 2073 6561 7263 6820 7061  active search pa
-00003830: 7468 2073 6368 656d 6173 2e0a 0a20 2020  th schemas...   
-00003840: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-00003850: 2020 3e3e 3e20 2320 5265 7475 726e 2072    >>> # Return r
-00003860: 6573 756c 7420 6973 2074 6965 6420 746f  esult is tied to
-00003870: 2073 6573 7369 6f6e 2c20 736f 2077 6520   session, so we 
-00003880: 6f6e 6c79 2074 6573 7420 6966 2074 6865  only test if the
-00003890: 2072 6573 756c 7420 6578 6973 7473 0a20   result exists. 
-000038a0: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-000038b0: 7420 3d20 7365 7373 696f 6e2e 6372 6561  t = session.crea
-000038c0: 7465 5f64 6174 6166 7261 6d65 285b 315d  te_dataframe([1]
-000038d0: 292e 7365 6c65 6374 2863 7572 7265 6e74  ).select(current
-000038e0: 5f73 6368 656d 6173 2829 292e 636f 6c6c  _schemas()).coll
-000038f0: 6563 7428 290a 2020 2020 2020 2020 3e3e  ect().        >>
-00003900: 3e20 6173 7365 7274 2072 6573 756c 745b  > assert result[
-00003910: 305d 5b27 4355 5252 454e 545f 5343 4845  0]['CURRENT_SCHE
-00003920: 4d41 5328 2927 5d20 6973 206e 6f74 204e  MAS()'] is not N
-00003930: 6f6e 650a 2020 2020 2222 220a 2020 2020  one.    """.    
-00003940: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00003950: 6375 7272 656e 745f 7363 6865 6d61 7322  current_schemas"
-00003960: 2928 290a 0a0a 6465 6620 6375 7272 656e  )()...def curren
-00003970: 745f 7265 6769 6f6e 2829 202d 3e20 436f  t_region() -> Co
-00003980: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00003990: 7572 6e73 2074 6865 206e 616d 6520 6f66  urns the name of
-000039a0: 2074 6865 2072 6567 696f 6e20 666f 7220   the region for 
-000039b0: 7468 6520 6163 636f 756e 7420 7768 6572  the account wher
-000039c0: 6520 7468 6520 6375 7272 656e 7420 7573  e the current us
-000039d0: 6572 2069 7320 6c6f 6767 6564 2069 6e2e  er is logged in.
-000039e0: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
-000039f0: 2020 2020 2020 203e 3e3e 2023 2052 6574         >>> # Ret
-00003a00: 7572 6e20 7265 7375 6c74 2069 7320 7469  urn result is ti
-00003a10: 6564 2074 6f20 7365 7373 696f 6e2c 2073  ed to session, s
-00003a20: 6f20 7765 206f 6e6c 7920 7465 7374 2069  o we only test i
-00003a30: 6620 7468 6520 7265 7375 6c74 2065 7869  f the result exi
-00003a40: 7374 730a 2020 2020 2020 2020 3e3e 3e20  sts.        >>> 
-00003a50: 7265 7375 6c74 203d 2073 6573 7369 6f6e  result = session
-00003a60: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00003a70: 6528 5b31 5d29 2e73 656c 6563 7428 6375  e([1]).select(cu
-00003a80: 7272 656e 745f 7265 6769 6f6e 2829 292e  rrent_region()).
-00003a90: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00003aa0: 2020 3e3e 3e20 6173 7365 7274 2072 6573    >>> assert res
-00003ab0: 756c 745b 305d 5b27 4355 5252 454e 545f  ult[0]['CURRENT_
-00003ac0: 5245 4749 4f4e 2829 275d 2069 7320 6e6f  REGION()'] is no
-00003ad0: 7420 4e6f 6e65 0a20 2020 2022 2222 0a20  t None.    """. 
-00003ae0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00003af0: 6e28 2263 7572 7265 6e74 5f72 6567 696f  n("current_regio
-00003b00: 6e22 2928 290a 0a0a 6465 6620 6375 7272  n")()...def curr
-00003b10: 656e 745f 6176 6169 6c61 626c 655f 726f  ent_available_ro
-00003b20: 6c65 7328 2920 2d3e 2043 6f6c 756d 6e3a  les() -> Column:
-00003b30: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00003b40: 6120 4a53 4f4e 2073 7472 696e 6720 7468  a JSON string th
-00003b50: 6174 206c 6973 7473 2061 6c6c 2072 6f6c  at lists all rol
-00003b60: 6573 2067 7261 6e74 6564 2074 6f20 7468  es granted to th
-00003b70: 6520 6375 7272 656e 7420 7573 6572 2e0a  e current user..
-00003b80: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-00003b90: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
-00003ba0: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
-00003bb0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
-00003bc0: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
-00003bd0: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
-00003be0: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
-00003bf0: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
-00003c00: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00003c10: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
-00003c20: 7265 6e74 5f61 7661 696c 6162 6c65 5f72  rent_available_r
-00003c30: 6f6c 6573 2829 292e 636f 6c6c 6563 7428  oles()).collect(
-00003c40: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
-00003c50: 7365 7274 2072 6573 756c 745b 305d 5b27  sert result[0]['
-00003c60: 4355 5252 454e 545f 4156 4149 4c41 424c  CURRENT_AVAILABL
-00003c70: 455f 524f 4c45 5328 2927 5d20 6973 206e  E_ROLES()'] is n
-00003c80: 6f74 204e 6f6e 650a 2020 2020 2222 220a  ot None.    """.
-00003c90: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00003ca0: 696e 2822 6375 7272 656e 745f 6176 6169  in("current_avai
-00003cb0: 6c61 626c 655f 726f 6c65 7322 2928 290a  lable_roles")().
-00003cc0: 0a0a 6465 6620 6164 645f 6d6f 6e74 6873  ..def add_months
-00003cd0: 280a 2020 2020 6461 7465 5f6f 725f 7469  (.    date_or_ti
-00003ce0: 6d65 7374 616d 703a 2043 6f6c 756d 6e4f  mestamp: ColumnO
-00003cf0: 724e 616d 652c 206e 756d 6265 725f 6f66  rName, number_of
-00003d00: 5f6d 6f6e 7468 733a 2055 6e69 6f6e 5b43  _months: Union[C
-00003d10: 6f6c 756d 6e2c 2069 6e74 5d0a 2920 2d3e  olumn, int].) ->
-00003d20: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00003d30: 4164 6473 206f 7220 7375 6274 7261 6374  Adds or subtract
-00003d40: 7320 6120 7370 6563 6966 6965 6420 6e75  s a specified nu
-00003d50: 6d62 6572 206f 6620 6d6f 6e74 6873 2074  mber of months t
-00003d60: 6f20 6120 6461 7465 206f 7220 7469 6d65  o a date or time
-00003d70: 7374 616d 702c 2070 7265 7365 7276 696e  stamp, preservin
-00003d80: 6720 7468 6520 656e 642d 6f66 2d6d 6f6e  g the end-of-mon
-00003d90: 7468 2069 6e66 6f72 6d61 7469 6f6e 2e0a  th information..
-00003da0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-00003db0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-00003dc0: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
-00003dd0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00003de0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00003df0: 616d 6528 5b64 6174 6574 696d 652e 6461  ame([datetime.da
-00003e00: 7465 2832 3032 322c 2034 2c20 3629 5d2c  te(2022, 4, 6)],
-00003e10: 2073 6368 656d 613d 5b22 6422 5d29 0a20   schema=["d"]). 
-00003e20: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00003e30: 6c65 6374 2861 6464 5f6d 6f6e 7468 7328  lect(add_months(
-00003e40: 2264 222c 2034 2929 2e63 6f6c 6c65 6374  "d", 4)).collect
-00003e50: 2829 5b30 5d5b 305d 0a20 2020 2020 2020  ()[0][0].       
-00003e60: 2064 6174 6574 696d 652e 6461 7465 2832   datetime.date(2
-00003e70: 3032 322c 2038 2c20 3629 0a20 2020 2022  022, 8, 6).    "
-00003e80: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00003e90: 6f6c 5f69 665f 7374 7228 6461 7465 5f6f  ol_if_str(date_o
-00003ea0: 725f 7469 6d65 7374 616d 702c 2022 6164  r_timestamp, "ad
-00003eb0: 645f 6d6f 6e74 6873 2229 0a20 2020 2072  d_months").    r
-00003ec0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-00003ed0: 6464 5f6d 6f6e 7468 7322 2928 632c 206e  dd_months")(c, n
-00003ee0: 756d 6265 725f 6f66 5f6d 6f6e 7468 7329  umber_of_months)
-00003ef0: 0a0a 0a64 6566 2061 6e79 5f76 616c 7565  ...def any_value
-00003f00: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00003f10: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00003f20: 2022 2222 5265 7475 726e 7320 6120 6e6f   """Returns a no
-00003f30: 6e2d 6465 7465 726d 696e 6973 7469 6320  n-deterministic 
-00003f40: 616e 7920 7661 6c75 6520 666f 7220 7468  any value for th
-00003f50: 6520 7370 6563 6966 6965 6420 636f 6c75  e specified colu
-00003f60: 6d6e 2e0a 2020 2020 5468 6973 2069 7320  mn..    This is 
-00003f70: 616e 2061 6767 7265 6761 7465 2061 6e64  an aggregate and
-00003f80: 2077 696e 646f 7720 6675 6e63 7469 6f6e   window function
-00003f90: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
-00003fa0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00003fb0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00003fc0: 6461 7461 6672 616d 6528 5b5b 312c 2032  dataframe([[1, 2
-00003fd0: 5d2c 205b 332c 2034 5d5d 2c20 7363 6865  ], [3, 4]], sche
-00003fe0: 6d61 3d5b 2261 222c 2022 6222 5d29 0a20  ma=["a", "b"]). 
-00003ff0: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-00004000: 7420 3d20 6466 2e73 656c 6563 7428 616e  t = df.select(an
-00004010: 795f 7661 6c75 6528 2261 2229 292e 636f  y_value("a")).co
-00004020: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00004030: 3e3e 3e20 6173 7365 7274 206c 656e 2872  >>> assert len(r
-00004040: 6573 756c 7429 203d 3d20 3120 2023 206e  esult) == 1  # n
-00004050: 6f6e 2d64 6574 6572 6d69 6e69 7374 6963  on-deterministic
-00004060: 2076 616c 7565 2069 6e20 7265 7375 6c74   value in result
-00004070: 2e0a 2020 2020 2222 220a 2020 2020 6320  ..    """.    c 
-00004080: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00004090: 2865 2c20 2261 6e79 5f76 616c 7565 2229  (e, "any_value")
-000040a0: 0a20 2020 2072 6574 7572 6e20 6361 6c6c  .    return call
-000040b0: 5f62 7569 6c74 696e 2822 616e 795f 7661  _builtin("any_va
-000040c0: 6c75 6522 2c20 6329 0a0a 0a64 6566 2062  lue", c)...def b
-000040d0: 6974 6e6f 7428 653a 2043 6f6c 756d 6e4f  itnot(e: ColumnO
-000040e0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-000040f0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-00004100: 2074 6865 2062 6974 7769 7365 206e 6567   the bitwise neg
-00004110: 6174 696f 6e20 6f66 2061 206e 756d 6572  ation of a numer
-00004120: 6963 2065 7870 7265 7373 696f 6e2e 0a0a  ic expression...
-00004130: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-00004140: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00004150: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00004160: 6166 7261 6d65 285b 315d 2c20 7363 6865  aframe([1], sche
-00004170: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00004180: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00004190: 6269 746e 6f74 2822 6122 2929 2e63 6f6c  bitnot("a")).col
-000041a0: 6c65 6374 2829 5b30 5d5b 305d 0a20 2020  lect()[0][0].   
-000041b0: 2020 2020 202d 320a 2020 2020 2222 220a       -2.    """.
-000041c0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-000041d0: 6966 5f73 7472 2865 2c20 2262 6974 6e6f  if_str(e, "bitno
-000041e0: 7422 290a 2020 2020 7265 7475 726e 2063  t").    return c
-000041f0: 616c 6c5f 6275 696c 7469 6e28 2262 6974  all_builtin("bit
-00004200: 6e6f 7422 2c20 6329 0a0a 0a64 6566 2062  not", c)...def b
-00004210: 6974 7368 6966 746c 6566 7428 746f 5f73  itshiftleft(to_s
-00004220: 6869 6674 5f63 6f6c 756d 6e3a 2043 6f6c  hift_column: Col
-00004230: 756d 6e4f 724e 616d 652c 206e 3a20 556e  umnOrName, n: Un
-00004240: 696f 6e5b 436f 6c75 6d6e 2c20 696e 745d  ion[Column, int]
-00004250: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00004260: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00004270: 6269 7477 6973 6520 6e65 6761 7469 6f6e  bitwise negation
-00004280: 206f 6620 6120 6e75 6d65 7269 6320 6578   of a numeric ex
-00004290: 7072 6573 7369 6f6e 2e0a 0a20 2020 2045  pression...    E
-000042a0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-000042b0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000042c0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-000042d0: 6528 5b32 5d2c 2073 6368 656d 613d 5b22  e([2], schema=["
-000042e0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-000042f0: 2064 662e 7365 6c65 6374 2862 6974 7368   df.select(bitsh
-00004300: 6966 746c 6566 7428 2261 222c 2031 2929  iftleft("a", 1))
-00004310: 2e63 6f6c 6c65 6374 2829 5b30 5d5b 305d  .collect()[0][0]
-00004320: 0a20 2020 2020 2020 2034 0a20 2020 2022  .        4.    "
-00004330: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00004340: 6f6c 5f69 665f 7374 7228 746f 5f73 6869  ol_if_str(to_shi
-00004350: 6674 5f63 6f6c 756d 6e2c 2022 6269 7473  ft_column, "bits
-00004360: 6869 6674 6c65 6674 2229 0a20 2020 2072  hiftleft").    r
-00004370: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
-00004380: 696e 2822 6269 7473 6869 6674 6c65 6674  in("bitshiftleft
-00004390: 222c 2063 2c20 6e29 0a0a 0a64 6566 2062  ", c, n)...def b
-000043a0: 6974 7368 6966 7472 6967 6874 2874 6f5f  itshiftright(to_
-000043b0: 7368 6966 745f 636f 6c75 6d6e 3a20 436f  shift_column: Co
-000043c0: 6c75 6d6e 4f72 4e61 6d65 2c20 6e3a 2055  lumnOrName, n: U
-000043d0: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
-000043e0: 5d29 202d 3e20 436f 6c75 6d6e 3a0a 2020  ]) -> Column:.  
-000043f0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00004400: 2062 6974 7769 7365 206e 6567 6174 696f   bitwise negatio
-00004410: 6e20 6f66 2061 206e 756d 6572 6963 2065  n of a numeric e
-00004420: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
-00004430: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-00004440: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00004450: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00004460: 6d65 285b 325d 2c20 7363 6865 6d61 3d5b  me([2], schema=[
-00004470: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00004480: 3e20 6466 2e73 656c 6563 7428 6269 7473  > df.select(bits
-00004490: 6869 6674 7269 6768 7428 2261 222c 2031  hiftright("a", 1
-000044a0: 2929 2e63 6f6c 6c65 6374 2829 5b30 5d5b  )).collect()[0][
-000044b0: 305d 0a20 2020 2020 2020 2031 0a20 2020  0].        1.   
-000044c0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-000044d0: 5f63 6f6c 5f69 665f 7374 7228 746f 5f73  _col_if_str(to_s
-000044e0: 6869 6674 5f63 6f6c 756d 6e2c 2022 6269  hift_column, "bi
-000044f0: 7473 6869 6674 7269 6768 7422 290a 2020  tshiftright").  
-00004500: 2020 7265 7475 726e 2063 616c 6c5f 6275    return call_bu
-00004510: 696c 7469 6e28 2262 6974 7368 6966 7472  iltin("bitshiftr
-00004520: 6967 6874 222c 2063 2c20 6e29 0a0a 0a64  ight", c, n)...d
-00004530: 6566 2063 6f6e 7665 7274 5f74 696d 657a  ef convert_timez
-00004540: 6f6e 6528 0a20 2020 2074 6172 6765 745f  one(.    target_
-00004550: 7469 6d65 7a6f 6e65 3a20 436f 6c75 6d6e  timezone: Column
-00004560: 4f72 4e61 6d65 2c0a 2020 2020 736f 7572  OrName,.    sour
-00004570: 6365 5f74 696d 653a 2043 6f6c 756d 6e4f  ce_time: ColumnO
-00004580: 724e 616d 652c 0a20 2020 2073 6f75 7263  rName,.    sourc
-00004590: 655f 7469 6d65 7a6f 6e65 3a20 4f70 7469  e_timezone: Opti
-000045a0: 6f6e 616c 5b43 6f6c 756d 6e4f 724e 616d  onal[ColumnOrNam
-000045b0: 655d 203d 204e 6f6e 652c 0a29 202d 3e20  e] = None,.) -> 
-000045c0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-000045d0: 6f6e 7665 7274 7320 7468 6520 6769 7665  onverts the give
-000045e0: 6e20 736f 7572 6365 5f74 696d 6520 746f  n source_time to
-000045f0: 2074 6865 2074 6172 6765 7420 7469 6d65   the target time
-00004600: 7a6f 6e65 2e0a 0a20 2020 2046 6f72 2074  zone...    For t
-00004610: 696d 657a 6f6e 6520 696e 666f 726d 6174  imezone informat
-00004620: 696f 6e2c 2072 6566 6572 2074 6f20 7468  ion, refer to th
-00004630: 6520 6053 6e6f 7766 6c61 6b65 2053 514c  e `Snowflake SQL
-00004640: 2063 6f6e 7665 7274 5f74 696d 657a 6f6e   convert_timezon
-00004650: 6520 6e6f 7465 7320 3c68 7474 7073 3a2f  e notes <https:/
-00004660: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-00004670: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-00004680: 656e 6365 2f66 756e 6374 696f 6e73 2f63  ence/functions/c
-00004690: 6f6e 7665 7274 5f74 696d 657a 6f6e 652e  onvert_timezone.
-000046a0: 6874 6d6c 2375 7361 6765 2d6e 6f74 6573  html#usage-notes
-000046b0: 3e60 5f0a 0a20 2020 2020 2020 2041 7267  >`_..        Arg
-000046c0: 733a 0a20 2020 2020 2020 2020 2020 2074  s:.            t
-000046d0: 6172 6765 745f 7469 6d65 7a6f 6e65 3a20  arget_timezone: 
-000046e0: 5468 6520 7469 6d65 207a 6f6e 6520 746f  The time zone to
-000046f0: 2077 6869 6368 2074 6865 2069 6e70 7574   which the input
-00004700: 2074 696d 6573 7461 6d70 2073 686f 756c   timestamp shoul
-00004710: 6420 6265 2063 6f6e 7665 7274 6564 2e3d  d be converted.=
-00004720: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00004730: 7263 655f 7469 6d65 3a20 5468 6520 7469  rce_time: The ti
-00004740: 6d65 7374 616d 7020 746f 2063 6f6e 7665  mestamp to conve
-00004750: 7274 2e20 5768 656e 2069 7427 7320 6120  rt. When it's a 
-00004760: 5449 4d45 5354 414d 505f 4c54 5a2c 2075  TIMESTAMP_LTZ, u
-00004770: 7365 2060 604e 6f6e 6560 6020 666f 7220  se ``None`` for 
-00004780: 6060 736f 7572 6365 5f74 696d 657a 6f6e  ``source_timezon
-00004790: 6560 602e 0a20 2020 2020 2020 2020 2020  e``..           
-000047a0: 2073 6f75 7263 655f 7469 6d65 7a6f 6e65   source_timezone
-000047b0: 3a20 5468 6520 7469 6d65 207a 6f6e 6520  : The time zone 
-000047c0: 666f 7220 7468 6520 6060 736f 7572 6365  for the ``source
-000047d0: 5f74 696d 6560 602e 2052 6571 7569 7265  _time``. Require
-000047e0: 6420 666f 7220 7469 6d65 7374 616d 7073  d for timestamps
-000047f0: 2077 6974 6820 6e6f 2074 696d 6520 7a6f   with no time zo
-00004800: 6e65 2028 692e 652e 2054 494d 4553 5441  ne (i.e. TIMESTA
-00004810: 4d50 5f4e 545a 292e 2055 7365 2060 604e  MP_NTZ). Use ``N
-00004820: 6f6e 6560 6020 6966 2074 6865 2074 696d  one`` if the tim
-00004830: 6573 7461 6d70 7320 6861 7665 2061 2074  estamps have a t
-00004840: 696d 6520 7a6f 6e65 2028 692e 652e 2054  ime zone (i.e. T
-00004850: 494d 4553 5441 4d50 5f4c 545a 292e 2044  IMESTAMP_LTZ). D
-00004860: 6566 6175 6c74 2069 7320 6060 4e6f 6e65  efault is ``None
-00004870: 6060 2e0a 0a20 2020 2020 2020 204e 6f74  ``...        Not
-00004880: 653a 0a20 2020 2020 2020 2020 2020 2054  e:.            T
-00004890: 6865 2073 6571 7565 6e63 6520 6f66 2074  he sequence of t
-000048a0: 6865 2033 2070 6172 616d 7320 6973 2064  he 3 params is d
-000048b0: 6966 6665 7265 6e74 2066 726f 6d20 7468  ifferent from th
-000048c0: 6520 5351 4c20 6675 6e63 7469 6f6e 2c20  e SQL function, 
-000048d0: 7768 6963 6820 7477 6f20 6f76 6572 6c6f  which two overlo
-000048e0: 6164 733a 0a0a 2020 2020 2020 2020 2020  ads:..          
-000048f0: 2020 2020 2d20 6060 434f 4e56 4552 545f      - ``CONVERT_
-00004900: 5449 4d45 5a4f 4e45 2820 3c73 6f75 7263  TIMEZONE( <sourc
-00004910: 655f 747a 3e20 2c20 3c74 6172 6765 745f  e_tz> , <target_
-00004920: 747a 3e20 2c20 3c73 6f75 7263 655f 7469  tz> , <source_ti
-00004930: 6d65 7374 616d 705f 6e74 7a3e 2029 6060  mestamp_ntz> )``
-00004940: 0a20 2020 2020 2020 2020 2020 2020 202d  .              -
-00004950: 2060 6043 4f4e 5645 5254 5f54 494d 455a   ``CONVERT_TIMEZ
-00004960: 4f4e 4528 203c 7461 7267 6574 5f74 7a3e  ONE( <target_tz>
-00004970: 202c 203c 736f 7572 6365 5f74 696d 6573   , <source_times
-00004980: 7461 6d70 3e20 2960 600a 0a20 2020 2020  tamp> )``..     
-00004990: 2020 2020 2020 2054 6865 2066 6972 7374         The first
-000049a0: 2070 6172 616d 6574 6572 2060 6073 6f75   parameter ``sou
-000049b0: 7263 655f 747a 6060 2069 7320 6f70 7469  rce_tz`` is opti
-000049c0: 6f6e 616c 2e20 4275 7420 696e 2050 7974  onal. But in Pyt
-000049d0: 686f 6e20 616e 206f 7074 696f 6e61 6c20  hon an optional 
-000049e0: 6172 6775 6d65 6e74 2073 686f 756c 646e  argument shouldn
-000049f0: 2774 2062 6520 706c 6163 6564 2061 7420  't be placed at 
-00004a00: 7468 6520 6669 7273 742e 0a20 2020 2020  the first..     
-00004a10: 2020 2020 2020 2053 6f20 6060 736f 7572         So ``sour
-00004a20: 6365 5f74 696d 657a 6f6e 6560 6020 6973  ce_timezone`` is
-00004a30: 2061 6674 6572 2060 6073 6f75 7263 655f   after ``source_
-00004a40: 7469 6d65 6060 2e0a 0a20 2020 2020 2020  time``...       
-00004a50: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-00004a60: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-00004a70: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
-00004a80: 2020 2020 2020 3e3e 3e20 6672 6f6d 2064        >>> from d
-00004a90: 6174 6575 7469 6c20 696d 706f 7274 2074  ateutil import t
-00004aa0: 7a0a 2020 2020 2020 2020 2020 2020 3e3e  z.            >>
-00004ab0: 3e20 6461 7465 7469 6d65 5f77 6974 685f  > datetime_with_
-00004ac0: 747a 203d 2064 6174 6574 696d 652e 6461  tz = datetime.da
-00004ad0: 7465 7469 6d65 2832 3032 322c 2034 2c20  tetime(2022, 4, 
-00004ae0: 362c 2039 2c20 302c 2030 2c20 747a 696e  6, 9, 0, 0, tzin
-00004af0: 666f 3d74 7a2e 747a 6f66 6673 6574 2822  fo=tz.tzoffset("
-00004b00: 6d79 7a6f 6e65 222c 202d 3336 3030 2a37  myzone", -3600*7
-00004b10: 2929 0a20 2020 2020 2020 2020 2020 203e  )).            >
-00004b20: 3e3e 2064 6174 6574 696d 655f 7769 7468  >> datetime_with
-00004b30: 5f6e 6f5f 747a 203d 2064 6174 6574 696d  _no_tz = datetim
-00004b40: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-00004b50: 2034 2c20 362c 2039 2c20 302c 2030 290a   4, 6, 9, 0, 0).
-00004b60: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00004b70: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00004b80: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00004b90: 6461 7465 7469 6d65 5f77 6974 685f 747a  datetime_with_tz
-00004ba0: 2c20 6461 7465 7469 6d65 5f77 6974 685f  , datetime_with_
-00004bb0: 6e6f 5f74 7a5d 5d2c 2073 6368 656d 613d  no_tz]], schema=
-00004bc0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
-00004bd0: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
-00004be0: 6c74 203d 2064 662e 7365 6c65 6374 2863  lt = df.select(c
-00004bf0: 6f6e 7665 7274 5f74 696d 657a 6f6e 6528  onvert_timezone(
-00004c00: 6c69 7428 2255 5443 2229 2c20 636f 6c28  lit("UTC"), col(
-00004c10: 2261 2229 292c 2063 6f6e 7665 7274 5f74  "a")), convert_t
-00004c20: 696d 657a 6f6e 6528 6c69 7428 2255 5443  imezone(lit("UTC
-00004c30: 2229 2c20 636f 6c28 2262 2229 2c20 6c69  "), col("b"), li
-00004c40: 7428 2241 7369 612f 5368 616e 6768 6169  t("Asia/Shanghai
-00004c50: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00004c60: 2020 2020 2020 2020 2020 203e 3e3e 2072             >>> r
-00004c70: 6573 756c 745b 305d 5b30 5d0a 2020 2020  esult[0][0].    
-00004c80: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-00004c90: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
-00004ca0: 342c 2036 2c20 3136 2c20 302c 2074 7a69  4, 6, 16, 0, tzi
-00004cb0: 6e66 6f3d 3c55 5443 3e29 0a20 2020 2020  nfo=<UTC>).     
-00004cc0: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-00004cd0: 745b 305d 5b31 5d0a 2020 2020 2020 2020  t[0][1].        
-00004ce0: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
-00004cf0: 6574 696d 6528 3230 3232 2c20 342c 2036  etime(2022, 4, 6
-00004d00: 2c20 312c 2030 290a 2020 2020 2222 220a  , 1, 0).    """.
-00004d10: 2020 2020 736f 7572 6365 5f74 7a20 3d20      source_tz = 
-00004d20: 280a 2020 2020 2020 2020 5f74 6f5f 636f  (.        _to_co
-00004d30: 6c5f 6966 5f73 7472 2873 6f75 7263 655f  l_if_str(source_
-00004d40: 7469 6d65 7a6f 6e65 2c20 2263 6f6e 7665  timezone, "conve
-00004d50: 7274 5f74 696d 657a 6f6e 6522 290a 2020  rt_timezone").  
-00004d60: 2020 2020 2020 6966 2073 6f75 7263 655f        if source_
-00004d70: 7469 6d65 7a6f 6e65 2069 7320 6e6f 7420  timezone is not 
-00004d80: 4e6f 6e65 0a20 2020 2020 2020 2065 6c73  None.        els
-00004d90: 6520 4e6f 6e65 0a20 2020 2029 0a20 2020  e None.    ).   
-00004da0: 2074 6172 6765 745f 747a 203d 205f 746f   target_tz = _to
-00004db0: 5f63 6f6c 5f69 665f 7374 7228 7461 7267  _col_if_str(targ
-00004dc0: 6574 5f74 696d 657a 6f6e 652c 2022 636f  et_timezone, "co
-00004dd0: 6e76 6572 745f 7469 6d65 7a6f 6e65 2229  nvert_timezone")
-00004de0: 0a20 2020 2073 6f75 7263 655f 7469 6d65  .    source_time
-00004df0: 5f74 6f5f 636f 6e76 6572 7420 3d20 5f74  _to_convert = _t
-00004e00: 6f5f 636f 6c5f 6966 5f73 7472 2873 6f75  o_col_if_str(sou
-00004e10: 7263 655f 7469 6d65 2c20 2263 6f6e 7665  rce_time, "conve
-00004e20: 7274 5f74 696d 657a 6f6e 6522 290a 0a20  rt_timezone").. 
-00004e30: 2020 2069 6620 736f 7572 6365 5f74 696d     if source_tim
-00004e40: 657a 6f6e 6520 6973 204e 6f6e 653a 0a20  ezone is None:. 
-00004e50: 2020 2020 2020 2072 6574 7572 6e20 6361         return ca
-00004e60: 6c6c 5f62 7569 6c74 696e 2822 636f 6e76  ll_builtin("conv
-00004e70: 6572 745f 7469 6d65 7a6f 6e65 222c 2074  ert_timezone", t
-00004e80: 6172 6765 745f 747a 2c20 736f 7572 6365  arget_tz, source
-00004e90: 5f74 696d 655f 746f 5f63 6f6e 7665 7274  _time_to_convert
-00004ea0: 290a 2020 2020 7265 7475 726e 2063 616c  ).    return cal
-00004eb0: 6c5f 6275 696c 7469 6e28 0a20 2020 2020  l_builtin(.     
-00004ec0: 2020 2022 636f 6e76 6572 745f 7469 6d65     "convert_time
-00004ed0: 7a6f 6e65 222c 2073 6f75 7263 655f 747a  zone", source_tz
-00004ee0: 2c20 7461 7267 6574 5f74 7a2c 2073 6f75  , target_tz, sou
-00004ef0: 7263 655f 7469 6d65 5f74 6f5f 636f 6e76  rce_time_to_conv
-00004f00: 6572 740a 2020 2020 290a 0a0a 6465 6620  ert.    )...def 
-00004f10: 6170 7072 6f78 5f63 6f75 6e74 5f64 6973  approx_count_dis
-00004f20: 7469 6e63 7428 653a 2043 6f6c 756d 6e4f  tinct(e: ColumnO
-00004f30: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00004f40: 3a0a 2020 2020 2222 2255 7365 7320 4879  :.    """Uses Hy
-00004f50: 7065 724c 6f67 4c6f 6720 746f 2072 6574  perLogLog to ret
-00004f60: 7572 6e20 616e 2061 7070 726f 7869 6d61  urn an approxima
-00004f70: 7469 6f6e 206f 6620 7468 6520 6469 7374  tion of the dist
-00004f80: 696e 6374 2063 6172 6469 6e61 6c69 7479  inct cardinality
-00004f90: 206f 6620 7468 6520 696e 7075 7420 2869   of the input (i
-00004fa0: 2e65 2e20 484c 4c28 636f 6c31 2c20 636f  .e. HLL(col1, co
-00004fb0: 6c32 2c20 2e2e 2e20 290a 2020 2020 7265  l2, ... ).    re
-00004fc0: 7475 726e 7320 616e 2061 7070 726f 7869  turns an approxi
-00004fd0: 6d61 7469 6f6e 206f 6620 434f 554e 5428  mation of COUNT(
-00004fe0: 4449 5354 494e 4354 2063 6f6c 312c 2063  DISTINCT col1, c
-00004ff0: 6f6c 322c 202e 2e2e 2029 292e 2222 220a  ol2, ... )).""".
-00005000: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00005010: 6966 5f73 7472 2865 2c20 2261 7070 726f  if_str(e, "appro
-00005020: 785f 636f 756e 745f 6469 7374 696e 6374  x_count_distinct
-00005030: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00005040: 696c 7469 6e28 2261 7070 726f 785f 636f  iltin("approx_co
-00005050: 756e 745f 6469 7374 696e 6374 2229 2863  unt_distinct")(c
-00005060: 290a 0a0a 6465 6620 6176 6728 653a 2043  )...def avg(e: C
-00005070: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00005080: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00005090: 6574 7572 6e73 2074 6865 2061 7665 7261  eturns the avera
-000050a0: 6765 206f 6620 6e6f 6e2d 4e55 4c4c 2072  ge of non-NULL r
-000050b0: 6563 6f72 6473 2e20 4966 2061 6c6c 2072  ecords. If all r
-000050c0: 6563 6f72 6473 2069 6e73 6964 6520 6120  ecords inside a 
-000050d0: 6772 6f75 7020 6172 6520 4e55 4c4c 2c0a  group are NULL,.
-000050e0: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
-000050f0: 2072 6574 7572 6e73 204e 554c 4c2e 0a0a   returns NULL...
-00005100: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-00005110: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00005120: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00005130: 7461 6672 616d 6528 5b5b 315d 2c20 5b32  taframe([[1], [2
-00005140: 5d2c 205b 325d 5d2c 2073 6368 656d 613d  ], [2]], schema=
-00005150: 5b22 6422 5d29 0a20 2020 2020 2020 203e  ["d"]).        >
-00005160: 3e3e 2064 662e 7365 6c65 6374 2861 7667  >> df.select(avg
-00005170: 2864 662e 6429 2e61 6c69 6173 2822 7265  (df.d).alias("re
-00005180: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-00005190: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000051a0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-000051b0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-000051c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-000051d0: 2020 2020 2020 7c31 2e36 3636 3636 3720        |1.666667 
-000051e0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000051f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00005200: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00005210: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00005220: 636f 6c5f 6966 5f73 7472 2865 2c20 2261  col_if_str(e, "a
-00005230: 7667 2229 0a20 2020 2072 6574 7572 6e20  vg").    return 
-00005240: 6275 696c 7469 6e28 2261 7667 2229 2863  builtin("avg")(c
-00005250: 290a 0a0a 6465 6620 636f 7272 2863 6f6c  )...def corr(col
-00005260: 756d 6e31 3a20 436f 6c75 6d6e 4f72 4e61  umn1: ColumnOrNa
-00005270: 6d65 2c20 636f 6c75 6d6e 323a 2043 6f6c  me, column2: Col
-00005280: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00005290: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-000052a0: 7572 6e73 2074 6865 2063 6f72 7265 6c61  urns the correla
-000052b0: 7469 6f6e 2063 6f65 6666 6963 6965 6e74  tion coefficient
-000052c0: 2066 6f72 206e 6f6e 2d6e 756c 6c20 7061   for non-null pa
-000052d0: 6972 7320 696e 2061 2067 726f 7570 2e0a  irs in a group..
-000052e0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-000052f0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00005300: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00005310: 7461 6672 616d 6528 5b5b 312c 2032 5d2c  taframe([[1, 2],
-00005320: 205b 312c 2032 5d2c 205b 342c 2035 5d2c   [1, 2], [4, 5],
-00005330: 205b 322c 2033 5d2c 205b 332c 204e 6f6e   [2, 3], [3, Non
-00005340: 655d 2c20 5b34 2c20 4e6f 6e65 5d2c 205b  e], [4, None], [
-00005350: 362c 345d 5d2c 2073 6368 656d 613d 5b22  6,4]], schema=["
-00005360: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
-00005370: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00005380: 636f 7272 2863 6f6c 2822 6122 292c 2063  corr(col("a"), c
-00005390: 6f6c 2822 6222 2929 2e61 6c69 6173 2822  ol("b")).alias("
-000053a0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-000053b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000053c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-000053d0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-000053e0: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-000053f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00005400: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00005410: 2020 207c 302e 3831 3336 3831 3530 3833     |0.8136815083
-00005420: 3238 3830 3920 207c 0a20 2020 2020 2020  28809  |.       
-00005430: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00005440: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00005450: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00005460: 2222 0a20 2020 2063 3120 3d20 5f74 6f5f  "".    c1 = _to_
-00005470: 636f 6c5f 6966 5f73 7472 2863 6f6c 756d  col_if_str(colum
-00005480: 6e31 2c20 2263 6f72 7222 290a 2020 2020  n1, "corr").    
-00005490: 6332 203d 205f 746f 5f63 6f6c 5f69 665f  c2 = _to_col_if_
-000054a0: 7374 7228 636f 6c75 6d6e 322c 2022 636f  str(column2, "co
-000054b0: 7272 2229 0a20 2020 2072 6574 7572 6e20  rr").    return 
-000054c0: 6275 696c 7469 6e28 2263 6f72 7222 2928  builtin("corr")(
-000054d0: 6331 2c20 6332 290a 0a0a 6465 6620 636f  c1, c2)...def co
-000054e0: 756e 7428 653a 2043 6f6c 756d 6e4f 724e  unt(e: ColumnOrN
-000054f0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00005500: 2020 2020 2222 2252 6574 7572 6e73 2065      """Returns e
-00005510: 6974 6865 7220 7468 6520 6e75 6d62 6572  ither the number
-00005520: 206f 6620 6e6f 6e2d 4e55 4c4c 2072 6563   of non-NULL rec
-00005530: 6f72 6473 2066 6f72 2074 6865 2073 7065  ords for the spe
-00005540: 6369 6669 6564 2063 6f6c 756d 6e73 2c20  cified columns, 
-00005550: 6f72 2074 6865 0a20 2020 2074 6f74 616c  or the.    total
-00005560: 206e 756d 6265 7220 6f66 2072 6563 6f72   number of recor
-00005570: 6473 2e0a 0a20 2020 2045 7861 6d70 6c65  ds...    Example
-00005580: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-00005590: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-000055a0: 655f 6461 7461 6672 616d 6528 5b5b 315d  e_dataframe([[1]
-000055b0: 2c20 5b4e 6f6e 655d 2c20 5b33 5d2c 205b  , [None], [3], [
-000055c0: 345d 2c20 5b4e 6f6e 655d 5d2c 2073 6368  4], [None]], sch
-000055d0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-000055e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000055f0: 2863 6f75 6e74 2863 6f6c 2822 6122 2929  (count(col("a"))
-00005600: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-00005610: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00005620: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00005630: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00005640: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00005650: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00005660: 7c33 2020 2020 2020 2020 207c 0a20 2020  |3         |.   
-00005670: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00005680: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00005690: 4c49 4e45 3e0a 2020 2020 2020 2020 3e3e  LINE>.        >>
-000056a0: 3e20 6466 2e73 656c 6563 7428 636f 756e  > df.select(coun
-000056b0: 7428 222a 2229 2e61 6c69 6173 2822 7265  t("*").alias("re
-000056c0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-000056d0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000056e0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-000056f0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-00005700: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00005710: 2020 2020 2020 7c35 2020 2020 2020 2020        |5        
-00005720: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00005730: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00005740: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00005750: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00005760: 636f 6c5f 6966 5f73 7472 2865 2c20 2263  col_if_str(e, "c
-00005770: 6f75 6e74 2229 0a20 2020 2072 6574 7572  ount").    retur
-00005780: 6e20 280a 2020 2020 2020 2020 6275 696c  n (.        buil
-00005790: 7469 6e28 2263 6f75 6e74 2229 284c 6974  tin("count")(Lit
-000057a0: 6572 616c 2831 2929 0a20 2020 2020 2020  eral(1)).       
-000057b0: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
-000057c0: 2e5f 6578 7072 6573 7369 6f6e 2c20 5374  ._expression, St
-000057d0: 6172 290a 2020 2020 2020 2020 656c 7365  ar).        else
-000057e0: 2062 7569 6c74 696e 2822 636f 756e 7422   builtin("count"
-000057f0: 2928 632e 5f65 7870 7265 7373 696f 6e29  )(c._expression)
-00005800: 0a20 2020 2029 0a0a 0a64 6566 2063 6f75  .    )...def cou
-00005810: 6e74 5f64 6973 7469 6e63 7428 2a63 6f6c  nt_distinct(*col
-00005820: 733a 2043 6f6c 756d 6e4f 724e 616d 6529  s: ColumnOrName)
-00005830: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00005840: 2222 2252 6574 7572 6e73 2065 6974 6865  """Returns eithe
-00005850: 7220 7468 6520 6e75 6d62 6572 206f 6620  r the number of 
-00005860: 6e6f 6e2d 4e55 4c4c 2064 6973 7469 6e63  non-NULL distinc
-00005870: 7420 7265 636f 7264 7320 666f 7220 7468  t records for th
-00005880: 6520 7370 6563 6966 6965 6420 636f 6c75  e specified colu
-00005890: 6d6e 732c 0a20 2020 206f 7220 7468 6520  mns,.    or the 
-000058a0: 746f 7461 6c20 6e75 6d62 6572 206f 6620  total number of 
-000058b0: 7468 6520 6469 7374 696e 6374 2072 6563  the distinct rec
-000058c0: 6f72 6473 2e0a 0a20 2020 2045 7861 6d70  ords...    Examp
-000058d0: 6c65 3a0a 0a20 2020 2020 2020 203e 3e3e  le:..        >>>
-000058e0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000058f0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00005900: 5b31 2c20 325d 2c20 5b31 2c20 325d 2c20  [1, 2], [1, 2], 
-00005910: 5b33 2c20 4e6f 6e65 5d2c 205b 322c 2033  [3, None], [2, 3
-00005920: 5d2c 205b 332c 204e 6f6e 655d 2c20 5b34  ], [3, None], [4
-00005930: 2c20 4e6f 6e65 5d5d 2c20 7363 6865 6d61  , None]], schema
-00005940: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
-00005950: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00005960: 6374 2863 6f75 6e74 5f64 6973 7469 6e63  ct(count_distinc
-00005970: 7428 636f 6c28 2261 2229 2c20 636f 6c28  t(col("a"), col(
-00005980: 2262 2229 292e 616c 6961 7328 2272 6573  "b")).alias("res
-00005990: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-000059a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000059b0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-000059c0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-000059d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-000059e0: 2020 2020 207c 3220 2020 2020 2020 2020       |2         
-000059f0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00005a00: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00005a10: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
-00005a20: 2020 203e 3e3e 2023 2020 5468 6520 7265     >>> #  The re
-00005a30: 7375 6c74 2073 686f 756c 6420 6265 2032  sult should be 2
-00005a40: 2066 6f72 207b 5b31 2c32 5d2c 5b32 2c33   for {[1,2],[2,3
-00005a50: 5d7d 2073 696e 6365 2074 6865 2072 6573  ]} since the res
-00005a60: 7420 6172 6520 6569 7468 6572 2064 7570  t are either dup
-00005a70: 6c69 6361 7465 206f 7220 4e55 4c4c 2072  licate or NULL r
-00005a80: 6563 6f72 6473 0a20 2020 2022 2222 0a20  ecords.    """. 
-00005a90: 2020 2063 7320 3d20 5b5f 746f 5f63 6f6c     cs = [_to_col
-00005aa0: 5f69 665f 7374 7228 632c 2022 636f 756e  _if_str(c, "coun
-00005ab0: 745f 6469 7374 696e 6374 2229 2066 6f72  t_distinct") for
-00005ac0: 2063 2069 6e20 636f 6c73 5d0a 2020 2020   c in cols].    
-00005ad0: 7265 7475 726e 2043 6f6c 756d 6e28 0a20  return Column(. 
-00005ae0: 2020 2020 2020 2046 756e 6374 696f 6e45         FunctionE
-00005af0: 7870 7265 7373 696f 6e28 2263 6f75 6e74  xpression("count
-00005b00: 222c 205b 632e 5f65 7870 7265 7373 696f  ", [c._expressio
-00005b10: 6e20 666f 7220 6320 696e 2063 735d 2c20  n for c in cs], 
-00005b20: 6973 5f64 6973 7469 6e63 743d 5472 7565  is_distinct=True
-00005b30: 290a 2020 2020 290a 0a0a 6465 6620 636f  ).    )...def co
-00005b40: 7661 725f 706f 7028 636f 6c75 6d6e 313a  var_pop(column1:
-00005b50: 2043 6f6c 756d 6e4f 724e 616d 652c 2063   ColumnOrName, c
-00005b60: 6f6c 756d 6e32 3a20 436f 6c75 6d6e 4f72  olumn2: ColumnOr
-00005b70: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00005b80: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00005b90: 7468 6520 706f 7075 6c61 7469 6f6e 2063  the population c
-00005ba0: 6f76 6172 6961 6e63 6520 666f 7220 6e6f  ovariance for no
-00005bb0: 6e2d 6e75 6c6c 2070 6169 7273 2069 6e20  n-null pairs in 
-00005bc0: 6120 6772 6f75 702e 0a0a 2020 2020 4578  a group...    Ex
-00005bd0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00005be0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00005bf0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00005c00: 2069 6d70 6f72 7420 4465 6369 6d61 6c54   import DecimalT
-00005c10: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
-00005c20: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00005c30: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00005c40: 312c 2032 5d2c 205b 312c 2032 5d2c 205b  1, 2], [1, 2], [
-00005c50: 342c 2035 5d2c 205b 322c 2033 5d2c 205b  4, 5], [2, 3], [
-00005c60: 332c 204e 6f6e 655d 2c20 5b34 2c20 4e6f  3, None], [4, No
-00005c70: 6e65 5d2c 205b 362c 345d 5d2c 2073 6368  ne], [6,4]], sch
-00005c80: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-00005c90: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00005ca0: 656c 6563 7428 636f 7661 725f 706f 7028  elect(covar_pop(
-00005cb0: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
-00005cc0: 2229 292e 6361 7374 2844 6563 696d 616c  ")).cast(Decimal
-00005cd0: 5479 7065 2873 6361 6c65 3d33 2929 2e61  Type(scale=3)).a
-00005ce0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00005cf0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00005d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00005d10: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-00005d20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00005d30: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
-00005d40: 2e38 3430 2020 2020 207c 0a20 2020 2020  .840     |.     
-00005d50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00005d60: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00005d70: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-00005d80: 636f 6c31 203d 205f 746f 5f63 6f6c 5f69  col1 = _to_col_i
-00005d90: 665f 7374 7228 636f 6c75 6d6e 312c 2022  f_str(column1, "
-00005da0: 636f 7661 725f 706f 7022 290a 2020 2020  covar_pop").    
-00005db0: 636f 6c32 203d 205f 746f 5f63 6f6c 5f69  col2 = _to_col_i
-00005dc0: 665f 7374 7228 636f 6c75 6d6e 322c 2022  f_str(column2, "
-00005dd0: 636f 7661 725f 706f 7022 290a 2020 2020  covar_pop").    
-00005de0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00005df0: 636f 7661 725f 706f 7022 2928 636f 6c31  covar_pop")(col1
-00005e00: 2c20 636f 6c32 290a 0a0a 6465 6620 636f  , col2)...def co
-00005e10: 7661 725f 7361 6d70 2863 6f6c 756d 6e31  var_samp(column1
-00005e20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00005e30: 636f 6c75 6d6e 323a 2043 6f6c 756d 6e4f  column2: ColumnO
-00005e40: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00005e50: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-00005e60: 2074 6865 2073 616d 706c 6520 636f 7661   the sample cova
-00005e70: 7269 616e 6365 2066 6f72 206e 6f6e 2d6e  riance for non-n
-00005e80: 756c 6c20 7061 6972 7320 696e 2061 2067  ull pairs in a g
-00005e90: 726f 7570 2e0a 0a20 2020 2045 7861 6d70  roup...    Examp
-00005ea0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-00005eb0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00005ec0: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-00005ed0: 706f 7274 2044 6563 696d 616c 5479 7065  port DecimalType
-00005ee0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00005ef0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00005f00: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
-00005f10: 325d 2c20 5b31 2c20 325d 2c20 5b34 2c20  2], [1, 2], [4, 
-00005f20: 355d 2c20 5b32 2c20 335d 2c20 5b33 2c20  5], [2, 3], [3, 
-00005f30: 4e6f 6e65 5d2c 205b 342c 204e 6f6e 655d  None], [4, None]
-00005f40: 2c20 5b36 2c34 5d5d 2c20 7363 6865 6d61  , [6,4]], schema
-00005f50: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
-00005f60: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00005f70: 6374 2863 6f76 6172 5f73 616d 7028 636f  ct(covar_samp(co
-00005f80: 6c28 2261 2229 2c20 636f 6c28 2262 2229  l("a"), col("b")
-00005f90: 292e 6361 7374 2844 6563 696d 616c 5479  ).cast(DecimalTy
-00005fa0: 7065 2873 6361 6c65 3d33 2929 2e61 6c69  pe(scale=3)).ali
-00005fb0: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-00005fc0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00005fd0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00005fe0: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
-00005ff0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00006000: 2d2d 2d0a 2020 2020 2020 2020 7c32 2e33  ---.        |2.3
-00006010: 3030 2020 2020 207c 0a20 2020 2020 2020  00     |.       
-00006020: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00006030: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00006040: 3e0a 2020 2020 2222 220a 2020 2020 636f  >.    """.    co
-00006050: 6c31 203d 205f 746f 5f63 6f6c 5f69 665f  l1 = _to_col_if_
-00006060: 7374 7228 636f 6c75 6d6e 312c 2022 636f  str(column1, "co
-00006070: 7661 725f 7361 6d70 2229 0a20 2020 2063  var_samp").    c
-00006080: 6f6c 3220 3d20 5f74 6f5f 636f 6c5f 6966  ol2 = _to_col_if
-00006090: 5f73 7472 2863 6f6c 756d 6e32 2c20 2263  _str(column2, "c
-000060a0: 6f76 6172 5f73 616d 7022 290a 2020 2020  ovar_samp").    
-000060b0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000060c0: 636f 7661 725f 7361 6d70 2229 2863 6f6c  covar_samp")(col
-000060d0: 312c 2063 6f6c 3229 0a0a 0a64 6566 206b  1, col2)...def k
-000060e0: 7572 746f 7369 7328 653a 2043 6f6c 756d  urtosis(e: Colum
-000060f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00006100: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00006110: 5265 7475 726e 7320 7468 6520 706f 7075  Returns the popu
-00006120: 6c61 7469 6f6e 2065 7863 6573 7320 6b75  lation excess ku
-00006130: 7274 6f73 6973 206f 6620 6e6f 6e2d 4e55  rtosis of non-NU
-00006140: 4c4c 2072 6563 6f72 6473 2e20 4966 2061  LL records. If a
-00006150: 6c6c 2072 6563 6f72 6473 0a20 2020 2069  ll records.    i
-00006160: 6e73 6964 6520 6120 6772 6f75 7020 6172  nside a group ar
-00006170: 6520 4e55 4c4c 2c20 7468 6520 6675 6e63  e NULL, the func
-00006180: 7469 6f6e 2072 6574 7572 6e73 204e 554c  tion returns NUL
-00006190: 4c2e 0a0a 2020 2020 4578 616d 706c 653a  L...    Example:
-000061a0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
-000061b0: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-000061c0: 6f77 7061 726b 2e66 756e 6374 696f 6e73  owpark.functions
-000061d0: 2069 6d70 6f72 7420 6b75 7274 6f73 6973   import kurtosis
-000061e0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000061f0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00006200: 5f64 6174 6166 7261 6d65 285b 312c 2033  _dataframe([1, 3
-00006210: 2c20 3130 2c20 312c 2033 5d2c 2073 6368  , 10, 1, 3], sch
-00006220: 656d 613d 5b22 7822 5d29 0a20 2020 2020  ema=["x"]).     
-00006230: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00006240: 286b 7572 746f 7369 7328 2278 2229 2e61  (kurtosis("x").a
-00006250: 735f 2822 7822 2929 2e63 6f6c 6c65 6374  s_("x")).collect
-00006260: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00006270: 583d 4465 6369 6d61 6c28 2733 2e36 3133  X=Decimal('3.613
-00006280: 3733 3636 3039 3935 3627 2929 5d0a 2020  736609956'))].  
-00006290: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-000062a0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-000062b0: 226b 7572 746f 7369 7322 290a 2020 2020  "kurtosis").    
-000062c0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000062d0: 6b75 7274 6f73 6973 2229 2863 290a 0a0a  kurtosis")(c)...
-000062e0: 6465 6620 6d61 7828 653a 2043 6f6c 756d  def max(e: Colum
-000062f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00006300: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00006310: 5265 7475 726e 7320 7468 6520 6d61 7869  Returns the maxi
-00006320: 6d75 6d20 7661 6c75 6520 666f 7220 7468  mum value for th
-00006330: 6520 7265 636f 7264 7320 696e 2061 2067  e records in a g
-00006340: 726f 7570 2e20 4e55 4c4c 2076 616c 7565  roup. NULL value
-00006350: 7320 6172 6520 6967 6e6f 7265 640a 2020  s are ignored.  
-00006360: 2020 756e 6c65 7373 2061 6c6c 2074 6865    unless all the
-00006370: 2072 6563 6f72 6473 2061 7265 204e 554c   records are NUL
-00006380: 4c2c 2069 6e20 7768 6963 6820 6361 7365  L, in which case
-00006390: 2061 204e 554c 4c20 7661 6c75 6520 6973   a NULL value is
-000063a0: 2072 6574 7572 6e65 642e 0a0a 2020 2020   returned...    
-000063b0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000063c0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000063d0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000063e0: 7261 6d65 285b 312c 2033 2c20 3130 2c20  rame([1, 3, 10, 
-000063f0: 312c 2033 5d2c 2073 6368 656d 613d 5b22  1, 3], schema=["
-00006400: 7822 5d29 0a20 2020 2020 2020 203e 3e3e  x"]).        >>>
-00006410: 2064 662e 7365 6c65 6374 286d 6178 2822   df.select(max("
-00006420: 7822 292e 6173 5f28 2278 2229 292e 636f  x").as_("x")).co
-00006430: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00006440: 5b52 6f77 2858 3d31 3029 5d0a 2020 2020  [Row(X=10)].    
-00006450: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00006460: 636f 6c5f 6966 5f73 7472 2865 2c20 226d  col_if_str(e, "m
-00006470: 6178 2229 0a20 2020 2072 6574 7572 6e20  ax").    return 
-00006480: 6275 696c 7469 6e28 226d 6178 2229 2863  builtin("max")(c
-00006490: 290a 0a0a 6465 6620 6d65 616e 2865 3a20  )...def mean(e: 
-000064a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-000064b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000064c0: 0a20 2020 2052 6574 7572 6e20 7468 6520  .    Return the 
-000064d0: 6176 6572 6167 6520 666f 7220 7468 6520  average for the 
-000064e0: 7370 6563 6966 6963 206e 756d 6572 6963  specific numeric
-000064f0: 2063 6f6c 756d 6e73 2e20 416c 6961 7320   columns. Alias 
-00006500: 6f66 203a 6675 6e63 3a60 6176 6760 2e0a  of :func:`avg`..
-00006510: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00006520: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00006530: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00006540: 6461 7461 6672 616d 6528 5b31 2c20 332c  dataframe([1, 3,
-00006550: 2031 302c 2031 2c20 335d 2c20 7363 6865   10, 1, 3], sche
-00006560: 6d61 3d5b 2278 225d 290a 2020 2020 2020  ma=["x"]).      
-00006570: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00006580: 6d65 616e 2822 7822 292e 6173 5f28 2278  mean("x").as_("x
-00006590: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-000065a0: 2020 2020 2020 5b52 6f77 2858 3d44 6563        [Row(X=Dec
-000065b0: 696d 616c 2827 332e 3630 3030 3030 2729  imal('3.600000')
-000065c0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-000065d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000065e0: 7228 652c 2022 6d65 616e 2229 0a20 2020  r(e, "mean").   
-000065f0: 2072 6574 7572 6e20 6176 6728 6329 0a0a   return avg(c)..
-00006600: 0a64 6566 206d 6564 6961 6e28 653a 2043  .def median(e: C
-00006610: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00006620: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00006630: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-00006640: 6d65 6469 616e 2076 616c 7565 2066 6f72  median value for
-00006650: 2074 6865 2072 6563 6f72 6473 2069 6e20   the records in 
-00006660: 6120 6772 6f75 702e 204e 554c 4c20 7661  a group. NULL va
-00006670: 6c75 6573 2061 7265 2069 676e 6f72 6564  lues are ignored
-00006680: 0a20 2020 2075 6e6c 6573 7320 616c 6c20  .    unless all 
-00006690: 7468 6520 7265 636f 7264 7320 6172 6520  the records are 
-000066a0: 4e55 4c4c 2c20 696e 2077 6869 6368 2063  NULL, in which c
-000066b0: 6173 6520 6120 4e55 4c4c 2076 616c 7565  ase a NULL value
-000066c0: 2069 7320 7265 7475 726e 6564 2e0a 0a20   is returned... 
-000066d0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-000066e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000066f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00006700: 7461 6672 616d 6528 5b31 2c20 332c 2031  taframe([1, 3, 1
-00006710: 302c 2031 2c20 335d 2c20 7363 6865 6d61  0, 1, 3], schema
-00006720: 3d5b 2278 225d 290a 2020 2020 2020 2020  =["x"]).        
-00006730: 3e3e 3e20 6466 2e73 656c 6563 7428 6d65  >>> df.select(me
-00006740: 6469 616e 2822 7822 292e 6173 5f28 2278  dian("x").as_("x
-00006750: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00006760: 2020 2020 2020 5b52 6f77 2858 3d44 6563        [Row(X=Dec
-00006770: 696d 616c 2827 332e 3030 3027 2929 5d0a  imal('3.000'))].
-00006780: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00006790: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-000067a0: 2c20 226d 6564 6961 6e22 290a 2020 2020  , "median").    
-000067b0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000067c0: 6d65 6469 616e 2229 2863 290a 0a0a 6465  median")(c)...de
-000067d0: 6620 6d69 6e28 653a 2043 6f6c 756d 6e4f  f min(e: ColumnO
-000067e0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-000067f0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00006800: 7475 726e 7320 7468 6520 6d69 6e69 6d75  turns the minimu
-00006810: 6d20 7661 6c75 6520 666f 7220 7468 6520  m value for the 
-00006820: 7265 636f 7264 7320 696e 2061 2067 726f  records in a gro
-00006830: 7570 2e20 4e55 4c4c 2076 616c 7565 7320  up. NULL values 
-00006840: 6172 6520 6967 6e6f 7265 640a 2020 2020  are ignored.    
-00006850: 756e 6c65 7373 2061 6c6c 2074 6865 2072  unless all the r
-00006860: 6563 6f72 6473 2061 7265 204e 554c 4c2c  ecords are NULL,
-00006870: 2069 6e20 7768 6963 6820 6361 7365 2061   in which case a
-00006880: 204e 554c 4c20 7661 6c75 6520 6973 2072   NULL value is r
-00006890: 6574 7572 6e65 642e 0a0a 2020 2020 4578  eturned...    Ex
-000068a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-000068b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000068c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000068d0: 6d65 285b 312c 2033 2c20 3130 2c20 312c  me([1, 3, 10, 1,
-000068e0: 2033 5d2c 2073 6368 656d 613d 5b22 7822   3], schema=["x"
-000068f0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00006900: 662e 7365 6c65 6374 286d 696e 2822 7822  f.select(min("x"
-00006910: 292e 6173 5f28 2278 2229 292e 636f 6c6c  ).as_("x")).coll
-00006920: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00006930: 6f77 2858 3d31 295d 0a20 2020 2022 2222  ow(X=1)].    """
-00006940: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00006950: 5f69 665f 7374 7228 652c 2022 6d69 6e22  _if_str(e, "min"
-00006960: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00006970: 6c74 696e 2822 6d69 6e22 2928 6329 0a0a  ltin("min")(c)..
-00006980: 0a64 6566 206d 6f64 6528 653a 2043 6f6c  .def mode(e: Col
-00006990: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-000069a0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-000069b0: 2020 5265 7475 726e 7320 7468 6520 6d6f    Returns the mo
-000069c0: 7374 2066 7265 7175 656e 7420 7661 6c75  st frequent valu
-000069d0: 6520 666f 7220 7468 6520 7265 636f 7264  e for the record
-000069e0: 7320 696e 2061 2067 726f 7570 2e20 4e55  s in a group. NU
-000069f0: 4c4c 2076 616c 7565 7320 6172 6520 6967  LL values are ig
-00006a00: 6e6f 7265 642e 0a20 2020 2049 6620 616c  nored..    If al
-00006a10: 6c20 7468 6520 7661 6c75 6573 2061 7265  l the values are
-00006a20: 204e 554c 4c2c 206f 7220 7468 6572 6520   NULL, or there 
-00006a30: 6172 6520 3020 726f 7773 2c20 7468 656e  are 0 rows, then
-00006a40: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
-00006a50: 7475 726e 7320 4e55 4c4c 2e0a 0a20 2020  turns NULL...   
-00006a60: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00006a70: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00006a80: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00006a90: 6672 616d 6528 5b31 2c20 332c 2031 302c  frame([1, 3, 10,
-00006aa0: 2031 2c20 345d 2c20 7363 6865 6d61 3d5b   1, 4], schema=[
-00006ab0: 2278 225d 290a 2020 2020 2020 2020 3e3e  "x"]).        >>
-00006ac0: 3e20 6466 2e73 656c 6563 7428 6d6f 6465  > df.select(mode
-00006ad0: 2822 7822 292e 6173 5f28 2278 2229 292e  ("x").as_("x")).
-00006ae0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00006af0: 2020 5b52 6f77 2858 3d31 295d 0a20 2020    [Row(X=1)].   
-00006b00: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00006b10: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00006b20: 6d6f 6465 2229 0a20 2020 2072 6574 7572  mode").    retur
-00006b30: 6e20 6275 696c 7469 6e28 226d 6f64 6522  n builtin("mode"
-00006b40: 2928 6329 0a0a 0a64 6566 2073 6b65 7728  )(c)...def skew(
-00006b50: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-00006b60: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00006b70: 2222 2252 6574 7572 6e73 2074 6865 2073  """Returns the s
-00006b80: 616d 706c 6520 736b 6577 6e65 7373 206f  ample skewness o
-00006b90: 6620 6e6f 6e2d 4e55 4c4c 2072 6563 6f72  f non-NULL recor
-00006ba0: 6473 2e20 4966 2061 6c6c 2072 6563 6f72  ds. If all recor
-00006bb0: 6473 2069 6e73 6964 6520 6120 6772 6f75  ds inside a grou
-00006bc0: 700a 2020 2020 6172 6520 4e55 4c4c 2c20  p.    are NULL, 
-00006bd0: 7468 6520 6675 6e63 7469 6f6e 2072 6574  the function ret
-00006be0: 7572 6e73 204e 554c 4c2e 2222 220a 2020  urns NULL.""".  
-00006bf0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00006c00: 5f73 7472 2865 2c20 2273 6b65 7722 290a  _str(e, "skew").
-00006c10: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00006c20: 696e 2822 736b 6577 2229 2863 290a 0a0a  in("skew")(c)...
-00006c30: 6465 6620 7374 6464 6576 2865 3a20 436f  def stddev(e: Co
-00006c40: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00006c50: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00006c60: 7475 726e 7320 7468 6520 7361 6d70 6c65  turns the sample
-00006c70: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-00006c80: 696f 6e20 2873 7175 6172 6520 726f 6f74  ion (square root
-00006c90: 206f 6620 7361 6d70 6c65 2076 6172 6961   of sample varia
-00006ca0: 6e63 6529 206f 660a 2020 2020 6e6f 6e2d  nce) of.    non-
-00006cb0: 4e55 4c4c 2076 616c 7565 732e 2049 6620  NULL values. If 
-00006cc0: 616c 6c20 7265 636f 7264 7320 696e 7369  all records insi
-00006cd0: 6465 2061 2067 726f 7570 2061 7265 204e  de a group are N
-00006ce0: 554c 4c2c 2072 6574 7572 6e73 204e 554c  ULL, returns NUL
-00006cf0: 4c2e 2222 220a 2020 2020 6320 3d20 5f74  L.""".    c = _t
-00006d00: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00006d10: 2273 7464 6465 7622 290a 2020 2020 7265  "stddev").    re
-00006d20: 7475 726e 2062 7569 6c74 696e 2822 7374  turn builtin("st
-00006d30: 6464 6576 2229 2863 290a 0a0a 6465 6620  ddev")(c)...def 
-00006d40: 7374 6464 6576 5f73 616d 7028 653a 2043  stddev_samp(e: C
-00006d50: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00006d60: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00006d70: 6574 7572 6e73 2074 6865 2073 616d 706c  eturns the sampl
-00006d80: 6520 7374 616e 6461 7264 2064 6576 6961  e standard devia
-00006d90: 7469 6f6e 2028 7371 7561 7265 2072 6f6f  tion (square roo
-00006da0: 7420 6f66 2073 616d 706c 6520 7661 7269  t of sample vari
-00006db0: 616e 6365 2920 6f66 0a20 2020 206e 6f6e  ance) of.    non
-00006dc0: 2d4e 554c 4c20 7661 6c75 6573 2e20 4966  -NULL values. If
-00006dd0: 2061 6c6c 2072 6563 6f72 6473 2069 6e73   all records ins
-00006de0: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
-00006df0: 4e55 4c4c 2c20 7265 7475 726e 7320 4e55  NULL, returns NU
-00006e00: 4c4c 2e20 416c 6961 7320 6f66 0a20 2020  LL. Alias of.   
-00006e10: 203a 6675 6e63 3a60 7374 6464 6576 602e   :func:`stddev`.
-00006e20: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00006e30: 636f 6c5f 6966 5f73 7472 2865 2c20 2273  col_if_str(e, "s
-00006e40: 7464 6465 765f 7361 6d70 2229 0a20 2020  tddev_samp").   
-00006e50: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00006e60: 2273 7464 6465 765f 7361 6d70 2229 2863  "stddev_samp")(c
-00006e70: 290a 0a0a 6465 6620 7374 6464 6576 5f70  )...def stddev_p
-00006e80: 6f70 2865 3a20 436f 6c75 6d6e 4f72 4e61  op(e: ColumnOrNa
-00006e90: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00006ea0: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
-00006eb0: 6520 706f 7075 6c61 7469 6f6e 2073 7461  e population sta
-00006ec0: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
-00006ed0: 2873 7175 6172 6520 726f 6f74 206f 6620  (square root of 
-00006ee0: 7661 7269 616e 6365 2920 6f66 206e 6f6e  variance) of non
-00006ef0: 2d4e 554c 4c0a 2020 2020 7661 6c75 6573  -NULL.    values
-00006f00: 2e20 4966 2061 6c6c 2072 6563 6f72 6473  . If all records
-00006f10: 2069 6e73 6964 6520 6120 6772 6f75 7020   inside a group 
-00006f20: 6172 6520 4e55 4c4c 2c20 7265 7475 726e  are NULL, return
-00006f30: 7320 4e55 4c4c 2e22 2222 0a20 2020 2063  s NULL.""".    c
-00006f40: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00006f50: 7228 652c 2022 7374 6464 6576 5f70 6f70  r(e, "stddev_pop
-00006f60: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00006f70: 696c 7469 6e28 2273 7464 6465 765f 706f  iltin("stddev_po
-00006f80: 7022 2928 6329 0a0a 0a64 6566 2073 756d  p")(c)...def sum
-00006f90: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00006fa0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00006fb0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00006fc0: 7375 6d20 6f66 206e 6f6e 2d4e 554c 4c20  sum of non-NULL 
-00006fd0: 7265 636f 7264 7320 696e 2061 2067 726f  records in a gro
-00006fe0: 7570 2e20 596f 7520 6361 6e20 7573 6520  up. You can use 
-00006ff0: 7468 6520 4449 5354 494e 4354 206b 6579  the DISTINCT key
-00007000: 776f 7264 0a20 2020 2074 6f20 636f 6d70  word.    to comp
-00007010: 7574 6520 7468 6520 7375 6d20 6f66 2075  ute the sum of u
-00007020: 6e69 7175 6520 6e6f 6e2d 6e75 6c6c 2076  nique non-null v
-00007030: 616c 7565 732e 2049 6620 616c 6c20 7265  alues. If all re
-00007040: 636f 7264 7320 696e 7369 6465 2061 2067  cords inside a g
-00007050: 726f 7570 2061 7265 0a20 2020 204e 554c  roup are.    NUL
-00007060: 4c2c 2074 6865 2066 756e 6374 696f 6e20  L, the function 
-00007070: 7265 7475 726e 7320 4e55 4c4c 2e22 2222  returns NULL."""
-00007080: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00007090: 5f69 665f 7374 7228 652c 2022 7375 6d22  _if_str(e, "sum"
-000070a0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-000070b0: 6c74 696e 2822 7375 6d22 2928 6329 0a0a  ltin("sum")(c)..
-000070c0: 0a64 6566 2073 756d 5f64 6973 7469 6e63  .def sum_distinc
-000070d0: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
-000070e0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-000070f0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00007100: 2073 756d 206f 6620 6e6f 6e2d 4e55 4c4c   sum of non-NULL
-00007110: 2064 6973 7469 6e63 7420 7265 636f 7264   distinct record
-00007120: 7320 696e 2061 2067 726f 7570 2e20 596f  s in a group. Yo
-00007130: 7520 6361 6e20 7573 6520 7468 650a 2020  u can use the.  
-00007140: 2020 4449 5354 494e 4354 206b 6579 776f    DISTINCT keywo
-00007150: 7264 2074 6f20 636f 6d70 7574 6520 7468  rd to compute th
-00007160: 6520 7375 6d20 6f66 2075 6e69 7175 6520  e sum of unique 
-00007170: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 732e  non-null values.
-00007180: 2049 6620 616c 6c20 7265 636f 7264 730a   If all records.
-00007190: 2020 2020 696e 7369 6465 2061 2067 726f      inside a gro
-000071a0: 7570 2061 7265 204e 554c 4c2c 2074 6865  up are NULL, the
-000071b0: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
-000071c0: 7320 4e55 4c4c 2e22 2222 0a20 2020 2063  s NULL.""".    c
-000071d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000071e0: 7228 652c 2022 7375 6d5f 6469 7374 696e  r(e, "sum_distin
-000071f0: 6374 2229 0a20 2020 2072 6574 7572 6e20  ct").    return 
-00007200: 5f63 616c 6c5f 6675 6e63 7469 6f6e 2822  _call_function("
-00007210: 7375 6d22 2c20 5472 7565 2c20 6329 0a0a  sum", True, c)..
-00007220: 0a64 6566 2076 6172 6961 6e63 6528 653a  .def variance(e:
-00007230: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00007240: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00007250: 2252 6574 7572 6e73 2074 6865 2073 616d  "Returns the sam
-00007260: 706c 6520 7661 7269 616e 6365 206f 6620  ple variance of 
-00007270: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
-00007280: 2069 6e20 6120 6772 6f75 702e 2049 6620   in a group. If 
-00007290: 616c 6c20 7265 636f 7264 730a 2020 2020  all records.    
-000072a0: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
-000072b0: 7265 204e 554c 4c2c 2061 204e 554c 4c20  re NULL, a NULL 
-000072c0: 6973 2072 6574 7572 6e65 642e 2046 6f72  is returned. For
-000072d0: 2061 2073 696e 676c 6520 726f 772c 204e   a single row, N
-000072e0: 554c 4c20 6973 2072 6574 7572 6e65 6420  ULL is returned 
-000072f0: 6173 2073 616d 706c 6520 7661 7269 616e  as sample varian
-00007300: 6365 2e0a 0a20 2020 2045 7861 6d70 6c65  ce...    Example
-00007310: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00007320: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00007330: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-00007340: 2c20 2d31 2c20 312c 202d 312c 202d 315d  , -1, 1, -1, -1]
-00007350: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-00007360: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00007370: 656c 6563 7428 7661 7269 616e 6365 2863  elect(variance(c
-00007380: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
-00007390: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-000073a0: 2856 4152 4941 4e43 4528 2241 2229 3d44  (VARIANCE("A")=D
-000073b0: 6563 696d 616c 2827 312e 3230 3030 3030  ecimal('1.200000
-000073c0: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
-000073d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000073e0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000073f0: 5b31 2c20 4e6f 6e65 2c20 322c 2033 2c20  [1, None, 2, 3, 
-00007400: 4e6f 6e65 2c20 352c 2036 5d2c 2073 6368  None, 5, 6], sch
-00007410: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00007420: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00007430: 2876 6172 6961 6e63 6528 636f 6c28 2261  (variance(col("a
-00007440: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00007450: 2020 2020 2020 205b 526f 7728 5641 5249         [Row(VARI
-00007460: 414e 4345 2822 4122 293d 4465 6369 6d61  ANCE("A")=Decima
-00007470: 6c28 2734 2e33 3030 3030 3027 2929 5d0a  l('4.300000'))].
-00007480: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00007490: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000074a0: 5f64 6174 6166 7261 6d65 285b 4e6f 6e65  _dataframe([None
-000074b0: 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c 2073  , None, None], s
-000074c0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-000074d0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-000074e0: 6374 2876 6172 6961 6e63 6528 636f 6c28  ct(variance(col(
-000074f0: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
-00007500: 0a20 2020 2020 2020 205b 526f 7728 5641  .        [Row(VA
-00007510: 5249 414e 4345 2822 4122 293d 4e6f 6e65  RIANCE("A")=None
-00007520: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
-00007530: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00007540: 6174 655f 6461 7461 6672 616d 6528 5b34  ate_dataframe([4
-00007550: 325d 2c20 7363 6865 6d61 3d5b 2261 225d  2], schema=["a"]
-00007560: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00007570: 2e73 656c 6563 7428 7661 7269 616e 6365  .select(variance
-00007580: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
-00007590: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-000075a0: 6f77 2856 4152 4941 4e43 4528 2241 2229  ow(VARIANCE("A")
-000075b0: 3d4e 6f6e 6529 5d0a 0a20 2020 2022 2222  =None)]..    """
-000075c0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-000075d0: 5f69 665f 7374 7228 652c 2022 7661 7269  _if_str(e, "vari
-000075e0: 616e 6365 2229 0a20 2020 2072 6574 7572  ance").    retur
-000075f0: 6e20 6275 696c 7469 6e28 2276 6172 6961  n builtin("varia
-00007600: 6e63 6522 2928 6329 0a0a 0a64 6566 2076  nce")(c)...def v
-00007610: 6172 5f73 616d 7028 653a 2043 6f6c 756d  ar_samp(e: Colum
-00007620: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00007630: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00007640: 6e73 2074 6865 2073 616d 706c 6520 7661  ns the sample va
-00007650: 7269 616e 6365 206f 6620 6e6f 6e2d 4e55  riance of non-NU
-00007660: 4c4c 2072 6563 6f72 6473 2069 6e20 6120  LL records in a 
-00007670: 6772 6f75 702e 2049 6620 616c 6c20 7265  group. If all re
-00007680: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
-00007690: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
-000076a0: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
-000076b0: 7572 6e65 642e 2046 6f72 2061 2073 696e  urned. For a sin
-000076c0: 676c 6520 726f 772c 204e 554c 4c20 6973  gle row, NULL is
-000076d0: 2072 6574 7572 6e65 6420 6173 2073 616d   returned as sam
-000076e0: 706c 6520 7661 7269 616e 6365 2e0a 2020  ple variance..  
-000076f0: 2020 416c 6961 7320 6f66 203a 6675 6e63    Alias of :func
-00007700: 3a60 7661 7269 616e 6365 600a 0a20 2020  :`variance`..   
-00007710: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00007720: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00007730: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00007740: 6672 616d 6528 5b31 2c20 2d31 2c20 312c  frame([1, -1, 1,
-00007750: 202d 312c 202d 315d 2c20 7363 6865 6d61   -1, -1], schema
-00007760: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00007770: 3e3e 3e20 6466 2e73 656c 6563 7428 7661  >>> df.select(va
-00007780: 725f 7361 6d70 2863 6f6c 2822 6122 2929  r_samp(col("a"))
-00007790: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-000077a0: 2020 2020 5b52 6f77 2856 4152 4941 4e43      [Row(VARIANC
-000077b0: 4528 2241 2229 3d44 6563 696d 616c 2827  E("A")=Decimal('
-000077c0: 312e 3230 3030 3030 2729 295d 0a0a 2020  1.200000'))]..  
-000077d0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000077e0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000077f0: 7461 6672 616d 6528 5b31 2c20 4e6f 6e65  taframe([1, None
-00007800: 2c20 322c 2033 2c20 4e6f 6e65 2c20 352c  , 2, 3, None, 5,
-00007810: 2036 5d2c 2073 6368 656d 613d 5b22 6122   6], schema=["a"
-00007820: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00007830: 662e 7365 6c65 6374 2876 6172 5f73 616d  f.select(var_sam
-00007840: 7028 636f 6c28 2261 2229 2929 2e63 6f6c  p(col("a"))).col
-00007850: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00007860: 526f 7728 5641 5249 414e 4345 2822 4122  Row(VARIANCE("A"
-00007870: 293d 4465 6369 6d61 6c28 2734 2e33 3030  )=Decimal('4.300
-00007880: 3030 3027 2929 5d0a 0a20 2020 2020 2020  000'))]..       
-00007890: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000078a0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000078b0: 6d65 285b 4e6f 6e65 2c20 4e6f 6e65 2c20  me([None, None, 
-000078c0: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b22  None], schema=["
-000078d0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-000078e0: 2064 662e 7365 6c65 6374 2876 6172 5f73   df.select(var_s
-000078f0: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
-00007900: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00007910: 205b 526f 7728 5641 5249 414e 4345 2822   [Row(VARIANCE("
-00007920: 4122 293d 4e6f 6e65 295d 0a0a 2020 2020  A")=None)]..    
-00007930: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00007940: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00007950: 6672 616d 6528 5b34 325d 2c20 7363 6865  frame([42], sche
-00007960: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00007970: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00007980: 7661 725f 7361 6d70 2863 6f6c 2822 6122  var_samp(col("a"
-00007990: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
-000079a0: 2020 2020 2020 5b52 6f77 2856 4152 4941        [Row(VARIA
-000079b0: 4e43 4528 2241 2229 3d4e 6f6e 6529 5d0a  NCE("A")=None)].
-000079c0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-000079d0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-000079e0: 652c 2022 7661 725f 7361 6d70 2229 0a20  e, "var_samp"). 
-000079f0: 2020 2072 6574 7572 6e20 7661 7269 616e     return varian
-00007a00: 6365 2863 290a 0a0a 6465 6620 7661 725f  ce(c)...def var_
-00007a10: 706f 7028 653a 2043 6f6c 756d 6e4f 724e  pop(e: ColumnOrN
-00007a20: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00007a30: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-00007a40: 6865 2070 6f70 756c 6174 696f 6e20 7661  he population va
-00007a50: 7269 616e 6365 206f 6620 6e6f 6e2d 4e55  riance of non-NU
-00007a60: 4c4c 2072 6563 6f72 6473 2069 6e20 6120  LL records in a 
-00007a70: 6772 6f75 702e 2049 6620 616c 6c20 7265  group. If all re
-00007a80: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
-00007a90: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
-00007aa0: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
-00007ab0: 7572 6e65 642e 2054 6865 2070 6f70 756c  urned. The popul
-00007ac0: 6174 696f 6e20 7661 7269 616e 6365 206f  ation variance o
-00007ad0: 6620 6120 7369 6e67 6c65 2072 6f77 2069  f a single row i
-00007ae0: 7320 302e 302e 0a0a 2020 2020 4578 616d  s 0.0...    Exam
-00007af0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00007b00: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00007b10: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00007b20: 285b 312c 202d 312c 2031 2c20 2d31 2c20  ([1, -1, 1, -1, 
-00007b30: 2d31 5d2c 2073 6368 656d 613d 5b22 6122  -1], schema=["a"
-00007b40: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00007b50: 662e 7365 6c65 6374 2876 6172 5f70 6f70  f.select(var_pop
-00007b60: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
-00007b70: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00007b80: 6f77 2856 4152 5f50 4f50 2822 4122 293d  ow(VAR_POP("A")=
-00007b90: 4465 6369 6d61 6c28 2730 2e39 3630 3030  Decimal('0.96000
-00007ba0: 3027 2929 5d0a 0a20 2020 2020 2020 203e  0'))]..        >
-00007bb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00007bc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00007bd0: 285b 312c 204e 6f6e 652c 2032 2c20 332c  ([1, None, 2, 3,
-00007be0: 204e 6f6e 652c 2035 2c20 365d 2c20 7363   None, 5, 6], sc
-00007bf0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00007c00: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00007c10: 7428 7661 725f 706f 7028 636f 6c28 2261  t(var_pop(col("a
-00007c20: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00007c30: 2020 2020 2020 205b 526f 7728 5641 525f         [Row(VAR_
-00007c40: 504f 5028 2241 2229 3d44 6563 696d 616c  POP("A")=Decimal
-00007c50: 2827 332e 3434 3030 3030 2729 295d 0a0a  ('3.440000'))]..
-00007c60: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00007c70: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00007c80: 6461 7461 6672 616d 6528 5b4e 6f6e 652c  dataframe([None,
-00007c90: 204e 6f6e 652c 204e 6f6e 655d 2c20 7363   None, None], sc
-00007ca0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00007cb0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00007cc0: 7428 7661 725f 706f 7028 636f 6c28 2261  t(var_pop(col("a
-00007cd0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00007ce0: 2020 2020 2020 205b 526f 7728 5641 525f         [Row(VAR_
-00007cf0: 504f 5028 2241 2229 3d4e 6f6e 6529 5d0a  POP("A")=None)].
-00007d00: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00007d10: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00007d20: 5f64 6174 6166 7261 6d65 285b 3432 5d2c  _dataframe([42],
-00007d30: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00007d40: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00007d50: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
-00007d60: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-00007d70: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
-00007d80: 4152 5f50 4f50 2822 4122 293d 4465 6369  AR_POP("A")=Deci
-00007d90: 6d61 6c28 2730 2e30 3030 3030 3027 2929  mal('0.000000'))
-00007da0: 5d0a 0a20 2020 2022 2222 0a20 2020 2063  ]..    """.    c
-00007db0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00007dc0: 7228 652c 2022 7661 725f 706f 7022 290a  r(e, "var_pop").
-00007dd0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00007de0: 696e 2822 7661 725f 706f 7022 2928 6329  in("var_pop")(c)
-00007df0: 0a0a 0a64 6566 2061 7070 726f 785f 7065  ...def approx_pe
-00007e00: 7263 656e 7469 6c65 2863 6f6c 3a20 436f  rcentile(col: Co
-00007e10: 6c75 6d6e 4f72 4e61 6d65 2c20 7065 7263  lumnOrName, perc
-00007e20: 656e 7469 6c65 3a20 666c 6f61 7429 202d  entile: float) -
-00007e30: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00007e40: 2252 6574 7572 6e73 2061 6e20 6170 7072  "Returns an appr
-00007e50: 6f78 696d 6174 6564 2076 616c 7565 2066  oximated value f
-00007e60: 6f72 2074 6865 2064 6573 6972 6564 2070  or the desired p
-00007e70: 6572 6365 6e74 696c 652e 2054 6869 7320  ercentile. This 
-00007e80: 6675 6e63 7469 6f6e 2075 7365 7320 7468  function uses th
-00007e90: 6520 742d 4469 6765 7374 2061 6c67 6f72  e t-Digest algor
-00007ea0: 6974 686d 2e22 2222 0a20 2020 2063 203d  ithm.""".    c =
-00007eb0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00007ec0: 636f 6c2c 2022 6170 7072 6f78 5f70 6572  col, "approx_per
-00007ed0: 6365 6e74 696c 6522 290a 2020 2020 7265  centile").    re
-00007ee0: 7475 726e 2062 7569 6c74 696e 2822 6170  turn builtin("ap
-00007ef0: 7072 6f78 5f70 6572 6365 6e74 696c 6522  prox_percentile"
-00007f00: 2928 632c 2073 716c 5f65 7870 7228 7374  )(c, sql_expr(st
-00007f10: 7228 7065 7263 656e 7469 6c65 2929 290a  r(percentile))).
-00007f20: 0a0a 6465 6620 6170 7072 6f78 5f70 6572  ..def approx_per
-00007f30: 6365 6e74 696c 655f 6163 6375 6d75 6c61  centile_accumula
-00007f40: 7465 2863 6f6c 3a20 436f 6c75 6d6e 4f72  te(col: ColumnOr
-00007f50: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00007f60: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00007f70: 7468 6520 696e 7465 726e 616c 2072 6570  the internal rep
-00007f80: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
-00007f90: 6865 2074 2d44 6967 6573 7420 7374 6174  he t-Digest stat
-00007fa0: 6520 2861 7320 6120 4a53 4f4e 206f 626a  e (as a JSON obj
-00007fb0: 6563 7429 2061 7420 7468 6520 656e 6420  ect) at the end 
-00007fc0: 6f66 2061 6767 7265 6761 7469 6f6e 2e0a  of aggregation..
-00007fd0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-00007fe0: 6e20 7573 6573 2074 6865 2074 2d44 6967  n uses the t-Dig
-00007ff0: 6573 7420 616c 676f 7269 7468 6d2e 0a20  est algorithm.. 
-00008000: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-00008010: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-00008020: 6c2c 2022 6170 7072 6f78 5f70 6572 6365  l, "approx_perce
-00008030: 6e74 696c 655f 6163 6375 6d75 6c61 7465  ntile_accumulate
-00008040: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00008050: 696c 7469 6e28 2261 7070 726f 785f 7065  iltin("approx_pe
-00008060: 7263 656e 7469 6c65 5f61 6363 756d 756c  rcentile_accumul
-00008070: 6174 6522 2928 6329 0a0a 0a64 6566 2061  ate")(c)...def a
-00008080: 7070 726f 785f 7065 7263 656e 7469 6c65  pprox_percentile
-00008090: 5f65 7374 696d 6174 6528 7374 6174 653a  _estimate(state:
-000080a0: 2043 6f6c 756d 6e4f 724e 616d 652c 2070   ColumnOrName, p
-000080b0: 6572 6365 6e74 696c 653a 2066 6c6f 6174  ercentile: float
-000080c0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000080d0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-000080e0: 6465 7369 7265 6420 6170 7072 6f78 696d  desired approxim
-000080f0: 6174 6564 2070 6572 6365 6e74 696c 6520  ated percentile 
-00008100: 7661 6c75 6520 666f 7220 7468 6520 7370  value for the sp
-00008110: 6563 6966 6965 6420 742d 4469 6765 7374  ecified t-Digest
-00008120: 2073 7461 7465 2e0a 2020 2020 4150 5052   state..    APPR
-00008130: 4f58 5f50 4552 4345 4e54 494c 455f 4553  OX_PERCENTILE_ES
-00008140: 5449 4d41 5445 2841 5050 524f 585f 5045  TIMATE(APPROX_PE
-00008150: 5243 454e 5449 4c45 5f41 4343 554d 554c  RCENTILE_ACCUMUL
-00008160: 4154 4528 2e29 2920 6973 2065 7175 6976  ATE(.)) is equiv
-00008170: 616c 656e 7420 746f 0a20 2020 2041 5050  alent to.    APP
-00008180: 524f 585f 5045 5243 454e 5449 4c45 282e  ROX_PERCENTILE(.
-00008190: 292e 0a20 2020 2022 2222 0a20 2020 2063  )..    """.    c
-000081a0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000081b0: 7228 7374 6174 652c 2022 6170 7072 6f78  r(state, "approx
-000081c0: 5f70 6572 6365 6e74 696c 655f 6573 7469  _percentile_esti
-000081d0: 6d61 7465 2229 0a20 2020 2072 6574 7572  mate").    retur
-000081e0: 6e20 6275 696c 7469 6e28 2261 7070 726f  n builtin("appro
-000081f0: 785f 7065 7263 656e 7469 6c65 5f65 7374  x_percentile_est
-00008200: 696d 6174 6522 2928 632c 2073 716c 5f65  imate")(c, sql_e
-00008210: 7870 7228 7374 7228 7065 7263 656e 7469  xpr(str(percenti
-00008220: 6c65 2929 290a 0a0a 6465 6620 6170 7072  le)))...def appr
-00008230: 6f78 5f70 6572 6365 6e74 696c 655f 636f  ox_percentile_co
-00008240: 6d62 696e 6528 7374 6174 653a 2043 6f6c  mbine(state: Col
-00008250: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00008260: 6c75 6d6e 3a0a 2020 2020 2222 2243 6f6d  lumn:.    """Com
-00008270: 6269 6e65 7320 286d 6572 6765 7329 2070  bines (merges) p
-00008280: 6572 6365 6e74 696c 6520 696e 7075 7420  ercentile input 
-00008290: 7374 6174 6573 2069 6e74 6f20 6120 7369  states into a si
-000082a0: 6e67 6c65 206f 7574 7075 7420 7374 6174  ngle output stat
-000082b0: 652e 0a20 2020 2054 6869 7320 616c 6c6f  e..    This allo
-000082c0: 7773 2073 6365 6e61 7269 6f73 2077 6865  ws scenarios whe
-000082d0: 7265 2041 5050 524f 585f 5045 5243 454e  re APPROX_PERCEN
-000082e0: 5449 4c45 5f41 4343 554d 554c 4154 4520  TILE_ACCUMULATE 
-000082f0: 6973 2072 756e 206f 7665 7220 686f 7269  is run over hori
-00008300: 7a6f 6e74 616c 2070 6172 7469 7469 6f6e  zontal partition
-00008310: 730a 2020 2020 6f66 2074 6865 2073 616d  s.    of the sam
-00008320: 6520 7461 626c 652c 2070 726f 6475 6369  e table, produci
-00008330: 6e67 2061 6e20 616c 676f 7269 7468 6d20  ng an algorithm 
-00008340: 7374 6174 6520 666f 7220 6561 6368 2074  state for each t
-00008350: 6162 6c65 2070 6172 7469 7469 6f6e 2e20  able partition. 
-00008360: 5468 6573 6520 7374 6174 6573 2063 616e  These states can
-00008370: 0a20 2020 206c 6174 6572 2062 6520 636f  .    later be co
-00008380: 6d62 696e 6564 2075 7369 6e67 2041 5050  mbined using APP
-00008390: 524f 585f 5045 5243 454e 5449 4c45 5f43  ROX_PERCENTILE_C
-000083a0: 4f4d 4249 4e45 2c20 7072 6f64 7563 696e  OMBINE, producin
-000083b0: 6720 7468 6520 7361 6d65 206f 7574 7075  g the same outpu
-000083c0: 7420 7374 6174 6520 6173 2061 0a20 2020  t state as a.   
-000083d0: 2073 696e 676c 6520 7275 6e20 6f66 2041   single run of A
-000083e0: 5050 524f 585f 5045 5243 454e 5449 4c45  PPROX_PERCENTILE
-000083f0: 5f41 4343 554d 554c 4154 4520 6f76 6572  _ACCUMULATE over
-00008400: 2074 6865 2065 6e74 6972 6520 7461 626c   the entire tabl
-00008410: 652e 0a20 2020 2022 2222 0a20 2020 2063  e..    """.    c
-00008420: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00008430: 7228 7374 6174 652c 2022 6170 7072 6f78  r(state, "approx
-00008440: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
-00008450: 696e 6522 290a 2020 2020 7265 7475 726e  ine").    return
-00008460: 2062 7569 6c74 696e 2822 6170 7072 6f78   builtin("approx
-00008470: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
-00008480: 696e 6522 2928 6329 0a0a 0a64 6566 2067  ine")(c)...def g
-00008490: 726f 7570 696e 6728 2a63 6f6c 733a 2043  rouping(*cols: C
-000084a0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-000084b0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-000084c0: 2020 2020 4465 7363 7269 6265 7320 7768      Describes wh
-000084d0: 6963 6820 6f66 2061 206c 6973 7420 6f66  ich of a list of
-000084e0: 2065 7870 7265 7373 696f 6e73 2061 7265   expressions are
-000084f0: 2067 726f 7570 6564 2069 6e20 6120 726f   grouped in a ro
-00008500: 7720 7072 6f64 7563 6564 2062 7920 6120  w produced by a 
-00008510: 4752 4f55 5020 4259 2071 7565 7279 2e0a  GROUP BY query..
-00008520: 0a20 2020 203a 6675 6e63 3a60 6772 6f75  .    :func:`grou
-00008530: 7069 6e67 5f69 6460 2069 7320 616e 2061  ping_id` is an a
-00008540: 6c69 6173 206f 6620 3a66 756e 633a 6067  lias of :func:`g
-00008550: 726f 7570 696e 6760 2e0a 0a20 2020 2045  rouping`...    E
-00008560: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00008570: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-00008580: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
-00008590: 6f72 7420 4772 6f75 7069 6e67 5365 7473  ort GroupingSets
-000085a0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000085b0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000085c0: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
-000085d0: 322c 2033 5d2c 205b 342c 2035 2c20 365d  2, 3], [4, 5, 6]
-000085e0: 5d2c 7363 6865 6d61 3d5b 2261 222c 2022  ],schema=["a", "
-000085f0: 6222 2c20 2263 225d 290a 2020 2020 2020  b", "c"]).      
-00008600: 2020 3e3e 3e20 6772 6f75 7069 6e67 5f73    >>> grouping_s
-00008610: 6574 7320 3d20 4772 6f75 7069 6e67 5365  ets = GroupingSe
-00008620: 7473 285b 636f 6c28 2261 2229 5d2c 205b  ts([col("a")], [
-00008630: 636f 6c28 2262 2229 5d2c 205b 636f 6c28  col("b")], [col(
-00008640: 2261 2229 2c20 636f 6c28 2262 2229 5d29  "a"), col("b")])
-00008650: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00008660: 6772 6f75 705f 6279 5f67 726f 7570 696e  group_by_groupin
-00008670: 675f 7365 7473 2867 726f 7570 696e 675f  g_sets(grouping_
-00008680: 7365 7473 292e 6167 6728 5b63 6f75 6e74  sets).agg([count
-00008690: 2822 6322 292c 2067 726f 7570 696e 6728  ("c"), grouping(
-000086a0: 2261 2229 2c20 6772 6f75 7069 6e67 2822  "a"), grouping("
-000086b0: 6222 292c 2067 726f 7570 696e 6728 2261  b"), grouping("a
-000086c0: 222c 2022 6222 295d 292e 636f 6c6c 6563  ", "b")]).collec
-000086d0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-000086e0: 2841 3d31 2c20 423d 322c 2043 4f55 4e54  (A=1, B=2, COUNT
-000086f0: 2843 293d 312c 2047 524f 5550 494e 4728  (C)=1, GROUPING(
-00008700: 4129 3d30 2c20 4752 4f55 5049 4e47 2842  A)=0, GROUPING(B
-00008710: 293d 302c 2047 524f 5550 494e 4728 412c  )=0, GROUPING(A,
-00008720: 2042 293d 3029 2c20 5c0a 526f 7728 413d   B)=0), \.Row(A=
-00008730: 342c 2042 3d35 2c20 434f 554e 5428 4329  4, B=5, COUNT(C)
-00008740: 3d31 2c20 4752 4f55 5049 4e47 2841 293d  =1, GROUPING(A)=
-00008750: 302c 2047 524f 5550 494e 4728 4229 3d30  0, GROUPING(B)=0
-00008760: 2c20 4752 4f55 5049 4e47 2841 2c20 4229  , GROUPING(A, B)
-00008770: 3d30 292c 205c 0a52 6f77 2841 3d31 2c20  =0), \.Row(A=1, 
-00008780: 423d 4e6f 6e65 2c20 434f 554e 5428 4329  B=None, COUNT(C)
-00008790: 3d31 2c20 4752 4f55 5049 4e47 2841 293d  =1, GROUPING(A)=
-000087a0: 302c 2047 524f 5550 494e 4728 4229 3d31  0, GROUPING(B)=1
-000087b0: 2c20 4752 4f55 5049 4e47 2841 2c20 4229  , GROUPING(A, B)
-000087c0: 3d31 292c 205c 0a52 6f77 2841 3d34 2c20  =1), \.Row(A=4, 
-000087d0: 423d 4e6f 6e65 2c20 434f 554e 5428 4329  B=None, COUNT(C)
-000087e0: 3d31 2c20 4752 4f55 5049 4e47 2841 293d  =1, GROUPING(A)=
-000087f0: 302c 2047 524f 5550 494e 4728 4229 3d31  0, GROUPING(B)=1
-00008800: 2c20 4752 4f55 5049 4e47 2841 2c20 4229  , GROUPING(A, B)
-00008810: 3d31 292c 205c 0a52 6f77 2841 3d4e 6f6e  =1), \.Row(A=Non
-00008820: 652c 2042 3d32 2c20 434f 554e 5428 4329  e, B=2, COUNT(C)
-00008830: 3d31 2c20 4752 4f55 5049 4e47 2841 293d  =1, GROUPING(A)=
-00008840: 312c 2047 524f 5550 494e 4728 4229 3d30  1, GROUPING(B)=0
-00008850: 2c20 4752 4f55 5049 4e47 2841 2c20 4229  , GROUPING(A, B)
-00008860: 3d32 292c 205c 0a52 6f77 2841 3d4e 6f6e  =2), \.Row(A=Non
-00008870: 652c 2042 3d35 2c20 434f 554e 5428 4329  e, B=5, COUNT(C)
-00008880: 3d31 2c20 4752 4f55 5049 4e47 2841 293d  =1, GROUPING(A)=
-00008890: 312c 2047 524f 5550 494e 4728 4229 3d30  1, GROUPING(B)=0
-000088a0: 2c20 4752 4f55 5049 4e47 2841 2c20 4229  , GROUPING(A, B)
-000088b0: 3d32 295d 0a20 2020 2022 2222 0a20 2020  =2)].    """.   
-000088c0: 2063 6f6c 756d 6e73 203d 205b 5f74 6f5f   columns = [_to_
-000088d0: 636f 6c5f 6966 5f73 7472 2863 2c20 2267  col_if_str(c, "g
-000088e0: 726f 7570 696e 6722 2920 666f 7220 6320  rouping") for c 
-000088f0: 696e 2063 6f6c 735d 0a20 2020 2072 6574  in cols].    ret
-00008900: 7572 6e20 6275 696c 7469 6e28 2267 726f  urn builtin("gro
-00008910: 7570 696e 6722 2928 2a63 6f6c 756d 6e73  uping")(*columns
-00008920: 290a 0a0a 6772 6f75 7069 6e67 5f69 6420  )...grouping_id 
-00008930: 3d20 6772 6f75 7069 6e67 0a0a 0a64 6566  = grouping...def
-00008940: 2063 6f61 6c65 7363 6528 2a65 3a20 436f   coalesce(*e: Co
-00008950: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00008960: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00008970: 7475 726e 7320 7468 6520 6669 7273 7420  turns the first 
-00008980: 6e6f 6e2d 4e55 4c4c 2065 7870 7265 7373  non-NULL express
-00008990: 696f 6e20 616d 6f6e 6720 6974 7320 6172  ion among its ar
-000089a0: 6775 6d65 6e74 732c 206f 7220 4e55 4c4c  guments, or NULL
-000089b0: 2069 6620 616c 6c20 6974 730a 2020 2020   if all its.    
-000089c0: 6172 6775 6d65 6e74 7320 6172 6520 4e55  arguments are NU
-000089d0: 4c4c 2e0a 0a20 2020 2045 7861 6d70 6c65  LL...    Example
-000089e0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-000089f0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00008a00: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00008a10: 312c 2032 2c20 335d 2c20 5b4e 6f6e 652c  1, 2, 3], [None,
-00008a20: 2032 2c20 335d 2c20 5b4e 6f6e 652c 204e   2, 3], [None, N
-00008a30: 6f6e 652c 2033 5d2c 205b 4e6f 6e65 2c20  one, 3], [None, 
-00008a40: 4e6f 6e65 2c20 4e6f 6e65 5d5d 2c20 7363  None, None]], sc
-00008a50: 6865 6d61 3d5b 2761 272c 2027 6227 2c20  hema=['a', 'b', 
-00008a60: 2763 275d 290a 2020 2020 2020 2020 3e3e  'c']).        >>
-00008a70: 3e20 6466 2e73 656c 6563 7428 6466 2e61  > df.select(df.a
-00008a80: 2c20 6466 2e62 2c20 6466 2e63 2c20 636f  , df.b, df.c, co
-00008a90: 616c 6573 6365 2864 662e 612c 2064 662e  alesce(df.a, df.
-00008aa0: 622c 2064 662e 6329 2e61 735f 2822 434f  b, df.c).as_("CO
-00008ab0: 414c 4553 4345 2229 292e 7368 6f77 2829  ALESCE")).show()
-00008ac0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00008ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00008af0: 2020 2020 207c 2241 2220 2020 7c22 4222       |"A"   |"B"
-00008b00: 2020 207c 2243 2220 2020 7c22 434f 414c     |"C"   |"COAL
-00008b10: 4553 4345 2220 207c 0a20 2020 2020 2020  ESCE"  |.       
-00008b20: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00008b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008b40: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
-00008b50: 2020 2020 7c32 2020 2020 207c 3320 2020      |2     |3   
-00008b60: 2020 7c31 2020 2020 2020 2020 2020 207c    |1           |
-00008b70: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
-00008b80: 7c32 2020 2020 207c 3320 2020 2020 7c32  |2     |3     |2
-00008b90: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-00008ba0: 2020 2020 207c 4e55 4c4c 2020 7c4e 554c       |NULL  |NUL
-00008bb0: 4c20 207c 3320 2020 2020 7c33 2020 2020  L  |3     |3    
-00008bc0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00008bd0: 207c 4e55 4c4c 2020 7c4e 554c 4c20 207c   |NULL  |NULL  |
-00008be0: 4e55 4c4c 2020 7c4e 554c 4c20 2020 2020  NULL  |NULL     
-00008bf0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00008c00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008c20: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00008c30: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00008c40: 2063 203d 205b 5f74 6f5f 636f 6c5f 6966   c = [_to_col_if
-00008c50: 5f73 7472 2865 782c 2022 636f 616c 6573  _str(ex, "coales
-00008c60: 6365 2229 2066 6f72 2065 7820 696e 2065  ce") for ex in e
-00008c70: 5d0a 2020 2020 7265 7475 726e 2062 7569  ].    return bui
-00008c80: 6c74 696e 2822 636f 616c 6573 6365 2229  ltin("coalesce")
-00008c90: 282a 6329 0a0a 0a64 6566 2065 7175 616c  (*c)...def equal
-00008ca0: 5f6e 616e 2865 3a20 436f 6c75 6d6e 4f72  _nan(e: ColumnOr
-00008cb0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00008cc0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-00008cd0: 7572 6e20 7472 7565 2069 6620 7468 6520  urn true if the 
-00008ce0: 7661 6c75 6520 696e 2074 6865 2063 6f6c  value in the col
-00008cf0: 756d 6e20 6973 206e 6f74 2061 206e 756d  umn is not a num
-00008d00: 6265 7220 284e 614e 292e 0a0a 2020 2020  ber (NaN)...    
-00008d10: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00008d20: 2020 203e 3e3e 2069 6d70 6f72 7420 6d61     >>> import ma
-00008d30: 7468 0a20 2020 2020 2020 203e 3e3e 2064  th.        >>> d
-00008d40: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00008d50: 7465 5f64 6174 6166 7261 6d65 285b 312e  te_dataframe([1.
-00008d60: 312c 206d 6174 682e 6e61 6e2c 2032 2e33  1, math.nan, 2.3
-00008d70: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00008d80: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00008d90: 7365 6c65 6374 2865 7175 616c 5f6e 616e  select(equal_nan
-00008da0: 2864 665b 2261 225d 292e 616c 6961 7328  (df["a"]).alias(
-00008db0: 2265 7175 616c 5f6e 616e 2229 292e 636f  "equal_nan")).co
-00008dc0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00008dd0: 5b52 6f77 2845 5155 414c 5f4e 414e 3d46  [Row(EQUAL_NAN=F
-00008de0: 616c 7365 292c 2052 6f77 2845 5155 414c  alse), Row(EQUAL
-00008df0: 5f4e 414e 3d54 7275 6529 2c20 526f 7728  _NAN=True), Row(
-00008e00: 4551 5541 4c5f 4e41 4e3d 4661 6c73 6529  EQUAL_NAN=False)
-00008e10: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-00008e20: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00008e30: 2865 2c20 2265 7175 616c 5f6e 616e 2229  (e, "equal_nan")
-00008e40: 0a20 2020 2072 6574 7572 6e20 632e 6571  .    return c.eq
-00008e50: 7561 6c5f 6e61 6e28 290a 0a0a 6465 6620  ual_nan()...def 
-00008e60: 6973 5f6e 756c 6c28 653a 2043 6f6c 756d  is_null(e: Colum
-00008e70: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00008e80: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00008e90: 5265 7475 726e 2074 7275 6520 6966 2074  Return true if t
-00008ea0: 6865 2076 616c 7565 2069 6e20 7468 6520  he value in the 
-00008eb0: 636f 6c75 6d6e 2069 7320 6e75 6c6c 2e0a  column is null..
-00008ec0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00008ed0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00008ee0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00008ef0: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
-00008f00: 706f 7274 2069 735f 6e75 6c6c 0a20 2020  port is_null.   
-00008f10: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00008f20: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00008f30: 6166 7261 6d65 285b 312e 322c 2066 6c6f  aframe([1.2, flo
-00008f40: 6174 2822 6e61 6e22 292c 204e 6f6e 652c  at("nan"), None,
-00008f50: 2031 2e30 5d2c 2073 6368 656d 613d 5b22   1.0], schema=["
-00008f60: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00008f70: 2064 662e 7365 6c65 6374 2869 735f 6e75   df.select(is_nu
-00008f80: 6c6c 2822 6122 292e 6173 5f28 2261 2229  ll("a").as_("a")
-00008f90: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00008fa0: 2020 2020 5b52 6f77 2841 3d46 616c 7365      [Row(A=False
-00008fb0: 292c 2052 6f77 2841 3d46 616c 7365 292c  ), Row(A=False),
-00008fc0: 2052 6f77 2841 3d54 7275 6529 2c20 526f   Row(A=True), Ro
-00008fd0: 7728 413d 4661 6c73 6529 5d0a 2020 2020  w(A=False)].    
-00008fe0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00008ff0: 636f 6c5f 6966 5f73 7472 2865 2c20 2269  col_if_str(e, "i
-00009000: 735f 6e75 6c6c 2229 0a20 2020 2072 6574  s_null").    ret
-00009010: 7572 6e20 632e 6973 5f6e 756c 6c28 290a  urn c.is_null().
-00009020: 0a0a 6465 6620 6e65 6761 7465 2865 3a20  ..def negate(e: 
-00009030: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00009040: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00009050: 5265 7475 726e 7320 7468 6520 6e65 6761  Returns the nega
-00009060: 7469 6f6e 206f 6620 7468 6520 7661 6c75  tion of the valu
-00009070: 6520 696e 2074 6865 2063 6f6c 756d 6e20  e in the column 
-00009080: 2865 7175 6976 616c 656e 7420 746f 2061  (equivalent to a
-00009090: 2075 6e61 7279 206d 696e 7573 292e 0a0a   unary minus)...
-000090a0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-000090b0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000090c0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000090d0: 6174 6166 7261 6d65 285b 5b31 5d5d 2c20  ataframe([[1]], 
-000090e0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-000090f0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00009100: 6563 7428 6e65 6761 7465 2863 6f6c 2822  ect(negate(col("
-00009110: 6122 292e 616c 6961 7328 2272 6573 756c  a").alias("resul
-00009120: 7422 2929 292e 7368 6f77 2829 0a20 2020  t"))).show().   
-00009130: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00009140: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-00009150: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-00009160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00009170: 2020 2020 7c2d 3120 2020 2020 2020 207c      |-1        |
-00009180: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00009190: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-000091a0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-000091b0: 220a 0a20 2020 2063 203d 205f 746f 5f63  "..    c = _to_c
-000091c0: 6f6c 5f69 665f 7374 7228 652c 2022 6e65  ol_if_str(e, "ne
-000091d0: 6761 7465 2229 0a20 2020 2072 6574 7572  gate").    retur
-000091e0: 6e20 2d63 0a0a 0a64 6566 206e 6f74 5f28  n -c...def not_(
-000091f0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-00009200: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00009210: 2222 2252 6574 7572 6e73 2074 6865 2069  """Returns the i
-00009220: 6e76 6572 7365 206f 6620 6120 626f 6f6c  nverse of a bool
-00009230: 6561 6e20 6578 7072 6573 7369 6f6e 2e0a  ean expression..
-00009240: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00009250: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00009260: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00009270: 6461 7461 6672 616d 6528 5b5b 5472 7565  dataframe([[True
-00009280: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
-00009290: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000092a0: 2e73 656c 6563 7428 6e6f 745f 2863 6f6c  .select(not_(col
-000092b0: 2822 6122 292e 616c 6961 7328 2272 6573  ("a").alias("res
-000092c0: 756c 7422 2929 292e 7368 6f77 2829 0a20  ult"))).show(). 
-000092d0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000092e0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-000092f0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-00009300: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00009310: 2020 2020 2020 7c46 616c 7365 2020 2020        |False    
-00009320: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00009330: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00009340: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00009350: 2222 220a 0a20 2020 2063 203d 205f 746f  """..    c = _to
-00009360: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00009370: 6e6f 745f 2229 0a20 2020 2072 6574 7572  not_").    retur
-00009380: 6e20 7e63 0a0a 0a64 6566 2072 616e 646f  n ~c...def rando
-00009390: 6d28 7365 6564 3a20 4f70 7469 6f6e 616c  m(seed: Optional
-000093a0: 5b69 6e74 5d20 3d20 4e6f 6e65 2920 2d3e  [int] = None) ->
-000093b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000093c0: 4561 6368 2063 616c 6c20 7265 7475 726e  Each call return
-000093d0: 7320 6120 7073 6575 646f 2d72 616e 646f  s a pseudo-rando
-000093e0: 6d20 3634 2d62 6974 2069 6e74 6567 6572  m 64-bit integer
-000093f0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00009400: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00009410: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-00009420: 656c 6563 7420 3122 290a 2020 2020 2020  elect 1").      
-00009430: 2020 3e3e 3e20 6466 203d 2064 662e 7365    >>> df = df.se
-00009440: 6c65 6374 2872 616e 646f 6d28 3132 3329  lect(random(123)
-00009450: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-00009460: 290a 2020 2020 2222 220a 2020 2020 7320  ).    """.    s 
-00009470: 3d20 7365 6564 2069 6620 7365 6564 2069  = seed if seed i
-00009480: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00009490: 7261 6e64 696e 7428 2d28 322a 2a36 3329  randint(-(2**63)
-000094a0: 2c20 322a 2a36 3320 2d20 3129 0a20 2020  , 2**63 - 1).   
-000094b0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000094c0: 2272 616e 646f 6d22 2928 4c69 7465 7261  "random")(Litera
-000094d0: 6c28 7329 290a 0a0a 6465 6620 756e 6966  l(s))...def unif
-000094e0: 6f72 6d28 0a20 2020 206d 696e 5f3a 2055  orm(.    min_: U
-000094f0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00009500: 652c 2069 6e74 2c20 666c 6f61 745d 2c0a  e, int, float],.
-00009510: 2020 2020 6d61 785f 3a20 556e 696f 6e5b      max_: Union[
-00009520: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-00009530: 742c 2066 6c6f 6174 5d2c 0a20 2020 2067  t, float],.    g
-00009540: 656e 3a20 556e 696f 6e5b 436f 6c75 6d6e  en: Union[Column
-00009550: 4f72 4e61 6d65 2c20 696e 742c 2066 6c6f  OrName, int, flo
-00009560: 6174 5d2c 0a29 202d 3e20 436f 6c75 6d6e  at],.) -> Column
-00009570: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00009580: 7475 726e 7320 6120 756e 6966 6f72 6d6c  turns a uniforml
-00009590: 7920 7261 6e64 6f6d 206e 756d 6265 722e  y random number.
-000095a0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-000095b0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-000095c0: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
-000095d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-000095e0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-000095f0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
-00009600: 2e2e 2020 2020 205b 5b31 5d5d 2c0a 2020  ..     [[1]],.  
-00009610: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-00009620: 6865 6d61 3d5b 2261 225d 2c0a 2020 2020  hema=["a"],.    
-00009630: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
-00009640: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00009650: 756e 6966 6f72 6d28 312c 2031 3030 2c20  uniform(1, 100, 
-00009660: 636f 6c28 2261 2229 292e 616c 6961 7328  col("a")).alias(
-00009670: 2255 4e49 464f 524d 2229 292e 636f 6c6c  "UNIFORM")).coll
-00009680: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00009690: 6f77 2855 4e49 464f 524d 3d36 3229 5d0a  ow(UNIFORM=62)].
-000096a0: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-000096b0: 2063 6f6e 7665 7274 5f6c 696d 6974 5f74   convert_limit_t
-000096c0: 6f5f 636f 6c28 6c69 6d69 7429 3a0a 2020  o_col(limit):.  
-000096d0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000096e0: 6e63 6528 6c69 6d69 742c 2069 6e74 293a  nce(limit, int):
-000096f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00009700: 7572 6e20 6c69 7428 6c69 6d69 7429 0a20  urn lit(limit). 
-00009710: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00009720: 7374 616e 6365 286c 696d 6974 2c20 666c  stance(limit, fl
-00009730: 6f61 7429 3a0a 2020 2020 2020 2020 2020  oat):.          
-00009740: 2020 7265 7475 726e 206c 6974 286c 696d    return lit(lim
-00009750: 6974 292e 6361 7374 2846 6c6f 6174 5479  it).cast(FloatTy
-00009760: 7065 2829 290a 2020 2020 2020 2020 7265  pe()).        re
-00009770: 7475 726e 205f 746f 5f63 6f6c 5f69 665f  turn _to_col_if_
-00009780: 7374 7228 6c69 6d69 742c 2022 756e 6966  str(limit, "unif
-00009790: 6f72 6d22 290a 0a20 2020 206d 696e 5f63  orm")..    min_c
-000097a0: 6f6c 203d 2063 6f6e 7665 7274 5f6c 696d  ol = convert_lim
-000097b0: 6974 5f74 6f5f 636f 6c28 6d69 6e5f 290a  it_to_col(min_).
-000097c0: 2020 2020 6d61 785f 636f 6c20 3d20 636f      max_col = co
-000097d0: 6e76 6572 745f 6c69 6d69 745f 746f 5f63  nvert_limit_to_c
-000097e0: 6f6c 286d 6178 5f29 0a20 2020 2067 656e  ol(max_).    gen
-000097f0: 5f63 6f6c 203d 2028 0a20 2020 2020 2020  _col = (.       
-00009800: 206c 6974 2867 656e 2920 6966 2069 7369   lit(gen) if isi
-00009810: 6e73 7461 6e63 6528 6765 6e2c 2028 696e  nstance(gen, (in
-00009820: 742c 2066 6c6f 6174 2929 2065 6c73 6520  t, float)) else 
-00009830: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2867  _to_col_if_str(g
-00009840: 656e 2c20 2275 6e69 666f 726d 2229 0a20  en, "uniform"). 
-00009850: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
-00009860: 6275 696c 7469 6e28 2275 6e69 666f 726d  builtin("uniform
-00009870: 2229 286d 696e 5f63 6f6c 2c20 6d61 785f  ")(min_col, max_
-00009880: 636f 6c2c 2067 656e 5f63 6f6c 290a 0a0a  col, gen_col)...
-00009890: 6465 6620 7365 7131 2873 6967 6e3a 2069  def seq1(sign: i
-000098a0: 6e74 203d 2030 2920 2d3e 2043 6f6c 756d  nt = 0) -> Colum
-000098b0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-000098c0: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-000098d0: 6d6f 6e6f 746f 6e69 6361 6c6c 7920 696e  monotonically in
-000098e0: 6372 6561 7369 6e67 2069 6e74 6567 6572  creasing integer
-000098f0: 732c 2077 6974 6820 7772 6170 2d61 726f  s, with wrap-aro
-00009900: 756e 640a 2020 2020 7768 6963 6820 6861  und.    which ha
-00009910: 7070 656e 7320 6166 7465 7220 6c61 7267  ppens after larg
-00009920: 6573 7420 7265 7072 6573 656e 7461 626c  est representabl
-00009930: 6520 696e 7465 6765 7220 6f66 2069 6e74  e integer of int
-00009940: 6567 6572 2077 6964 7468 2031 2062 7974  eger width 1 byt
-00009950: 652e 0a0a 2020 2020 4172 6773 3a0a 2020  e...    Args:.  
-00009960: 2020 2020 2020 7369 676e 3a20 5768 656e        sign: When
-00009970: 2030 2c20 7468 6520 7365 7175 656e 6365   0, the sequence
-00009980: 2063 6f6e 7469 6e75 6573 2061 7420 3020   continues at 0 
-00009990: 6166 7465 7220 7772 6170 2d61 726f 756e  after wrap-aroun
-000099a0: 642e 2057 6865 6e20 312c 2074 6865 2073  d. When 1, the s
-000099b0: 6571 7565 6e63 650a 2020 2020 2020 2020  equence.        
-000099c0: 2020 2020 636f 6e74 696e 7565 7320 6174      continues at
-000099d0: 2073 6d61 6c6c 6573 7420 7265 7072 6573   smallest repres
-000099e0: 656e 7461 626c 6520 3120 6279 7465 2069  entable 1 byte i
-000099f0: 6e74 6567 6572 2e20 4465 6661 756c 7473  nteger. Defaults
-00009a00: 2074 6f20 302e 0a0a 2020 2020 5365 6520   to 0...    See 
-00009a10: 416c 736f 3a0a 2020 2020 2020 2020 2d20  Also:.        - 
-00009a20: 3a6d 6574 683a 6053 6573 7369 6f6e 2e67  :meth:`Session.g
-00009a30: 656e 6572 6174 6f72 602c 2077 6869 6368  enerator`, which
-00009a40: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00009a50: 6765 6e65 7261 7465 2069 6e20 7461 6e64  generate in tand
-00009a60: 656d 2077 6974 6820 6073 6571 3160 2074  em with `seq1` t
-00009a70: 6f0a 2020 2020 2020 2020 2020 2020 6765  o.            ge
-00009a80: 6e65 7261 7465 2073 6571 7565 6e63 6573  nerate sequences
-00009a90: 2e0a 2020 2020 2222 220a 2020 2020 7265  ..    """.    re
-00009aa0: 7475 726e 2062 7569 6c74 696e 2822 7365  turn builtin("se
-00009ab0: 7131 2229 284c 6974 6572 616c 2873 6967  q1")(Literal(sig
-00009ac0: 6e29 290a 0a0a 6465 6620 7365 7132 2873  n))...def seq2(s
-00009ad0: 6967 6e3a 2069 6e74 203d 2030 2920 2d3e  ign: int = 0) ->
-00009ae0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00009af0: 5265 7475 726e 7320 6120 7365 7175 656e  Returns a sequen
-00009b00: 6365 206f 6620 6d6f 6e6f 746f 6e69 6361  ce of monotonica
-00009b10: 6c6c 7920 696e 6372 6561 7369 6e67 2069  lly increasing i
-00009b20: 6e74 6567 6572 732c 2077 6974 6820 7772  ntegers, with wr
-00009b30: 6170 2d61 726f 756e 640a 2020 2020 7768  ap-around.    wh
-00009b40: 6963 6820 6861 7070 656e 7320 6166 7465  ich happens afte
-00009b50: 7220 6c61 7267 6573 7420 7265 7072 6573  r largest repres
-00009b60: 656e 7461 626c 6520 696e 7465 6765 7220  entable integer 
-00009b70: 6f66 2069 6e74 6567 6572 2077 6964 7468  of integer width
-00009b80: 2032 2062 7974 652e 0a0a 2020 2020 4172   2 byte...    Ar
-00009b90: 6773 3a0a 2020 2020 2020 2020 7369 676e  gs:.        sign
-00009ba0: 3a20 5768 656e 2030 2c20 7468 6520 7365  : When 0, the se
-00009bb0: 7175 656e 6365 2063 6f6e 7469 6e75 6573  quence continues
-00009bc0: 2061 7420 3020 6166 7465 7220 7772 6170   at 0 after wrap
-00009bd0: 2d61 726f 756e 642e 2057 6865 6e20 312c  -around. When 1,
-00009be0: 2074 6865 2073 6571 7565 6e63 650a 2020   the sequence.  
-00009bf0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00009c00: 7565 7320 6174 2073 6d61 6c6c 6573 7420  ues at smallest 
-00009c10: 7265 7072 6573 656e 7461 626c 6520 3220  representable 2 
-00009c20: 6279 7465 2069 6e74 6567 6572 2e20 4465  byte integer. De
-00009c30: 6661 756c 7473 2074 6f20 302e 0a0a 2020  faults to 0...  
-00009c40: 2020 5365 6520 416c 736f 3a0a 2020 2020    See Also:.    
-00009c50: 2020 2020 2d20 3a6d 6574 683a 6053 6573      - :meth:`Ses
-00009c60: 7369 6f6e 2e67 656e 6572 6174 6f72 602c  sion.generator`,
-00009c70: 2077 6869 6368 2063 616e 2062 6520 7573   which can be us
-00009c80: 6564 2074 6f20 6765 6e65 7261 7465 2069  ed to generate i
-00009c90: 6e20 7461 6e64 656d 2077 6974 6820 6073  n tandem with `s
-00009ca0: 6571 3260 2074 6f0a 2020 2020 2020 2020  eq2` to.        
-00009cb0: 2020 2020 6765 6e65 7261 7465 2073 6571      generate seq
-00009cc0: 7565 6e63 6573 2e0a 2020 2020 2222 220a  uences..    """.
-00009cd0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00009ce0: 696e 2822 7365 7132 2229 284c 6974 6572  in("seq2")(Liter
-00009cf0: 616c 2873 6967 6e29 290a 0a0a 6465 6620  al(sign))...def 
-00009d00: 7365 7134 2873 6967 6e3a 2069 6e74 203d  seq4(sign: int =
-00009d10: 2030 2920 2d3e 2043 6f6c 756d 6e3a 0a20   0) -> Column:. 
-00009d20: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
-00009d30: 7365 7175 656e 6365 206f 6620 6d6f 6e6f  sequence of mono
-00009d40: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
-00009d50: 7369 6e67 2069 6e74 6567 6572 732c 2077  sing integers, w
-00009d60: 6974 6820 7772 6170 2d61 726f 756e 640a  ith wrap-around.
-00009d70: 2020 2020 7768 6963 6820 6861 7070 656e      which happen
-00009d80: 7320 6166 7465 7220 6c61 7267 6573 7420  s after largest 
-00009d90: 7265 7072 6573 656e 7461 626c 6520 696e  representable in
-00009da0: 7465 6765 7220 6f66 2069 6e74 6567 6572  teger of integer
-00009db0: 2077 6964 7468 2034 2062 7974 652e 0a0a   width 4 byte...
-00009dc0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00009dd0: 2020 7369 676e 3a20 5768 656e 2030 2c20    sign: When 0, 
-00009de0: 7468 6520 7365 7175 656e 6365 2063 6f6e  the sequence con
-00009df0: 7469 6e75 6573 2061 7420 3020 6166 7465  tinues at 0 afte
-00009e00: 7220 7772 6170 2d61 726f 756e 642e 2057  r wrap-around. W
-00009e10: 6865 6e20 312c 2074 6865 2073 6571 7565  hen 1, the seque
-00009e20: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
-00009e30: 636f 6e74 696e 7565 7320 6174 2073 6d61  continues at sma
-00009e40: 6c6c 6573 7420 7265 7072 6573 656e 7461  llest representa
-00009e50: 626c 6520 3420 6279 7465 2069 6e74 6567  ble 4 byte integ
-00009e60: 6572 2e20 4465 6661 756c 7473 2074 6f20  er. Defaults to 
-00009e70: 302e 0a0a 2020 2020 5365 6520 416c 736f  0...    See Also
-00009e80: 3a0a 2020 2020 2020 2020 2d20 3a6d 6574  :.        - :met
-00009e90: 683a 6053 6573 7369 6f6e 2e67 656e 6572  h:`Session.gener
-00009ea0: 6174 6f72 602c 2077 6869 6368 2063 616e  ator`, which can
-00009eb0: 2062 6520 7573 6564 2074 6f20 6765 6e65   be used to gene
-00009ec0: 7261 7465 2069 6e20 7461 6e64 656d 2077  rate in tandem w
-00009ed0: 6974 6820 6073 6571 3460 2074 6f0a 2020  ith `seq4` to.  
-00009ee0: 2020 2020 2020 2020 2020 6765 6e65 7261            genera
-00009ef0: 7465 2073 6571 7565 6e63 6573 2e0a 2020  te sequences..  
-00009f00: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00009f10: 2062 7569 6c74 696e 2822 7365 7134 2229   builtin("seq4")
-00009f20: 284c 6974 6572 616c 2873 6967 6e29 290a  (Literal(sign)).
-00009f30: 0a0a 6465 6620 7365 7138 2873 6967 6e3a  ..def seq8(sign:
-00009f40: 2069 6e74 203d 2030 2920 2d3e 2043 6f6c   int = 0) -> Col
-00009f50: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00009f60: 726e 7320 6120 7365 7175 656e 6365 206f  rns a sequence o
-00009f70: 6620 6d6f 6e6f 746f 6e69 6361 6c6c 7920  f monotonically 
-00009f80: 696e 6372 6561 7369 6e67 2069 6e74 6567  increasing integ
-00009f90: 6572 732c 2077 6974 6820 7772 6170 2d61  ers, with wrap-a
-00009fa0: 726f 756e 640a 2020 2020 7768 6963 6820  round.    which 
-00009fb0: 6861 7070 656e 7320 6166 7465 7220 6c61  happens after la
-00009fc0: 7267 6573 7420 7265 7072 6573 656e 7461  rgest representa
-00009fd0: 626c 6520 696e 7465 6765 7220 6f66 2069  ble integer of i
-00009fe0: 6e74 6567 6572 2077 6964 7468 2038 2062  nteger width 8 b
-00009ff0: 7974 652e 0a0a 2020 2020 4172 6773 3a0a  yte...    Args:.
-0000a000: 2020 2020 2020 2020 7369 676e 3a20 5768          sign: Wh
-0000a010: 656e 2030 2c20 7468 6520 7365 7175 656e  en 0, the sequen
-0000a020: 6365 2063 6f6e 7469 6e75 6573 2061 7420  ce continues at 
-0000a030: 3020 6166 7465 7220 7772 6170 2d61 726f  0 after wrap-aro
-0000a040: 756e 642e 2057 6865 6e20 312c 2074 6865  und. When 1, the
-0000a050: 2073 6571 7565 6e63 650a 2020 2020 2020   sequence.      
-0000a060: 2020 2020 2020 636f 6e74 696e 7565 7320        continues 
-0000a070: 6174 2073 6d61 6c6c 6573 7420 7265 7072  at smallest repr
-0000a080: 6573 656e 7461 626c 6520 3820 6279 7465  esentable 8 byte
-0000a090: 2069 6e74 6567 6572 2e20 4465 6661 756c   integer. Defaul
-0000a0a0: 7473 2074 6f20 302e 0a0a 2020 2020 5365  ts to 0...    Se
-0000a0b0: 6520 416c 736f 3a0a 2020 2020 2020 2020  e Also:.        
-0000a0c0: 2d20 3a6d 6574 683a 6053 6573 7369 6f6e  - :meth:`Session
-0000a0d0: 2e67 656e 6572 6174 6f72 602c 2077 6869  .generator`, whi
-0000a0e0: 6368 2063 616e 2062 6520 7573 6564 2074  ch can be used t
-0000a0f0: 6f20 6765 6e65 7261 7465 2069 6e20 7461  o generate in ta
-0000a100: 6e64 656d 2077 6974 6820 6073 6571 3860  ndem with `seq8`
-0000a110: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
-0000a120: 6765 6e65 7261 7465 2073 6571 7565 6e63  generate sequenc
-0000a130: 6573 2e0a 2020 2020 2222 220a 2020 2020  es..    """.    
-0000a140: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000a150: 7365 7138 2229 284c 6974 6572 616c 2873  seq8")(Literal(s
-0000a160: 6967 6e29 290a 0a0a 6465 6620 746f 5f64  ign))...def to_d
-0000a170: 6563 696d 616c 2865 3a20 436f 6c75 6d6e  ecimal(e: Column
-0000a180: 4f72 4e61 6d65 2c20 7072 6563 6973 696f  OrName, precisio
-0000a190: 6e3a 2069 6e74 2c20 7363 616c 653a 2069  n: int, scale: i
-0000a1a0: 6e74 2920 2d3e 2043 6f6c 756d 6e3a 0a20  nt) -> Column:. 
-0000a1b0: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
-0000a1c0: 6e20 696e 7075 7420 6578 7072 6573 7369  n input expressi
-0000a1d0: 6f6e 2074 6f20 6120 6465 6369 6d61 6c2e  on to a decimal.
-0000a1e0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0000a1f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0000a200: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0000a210: 6461 7461 6672 616d 6528 5b27 3132 272c  dataframe(['12',
-0000a220: 2027 3131 2e33 272c 2027 2d39 302e 3132   '11.3', '-90.12
-0000a230: 3334 3527 5d2c 2073 6368 656d 613d 5b27  345'], schema=['
-0000a240: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
-0000a250: 2064 662e 7365 6c65 6374 2874 6f5f 6465   df.select(to_de
-0000a260: 6369 6d61 6c28 636f 6c28 2761 2729 2c20  cimal(col('a'), 
-0000a270: 3338 2c20 3029 2e61 735f 2827 616e 7327  38, 0).as_('ans'
-0000a280: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0000a290: 2020 2020 205b 526f 7728 414e 533d 3132       [Row(ANS=12
-0000a2a0: 292c 2052 6f77 2841 4e53 3d31 3129 2c20  ), Row(ANS=11), 
-0000a2b0: 526f 7728 414e 533d 2d39 3029 5d0a 0a20  Row(ANS=-90)].. 
-0000a2c0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0000a2d0: 6c65 6374 2874 6f5f 6465 6369 6d61 6c28  lect(to_decimal(
-0000a2e0: 636f 6c28 2761 2729 2c20 3338 2c20 3229  col('a'), 38, 2)
-0000a2f0: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
-0000a300: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0000a310: 526f 7728 414e 533d 4465 6369 6d61 6c28  Row(ANS=Decimal(
-0000a320: 2731 322e 3030 2729 292c 2052 6f77 2841  '12.00')), Row(A
-0000a330: 4e53 3d44 6563 696d 616c 2827 3131 2e33  NS=Decimal('11.3
-0000a340: 3027 2929 2c20 526f 7728 414e 533d 4465  0')), Row(ANS=De
-0000a350: 6369 6d61 6c28 272d 3930 2e31 3227 2929  cimal('-90.12'))
-0000a360: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0000a370: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000a380: 2865 2c20 2274 6f5f 6465 6369 6d61 6c22  (e, "to_decimal"
-0000a390: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0000a3a0: 6c74 696e 2822 746f 5f64 6563 696d 616c  ltin("to_decimal
-0000a3b0: 2229 2863 2c20 7371 6c5f 6578 7072 2873  ")(c, sql_expr(s
-0000a3c0: 7472 2870 7265 6369 7369 6f6e 2929 2c20  tr(precision)), 
-0000a3d0: 7371 6c5f 6578 7072 2873 7472 2873 6361  sql_expr(str(sca
-0000a3e0: 6c65 2929 290a 0a0a 6465 6620 6469 7630  le)))...def div0
-0000a3f0: 280a 2020 2020 6469 7669 6465 6e64 3a20  (.    dividend: 
-0000a400: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-0000a410: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
-0000a420: 2064 6976 6973 6f72 3a20 556e 696f 6e5b   divisor: Union[
-0000a430: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-0000a440: 742c 2066 6c6f 6174 5d0a 2920 2d3e 2043  t, float].) -> C
-0000a450: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-0000a460: 2020 2050 6572 666f 726d 7320 6469 7669     Performs divi
-0000a470: 7369 6f6e 206c 696b 6520 7468 6520 6469  sion like the di
-0000a480: 7669 7369 6f6e 206f 7065 7261 746f 7220  vision operator 
-0000a490: 282f 292c 0a20 2020 2062 7574 2072 6574  (/),.    but ret
-0000a4a0: 7572 6e73 2030 2077 6865 6e20 7468 6520  urns 0 when the 
-0000a4b0: 6469 7669 736f 7220 6973 2030 2028 7261  divisor is 0 (ra
-0000a4c0: 7468 6572 2074 6861 6e20 7265 706f 7274  ther than report
-0000a4d0: 696e 6720 616e 2065 7272 6f72 292e 0a0a  ing an error)...
-0000a4e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0000a4f0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000a500: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0000a510: 6174 6166 7261 6d65 285b 315d 2c20 7363  ataframe([1], sc
-0000a520: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0000a530: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0000a540: 7428 6469 7630 2864 665b 2261 225d 2c20  t(div0(df["a"], 
-0000a550: 3129 2e61 6c69 6173 2822 6469 7669 6465  1).alias("divide
-0000a560: 645f 6279 5f6f 6e65 2229 2c20 6469 7630  d_by_one"), div0
-0000a570: 2864 665b 2261 225d 2c20 3029 2e61 6c69  (df["a"], 0).ali
-0000a580: 6173 2822 6469 7669 6465 645f 6279 5f7a  as("divided_by_z
-0000a590: 6572 6f22 2929 2e63 6f6c 6c65 6374 2829  ero")).collect()
-0000a5a0: 0a20 2020 2020 2020 205b 526f 7728 4449  .        [Row(DI
-0000a5b0: 5649 4445 445f 4259 5f4f 4e45 3d44 6563  VIDED_BY_ONE=Dec
-0000a5c0: 696d 616c 2827 312e 3030 3030 3030 2729  imal('1.000000')
-0000a5d0: 2c20 4449 5649 4445 445f 4259 5f5a 4552  , DIVIDED_BY_ZER
-0000a5e0: 4f3d 4465 6369 6d61 6c28 2730 2e30 3030  O=Decimal('0.000
-0000a5f0: 3030 3027 2929 5d0a 2020 2020 2222 220a  000'))].    """.
-0000a600: 2020 2020 6469 7669 6465 6e64 5f63 6f6c      dividend_col
-0000a610: 203d 2028 0a20 2020 2020 2020 206c 6974   = (.        lit
-0000a620: 2864 6976 6964 656e 6429 0a20 2020 2020  (dividend).     
-0000a630: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0000a640: 2864 6976 6964 656e 642c 2028 696e 742c  (dividend, (int,
-0000a650: 2066 6c6f 6174 2929 0a20 2020 2020 2020   float)).       
-0000a660: 2065 6c73 6520 5f74 6f5f 636f 6c5f 6966   else _to_col_if
-0000a670: 5f73 7472 2864 6976 6964 656e 642c 2022  _str(dividend, "
-0000a680: 6469 7630 2229 0a20 2020 2029 0a20 2020  div0").    ).   
-0000a690: 2064 6976 6973 6f72 5f63 6f6c 203d 2028   divisor_col = (
-0000a6a0: 0a20 2020 2020 2020 206c 6974 2864 6976  .        lit(div
-0000a6b0: 6973 6f72 290a 2020 2020 2020 2020 6966  isor).        if
-0000a6c0: 2069 7369 6e73 7461 6e63 6528 6469 7669   isinstance(divi
-0000a6d0: 736f 722c 2028 696e 742c 2066 6c6f 6174  sor, (int, float
-0000a6e0: 2929 0a20 2020 2020 2020 2065 6c73 6520  )).        else 
-0000a6f0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2864  _to_col_if_str(d
-0000a700: 6976 6973 6f72 2c20 2264 6976 3022 290a  ivisor, "div0").
-0000a710: 2020 2020 290a 2020 2020 7265 7475 726e      ).    return
-0000a720: 2062 7569 6c74 696e 2822 6469 7630 2229   builtin("div0")
-0000a730: 2864 6976 6964 656e 645f 636f 6c2c 2064  (dividend_col, d
-0000a740: 6976 6973 6f72 5f63 6f6c 290a 0a0a 6465  ivisor_col)...de
-0000a750: 6620 7371 7274 2865 3a20 436f 6c75 6d6e  f sqrt(e: Column
-0000a760: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000a770: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-0000a780: 7320 7468 6520 7371 7561 7265 2d72 6f6f  s the square-roo
-0000a790: 7420 6f66 2061 206e 6f6e 2d6e 6567 6174  t of a non-negat
-0000a7a0: 6976 6520 6e75 6d65 7269 6320 6578 7072  ive numeric expr
-0000a7b0: 6573 7369 6f6e 2e22 2222 0a20 2020 2063  ession.""".    c
-0000a7c0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000a7d0: 7228 652c 2022 7371 7274 2229 0a20 2020  r(e, "sqrt").   
-0000a7e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000a7f0: 2273 7172 7422 2928 6329 0a0a 0a64 6566  "sqrt")(c)...def
-0000a800: 2061 6273 2865 3a20 436f 6c75 6d6e 4f72   abs(e: ColumnOr
-0000a810: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0000a820: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0000a830: 7468 6520 6162 736f 6c75 7465 2076 616c  the absolute val
-0000a840: 7565 206f 6620 6120 6e75 6d65 7269 6320  ue of a numeric 
-0000a850: 6578 7072 6573 7369 6f6e 2e22 2222 0a20  expression.""". 
-0000a860: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000a870: 665f 7374 7228 652c 2022 6162 7322 290a  f_str(e, "abs").
-0000a880: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000a890: 696e 2822 6162 7322 2928 6329 0a0a 0a64  in("abs")(c)...d
-0000a8a0: 6566 2061 636f 7328 653a 2043 6f6c 756d  ef acos(e: Colum
-0000a8b0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0000a8c0: 6d6e 3a0a 2020 2020 2222 2243 6f6d 7075  mn:.    """Compu
-0000a8d0: 7465 7320 7468 6520 696e 7665 7273 6520  tes the inverse 
-0000a8e0: 636f 7369 6e65 2028 6172 6320 636f 7369  cosine (arc cosi
-0000a8f0: 6e65 2920 6f66 2069 7473 2069 6e70 7574  ne) of its input
-0000a900: 3b0a 2020 2020 7468 6520 7265 7375 6c74  ;.    the result
-0000a910: 2069 7320 6120 6e75 6d62 6572 2069 6e20   is a number in 
-0000a920: 7468 6520 696e 7465 7276 616c 205b 2d70  the interval [-p
-0000a930: 692c 2070 695d 2e22 2222 0a20 2020 2063  i, pi].""".    c
-0000a940: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000a950: 7228 652c 2022 6163 6f73 2229 0a20 2020  r(e, "acos").   
-0000a960: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000a970: 2261 636f 7322 2928 6329 0a0a 0a64 6566  "acos")(c)...def
-0000a980: 2061 7369 6e28 653a 2043 6f6c 756d 6e4f   asin(e: ColumnO
-0000a990: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000a9a0: 3a0a 2020 2020 2222 2243 6f6d 7075 7465  :.    """Compute
-0000a9b0: 7320 7468 6520 696e 7665 7273 6520 7369  s the inverse si
-0000a9c0: 6e65 2028 6172 6320 7369 6e65 2920 6f66  ne (arc sine) of
-0000a9d0: 2069 7473 2069 6e70 7574 3b0a 2020 2020   its input;.    
-0000a9e0: 7468 6520 7265 7375 6c74 2069 7320 6120  the result is a 
-0000a9f0: 6e75 6d62 6572 2069 6e20 7468 6520 696e  number in the in
-0000aa00: 7465 7276 616c 205b 2d70 692c 2070 695d  terval [-pi, pi]
-0000aa10: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0000aa20: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0000aa30: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0000aa40: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-0000aa50: 7420 4465 6369 6d61 6c54 7970 650a 2020  t DecimalType.  
-0000aa60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000aa70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000aa80: 7461 6672 616d 6528 5b5b 315d 5d2c 2073  taframe([[1]], s
-0000aa90: 6368 656d 613d 5b22 6465 6722 5d29 0a20  chema=["deg"]). 
-0000aaa0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0000aab0: 6c65 6374 2861 7369 6e28 636f 6c28 2264  lect(asin(col("d
-0000aac0: 6567 2229 292e 6361 7374 2844 6563 696d  eg")).cast(Decim
-0000aad0: 616c 5479 7065 2873 6361 6c65 3d33 2929  alType(scale=3))
-0000aae0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-0000aaf0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0000ab00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0000ab10: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-0000ab20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0000ab30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000ab40: 7c31 2e35 3731 2020 2020 207c 0a20 2020  |1.571     |.   
-0000ab50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000ab60: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0000ab70: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0000ab80: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0000ab90: 5f73 7472 2865 2c20 2261 7369 6e22 290a  _str(e, "asin").
-0000aba0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000abb0: 696e 2822 6173 696e 2229 2863 290a 0a0a  in("asin")(c)...
-0000abc0: 6465 6620 6174 616e 2865 3a20 436f 6c75  def atan(e: Colu
-0000abd0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000abe0: 756d 6e3a 0a20 2020 2022 2222 436f 6d70  umn:.    """Comp
-0000abf0: 7574 6573 2074 6865 2069 6e76 6572 7365  utes the inverse
-0000ac00: 2074 616e 6765 6e74 2028 6172 6320 7461   tangent (arc ta
-0000ac10: 6e67 656e 7429 206f 6620 6974 7320 696e  ngent) of its in
-0000ac20: 7075 743b 0a20 2020 2074 6865 2072 6573  put;.    the res
-0000ac30: 756c 7420 6973 2061 206e 756d 6265 7220  ult is a number 
-0000ac40: 696e 2074 6865 2069 6e74 6572 7661 6c20  in the interval 
-0000ac50: 5b2d 7069 2c20 7069 5d2e 0a0a 2020 2020  [-pi, pi]...    
-0000ac60: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-0000ac70: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0000ac80: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-0000ac90: 7065 7320 696d 706f 7274 2044 6563 696d  pes import Decim
-0000aca0: 616c 5479 7065 0a20 2020 2020 2020 203e  alType.        >
-0000acb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0000acc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0000acd0: 285b 5b31 5d5d 2c20 7363 6865 6d61 3d5b  ([[1]], schema=[
-0000ace0: 2264 6567 225d 290a 2020 2020 2020 2020  "deg"]).        
-0000acf0: 3e3e 3e20 6466 2e73 656c 6563 7428 6174  >>> df.select(at
-0000ad00: 616e 2863 6f6c 2822 6465 6722 2929 2e63  an(col("deg")).c
-0000ad10: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
-0000ad20: 7363 616c 653d 3329 292e 616c 6961 7328  scale=3)).alias(
-0000ad30: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0000ad40: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0000ad50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000ad60: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-0000ad70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000ad80: 0a20 2020 2020 2020 207c 302e 3738 3520  .        |0.785 
-0000ad90: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0000ada0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000adb0: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0000adc0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0000add0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0000ade0: 2022 6174 616e 2229 0a20 2020 2072 6574   "atan").    ret
-0000adf0: 7572 6e20 6275 696c 7469 6e28 2261 7461  urn builtin("ata
-0000ae00: 6e22 2928 6329 0a0a 0a64 6566 2061 7461  n")(c)...def ata
-0000ae10: 6e32 2879 3a20 436f 6c75 6d6e 4f72 4e61  n2(y: ColumnOrNa
-0000ae20: 6d65 2c20 783a 2043 6f6c 756d 6e4f 724e  me, x: ColumnOrN
-0000ae30: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0000ae40: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
-0000ae50: 7468 6520 696e 7665 7273 6520 7461 6e67  the inverse tang
-0000ae60: 656e 7420 2861 7263 2074 616e 6765 6e74  ent (arc tangent
-0000ae70: 2920 6f66 2069 7473 2069 6e70 7574 3b0a  ) of its input;.
-0000ae80: 2020 2020 7468 6520 7265 7375 6c74 2069      the result i
-0000ae90: 7320 6120 6e75 6d62 6572 2069 6e20 7468  s a number in th
-0000aea0: 6520 696e 7465 7276 616c 205b 2d70 692c  e interval [-pi,
-0000aeb0: 2070 695d 2e0a 0a20 2020 2045 7861 6d70   pi]...    Examp
-0000aec0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-0000aed0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0000aee0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-0000aef0: 6d70 6f72 7420 4465 6369 6d61 6c54 7970  mport DecimalTyp
-0000af00: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0000af10: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000af20: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
-0000af30: 2032 5d5d 2c20 7363 6865 6d61 3d5b 2278   2]], schema=["x
-0000af40: 222c 2022 7922 5d29 0a20 2020 2020 2020  ", "y"]).       
-0000af50: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
-0000af60: 7461 6e32 2864 662e 782c 2064 662e 7929  tan2(df.x, df.y)
-0000af70: 2e63 6173 7428 4465 6369 6d61 6c54 7970  .cast(DecimalTyp
-0000af80: 6528 7363 616c 653d 3329 292e 616c 6961  e(scale=3)).alia
-0000af90: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-0000afa0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0000afb0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000afc0: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-0000afd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000afe0: 2d2d 0a20 2020 2020 2020 207c 302e 3436  --.        |0.46
-0000aff0: 3420 2020 2020 7c0a 2020 2020 2020 2020  4     |.        
-0000b000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000b010: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0000b020: 0a20 2020 2022 2222 0a20 2020 2079 5f63  .    """.    y_c
-0000b030: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
-0000b040: 7374 7228 792c 2022 6174 616e 3222 290a  str(y, "atan2").
-0000b050: 2020 2020 785f 636f 6c20 3d20 5f74 6f5f      x_col = _to_
-0000b060: 636f 6c5f 6966 5f73 7472 2878 2c20 2261  col_if_str(x, "a
-0000b070: 7461 6e32 2229 0a20 2020 2072 6574 7572  tan2").    retur
-0000b080: 6e20 6275 696c 7469 6e28 2261 7461 6e32  n builtin("atan2
-0000b090: 2229 2879 5f63 6f6c 2c20 785f 636f 6c29  ")(y_col, x_col)
-0000b0a0: 0a0a 0a64 6566 2063 6569 6c28 653a 2043  ...def ceil(e: C
-0000b0b0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0000b0c0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-0000b0d0: 6574 7572 6e73 2076 616c 7565 7320 6672  eturns values fr
-0000b0e0: 6f6d 2074 6865 2073 7065 6369 6669 6564  om the specified
-0000b0f0: 2063 6f6c 756d 6e20 726f 756e 6465 6420   column rounded 
-0000b100: 746f 2074 6865 206e 6561 7265 7374 2065  to the nearest e
-0000b110: 7175 616c 206f 7220 6c61 7267 6572 0a20  qual or larger. 
-0000b120: 2020 2069 6e74 6567 6572 2e0a 0a20 2020     integer...   
-0000b130: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0000b140: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000b150: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0000b160: 6672 616d 6528 5b31 3335 2e31 3335 2c20  frame([135.135, 
-0000b170: 2d39 3735 2e39 3735 5d2c 2073 6368 656d  -975.975], schem
-0000b180: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-0000b190: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-0000b1a0: 6569 6c28 6466 5b22 6122 5d29 2e61 6c69  eil(df["a"]).ali
-0000b1b0: 6173 2822 6365 696c 2229 292e 636f 6c6c  as("ceil")).coll
-0000b1c0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0000b1d0: 6f77 2843 4549 4c3d 3133 362e 3029 2c20  ow(CEIL=136.0), 
-0000b1e0: 526f 7728 4345 494c 3d2d 3937 352e 3029  Row(CEIL=-975.0)
-0000b1f0: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0000b200: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000b210: 2865 2c20 2263 6569 6c22 290a 2020 2020  (e, "ceil").    
-0000b220: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000b230: 6365 696c 2229 2863 290a 0a0a 6465 6620  ceil")(c)...def 
-0000b240: 636f 7328 653a 2043 6f6c 756d 6e4f 724e  cos(e: ColumnOrN
-0000b250: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0000b260: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
-0000b270: 7468 6520 636f 7369 6e65 206f 6620 6974  the cosine of it
-0000b280: 7320 6172 6775 6d65 6e74 3b20 7468 6520  s argument; the 
-0000b290: 6172 6775 6d65 6e74 2073 686f 756c 6420  argument should 
-0000b2a0: 6265 2065 7870 7265 7373 6564 2069 6e20  be expressed in 
-0000b2b0: 7261 6469 616e 732e 0a0a 2020 2020 4578  radians...    Ex
-0000b2c0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-0000b2d0: 3e3e 2066 726f 6d20 6d61 7468 2069 6d70  >> from math imp
-0000b2e0: 6f72 7420 7069 0a20 2020 2020 2020 203e  ort pi.        >
-0000b2f0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0000b300: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0000b310: 285b 5b70 695d 5d2c 2073 6368 656d 613d  ([[pi]], schema=
-0000b320: 5b22 6465 6722 5d29 0a20 2020 2020 2020  ["deg"]).       
-0000b330: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-0000b340: 6f73 2863 6f6c 2822 6465 6722 2929 2e61  os(col("deg")).a
-0000b350: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-0000b360: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-0000b370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000b380: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-0000b390: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000b3a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c2d  -----.        |-
-0000b3b0: 312e 3020 2020 2020 207c 0a20 2020 2020  1.0      |.     
-0000b3c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0000b3d0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0000b3e0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-0000b3f0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0000b400: 7472 2865 2c20 2263 6f73 2229 0a20 2020  tr(e, "cos").   
-0000b410: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000b420: 2263 6f73 2229 2863 290a 0a0a 6465 6620  "cos")(c)...def 
-0000b430: 636f 7368 2865 3a20 436f 6c75 6d6e 4f72  cosh(e: ColumnOr
-0000b440: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0000b450: 0a20 2020 2022 2222 436f 6d70 7574 6573  .    """Computes
-0000b460: 2074 6865 2068 7970 6572 626f 6c69 6320   the hyperbolic 
-0000b470: 636f 7369 6e65 206f 6620 6974 7320 6172  cosine of its ar
-0000b480: 6775 6d65 6e74 2e0a 0a20 2020 2045 7861  gument...    Exa
-0000b490: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-0000b4a0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0000b4b0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-0000b4c0: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
-0000b4d0: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-0000b4e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000b4f0: 7465 5f64 6174 6166 7261 6d65 285b 5b30  te_dataframe([[0
-0000b500: 5d5d 2c20 7363 6865 6d61 3d5b 2264 6567  ]], schema=["deg
-0000b510: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-0000b520: 6466 2e73 656c 6563 7428 636f 7368 2863  df.select(cosh(c
-0000b530: 6f6c 2822 6465 6722 2929 2e61 6c69 6173  ol("deg")).alias
-0000b540: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-0000b550: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0000b560: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000b570: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-0000b580: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000b590: 2d0a 2020 2020 2020 2020 7c31 2e30 2020  -.        |1.0  
-0000b5a0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0000b5b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000b5c0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0000b5d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000b5e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0000b5f0: 2c20 2263 6f73 6822 290a 2020 2020 7265  , "cosh").    re
-0000b600: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
-0000b610: 7368 2229 2863 290a 0a0a 6465 6620 6578  sh")(c)...def ex
-0000b620: 7028 653a 2043 6f6c 756d 6e4f 724e 616d  p(e: ColumnOrNam
-0000b630: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0000b640: 2020 2222 220a 2020 2020 436f 6d70 7574    """.    Comput
-0000b650: 6573 2045 756c 6572 2773 206e 756d 6265  es Euler's numbe
-0000b660: 7220 6520 7261 6973 6564 2074 6f20 6120  r e raised to a 
-0000b670: 666c 6f61 7469 6e67 2d70 6f69 6e74 2076  floating-point v
-0000b680: 616c 7565 2e0a 0a20 2020 2045 7861 6d70  alue...    Examp
-0000b690: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0000b6a0: 3e20 696d 706f 7274 206d 6174 680a 2020  > import math.  
-0000b6b0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0000b6c0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0000b6d0: 6b2e 7479 7065 7320 696d 706f 7274 2049  k.types import I
-0000b6e0: 6e74 6567 6572 5479 7065 0a20 2020 2020  ntegerType.     
-0000b6f0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0000b700: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0000b710: 7261 6d65 285b 302e 302c 206d 6174 682e  rame([0.0, math.
-0000b720: 6c6f 6728 3130 295d 2c20 7363 6865 6d61  log(10)], schema
-0000b730: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-0000b740: 3e3e 3e20 6466 2e73 656c 6563 7428 6578  >>> df.select(ex
-0000b750: 7028 6466 5b22 6122 5d29 2e63 6173 7428  p(df["a"]).cast(
-0000b760: 496e 7465 6765 7254 7970 6528 2929 2e61  IntegerType()).a
-0000b770: 6c69 6173 2822 6578 7022 2929 2e63 6f6c  lias("exp")).col
-0000b780: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0000b790: 526f 7728 4558 503d 3129 2c20 526f 7728  Row(EXP=1), Row(
-0000b7a0: 4558 503d 3130 295d 0a20 2020 2022 2222  EXP=10)].    """
-0000b7b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0000b7c0: 5f69 665f 7374 7228 652c 2022 6578 7022  _if_str(e, "exp"
-0000b7d0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0000b7e0: 6c74 696e 2822 6578 7022 2928 6329 0a0a  ltin("exp")(c)..
-0000b7f0: 0a64 6566 2066 6163 746f 7269 616c 2865  .def factorial(e
-0000b800: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0000b810: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000b820: 2222 0a20 2020 2043 6f6d 7075 7465 7320  "".    Computes 
-0000b830: 7468 6520 6661 6374 6f72 6961 6c20 6f66  the factorial of
-0000b840: 2069 7473 2069 6e70 7574 2e20 5468 6520   its input. The 
-0000b850: 696e 7075 7420 6172 6775 6d65 6e74 206d  input argument m
-0000b860: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
-0000b870: 720a 2020 2020 6578 7072 6573 7369 6f6e  r.    expression
-0000b880: 2069 6e20 7468 6520 7261 6e67 6520 6f66   in the range of
-0000b890: 2030 2074 6f20 3333 2e0a 0a20 2020 2045   0 to 33...    E
-0000b8a0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0000b8b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000b8c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000b8d0: 616d 6528 5b30 2c20 312c 2035 2c20 3130  ame([0, 1, 5, 10
-0000b8e0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0000b8f0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0000b900: 7365 6c65 6374 2866 6163 746f 7269 616c  select(factorial
-0000b910: 2864 665b 2261 225d 292e 616c 6961 7328  (df["a"]).alias(
-0000b920: 2266 6163 746f 7269 616c 2229 292e 636f  "factorial")).co
-0000b930: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0000b940: 5b52 6f77 2846 4143 544f 5249 414c 3d31  [Row(FACTORIAL=1
-0000b950: 292c 2052 6f77 2846 4143 544f 5249 414c  ), Row(FACTORIAL
-0000b960: 3d31 292c 2052 6f77 2846 4143 544f 5249  =1), Row(FACTORI
-0000b970: 414c 3d31 3230 292c 2052 6f77 2846 4143  AL=120), Row(FAC
-0000b980: 544f 5249 414c 3d33 3632 3838 3030 295d  TORIAL=3628800)]
-0000b990: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0000b9a0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0000b9b0: 652c 2022 6661 6374 6f72 6961 6c22 290a  e, "factorial").
-0000b9c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000b9d0: 696e 2822 6661 6374 6f72 6961 6c22 2928  in("factorial")(
-0000b9e0: 6329 0a0a 0a64 6566 2066 6c6f 6f72 2865  c)...def floor(e
-0000b9f0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0000ba00: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000ba10: 2222 0a20 2020 2052 6574 7572 6e73 2076  "".    Returns v
-0000ba20: 616c 7565 7320 6672 6f6d 2074 6865 2073  alues from the s
-0000ba30: 7065 6369 6669 6564 2063 6f6c 756d 6e20  pecified column 
-0000ba40: 726f 756e 6465 6420 746f 2074 6865 206e  rounded to the n
-0000ba50: 6561 7265 7374 2065 7175 616c 206f 720a  earest equal or.
-0000ba60: 2020 2020 736d 616c 6c65 7220 696e 7465      smaller inte
-0000ba70: 6765 722e 0a0a 2020 2020 4578 616d 706c  ger...    Exampl
-0000ba80: 6573 3a3a 0a0a 2020 2020 2020 2020 3e3e  es::..        >>
-0000ba90: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0000baa0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0000bab0: 5b31 3335 2e31 3335 2c20 2d39 3735 2e39  [135.135, -975.9
-0000bac0: 3735 5d2c 2073 6368 656d 613d 5b22 6122  75], schema=["a"
-0000bad0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0000bae0: 662e 7365 6c65 6374 2866 6c6f 6f72 2864  f.select(floor(d
-0000baf0: 665b 2261 225d 292e 616c 6961 7328 2266  f["a"]).alias("f
-0000bb00: 6c6f 6f72 2229 292e 636f 6c6c 6563 7428  loor")).collect(
-0000bb10: 290a 2020 2020 2020 2020 5b52 6f77 2846  ).        [Row(F
-0000bb20: 4c4f 4f52 3d31 3335 2e30 292c 2052 6f77  LOOR=135.0), Row
-0000bb30: 2846 4c4f 4f52 3d2d 3937 362e 3029 5d0a  (FLOOR=-976.0)].
-0000bb40: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000bb50: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0000bb60: 2c20 2266 6c6f 6f72 2229 0a20 2020 2072  , "floor").    r
-0000bb70: 6574 7572 6e20 6275 696c 7469 6e28 2266  eturn builtin("f
-0000bb80: 6c6f 6f72 2229 2863 290a 0a0a 6465 6620  loor")(c)...def 
-0000bb90: 7369 6e28 653a 2043 6f6c 756d 6e4f 724e  sin(e: ColumnOrN
-0000bba0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0000bbb0: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
-0000bbc0: 7468 6520 7369 6e65 206f 6620 6974 7320  the sine of its 
-0000bbd0: 6172 6775 6d65 6e74 3b20 7468 6520 6172  argument; the ar
-0000bbe0: 6775 6d65 6e74 2073 686f 756c 6420 6265  gument should be
-0000bbf0: 2065 7870 7265 7373 6564 2069 6e20 7261   expressed in ra
-0000bc00: 6469 616e 732e 2222 220a 2020 2020 6320  dians.""".    c 
-0000bc10: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000bc20: 2865 2c20 2273 696e 2229 0a20 2020 2072  (e, "sin").    r
-0000bc30: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
-0000bc40: 696e 2229 2863 290a 0a0a 6465 6620 7369  in")(c)...def si
-0000bc50: 6e68 2865 3a20 436f 6c75 6d6e 4f72 4e61  nh(e: ColumnOrNa
-0000bc60: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000bc70: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
-0000bc80: 6865 2068 7970 6572 626f 6c69 6320 7369  he hyperbolic si
-0000bc90: 6e65 206f 6620 6974 7320 6172 6775 6d65  ne of its argume
-0000bca0: 6e74 2e22 2222 0a20 2020 2063 203d 205f  nt.""".    c = _
-0000bcb0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0000bcc0: 2022 7369 6e68 2229 0a20 2020 2072 6574   "sinh").    ret
-0000bcd0: 7572 6e20 6275 696c 7469 6e28 2273 696e  urn builtin("sin
-0000bce0: 6822 2928 6329 0a0a 0a64 6566 2074 616e  h")(c)...def tan
-0000bcf0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0000bd00: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0000bd10: 2022 2222 436f 6d70 7574 6573 2074 6865   """Computes the
-0000bd20: 2074 616e 6765 6e74 206f 6620 6974 7320   tangent of its 
-0000bd30: 6172 6775 6d65 6e74 3b20 7468 6520 6172  argument; the ar
-0000bd40: 6775 6d65 6e74 2073 686f 756c 6420 6265  gument should be
-0000bd50: 2065 7870 7265 7373 6564 2069 6e20 7261   expressed in ra
-0000bd60: 6469 616e 732e 2222 220a 2020 2020 6320  dians.""".    c 
-0000bd70: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000bd80: 2865 2c20 2274 616e 2229 0a20 2020 2072  (e, "tan").    r
-0000bd90: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
-0000bda0: 616e 2229 2863 290a 0a0a 6465 6620 7461  an")(c)...def ta
-0000bdb0: 6e68 2865 3a20 436f 6c75 6d6e 4f72 4e61  nh(e: ColumnOrNa
-0000bdc0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000bdd0: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
-0000bde0: 6865 2068 7970 6572 626f 6c69 6320 7461  he hyperbolic ta
-0000bdf0: 6e67 656e 7420 6f66 2069 7473 2061 7267  ngent of its arg
-0000be00: 756d 656e 742e 2222 220a 2020 2020 6320  ument.""".    c 
-0000be10: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000be20: 2865 2c20 2274 616e 6822 290a 2020 2020  (e, "tanh").    
-0000be30: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000be40: 7461 6e68 2229 2863 290a 0a0a 6465 6620  tanh")(c)...def 
-0000be50: 6465 6772 6565 7328 653a 2043 6f6c 756d  degrees(e: Colum
-0000be60: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0000be70: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0000be80: 436f 6e76 6572 7473 2072 6164 6961 6e73  Converts radians
-0000be90: 2074 6f20 6465 6772 6565 732e 0a0a 2020   to degrees...  
-0000bea0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0000beb0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0000bec0: 6d61 7468 0a20 2020 2020 2020 203e 3e3e  math.        >>>
-0000bed0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0000bee0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-0000bef0: 6d70 6f72 7420 5374 7275 6374 5479 7065  mport StructType
-0000bf00: 2c20 5374 7275 6374 4669 656c 642c 2044  , StructField, D
-0000bf10: 6f75 626c 6554 7970 652c 2049 6e74 6567  oubleType, Integ
-0000bf20: 6572 5479 7065 0a20 2020 2020 2020 203e  erType.        >
-0000bf30: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0000bf40: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0000bf50: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-0000bf60: 2020 5b6d 6174 682e 7069 202f 2033 2c20    [math.pi / 3, 
-0000bf70: 6d61 7468 2e70 692c 2033 202a 206d 6174  math.pi, 3 * mat
-0000bf80: 682e 7069 5d2c 0a20 2020 2020 2020 202e  h.pi],.        .
-0000bf90: 2e2e 2020 2020 2073 6368 656d 613d 5374  ..     schema=St
-0000bfa0: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
-0000bfb0: 4669 656c 6428 2261 222c 2044 6f75 626c  Field("a", Doubl
-0000bfc0: 6554 7970 6528 2929 5d29 2c0a 2020 2020  eType())]),.    
-0000bfd0: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
-0000bfe0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000bff0: 6465 6772 6565 7328 636f 6c28 2261 2229  degrees(col("a")
-0000c000: 292e 6361 7374 2849 6e74 6567 6572 5479  ).cast(IntegerTy
-0000c010: 7065 2829 292e 616c 6961 7328 2244 4547  pe()).alias("DEG
-0000c020: 5245 4553 2229 292e 636f 6c6c 6563 7428  REES")).collect(
-0000c030: 290a 2020 2020 2020 2020 5b52 6f77 2844  ).        [Row(D
-0000c040: 4547 5245 4553 3d36 3029 2c20 526f 7728  EGREES=60), Row(
-0000c050: 4445 4752 4545 533d 3138 3029 2c20 526f  DEGREES=180), Ro
-0000c060: 7728 4445 4752 4545 533d 3534 3029 5d0a  w(DEGREES=540)].
-0000c070: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000c080: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0000c090: 2c20 2264 6567 7265 6573 2229 0a20 2020  , "degrees").   
-0000c0a0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000c0b0: 2264 6567 7265 6573 2229 2863 290a 0a0a  "degrees")(c)...
-0000c0c0: 6465 6620 7261 6469 616e 7328 653a 2043  def radians(e: C
-0000c0d0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0000c0e0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-0000c0f0: 6f6e 7665 7274 7320 6465 6772 6565 7320  onverts degrees 
-0000c100: 746f 2072 6164 6961 6e73 2e0a 0a20 2020  to radians...   
-0000c110: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
-0000c120: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000c130: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000c140: 6166 7261 6d65 285b 5b31 2e31 3131 5d2c  aframe([[1.111],
-0000c150: 205b 322e 3232 325d 2c20 5b33 2e33 3333   [2.222], [3.333
-0000c160: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
-0000c170: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0000c180: 2e73 656c 6563 7428 7261 6469 616e 7328  .select(radians(
-0000c190: 636f 6c28 2261 2229 292e 6361 7374 2822  col("a")).cast("
-0000c1a0: 6e75 6d62 6572 2833 382c 2035 2922 292e  number(38, 5)").
-0000c1b0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0000c1c0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0000c1d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000c1e0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0000c1f0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000c200: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000c210: 302e 3031 3933 3920 2020 7c0a 2020 2020  0.01939   |.    
-0000c220: 2020 2020 7c30 2e30 3338 3738 2020 207c      |0.03878   |
-0000c230: 0a20 2020 2020 2020 207c 302e 3035 3831  .        |0.0581
-0000c240: 3720 2020 7c0a 2020 2020 2020 2020 2d2d  7   |.        --
-0000c250: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000c260: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0000c270: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0000c280: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0000c290: 2022 7261 6469 616e 7322 290a 2020 2020   "radians").    
-0000c2a0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000c2b0: 7261 6469 616e 7322 2928 6329 0a0a 0a64  radians")(c)...d
-0000c2c0: 6566 206d 6435 2865 3a20 436f 6c75 6d6e  ef md5(e: Column
-0000c2d0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000c2e0: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-0000c2f0: 6574 7572 6e73 2061 2033 322d 6368 6172  eturns a 32-char
-0000c300: 6163 7465 7220 6865 782d 656e 636f 6465  acter hex-encode
-0000c310: 6420 7374 7269 6e67 2063 6f6e 7461 696e  d string contain
-0000c320: 696e 6720 7468 6520 3132 382d 6269 7420  ing the 128-bit 
-0000c330: 4d44 3520 6d65 7373 6167 6520 6469 6765  MD5 message dige
-0000c340: 7374 2e0a 0a20 2020 2020 4578 616d 706c  st...     Exampl
-0000c350: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-0000c360: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0000c370: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-0000c380: 2261 222c 2022 6222 5d2c 2073 6368 656d  "a", "b"], schem
-0000c390: 613d 5b22 636f 6c22 5d29 2e73 656c 6563  a=["col"]).selec
-0000c3a0: 7428 6d64 3528 2263 6f6c 2229 290a 2020  t(md5("col")).  
-0000c3b0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
-0000c3c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0000c3d0: 526f 7728 4d44 3528 2243 4f4c 2229 3d27  Row(MD5("COL")='
-0000c3e0: 3063 6331 3735 6239 6330 6631 6236 6138  0cc175b9c0f1b6a8
-0000c3f0: 3331 6333 3939 6532 3639 3737 3236 3631  31c399e269772661
-0000c400: 2729 2c20 526f 7728 4d44 3528 2243 4f4c  '), Row(MD5("COL
-0000c410: 2229 3d27 3932 6562 3566 6665 6536 6165  ")='92eb5ffee6ae
-0000c420: 3266 6563 3361 6437 3163 3737 3735 3331  2fec3ad71c777531
-0000c430: 3537 3866 2729 5d0a 2020 2020 2222 220a  578f')].    """.
-0000c440: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0000c450: 6966 5f73 7472 2865 2c20 226d 6435 2229  if_str(e, "md5")
-0000c460: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000c470: 7469 6e28 226d 6435 2229 2863 290a 0a0a  tin("md5")(c)...
-0000c480: 6465 6620 7368 6131 2865 3a20 436f 6c75  def sha1(e: Colu
-0000c490: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000c4a0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-0000c4b0: 726e 7320 6120 3430 2d63 6861 7261 6374  rns a 40-charact
-0000c4c0: 6572 2068 6578 2d65 6e63 6f64 6564 2073  er hex-encoded s
-0000c4d0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
-0000c4e0: 2074 6865 2031 3630 2d62 6974 2053 4841   the 160-bit SHA
-0000c4f0: 2d31 206d 6573 7361 6765 2064 6967 6573  -1 message diges
-0000c500: 742e 2222 220a 2020 2020 6320 3d20 5f74  t.""".    c = _t
-0000c510: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000c520: 2273 6861 3122 290a 2020 2020 7265 7475  "sha1").    retu
-0000c530: 726e 2062 7569 6c74 696e 2822 7368 6131  rn builtin("sha1
-0000c540: 2229 2863 290a 0a0a 6465 6620 7368 6132  ")(c)...def sha2
-0000c550: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0000c560: 2c20 6e75 6d5f 6269 7473 3a20 696e 7429  , num_bits: int)
-0000c570: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0000c580: 2222 2252 6574 7572 6e73 2061 2068 6578  """Returns a hex
-0000c590: 2d65 6e63 6f64 6564 2073 7472 696e 6720  -encoded string 
-0000c5a0: 636f 6e74 6169 6e69 6e67 2074 6865 204e  containing the N
-0000c5b0: 2d62 6974 2053 4841 2d32 206d 6573 7361  -bit SHA-2 messa
-0000c5c0: 6765 2064 6967 6573 742c 0a20 2020 2077  ge digest,.    w
-0000c5d0: 6865 7265 204e 2069 7320 7468 6520 7370  here N is the sp
-0000c5e0: 6563 6966 6965 6420 6f75 7470 7574 2064  ecified output d
-0000c5f0: 6967 6573 7420 7369 7a65 2e22 2222 0a20  igest size.""". 
-0000c600: 2020 2070 6572 6d69 7474 6564 5f76 616c     permitted_val
-0000c610: 7565 7320 3d20 5b30 2c20 3232 342c 2032  ues = [0, 224, 2
-0000c620: 3536 2c20 3338 342c 2035 3132 5d0a 2020  56, 384, 512].  
-0000c630: 2020 6966 206e 756d 5f62 6974 7320 6e6f    if num_bits no
-0000c640: 7420 696e 2070 6572 6d69 7474 6564 5f76  t in permitted_v
-0000c650: 616c 7565 733a 0a20 2020 2020 2020 2072  alues:.        r
-0000c660: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000c670: 0a20 2020 2020 2020 2020 2020 2066 226e  .            f"n
-0000c680: 756d 5f62 6974 7320 7b6e 756d 5f62 6974  um_bits {num_bit
-0000c690: 737d 2069 7320 6e6f 7420 696e 2074 6865  s} is not in the
-0000c6a0: 2070 6572 6d69 7474 6564 2076 616c 7565   permitted value
-0000c6b0: 7320 7b70 6572 6d69 7474 6564 5f76 616c  s {permitted_val
-0000c6c0: 7565 737d 220a 2020 2020 2020 2020 290a  ues}".        ).
-0000c6d0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0000c6e0: 6966 5f73 7472 2865 2c20 2273 6861 3222  if_str(e, "sha2"
-0000c6f0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0000c700: 6c74 696e 2822 7368 6132 2229 2863 2c20  ltin("sha2")(c, 
-0000c710: 6e75 6d5f 6269 7473 290a 0a0a 6465 6620  num_bits)...def 
-0000c720: 6861 7368 282a 636f 6c73 3a20 436f 6c75  hash(*cols: Colu
-0000c730: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000c740: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0000c750: 2052 6574 7572 6e73 2061 2073 6967 6e65   Returns a signe
-0000c760: 6420 3634 2d62 6974 2068 6173 6820 7661  d 64-bit hash va
-0000c770: 6c75 652e 204e 6f74 6520 7468 6174 2048  lue. Note that H
-0000c780: 4153 4820 6e65 7665 7220 7265 7475 726e  ASH never return
-0000c790: 7320 4e55 4c4c 2c20 6576 656e 2066 6f72  s NULL, even for
-0000c7a0: 204e 554c 4c20 696e 7075 7473 2e0a 0a20   NULL inputs... 
-0000c7b0: 2020 2045 7861 6d70 6c65 733a 3a0a 0a20     Examples::.. 
-0000c7c0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-0000c7d0: 7420 6465 6369 6d61 6c0a 2020 2020 2020  t decimal.      
-0000c7e0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000c7f0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000c800: 616d 6528 5b5b 3130 2c20 2231 3022 2c20  ame([[10, "10", 
-0000c810: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
-0000c820: 3130 292c 2031 302e 305d 5d2c 2073 6368  10), 10.0]], sch
-0000c830: 656d 613d 5b22 6122 2c20 2262 222c 2022  ema=["a", "b", "
-0000c840: 6322 2c20 2264 225d 290a 2020 2020 2020  c", "d"]).      
-0000c850: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000c860: 6861 7368 2822 6122 292e 616c 6961 7328  hash("a").alias(
-0000c870: 2268 6173 685f 6122 292c 2068 6173 6828  "hash_a"), hash(
-0000c880: 2262 2229 2e61 6c69 6173 2822 6861 7368  "b").alias("hash
-0000c890: 5f62 2229 2c20 6861 7368 2822 6322 292e  _b"), hash("c").
-0000c8a0: 616c 6961 7328 2268 6173 685f 6322 292c  alias("hash_c"),
-0000c8b0: 2068 6173 6828 2264 2229 2e61 6c69 6173   hash("d").alias
-0000c8c0: 2822 6861 7368 5f64 2229 292e 636f 6c6c  ("hash_d")).coll
-0000c8d0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0000c8e0: 6f77 2848 4153 485f 413d 3135 3939 3632  ow(HASH_A=159962
-0000c8f0: 3737 3036 3832 3239 3633 3036 382c 2048  7706822963068, H
-0000c900: 4153 485f 423d 3336 3232 3439 3439 3830  ASH_B=3622494980
-0000c910: 3434 3031 3038 3938 342c 2048 4153 485f  440108984, HASH_
-0000c920: 433d 3135 3939 3632 3737 3036 3832 3239  C=15996277068229
-0000c930: 3633 3036 382c 2048 4153 485f 443d 3135  63068, HASH_D=15
-0000c940: 3939 3632 3737 3036 3832 3239 3633 3036  9962770682296306
-0000c950: 3829 5d0a 2020 2020 2020 2020 3e3e 3e20  8)].        >>> 
-0000c960: 6466 2e73 656c 6563 7428 6861 7368 286c  df.select(hash(l
-0000c970: 6974 284e 6f6e 6529 292e 616c 6961 7328  it(None)).alias(
-0000c980: 226f 6e65 2229 2c20 6861 7368 286c 6974  "one"), hash(lit
-0000c990: 284e 6f6e 6529 2c20 6c69 7428 4e6f 6e65  (None), lit(None
-0000c9a0: 2929 2e61 6c69 6173 2822 7477 6f22 292c  )).alias("two"),
-0000c9b0: 2068 6173 6828 6c69 7428 4e6f 6e65 292c   hash(lit(None),
-0000c9c0: 206c 6974 284e 6f6e 6529 2c20 6c69 7428   lit(None), lit(
-0000c9d0: 4e6f 6e65 2929 2e61 6c69 6173 2822 7468  None)).alias("th
-0000c9e0: 7265 6522 2929 2e63 6f6c 6c65 6374 2829  ree")).collect()
-0000c9f0: 0a20 2020 2020 2020 205b 526f 7728 4f4e  .        [Row(ON
-0000ca00: 453d 3838 3137 3937 3537 3032 3339 3336  E=88179757023936
-0000ca10: 3139 3336 382c 2054 574f 3d39 3533 3936  19368, TWO=95396
-0000ca20: 3332 3538 3335 3131 3034 3136 302c 2054  3258351104160, T
-0000ca30: 4852 4545 3d32 3934 3139 3438 3336 3338  HREE=29419483638
-0000ca40: 3435 3638 3434 3132 295d 0a20 2020 2022  45684412)].    "
-0000ca50: 2222 0a20 2020 2063 6f6c 756d 6e73 203d  "".    columns =
-0000ca60: 205b 5f74 6f5f 636f 6c5f 6966 5f73 7472   [_to_col_if_str
-0000ca70: 2863 2c20 2268 6173 6822 2920 666f 7220  (c, "hash") for 
-0000ca80: 6320 696e 2063 6f6c 735d 0a20 2020 2072  c in cols].    r
-0000ca90: 6574 7572 6e20 6275 696c 7469 6e28 2268  eturn builtin("h
-0000caa0: 6173 6822 2928 636f 6c75 6d6e 7329 0a0a  ash")(columns)..
-0000cab0: 0a64 6566 2061 7363 6969 2865 3a20 436f  .def ascii(e: Co
-0000cac0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000cad0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-0000cae0: 7475 726e 7320 7468 6520 4153 4349 4920  turns the ASCII 
-0000caf0: 636f 6465 2066 6f72 2074 6865 2066 6972  code for the fir
-0000cb00: 7374 2063 6861 7261 6374 6572 206f 6620  st character of 
-0000cb10: 6120 7374 7269 6e67 2e20 4966 2074 6865  a string. If the
-0000cb20: 2073 7472 696e 6720 6973 2065 6d70 7479   string is empty
-0000cb30: 2c0a 2020 2020 6120 7661 6c75 6520 6f66  ,.    a value of
-0000cb40: 2030 2069 7320 7265 7475 726e 6564 2e0a   0 is returned..
-0000cb50: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0000cb60: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0000cb70: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0000cb80: 6461 7461 6672 616d 6528 5b27 2127 2c20  dataframe(['!', 
-0000cb90: 2741 272c 2027 6127 2c20 2727 2c20 2762  'A', 'a', '', 'b
-0000cba0: 6364 272c 204e 6f6e 655d 2c20 7363 6865  cd', None], sche
-0000cbb0: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
-0000cbc0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000cbd0: 6466 2e61 2c20 6173 6369 6928 6466 2e61  df.a, ascii(df.a
-0000cbe0: 292e 6173 5f28 2761 7363 6969 2729 292e  ).as_('ascii')).
-0000cbf0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0000cc00: 2020 5b52 6f77 2841 3d27 2127 2c20 4153    [Row(A='!', AS
-0000cc10: 4349 493d 3333 292c 2052 6f77 2841 3d27  CII=33), Row(A='
-0000cc20: 4127 2c20 4153 4349 493d 3635 292c 2052  A', ASCII=65), R
-0000cc30: 6f77 2841 3d27 6127 2c20 4153 4349 493d  ow(A='a', ASCII=
-0000cc40: 3937 292c 2052 6f77 2841 3d27 272c 2041  97), Row(A='', A
-0000cc50: 5343 4949 3d30 292c 2052 6f77 2841 3d27  SCII=0), Row(A='
-0000cc60: 6263 6427 2c20 4153 4349 493d 3938 292c  bcd', ASCII=98),
-0000cc70: 2052 6f77 2841 3d4e 6f6e 652c 2041 5343   Row(A=None, ASC
-0000cc80: 4949 3d4e 6f6e 6529 5d0a 2020 2020 2222  II=None)].    ""
-0000cc90: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0000cca0: 6c5f 6966 5f73 7472 2865 2c20 2261 7363  l_if_str(e, "asc
-0000ccb0: 6969 2229 0a20 2020 2072 6574 7572 6e20  ii").    return 
-0000ccc0: 6275 696c 7469 6e28 2261 7363 6969 2229  builtin("ascii")
-0000ccd0: 2863 290a 0a0a 6465 6620 696e 6974 6361  (c)...def initca
-0000cce0: 7028 653a 2043 6f6c 756d 6e4f 724e 616d  p(e: ColumnOrNam
-0000ccf0: 652c 2064 656c 696d 6974 6572 733a 2043  e, delimiters: C
-0000cd00: 6f6c 756d 6e4f 724e 616d 6520 3d20 4e6f  olumnOrName = No
-0000cd10: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
-0000cd20: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-0000cd30: 6e73 2074 6865 2069 6e70 7574 2073 7472  ns the input str
-0000cd40: 696e 6720 7769 7468 2074 6865 2066 6972  ing with the fir
-0000cd50: 7374 206c 6574 7465 7220 6f66 2065 6163  st letter of eac
-0000cd60: 6820 776f 7264 2069 6e20 7570 7065 7263  h word in upperc
-0000cd70: 6173 650a 2020 2020 616e 6420 7468 6520  ase.    and the 
-0000cd80: 7375 6273 6571 7565 6e74 206c 6574 7465  subsequent lette
-0000cd90: 7273 2069 6e20 6c6f 7765 7263 6173 652e  rs in lowercase.
-0000cda0: 0a0a 2020 2020 6060 6465 6c69 6d69 7465  ..    ``delimite
-0000cdb0: 7273 6060 2069 7320 616e 206f 7074 696f  rs`` is an optio
-0000cdc0: 6e61 6c20 6172 6775 6d65 6e74 2073 7065  nal argument spe
-0000cdd0: 6369 6679 696e 6720 6120 7374 7269 6e67  cifying a string
-0000cde0: 206f 6620 6f6e 6520 6f72 206d 6f72 650a   of one or more.
-0000cdf0: 2020 2020 6368 6172 6163 7465 7273 2074      characters t
-0000ce00: 6861 7420 6060 696e 6974 6361 7060 6020  hat ``initcap`` 
-0000ce10: 7573 6573 2061 7320 7365 7061 7261 746f  uses as separato
-0000ce20: 7273 2066 6f72 2077 6f72 6473 2069 6e20  rs for words in 
-0000ce30: 7468 6520 696e 7075 7420 6578 7072 6573  the input expres
-0000ce40: 7369 6f6e 2e0a 0a20 2020 2049 6620 6060  sion...    If ``
-0000ce50: 6465 6c69 6d69 7465 7273 6060 2069 7320  delimiters`` is 
-0000ce60: 6e6f 7420 7370 6563 6966 6965 642c 2061  not specified, a
-0000ce70: 6e79 206f 6620 7468 6520 666f 6c6c 6f77  ny of the follow
-0000ce80: 696e 6720 6368 6172 6163 7465 7273 2069  ing characters i
-0000ce90: 6e20 7468 650a 2020 2020 696e 7075 7420  n the.    input 
-0000cea0: 6578 7072 6573 7369 6f6e 7320 6172 6520  expressions are 
-0000ceb0: 7472 6561 7465 6420 6173 2077 6f72 6420  treated as word 
-0000cec0: 7365 7061 7261 746f 7273 3a0a 0a20 2020  separators:..   
-0000ced0: 2020 2020 2060 603c 7768 6974 6573 7061       ``<whitespa
-0000cee0: 6365 3e20 2120 3f20 4020 2220 5e20 2320  ce> ! ? @ " ^ # 
-0000cef0: 2420 2620 7e20 5f20 2c20 2e20 3a20 3b20  $ & ~ _ , . : ; 
-0000cf00: 2b20 2d20 2a20 2520 2f20 7c20 5c5c 205b  + - * % / | \\ [
-0000cf10: 205d 2028 2029 207b 207d 203c 203e 6060   ] ( ) { } < >``
-0000cf20: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
-0000cf30: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0000cf40: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000cf50: 655f 6461 7461 6672 616d 6528 5b22 7468  e_dataframe(["th
-0000cf60: 6520 736b 7920 6973 2062 6c75 6522 2c20  e sky is blue", 
-0000cf70: 2257 4520 4341 4e20 4841 4e44 4c45 2054  "WE CAN HANDLE T
-0000cf80: 4849 5322 2c20 22c3 84c3 a4c3 96c3 b6c3  HIS", ".........
-0000cf90: 9fc3 9cc3 bc22 2c20 4e6f 6e65 5d2c 2073  .....", None], s
-0000cfa0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0000cfb0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000cfc0: 6374 2869 6e69 7463 6170 2864 665b 2261  ct(initcap(df["a
-0000cfd0: 225d 292e 616c 6961 7328 2269 6e69 7463  "]).alias("initc
-0000cfe0: 6170 2229 292e 636f 6c6c 6563 7428 290a  ap")).collect().
-0000cff0: 2020 2020 2020 2020 5b52 6f77 2849 4e49          [Row(INI
-0000d000: 5443 4150 3d27 5468 6520 536b 7920 4973  TCAP='The Sky Is
-0000d010: 2042 6c75 6527 292c 2052 6f77 2849 4e49   Blue'), Row(INI
-0000d020: 5443 4150 3d27 5765 2043 616e 2048 616e  TCAP='We Can Han
-0000d030: 646c 6520 5468 6973 2729 2c20 526f 7728  dle This'), Row(
-0000d040: 494e 4954 4341 503d 27c3 84c3 a4c3 b6c3  INITCAP='.......
-0000d050: b6c3 9fc3 bcc3 bc27 292c 2052 6f77 2849  .......'), Row(I
-0000d060: 4e49 5443 4150 3d4e 6f6e 6529 5d0a 2020  NITCAP=None)].  
-0000d070: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0000d080: 6563 7428 696e 6974 6361 7028 6466 5b22  ect(initcap(df["
-0000d090: 6122 5d2c 206c 6974 2827 2729 292e 616c  a"], lit('')).al
-0000d0a0: 6961 7328 2269 6e69 7463 6170 2229 292e  ias("initcap")).
-0000d0b0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0000d0c0: 2020 5b52 6f77 2849 4e49 5443 4150 3d27    [Row(INITCAP='
-0000d0d0: 5468 6520 736b 7920 6973 2062 6c75 6527  The sky is blue'
-0000d0e0: 292c 2052 6f77 2849 4e49 5443 4150 3d27  ), Row(INITCAP='
-0000d0f0: 5765 2063 616e 2068 616e 646c 6520 7468  We can handle th
-0000d100: 6973 2729 2c20 526f 7728 494e 4954 4341  is'), Row(INITCA
-0000d110: 503d 27c3 84c3 a4c3 b6c3 b6c3 9fc3 bcc3  P='.............
-0000d120: bc27 292c 2052 6f77 2849 4e49 5443 4150  .'), Row(INITCAP
-0000d130: 3d4e 6f6e 6529 5d0a 2020 2020 2222 220a  =None)].    """.
-0000d140: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0000d150: 6966 5f73 7472 2865 2c20 2269 6e69 7463  if_str(e, "initc
-0000d160: 6170 2229 0a20 2020 2069 6620 6465 6c69  ap").    if deli
-0000d170: 6d69 7465 7273 2069 7320 4e6f 6e65 3a0a  miters is None:.
-0000d180: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-0000d190: 7569 6c74 696e 2822 696e 6974 6361 7022  uiltin("initcap"
-0000d1a0: 2928 6329 0a20 2020 2064 656c 696d 6974  )(c).    delimit
-0000d1b0: 6572 5f63 6f6c 203d 205f 746f 5f63 6f6c  er_col = _to_col
-0000d1c0: 5f69 665f 7374 7228 6465 6c69 6d69 7465  _if_str(delimite
-0000d1d0: 7273 2c20 2269 6e69 7463 6170 2229 0a20  rs, "initcap"). 
-0000d1e0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0000d1f0: 6e28 2269 6e69 7463 6170 2229 2863 2c20  n("initcap")(c, 
-0000d200: 6465 6c69 6d69 7465 725f 636f 6c29 0a0a  delimiter_col)..
-0000d210: 0a64 6566 206c 656e 6774 6828 653a 2043  .def length(e: C
-0000d220: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0000d230: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-0000d240: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0000d250: 6c65 6e67 7468 206f 6620 616e 2069 6e70  length of an inp
-0000d260: 7574 2073 7472 696e 6720 6f72 2062 696e  ut string or bin
-0000d270: 6172 7920 7661 6c75 652e 2046 6f72 2073  ary value. For s
-0000d280: 7472 696e 6773 2c0a 2020 2020 7468 6520  trings,.    the 
-0000d290: 6c65 6e67 7468 2069 7320 7468 6520 6e75  length is the nu
-0000d2a0: 6d62 6572 206f 6620 6368 6172 6163 7465  mber of characte
-0000d2b0: 7273 2c20 616e 6420 5554 462d 3820 6368  rs, and UTF-8 ch
-0000d2c0: 6172 6163 7465 7273 2061 7265 2063 6f75  aracters are cou
-0000d2d0: 6e74 6564 2061 7320 610a 2020 2020 7369  nted as a.    si
-0000d2e0: 6e67 6c65 2063 6861 7261 6374 6572 2e20  ngle character. 
-0000d2f0: 466f 7220 6269 6e61 7279 2c20 7468 6520  For binary, the 
-0000d300: 6c65 6e67 7468 2069 7320 7468 6520 6e75  length is the nu
-0000d310: 6d62 6572 206f 6620 6279 7465 732e 0a0a  mber of bytes...
-0000d320: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0000d330: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000d340: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0000d350: 6174 6166 7261 6d65 285b 2274 6865 2073  ataframe(["the s
-0000d360: 6b79 2069 7320 626c 7565 222c 2022 5745  ky is blue", "WE
-0000d370: 2043 414e 2048 414e 444c 4520 5448 4953   CAN HANDLE THIS
-0000d380: 222c 2022 c384 c3a4 c396 c3b6 c39f c39c  ", "............
-0000d390: c3bc 222c 204e 6f6e 655d 2c20 7363 6865  ..", None], sche
-0000d3a0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0000d3b0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000d3c0: 6c65 6e67 7468 2864 665b 2261 225d 292e  length(df["a"]).
-0000d3d0: 616c 6961 7328 226c 656e 6774 6822 2929  alias("length"))
-0000d3e0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0000d3f0: 2020 205b 526f 7728 4c45 4e47 5448 3d31     [Row(LENGTH=1
-0000d400: 3529 2c20 526f 7728 4c45 4e47 5448 3d31  5), Row(LENGTH=1
-0000d410: 3829 2c20 526f 7728 4c45 4e47 5448 3d37  8), Row(LENGTH=7
-0000d420: 292c 2052 6f77 284c 454e 4754 483d 4e6f  ), Row(LENGTH=No
-0000d430: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
-0000d440: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-0000d450: 7374 7228 652c 2022 6c65 6e67 7468 2229  str(e, "length")
-0000d460: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000d470: 7469 6e28 226c 656e 6774 6822 2928 6329  tin("length")(c)
-0000d480: 0a0a 0a64 6566 206c 6f77 6572 2865 3a20  ...def lower(e: 
-0000d490: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0000d4a0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0000d4b0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
-0000d4c0: 2069 6e70 7574 2073 7472 696e 6720 7769   input string wi
-0000d4d0: 7468 2061 6c6c 2063 6861 7261 6374 6572  th all character
-0000d4e0: 7320 636f 6e76 6572 7465 6420 746f 206c  s converted to l
-0000d4f0: 6f77 6572 6361 7365 2e0a 0a20 2020 2045  owercase...    E
-0000d500: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0000d510: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000d520: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000d530: 616d 6528 5b27 6162 6327 2c20 2741 6263  ame(['abc', 'Abc
-0000d540: 272c 2027 6142 4327 2c20 2741 6e66 c3bc  ', 'aBC', 'Anf..
-0000d550: 6872 756e 6773 7a65 6963 6865 6e27 2c20  hrungszeichen', 
-0000d560: 2731 342e 3935 20e2 82ac 275d 2c20 7363  '14.95 ...'], sc
-0000d570: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0000d580: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0000d590: 7428 6c6f 7765 7228 636f 6c28 2261 2229  t(lower(col("a")
-0000d5a0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0000d5b0: 2020 2020 205b 526f 7728 4c4f 5745 5228       [Row(LOWER(
-0000d5c0: 2241 2229 3d27 6162 6327 292c 2052 6f77  "A")='abc'), Row
-0000d5d0: 284c 4f57 4552 2822 4122 293d 2761 6263  (LOWER("A")='abc
-0000d5e0: 2729 2c20 526f 7728 4c4f 5745 5228 2241  '), Row(LOWER("A
-0000d5f0: 2229 3d27 6162 6327 292c 2052 6f77 284c  ")='abc'), Row(L
-0000d600: 4f57 4552 2822 4122 293d 2761 6e66 c3bc  OWER("A")='anf..
-0000d610: 6872 756e 6773 7a65 6963 6865 6e27 292c  hrungszeichen'),
-0000d620: 2052 6f77 284c 4f57 4552 2822 4122 293d   Row(LOWER("A")=
-0000d630: 2731 342e 3935 20e2 82ac 2729 5d0a 2020  '14.95 ...')].  
-0000d640: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0000d650: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000d660: 226c 6f77 6572 2229 0a20 2020 2072 6574  "lower").    ret
-0000d670: 7572 6e20 6275 696c 7469 6e28 226c 6f77  urn builtin("low
-0000d680: 6572 2229 2863 290a 0a0a 6465 6620 6c70  er")(c)...def lp
-0000d690: 6164 2865 3a20 436f 6c75 6d6e 4f72 4e61  ad(e: ColumnOrNa
-0000d6a0: 6d65 2c20 6c65 6e3a 2055 6e69 6f6e 5b43  me, len: Union[C
-0000d6b0: 6f6c 756d 6e2c 2069 6e74 5d2c 2070 6164  olumn, int], pad
-0000d6c0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0000d6d0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000d6e0: 2222 0a20 2020 204c 6566 742d 7061 6473  "".    Left-pads
-0000d6f0: 2061 2073 7472 696e 6720 7769 7468 2063   a string with c
-0000d700: 6861 7261 6374 6572 7320 6672 6f6d 2061  haracters from a
-0000d710: 6e6f 7468 6572 2073 7472 696e 672c 206f  nother string, o
-0000d720: 7220 6c65 6674 2d70 6164 7320 610a 2020  r left-pads a.  
-0000d730: 2020 6269 6e61 7279 2076 616c 7565 2077    binary value w
-0000d740: 6974 6820 6279 7465 7320 6672 6f6d 2061  ith bytes from a
-0000d750: 6e6f 7468 6572 2062 696e 6172 7920 7661  nother binary va
-0000d760: 6c75 652e 0a0a 2020 2020 4578 616d 706c  lue...    Exampl
-0000d770: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-0000d780: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0000d790: 736e 6f77 7061 726b 2e66 756e 6374 696f  snowpark.functio
-0000d7a0: 6e73 2069 6d70 6f72 7420 6c69 740a 2020  ns import lit.  
-0000d7b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000d7c0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000d7d0: 7461 6672 616d 6528 5b5b 2261 225d 2c20  taframe([["a"], 
-0000d7e0: 5b22 6222 5d2c 205b 2263 225d 5d2c 2073  ["b"], ["c"]], s
-0000d7f0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0000d800: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000d810: 6374 286c 7061 6428 636f 6c28 2261 2229  ct(lpad(col("a")
-0000d820: 2c20 332c 206c 6974 2822 6b22 2929 2e61  , 3, lit("k")).a
-0000d830: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-0000d840: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-0000d850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000d860: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-0000d870: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000d880: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c6b  -----.        |k
-0000d890: 6b61 2020 2020 2020 207c 0a20 2020 2020  ka       |.     
-0000d8a0: 2020 207c 6b6b 6220 2020 2020 2020 7c0a     |kkb       |.
-0000d8b0: 2020 2020 2020 2020 7c6b 6b63 2020 2020          |kkc    
-0000d8c0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-0000d8d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000d8e0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-0000d8f0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0000d900: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000d910: 226c 7061 6422 290a 2020 2020 7020 3d20  "lpad").    p = 
-0000d920: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2870  _to_col_if_str(p
-0000d930: 6164 2c20 226c 7061 6422 290a 2020 2020  ad, "lpad").    
-0000d940: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000d950: 6c70 6164 2229 2863 2c20 6c69 7428 6c65  lpad")(c, lit(le
-0000d960: 6e29 2c20 7029 0a0a 0a64 6566 206c 7472  n), p)...def ltr
-0000d970: 696d 2865 3a20 436f 6c75 6d6e 4f72 4e61  im(e: ColumnOrNa
-0000d980: 6d65 2c20 7472 696d 5f73 7472 696e 673a  me, trim_string:
-0000d990: 204f 7074 696f 6e61 6c5b 436f 6c75 6d6e   Optional[Column
-0000d9a0: 4f72 4e61 6d65 5d20 3d20 4e6f 6e65 2920  OrName] = None) 
-0000d9b0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000d9c0: 2222 0a20 2020 2052 656d 6f76 6573 206c  "".    Removes l
-0000d9d0: 6561 6469 6e67 2063 6861 7261 6374 6572  eading character
-0000d9e0: 732c 2069 6e63 6c75 6469 6e67 2077 6869  s, including whi
-0000d9f0: 7465 7370 6163 652c 2066 726f 6d20 6120  tespace, from a 
-0000da00: 7374 7269 6e67 2e0a 0a20 2020 2045 7861  string...    Exa
-0000da10: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0000da20: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0000da30: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-0000da40: 7469 6f6e 7320 696d 706f 7274 206c 6974  tions import lit
-0000da50: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000da60: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000da70: 5f64 6174 6166 7261 6d65 285b 5b22 6173  _dataframe([["as
-0000da80: 7373 225d 2c20 5b22 6273 7373 225d 2c20  ss"], ["bsss"], 
-0000da90: 5b22 6373 7373 225d 5d2c 2073 6368 656d  ["csss"]], schem
-0000daa0: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-0000dab0: 203e 3e3e 2064 662e 7365 6c65 6374 2872   >>> df.select(r
-0000dac0: 7472 696d 2863 6f6c 2822 6122 292c 2074  trim(col("a"), t
-0000dad0: 7269 6d5f 7374 7269 6e67 3d6c 6974 2822  rim_string=lit("
-0000dae0: 7373 7322 2929 2e61 6c69 6173 2822 7265  sss")).alias("re
-0000daf0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-0000db00: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000db10: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-0000db20: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-0000db30: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0000db40: 2020 2020 2020 7c61 2020 2020 2020 2020        |a        
-0000db50: 207c 0a20 2020 2020 2020 207c 6220 2020   |.        |b   
-0000db60: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0000db70: 7c63 2020 2020 2020 2020 207c 0a20 2020  |c         |.   
-0000db80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000db90: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0000dba0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0000dbb0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0000dbc0: 5f73 7472 2865 2c20 226c 7472 696d 2229  _str(e, "ltrim")
-0000dbd0: 0a20 2020 2074 203d 205f 746f 5f63 6f6c  .    t = _to_col
-0000dbe0: 5f69 665f 7374 7228 7472 696d 5f73 7472  _if_str(trim_str
-0000dbf0: 696e 672c 2022 6c74 7269 6d22 2920 6966  ing, "ltrim") if
-0000dc00: 2074 7269 6d5f 7374 7269 6e67 2069 7320   trim_string is 
-0000dc10: 6e6f 7420 4e6f 6e65 2065 6c73 6520 4e6f  not None else No
-0000dc20: 6e65 0a20 2020 2072 6574 7572 6e20 6275  ne.    return bu
-0000dc30: 696c 7469 6e28 226c 7472 696d 2229 2863  iltin("ltrim")(c
-0000dc40: 2c20 7429 2069 6620 7420 6973 206e 6f74  , t) if t is not
-0000dc50: 204e 6f6e 6520 656c 7365 2062 7569 6c74   None else built
-0000dc60: 696e 2822 6c74 7269 6d22 2928 6329 0a0a  in("ltrim")(c)..
-0000dc70: 0a64 6566 2072 7061 6428 653a 2043 6f6c  .def rpad(e: Col
-0000dc80: 756d 6e4f 724e 616d 652c 206c 656e 3a20  umnOrName, len: 
-0000dc90: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
-0000dca0: 745d 2c20 7061 643a 2043 6f6c 756d 6e4f  t], pad: ColumnO
-0000dcb0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000dcc0: 3a0a 2020 2020 2222 2252 6967 6874 2d70  :.    """Right-p
-0000dcd0: 6164 7320 6120 7374 7269 6e67 2077 6974  ads a string wit
-0000dce0: 6820 6368 6172 6163 7465 7273 2066 726f  h characters fro
-0000dcf0: 6d20 616e 6f74 6865 7220 7374 7269 6e67  m another string
-0000dd00: 2c20 6f72 2072 6967 6874 2d70 6164 7320  , or right-pads 
-0000dd10: 610a 2020 2020 6269 6e61 7279 2076 616c  a.    binary val
-0000dd20: 7565 2077 6974 6820 6279 7465 7320 6672  ue with bytes fr
-0000dd30: 6f6d 2061 6e6f 7468 6572 2062 696e 6172  om another binar
-0000dd40: 7920 7661 6c75 652e 2057 6865 6e20 6361  y value. When ca
-0000dd50: 6c6c 6564 2c20 6065 6020 6973 2070 6164  lled, `e` is pad
-0000dd60: 6465 6420 746f 206c 656e 6774 6820 606c  ded to length `l
-0000dd70: 656e 600a 2020 2020 7769 7468 2063 6861  en`.    with cha
-0000dd80: 7261 6374 6572 732f 6279 7465 7320 6672  racters/bytes fr
-0000dd90: 6f6d 2060 7061 6460 2e0a 0a20 2020 2045  om `pad`...    E
-0000dda0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0000ddb0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0000ddc0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-0000ddd0: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
-0000dde0: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
-0000ddf0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000de00: 7465 5f64 6174 6166 7261 6d65 285b 5b22  te_dataframe([["
-0000de10: 6122 5d2c 205b 2262 225d 2c20 5b22 6322  a"], ["b"], ["c"
-0000de20: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
-0000de30: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0000de40: 2e73 656c 6563 7428 7270 6164 2863 6f6c  .select(rpad(col
-0000de50: 2822 6122 292c 2033 2c20 6c69 7428 226b  ("a"), 3, lit("k
-0000de60: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-0000de70: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-0000de80: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000de90: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-0000dea0: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-0000deb0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000dec0: 2020 207c 616b 6b20 2020 2020 2020 7c0a     |akk       |.
-0000ded0: 2020 2020 2020 2020 7c62 6b6b 2020 2020          |bkk    
-0000dee0: 2020 207c 0a20 2020 2020 2020 207c 636b     |.        |ck
-0000def0: 6b20 2020 2020 2020 7c0a 2020 2020 2020  k       |.      
-0000df00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000df10: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0000df20: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-0000df30: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000df40: 7228 652c 2022 7270 6164 2229 0a20 2020  r(e, "rpad").   
-0000df50: 2070 203d 205f 746f 5f63 6f6c 5f69 665f   p = _to_col_if_
-0000df60: 7374 7228 7061 642c 2022 7270 6164 2229  str(pad, "rpad")
-0000df70: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000df80: 7469 6e28 2272 7061 6422 2928 632c 206c  tin("rpad")(c, l
-0000df90: 6974 286c 656e 292c 2070 290a 0a0a 6465  it(len), p)...de
-0000dfa0: 6620 7274 7269 6d28 653a 2043 6f6c 756d  f rtrim(e: Colum
-0000dfb0: 6e4f 724e 616d 652c 2074 7269 6d5f 7374  nOrName, trim_st
-0000dfc0: 7269 6e67 3a20 4f70 7469 6f6e 616c 5b43  ring: Optional[C
-0000dfd0: 6f6c 756d 6e4f 724e 616d 655d 203d 204e  olumnOrName] = N
-0000dfe0: 6f6e 6529 202d 3e20 436f 6c75 6d6e 3a0a  one) -> Column:.
-0000dff0: 2020 2020 2222 2252 656d 6f76 6573 2074      """Removes t
-0000e000: 7261 696c 696e 6720 6368 6172 6163 7465  railing characte
-0000e010: 7273 2c20 696e 636c 7564 696e 6720 7768  rs, including wh
-0000e020: 6974 6573 7061 6365 2c20 6672 6f6d 2061  itespace, from a
-0000e030: 2073 7472 696e 672e 0a0a 2020 2020 4578   string...    Ex
-0000e040: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0000e050: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0000e060: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-0000e070: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
-0000e080: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
-0000e090: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000e0a0: 655f 6461 7461 6672 616d 6528 5b5b 2261  e_dataframe([["a
-0000e0b0: 7373 7322 5d2c 205b 2262 7373 7322 5d2c  sss"], ["bsss"],
-0000e0c0: 205b 2263 7373 7322 5d5d 2c20 7363 6865   ["csss"]], sche
-0000e0d0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0000e0e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000e0f0: 7274 7269 6d28 636f 6c28 2261 2229 2c20  rtrim(col("a"), 
-0000e100: 7472 696d 5f73 7472 696e 673d 6c69 7428  trim_string=lit(
-0000e110: 2273 7373 2229 292e 616c 6961 7328 2272  "sss")).alias("r
-0000e120: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0000e130: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000e140: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0000e150: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0000e160: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000e170: 2020 2020 2020 207c 6120 2020 2020 2020         |a       
-0000e180: 2020 7c0a 2020 2020 2020 2020 7c62 2020    |.        |b  
-0000e190: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0000e1a0: 207c 6320 2020 2020 2020 2020 7c0a 2020   |c         |.  
-0000e1b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000e1c0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0000e1d0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-0000e1e0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000e1f0: 665f 7374 7228 652c 2022 7274 7269 6d22  f_str(e, "rtrim"
-0000e200: 290a 2020 2020 7420 3d20 5f74 6f5f 636f  ).    t = _to_co
-0000e210: 6c5f 6966 5f73 7472 2874 7269 6d5f 7374  l_if_str(trim_st
-0000e220: 7269 6e67 2c20 2272 7472 696d 2229 2069  ring, "rtrim") i
-0000e230: 6620 7472 696d 5f73 7472 696e 6720 6973  f trim_string is
-0000e240: 206e 6f74 204e 6f6e 6520 656c 7365 204e   not None else N
-0000e250: 6f6e 650a 2020 2020 7265 7475 726e 2062  one.    return b
-0000e260: 7569 6c74 696e 2822 7274 7269 6d22 2928  uiltin("rtrim")(
-0000e270: 632c 2074 2920 6966 2074 2069 7320 6e6f  c, t) if t is no
-0000e280: 7420 4e6f 6e65 2065 6c73 6520 6275 696c  t None else buil
-0000e290: 7469 6e28 2272 7472 696d 2229 2863 290a  tin("rtrim")(c).
-0000e2a0: 0a0a 6465 6620 7265 7065 6174 2873 3a20  ..def repeat(s: 
-0000e2b0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6e3a  ColumnOrName, n:
-0000e2c0: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
-0000e2d0: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
-0000e2e0: 2020 2020 2222 2242 7569 6c64 7320 6120      """Builds a 
-0000e2f0: 7374 7269 6e67 2062 7920 7265 7065 6174  string by repeat
-0000e300: 696e 6720 7468 6520 696e 7075 7420 666f  ing the input fo
-0000e310: 7220 7468 6520 7370 6563 6966 6965 6420  r the specified 
-0000e320: 6e75 6d62 6572 206f 6620 7469 6d65 732e  number of times.
-0000e330: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0000e340: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000e350: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000e360: 5f64 6174 6166 7261 6d65 285b 5b22 6122  _dataframe([["a"
-0000e370: 5d2c 205b 2262 225d 2c20 5b22 6322 5d5d  ], ["b"], ["c"]]
-0000e380: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0000e390: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000e3a0: 656c 6563 7428 7265 7065 6174 2863 6f6c  elect(repeat(col
-0000e3b0: 2822 6122 292c 2033 292e 616c 6961 7328  ("a"), 3).alias(
-0000e3c0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0000e3d0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0000e3e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000e3f0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-0000e400: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000e410: 0a20 2020 2020 2020 207c 6161 6120 2020  .        |aaa   
-0000e420: 2020 2020 7c0a 2020 2020 2020 2020 7c62      |.        |b
-0000e430: 6262 2020 2020 2020 207c 0a20 2020 2020  bb       |.     
-0000e440: 2020 207c 6363 6320 2020 2020 2020 7c0a     |ccc       |.
-0000e450: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000e460: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0000e470: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0000e480: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0000e490: 5f69 665f 7374 7228 732c 2022 7265 7065  _if_str(s, "repe
-0000e4a0: 6174 2229 0a20 2020 2072 6574 7572 6e20  at").    return 
-0000e4b0: 6275 696c 7469 6e28 2272 6570 6561 7422  builtin("repeat"
-0000e4c0: 2928 632c 206c 6974 286e 2929 0a0a 0a64  )(c, lit(n))...d
-0000e4d0: 6566 2072 6576 6572 7365 2863 6f6c 3a20  ef reverse(col: 
-0000e4e0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0000e4f0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0000e500: 5265 7665 7273 6573 2074 6865 206f 7264  Reverses the ord
-0000e510: 6572 206f 6620 6368 6172 6163 7465 7273  er of characters
-0000e520: 2069 6e20 6120 7374 7269 6e67 2c20 6f72   in a string, or
-0000e530: 206f 6620 6279 7465 7320 696e 2061 2062   of bytes in a b
-0000e540: 696e 6172 7920 7661 6c75 652e 0a0a 2020  inary value...  
-0000e550: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0000e560: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000e570: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000e580: 6166 7261 6d65 285b 5b22 4865 6c6c 6f22  aframe([["Hello"
-0000e590: 5d2c 205b 2261 6263 225d 5d2c 2073 6368  ], ["abc"]], sch
-0000e5a0: 656d 613d 5b22 636f 6c31 225d 290a 2020  ema=["col1"]).  
-0000e5b0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0000e5c0: 6563 7428 7265 7665 7273 6528 636f 6c28  ect(reverse(col(
-0000e5d0: 2263 6f6c 3122 2929 292e 7368 6f77 2829  "col1"))).show()
-0000e5e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000e5f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000e600: 0a20 2020 2020 2020 207c 2252 4556 4552  .        |"REVER
-0000e610: 5345 2822 2243 4f4c 3122 2229 2220 207c  SE(""COL1"")"  |
-0000e620: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000e630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000e640: 0a20 2020 2020 2020 207c 6f6c 6c65 4820  .        |olleH 
-0000e650: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0000e660: 0a20 2020 2020 2020 207c 6362 6120 2020  .        |cba   
-0000e670: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0000e680: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000e690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000e6a0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0000e6b0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0000e6c0: 2063 6f6c 203d 205f 746f 5f63 6f6c 5f69   col = _to_col_i
-0000e6d0: 665f 7374 7228 636f 6c2c 2022 7265 7665  f_str(col, "reve
-0000e6e0: 7273 6522 290a 2020 2020 7265 7475 726e  rse").    return
-0000e6f0: 2062 7569 6c74 696e 2822 7265 7665 7273   builtin("revers
-0000e700: 6522 2928 636f 6c29 0a0a 0a64 6566 2073  e")(col)...def s
-0000e710: 6f75 6e64 6578 2865 3a20 436f 6c75 6d6e  oundex(e: Column
-0000e720: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000e730: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-0000e740: 7320 6120 7374 7269 6e67 2074 6861 7420  s a string that 
-0000e750: 636f 6e74 6169 6e73 2061 2070 686f 6e65  contains a phone
-0000e760: 7469 6320 7265 7072 6573 656e 7461 7469  tic representati
-0000e770: 6f6e 206f 6620 7468 6520 696e 7075 7420  on of the input 
-0000e780: 7374 7269 6e67 2e22 2222 0a20 2020 2063  string.""".    c
-0000e790: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000e7a0: 7228 652c 2022 736f 756e 6465 7822 290a  r(e, "soundex").
-0000e7b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000e7c0: 696e 2822 736f 756e 6465 7822 2928 6329  in("soundex")(c)
-0000e7d0: 0a0a 0a64 6566 2074 7269 6d28 653a 2043  ...def trim(e: C
-0000e7e0: 6f6c 756d 6e4f 724e 616d 652c 2074 7269  olumnOrName, tri
-0000e7f0: 6d5f 7374 7269 6e67 3a20 4f70 7469 6f6e  m_string: Option
-0000e800: 616c 5b43 6f6c 756d 6e4f 724e 616d 655d  al[ColumnOrName]
-0000e810: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
-0000e820: 6d6e 3a0a 2020 2020 2222 2252 656d 6f76  mn:.    """Remov
-0000e830: 6573 206c 6561 6469 6e67 2061 6e64 2074  es leading and t
-0000e840: 7261 696c 696e 6720 6368 6172 6163 7465  railing characte
-0000e850: 7273 2066 726f 6d20 6120 7374 7269 6e67  rs from a string
-0000e860: 2e20 5065 7220 6465 6661 756c 7420 6f6e  . Per default on
-0000e870: 6c79 2077 6869 7465 7370 6163 6520 2720  ly whitespace ' 
-0000e880: 2720 6368 6172 6163 7465 7273 2061 7265  ' characters are
-0000e890: 2072 656d 6f76 6564 2e0a 0a20 2020 2045   removed...    E
-0000e8a0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0000e8b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000e8c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000e8d0: 616d 6528 5b27 6865 6c6c 6f27 2c20 2720  ame(['hello', ' 
-0000e8e0: 776f 726c 6427 2c20 2720 2020 2120 2020  world', '   !   
-0000e8f0: 275d 2c20 7363 6865 6d61 3d5b 2261 225d  '], schema=["a"]
-0000e900: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0000e910: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0000e920: 2020 205b 526f 7728 413d 2768 656c 6c6f     [Row(A='hello
-0000e930: 2729 2c20 526f 7728 413d 2720 776f 726c  '), Row(A=' worl
-0000e940: 6427 292c 2052 6f77 2841 3d27 2020 2021  d'), Row(A='   !
-0000e950: 2020 2027 295d 0a20 2020 2020 2020 203e     ')].        >
-0000e960: 3e3e 2064 662e 7365 6c65 6374 2874 7269  >> df.select(tri
-0000e970: 6d28 636f 6c28 2261 2229 2929 2e63 6f6c  m(col("a"))).col
-0000e980: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0000e990: 526f 7728 5452 494d 2822 4122 293d 2768  Row(TRIM("A")='h
-0000e9a0: 656c 6c6f 2729 2c20 526f 7728 5452 494d  ello'), Row(TRIM
-0000e9b0: 2822 4122 293d 2777 6f72 6c64 2729 2c20  ("A")='world'), 
-0000e9c0: 526f 7728 5452 494d 2822 4122 293d 2721  Row(TRIM("A")='!
-0000e9d0: 2729 5d0a 0a20 2020 2045 7861 6d70 6c65  ')]..    Example
-0000e9e0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0000e9f0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0000ea00: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
-0000ea10: 4555 5220 3132 2e39 3627 2c20 2737 2e38  EUR 12.96', '7.8
-0000ea20: 3955 5344 272c 2027 352e 3939 4527 5d2c  9USD', '5.99E'],
-0000ea30: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-0000ea40: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0000ea50: 6c65 6374 2874 7269 6d28 636f 6c28 2261  lect(trim(col("a
-0000ea60: 2229 2c20 6c69 7428 2245 5552 5553 4420  "), lit("EURUSD 
-0000ea70: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-0000ea80: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0000ea90: 2020 5b52 6f77 2841 4e53 3d27 3132 2e39    [Row(ANS='12.9
-0000eaa0: 3627 292c 2052 6f77 2841 4e53 3d27 372e  6'), Row(ANS='7.
-0000eab0: 3839 2729 2c20 526f 7728 414e 533d 2735  89'), Row(ANS='5
-0000eac0: 2e39 3927 295d 0a0a 2020 2020 4578 616d  .99')]..    Exam
-0000ead0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-0000eae0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0000eaf0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0000eb00: 285b 2761 6263 3132 2034 3561 2037 3962  (['abc12 45a 79b
-0000eb10: 6321 275d 2c20 7363 6865 6d61 3d5b 2261  c!'], schema=["a
-0000eb20: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-0000eb30: 6466 2e73 656c 6563 7428 7472 696d 2863  df.select(trim(c
-0000eb40: 6f6c 2822 6122 292c 206c 6974 2822 6162  ol("a"), lit("ab
-0000eb50: 6321 2229 292e 6173 5f28 2261 6e73 2229  c!")).as_("ans")
-0000eb60: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0000eb70: 2020 2020 5b52 6f77 2841 4e53 3d27 3132      [Row(ANS='12
-0000eb80: 2034 3561 2037 3927 295d 0a0a 2020 2020   45a 79')]..    
-0000eb90: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0000eba0: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
-0000ebb0: 7269 6d22 290a 2020 2020 7420 3d20 5f74  rim").    t = _t
-0000ebc0: 6f5f 636f 6c5f 6966 5f73 7472 2874 7269  o_col_if_str(tri
-0000ebd0: 6d5f 7374 7269 6e67 2c20 2274 7269 6d22  m_string, "trim"
-0000ebe0: 2920 6966 2074 7269 6d5f 7374 7269 6e67  ) if trim_string
-0000ebf0: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-0000ec00: 6520 4e6f 6e65 0a20 2020 2072 6574 7572  e None.    retur
-0000ec10: 6e20 6275 696c 7469 6e28 2274 7269 6d22  n builtin("trim"
-0000ec20: 2928 632c 2074 2920 6966 2074 2069 7320  )(c, t) if t is 
-0000ec30: 6e6f 7420 4e6f 6e65 2065 6c73 6520 6275  not None else bu
-0000ec40: 696c 7469 6e28 2274 7269 6d22 2928 6329  iltin("trim")(c)
-0000ec50: 0a0a 0a64 6566 2075 7070 6572 2865 3a20  ...def upper(e: 
-0000ec60: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0000ec70: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0000ec80: 5265 7475 726e 7320 7468 6520 696e 7075  Returns the inpu
-0000ec90: 7420 7374 7269 6e67 2077 6974 6820 616c  t string with al
-0000eca0: 6c20 6368 6172 6163 7465 7273 2063 6f6e  l characters con
-0000ecb0: 7665 7274 6564 2074 6f20 7570 7065 7263  verted to upperc
-0000ecc0: 6173 652e 0a20 2020 2020 2020 556e 6963  ase..       Unic
-0000ecd0: 6f64 6520 6368 6172 6163 7465 7273 2061  ode characters a
-0000ece0: 7265 2073 7570 706f 7274 6564 2e0a 0a20  re supported... 
-0000ecf0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0000ed00: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000ed10: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000ed20: 7461 6672 616d 6528 5b27 6162 6327 2c20  taframe(['abc', 
-0000ed30: 2741 6263 272c 2027 6142 4327 2c20 2741  'Abc', 'aBC', 'A
-0000ed40: 6e66 c3bc 6872 756e 6773 7a65 6963 6865  nf..hrungszeiche
-0000ed50: 6e27 2c20 2731 342e 3935 20e2 82ac 275d  n', '14.95 ...']
-0000ed60: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0000ed70: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000ed80: 656c 6563 7428 7570 7065 7228 636f 6c28  elect(upper(col(
-0000ed90: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
-0000eda0: 0a20 2020 2020 2020 205b 526f 7728 5550  .        [Row(UP
-0000edb0: 5045 5228 2241 2229 3d27 4142 4327 292c  PER("A")='ABC'),
-0000edc0: 2052 6f77 2855 5050 4552 2822 4122 293d   Row(UPPER("A")=
-0000edd0: 2741 4243 2729 2c20 526f 7728 5550 5045  'ABC'), Row(UPPE
-0000ede0: 5228 2241 2229 3d27 4142 4327 292c 2052  R("A")='ABC'), R
-0000edf0: 6f77 2855 5050 4552 2822 4122 293d 2741  ow(UPPER("A")='A
-0000ee00: 4e46 c39c 4852 554e 4753 5a45 4943 4845  NF..HRUNGSZEICHE
-0000ee10: 4e27 292c 2052 6f77 2855 5050 4552 2822  N'), Row(UPPER("
-0000ee20: 4122 293d 2731 342e 3935 20e2 82ac 2729  A")='14.95 ...')
-0000ee30: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0000ee40: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000ee50: 2865 2c20 2275 7070 6572 2229 0a20 2020  (e, "upper").   
-0000ee60: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000ee70: 2275 7070 6572 2229 2863 290a 0a0a 6465  "upper")(c)...de
-0000ee80: 6620 7374 7274 6f6b 5f74 6f5f 6172 7261  f strtok_to_arra
-0000ee90: 7928 0a20 2020 2074 6578 743a 2043 6f6c  y(.    text: Col
-0000eea0: 756d 6e4f 724e 616d 652c 2064 656c 696d  umnOrName, delim
-0000eeb0: 6974 6572 3a20 4f70 7469 6f6e 616c 5b43  iter: Optional[C
-0000eec0: 6f6c 756d 6e4f 724e 616d 655d 203d 204e  olumnOrName] = N
-0000eed0: 6f6e 650a 2920 2d3e 2043 6f6c 756d 6e3a  one.) -> Column:
-0000eee0: 0a20 2020 2022 2222 0a20 2020 2054 6f6b  .    """.    Tok
-0000eef0: 656e 697a 6573 2074 6865 2067 6976 656e  enizes the given
-0000ef00: 2073 7472 696e 6720 7573 696e 6720 7468   string using th
-0000ef10: 6520 6769 7665 6e20 7365 7420 6f66 2064  e given set of d
-0000ef20: 656c 696d 6974 6572 7320 616e 6420 7265  elimiters and re
-0000ef30: 7475 726e 7320 7468 6520 746f 6b65 6e73  turns the tokens
-0000ef40: 2061 7320 616e 2061 7272 6179 2e0a 0a20   as an array... 
-0000ef50: 2020 2049 6620 6569 7468 6572 2070 6172     If either par
-0000ef60: 616d 6574 6572 2069 7320 6120 4e55 4c4c  ameter is a NULL
-0000ef70: 2c20 6120 4e55 4c4c 2069 7320 7265 7475  , a NULL is retu
-0000ef80: 726e 6564 2e20 416e 2065 6d70 7479 2061  rned. An empty a
-0000ef90: 7272 6179 2069 7320 7265 7475 726e 6564  rray is returned
-0000efa0: 2069 6620 746f 6b65 6e69 7a61 7469 6f6e   if tokenization
-0000efb0: 2070 726f 6475 6365 7320 6e6f 2074 6f6b   produces no tok
-0000efc0: 656e 732e 0a0a 2020 2020 4578 616d 706c  ens...    Exampl
-0000efd0: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0000efe0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0000eff0: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
-0000f000: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
-0000f010: 5b22 612e 622e 6322 2c20 222e 225d 2c20  ["a.b.c", "."], 
-0000f020: 5b22 312c 322e 3322 2c20 222c 225d 5d2c  ["1,2.3", ","]],
-0000f030: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0000f040: 2073 6368 656d 613d 5b22 7465 7874 222c   schema=["text",
-0000f050: 2022 6465 6c69 6d69 7465 7222 5d2c 0a20   "delimiter"],. 
-0000f060: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-0000f070: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000f080: 6374 2873 7472 746f 6b5f 746f 5f61 7272  ct(strtok_to_arr
-0000f090: 6179 2822 7465 7874 222c 2022 6465 6c69  ay("text", "deli
-0000f0a0: 6d69 7465 7222 292e 616c 6961 7328 2254  miter").alias("T
-0000f0b0: 494d 455f 4652 4f4d 5f50 4152 5453 2229  IME_FROM_PARTS")
-0000f0c0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0000f0d0: 2020 2020 5b52 6f77 2854 494d 455f 4652      [Row(TIME_FR
-0000f0e0: 4f4d 5f50 4152 5453 3d27 5b5c 5c6e 2020  OM_PARTS='[\\n  
-0000f0f0: 2261 222c 5c5c 6e20 2022 6222 2c5c 5c6e  "a",\\n  "b",\\n
-0000f100: 2020 2263 225c 5c6e 5d27 292c 2052 6f77    "c"\\n]'), Row
-0000f110: 2854 494d 455f 4652 4f4d 5f50 4152 5453  (TIME_FROM_PARTS
-0000f120: 3d27 5b5c 5c6e 2020 2231 222c 5c5c 6e20  ='[\\n  "1",\\n 
-0000f130: 2022 322e 3322 5c5c 6e5d 2729 5d0a 2020   "2.3"\\n]')].  
-0000f140: 2020 2222 220a 2020 2020 7420 3d20 5f74    """.    t = _t
-0000f150: 6f5f 636f 6c5f 6966 5f73 7472 2874 6578  o_col_if_str(tex
-0000f160: 742c 2022 7374 7274 6f6b 5f74 6f5f 6172  t, "strtok_to_ar
-0000f170: 7261 7922 290a 2020 2020 6420 3d20 5f74  ray").    d = _t
-0000f180: 6f5f 636f 6c5f 6966 5f73 7472 2864 656c  o_col_if_str(del
-0000f190: 696d 6974 6572 2c20 2273 7472 746f 6b5f  imiter, "strtok_
-0000f1a0: 746f 5f61 7272 6179 2229 2069 6620 6465  to_array") if de
-0000f1b0: 6c69 6d69 7465 7220 656c 7365 204e 6f6e  limiter else Non
-0000f1c0: 650a 2020 2020 7265 7475 726e 2028 0a20  e.    return (. 
-0000f1d0: 2020 2020 2020 2062 7569 6c74 696e 2822         builtin("
-0000f1e0: 7374 7274 6f6b 5f74 6f5f 6172 7261 7922  strtok_to_array"
-0000f1f0: 2928 742c 2064 2920 6966 2064 656c 696d  )(t, d) if delim
-0000f200: 6974 6572 2065 6c73 6520 6275 696c 7469  iter else builti
-0000f210: 6e28 2273 7472 746f 6b5f 746f 5f61 7272  n("strtok_to_arr
-0000f220: 6179 2229 2874 290a 2020 2020 290a 0a0a  ay")(t).    )...
-0000f230: 6465 6620 6c6f 6728 0a20 2020 2062 6173  def log(.    bas
-0000f240: 653a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  e: Union[ColumnO
-0000f250: 724e 616d 652c 2069 6e74 2c20 666c 6f61  rName, int, floa
-0000f260: 745d 2c20 783a 2055 6e69 6f6e 5b43 6f6c  t], x: Union[Col
-0000f270: 756d 6e4f 724e 616d 652c 2069 6e74 2c20  umnOrName, int, 
-0000f280: 666c 6f61 745d 0a29 202d 3e20 436f 6c75  float].) -> Colu
-0000f290: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0000f2a0: 5265 7475 726e 7320 7468 6520 6c6f 6761  Returns the loga
-0000f2b0: 7269 7468 6d20 6f66 2061 206e 756d 6572  rithm of a numer
-0000f2c0: 6963 2065 7870 7265 7373 696f 6e2e 0a0a  ic expression...
-0000f2d0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0000f2e0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0000f2f0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0000f300: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-0000f310: 496e 7465 6765 7254 7970 650a 2020 2020  IntegerType.    
-0000f320: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000f330: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0000f340: 6672 616d 6528 5b31 2c20 3130 5d2c 2073  frame([1, 10], s
-0000f350: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0000f360: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000f370: 6374 286c 6f67 2831 302c 2064 665b 2261  ct(log(10, df["a
-0000f380: 225d 292e 6361 7374 2849 6e74 6567 6572  "]).cast(Integer
-0000f390: 5479 7065 2829 292e 616c 6961 7328 226c  Type()).alias("l
-0000f3a0: 6f67 2229 292e 636f 6c6c 6563 7428 290a  og")).collect().
-0000f3b0: 2020 2020 2020 2020 5b52 6f77 284c 4f47          [Row(LOG
-0000f3c0: 3d30 292c 2052 6f77 284c 4f47 3d31 295d  =0), Row(LOG=1)]
-0000f3d0: 0a20 2020 2022 2222 0a20 2020 2062 203d  .    """.    b =
-0000f3e0: 206c 6974 2862 6173 6529 2069 6620 6973   lit(base) if is
-0000f3f0: 696e 7374 616e 6365 2862 6173 652c 2028  instance(base, (
-0000f400: 696e 742c 2066 6c6f 6174 2929 2065 6c73  int, float)) els
-0000f410: 6520 5f74 6f5f 636f 6c5f 6966 5f73 7472  e _to_col_if_str
-0000f420: 2862 6173 652c 2022 6c6f 6722 290a 2020  (base, "log").  
-0000f430: 2020 6172 6720 3d20 6c69 7428 7829 2069    arg = lit(x) i
-0000f440: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
-0000f450: 2869 6e74 2c20 666c 6f61 7429 2920 656c  (int, float)) el
-0000f460: 7365 205f 746f 5f63 6f6c 5f69 665f 7374  se _to_col_if_st
-0000f470: 7228 782c 2022 6c6f 6722 290a 2020 2020  r(x, "log").    
-0000f480: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000f490: 6c6f 6722 2928 622c 2061 7267 290a 0a0a  log")(b, arg)...
-0000f4a0: 6465 6620 706f 7728 0a20 2020 206c 6566  def pow(.    lef
-0000f4b0: 743a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  t: Union[ColumnO
-0000f4c0: 724e 616d 652c 2069 6e74 2c20 666c 6f61  rName, int, floa
-0000f4d0: 745d 2c20 7269 6768 743a 2055 6e69 6f6e  t], right: Union
-0000f4e0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-0000f4f0: 6e74 2c20 666c 6f61 745d 0a29 202d 3e20  nt, float].) -> 
-0000f500: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-0000f510: 6574 7572 6e73 2061 206e 756d 6265 7220  eturns a number 
-0000f520: 286c 6566 7429 2072 6169 7365 6420 746f  (left) raised to
-0000f530: 2074 6865 2073 7065 6369 6669 6564 2070   the specified p
-0000f540: 6f77 6572 2028 7269 6768 7429 2e0a 0a20  ower (right)... 
-0000f550: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-0000f560: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000f570: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000f580: 6166 7261 6d65 285b 5b32 2c20 335d 2c20  aframe([[2, 3], 
-0000f590: 5b33 2c20 345d 5d2c 2073 6368 656d 613d  [3, 4]], schema=
-0000f5a0: 5b22 7822 2c20 2279 225d 290a 2020 2020  ["x", "y"]).    
-0000f5b0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0000f5c0: 7428 706f 7728 636f 6c28 2278 2229 2c20  t(pow(col("x"), 
-0000f5d0: 636f 6c28 2279 2229 292e 616c 6961 7328  col("y")).alias(
-0000f5e0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0000f5f0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0000f600: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000f610: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-0000f620: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000f630: 0a20 2020 2020 2020 207c 382e 3020 2020  .        |8.0   
-0000f640: 2020 2020 7c0a 2020 2020 2020 2020 7c38      |.        |8
-0000f650: 312e 3020 2020 2020 207c 0a20 2020 2020  1.0      |.     
-0000f660: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0000f670: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0000f680: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-0000f690: 6e75 6d62 6572 203d 2028 0a20 2020 2020  number = (.     
-0000f6a0: 2020 206c 6974 286c 6566 7429 2069 6620     lit(left) if 
-0000f6b0: 6973 696e 7374 616e 6365 286c 6566 742c  isinstance(left,
-0000f6c0: 2028 696e 742c 2066 6c6f 6174 2929 2065   (int, float)) e
-0000f6d0: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
-0000f6e0: 7472 286c 6566 742c 2022 706f 7722 290a  tr(left, "pow").
-0000f6f0: 2020 2020 290a 2020 2020 706f 7765 7220      ).    power 
-0000f700: 3d20 280a 2020 2020 2020 2020 6c69 7428  = (.        lit(
-0000f710: 7269 6768 7429 2069 6620 6973 696e 7374  right) if isinst
-0000f720: 616e 6365 2872 6967 6874 2c20 2869 6e74  ance(right, (int
-0000f730: 2c20 666c 6f61 7429 2920 656c 7365 205f  , float)) else _
-0000f740: 746f 5f63 6f6c 5f69 665f 7374 7228 7269  to_col_if_str(ri
-0000f750: 6768 742c 2022 706f 7722 290a 2020 2020  ght, "pow").    
-0000f760: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0000f770: 6c74 696e 2822 706f 7722 2928 6e75 6d62  ltin("pow")(numb
-0000f780: 6572 2c20 706f 7765 7229 0a0a 0a64 6566  er, power)...def
-0000f790: 2072 6f75 6e64 2865 3a20 436f 6c75 6d6e   round(e: Column
-0000f7a0: 4f72 4e61 6d65 2c20 7363 616c 653a 2055  OrName, scale: U
-0000f7b0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-0000f7c0: 652c 2069 6e74 2c20 666c 6f61 745d 203d  e, int, float] =
-0000f7d0: 2030 2920 2d3e 2043 6f6c 756d 6e3a 0a20   0) -> Column:. 
-0000f7e0: 2020 2022 2222 5265 7475 726e 7320 726f     """Returns ro
-0000f7f0: 756e 6465 6420 7661 6c75 6573 2066 726f  unded values fro
-0000f800: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
-0000f810: 636f 6c75 6d6e 2e0a 0a20 2020 2045 7861  column...    Exa
-0000f820: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0000f830: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0000f840: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0000f850: 6528 5b5b 312e 3131 5d2c 205b 322e 3232  e([[1.11], [2.22
-0000f860: 5d2c 205b 332e 3333 5d5d 2c20 7363 6865  ], [3.33]], sche
-0000f870: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0000f880: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000f890: 726f 756e 6428 636f 6c28 2261 2229 292e  round(col("a")).
-0000f8a0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0000f8b0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0000f8c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000f8d0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0000f8e0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000f8f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000f900: 312e 3020 2020 2020 2020 7c0a 2020 2020  1.0       |.    
-0000f910: 2020 2020 7c32 2e30 2020 2020 2020 207c      |2.0       |
-0000f920: 0a20 2020 2020 2020 207c 332e 3020 2020  .        |3.0   
-0000f930: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0000f940: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000f950: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0000f960: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0000f970: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0000f980: 2022 726f 756e 6422 290a 2020 2020 7363   "round").    sc
-0000f990: 616c 655f 636f 6c20 3d20 280a 2020 2020  ale_col = (.    
-0000f9a0: 2020 2020 6c69 7428 7363 616c 6529 0a20      lit(scale). 
-0000f9b0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000f9c0: 616e 6365 2873 6361 6c65 2c20 2869 6e74  ance(scale, (int
-0000f9d0: 2c20 666c 6f61 7429 290a 2020 2020 2020  , float)).      
-0000f9e0: 2020 656c 7365 205f 746f 5f63 6f6c 5f69    else _to_col_i
-0000f9f0: 665f 7374 7228 7363 616c 652c 2022 726f  f_str(scale, "ro
-0000fa00: 756e 6422 290a 2020 2020 290a 2020 2020  und").    ).    
-0000fa10: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000fa20: 726f 756e 6422 2928 632c 2073 6361 6c65  round")(c, scale
-0000fa30: 5f63 6f6c 290a 0a0a 6465 6620 7370 6c69  _col)...def spli
-0000fa40: 7428 0a20 2020 2073 7472 3a20 436f 6c75  t(.    str: Colu
-0000fa50: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 7061  mnOrName,.    pa
-0000fa60: 7474 6572 6e3a 2043 6f6c 756d 6e4f 724e  ttern: ColumnOrN
-0000fa70: 616d 652c 0a29 202d 3e20 436f 6c75 6d6e  ame,.) -> Column
-0000fa80: 3a0a 2020 2020 2222 2253 706c 6974 7320  :.    """Splits 
-0000fa90: 6120 6769 7665 6e20 7374 7269 6e67 2077  a given string w
-0000faa0: 6974 6820 6120 6769 7665 6e20 7365 7061  ith a given sepa
-0000fab0: 7261 746f 7220 616e 6420 7265 7475 726e  rator and return
-0000fac0: 7320 7468 6520 7265 7375 6c74 2069 6e20  s the result in 
-0000fad0: 616e 2061 7272 6179 0a20 2020 206f 6620  an array.    of 
-0000fae0: 7374 7269 6e67 732e 2054 6f20 7370 6563  strings. To spec
-0000faf0: 6966 7920 6120 7374 7269 6e67 2073 6570  ify a string sep
-0000fb00: 6172 6174 6f72 2c20 7573 6520 7468 6520  arator, use the 
-0000fb10: 3a66 756e 633a 606c 6974 2829 6020 6675  :func:`lit()` fu
-0000fb20: 6e63 7469 6f6e 2e22 2222 0a20 2020 2073  nction.""".    s
-0000fb30: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000fb40: 7228 7374 722c 2022 7370 6c69 7422 290a  r(str, "split").
-0000fb50: 2020 2020 7020 3d20 5f74 6f5f 636f 6c5f      p = _to_col_
-0000fb60: 6966 5f73 7472 2870 6174 7465 726e 2c20  if_str(pattern, 
-0000fb70: 2273 706c 6974 2229 0a20 2020 2072 6574  "split").    ret
-0000fb80: 7572 6e20 6275 696c 7469 6e28 2273 706c  urn builtin("spl
-0000fb90: 6974 2229 2873 2c20 7029 0a0a 0a64 6566  it")(s, p)...def
-0000fba0: 2073 7562 7374 7269 6e67 280a 2020 2020   substring(.    
-0000fbb0: 7374 723a 2043 6f6c 756d 6e4f 724e 616d  str: ColumnOrNam
-0000fbc0: 652c 2070 6f73 3a20 556e 696f 6e5b 436f  e, pos: Union[Co
-0000fbd0: 6c75 6d6e 2c20 696e 745d 2c20 6c65 6e3a  lumn, int], len:
-0000fbe0: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
-0000fbf0: 6e74 5d0a 2920 2d3e 2043 6f6c 756d 6e3a  nt].) -> Column:
-0000fc00: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0000fc10: 7468 6520 706f 7274 696f 6e20 6f66 2074  the portion of t
-0000fc20: 6865 2073 7472 696e 6720 6f72 2062 696e  he string or bin
-0000fc30: 6172 7920 7661 6c75 6520 7374 722c 2073  ary value str, s
-0000fc40: 7461 7274 696e 6720 6672 6f6d 2074 6865  tarting from the
-0000fc50: 0a20 2020 2063 6861 7261 6374 6572 2f62  .    character/b
-0000fc60: 7974 6520 7370 6563 6966 6965 6420 6279  yte specified by
-0000fc70: 2070 6f73 2c20 7769 7468 206c 696d 6974   pos, with limit
-0000fc80: 6564 206c 656e 6774 682e 2054 6865 206c  ed length. The l
-0000fc90: 656e 6774 6820 7368 6f75 6c64 2062 6520  ength should be 
-0000fca0: 6772 6561 7465 720a 2020 2020 7468 616e  greater.    than
-0000fcb0: 206f 7220 6571 7561 6c20 746f 207a 6572   or equal to zer
-0000fcc0: 6f2e 2049 6620 7468 6520 6c65 6e67 7468  o. If the length
-0000fcd0: 2069 7320 6120 6e65 6761 7469 7665 206e   is a negative n
-0000fce0: 756d 6265 722c 2074 6865 2066 756e 6374  umber, the funct
-0000fcf0: 696f 6e20 7265 7475 726e 7320 616e 0a20  ion returns an. 
-0000fd00: 2020 2065 6d70 7479 2073 7472 696e 672e     empty string.
-0000fd10: 0a0a 2020 2020 4e6f 7465 3a0a 2020 2020  ..    Note:.    
-0000fd20: 2020 2020 466f 7220 6060 706f 7360 602c      For ``pos``,
-0000fd30: 2031 2069 7320 7468 6520 6669 7273 7420   1 is the first 
-0000fd40: 6368 6172 6163 7465 7220 6f66 2074 6865  character of the
-0000fd50: 2073 7472 696e 6720 696e 2053 6e6f 7766   string in Snowf
-0000fd60: 6c61 6b65 2064 6174 6162 6173 652e 0a0a  lake database...
-0000fd70: 2020 2020 3a66 756e 633a 6073 7562 7374      :func:`subst
-0000fd80: 7260 2069 7320 616e 2061 6c69 6173 206f  r` is an alias o
-0000fd90: 6620 3a66 756e 633a 6073 7562 7374 7269  f :func:`substri
-0000fda0: 6e67 602e 0a20 2020 2022 2222 0a20 2020  ng`..    """.   
-0000fdb0: 2073 203d 205f 746f 5f63 6f6c 5f69 665f   s = _to_col_if_
-0000fdc0: 7374 7228 7374 722c 2022 7375 6273 7472  str(str, "substr
-0000fdd0: 696e 6722 290a 2020 2020 7020 3d20 706f  ing").    p = po
-0000fde0: 7320 6966 2069 7369 6e73 7461 6e63 6528  s if isinstance(
-0000fdf0: 706f 732c 2043 6f6c 756d 6e29 2065 6c73  pos, Column) els
-0000fe00: 6520 6c69 7428 706f 7329 0a20 2020 206c  e lit(pos).    l
-0000fe10: 656e 6774 6820 3d20 6c65 6e20 6966 2069  ength = len if i
-0000fe20: 7369 6e73 7461 6e63 6528 6c65 6e2c 2043  sinstance(len, C
-0000fe30: 6f6c 756d 6e29 2065 6c73 6520 6c69 7428  olumn) else lit(
-0000fe40: 6c65 6e29 0a20 2020 2072 6574 7572 6e20  len).    return 
-0000fe50: 6275 696c 7469 6e28 2273 7562 7374 7269  builtin("substri
-0000fe60: 6e67 2229 2873 2c20 702c 206c 656e 6774  ng")(s, p, lengt
-0000fe70: 6829 0a0a 0a64 6566 2072 6567 6578 705f  h)...def regexp_
-0000fe80: 636f 756e 7428 0a20 2020 2073 7562 6a65  count(.    subje
-0000fe90: 6374 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ct: ColumnOrName
-0000fea0: 2c0a 2020 2020 7061 7474 6572 6e3a 2043  ,.    pattern: C
-0000feb0: 6f6c 756d 6e4f 724c 6974 6572 616c 5374  olumnOrLiteralSt
-0000fec0: 722c 0a20 2020 2070 6f73 6974 696f 6e3a  r,.    position:
-0000fed0: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
-0000fee0: 6e74 5d20 3d20 312c 0a20 2020 202a 7061  nt] = 1,.    *pa
-0000fef0: 7261 6d65 7465 7273 3a20 436f 6c75 6d6e  rameters: Column
-0000ff00: 4f72 4c69 7465 7261 6c2c 0a29 202d 3e20  OrLiteral,.) -> 
-0000ff10: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-0000ff20: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
-0000ff30: 7220 6f66 2074 696d 6573 2074 6861 7420  r of times that 
-0000ff40: 6120 7061 7474 6572 6e20 6f63 6375 7273  a pattern occurs
-0000ff50: 2069 6e20 7468 6520 7375 626a 6563 742e   in the subject.
-0000ff60: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0000ff70: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000ff80: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-0000ff90: 656c 6563 7420 2a20 6672 6f6d 2076 616c  elect * from val
-0000ffa0: 7565 7328 2761 7070 6c65 2729 2c28 2762  ues('apple'),('b
-0000ffb0: 616e 616e 6127 292c 2827 7065 6163 6827  anana'),('peach'
-0000ffc0: 2920 6173 2054 2861 2922 290a 2020 2020  ) as T(a)").    
-0000ffd0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0000ffe0: 7428 7265 6765 7870 5f63 6f75 6e74 2863  t(regexp_count(c
-0000fff0: 6f6c 2822 6122 292c 2022 6122 292e 616c  ol("a"), "a").al
-00010000: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-00010010: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00010020: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00010030: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-00010040: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00010050: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
-00010060: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00010070: 2020 7c33 2020 2020 2020 2020 207c 0a20    |3         |. 
-00010080: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
-00010090: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000100a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000100b0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-000100c0: 2022 2222 0a20 2020 2073 716c 5f66 756e   """.    sql_fun
-000100d0: 635f 6e61 6d65 203d 2022 7265 6765 7870  c_name = "regexp
-000100e0: 5f63 6f75 6e74 220a 2020 2020 7375 6220  _count".    sub 
-000100f0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00010100: 2873 7562 6a65 6374 2c20 7371 6c5f 6675  (subject, sql_fu
-00010110: 6e63 5f6e 616d 6529 0a20 2020 2070 6174  nc_name).    pat
-00010120: 203d 206c 6974 2870 6174 7465 726e 290a   = lit(pattern).
-00010130: 2020 2020 706f 7320 3d20 6c69 7428 706f      pos = lit(po
-00010140: 7369 7469 6f6e 290a 0a20 2020 2070 6172  sition)..    par
-00010150: 616d 7320 3d20 5b6c 6974 2870 2920 666f  ams = [lit(p) fo
-00010160: 7220 7020 696e 2070 6172 616d 6574 6572  r p in parameter
-00010170: 735d 0a20 2020 2072 6574 7572 6e20 6275  s].    return bu
-00010180: 696c 7469 6e28 7371 6c5f 6675 6e63 5f6e  iltin(sql_func_n
-00010190: 616d 6529 2873 7562 2c20 7061 742c 2070  ame)(sub, pat, p
-000101a0: 6f73 2c20 2a70 6172 616d 7329 0a0a 0a64  os, *params)...d
-000101b0: 6566 2072 6567 6578 705f 7265 706c 6163  ef regexp_replac
-000101c0: 6528 0a20 2020 2073 7562 6a65 6374 3a20  e(.    subject: 
-000101d0: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
-000101e0: 2020 7061 7474 6572 6e3a 2043 6f6c 756d    pattern: Colum
-000101f0: 6e4f 724c 6974 6572 616c 5374 722c 0a20  nOrLiteralStr,. 
-00010200: 2020 2072 6570 6c61 6365 6d65 6e74 3a20     replacement: 
-00010210: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
-00010220: 7472 203d 2022 222c 0a20 2020 2070 6f73  tr = "",.    pos
-00010230: 6974 696f 6e3a 2055 6e69 6f6e 5b43 6f6c  ition: Union[Col
-00010240: 756d 6e2c 2069 6e74 5d20 3d20 312c 0a20  umn, int] = 1,. 
-00010250: 2020 206f 6363 7572 7265 6e63 6573 3a20     occurrences: 
-00010260: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
-00010270: 745d 203d 2030 2c0a 2020 2020 2a70 6172  t] = 0,.    *par
-00010280: 616d 6574 6572 733a 2043 6f6c 756d 6e4f  ameters: ColumnO
-00010290: 724c 6974 6572 616c 2c0a 2920 2d3e 2043  rLiteral,.) -> C
-000102a0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-000102b0: 7475 726e 7320 7468 6520 7375 626a 6563  turns the subjec
-000102c0: 7420 7769 7468 2074 6865 2073 7065 6369  t with the speci
-000102d0: 6669 6564 2070 6174 7465 726e 2028 6f72  fied pattern (or
-000102e0: 2061 6c6c 206f 6363 7572 7265 6e63 6573   all occurrences
-000102f0: 206f 6620 7468 6520 7061 7474 6572 6e29   of the pattern)
-00010300: 2065 6974 6865 7220 7265 6d6f 7665 6420   either removed 
-00010310: 6f72 2072 6570 6c61 6365 6420 6279 2061  or replaced by a
-00010320: 2072 6570 6c61 6365 6d65 6e74 2073 7472   replacement str
-00010330: 696e 672e 0a20 2020 2049 6620 6e6f 206d  ing..    If no m
-00010340: 6174 6368 6573 2061 7265 2066 6f75 6e64  atches are found
-00010350: 2c20 7265 7475 726e 7320 7468 6520 6f72  , returns the or
-00010360: 6967 696e 616c 2073 7562 6a65 6374 2e0a  iginal subject..
-00010370: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00010380: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00010390: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000103a0: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-000103b0: 2020 2e2e 2e20 2020 2020 5b5b 2249 7420    ...     [["It 
-000103c0: 7761 7320 7468 6520 6265 7374 206f 6620  was the best of 
-000103d0: 7469 6d65 732c 2069 7420 7761 7320 7468  times, it was th
-000103e0: 6520 776f 7273 7420 6f66 2074 696d 6573  e worst of times
-000103f0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
-00010400: 5d0a 2020 2020 2020 2020 2e2e 2e20 290a  ].        ... ).
-00010410: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00010420: 656c 6563 7428 7265 6765 7870 5f72 6570  elect(regexp_rep
-00010430: 6c61 6365 2863 6f6c 2822 6122 292c 206c  lace(col("a"), l
-00010440: 6974 2822 2820 297b 312c 7d22 292c 206c  it("( ){1,}"), l
-00010450: 6974 2822 2229 292e 616c 6961 7328 2272  it("")).alias("r
-00010460: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00010470: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00010480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00010490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000104a0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-000104b0: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
-000104c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000104e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-000104f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00010500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00010510: 2020 2020 2020 207c 4974 7761 7374 6865         |Itwasthe
-00010520: 6265 7374 6f66 7469 6d65 732c 6974 7761  bestoftimes,itwa
-00010530: 7374 6865 776f 7273 746f 6674 696d 6573  stheworstoftimes
-00010540: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00010550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00010560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00010570: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00010580: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00010590: 2022 2222 0a20 2020 2073 716c 5f66 756e   """.    sql_fun
-000105a0: 635f 6e61 6d65 203d 2022 7265 6765 7870  c_name = "regexp
-000105b0: 5f72 6570 6c61 6365 220a 2020 2020 7375  _replace".    su
-000105c0: 6220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  b = _to_col_if_s
-000105d0: 7472 2873 7562 6a65 6374 2c20 7371 6c5f  tr(subject, sql_
-000105e0: 6675 6e63 5f6e 616d 6529 0a20 2020 2070  func_name).    p
-000105f0: 6174 203d 206c 6974 2870 6174 7465 726e  at = lit(pattern
-00010600: 290a 2020 2020 7265 7020 3d20 6c69 7428  ).    rep = lit(
-00010610: 7265 706c 6163 656d 656e 7429 0a20 2020  replacement).   
-00010620: 2070 6f73 203d 206c 6974 2870 6f73 6974   pos = lit(posit
-00010630: 696f 6e29 0a20 2020 206f 6363 203d 206c  ion).    occ = l
-00010640: 6974 286f 6363 7572 7265 6e63 6573 290a  it(occurrences).
-00010650: 0a20 2020 2070 6172 616d 7320 3d20 5b6c  .    params = [l
-00010660: 6974 2870 2920 666f 7220 7020 696e 2070  it(p) for p in p
-00010670: 6172 616d 6574 6572 735d 0a20 2020 2072  arameters].    r
-00010680: 6574 7572 6e20 6275 696c 7469 6e28 7371  eturn builtin(sq
-00010690: 6c5f 6675 6e63 5f6e 616d 6529 2873 7562  l_func_name)(sub
-000106a0: 2c20 7061 742c 2072 6570 2c20 706f 732c  , pat, rep, pos,
-000106b0: 206f 6363 2c20 2a70 6172 616d 7329 0a0a   occ, *params)..
-000106c0: 0a64 6566 2072 6570 6c61 6365 280a 2020  .def replace(.  
-000106d0: 2020 7375 626a 6563 743a 2043 6f6c 756d    subject: Colum
-000106e0: 6e4f 724e 616d 652c 0a20 2020 2070 6174  nOrName,.    pat
-000106f0: 7465 726e 3a20 436f 6c75 6d6e 4f72 4c69  tern: ColumnOrLi
-00010700: 7465 7261 6c53 7472 2c0a 2020 2020 7265  teralStr,.    re
-00010710: 706c 6163 656d 656e 743a 2043 6f6c 756d  placement: Colum
-00010720: 6e4f 724c 6974 6572 616c 5374 7220 3d20  nOrLiteralStr = 
-00010730: 2222 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  "",.) -> Column:
-00010740: 0a20 2020 2022 2222 0a20 2020 2052 656d  .    """.    Rem
-00010750: 6f76 6573 2061 6c6c 206f 6363 7572 7265  oves all occurre
-00010760: 6e63 6573 206f 6620 6120 7370 6563 6966  nces of a specif
-00010770: 6965 6420 7375 626a 6563 7420 616e 6420  ied subject and 
-00010780: 6f70 7469 6f6e 616c 6c79 2072 6570 6c61  optionally repla
-00010790: 6365 7320 7468 656d 2077 6974 6820 7265  ces them with re
-000107a0: 706c 6163 656d 656e 742e 0a0a 2020 2020  placement...    
-000107b0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000107c0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000107d0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000107e0: 7261 6d65 285b 5b22 6170 706c 6522 5d2c  rame([["apple"],
-000107f0: 205b 2261 7070 6c65 2070 6965 225d 2c20   ["apple pie"], 
-00010800: 5b22 6170 706c 6520 6a75 6963 6522 5d5d  ["apple juice"]]
-00010810: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-00010820: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00010830: 656c 6563 7428 7265 706c 6163 6528 636f  elect(replace(co
-00010840: 6c28 2261 2229 2c20 2261 7070 6c65 222c  l("a"), "apple",
-00010850: 2022 6f72 616e 6765 2229 2e61 6c69 6173   "orange").alias
-00010860: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-00010870: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00010880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00010890: 2020 2020 7c22 5245 5355 4c54 2220 2020      |"RESULT"   
-000108a0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-000108b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000108c0: 2020 2020 2020 7c6f 7261 6e67 6520 2020        |orange   
-000108d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-000108e0: 6f72 616e 6765 2070 6965 2020 2020 7c0a  orange pie    |.
-000108f0: 2020 2020 2020 2020 7c6f 7261 6e67 6520          |orange 
-00010900: 6a75 6963 6520 207c 0a20 2020 2020 2020  juice  |.       
-00010910: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00010920: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00010930: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00010940: 2020 7371 6c5f 6675 6e63 5f6e 616d 6520    sql_func_name 
-00010950: 3d20 2272 6570 6c61 6365 220a 2020 2020  = "replace".    
-00010960: 7375 6220 3d20 5f74 6f5f 636f 6c5f 6966  sub = _to_col_if
-00010970: 5f73 7472 2873 7562 6a65 6374 2c20 7371  _str(subject, sq
-00010980: 6c5f 6675 6e63 5f6e 616d 6529 0a20 2020  l_func_name).   
-00010990: 2070 6174 203d 206c 6974 2870 6174 7465   pat = lit(patte
-000109a0: 726e 290a 2020 2020 7265 7020 3d20 6c69  rn).    rep = li
-000109b0: 7428 7265 706c 6163 656d 656e 7429 0a20  t(replacement). 
-000109c0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-000109d0: 6e28 7371 6c5f 6675 6e63 5f6e 616d 6529  n(sql_func_name)
-000109e0: 2873 7562 2c20 7061 742c 2072 6570 290a  (sub, pat, rep).
-000109f0: 0a0a 6465 6620 6368 6172 696e 6465 7828  ..def charindex(
-00010a00: 0a20 2020 2074 6172 6765 745f 6578 7072  .    target_expr
-00010a10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
-00010a20: 2020 2020 736f 7572 6365 5f65 7870 723a      source_expr:
-00010a30: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
-00010a40: 2020 2070 6f73 6974 696f 6e3a 204f 7074     position: Opt
-00010a50: 696f 6e61 6c5b 556e 696f 6e5b 436f 6c75  ional[Union[Colu
-00010a60: 6d6e 2c20 696e 745d 5d20 3d20 4e6f 6e65  mn, int]] = None
-00010a70: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-00010a80: 2020 2022 2222 5365 6172 6368 6573 2066     """Searches f
-00010a90: 6f72 2060 6074 6172 6765 745f 6578 7072  or ``target_expr
-00010aa0: 6060 2069 6e20 6060 736f 7572 6365 5f65  `` in ``source_e
-00010ab0: 7870 7260 6020 616e 642c 2069 6620 7375  xpr`` and, if su
-00010ac0: 6363 6573 7366 756c 2c0a 2020 2020 7265  ccessful,.    re
-00010ad0: 7475 726e 7320 7468 6520 706f 7369 7469  turns the positi
-00010ae0: 6f6e 2028 312d 6261 7365 6429 206f 6620  on (1-based) of 
-00010af0: 7468 6520 6060 7461 7267 6574 5f65 7870  the ``target_exp
-00010b00: 7260 6020 696e 2060 6073 6f75 7263 655f  r`` in ``source_
-00010b10: 6578 7072 6060 2e0a 0a20 2020 2041 7267  expr``...    Arg
-00010b20: 733a 0a20 2020 2020 2020 2074 6172 6765  s:.        targe
-00010b30: 745f 6578 7072 3a20 4120 7374 7269 6e67  t_expr: A string
-00010b40: 206f 7220 6269 6e61 7279 2065 7870 7265   or binary expre
-00010b50: 7373 696f 6e20 7265 7072 6573 656e 7469  ssion representi
-00010b60: 6e67 2074 6865 2076 616c 7565 2074 6f20  ng the value to 
-00010b70: 6c6f 6f6b 2066 6f72 2e0a 2020 2020 2020  look for..      
-00010b80: 2020 736f 7572 6365 5f65 7870 723a 2041    source_expr: A
-00010b90: 2073 7472 696e 6720 6f72 2062 696e 6172   string or binar
-00010ba0: 7920 6578 7072 6573 7369 6f6e 2072 6570  y expression rep
-00010bb0: 7265 7365 6e74 696e 6720 7468 6520 7661  resenting the va
-00010bc0: 6c75 6520 746f 2073 6561 7263 682e 0a20  lue to search.. 
-00010bd0: 2020 2020 2020 2070 6f73 6974 696f 6e3a         position:
-00010be0: 2041 206e 756d 6265 7220 696e 6469 6361   A number indica
-00010bf0: 7469 6f6e 2074 6865 2070 6f73 6974 696f  tion the positio
-00010c00: 6e20 2831 2d62 6173 6564 2920 6672 6f6d  n (1-based) from
-00010c10: 2077 6865 7265 2074 6f20 7374 6172 7420   where to start 
-00010c20: 7468 6520 7365 6172 6368 2e20 4465 6661  the search. Defa
-00010c30: 756c 7473 2074 6f20 4e6f 6e65 2e0a 0a20  ults to None... 
-00010c40: 2020 2045 7861 6d70 6c65 733a 3a0a 2020     Examples::.  
-00010c50: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00010c60: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00010c70: 7461 6672 616d 6528 5b22 6261 6e61 6e61  taframe(["banana
-00010c80: 225d 2c20 7363 6865 6d61 3d5b 2761 275d  "], schema=['a']
-00010c90: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00010ca0: 2e73 656c 6563 7428 6368 6172 696e 6465  .select(charinde
-00010cb0: 7828 6c69 7428 2261 6e22 292c 2064 662e  x(lit("an"), df.
-00010cc0: 612c 2031 292e 6173 5f28 2272 6573 756c  a, 1).as_("resul
-00010cd0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00010ce0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00010cf0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-00010d00: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-00010d10: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00010d20: 2020 207c 3220 2020 2020 2020 2020 7c0a     |2         |.
-00010d30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00010d40: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00010d50: 414e 4b4c 494e 453e 0a0a 2020 2020 2020  ANKLINE>..      
-00010d60: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00010d70: 6368 6172 696e 6465 7828 6c69 7428 2261  charindex(lit("a
-00010d80: 6e22 292c 2064 662e 612c 2033 292e 6173  n"), df.a, 3).as
-00010d90: 5f28 2272 6573 756c 7422 2929 2e73 686f  _("result")).sho
-00010da0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00010db0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00010dc0: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-00010dd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00010de0: 2d2d 0a20 2020 2020 2020 207c 3420 2020  --.        |4   
-00010df0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00010e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00010e10: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00010e20: 0a20 2020 2022 2222 0a20 2020 2074 203d  .    """.    t =
-00010e30: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00010e40: 7461 7267 6574 5f65 7870 722c 2022 6368  target_expr, "ch
-00010e50: 6172 696e 6465 7822 290a 2020 2020 7320  arindex").    s 
-00010e60: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00010e70: 2873 6f75 7263 655f 6578 7072 2c20 2263  (source_expr, "c
-00010e80: 6861 7269 6e64 6578 2229 0a20 2020 2072  harindex").    r
-00010e90: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
-00010ea0: 6275 696c 7469 6e28 2263 6861 7269 6e64  builtin("charind
-00010eb0: 6578 2229 2874 2c20 732c 206c 6974 2870  ex")(t, s, lit(p
-00010ec0: 6f73 6974 696f 6e29 290a 2020 2020 2020  osition)).      
-00010ed0: 2020 6966 2070 6f73 6974 696f 6e20 6973    if position is
-00010ee0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
-00010ef0: 2020 656c 7365 2062 7569 6c74 696e 2822    else builtin("
-00010f00: 6368 6172 696e 6465 7822 2928 742c 2073  charindex")(t, s
-00010f10: 290a 2020 2020 290a 0a0a 6465 6620 636f  ).    )...def co
-00010f20: 6c6c 6174 6528 653a 2043 6f6c 756d 6e2c  llate(e: Column,
-00010f30: 2063 6f6c 6c61 7469 6f6e 5f73 7065 633a   collation_spec:
-00010f40: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
-00010f50: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00010f60: 6120 636f 7079 206f 6620 7468 6520 6f72  a copy of the or
-00010f70: 6967 696e 616c 203a 636c 6173 733a 6043  iginal :class:`C
-00010f80: 6f6c 756d 6e60 2077 6974 6820 7468 6520  olumn` with the 
-00010f90: 7370 6563 6966 6965 6420 6060 636f 6c6c  specified ``coll
-00010fa0: 6174 696f 6e5f 7370 6563 6060 0a20 2020  ation_spec``.   
-00010fb0: 2070 726f 7065 7274 792c 2072 6174 6865   property, rathe
-00010fc0: 7220 7468 616e 2074 6865 206f 7269 6769  r than the origi
-00010fd0: 6e61 6c20 636f 6c6c 6174 696f 6e20 7370  nal collation sp
-00010fe0: 6563 6966 6963 6174 696f 6e20 7072 6f70  ecification prop
-00010ff0: 6572 7479 2e0a 0a20 2020 2046 6f72 2064  erty...    For d
-00011000: 6574 6169 6c73 2c20 7365 6520 7468 6520  etails, see the 
-00011010: 536e 6f77 666c 616b 6520 646f 6375 6d65  Snowflake docume
-00011020: 6e74 6174 696f 6e20 6f6e 0a20 2020 2060  ntation on.    `
-00011030: 636f 6c6c 6174 696f 6e20 7370 6563 6966  collation specif
-00011040: 6963 6174 696f 6e73 203c 6874 7470 733a  ications <https:
-00011050: 2f2f 646f 6373 2e73 6e6f 7766 6c61 6b65  //docs.snowflake
-00011060: 2e63 6f6d 2f65 6e2f 7371 6c2d 7265 6665  .com/en/sql-refe
-00011070: 7265 6e63 652f 636f 6c6c 6174 696f 6e2e  rence/collation.
-00011080: 6874 6d6c 236c 6162 656c 2d63 6f6c 6c61  html#label-colla
-00011090: 7469 6f6e 2d73 7065 6369 6669 6361 7469  tion-specificati
-000110a0: 6f6e 3e60 5f2e 0a0a 2020 2020 4578 616d  on>`_...    Exam
-000110b0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-000110c0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000110d0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000110e0: 5b27 c3b1 275d 2c20 7363 6865 6d61 3d5b  ['..'], schema=[
-000110f0: 2776 275d 290a 2020 2020 2020 2020 3e3e  'v']).        >>
-00011100: 3e20 6466 2e73 656c 6563 7428 6466 2e76  > df.select(df.v
-00011110: 203d 3d20 6c69 7428 27c3 9127 292c 2063   == lit('..'), c
-00011120: 6f6c 6c61 7465 2864 662e 762c 2027 7370  ollate(df.v, 'sp
-00011130: 2d75 7070 6572 2729 203d 3d20 6c69 7428  -upper') == lit(
-00011140: 27c3 9127 2929 2e73 686f 7728 290a 2020  '..')).show().  
-00011150: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00011160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011170: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011180: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011190: 0a20 2020 2020 2020 207c 2228 2222 5622  .        |"(""V"
-000111a0: 2220 3d20 27c3 9127 2922 2020 7c22 2843  " = '..')"  |"(C
-000111b0: 4f4c 4c41 5445 2822 2256 2222 2c20 2753  OLLATE(""V"", 'S
-000111c0: 502d 5550 5045 5227 2920 3d20 27c3 9127  P-UPPER') = '..'
-000111d0: 2922 2020 7c0a 2020 2020 2020 2020 2d2d  )"  |.        --
-000111e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000111f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011210: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00011220: 207c 4661 6c73 6520 2020 2020 2020 2020   |False         
-00011230: 2020 207c 5472 7565 2020 2020 2020 2020     |True        
-00011240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011250: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00011260: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00011270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-000112a0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000112b0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-000112c0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000112d0: 7228 652c 2022 636f 6c6c 6174 6522 290a  r(e, "collate").
-000112e0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000112f0: 696e 2822 636f 6c6c 6174 6522 2928 632c  in("collate")(c,
-00011300: 2063 6f6c 6c61 7469 6f6e 5f73 7065 6329   collation_spec)
-00011310: 0a0a 0a64 6566 2063 6f6c 6c61 7469 6f6e  ...def collation
-00011320: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00011330: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00011340: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00011350: 636f 6c6c 6174 696f 6e20 7370 6563 6966  collation specif
-00011360: 6963 6174 696f 6e20 6f66 2065 7870 722e  ication of expr.
-00011370: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00011380: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00011390: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-000113a0: 6461 7461 6672 616d 6528 5b27 c3b1 275d  dataframe(['..']
-000113b0: 2c20 7363 6865 6d61 3d5b 2776 275d 290a  , schema=['v']).
-000113c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000113d0: 656c 6563 7428 636f 6c6c 6174 696f 6e28  elect(collation(
-000113e0: 636f 6c6c 6174 6528 6466 2e76 2c20 2773  collate(df.v, 's
-000113f0: 702d 7570 7065 7227 2929 292e 7368 6f77  p-upper'))).show
-00011400: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00011410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011430: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00011440: 2243 4f4c 4c41 5449 4f4e 2843 4f4c 4c41  "COLLATION(COLLA
-00011450: 5445 2822 2256 2222 2c20 2753 502d 5550  TE(""V"", 'SP-UP
-00011460: 5045 5227 2929 2220 207c 0a20 2020 2020  PER'))"  |.     
-00011470: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00011480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-000114a0: 2020 2020 2020 207c 7370 2d75 7070 6572         |sp-upper
-000114b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114d0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000114e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000114f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011500: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00011510: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00011520: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00011530: 6f6c 5f69 665f 7374 7228 652c 2022 636f  ol_if_str(e, "co
-00011540: 6c6c 6174 696f 6e22 290a 2020 2020 7265  llation").    re
-00011550: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
-00011560: 6c6c 6174 696f 6e22 2928 6329 0a0a 0a64  llation")(c)...d
-00011570: 6566 2063 6f6e 6361 7428 2a63 6f6c 733a  ef concat(*cols:
-00011580: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00011590: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000115a0: 2243 6f6e 6361 7465 6e61 7465 7320 6f6e  "Concatenates on
-000115b0: 6520 6f72 206d 6f72 6520 7374 7269 6e67  e or more string
-000115c0: 732c 206f 7220 636f 6e63 6174 656e 6174  s, or concatenat
-000115d0: 6573 206f 6e65 206f 7220 6d6f 7265 2062  es one or more b
-000115e0: 696e 6172 7920 7661 6c75 6573 2e20 4966  inary values. If
-000115f0: 2061 6e79 206f 6620 7468 6520 7661 6c75   any of the valu
-00011600: 6573 2069 7320 6e75 6c6c 2c20 7468 6520  es is null, the 
-00011610: 7265 7375 6c74 2069 7320 616c 736f 206e  result is also n
-00011620: 756c 6c2e 0a0a 2020 2020 4578 616d 706c  ull...    Exampl
-00011630: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-00011640: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00011650: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00011660: 2748 656c 6c6f 272c 2027 576f 726c 6427  'Hello', 'World'
-00011670: 5d5d 2c20 7363 6865 6d61 3d5b 2761 272c  ]], schema=['a',
-00011680: 2027 6227 5d29 0a20 2020 2020 2020 203e   'b']).        >
-00011690: 3e3e 2064 662e 7365 6c65 6374 2863 6f6e  >> df.select(con
-000116a0: 6361 7428 6466 2e61 2c20 6466 2e62 2929  cat(df.a, df.b))
-000116b0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-000116c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000116d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000116e0: 2020 207c 2243 4f4e 4341 5428 2222 4122     |"CONCAT(""A"
-000116f0: 222c 2022 2242 2222 2922 2020 7c0a 2020  ", ""B"")"  |.  
-00011700: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00011710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011720: 0a20 2020 2020 2020 207c 4865 6c6c 6f57  .        |HelloW
-00011730: 6f72 6c64 2020 2020 2020 2020 2020 2020  orld            
-00011740: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00011750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011760: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00011770: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00011780: 2222 0a0a 2020 2020 636f 6c75 6d6e 7320  ""..    columns 
-00011790: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
-000117a0: 7228 632c 2022 636f 6e63 6174 2229 2066  r(c, "concat") f
-000117b0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
-000117c0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-000117d0: 2822 636f 6e63 6174 2229 282a 636f 6c75  ("concat")(*colu
-000117e0: 6d6e 7329 0a0a 0a64 6566 2063 6f6e 6361  mns)...def conca
-000117f0: 745f 7773 282a 636f 6c73 3a20 436f 6c75  t_ws(*cols: Colu
-00011800: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00011810: 756d 6e3a 0a20 2020 2022 2222 436f 6e63  umn:.    """Conc
-00011820: 6174 656e 6174 6573 2074 776f 206f 7220  atenates two or 
-00011830: 6d6f 7265 2073 7472 696e 6773 2c20 6f72  more strings, or
-00011840: 2063 6f6e 6361 7465 6e61 7465 7320 7477   concatenates tw
-00011850: 6f20 6f72 206d 6f72 6520 6269 6e61 7279  o or more binary
-00011860: 2076 616c 7565 732e 2049 6620 616e 7920   values. If any 
-00011870: 6f66 2074 6865 2076 616c 7565 7320 6973  of the values is
-00011880: 206e 756c 6c2c 2074 6865 2072 6573 756c   null, the resul
-00011890: 7420 6973 2061 6c73 6f20 6e75 6c6c 2e0a  t is also null..
-000118a0: 2020 2020 5468 6520 434f 4e43 4154 5f57      The CONCAT_W
-000118b0: 5320 6f70 6572 6174 6f72 2072 6571 7569  S operator requi
-000118c0: 7265 7320 6174 206c 6561 7374 2074 776f  res at least two
-000118d0: 2061 7267 756d 656e 7473 2c20 616e 6420   arguments, and 
-000118e0: 7573 6573 2074 6865 2066 6972 7374 2061  uses the first a
-000118f0: 7267 756d 656e 7420 746f 2073 6570 6172  rgument to separ
-00011900: 6174 6520 616c 6c20 666f 6c6c 6f77 696e  ate all followin
-00011910: 6720 6172 6775 6d65 6e74 732e 0a0a 2020  g arguments...  
-00011920: 2020 4578 616d 706c 6573 3a3a 0a20 2020    Examples::.   
-00011930: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00011940: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00011950: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-00011960: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
-00011970: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00011980: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00011990: 5b5b 2748 656c 6c6f 272c 2027 576f 726c  [['Hello', 'Worl
-000119a0: 6427 5d5d 2c20 7363 6865 6d61 3d5b 2761  d']], schema=['a
-000119b0: 272c 2027 6227 5d29 0a20 2020 2020 2020  ', 'b']).       
-000119c0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-000119d0: 6f6e 6361 745f 7773 286c 6974 2827 2c27  oncat_ws(lit(','
-000119e0: 292c 2064 662e 612c 2064 662e 6229 292e  ), df.a, df.b)).
-000119f0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00011a00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011a20: 2d0a 2020 2020 2020 2020 7c22 434f 4e43  -.        |"CONC
-00011a30: 4154 5f57 5328 272c 272c 2022 2241 2222  AT_WS(',', ""A""
-00011a40: 2c20 2222 4222 2229 2220 207c 0a20 2020  , ""B"")"  |.   
-00011a50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00011a60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011a70: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011a80: 7c48 656c 6c6f 2c57 6f72 6c64 2020 2020  |Hello,World    
-00011a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011aa0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00011ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00011ad0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00011ae0: 3e0a 0a20 2020 2020 2020 203e 3e3e 2064  >..        >>> d
-00011af0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00011b00: 7465 5f64 6174 6166 7261 6d65 285b 5b27  te_dataframe([['
-00011b10: 4865 6c6c 6f27 2c20 2757 6f72 6c64 272c  Hello', 'World',
-00011b20: 2027 2c27 5d5d 2c20 7363 6865 6d61 3d5b   ',']], schema=[
-00011b30: 2761 272c 2027 6227 2c20 2773 6570 275d  'a', 'b', 'sep']
-00011b40: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00011b50: 2e73 656c 6563 7428 636f 6e63 6174 5f77  .select(concat_w
-00011b60: 7328 2773 6570 272c 2064 662e 612c 2064  s('sep', df.a, d
-00011b70: 662e 6229 292e 7368 6f77 2829 0a20 2020  f.b)).show().   
-00011b80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00011b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00011bb0: 2020 2020 7c22 434f 4e43 4154 5f57 5328      |"CONCAT_WS(
-00011bc0: 2222 5345 5022 222c 2022 2241 2222 2c20  ""SEP"", ""A"", 
-00011bd0: 2222 4222 2229 2220 207c 0a20 2020 2020  ""B"")"  |.     
-00011be0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00011bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011c00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00011c10: 2020 7c48 656c 6c6f 2c57 6f72 6c64 2020    |Hello,World  
-00011c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c30: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00011c40: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00011c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011c60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011c70: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00011c80: 2222 220a 2020 2020 636f 6c75 6d6e 7320  """.    columns 
-00011c90: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
-00011ca0: 7228 632c 2022 636f 6e63 6174 5f77 7322  r(c, "concat_ws"
-00011cb0: 2920 666f 7220 6320 696e 2063 6f6c 735d  ) for c in cols]
-00011cc0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00011cd0: 7469 6e28 2263 6f6e 6361 745f 7773 2229  tin("concat_ws")
-00011ce0: 282a 636f 6c75 6d6e 7329 0a0a 0a64 6566  (*columns)...def
-00011cf0: 2074 7261 6e73 6c61 7465 280a 2020 2020   translate(.    
-00011d00: 7372 633a 2043 6f6c 756d 6e4f 724e 616d  src: ColumnOrNam
-00011d10: 652c 0a20 2020 2073 6f75 7263 655f 616c  e,.    source_al
-00011d20: 7068 6162 6574 3a20 436f 6c75 6d6e 4f72  phabet: ColumnOr
-00011d30: 4e61 6d65 2c0a 2020 2020 7461 7267 6574  Name,.    target
-00011d40: 5f61 6c70 6861 6265 743a 2043 6f6c 756d  _alphabet: Colum
-00011d50: 6e4f 724e 616d 652c 0a29 202d 3e20 436f  nOrName,.) -> Co
-00011d60: 6c75 6d6e 3a0a 2020 2020 2222 2254 7261  lumn:.    """Tra
-00011d70: 6e73 6c61 7465 7320 7372 6320 6672 6f6d  nslates src from
-00011d80: 2074 6865 2063 6861 7261 6374 6572 7320   the characters 
-00011d90: 696e 2073 6f75 7263 655f 616c 7068 6162  in source_alphab
-00011da0: 6574 2074 6f20 7468 6520 6368 6172 6163  et to the charac
-00011db0: 7465 7273 2069 6e0a 2020 2020 7461 7267  ters in.    targ
-00011dc0: 6574 5f61 6c70 6861 6265 742e 2045 6163  et_alphabet. Eac
-00011dd0: 6820 6368 6172 6163 7465 7220 6d61 7463  h character matc
-00011de0: 6869 6e67 2061 2063 6861 7261 6374 6572  hing a character
-00011df0: 2061 7420 706f 7369 7469 6f6e 2069 2069   at position i i
-00011e00: 6e20 7468 6520 736f 7572 6365 5f61 6c70  n the source_alp
-00011e10: 6861 6265 7420 6973 2072 6570 6c61 6365  habet is replace
-00011e20: 640a 2020 2020 7769 7468 2074 6865 2063  d.    with the c
-00011e30: 6861 7261 6374 6572 2061 7420 706f 7369  haracter at posi
-00011e40: 7469 6f6e 2069 2069 6e20 7468 6520 7461  tion i in the ta
-00011e50: 7267 6574 5f61 6c70 6861 6265 742e 2049  rget_alphabet. I
-00011e60: 6620 7461 7267 6574 5f61 6c70 6861 6265  f target_alphabe
-00011e70: 7420 6973 2073 686f 7274 6572 2c20 616e  t is shorter, an
-00011e80: 6420 7468 6572 6520 6973 206e 6f20 636f  d there is no co
-00011e90: 7272 6573 706f 6e64 696e 670a 2020 2020  rresponding.    
-00011ea0: 6368 6172 6163 7465 7220 7468 6520 6368  character the ch
-00011eb0: 6172 6163 7465 7220 6973 206f 6d69 7474  aracter is omitt
-00011ec0: 6564 2e20 7461 7267 6574 5f61 6c70 6861  ed. target_alpha
-00011ed0: 6265 7420 6361 6e20 6e6f 7420 6265 206c  bet can not be l
-00011ee0: 6f6e 6765 7220 7468 616e 2073 6f75 7263  onger than sourc
-00011ef0: 655f 616c 7068 6162 6574 2e0a 0a20 2020  e_alphabet...   
-00011f00: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00011f10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00011f20: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00011f30: 6672 616d 6528 5b22 6162 6364 6566 222c  frame(["abcdef",
-00011f40: 2022 6162 6261 225d 2c20 7363 6865 6d61   "abba"], schema
-00011f50: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00011f60: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
-00011f70: 616e 736c 6174 6528 636f 6c28 2261 2229  anslate(col("a")
-00011f80: 2c20 6c69 7428 2261 6263 2229 2c20 6c69  , lit("abc"), li
-00011f90: 7428 2241 4243 2229 292e 6173 5f28 2261  t("ABC")).as_("a
-00011fa0: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
-00011fb0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-00011fc0: 3d27 4142 4364 6566 2729 2c20 526f 7728  ='ABCdef'), Row(
-00011fd0: 414e 533d 2741 4242 4127 295d 0a0a 2020  ANS='ABBA')]..  
-00011fe0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00011ff0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00012000: 7461 6672 616d 6528 5b22 6669 6c65 2077  taframe(["file w
-00012010: 6974 6820 7370 6163 6573 2e74 7874 222c  ith spaces.txt",
-00012020: 2022 5c5c 7474 6573 7422 5d2c 2073 6368   "\\ttest"], sch
-00012030: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00012040: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00012050: 2874 7261 6e73 6c61 7465 2863 6f6c 2822  (translate(col("
-00012060: 6122 292c 206c 6974 2822 205c 5c74 2229  a"), lit(" \\t")
-00012070: 2c20 6c69 7428 225f 2229 292e 6173 5f28  , lit("_")).as_(
-00012080: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-00012090: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-000120a0: 4e53 3d27 6669 6c65 5f77 6974 685f 7370  NS='file_with_sp
-000120b0: 6163 6573 2e74 7874 2729 2c20 526f 7728  aces.txt'), Row(
-000120c0: 414e 533d 2774 6573 7427 295d 0a0a 2020  ANS='test')]..  
-000120d0: 2020 2222 220a 2020 2020 736f 7572 6365    """.    source
-000120e0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000120f0: 7228 7372 632c 2022 7472 616e 736c 6174  r(src, "translat
-00012100: 6522 290a 2020 2020 736f 7572 6365 5f61  e").    source_a
-00012110: 6c70 6861 6265 7420 3d20 5f74 6f5f 636f  lphabet = _to_co
-00012120: 6c5f 6966 5f73 7472 2873 6f75 7263 655f  l_if_str(source_
-00012130: 616c 7068 6162 6574 2c20 2274 7261 6e73  alphabet, "trans
-00012140: 6c61 7465 2229 0a20 2020 2074 6172 6765  late").    targe
-00012150: 745f 616c 7068 6162 6574 203d 205f 746f  t_alphabet = _to
-00012160: 5f63 6f6c 5f69 665f 7374 7228 7461 7267  _col_if_str(targ
-00012170: 6574 5f61 6c70 6861 6265 742c 2022 7472  et_alphabet, "tr
-00012180: 616e 736c 6174 6522 290a 2020 2020 7265  anslate").    re
-00012190: 7475 726e 2062 7569 6c74 696e 2822 7472  turn builtin("tr
-000121a0: 616e 736c 6174 6522 2928 736f 7572 6365  anslate")(source
-000121b0: 2c20 736f 7572 6365 5f61 6c70 6861 6265  , source_alphabe
-000121c0: 742c 2074 6172 6765 745f 616c 7068 6162  t, target_alphab
-000121d0: 6574 290a 0a0a 6465 6620 636f 6e74 6169  et)...def contai
-000121e0: 6e73 2863 6f6c 3a20 436f 6c75 6d6e 4f72  ns(col: ColumnOr
-000121f0: 4e61 6d65 2c20 7374 7269 6e67 3a20 436f  Name, string: Co
-00012200: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00012210: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00012220: 7475 726e 7320 6966 2060 636f 6c60 2063  turns if `col` c
-00012230: 6f6e 7461 696e 7320 6073 7472 696e 6760  ontains `string`
-00012240: 2066 6f72 2065 6163 6820 726f 772e 2053   for each row. S
-00012250: 6565 2060 434f 4e54 4149 4e53 203c 6874  ee `CONTAINS <ht
-00012260: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
-00012270: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
-00012280: 7265 6665 7265 6e63 652f 6675 6e63 7469  reference/functi
-00012290: 6f6e 732f 636f 6e74 6169 6e73 3e60 0a0a  ons/contains>`..
-000122a0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-000122b0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000122c0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000122d0: 6166 7261 6d65 285b 5b31 2c32 5d2c 205b  aframe([[1,2], [
-000122e0: 332c 345d 2c20 5b35 2c35 5d20 5d2c 2073  3,4], [5,5] ], s
-000122f0: 6368 656d 613d 5b22 6122 2c22 6222 5d29  chema=["a","b"])
-00012300: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00012310: 7365 6c65 6374 2863 6f6e 7461 696e 7328  select(contains(
-00012320: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
-00012330: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-00012340: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00012350: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00012360: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-00012370: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-00012380: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00012390: 2020 207c 4661 6c73 6520 2020 2020 7c0a     |False     |.
-000123a0: 2020 2020 2020 2020 7c46 616c 7365 2020          |False  
-000123b0: 2020 207c 0a20 2020 2020 2020 207c 5472     |.        |Tr
-000123c0: 7565 2020 2020 2020 7c0a 2020 2020 2020  ue      |.      
-000123d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-000123e0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000123f0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-00012400: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00012410: 7228 636f 6c2c 2022 636f 6e74 6169 6e73  r(col, "contains
-00012420: 2229 0a20 2020 2073 203d 205f 746f 5f63  ").    s = _to_c
-00012430: 6f6c 5f69 665f 7374 7228 7374 7269 6e67  ol_if_str(string
-00012440: 2c20 2263 6f6e 7461 696e 7322 290a 2020  , "contains").  
-00012450: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00012460: 2822 636f 6e74 6169 6e73 2229 2863 2c20  ("contains")(c, 
-00012470: 7329 0a0a 0a64 6566 2073 7461 7274 7377  s)...def startsw
-00012480: 6974 6828 636f 6c3a 2043 6f6c 756d 6e4f  ith(col: ColumnO
-00012490: 724e 616d 652c 2073 7472 3a20 436f 6c75  rName, str: Colu
-000124a0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000124b0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000124c0: 726e 7320 7472 7565 2069 6620 636f 6c20  rns true if col 
-000124d0: 7374 6172 7473 2077 6974 6820 7374 722e  starts with str.
-000124e0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-000124f0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-00012500: 2273 7461 7274 7377 6974 6822 290a 2020  "startswith").  
-00012510: 2020 7320 3d20 5f74 6f5f 636f 6c5f 6966    s = _to_col_if
-00012520: 5f73 7472 2873 7472 2c20 2273 7461 7274  _str(str, "start
-00012530: 7377 6974 6822 290a 2020 2020 7265 7475  swith").    retu
-00012540: 726e 2062 7569 6c74 696e 2822 7374 6172  rn builtin("star
-00012550: 7473 7769 7468 2229 2863 2c20 7329 0a0a  tswith")(c, s)..
-00012560: 0a64 6566 2065 6e64 7377 6974 6828 636f  .def endswith(co
-00012570: 6c3a 2043 6f6c 756d 6e4f 724e 616d 652c  l: ColumnOrName,
-00012580: 2073 7472 3a20 436f 6c75 6d6e 4f72 4e61   str: ColumnOrNa
-00012590: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-000125a0: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-000125b0: 6e73 2074 7275 6520 6966 2063 6f6c 2065  ns true if col e
-000125c0: 6e64 7320 7769 7468 2073 7472 2e0a 0a20  nds with str... 
-000125d0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-000125e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000125f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00012600: 7461 6672 616d 6528 5b22 6170 706c 6522  taframe(["apple"
-00012610: 2c20 2262 616e 616e 6122 2c20 2270 6561  , "banana", "pea
-00012620: 6368 225d 2c20 7363 6865 6d61 3d5b 2261  ch"], schema=["a
-00012630: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00012640: 6466 2e73 656c 6563 7428 656e 6473 7769  df.select(endswi
-00012650: 7468 2864 665b 2261 225d 2c20 6c69 7428  th(df["a"], lit(
-00012660: 2261 6e61 2229 292e 616c 6961 7328 2265  "ana")).alias("e
-00012670: 6e64 7377 6974 6822 2929 2e63 6f6c 6c65  ndswith")).colle
-00012680: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00012690: 7728 454e 4453 5749 5448 3d46 616c 7365  w(ENDSWITH=False
-000126a0: 292c 2052 6f77 2845 4e44 5357 4954 483d  ), Row(ENDSWITH=
-000126b0: 5472 7565 292c 2052 6f77 2845 4e44 5357  True), Row(ENDSW
-000126c0: 4954 483d 4661 6c73 6529 5d0a 2020 2020  ITH=False)].    
-000126d0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-000126e0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-000126f0: 2265 6e64 7377 6974 6822 290a 2020 2020  "endswith").    
-00012700: 7320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  s = _to_col_if_s
-00012710: 7472 2873 7472 2c20 2265 6e64 7377 6974  tr(str, "endswit
-00012720: 6822 290a 2020 2020 7265 7475 726e 2062  h").    return b
-00012730: 7569 6c74 696e 2822 656e 6473 7769 7468  uiltin("endswith
-00012740: 2229 2863 2c20 7329 0a0a 0a64 6566 2069  ")(c, s)...def i
-00012750: 6e73 6572 7428 0a20 2020 2062 6173 655f  nsert(.    base_
-00012760: 6578 7072 3a20 436f 6c75 6d6e 4f72 4e61  expr: ColumnOrNa
-00012770: 6d65 2c0a 2020 2020 706f 7369 7469 6f6e  me,.    position
-00012780: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
-00012790: 696e 745d 2c0a 2020 2020 6c65 6e67 7468  int],.    length
-000127a0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
-000127b0: 696e 745d 2c0a 2020 2020 696e 7365 7274  int],.    insert
-000127c0: 5f65 7870 723a 2043 6f6c 756d 6e4f 724e  _expr: ColumnOrN
-000127d0: 616d 652c 0a29 202d 3e20 436f 6c75 6d6e  ame,.) -> Column
-000127e0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-000127f0: 706c 6163 6573 2061 2073 7562 7374 7269  places a substri
-00012800: 6e67 206f 6620 7468 6520 7370 6563 6966  ng of the specif
-00012810: 6965 6420 6c65 6e67 7468 2c20 7374 6172  ied length, star
-00012820: 7469 6e67 2061 7420 7468 6520 7370 6563  ting at the spec
-00012830: 6966 6965 6420 706f 7369 7469 6f6e 2c0a  ified position,.
-00012840: 2020 2020 7769 7468 2061 206e 6577 2073      with a new s
-00012850: 7472 696e 6720 6f72 2062 696e 6172 7920  tring or binary 
-00012860: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
-00012870: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
-00012880: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00012890: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-000128a0: 6528 5b22 6162 6322 5d2c 2073 6368 656d  e(["abc"], schem
-000128b0: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-000128c0: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
-000128d0: 6e73 6572 7428 6466 5b22 6122 5d2c 2031  nsert(df["a"], 1
-000128e0: 2c20 322c 206c 6974 2822 5a22 2929 2e61  , 2, lit("Z")).a
-000128f0: 6c69 6173 2822 696e 7365 7274 2229 292e  lias("insert")).
-00012900: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00012910: 2020 5b52 6f77 2849 4e53 4552 543d 275a    [Row(INSERT='Z
-00012920: 6327 295d 0a20 2020 2022 2222 0a20 2020  c')].    """.   
-00012930: 2062 203d 205f 746f 5f63 6f6c 5f69 665f   b = _to_col_if_
-00012940: 7374 7228 6261 7365 5f65 7870 722c 2022  str(base_expr, "
-00012950: 696e 7365 7274 2229 0a20 2020 2069 203d  insert").    i =
-00012960: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00012970: 696e 7365 7274 5f65 7870 722c 2022 696e  insert_expr, "in
-00012980: 7365 7274 2229 0a20 2020 2072 6574 7572  sert").    retur
-00012990: 6e20 6275 696c 7469 6e28 2269 6e73 6572  n builtin("inser
-000129a0: 7422 2928 622c 206c 6974 2870 6f73 6974  t")(b, lit(posit
-000129b0: 696f 6e29 2c20 6c69 7428 6c65 6e67 7468  ion), lit(length
-000129c0: 292c 2069 290a 0a0a 6465 6620 6c65 6674  ), i)...def left
-000129d0: 2873 7472 5f65 7870 723a 2043 6f6c 756d  (str_expr: Colum
-000129e0: 6e4f 724e 616d 652c 206c 656e 6774 683a  nOrName, length:
-000129f0: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
-00012a00: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
-00012a10: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-00012a20: 206c 6566 7420 6d6f 7374 2073 7562 7374   left most subst
-00012a30: 7269 6e67 206f 6620 6060 7374 725f 6578  ring of ``str_ex
-00012a40: 7072 6060 2e0a 0a20 2020 2045 7861 6d70  pr``...    Examp
-00012a50: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00012a60: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00012a70: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00012a80: 5b5b 2261 6263 225d 2c20 5b22 6465 6622  [["abc"], ["def"
-00012a90: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
-00012aa0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00012ab0: 2e73 656c 6563 7428 6c65 6674 2863 6f6c  .select(left(col
-00012ac0: 2822 6122 292c 2032 292e 616c 6961 7328  ("a"), 2).alias(
-00012ad0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00012ae0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00012af0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00012b00: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-00012b10: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00012b20: 0a20 2020 2020 2020 207c 6162 2020 2020  .        |ab    
-00012b30: 2020 2020 7c0a 2020 2020 2020 2020 7c64      |.        |d
-00012b40: 6520 2020 2020 2020 207c 0a20 2020 2020  e        |.     
-00012b50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00012b60: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00012b70: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-00012b80: 7320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  s = _to_col_if_s
-00012b90: 7472 2873 7472 5f65 7870 722c 2022 6c65  tr(str_expr, "le
-00012ba0: 6674 2229 0a20 2020 2072 6574 7572 6e20  ft").    return 
-00012bb0: 6275 696c 7469 6e28 226c 6566 7422 2928  builtin("left")(
-00012bc0: 732c 206c 6974 286c 656e 6774 6829 290a  s, lit(length)).
-00012bd0: 0a0a 6465 6620 7269 6768 7428 7374 725f  ..def right(str_
-00012be0: 6578 7072 3a20 436f 6c75 6d6e 4f72 4e61  expr: ColumnOrNa
-00012bf0: 6d65 2c20 6c65 6e67 7468 3a20 556e 696f  me, length: Unio
-00012c00: 6e5b 436f 6c75 6d6e 2c20 696e 745d 2920  n[Column, int]) 
-00012c10: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00012c20: 2222 5265 7475 726e 7320 6120 7269 6768  ""Returns a righ
-00012c30: 7420 6d6f 7374 2073 7562 7374 7269 6e67  t most substring
-00012c40: 206f 6620 6060 7374 725f 6578 7072 6060   of ``str_expr``
-00012c50: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00012c60: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00012c70: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00012c80: 655f 6461 7461 6672 616d 6528 5b5b 2261  e_dataframe([["a
-00012c90: 6263 225d 2c20 5b22 6465 6622 5d5d 2c20  bc"], ["def"]], 
-00012ca0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-00012cb0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00012cc0: 6563 7428 7269 6768 7428 636f 6c28 2261  ect(right(col("a
-00012cd0: 2229 2c20 3229 2e61 6c69 6173 2822 7265  "), 2).alias("re
-00012ce0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-00012cf0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00012d00: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-00012d10: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-00012d20: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00012d30: 2020 2020 2020 7c62 6320 2020 2020 2020        |bc       
-00012d40: 207c 0a20 2020 2020 2020 207c 6566 2020   |.        |ef  
+000028c0: 2020 2020 7c20 2031 2c20 207c 2020 2273      |  1,  |  "s
+000028d0: 6e6f 7722 3a20 2266 6c61 6b65 2220 207c  now": "flake"  |
+000028e0: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
+000028f0: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
+00002900: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
+00002910: 2020 2020 2020 207c 2020 2020 2020 2020         |        
+00002920: 2020 2020 7c20 2032 2020 207c 7d20 2020      |  2   |}   
+00002930: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00002940: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
+00002950: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
+00002960: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
+00002970: 2020 2020 2020 207c 2020 2020 2020 2020         |        
+00002980: 2020 2020 7c5d 2020 2020 207c 2020 2020      |]     |    
+00002990: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000029a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000029b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002a00: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00002a10: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00002a20: 2072 6574 7572 6e20 6c69 7465 7261 6c20   return literal 
+00002a30: 6966 2069 7369 6e73 7461 6e63 6528 6c69  if isinstance(li
+00002a40: 7465 7261 6c2c 2043 6f6c 756d 6e29 2065  teral, Column) e
+00002a50: 6c73 6520 436f 6c75 6d6e 284c 6974 6572  lse Column(Liter
+00002a60: 616c 286c 6974 6572 616c 2929 0a0a 0a64  al(literal))...d
+00002a70: 6566 2073 716c 5f65 7870 7228 7371 6c3a  ef sql_expr(sql:
+00002a80: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
+00002a90: 0a20 2020 2022 2222 4372 6561 7465 7320  .    """Creates 
+00002aa0: 6120 3a63 6c61 7373 3a60 7e73 6e6f 7766  a :class:`~snowf
+00002ab0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 436f  lake.snowpark.Co
+00002ac0: 6c75 6d6e 6020 6578 7072 6573 7369 6f6e  lumn` expression
+00002ad0: 2066 726f 6d20 7261 7720 5351 4c20 7465   from raw SQL te
+00002ae0: 7874 2e0a 2020 2020 4e6f 7465 2074 6861  xt..    Note tha
+00002af0: 7420 7468 6520 6675 6e63 7469 6f6e 2064  t the function d
+00002b00: 6f65 7320 6e6f 7420 696e 7465 7270 7265  oes not interpre
+00002b10: 7420 6f72 2063 6865 636b 2074 6865 2053  t or check the S
+00002b20: 514c 2074 6578 742e 0a0a 2020 2020 4578  QL text...    Ex
+00002b30: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00002b40: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00002b50: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00002b60: 6528 5b5b 312c 2032 5d2c 205b 332c 2034  e([[1, 2], [3, 4
+00002b70: 5d5d 2c20 7363 6865 6d61 3d5b 2241 222c  ]], schema=["A",
+00002b80: 2022 4222 5d29 0a20 2020 2020 2020 203e   "B"]).        >
+00002b90: 3e3e 2064 662e 6669 6c74 6572 2822 6120  >> df.filter("a 
+00002ba0: 3e20 3122 292e 636f 6c6c 6563 7428 2920  > 1").collect() 
+00002bb0: 2023 2075 7365 2053 514c 2065 7870 7265   # use SQL expre
+00002bc0: 7373 696f 6e0a 2020 2020 2020 2020 5b52  ssion.        [R
+00002bd0: 6f77 2841 3d33 2c20 423d 3429 5d0a 2020  ow(A=3, B=4)].  
+00002be0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00002bf0: 2043 6f6c 756d 6e2e 5f65 7870 7228 7371   Column._expr(sq
+00002c00: 6c29 0a0a 0a64 6566 2063 7572 7265 6e74  l)...def current
+00002c10: 5f73 6573 7369 6f6e 2829 202d 3e20 436f  _session() -> Co
+00002c20: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00002c30: 2020 5265 7475 726e 7320 6120 756e 6971    Returns a uniq
+00002c40: 7565 2073 7973 7465 6d20 6964 656e 7469  ue system identi
+00002c50: 6669 6572 2066 6f72 2074 6865 2053 6e6f  fier for the Sno
+00002c60: 7766 6c61 6b65 2073 6573 7369 6f6e 2063  wflake session c
+00002c70: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+00002c80: 7468 6520 7072 6573 656e 7420 636f 6e6e  the present conn
+00002c90: 6563 7469 6f6e 2e0a 2020 2020 5468 6973  ection..    This
+00002ca0: 2077 696c 6c20 6765 6e65 7261 6c6c 7920   will generally 
+00002cb0: 6265 2061 2073 7973 7465 6d2d 6765 6e65  be a system-gene
+00002cc0: 7261 7465 6420 616c 7068 616e 756d 6572  rated alphanumer
+00002cd0: 6963 2073 7472 696e 672e 2049 7420 6973  ic string. It is
+00002ce0: 204e 4f54 2064 6572 6976 6564 2066 726f   NOT derived fro
+00002cf0: 6d20 7468 6520 7573 6572 206e 616d 6520  m the user name 
+00002d00: 6f72 2075 7365 7220 6163 636f 756e 742e  or user account.
+00002d10: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
+00002d20: 2020 2020 2020 203e 3e3e 2023 2052 6574         >>> # Ret
+00002d30: 7572 6e20 7265 7375 6c74 2069 7320 7469  urn result is ti
+00002d40: 6564 2074 6f20 7365 7373 696f 6e2c 2073  ed to session, s
+00002d50: 6f20 7765 206f 6e6c 7920 7465 7374 2069  o we only test i
+00002d60: 6620 7468 6520 7265 7375 6c74 2065 7869  f the result exi
+00002d70: 7374 730a 2020 2020 2020 2020 3e3e 3e20  sts.        >>> 
+00002d80: 7265 7375 6c74 203d 2073 6573 7369 6f6e  result = session
+00002d90: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00002da0: 6528 5b31 5d29 2e73 656c 6563 7428 6375  e([1]).select(cu
+00002db0: 7272 656e 745f 7365 7373 696f 6e28 2929  rrent_session())
+00002dc0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00002dd0: 2020 203e 3e3e 2061 7373 6572 7420 7265     >>> assert re
+00002de0: 7375 6c74 5b30 5d5b 2743 5552 5245 4e54  sult[0]['CURRENT
+00002df0: 5f53 4553 5349 4f4e 2829 275d 2069 7320  _SESSION()'] is 
+00002e00: 6e6f 7420 4e6f 6e65 0a20 2020 2022 2222  not None.    """
+00002e10: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00002e20: 7469 6e28 2263 7572 7265 6e74 5f73 6573  tin("current_ses
+00002e30: 7369 6f6e 2229 2829 0a0a 0a64 6566 2063  sion")()...def c
+00002e40: 7572 7265 6e74 5f73 7461 7465 6d65 6e74  urrent_statement
+00002e50: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+00002e60: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+00002e70: 7320 7468 6520 5351 4c20 7465 7874 206f  s the SQL text o
+00002e80: 6620 7468 6520 7374 6174 656d 656e 7420  f the statement 
+00002e90: 7468 6174 2069 7320 6375 7272 656e 746c  that is currentl
+00002ea0: 7920 6578 6563 7574 696e 672e 0a0a 2020  y executing...  
+00002eb0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+00002ec0: 2020 203e 3e3e 2023 2052 6574 7572 6e20     >>> # Return 
+00002ed0: 7265 7375 6c74 2069 7320 7469 6564 2074  result is tied t
+00002ee0: 6f20 7365 7373 696f 6e2c 2073 6f20 7765  o session, so we
+00002ef0: 206f 6e6c 7920 7465 7374 2069 6620 7468   only test if th
+00002f00: 6520 7265 7375 6c74 2065 7869 7374 730a  e result exists.
+00002f10: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
+00002f20: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00002f30: 7261 6d65 285b 315d 292e 7365 6c65 6374  rame([1]).select
+00002f40: 2863 7572 7265 6e74 5f73 7461 7465 6d65  (current_stateme
+00002f50: 6e74 2829 292e 636f 6c6c 6563 7428 290a  nt()).collect().
+00002f60: 2020 2020 2020 2020 5b52 6f77 2843 5552          [Row(CUR
+00002f70: 5245 4e54 5f53 5441 5445 4d45 4e54 2829  RENT_STATEMENT()
+00002f80: 3d27 5345 4c45 4354 2063 7572 7265 6e74  ='SELECT current
+00002f90: 5f73 7461 7465 6d65 6e74 2829 2046 524f  _statement() FRO
+00002fa0: 4d20 2820 5345 4c45 4354 2022 5f31 2220  M ( SELECT "_1" 
+00002fb0: 4652 4f4d 2028 2053 454c 4543 5420 2431  FROM ( SELECT $1
+00002fc0: 2041 5320 225f 3122 2046 524f 4d20 2056   AS "_1" FROM  V
+00002fd0: 414c 5545 5320 2831 203a 3a20 494e 5429  ALUES (1 :: INT)
+00002fe0: 2929 2729 5d0a 2020 2020 2222 220a 2020  ))')].    """.  
+00002ff0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00003000: 2822 6375 7272 656e 745f 7374 6174 656d  ("current_statem
+00003010: 656e 7422 2928 290a 0a0a 6465 6620 6375  ent")()...def cu
+00003020: 7272 656e 745f 7573 6572 2829 202d 3e20  rrent_user() -> 
+00003030: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00003040: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00003050: 6e61 6d65 206f 6620 7468 6520 7573 6572  name of the user
+00003060: 2063 7572 7265 6e74 6c79 206c 6f67 6765   currently logge
+00003070: 6420 696e 746f 2074 6865 2073 7973 7465  d into the syste
+00003080: 6d2e 0a0a 2020 2020 4578 616d 706c 653a  m...    Example:
+00003090: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
+000030a0: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
+000030b0: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
+000030c0: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
+000030d0: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
+000030e0: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
+000030f0: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
+00003100: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00003110: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
+00003120: 6375 7272 656e 745f 7573 6572 2829 292e  current_user()).
+00003130: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00003140: 2020 3e3e 3e20 6173 7365 7274 2072 6573    >>> assert res
+00003150: 756c 745b 305d 5b27 4355 5252 454e 545f  ult[0]['CURRENT_
+00003160: 5553 4552 2829 275d 2069 7320 6e6f 7420  USER()'] is not 
+00003170: 4e6f 6e65 0a20 2020 2022 2222 0a20 2020  None.    """.   
+00003180: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00003190: 2263 7572 7265 6e74 5f75 7365 7222 2928  "current_user")(
+000031a0: 290a 0a0a 6465 6620 6375 7272 656e 745f  )...def current_
+000031b0: 7665 7273 696f 6e28 2920 2d3e 2043 6f6c  version() -> Col
+000031c0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+000031d0: 2052 6574 7572 6e73 2074 6865 2063 7572   Returns the cur
+000031e0: 7265 6e74 2053 6e6f 7766 6c61 6b65 2076  rent Snowflake v
+000031f0: 6572 7369 6f6e 2e0a 0a20 2020 2045 7861  ersion...    Exa
+00003200: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00003210: 3e20 2320 5265 7475 726e 2072 6573 756c  > # Return resul
+00003220: 7420 6973 2074 6965 6420 746f 2073 6573  t is tied to ses
+00003230: 7369 6f6e 2c20 736f 2077 6520 6f6e 6c79  sion, so we only
+00003240: 2074 6573 7420 6966 2074 6865 2072 6573   test if the res
+00003250: 756c 7420 6578 6973 7473 0a20 2020 2020  ult exists.     
+00003260: 2020 203e 3e3e 2072 6573 756c 7420 3d20     >>> result = 
+00003270: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00003280: 6174 6166 7261 6d65 285b 315d 292e 7365  ataframe([1]).se
+00003290: 6c65 6374 2863 7572 7265 6e74 5f76 6572  lect(current_ver
+000032a0: 7369 6f6e 2829 292e 636f 6c6c 6563 7428  sion()).collect(
+000032b0: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
+000032c0: 7365 7274 2072 6573 756c 745b 305d 5b27  sert result[0]['
+000032d0: 4355 5252 454e 545f 5645 5253 494f 4e28  CURRENT_VERSION(
+000032e0: 2927 5d20 6973 206e 6f74 204e 6f6e 650a  )'] is not None.
+000032f0: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+00003300: 726e 2062 7569 6c74 696e 2822 6375 7272  rn builtin("curr
+00003310: 656e 745f 7665 7273 696f 6e22 2928 290a  ent_version")().
+00003320: 0a0a 6465 6620 6375 7272 656e 745f 7761  ..def current_wa
+00003330: 7265 686f 7573 6528 2920 2d3e 2043 6f6c  rehouse() -> Col
+00003340: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00003350: 2052 6574 7572 6e73 2074 6865 206e 616d   Returns the nam
+00003360: 6520 6f66 2074 6865 2077 6172 6568 6f75  e of the warehou
+00003370: 7365 2069 6e20 7573 6520 666f 7220 7468  se in use for th
+00003380: 6520 6375 7272 656e 7420 7365 7373 696f  e current sessio
+00003390: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
+000033a0: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
+000033b0: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
+000033c0: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
+000033d0: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
+000033e0: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
+000033f0: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
+00003400: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
+00003410: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00003420: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
+00003430: 6375 7272 656e 745f 7761 7265 686f 7573  current_warehous
+00003440: 6528 2929 2e63 6f6c 6c65 6374 2829 0a20  e()).collect(). 
+00003450: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
+00003460: 7420 7265 7375 6c74 5b30 5d5b 2743 5552  t result[0]['CUR
+00003470: 5245 4e54 5f57 4152 4548 4f55 5345 2829  RENT_WAREHOUSE()
+00003480: 275d 2069 7320 6e6f 7420 4e6f 6e65 0a20  '] is not None. 
+00003490: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+000034a0: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
+000034b0: 6e74 5f77 6172 6568 6f75 7365 2229 2829  nt_warehouse")()
+000034c0: 0a0a 0a64 6566 2063 7572 7265 6e74 5f64  ...def current_d
+000034d0: 6174 6162 6173 6528 2920 2d3e 2043 6f6c  atabase() -> Col
+000034e0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+000034f0: 726e 7320 7468 6520 6e61 6d65 206f 6620  rns the name of 
+00003500: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
+00003510: 7573 6520 666f 7220 7468 6520 6375 7272  use for the curr
+00003520: 656e 7420 7365 7373 696f 6e2e 0a0a 2020  ent session...  
+00003530: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+00003540: 2020 203e 3e3e 2023 2052 6574 7572 6e20     >>> # Return 
+00003550: 7265 7375 6c74 2069 7320 7469 6564 2074  result is tied t
+00003560: 6f20 7365 7373 696f 6e2c 2073 6f20 7765  o session, so we
+00003570: 206f 6e6c 7920 7465 7374 2069 6620 7468   only test if th
+00003580: 6520 7265 7375 6c74 2065 7869 7374 730a  e result exists.
+00003590: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
+000035a0: 6c74 203d 2073 6573 7369 6f6e 2e63 7265  lt = session.cre
+000035b0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+000035c0: 5d29 2e73 656c 6563 7428 6375 7272 656e  ]).select(curren
+000035d0: 745f 6461 7461 6261 7365 2829 292e 636f  t_database()).co
+000035e0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000035f0: 3e3e 3e20 6173 7365 7274 2072 6573 756c  >>> assert resul
+00003600: 745b 305d 5b27 4355 5252 454e 545f 4441  t[0]['CURRENT_DA
+00003610: 5441 4241 5345 2829 275d 2069 7320 6e6f  TABASE()'] is no
+00003620: 7420 4e6f 6e65 0a20 2020 2022 2222 0a20  t None.    """. 
+00003630: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00003640: 6e28 2263 7572 7265 6e74 5f64 6174 6162  n("current_datab
+00003650: 6173 6522 2928 290a 0a0a 6465 6620 6375  ase")()...def cu
+00003660: 7272 656e 745f 726f 6c65 2829 202d 3e20  rrent_role() -> 
+00003670: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00003680: 6574 7572 6e73 2074 6865 206e 616d 6520  eturns the name 
+00003690: 6f66 2074 6865 2072 6f6c 6520 696e 2075  of the role in u
+000036a0: 7365 2066 6f72 2074 6865 2063 7572 7265  se for the curre
+000036b0: 6e74 2073 6573 7369 6f6e 2e0a 0a20 2020  nt session...   
+000036c0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+000036d0: 2020 3e3e 3e20 2320 5265 7475 726e 2072    >>> # Return r
+000036e0: 6573 756c 7420 6973 2074 6965 6420 746f  esult is tied to
+000036f0: 2073 6573 7369 6f6e 2c20 736f 2077 6520   session, so we 
+00003700: 6f6e 6c79 2074 6573 7420 6966 2074 6865  only test if the
+00003710: 2072 6573 756c 7420 6578 6973 7473 0a20   result exists. 
+00003720: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+00003730: 7420 3d20 7365 7373 696f 6e2e 6372 6561  t = session.crea
+00003740: 7465 5f64 6174 6166 7261 6d65 285b 315d  te_dataframe([1]
+00003750: 292e 7365 6c65 6374 2863 7572 7265 6e74  ).select(current
+00003760: 5f72 6f6c 6528 2929 2e63 6f6c 6c65 6374  _role()).collect
+00003770: 2829 0a20 2020 2020 2020 203e 3e3e 2061  ().        >>> a
+00003780: 7373 6572 7420 7265 7375 6c74 5b30 5d5b  ssert result[0][
+00003790: 2743 5552 5245 4e54 5f52 4f4c 4528 2927  'CURRENT_ROLE()'
+000037a0: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
+000037b0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+000037c0: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
+000037d0: 745f 726f 6c65 2229 2829 0a0a 0a64 6566  t_role")()...def
+000037e0: 2063 7572 7265 6e74 5f73 6368 656d 6128   current_schema(
+000037f0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00003800: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+00003810: 6e61 6d65 206f 6620 7468 6520 7363 6865  name of the sche
+00003820: 6d61 2069 6e20 7573 6520 666f 7220 7468  ma in use for th
+00003830: 6520 6375 7272 656e 7420 7365 7373 696f  e current sessio
+00003840: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
+00003850: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
+00003860: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
+00003870: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
+00003880: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
+00003890: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
+000038a0: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
+000038b0: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
+000038c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000038d0: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
+000038e0: 6375 7272 656e 745f 7363 6865 6d61 2829  current_schema()
+000038f0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00003900: 2020 2020 3e3e 3e20 6173 7365 7274 2072      >>> assert r
+00003910: 6573 756c 745b 305d 5b27 4355 5252 454e  esult[0]['CURREN
+00003920: 545f 5343 4845 4d41 2829 275d 2069 7320  T_SCHEMA()'] is 
+00003930: 6e6f 7420 4e6f 6e65 0a20 2020 2022 2222  not None.    """
+00003940: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00003950: 7469 6e28 2263 7572 7265 6e74 5f73 6368  tin("current_sch
+00003960: 656d 6122 2928 290a 0a0a 6465 6620 6375  ema")()...def cu
+00003970: 7272 656e 745f 7363 6865 6d61 7328 2920  rrent_schemas() 
+00003980: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00003990: 2222 5265 7475 726e 7320 6163 7469 7665  ""Returns active
+000039a0: 2073 6561 7263 6820 7061 7468 2073 6368   search path sch
+000039b0: 656d 6173 2e0a 0a20 2020 2045 7861 6d70  emas...    Examp
+000039c0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+000039d0: 2320 5265 7475 726e 2072 6573 756c 7420  # Return result 
+000039e0: 6973 2074 6965 6420 746f 2073 6573 7369  is tied to sessi
+000039f0: 6f6e 2c20 736f 2077 6520 6f6e 6c79 2074  on, so we only t
+00003a00: 6573 7420 6966 2074 6865 2072 6573 756c  est if the resul
+00003a10: 7420 6578 6973 7473 0a20 2020 2020 2020  t exists.       
+00003a20: 203e 3e3e 2072 6573 756c 7420 3d20 7365   >>> result = se
+00003a30: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00003a40: 6166 7261 6d65 285b 315d 292e 7365 6c65  aframe([1]).sele
+00003a50: 6374 2863 7572 7265 6e74 5f73 6368 656d  ct(current_schem
+00003a60: 6173 2829 292e 636f 6c6c 6563 7428 290a  as()).collect().
+00003a70: 2020 2020 2020 2020 3e3e 3e20 6173 7365          >>> asse
+00003a80: 7274 2072 6573 756c 745b 305d 5b27 4355  rt result[0]['CU
+00003a90: 5252 454e 545f 5343 4845 4d41 5328 2927  RRENT_SCHEMAS()'
+00003aa0: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
+00003ab0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00003ac0: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
+00003ad0: 745f 7363 6865 6d61 7322 2928 290a 0a0a  t_schemas")()...
+00003ae0: 6465 6620 6375 7272 656e 745f 7265 6769  def current_regi
+00003af0: 6f6e 2829 202d 3e20 436f 6c75 6d6e 3a0a  on() -> Column:.
+00003b00: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00003b10: 6865 206e 616d 6520 6f66 2074 6865 2072  he name of the r
+00003b20: 6567 696f 6e20 666f 7220 7468 6520 6163  egion for the ac
+00003b30: 636f 756e 7420 7768 6572 6520 7468 6520  count where the 
+00003b40: 6375 7272 656e 7420 7573 6572 2069 7320  current user is 
+00003b50: 6c6f 6767 6564 2069 6e2e 0a0a 2020 2020  logged in...    
+00003b60: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00003b70: 203e 3e3e 2023 2052 6574 7572 6e20 7265   >>> # Return re
+00003b80: 7375 6c74 2069 7320 7469 6564 2074 6f20  sult is tied to 
+00003b90: 7365 7373 696f 6e2c 2073 6f20 7765 206f  session, so we o
+00003ba0: 6e6c 7920 7465 7374 2069 6620 7468 6520  nly test if the 
+00003bb0: 7265 7375 6c74 2065 7869 7374 730a 2020  result exists.  
+00003bc0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
+00003bd0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00003be0: 655f 6461 7461 6672 616d 6528 5b31 5d29  e_dataframe([1])
+00003bf0: 2e73 656c 6563 7428 6375 7272 656e 745f  .select(current_
+00003c00: 7265 6769 6f6e 2829 292e 636f 6c6c 6563  region()).collec
+00003c10: 7428 290a 2020 2020 2020 2020 3e3e 3e20  t().        >>> 
+00003c20: 6173 7365 7274 2072 6573 756c 745b 305d  assert result[0]
+00003c30: 5b27 4355 5252 454e 545f 5245 4749 4f4e  ['CURRENT_REGION
+00003c40: 2829 275d 2069 7320 6e6f 7420 4e6f 6e65  ()'] is not None
+00003c50: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
+00003c60: 7572 6e20 6275 696c 7469 6e28 2263 7572  urn builtin("cur
+00003c70: 7265 6e74 5f72 6567 696f 6e22 2928 290a  rent_region")().
+00003c80: 0a0a 6465 6620 6375 7272 656e 745f 6176  ..def current_av
+00003c90: 6169 6c61 626c 655f 726f 6c65 7328 2920  ailable_roles() 
+00003ca0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00003cb0: 2222 5265 7475 726e 7320 6120 4a53 4f4e  ""Returns a JSON
+00003cc0: 2073 7472 696e 6720 7468 6174 206c 6973   string that lis
+00003cd0: 7473 2061 6c6c 2072 6f6c 6573 2067 7261  ts all roles gra
+00003ce0: 6e74 6564 2074 6f20 7468 6520 6375 7272  nted to the curr
+00003cf0: 656e 7420 7573 6572 2e0a 0a20 2020 2045  ent user...    E
+00003d00: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00003d10: 3e3e 3e20 2320 5265 7475 726e 2072 6573  >>> # Return res
+00003d20: 756c 7420 6973 2074 6965 6420 746f 2073  ult is tied to s
+00003d30: 6573 7369 6f6e 2c20 736f 2077 6520 6f6e  ession, so we on
+00003d40: 6c79 2074 6573 7420 6966 2074 6865 2072  ly test if the r
+00003d50: 6573 756c 7420 6578 6973 7473 0a20 2020  esult exists.   
+00003d60: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
+00003d70: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00003d80: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
+00003d90: 7365 6c65 6374 2863 7572 7265 6e74 5f61  select(current_a
+00003da0: 7661 696c 6162 6c65 5f72 6f6c 6573 2829  vailable_roles()
+00003db0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00003dc0: 2020 2020 3e3e 3e20 6173 7365 7274 2072      >>> assert r
+00003dd0: 6573 756c 745b 305d 5b27 4355 5252 454e  esult[0]['CURREN
+00003de0: 545f 4156 4149 4c41 424c 455f 524f 4c45  T_AVAILABLE_ROLE
+00003df0: 5328 2927 5d20 6973 206e 6f74 204e 6f6e  S()'] is not Non
+00003e00: 650a 2020 2020 2222 220a 2020 2020 7265  e.    """.    re
+00003e10: 7475 726e 2062 7569 6c74 696e 2822 6375  turn builtin("cu
+00003e20: 7272 656e 745f 6176 6169 6c61 626c 655f  rrent_available_
+00003e30: 726f 6c65 7322 2928 290a 0a0a 6465 6620  roles")()...def 
+00003e40: 6164 645f 6d6f 6e74 6873 280a 2020 2020  add_months(.    
+00003e50: 6461 7465 5f6f 725f 7469 6d65 7374 616d  date_or_timestam
+00003e60: 703a 2043 6f6c 756d 6e4f 724e 616d 652c  p: ColumnOrName,
+00003e70: 206e 756d 6265 725f 6f66 5f6d 6f6e 7468   number_of_month
+00003e80: 733a 2055 6e69 6f6e 5b43 6f6c 756d 6e2c  s: Union[Column,
+00003e90: 2069 6e74 5d0a 2920 2d3e 2043 6f6c 756d   int].) -> Colum
+00003ea0: 6e3a 0a20 2020 2022 2222 4164 6473 206f  n:.    """Adds o
+00003eb0: 7220 7375 6274 7261 6374 7320 6120 7370  r subtracts a sp
+00003ec0: 6563 6966 6965 6420 6e75 6d62 6572 206f  ecified number o
+00003ed0: 6620 6d6f 6e74 6873 2074 6f20 6120 6461  f months to a da
+00003ee0: 7465 206f 7220 7469 6d65 7374 616d 702c  te or timestamp,
+00003ef0: 2070 7265 7365 7276 696e 6720 7468 6520   preserving the 
+00003f00: 656e 642d 6f66 2d6d 6f6e 7468 2069 6e66  end-of-month inf
+00003f10: 6f72 6d61 7469 6f6e 2e0a 0a20 2020 2045  ormation...    E
+00003f20: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00003f30: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+00003f40: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+00003f50: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00003f60: 6174 655f 6461 7461 6672 616d 6528 5b64  ate_dataframe([d
+00003f70: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+00003f80: 322c 2034 2c20 3629 5d2c 2073 6368 656d  2, 4, 6)], schem
+00003f90: 613d 5b22 6422 5d29 0a20 2020 2020 2020  a=["d"]).       
+00003fa0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+00003fb0: 6464 5f6d 6f6e 7468 7328 2264 222c 2034  dd_months("d", 4
+00003fc0: 2929 2e63 6f6c 6c65 6374 2829 5b30 5d5b  )).collect()[0][
+00003fd0: 305d 0a20 2020 2020 2020 2064 6174 6574  0].        datet
+00003fe0: 696d 652e 6461 7465 2832 3032 322c 2038  ime.date(2022, 8
+00003ff0: 2c20 3629 0a20 2020 2022 2222 0a20 2020  , 6).    """.   
+00004000: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00004010: 7374 7228 6461 7465 5f6f 725f 7469 6d65  str(date_or_time
+00004020: 7374 616d 702c 2022 6164 645f 6d6f 6e74  stamp, "add_mont
+00004030: 6873 2229 0a20 2020 2072 6574 7572 6e20  hs").    return 
+00004040: 6275 696c 7469 6e28 2261 6464 5f6d 6f6e  builtin("add_mon
+00004050: 7468 7322 2928 632c 206e 756d 6265 725f  ths")(c, number_
+00004060: 6f66 5f6d 6f6e 7468 7329 0a0a 0a64 6566  of_months)...def
+00004070: 2061 6e79 5f76 616c 7565 2865 3a20 436f   any_value(e: Co
+00004080: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00004090: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+000040a0: 7475 726e 7320 6120 6e6f 6e2d 6465 7465  turns a non-dete
+000040b0: 726d 696e 6973 7469 6320 616e 7920 7661  rministic any va
+000040c0: 6c75 6520 666f 7220 7468 6520 7370 6563  lue for the spec
+000040d0: 6966 6965 6420 636f 6c75 6d6e 2e0a 2020  ified column..  
+000040e0: 2020 5468 6973 2069 7320 616e 2061 6767    This is an agg
+000040f0: 7265 6761 7465 2061 6e64 2077 696e 646f  regate and windo
+00004100: 7720 6675 6e63 7469 6f6e 2e0a 0a20 2020  w function...   
+00004110: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00004120: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00004130: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00004140: 616d 6528 5b5b 312c 2032 5d2c 205b 332c  ame([[1, 2], [3,
+00004150: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2261   4]], schema=["a
+00004160: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+00004170: 203e 3e3e 2072 6573 756c 7420 3d20 6466   >>> result = df
+00004180: 2e73 656c 6563 7428 616e 795f 7661 6c75  .select(any_valu
+00004190: 6528 2261 2229 292e 636f 6c6c 6563 7428  e("a")).collect(
+000041a0: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
+000041b0: 7365 7274 206c 656e 2872 6573 756c 7429  sert len(result)
+000041c0: 203d 3d20 3120 2023 206e 6f6e 2d64 6574   == 1  # non-det
+000041d0: 6572 6d69 6e69 7374 6963 2076 616c 7565  erministic value
+000041e0: 2069 6e20 7265 7375 6c74 2e0a 2020 2020   in result..    
+000041f0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00004200: 636f 6c5f 6966 5f73 7472 2865 2c20 2261  col_if_str(e, "a
+00004210: 6e79 5f76 616c 7565 2229 0a20 2020 2072  ny_value").    r
+00004220: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
+00004230: 696e 2822 616e 795f 7661 6c75 6522 2c20  in("any_value", 
+00004240: 6329 0a0a 0a64 6566 2062 6974 6e6f 7428  c)...def bitnot(
+00004250: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+00004260: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00004270: 2222 2252 6574 7572 6e73 2074 6865 2062  """Returns the b
+00004280: 6974 7769 7365 206e 6567 6174 696f 6e20  itwise negation 
+00004290: 6f66 2061 206e 756d 6572 6963 2065 7870  of a numeric exp
+000042a0: 7265 7373 696f 6e2e 0a0a 2020 2020 4578  ression...    Ex
+000042b0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+000042c0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000042d0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000042e0: 285b 315d 2c20 7363 6865 6d61 3d5b 2261  ([1], schema=["a
+000042f0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+00004300: 6466 2e73 656c 6563 7428 6269 746e 6f74  df.select(bitnot
+00004310: 2822 6122 2929 2e63 6f6c 6c65 6374 2829  ("a")).collect()
+00004320: 5b30 5d5b 305d 0a20 2020 2020 2020 202d  [0][0].        -
+00004330: 320a 2020 2020 2222 220a 2020 2020 6320  2.    """.    c 
+00004340: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00004350: 2865 2c20 2262 6974 6e6f 7422 290a 2020  (e, "bitnot").  
+00004360: 2020 7265 7475 726e 2063 616c 6c5f 6275    return call_bu
+00004370: 696c 7469 6e28 2262 6974 6e6f 7422 2c20  iltin("bitnot", 
+00004380: 6329 0a0a 0a64 6566 2062 6974 7368 6966  c)...def bitshif
+00004390: 746c 6566 7428 746f 5f73 6869 6674 5f63  tleft(to_shift_c
+000043a0: 6f6c 756d 6e3a 2043 6f6c 756d 6e4f 724e  olumn: ColumnOrN
+000043b0: 616d 652c 206e 3a20 556e 696f 6e5b 436f  ame, n: Union[Co
+000043c0: 6c75 6d6e 2c20 696e 745d 2920 2d3e 2043  lumn, int]) -> C
+000043d0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+000043e0: 7475 726e 7320 7468 6520 6269 7477 6973  turns the bitwis
+000043f0: 6520 6e65 6761 7469 6f6e 206f 6620 6120  e negation of a 
+00004400: 6e75 6d65 7269 6320 6578 7072 6573 7369  numeric expressi
+00004410: 6f6e 2e0a 0a20 2020 2045 7861 6d70 6c65  on...    Example
+00004420: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+00004430: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00004440: 655f 6461 7461 6672 616d 6528 5b32 5d2c  e_dataframe([2],
+00004450: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00004460: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00004470: 6c65 6374 2862 6974 7368 6966 746c 6566  lect(bitshiftlef
+00004480: 7428 2261 222c 2031 2929 2e63 6f6c 6c65  t("a", 1)).colle
+00004490: 6374 2829 5b30 5d5b 305d 0a20 2020 2020  ct()[0][0].     
+000044a0: 2020 2034 0a20 2020 2022 2222 0a20 2020     4.    """.   
+000044b0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+000044c0: 7374 7228 746f 5f73 6869 6674 5f63 6f6c  str(to_shift_col
+000044d0: 756d 6e2c 2022 6269 7473 6869 6674 6c65  umn, "bitshiftle
+000044e0: 6674 2229 0a20 2020 2072 6574 7572 6e20  ft").    return 
+000044f0: 6361 6c6c 5f62 7569 6c74 696e 2822 6269  call_builtin("bi
+00004500: 7473 6869 6674 6c65 6674 222c 2063 2c20  tshiftleft", c, 
+00004510: 6e29 0a0a 0a64 6566 2062 6974 7368 6966  n)...def bitshif
+00004520: 7472 6967 6874 2874 6f5f 7368 6966 745f  tright(to_shift_
+00004530: 636f 6c75 6d6e 3a20 436f 6c75 6d6e 4f72  column: ColumnOr
+00004540: 4e61 6d65 2c20 6e3a 2055 6e69 6f6e 5b43  Name, n: Union[C
+00004550: 6f6c 756d 6e2c 2069 6e74 5d29 202d 3e20  olumn, int]) -> 
+00004560: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00004570: 6574 7572 6e73 2074 6865 2062 6974 7769  eturns the bitwi
+00004580: 7365 206e 6567 6174 696f 6e20 6f66 2061  se negation of a
+00004590: 206e 756d 6572 6963 2065 7870 7265 7373   numeric express
+000045a0: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
+000045b0: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
+000045c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000045d0: 7465 5f64 6174 6166 7261 6d65 285b 325d  te_dataframe([2]
+000045e0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+000045f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00004600: 656c 6563 7428 6269 7473 6869 6674 7269  elect(bitshiftri
+00004610: 6768 7428 2261 222c 2031 2929 2e63 6f6c  ght("a", 1)).col
+00004620: 6c65 6374 2829 5b30 5d5b 305d 0a20 2020  lect()[0][0].   
+00004630: 2020 2020 2031 0a20 2020 2022 2222 0a20       1.    """. 
+00004640: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00004650: 665f 7374 7228 746f 5f73 6869 6674 5f63  f_str(to_shift_c
+00004660: 6f6c 756d 6e2c 2022 6269 7473 6869 6674  olumn, "bitshift
+00004670: 7269 6768 7422 290a 2020 2020 7265 7475  right").    retu
+00004680: 726e 2063 616c 6c5f 6275 696c 7469 6e28  rn call_builtin(
+00004690: 2262 6974 7368 6966 7472 6967 6874 222c  "bitshiftright",
+000046a0: 2063 2c20 6e29 0a0a 0a64 6566 2062 726f   c, n)...def bro
+000046b0: 756e 6428 636f 6c3a 2043 6f6c 756d 6e4f  und(col: ColumnO
+000046c0: 724e 616d 652c 2073 6361 6c65 3a20 556e  rName, scale: Un
+000046d0: 696f 6e5b 436f 6c75 6d6e 2c20 696e 745d  ion[Column, int]
+000046e0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000046f0: 2022 2222 0a20 2020 2052 6f75 6e64 7320   """.    Rounds 
+00004700: 7468 6520 6e75 6d62 6572 2075 7369 6e67  the number using
+00004710: 2060 4841 4c46 5f54 4f5f 4556 454e 6020   `HALF_TO_EVEN` 
+00004720: 6f70 7469 6f6e 2e20 5468 6520 6048 414c  option. The `HAL
+00004730: 465f 544f 5f45 5645 4e60 2072 6f75 6e64  F_TO_EVEN` round
+00004740: 696e 6720 6d6f 6465 2072 6f75 6e64 7320  ing mode rounds 
+00004750: 7468 6520 6769 7665 6e20 6465 6369 6d61  the given decima
+00004760: 6c20 7661 6c75 6520 746f 2074 6865 2073  l value to the s
+00004770: 7065 6369 6669 6564 2073 6361 6c65 2028  pecified scale (
+00004780: 6e75 6d62 6572 206f 6620 6465 6369 6d61  number of decima
+00004790: 6c20 706c 6163 6573 2920 6173 2066 6f6c  l places) as fol
+000047a0: 6c6f 7773 3a0a 2020 2020 2a20 4966 2073  lows:.    * If s
+000047b0: 6361 6c65 2069 7320 6772 6561 7465 7220  cale is greater 
+000047c0: 7468 616e 206f 7220 6571 7561 6c20 746f  than or equal to
+000047d0: 2030 2c20 726f 756e 6420 746f 2074 6865   0, round to the
+000047e0: 2073 7065 6369 6669 6564 206e 756d 6265   specified numbe
+000047f0: 7220 6f66 2064 6563 696d 616c 2070 6c61  r of decimal pla
+00004800: 6365 7320 7573 696e 6720 6861 6c66 2d65  ces using half-e
+00004810: 7665 6e20 726f 756e 6469 6e67 2e20 5468  ven rounding. Th
+00004820: 6973 2072 6f75 6e64 7320 746f 7761 7264  is rounds toward
+00004830: 7320 7468 6520 6e65 6172 6573 7420 7661  s the nearest va
+00004840: 6c75 6520 7769 7468 2074 6965 7320 2865  lue with ties (e
+00004850: 7175 616c 6c79 2063 6c6f 7365 2076 616c  qually close val
+00004860: 7565 7329 2072 6f75 6e64 696e 6720 746f  ues) rounding to
+00004870: 2074 6865 206e 6561 7265 7374 2065 7665   the nearest eve
+00004880: 6e20 6469 6769 742e 0a20 2020 202a 2049  n digit..    * I
+00004890: 6620 7363 616c 6520 6973 206c 6573 7320  f scale is less 
+000048a0: 7468 616e 2030 2c20 726f 756e 6420 746f  than 0, round to
+000048b0: 2074 6865 2069 6e74 6567 7261 6c20 7061   the integral pa
+000048c0: 7274 206f 6620 7468 6520 6465 6369 6d61  rt of the decima
+000048d0: 6c2e 2054 6869 7320 726f 756e 6473 2074  l. This rounds t
+000048e0: 6f77 6172 6473 2030 2061 6e64 2074 7275  owards 0 and tru
+000048f0: 6e63 6174 6573 2074 6865 2064 6563 696d  ncates the decim
+00004900: 616c 2070 6c61 6365 732e 0a0a 2020 2020  al places...    
+00004910: 4e6f 7465 3a0a 0a20 2020 2020 2020 2031  Note:..        1
+00004920: 2e20 5468 6520 6461 7461 2074 7970 6520  . The data type 
+00004930: 6f66 2074 6865 2065 7870 7265 7373 696f  of the expressio
+00004940: 6e20 6d75 7374 2062 6520 6f6e 6520 6f66  n must be one of
+00004950: 2074 6865 2060 6461 7461 2074 7970 6573   the `data types
+00004960: 2066 6f72 2061 2066 6978 6564 2d70 6f69   for a fixed-poi
+00004970: 6e74 206e 756d 6265 720a 2020 2020 2020  nt number.      
+00004980: 2020 3c68 7474 7073 3a2f 2f64 6f63 732e    <https://docs.
+00004990: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
+000049a0: 2f73 716c 2d72 6566 6572 656e 6365 2f64  /sql-reference/d
+000049b0: 6174 612d 7479 7065 732d 6e75 6d65 7269  ata-types-numeri
+000049c0: 632e 6874 6d6c 236c 6162 656c 2d64 6174  c.html#label-dat
+000049d0: 612d 7479 7065 732d 666f 722d 6669 7865  a-types-for-fixe
+000049e0: 642d 706f 696e 742d 6e75 6d62 6572 733e  d-point-numbers>
+000049f0: 605f 2e0a 0a20 2020 2020 2020 2032 2e20  `_...        2. 
+00004a00: 4461 7461 2074 7970 6573 2066 6f72 2066  Data types for f
+00004a10: 6c6f 6174 696e 6720 706f 696e 7420 6e75  loating point nu
+00004a20: 6d62 6572 7320 2865 2e67 2e20 464c 4f41  mbers (e.g. FLOA
+00004a30: 5429 2061 7265 206e 6f74 2073 7570 706f  T) are not suppo
+00004a40: 7274 6564 2077 6974 6820 7468 6973 2061  rted with this a
+00004a50: 7267 756d 656e 742e 0a0a 2020 2020 2020  rgument...      
+00004a60: 2020 332e 2049 6620 7468 6520 6578 7072    3. If the expr
+00004a70: 6573 7369 6f6e 2064 6174 6120 7479 7065  ession data type
+00004a80: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+00004a90: 642c 2074 6865 2065 7870 7265 7373 696f  d, the expressio
+00004aa0: 6e20 6d75 7374 2062 6520 6578 706c 6963  n must be explic
+00004ab0: 6974 6c79 2063 6173 7420 746f 2064 6563  itly cast to dec
+00004ac0: 696d 616c 2062 6566 6f72 6520 6361 6c6c  imal before call
+00004ad0: 696e 672e 0a0a 2020 2020 4578 616d 706c  ing...    Exampl
+00004ae0: 653a 0a20 2020 2020 2020 203e 3e3e 2069  e:.        >>> i
+00004af0: 6d70 6f72 7420 6465 6369 6d61 6c0a 2020  mport decimal.  
+00004b00: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+00004b10: 205b 2864 6563 696d 616c 2e44 6563 696d   [(decimal.Decim
+00004b20: 616c 2831 2e32 3335 2929 2c28 6465 6369  al(1.235)),(deci
+00004b30: 6d61 6c2e 4465 6369 6d61 6c28 332e 3529  mal.Decimal(3.5)
+00004b40: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
+00004b50: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00004b60: 7465 4461 7461 4672 616d 6528 6461 7461  teDataFrame(data
+00004b70: 2c20 5b22 7661 6c75 6522 5d29 0a20 2020  , ["value"]).   
+00004b80: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00004b90: 6374 2862 726f 756e 6428 2756 414c 5545  ct(bround('VALUE
+00004ba0: 272c 3129 2e61 6c69 6173 2822 5641 4c55  ',1).alias("VALU
+00004bb0: 4522 2929 2e73 686f 7728 2920 2320 526f  E")).show() # Ro
+00004bc0: 756e 6473 2074 6f20 3120 6465 6369 6d61  unds to 1 decima
+00004bd0: 6c20 706c 6163 650a 2020 2020 2020 2020  l place.        
+00004be0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00004bf0: 2020 2020 7c22 5641 4c55 4522 2020 7c0a      |"VALUE"  |.
+00004c00: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00004c10: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e32  ---.        |1.2
+00004c20: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00004c30: 7c33 2e35 2020 2020 2020 7c0a 2020 2020  |3.5      |.    
+00004c40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a      -----------.
+00004c50: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+00004c60: 4e45 3e0a 2020 2020 2020 2020 3e3e 3e20  NE>.        >>> 
+00004c70: 6466 2e73 656c 6563 7428 6272 6f75 6e64  df.select(bround
+00004c80: 2827 5641 4c55 4527 2c30 292e 616c 6961  ('VALUE',0).alia
+00004c90: 7328 2256 414c 5545 2229 292e 7368 6f77  s("VALUE")).show
+00004ca0: 2829 2023 2052 6f75 6e64 7320 746f 2031  () # Rounds to 1
+00004cb0: 2064 6563 696d 616c 2070 6c61 6365 0a20   decimal place. 
+00004cc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00004cd0: 2d2d 0a20 2020 2020 2020 207c 2256 414c  --.        |"VAL
+00004ce0: 5545 2220 207c 0a20 2020 2020 2020 202d  UE"  |.        -
+00004cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00004d00: 2020 207c 3120 2020 2020 2020 207c 0a20     |1        |. 
+00004d10: 2020 2020 2020 207c 3420 2020 2020 2020         |4       
+00004d20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00004d30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00004d40: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00004d50: 2222 0a20 2020 2063 6f6c 203d 205f 746f  "".    col = _to
+00004d60: 5f63 6f6c 5f69 665f 7374 7228 636f 6c2c  _col_if_str(col,
+00004d70: 2022 6272 6f75 6e64 2229 0a20 2020 2073   "bround").    s
+00004d80: 6361 6c65 203d 205f 746f 5f63 6f6c 5f69  cale = _to_col_i
+00004d90: 665f 6c69 7428 7363 616c 652c 2022 6272  f_lit(scale, "br
+00004da0: 6f75 6e64 2229 0a20 2020 2072 6574 7572  ound").    retur
+00004db0: 6e20 6361 6c6c 5f62 7569 6c74 696e 2822  n call_builtin("
+00004dc0: 524f 554e 4422 2c20 636f 6c2c 2073 6361  ROUND", col, sca
+00004dd0: 6c65 2c20 6c69 7428 2248 414c 465f 544f  le, lit("HALF_TO
+00004de0: 5f45 5645 4e22 2929 0a0a 0a64 6566 2063  _EVEN"))...def c
+00004df0: 6f6e 7665 7274 5f74 696d 657a 6f6e 6528  onvert_timezone(
+00004e00: 0a20 2020 2074 6172 6765 745f 7469 6d65  .    target_time
+00004e10: 7a6f 6e65 3a20 436f 6c75 6d6e 4f72 4e61  zone: ColumnOrNa
+00004e20: 6d65 2c0a 2020 2020 736f 7572 6365 5f74  me,.    source_t
+00004e30: 696d 653a 2043 6f6c 756d 6e4f 724e 616d  ime: ColumnOrNam
+00004e40: 652c 0a20 2020 2073 6f75 7263 655f 7469  e,.    source_ti
+00004e50: 6d65 7a6f 6e65 3a20 4f70 7469 6f6e 616c  mezone: Optional
+00004e60: 5b43 6f6c 756d 6e4f 724e 616d 655d 203d  [ColumnOrName] =
+00004e70: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
+00004e80: 6d6e 3a0a 2020 2020 2222 2243 6f6e 7665  mn:.    """Conve
+00004e90: 7274 7320 7468 6520 6769 7665 6e20 736f  rts the given so
+00004ea0: 7572 6365 5f74 696d 6520 746f 2074 6865  urce_time to the
+00004eb0: 2074 6172 6765 7420 7469 6d65 7a6f 6e65   target timezone
+00004ec0: 2e0a 0a20 2020 2046 6f72 2074 696d 657a  ...    For timez
+00004ed0: 6f6e 6520 696e 666f 726d 6174 696f 6e2c  one information,
+00004ee0: 2072 6566 6572 2074 6f20 7468 6520 6053   refer to the `S
+00004ef0: 6e6f 7766 6c61 6b65 2053 514c 2063 6f6e  nowflake SQL con
+00004f00: 7665 7274 5f74 696d 657a 6f6e 6520 6e6f  vert_timezone no
+00004f10: 7465 7320 3c68 7474 7073 3a2f 2f64 6f63  tes <https://doc
+00004f20: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
+00004f30: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
+00004f40: 2f66 756e 6374 696f 6e73 2f63 6f6e 7665  /functions/conve
+00004f50: 7274 5f74 696d 657a 6f6e 652e 6874 6d6c  rt_timezone.html
+00004f60: 2375 7361 6765 2d6e 6f74 6573 3e60 5f0a  #usage-notes>`_.
+00004f70: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00004f80: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00004f90: 745f 7469 6d65 7a6f 6e65 3a20 5468 6520  t_timezone: The 
+00004fa0: 7469 6d65 207a 6f6e 6520 746f 2077 6869  time zone to whi
+00004fb0: 6368 2074 6865 2069 6e70 7574 2074 696d  ch the input tim
+00004fc0: 6573 7461 6d70 2073 686f 756c 6420 6265  estamp should be
+00004fd0: 2063 6f6e 7665 7274 6564 2e3d 0a20 2020   converted.=.   
+00004fe0: 2020 2020 2020 2020 2073 6f75 7263 655f           source_
+00004ff0: 7469 6d65 3a20 5468 6520 7469 6d65 7374  time: The timest
+00005000: 616d 7020 746f 2063 6f6e 7665 7274 2e20  amp to convert. 
+00005010: 5768 656e 2069 7427 7320 6120 5449 4d45  When it's a TIME
+00005020: 5354 414d 505f 4c54 5a2c 2075 7365 2060  STAMP_LTZ, use `
+00005030: 604e 6f6e 6560 6020 666f 7220 6060 736f  `None`` for ``so
+00005040: 7572 6365 5f74 696d 657a 6f6e 6560 602e  urce_timezone``.
+00005050: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00005060: 7263 655f 7469 6d65 7a6f 6e65 3a20 5468  rce_timezone: Th
+00005070: 6520 7469 6d65 207a 6f6e 6520 666f 7220  e time zone for 
+00005080: 7468 6520 6060 736f 7572 6365 5f74 696d  the ``source_tim
+00005090: 6560 602e 2052 6571 7569 7265 6420 666f  e``. Required fo
+000050a0: 7220 7469 6d65 7374 616d 7073 2077 6974  r timestamps wit
+000050b0: 6820 6e6f 2074 696d 6520 7a6f 6e65 2028  h no time zone (
+000050c0: 692e 652e 2054 494d 4553 5441 4d50 5f4e  i.e. TIMESTAMP_N
+000050d0: 545a 292e 2055 7365 2060 604e 6f6e 6560  TZ). Use ``None`
+000050e0: 6020 6966 2074 6865 2074 696d 6573 7461  ` if the timesta
+000050f0: 6d70 7320 6861 7665 2061 2074 696d 6520  mps have a time 
+00005100: 7a6f 6e65 2028 692e 652e 2054 494d 4553  zone (i.e. TIMES
+00005110: 5441 4d50 5f4c 545a 292e 2044 6566 6175  TAMP_LTZ). Defau
+00005120: 6c74 2069 7320 6060 4e6f 6e65 6060 2e0a  lt is ``None``..
+00005130: 0a20 2020 2020 2020 204e 6f74 653a 0a20  .        Note:. 
+00005140: 2020 2020 2020 2020 2020 2054 6865 2073             The s
+00005150: 6571 7565 6e63 6520 6f66 2074 6865 2033  equence of the 3
+00005160: 2070 6172 616d 7320 6973 2064 6966 6665   params is diffe
+00005170: 7265 6e74 2066 726f 6d20 7468 6520 5351  rent from the SQ
+00005180: 4c20 6675 6e63 7469 6f6e 2c20 7768 6963  L function, whic
+00005190: 6820 7477 6f20 6f76 6572 6c6f 6164 733a  h two overloads:
+000051a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000051b0: 2d20 6060 434f 4e56 4552 545f 5449 4d45  - ``CONVERT_TIME
+000051c0: 5a4f 4e45 2820 3c73 6f75 7263 655f 747a  ZONE( <source_tz
+000051d0: 3e20 2c20 3c74 6172 6765 745f 747a 3e20  > , <target_tz> 
+000051e0: 2c20 3c73 6f75 7263 655f 7469 6d65 7374  , <source_timest
+000051f0: 616d 705f 6e74 7a3e 2029 6060 0a20 2020  amp_ntz> )``.   
+00005200: 2020 2020 2020 2020 2020 202d 2060 6043             - ``C
+00005210: 4f4e 5645 5254 5f54 494d 455a 4f4e 4528  ONVERT_TIMEZONE(
+00005220: 203c 7461 7267 6574 5f74 7a3e 202c 203c   <target_tz> , <
+00005230: 736f 7572 6365 5f74 696d 6573 7461 6d70  source_timestamp
+00005240: 3e20 2960 600a 0a20 2020 2020 2020 2020  > )``..         
+00005250: 2020 2054 6865 2066 6972 7374 2070 6172     The first par
+00005260: 616d 6574 6572 2060 6073 6f75 7263 655f  ameter ``source_
+00005270: 747a 6060 2069 7320 6f70 7469 6f6e 616c  tz`` is optional
+00005280: 2e20 4275 7420 696e 2050 7974 686f 6e20  . But in Python 
+00005290: 616e 206f 7074 696f 6e61 6c20 6172 6775  an optional argu
+000052a0: 6d65 6e74 2073 686f 756c 646e 2774 2062  ment shouldn't b
+000052b0: 6520 706c 6163 6564 2061 7420 7468 6520  e placed at the 
+000052c0: 6669 7273 742e 0a20 2020 2020 2020 2020  first..         
+000052d0: 2020 2053 6f20 6060 736f 7572 6365 5f74     So ``source_t
+000052e0: 696d 657a 6f6e 6560 6020 6973 2061 6674  imezone`` is aft
+000052f0: 6572 2060 6073 6f75 7263 655f 7469 6d65  er ``source_time
+00005300: 6060 2e0a 0a20 2020 2020 2020 2045 7861  ``...        Exa
+00005310: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+00005320: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
+00005330: 6574 696d 650a 2020 2020 2020 2020 2020  etime.          
+00005340: 2020 3e3e 3e20 6672 6f6d 2064 6174 6575    >>> from dateu
+00005350: 7469 6c20 696d 706f 7274 2074 7a0a 2020  til import tz.  
+00005360: 2020 2020 2020 2020 2020 3e3e 3e20 6461            >>> da
+00005370: 7465 7469 6d65 5f77 6974 685f 747a 203d  tetime_with_tz =
+00005380: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+00005390: 6d65 2832 3032 322c 2034 2c20 362c 2039  me(2022, 4, 6, 9
+000053a0: 2c20 302c 2030 2c20 747a 696e 666f 3d74  , 0, 0, tzinfo=t
+000053b0: 7a2e 747a 6f66 6673 6574 2822 6d79 7a6f  z.tzoffset("myzo
+000053c0: 6e65 222c 202d 3336 3030 2a37 2929 0a20  ne", -3600*7)). 
+000053d0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+000053e0: 6174 6574 696d 655f 7769 7468 5f6e 6f5f  atetime_with_no_
+000053f0: 747a 203d 2064 6174 6574 696d 652e 6461  tz = datetime.da
+00005400: 7465 7469 6d65 2832 3032 322c 2034 2c20  tetime(2022, 4, 
+00005410: 362c 2039 2c20 302c 2030 290a 2020 2020  6, 9, 0, 0).    
+00005420: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00005430: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00005440: 6461 7461 6672 616d 6528 5b5b 6461 7465  dataframe([[date
+00005450: 7469 6d65 5f77 6974 685f 747a 2c20 6461  time_with_tz, da
+00005460: 7465 7469 6d65 5f77 6974 685f 6e6f 5f74  tetime_with_no_t
+00005470: 7a5d 5d2c 2073 6368 656d 613d 5b22 6122  z]], schema=["a"
+00005480: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+00005490: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
+000054a0: 2064 662e 7365 6c65 6374 2863 6f6e 7665   df.select(conve
+000054b0: 7274 5f74 696d 657a 6f6e 6528 6c69 7428  rt_timezone(lit(
+000054c0: 2255 5443 2229 2c20 636f 6c28 2261 2229  "UTC"), col("a")
+000054d0: 292c 2063 6f6e 7665 7274 5f74 696d 657a  ), convert_timez
+000054e0: 6f6e 6528 6c69 7428 2255 5443 2229 2c20  one(lit("UTC"), 
+000054f0: 636f 6c28 2262 2229 2c20 6c69 7428 2241  col("b"), lit("A
+00005500: 7369 612f 5368 616e 6768 6169 2229 2929  sia/Shanghai")))
+00005510: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00005520: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+00005530: 745b 305d 5b30 5d0a 2020 2020 2020 2020  t[0][0].        
+00005540: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
+00005550: 6574 696d 6528 3230 3232 2c20 342c 2036  etime(2022, 4, 6
+00005560: 2c20 3136 2c20 302c 2074 7a69 6e66 6f3d  , 16, 0, tzinfo=
+00005570: 3c55 5443 3e29 0a20 2020 2020 2020 2020  <UTC>).         
+00005580: 2020 203e 3e3e 2072 6573 756c 745b 305d     >>> result[0]
+00005590: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+000055a0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+000055b0: 6528 3230 3232 2c20 342c 2036 2c20 312c  e(2022, 4, 6, 1,
+000055c0: 2030 290a 2020 2020 2222 220a 2020 2020   0).    """.    
+000055d0: 736f 7572 6365 5f74 7a20 3d20 280a 2020  source_tz = (.  
+000055e0: 2020 2020 2020 5f74 6f5f 636f 6c5f 6966        _to_col_if
+000055f0: 5f73 7472 2873 6f75 7263 655f 7469 6d65  _str(source_time
+00005600: 7a6f 6e65 2c20 2263 6f6e 7665 7274 5f74  zone, "convert_t
+00005610: 696d 657a 6f6e 6522 290a 2020 2020 2020  imezone").      
+00005620: 2020 6966 2073 6f75 7263 655f 7469 6d65    if source_time
+00005630: 7a6f 6e65 2069 7320 6e6f 7420 4e6f 6e65  zone is not None
+00005640: 0a20 2020 2020 2020 2065 6c73 6520 4e6f  .        else No
+00005650: 6e65 0a20 2020 2029 0a20 2020 2074 6172  ne.    ).    tar
+00005660: 6765 745f 747a 203d 205f 746f 5f63 6f6c  get_tz = _to_col
+00005670: 5f69 665f 7374 7228 7461 7267 6574 5f74  _if_str(target_t
+00005680: 696d 657a 6f6e 652c 2022 636f 6e76 6572  imezone, "conver
+00005690: 745f 7469 6d65 7a6f 6e65 2229 0a20 2020  t_timezone").   
+000056a0: 2073 6f75 7263 655f 7469 6d65 5f74 6f5f   source_time_to_
+000056b0: 636f 6e76 6572 7420 3d20 5f74 6f5f 636f  convert = _to_co
+000056c0: 6c5f 6966 5f73 7472 2873 6f75 7263 655f  l_if_str(source_
+000056d0: 7469 6d65 2c20 2263 6f6e 7665 7274 5f74  time, "convert_t
+000056e0: 696d 657a 6f6e 6522 290a 0a20 2020 2069  imezone")..    i
+000056f0: 6620 736f 7572 6365 5f74 696d 657a 6f6e  f source_timezon
+00005700: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00005710: 2020 2072 6574 7572 6e20 6361 6c6c 5f62     return call_b
+00005720: 7569 6c74 696e 2822 636f 6e76 6572 745f  uiltin("convert_
+00005730: 7469 6d65 7a6f 6e65 222c 2074 6172 6765  timezone", targe
+00005740: 745f 747a 2c20 736f 7572 6365 5f74 696d  t_tz, source_tim
+00005750: 655f 746f 5f63 6f6e 7665 7274 290a 2020  e_to_convert).  
+00005760: 2020 7265 7475 726e 2063 616c 6c5f 6275    return call_bu
+00005770: 696c 7469 6e28 0a20 2020 2020 2020 2022  iltin(.        "
+00005780: 636f 6e76 6572 745f 7469 6d65 7a6f 6e65  convert_timezone
+00005790: 222c 2073 6f75 7263 655f 747a 2c20 7461  ", source_tz, ta
+000057a0: 7267 6574 5f74 7a2c 2073 6f75 7263 655f  rget_tz, source_
+000057b0: 7469 6d65 5f74 6f5f 636f 6e76 6572 740a  time_to_convert.
+000057c0: 2020 2020 290a 0a0a 6465 6620 6170 7072      )...def appr
+000057d0: 6f78 5f63 6f75 6e74 5f64 6973 7469 6e63  ox_count_distinc
+000057e0: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
+000057f0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00005800: 2020 2222 2255 7365 7320 4879 7065 724c    """Uses HyperL
+00005810: 6f67 4c6f 6720 746f 2072 6574 7572 6e20  ogLog to return 
+00005820: 616e 2061 7070 726f 7869 6d61 7469 6f6e  an approximation
+00005830: 206f 6620 7468 6520 6469 7374 696e 6374   of the distinct
+00005840: 2063 6172 6469 6e61 6c69 7479 206f 6620   cardinality of 
+00005850: 7468 6520 696e 7075 7420 2869 2e65 2e20  the input (i.e. 
+00005860: 484c 4c28 636f 6c31 2c20 636f 6c32 2c20  HLL(col1, col2, 
+00005870: 2e2e 2e20 290a 2020 2020 7265 7475 726e  ... ).    return
+00005880: 7320 616e 2061 7070 726f 7869 6d61 7469  s an approximati
+00005890: 6f6e 206f 6620 434f 554e 5428 4449 5354  on of COUNT(DIST
+000058a0: 494e 4354 2063 6f6c 312c 2063 6f6c 322c  INCT col1, col2,
+000058b0: 202e 2e2e 2029 292e 0a0a 2020 2020 4578   ... ))...    Ex
+000058c0: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+000058d0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000058e0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+000058f0: 6528 5b5b 312c 2032 5d2c 205b 332c 2034  e([[1, 2], [3, 4
+00005900: 5d2c 205b 352c 2036 5d5d 2c20 7363 6865  ], [5, 6]], sche
+00005910: 6d61 3d5b 2261 222c 2022 6222 5d29 0a20  ma=["a", "b"]). 
+00005920: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00005930: 6c65 6374 2861 7070 726f 785f 636f 756e  lect(approx_coun
+00005940: 745f 6469 7374 696e 6374 2822 6122 292e  t_distinct("a").
+00005950: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00005960: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00005970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00005980: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00005990: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000059a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+000059b0: 3320 2020 2020 2020 2020 7c0a 2020 2020  3         |.    
+000059c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000059d0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+000059e0: 494e 453e 0a0a 2020 2020 2222 220a 2020  INE>..    """.  
+000059f0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00005a00: 5f73 7472 2865 2c20 2261 7070 726f 785f  _str(e, "approx_
+00005a10: 636f 756e 745f 6469 7374 696e 6374 2229  count_distinct")
+00005a20: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00005a30: 7469 6e28 2261 7070 726f 785f 636f 756e  tin("approx_coun
+00005a40: 745f 6469 7374 696e 6374 2229 2863 290a  t_distinct")(c).
+00005a50: 0a0a 6465 6620 6176 6728 653a 2043 6f6c  ..def avg(e: Col
+00005a60: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00005a70: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00005a80: 7572 6e73 2074 6865 2061 7665 7261 6765  urns the average
+00005a90: 206f 6620 6e6f 6e2d 4e55 4c4c 2072 6563   of non-NULL rec
+00005aa0: 6f72 6473 2e20 4966 2061 6c6c 2072 6563  ords. If all rec
+00005ab0: 6f72 6473 2069 6e73 6964 6520 6120 6772  ords inside a gr
+00005ac0: 6f75 7020 6172 6520 4e55 4c4c 2c0a 2020  oup are NULL,.  
+00005ad0: 2020 7468 6520 6675 6e63 7469 6f6e 2072    the function r
+00005ae0: 6574 7572 6e73 204e 554c 4c2e 0a0a 2020  eturns NULL...  
+00005af0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00005b00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00005b10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00005b20: 6672 616d 6528 5b5b 315d 2c20 5b32 5d2c  frame([[1], [2],
+00005b30: 205b 325d 5d2c 2073 6368 656d 613d 5b22   [2]], schema=["
+00005b40: 6422 5d29 0a20 2020 2020 2020 203e 3e3e  d"]).        >>>
+00005b50: 2064 662e 7365 6c65 6374 2861 7667 2864   df.select(avg(d
+00005b60: 662e 6429 2e61 6c69 6173 2822 7265 7375  f.d).alias("resu
+00005b70: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00005b80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00005b90: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+00005ba0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+00005bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00005bc0: 2020 2020 7c31 2e36 3636 3636 3720 207c      |1.666667  |
+00005bd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00005be0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00005bf0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+00005c00: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00005c10: 6c5f 6966 5f73 7472 2865 2c20 2261 7667  l_if_str(e, "avg
+00005c20: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00005c30: 696c 7469 6e28 2261 7667 2229 2863 290a  iltin("avg")(c).
+00005c40: 0a0a 6465 6620 636f 7272 2863 6f6c 756d  ..def corr(colum
+00005c50: 6e31 3a20 436f 6c75 6d6e 4f72 4e61 6d65  n1: ColumnOrName
+00005c60: 2c20 636f 6c75 6d6e 323a 2043 6f6c 756d  , column2: Colum
+00005c70: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00005c80: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00005c90: 6e73 2074 6865 2063 6f72 7265 6c61 7469  ns the correlati
+00005ca0: 6f6e 2063 6f65 6666 6963 6965 6e74 2066  on coefficient f
+00005cb0: 6f72 206e 6f6e 2d6e 756c 6c20 7061 6972  or non-null pair
+00005cc0: 7320 696e 2061 2067 726f 7570 2e0a 0a20  s in a group... 
+00005cd0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+00005ce0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00005cf0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00005d00: 6672 616d 6528 5b5b 312c 2032 5d2c 205b  frame([[1, 2], [
+00005d10: 312c 2032 5d2c 205b 342c 2035 5d2c 205b  1, 2], [4, 5], [
+00005d20: 322c 2033 5d2c 205b 332c 204e 6f6e 655d  2, 3], [3, None]
+00005d30: 2c20 5b34 2c20 4e6f 6e65 5d2c 205b 362c  , [4, None], [6,
+00005d40: 345d 5d2c 2073 6368 656d 613d 5b22 6122  4]], schema=["a"
+00005d50: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+00005d60: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
+00005d70: 7272 2863 6f6c 2822 6122 292c 2063 6f6c  rr(col("a"), col
+00005d80: 2822 6222 2929 2e61 6c69 6173 2822 7265  ("b")).alias("re
+00005d90: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+00005da0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00005db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00005dc0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00005dd0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00005de0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00005df0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00005e00: 207c 302e 3831 3336 3831 3530 3833 3238   |0.813681508328
+00005e10: 3830 3920 207c 0a20 2020 2020 2020 202d  809  |.        -
+00005e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005e30: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00005e40: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00005e50: 0a20 2020 2063 3120 3d20 5f74 6f5f 636f  .    c1 = _to_co
+00005e60: 6c5f 6966 5f73 7472 2863 6f6c 756d 6e31  l_if_str(column1
+00005e70: 2c20 2263 6f72 7222 290a 2020 2020 6332  , "corr").    c2
+00005e80: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00005e90: 7228 636f 6c75 6d6e 322c 2022 636f 7272  r(column2, "corr
+00005ea0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00005eb0: 696c 7469 6e28 2263 6f72 7222 2928 6331  iltin("corr")(c1
+00005ec0: 2c20 6332 290a 0a0a 6465 6620 636f 756e  , c2)...def coun
+00005ed0: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
+00005ee0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00005ef0: 2020 2222 2252 6574 7572 6e73 2065 6974    """Returns eit
+00005f00: 6865 7220 7468 6520 6e75 6d62 6572 206f  her the number o
+00005f10: 6620 6e6f 6e2d 4e55 4c4c 2072 6563 6f72  f non-NULL recor
+00005f20: 6473 2066 6f72 2074 6865 2073 7065 6369  ds for the speci
+00005f30: 6669 6564 2063 6f6c 756d 6e73 2c20 6f72  fied columns, or
+00005f40: 2074 6865 0a20 2020 2074 6f74 616c 206e   the.    total n
+00005f50: 756d 6265 7220 6f66 2072 6563 6f72 6473  umber of records
+00005f60: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
+00005f70: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00005f80: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00005f90: 6461 7461 6672 616d 6528 5b5b 315d 2c20  dataframe([[1], 
+00005fa0: 5b4e 6f6e 655d 2c20 5b33 5d2c 205b 345d  [None], [3], [4]
+00005fb0: 2c20 5b4e 6f6e 655d 5d2c 2073 6368 656d  , [None]], schem
+00005fc0: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00005fd0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
+00005fe0: 6f75 6e74 2863 6f6c 2822 6122 2929 2e61  ount(col("a")).a
+00005ff0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00006000: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00006010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00006020: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00006030: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006040: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c33  -----.        |3
+00006050: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00006060: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00006070: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+00006080: 4e45 3e0a 2020 2020 2020 2020 3e3e 3e20  NE>.        >>> 
+00006090: 6466 2e73 656c 6563 7428 636f 756e 7428  df.select(count(
+000060a0: 222a 2229 2e61 6c69 6173 2822 7265 7375  "*").alias("resu
+000060b0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+000060c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+000060d0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+000060e0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+000060f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00006100: 2020 2020 7c35 2020 2020 2020 2020 207c      |5         |
+00006110: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006120: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00006130: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+00006140: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00006150: 6c5f 6966 5f73 7472 2865 2c20 2263 6f75  l_if_str(e, "cou
+00006160: 6e74 2229 0a20 2020 2072 6574 7572 6e20  nt").    return 
+00006170: 280a 2020 2020 2020 2020 6275 696c 7469  (.        builti
+00006180: 6e28 2263 6f75 6e74 2229 284c 6974 6572  n("count")(Liter
+00006190: 616c 2831 2929 0a20 2020 2020 2020 2069  al(1)).        i
+000061a0: 6620 6973 696e 7374 616e 6365 2863 2e5f  f isinstance(c._
+000061b0: 6578 7072 6573 7369 6f6e 2c20 5374 6172  expression, Star
+000061c0: 290a 2020 2020 2020 2020 656c 7365 2062  ).        else b
+000061d0: 7569 6c74 696e 2822 636f 756e 7422 2928  uiltin("count")(
+000061e0: 632e 5f65 7870 7265 7373 696f 6e29 0a20  c._expression). 
+000061f0: 2020 2029 0a0a 0a64 6566 2063 6f75 6e74     )...def count
+00006200: 5f64 6973 7469 6e63 7428 2a63 6f6c 733a  _distinct(*cols:
+00006210: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00006220: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00006230: 2252 6574 7572 6e73 2065 6974 6865 7220  "Returns either 
+00006240: 7468 6520 6e75 6d62 6572 206f 6620 6e6f  the number of no
+00006250: 6e2d 4e55 4c4c 2064 6973 7469 6e63 7420  n-NULL distinct 
+00006260: 7265 636f 7264 7320 666f 7220 7468 6520  records for the 
+00006270: 7370 6563 6966 6965 6420 636f 6c75 6d6e  specified column
+00006280: 732c 0a20 2020 206f 7220 7468 6520 746f  s,.    or the to
+00006290: 7461 6c20 6e75 6d62 6572 206f 6620 7468  tal number of th
+000062a0: 6520 6469 7374 696e 6374 2072 6563 6f72  e distinct recor
+000062b0: 6473 2e0a 0a20 2020 2045 7861 6d70 6c65  ds...    Example
+000062c0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+000062d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000062e0: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+000062f0: 2c20 325d 2c20 5b31 2c20 325d 2c20 5b33  , 2], [1, 2], [3
+00006300: 2c20 4e6f 6e65 5d2c 205b 322c 2033 5d2c  , None], [2, 3],
+00006310: 205b 332c 204e 6f6e 655d 2c20 5b34 2c20   [3, None], [4, 
+00006320: 4e6f 6e65 5d5d 2c20 7363 6865 6d61 3d5b  None]], schema=[
+00006330: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00006340: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00006350: 2863 6f75 6e74 5f64 6973 7469 6e63 7428  (count_distinct(
+00006360: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
+00006370: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
+00006380: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+00006390: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000063a0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+000063b0: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+000063c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000063d0: 2020 207c 3220 2020 2020 2020 2020 7c0a     |2         |.
+000063e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000063f0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00006400: 414e 4b4c 494e 453e 0a20 2020 2020 2020  ANKLINE>.       
+00006410: 203e 3e3e 2023 2020 5468 6520 7265 7375   >>> #  The resu
+00006420: 6c74 2073 686f 756c 6420 6265 2032 2066  lt should be 2 f
+00006430: 6f72 207b 5b31 2c32 5d2c 5b32 2c33 5d7d  or {[1,2],[2,3]}
+00006440: 2073 696e 6365 2074 6865 2072 6573 7420   since the rest 
+00006450: 6172 6520 6569 7468 6572 2064 7570 6c69  are either dupli
+00006460: 6361 7465 206f 7220 4e55 4c4c 2072 6563  cate or NULL rec
+00006470: 6f72 6473 0a20 2020 2022 2222 0a20 2020  ords.    """.   
+00006480: 2063 7320 3d20 5b5f 746f 5f63 6f6c 5f69   cs = [_to_col_i
+00006490: 665f 7374 7228 632c 2022 636f 756e 745f  f_str(c, "count_
+000064a0: 6469 7374 696e 6374 2229 2066 6f72 2063  distinct") for c
+000064b0: 2069 6e20 636f 6c73 5d0a 2020 2020 7265   in cols].    re
+000064c0: 7475 726e 2043 6f6c 756d 6e28 0a20 2020  turn Column(.   
+000064d0: 2020 2020 2046 756e 6374 696f 6e45 7870       FunctionExp
+000064e0: 7265 7373 696f 6e28 2263 6f75 6e74 222c  ression("count",
+000064f0: 205b 632e 5f65 7870 7265 7373 696f 6e20   [c._expression 
+00006500: 666f 7220 6320 696e 2063 735d 2c20 6973  for c in cs], is
+00006510: 5f64 6973 7469 6e63 743d 5472 7565 290a  _distinct=True).
+00006520: 2020 2020 290a 0a0a 6465 6620 636f 7661      )...def cova
+00006530: 725f 706f 7028 636f 6c75 6d6e 313a 2043  r_pop(column1: C
+00006540: 6f6c 756d 6e4f 724e 616d 652c 2063 6f6c  olumnOrName, col
+00006550: 756d 6e32 3a20 436f 6c75 6d6e 4f72 4e61  umn2: ColumnOrNa
+00006560: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00006570: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
+00006580: 6520 706f 7075 6c61 7469 6f6e 2063 6f76  e population cov
+00006590: 6172 6961 6e63 6520 666f 7220 6e6f 6e2d  ariance for non-
+000065a0: 6e75 6c6c 2070 6169 7273 2069 6e20 6120  null pairs in a 
+000065b0: 6772 6f75 702e 0a0a 2020 2020 4578 616d  group...    Exam
+000065c0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+000065d0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+000065e0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+000065f0: 6d70 6f72 7420 4465 6369 6d61 6c54 7970  mport DecimalTyp
+00006600: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+00006610: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00006620: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
+00006630: 2032 5d2c 205b 312c 2032 5d2c 205b 342c   2], [1, 2], [4,
+00006640: 2035 5d2c 205b 322c 2033 5d2c 205b 332c   5], [2, 3], [3,
+00006650: 204e 6f6e 655d 2c20 5b34 2c20 4e6f 6e65   None], [4, None
+00006660: 5d2c 205b 362c 345d 5d2c 2073 6368 656d  ], [6,4]], schem
+00006670: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+00006680: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00006690: 6563 7428 636f 7661 725f 706f 7028 636f  ect(covar_pop(co
+000066a0: 6c28 2261 2229 2c20 636f 6c28 2262 2229  l("a"), col("b")
+000066b0: 292e 6361 7374 2844 6563 696d 616c 5479  ).cast(DecimalTy
+000066c0: 7065 2873 6361 6c65 3d33 2929 2e61 6c69  pe(scale=3)).ali
+000066d0: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+000066e0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+000066f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00006700: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+00006710: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00006720: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e38  ---.        |1.8
+00006730: 3430 2020 2020 207c 0a20 2020 2020 2020  40     |.       
+00006740: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00006750: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00006760: 3e0a 2020 2020 2222 220a 2020 2020 636f  >.    """.    co
+00006770: 6c31 203d 205f 746f 5f63 6f6c 5f69 665f  l1 = _to_col_if_
+00006780: 7374 7228 636f 6c75 6d6e 312c 2022 636f  str(column1, "co
+00006790: 7661 725f 706f 7022 290a 2020 2020 636f  var_pop").    co
+000067a0: 6c32 203d 205f 746f 5f63 6f6c 5f69 665f  l2 = _to_col_if_
+000067b0: 7374 7228 636f 6c75 6d6e 322c 2022 636f  str(column2, "co
+000067c0: 7661 725f 706f 7022 290a 2020 2020 7265  var_pop").    re
+000067d0: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
+000067e0: 7661 725f 706f 7022 2928 636f 6c31 2c20  var_pop")(col1, 
+000067f0: 636f 6c32 290a 0a0a 6465 6620 636f 7661  col2)...def cova
+00006800: 725f 7361 6d70 2863 6f6c 756d 6e31 3a20  r_samp(column1: 
+00006810: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 636f  ColumnOrName, co
+00006820: 6c75 6d6e 323a 2043 6f6c 756d 6e4f 724e  lumn2: ColumnOrN
+00006830: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00006840: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00006850: 6865 2073 616d 706c 6520 636f 7661 7269  he sample covari
+00006860: 616e 6365 2066 6f72 206e 6f6e 2d6e 756c  ance for non-nul
+00006870: 6c20 7061 6972 7320 696e 2061 2067 726f  l pairs in a gro
+00006880: 7570 2e0a 0a20 2020 2045 7861 6d70 6c65  up...    Example
+00006890: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+000068a0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+000068b0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+000068c0: 7274 2044 6563 696d 616c 5479 7065 0a20  rt DecimalType. 
+000068d0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000068e0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000068f0: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
+00006900: 2c20 5b31 2c20 325d 2c20 5b34 2c20 355d  , [1, 2], [4, 5]
+00006910: 2c20 5b32 2c20 335d 2c20 5b33 2c20 4e6f  , [2, 3], [3, No
+00006920: 6e65 5d2c 205b 342c 204e 6f6e 655d 2c20  ne], [4, None], 
+00006930: 5b36 2c34 5d5d 2c20 7363 6865 6d61 3d5b  [6,4]], schema=[
+00006940: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00006950: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00006960: 2863 6f76 6172 5f73 616d 7028 636f 6c28  (covar_samp(col(
+00006970: 2261 2229 2c20 636f 6c28 2262 2229 292e  "a"), col("b")).
+00006980: 6361 7374 2844 6563 696d 616c 5479 7065  cast(DecimalType
+00006990: 2873 6361 6c65 3d33 2929 2e61 6c69 6173  (scale=3)).alias
+000069a0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+000069b0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+000069c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000069d0: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
+000069e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+000069f0: 2d0a 2020 2020 2020 2020 7c32 2e33 3030  -.        |2.300
+00006a00: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00006a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00006a20: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00006a30: 2020 2020 2222 220a 2020 2020 636f 6c31      """.    col1
+00006a40: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00006a50: 7228 636f 6c75 6d6e 312c 2022 636f 7661  r(column1, "cova
+00006a60: 725f 7361 6d70 2229 0a20 2020 2063 6f6c  r_samp").    col
+00006a70: 3220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  2 = _to_col_if_s
+00006a80: 7472 2863 6f6c 756d 6e32 2c20 2263 6f76  tr(column2, "cov
+00006a90: 6172 5f73 616d 7022 290a 2020 2020 7265  ar_samp").    re
+00006aa0: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
+00006ab0: 7661 725f 7361 6d70 2229 2863 6f6c 312c  var_samp")(col1,
+00006ac0: 2063 6f6c 3229 0a0a 0a64 6566 206b 7572   col2)...def kur
+00006ad0: 746f 7369 7328 653a 2043 6f6c 756d 6e4f  tosis(e: ColumnO
+00006ae0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00006af0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00006b00: 7475 726e 7320 7468 6520 706f 7075 6c61  turns the popula
+00006b10: 7469 6f6e 2065 7863 6573 7320 6b75 7274  tion excess kurt
+00006b20: 6f73 6973 206f 6620 6e6f 6e2d 4e55 4c4c  osis of non-NULL
+00006b30: 2072 6563 6f72 6473 2e20 4966 2061 6c6c   records. If all
+00006b40: 2072 6563 6f72 6473 0a20 2020 2069 6e73   records.    ins
+00006b50: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
+00006b60: 4e55 4c4c 2c20 7468 6520 6675 6e63 7469  NULL, the functi
+00006b70: 6f6e 2072 6574 7572 6e73 204e 554c 4c2e  on returns NULL.
+00006b80: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00006b90: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00006ba0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00006bb0: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
+00006bc0: 6d70 6f72 7420 6b75 7274 6f73 6973 0a20  mport kurtosis. 
+00006bd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00006be0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00006bf0: 6174 6166 7261 6d65 285b 312c 2033 2c20  ataframe([1, 3, 
+00006c00: 3130 2c20 312c 2033 5d2c 2073 6368 656d  10, 1, 3], schem
+00006c10: 613d 5b22 7822 5d29 0a20 2020 2020 2020  a=["x"]).       
+00006c20: 203e 3e3e 2064 662e 7365 6c65 6374 286b   >>> df.select(k
+00006c30: 7572 746f 7369 7328 2278 2229 2e61 735f  urtosis("x").as_
+00006c40: 2822 7822 2929 2e63 6f6c 6c65 6374 2829  ("x")).collect()
+00006c50: 0a20 2020 2020 2020 205b 526f 7728 583d  .        [Row(X=
+00006c60: 4465 6369 6d61 6c28 2733 2e36 3133 3733  Decimal('3.61373
+00006c70: 3636 3039 3935 3627 2929 5d0a 2020 2020  6609956'))].    
+00006c80: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00006c90: 636f 6c5f 6966 5f73 7472 2865 2c20 226b  col_if_str(e, "k
+00006ca0: 7572 746f 7369 7322 290a 2020 2020 7265  urtosis").    re
+00006cb0: 7475 726e 2062 7569 6c74 696e 2822 6b75  turn builtin("ku
+00006cc0: 7274 6f73 6973 2229 2863 290a 0a0a 6465  rtosis")(c)...de
+00006cd0: 6620 6d61 7828 653a 2043 6f6c 756d 6e4f  f max(e: ColumnO
+00006ce0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00006cf0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00006d00: 7475 726e 7320 7468 6520 6d61 7869 6d75  turns the maximu
+00006d10: 6d20 7661 6c75 6520 666f 7220 7468 6520  m value for the 
+00006d20: 7265 636f 7264 7320 696e 2061 2067 726f  records in a gro
+00006d30: 7570 2e20 4e55 4c4c 2076 616c 7565 7320  up. NULL values 
+00006d40: 6172 6520 6967 6e6f 7265 640a 2020 2020  are ignored.    
+00006d50: 756e 6c65 7373 2061 6c6c 2074 6865 2072  unless all the r
+00006d60: 6563 6f72 6473 2061 7265 204e 554c 4c2c  ecords are NULL,
+00006d70: 2069 6e20 7768 6963 6820 6361 7365 2061   in which case a
+00006d80: 204e 554c 4c20 7661 6c75 6520 6973 2072   NULL value is r
+00006d90: 6574 7572 6e65 642e 0a0a 2020 2020 4578  eturned...    Ex
+00006da0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00006db0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00006dc0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00006dd0: 6d65 285b 312c 2033 2c20 3130 2c20 312c  me([1, 3, 10, 1,
+00006de0: 2033 5d2c 2073 6368 656d 613d 5b22 7822   3], schema=["x"
+00006df0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00006e00: 662e 7365 6c65 6374 286d 6178 2822 7822  f.select(max("x"
+00006e10: 292e 6173 5f28 2278 2229 292e 636f 6c6c  ).as_("x")).coll
+00006e20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00006e30: 6f77 2858 3d31 3029 5d0a 2020 2020 2222  ow(X=10)].    ""
+00006e40: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00006e50: 6c5f 6966 5f73 7472 2865 2c20 226d 6178  l_if_str(e, "max
+00006e60: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00006e70: 696c 7469 6e28 226d 6178 2229 2863 290a  iltin("max")(c).
+00006e80: 0a0a 6465 6620 6d65 616e 2865 3a20 436f  ..def mean(e: Co
+00006e90: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00006ea0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00006eb0: 2020 2052 6574 7572 6e20 7468 6520 6176     Return the av
+00006ec0: 6572 6167 6520 666f 7220 7468 6520 7370  erage for the sp
+00006ed0: 6563 6966 6963 206e 756d 6572 6963 2063  ecific numeric c
+00006ee0: 6f6c 756d 6e73 2e20 416c 6961 7320 6f66  olumns. Alias of
+00006ef0: 203a 6675 6e63 3a60 6176 6760 2e0a 0a20   :func:`avg`... 
+00006f00: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00006f10: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00006f20: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00006f30: 7461 6672 616d 6528 5b31 2c20 332c 2031  taframe([1, 3, 1
+00006f40: 302c 2031 2c20 335d 2c20 7363 6865 6d61  0, 1, 3], schema
+00006f50: 3d5b 2278 225d 290a 2020 2020 2020 2020  =["x"]).        
+00006f60: 3e3e 3e20 6466 2e73 656c 6563 7428 6d65  >>> df.select(me
+00006f70: 616e 2822 7822 292e 6173 5f28 2278 2229  an("x").as_("x")
+00006f80: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00006f90: 2020 2020 5b52 6f77 2858 3d44 6563 696d      [Row(X=Decim
+00006fa0: 616c 2827 332e 3630 3030 3030 2729 295d  al('3.600000'))]
+00006fb0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00006fc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00006fd0: 652c 2022 6d65 616e 2229 0a20 2020 2072  e, "mean").    r
+00006fe0: 6574 7572 6e20 6176 6728 6329 0a0a 0a64  eturn avg(c)...d
+00006ff0: 6566 206d 6564 6961 6e28 653a 2043 6f6c  ef median(e: Col
+00007000: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00007010: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00007020: 2020 5265 7475 726e 7320 7468 6520 6d65    Returns the me
+00007030: 6469 616e 2076 616c 7565 2066 6f72 2074  dian value for t
+00007040: 6865 2072 6563 6f72 6473 2069 6e20 6120  he records in a 
+00007050: 6772 6f75 702e 204e 554c 4c20 7661 6c75  group. NULL valu
+00007060: 6573 2061 7265 2069 676e 6f72 6564 0a20  es are ignored. 
+00007070: 2020 2075 6e6c 6573 7320 616c 6c20 7468     unless all th
+00007080: 6520 7265 636f 7264 7320 6172 6520 4e55  e records are NU
+00007090: 4c4c 2c20 696e 2077 6869 6368 2063 6173  LL, in which cas
+000070a0: 6520 6120 4e55 4c4c 2076 616c 7565 2069  e a NULL value i
+000070b0: 7320 7265 7475 726e 6564 2e0a 0a20 2020  s returned...   
+000070c0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+000070d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000070e0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000070f0: 6672 616d 6528 5b31 2c20 332c 2031 302c  frame([1, 3, 10,
+00007100: 2031 2c20 335d 2c20 7363 6865 6d61 3d5b   1, 3], schema=[
+00007110: 2278 225d 290a 2020 2020 2020 2020 3e3e  "x"]).        >>
+00007120: 3e20 6466 2e73 656c 6563 7428 6d65 6469  > df.select(medi
+00007130: 616e 2822 7822 292e 6173 5f28 2278 2229  an("x").as_("x")
+00007140: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00007150: 2020 2020 5b52 6f77 2858 3d44 6563 696d      [Row(X=Decim
+00007160: 616c 2827 332e 3030 3027 2929 5d0a 2020  al('3.000'))].  
+00007170: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00007180: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00007190: 226d 6564 6961 6e22 290a 2020 2020 7265  "median").    re
+000071a0: 7475 726e 2062 7569 6c74 696e 2822 6d65  turn builtin("me
+000071b0: 6469 616e 2229 2863 290a 0a0a 6465 6620  dian")(c)...def 
+000071c0: 6d69 6e28 653a 2043 6f6c 756d 6e4f 724e  min(e: ColumnOrN
+000071d0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+000071e0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+000071f0: 726e 7320 7468 6520 6d69 6e69 6d75 6d20  rns the minimum 
+00007200: 7661 6c75 6520 666f 7220 7468 6520 7265  value for the re
+00007210: 636f 7264 7320 696e 2061 2067 726f 7570  cords in a group
+00007220: 2e20 4e55 4c4c 2076 616c 7565 7320 6172  . NULL values ar
+00007230: 6520 6967 6e6f 7265 640a 2020 2020 756e  e ignored.    un
+00007240: 6c65 7373 2061 6c6c 2074 6865 2072 6563  less all the rec
+00007250: 6f72 6473 2061 7265 204e 554c 4c2c 2069  ords are NULL, i
+00007260: 6e20 7768 6963 6820 6361 7365 2061 204e  n which case a N
+00007270: 554c 4c20 7661 6c75 6520 6973 2072 6574  ULL value is ret
+00007280: 7572 6e65 642e 0a0a 2020 2020 4578 616d  urned...    Exam
+00007290: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+000072a0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000072b0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000072c0: 285b 312c 2033 2c20 3130 2c20 312c 2033  ([1, 3, 10, 1, 3
+000072d0: 5d2c 2073 6368 656d 613d 5b22 7822 5d29  ], schema=["x"])
+000072e0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000072f0: 7365 6c65 6374 286d 696e 2822 7822 292e  select(min("x").
+00007300: 6173 5f28 2278 2229 292e 636f 6c6c 6563  as_("x")).collec
+00007310: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00007320: 2858 3d31 295d 0a20 2020 2022 2222 0a20  (X=1)].    """. 
+00007330: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00007340: 665f 7374 7228 652c 2022 6d69 6e22 290a  f_str(e, "min").
+00007350: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00007360: 696e 2822 6d69 6e22 2928 6329 0a0a 0a64  in("min")(c)...d
+00007370: 6566 206d 6f64 6528 653a 2043 6f6c 756d  ef mode(e: Colum
+00007380: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00007390: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000073a0: 5265 7475 726e 7320 7468 6520 6d6f 7374  Returns the most
+000073b0: 2066 7265 7175 656e 7420 7661 6c75 6520   frequent value 
+000073c0: 666f 7220 7468 6520 7265 636f 7264 7320  for the records 
+000073d0: 696e 2061 2067 726f 7570 2e20 4e55 4c4c  in a group. NULL
+000073e0: 2076 616c 7565 7320 6172 6520 6967 6e6f   values are igno
+000073f0: 7265 642e 0a20 2020 2049 6620 616c 6c20  red..    If all 
+00007400: 7468 6520 7661 6c75 6573 2061 7265 204e  the values are N
+00007410: 554c 4c2c 206f 7220 7468 6572 6520 6172  ULL, or there ar
+00007420: 6520 3020 726f 7773 2c20 7468 656e 2074  e 0 rows, then t
+00007430: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+00007440: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
+00007450: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00007460: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00007470: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00007480: 616d 6528 5b31 2c20 332c 2031 302c 2031  ame([1, 3, 10, 1
+00007490: 2c20 345d 2c20 7363 6865 6d61 3d5b 2278  , 4], schema=["x
+000074a0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000074b0: 6466 2e73 656c 6563 7428 6d6f 6465 2822  df.select(mode("
+000074c0: 7822 292e 6173 5f28 2278 2229 292e 636f  x").as_("x")).co
+000074d0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000074e0: 5b52 6f77 2858 3d31 295d 0a20 2020 2022  [Row(X=1)].    "
+000074f0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00007500: 6f6c 5f69 665f 7374 7228 652c 2022 6d6f  ol_if_str(e, "mo
+00007510: 6465 2229 0a20 2020 2072 6574 7572 6e20  de").    return 
+00007520: 6275 696c 7469 6e28 226d 6f64 6522 2928  builtin("mode")(
+00007530: 6329 0a0a 0a64 6566 2073 6b65 7728 653a  c)...def skew(e:
+00007540: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00007550: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00007560: 2252 6574 7572 6e73 2074 6865 2073 616d  "Returns the sam
+00007570: 706c 6520 736b 6577 6e65 7373 206f 6620  ple skewness of 
+00007580: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
+00007590: 2e20 4966 2061 6c6c 2072 6563 6f72 6473  . If all records
+000075a0: 2069 6e73 6964 6520 6120 6772 6f75 700a   inside a group.
+000075b0: 2020 2020 6172 6520 4e55 4c4c 2c20 7468      are NULL, th
+000075c0: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+000075d0: 6e73 204e 554c 4c2e 0a0a 2020 2020 4578  ns NULL...    Ex
+000075e0: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+000075f0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00007600: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+00007610: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
+00007620: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+00007630: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00007640: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00007650: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00007660: 5b31 302c 2031 302c 2032 302c 2032 352c  [10, 10, 20, 25,
+00007670: 2033 305d 2c0a 2020 2020 2020 2020 2e2e   30],.        ..
+00007680: 2e20 2020 2020 7363 6865 6d61 3d5b 2261  .     schema=["a
+00007690: 225d 0a20 2020 2020 2020 202e 2e2e 2029  "].        ... )
+000076a0: 2e73 656c 6563 7428 736b 6577 2822 6122  .select(skew("a"
+000076b0: 292e 6361 7374 2844 6563 696d 616c 5479  ).cast(DecimalTy
+000076c0: 7065 2873 6361 6c65 3d34 2929 290a 2020  pe(scale=4))).  
+000076d0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+000076e0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000076f0: 526f 7728 4341 5354 2028 534b 4557 2822  Row(CAST (SKEW("
+00007700: 4122 2920 4153 204e 554d 4245 5228 3338  A") AS NUMBER(38
+00007710: 2c20 3429 293d 4465 6369 6d61 6c28 2730  , 4))=Decimal('0
+00007720: 2e30 3532 3427 2929 5d0a 2020 2020 2222  .0524'))].    ""
+00007730: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00007740: 6c5f 6966 5f73 7472 2865 2c20 2273 6b65  l_if_str(e, "ske
+00007750: 7722 290a 2020 2020 7265 7475 726e 2062  w").    return b
+00007760: 7569 6c74 696e 2822 736b 6577 2229 2863  uiltin("skew")(c
+00007770: 290a 0a0a 6465 6620 7374 6464 6576 2865  )...def stddev(e
+00007780: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00007790: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000077a0: 2222 5265 7475 726e 7320 7468 6520 7361  ""Returns the sa
+000077b0: 6d70 6c65 2073 7461 6e64 6172 6420 6465  mple standard de
+000077c0: 7669 6174 696f 6e20 2873 7175 6172 6520  viation (square 
+000077d0: 726f 6f74 206f 6620 7361 6d70 6c65 2076  root of sample v
+000077e0: 6172 6961 6e63 6529 206f 660a 2020 2020  ariance) of.    
+000077f0: 6e6f 6e2d 4e55 4c4c 2076 616c 7565 732e  non-NULL values.
+00007800: 2049 6620 616c 6c20 7265 636f 7264 7320   If all records 
+00007810: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00007820: 7265 204e 554c 4c2c 2072 6574 7572 6e73  re NULL, returns
+00007830: 204e 554c 4c2e 0a0a 2020 2020 4578 616d   NULL...    Exam
+00007840: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00007850: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+00007860: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+00007870: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
+00007880: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+00007890: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000078a0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+000078b0: 2020 2020 2020 2e2e 2e20 2020 2020 5b34        ...     [4
+000078c0: 2c20 395d 2c0a 2020 2020 2020 2020 2e2e  , 9],.        ..
+000078d0: 2e20 2020 2020 7363 6865 6d61 3d5b 224e  .     schema=["N
+000078e0: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
+000078f0: 292e 7365 6c65 6374 2873 7464 6465 7628  ).select(stddev(
+00007900: 636f 6c28 224e 2229 292e 6361 7374 2844  col("N")).cast(D
+00007910: 6563 696d 616c 5479 7065 2873 6361 6c65  ecimalType(scale
+00007920: 3d34 2929 290a 2020 2020 2020 2020 3e3e  =4))).        >>
+00007930: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
+00007940: 2020 2020 2020 205b 526f 7728 4341 5354         [Row(CAST
+00007950: 2028 5354 4444 4556 2822 4e22 2920 4153   (STDDEV("N") AS
+00007960: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
+00007970: 4465 6369 6d61 6c28 2733 2e35 3335 3527  Decimal('3.5355'
+00007980: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+00007990: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+000079a0: 7472 2865 2c20 2273 7464 6465 7622 290a  tr(e, "stddev").
+000079b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000079c0: 696e 2822 7374 6464 6576 2229 2863 290a  in("stddev")(c).
+000079d0: 0a0a 6465 6620 7374 6464 6576 5f73 616d  ..def stddev_sam
+000079e0: 7028 653a 2043 6f6c 756d 6e4f 724e 616d  p(e: ColumnOrNam
+000079f0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00007a00: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+00007a10: 2073 616d 706c 6520 7374 616e 6461 7264   sample standard
+00007a20: 2064 6576 6961 7469 6f6e 2028 7371 7561   deviation (squa
+00007a30: 7265 2072 6f6f 7420 6f66 2073 616d 706c  re root of sampl
+00007a40: 6520 7661 7269 616e 6365 2920 6f66 0a20  e variance) of. 
+00007a50: 2020 206e 6f6e 2d4e 554c 4c20 7661 6c75     non-NULL valu
+00007a60: 6573 2e20 4966 2061 6c6c 2072 6563 6f72  es. If all recor
+00007a70: 6473 2069 6e73 6964 6520 6120 6772 6f75  ds inside a grou
+00007a80: 7020 6172 6520 4e55 4c4c 2c20 7265 7475  p are NULL, retu
+00007a90: 726e 7320 4e55 4c4c 2e20 416c 6961 7320  rns NULL. Alias 
+00007aa0: 6f66 0a20 2020 203a 6675 6e63 3a60 7374  of.    :func:`st
+00007ab0: 6464 6576 602e 0a0a 2020 2020 4578 616d  ddev`...    Exam
+00007ac0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00007ad0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+00007ae0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+00007af0: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
+00007b00: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+00007b10: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00007b20: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+00007b30: 2020 2020 2020 2e2e 2e20 2020 2020 5b34        ...     [4
+00007b40: 2c20 395d 2c0a 2020 2020 2020 2020 2e2e  , 9],.        ..
+00007b50: 2e20 2020 2020 7363 6865 6d61 3d5b 224e  .     schema=["N
+00007b60: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
+00007b70: 292e 7365 6c65 6374 2873 7464 6465 765f  ).select(stddev_
+00007b80: 7361 6d70 2863 6f6c 2822 4e22 2929 2e63  samp(col("N")).c
+00007b90: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
+00007ba0: 7363 616c 653d 3429 2929 0a20 2020 2020  scale=4))).     
+00007bb0: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
+00007bc0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00007bd0: 2843 4153 5420 2853 5444 4445 565f 5341  (CAST (STDDEV_SA
+00007be0: 4d50 2822 4e22 2920 4153 204e 554d 4245  MP("N") AS NUMBE
+00007bf0: 5228 3338 2c20 3429 293d 4465 6369 6d61  R(38, 4))=Decima
+00007c00: 6c28 2733 2e35 3335 3527 2929 5d0a 2020  l('3.5355'))].  
+00007c10: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00007c20: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00007c30: 2273 7464 6465 765f 7361 6d70 2229 0a20  "stddev_samp"). 
+00007c40: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00007c50: 6e28 2273 7464 6465 765f 7361 6d70 2229  n("stddev_samp")
+00007c60: 2863 290a 0a0a 6465 6620 7374 6464 6576  (c)...def stddev
+00007c70: 5f70 6f70 2865 3a20 436f 6c75 6d6e 4f72  _pop(e: ColumnOr
+00007c80: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00007c90: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00007ca0: 7468 6520 706f 7075 6c61 7469 6f6e 2073  the population s
+00007cb0: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+00007cc0: 6e20 2873 7175 6172 6520 726f 6f74 206f  n (square root o
+00007cd0: 6620 7661 7269 616e 6365 2920 6f66 206e  f variance) of n
+00007ce0: 6f6e 2d4e 554c 4c0a 2020 2020 7661 6c75  on-NULL.    valu
+00007cf0: 6573 2e20 4966 2061 6c6c 2072 6563 6f72  es. If all recor
+00007d00: 6473 2069 6e73 6964 6520 6120 6772 6f75  ds inside a grou
+00007d10: 7020 6172 6520 4e55 4c4c 2c20 7265 7475  p are NULL, retu
+00007d20: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
+00007d30: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00007d40: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00007d50: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00007d60: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
+00007d70: 2020 2020 5b34 2c20 395d 2c0a 2020 2020      [4, 9],.    
+00007d80: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+00007d90: 6d61 3d5b 224e 225d 2c0a 2020 2020 2020  ma=["N"],.      
+00007da0: 2020 2e2e 2e20 292e 7365 6c65 6374 2873    ... ).select(s
+00007db0: 7464 6465 765f 706f 7028 636f 6c28 224e  tddev_pop(col("N
+00007dc0: 2229 2929 0a20 2020 2020 2020 203e 3e3e  "))).        >>>
+00007dd0: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+00007de0: 2020 2020 2020 5b52 6f77 2853 5444 4445        [Row(STDDE
+00007df0: 565f 504f 5028 224e 2229 3d32 2e35 295d  V_POP("N")=2.5)]
+00007e00: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00007e10: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00007e20: 652c 2022 7374 6464 6576 5f70 6f70 2229  e, "stddev_pop")
+00007e30: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00007e40: 7469 6e28 2273 7464 6465 765f 706f 7022  tin("stddev_pop"
+00007e50: 2928 6329 0a0a 0a64 6566 2073 756d 2865  )(c)...def sum(e
+00007e60: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00007e70: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00007e80: 2222 5265 7475 726e 7320 7468 6520 7375  ""Returns the su
+00007e90: 6d20 6f66 206e 6f6e 2d4e 554c 4c20 7265  m of non-NULL re
+00007ea0: 636f 7264 7320 696e 2061 2067 726f 7570  cords in a group
+00007eb0: 2e20 596f 7520 6361 6e20 7573 6520 7468  . You can use th
+00007ec0: 6520 4449 5354 494e 4354 206b 6579 776f  e DISTINCT keywo
+00007ed0: 7264 0a20 2020 2074 6f20 636f 6d70 7574  rd.    to comput
+00007ee0: 6520 7468 6520 7375 6d20 6f66 2075 6e69  e the sum of uni
+00007ef0: 7175 6520 6e6f 6e2d 6e75 6c6c 2076 616c  que non-null val
+00007f00: 7565 732e 2049 6620 616c 6c20 7265 636f  ues. If all reco
+00007f10: 7264 7320 696e 7369 6465 2061 2067 726f  rds inside a gro
+00007f20: 7570 2061 7265 0a20 2020 204e 554c 4c2c  up are.    NULL,
+00007f30: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
+00007f40: 7475 726e 7320 4e55 4c4c 2e0a 0a20 2020  turns NULL...   
+00007f50: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00007f60: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00007f70: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00007f80: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00007f90: 2e20 2020 2020 5b34 2c20 395d 2c0a 2020  .     [4, 9],.  
+00007fa0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+00007fb0: 6865 6d61 3d5b 224e 225d 2c0a 2020 2020  hema=["N"],.    
+00007fc0: 2020 2020 2e2e 2e20 292e 7365 6c65 6374      ... ).select
+00007fd0: 2873 756d 2863 6f6c 2822 4e22 2929 290a  (sum(col("N"))).
+00007fe0: 2020 2020 2020 2020 3e3e 3e20 6466 2e63          >>> df.c
+00007ff0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00008000: 205b 526f 7728 5355 4d28 224e 2229 3d31   [Row(SUM("N")=1
+00008010: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
+00008020: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00008030: 7472 2865 2c20 2273 756d 2229 0a20 2020  tr(e, "sum").   
+00008040: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00008050: 2273 756d 2229 2863 290a 0a0a 6465 6620  "sum")(c)...def 
+00008060: 7375 6d5f 6469 7374 696e 6374 2865 3a20  sum_distinct(e: 
+00008070: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00008080: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00008090: 5265 7475 726e 7320 7468 6520 7375 6d20  Returns the sum 
+000080a0: 6f66 206e 6f6e 2d4e 554c 4c20 6469 7374  of non-NULL dist
+000080b0: 696e 6374 2072 6563 6f72 6473 2069 6e20  inct records in 
+000080c0: 6120 6772 6f75 702e 2059 6f75 2063 616e  a group. You can
+000080d0: 2075 7365 2074 6865 0a20 2020 2044 4953   use the.    DIS
+000080e0: 5449 4e43 5420 6b65 7977 6f72 6420 746f  TINCT keyword to
+000080f0: 2063 6f6d 7075 7465 2074 6865 2073 756d   compute the sum
+00008100: 206f 6620 756e 6971 7565 206e 6f6e 2d6e   of unique non-n
+00008110: 756c 6c20 7661 6c75 6573 2e20 4966 2061  ull values. If a
+00008120: 6c6c 2072 6563 6f72 6473 0a20 2020 2069  ll records.    i
+00008130: 6e73 6964 6520 6120 6772 6f75 7020 6172  nside a group ar
+00008140: 6520 4e55 4c4c 2c20 7468 6520 6675 6e63  e NULL, the func
+00008150: 7469 6f6e 2072 6574 7572 6e73 204e 554c  tion returns NUL
+00008160: 4c2e 0a0a 2020 2020 4578 616d 706c 653a  L...    Example:
+00008170: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+00008180: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00008190: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+000081a0: 2020 2020 202e 2e2e 2020 2020 205b 312c       ...     [1,
+000081b0: 2032 2c20 4e6f 6e65 2c20 335d 2c0a 2020   2, None, 3],.  
+000081c0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+000081d0: 6865 6d61 3d5b 224e 225d 2c0a 2020 2020  hema=["N"],.    
+000081e0: 2020 2020 2e2e 2e20 292e 7365 6c65 6374      ... ).select
+000081f0: 2873 756d 5f64 6973 7469 6e63 7428 636f  (sum_distinct(co
+00008200: 6c28 224e 2229 2929 0a20 2020 2020 2020  l("N"))).       
+00008210: 203e 3e3e 2064 662e 636f 6c6c 6563 7428   >>> df.collect(
+00008220: 290a 2020 2020 2020 2020 5b52 6f77 2853  ).        [Row(S
+00008230: 554d 2820 4449 5354 494e 4354 2022 4e22  UM( DISTINCT "N"
+00008240: 293d 3629 5d0a 2020 2020 2222 220a 2020  )=6)].    """.  
+00008250: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00008260: 5f73 7472 2865 2c20 2273 756d 5f64 6973  _str(e, "sum_dis
+00008270: 7469 6e63 7422 290a 2020 2020 7265 7475  tinct").    retu
+00008280: 726e 205f 6361 6c6c 5f66 756e 6374 696f  rn _call_functio
+00008290: 6e28 2273 756d 222c 2054 7275 652c 2063  n("sum", True, c
+000082a0: 290a 0a0a 6465 6620 7661 7269 616e 6365  )...def variance
+000082b0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+000082c0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000082d0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+000082e0: 7361 6d70 6c65 2076 6172 6961 6e63 6520  sample variance 
+000082f0: 6f66 206e 6f6e 2d4e 554c 4c20 7265 636f  of non-NULL reco
+00008300: 7264 7320 696e 2061 2067 726f 7570 2e20  rds in a group. 
+00008310: 4966 2061 6c6c 2072 6563 6f72 6473 0a20  If all records. 
+00008320: 2020 2069 6e73 6964 6520 6120 6772 6f75     inside a grou
+00008330: 7020 6172 6520 4e55 4c4c 2c20 6120 4e55  p are NULL, a NU
+00008340: 4c4c 2069 7320 7265 7475 726e 6564 2e20  LL is returned. 
+00008350: 466f 7220 6120 7369 6e67 6c65 2072 6f77  For a single row
+00008360: 2c20 4e55 4c4c 2069 7320 7265 7475 726e  , NULL is return
+00008370: 6564 2061 7320 7361 6d70 6c65 2076 6172  ed as sample var
+00008380: 6961 6e63 652e 0a0a 2020 2020 4578 616d  iance...    Exam
+00008390: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+000083a0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000083b0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000083c0: 285b 312c 202d 312c 2031 2c20 2d31 2c20  ([1, -1, 1, -1, 
+000083d0: 2d31 5d2c 2073 6368 656d 613d 5b22 6122  -1], schema=["a"
+000083e0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+000083f0: 662e 7365 6c65 6374 2876 6172 6961 6e63  f.select(varianc
+00008400: 6528 636f 6c28 2261 2229 2929 2e63 6f6c  e(col("a"))).col
+00008410: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00008420: 526f 7728 5641 5249 414e 4345 2822 4122  Row(VARIANCE("A"
+00008430: 293d 4465 6369 6d61 6c28 2731 2e32 3030  )=Decimal('1.200
+00008440: 3030 3027 2929 5d0a 0a20 2020 2020 2020  000'))]..       
+00008450: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00008460: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00008470: 6d65 285b 312c 204e 6f6e 652c 2032 2c20  me([1, None, 2, 
+00008480: 332c 204e 6f6e 652c 2035 2c20 365d 2c20  3, None, 5, 6], 
+00008490: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+000084a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000084b0: 6563 7428 7661 7269 616e 6365 2863 6f6c  ect(variance(col
+000084c0: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+000084d0: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
+000084e0: 4152 4941 4e43 4528 2241 2229 3d44 6563  ARIANCE("A")=Dec
+000084f0: 696d 616c 2827 342e 3330 3030 3030 2729  imal('4.300000')
+00008500: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
+00008510: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00008520: 6174 655f 6461 7461 6672 616d 6528 5b4e  ate_dataframe([N
+00008530: 6f6e 652c 204e 6f6e 652c 204e 6f6e 655d  one, None, None]
+00008540: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00008550: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00008560: 656c 6563 7428 7661 7269 616e 6365 2863  elect(variance(c
+00008570: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
+00008580: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00008590: 2856 4152 4941 4e43 4528 2241 2229 3d4e  (VARIANCE("A")=N
+000085a0: 6f6e 6529 5d0a 0a20 2020 2020 2020 203e  one)]..        >
+000085b0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000085c0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000085d0: 285b 3432 5d2c 2073 6368 656d 613d 5b22  ([42], schema=["
+000085e0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+000085f0: 2064 662e 7365 6c65 6374 2876 6172 6961   df.select(varia
+00008600: 6e63 6528 636f 6c28 2261 2229 2929 2e63  nce(col("a"))).c
+00008610: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00008620: 205b 526f 7728 5641 5249 414e 4345 2822   [Row(VARIANCE("
+00008630: 4122 293d 4e6f 6e65 295d 0a0a 2020 2020  A")=None)]..    
+00008640: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00008650: 636f 6c5f 6966 5f73 7472 2865 2c20 2276  col_if_str(e, "v
+00008660: 6172 6961 6e63 6522 290a 2020 2020 7265  ariance").    re
+00008670: 7475 726e 2062 7569 6c74 696e 2822 7661  turn builtin("va
+00008680: 7269 616e 6365 2229 2863 290a 0a0a 6465  riance")(c)...de
+00008690: 6620 7661 725f 7361 6d70 2865 3a20 436f  f var_samp(e: Co
+000086a0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000086b0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+000086c0: 7475 726e 7320 7468 6520 7361 6d70 6c65  turns the sample
+000086d0: 2076 6172 6961 6e63 6520 6f66 206e 6f6e   variance of non
+000086e0: 2d4e 554c 4c20 7265 636f 7264 7320 696e  -NULL records in
+000086f0: 2061 2067 726f 7570 2e20 4966 2061 6c6c   a group. If all
+00008700: 2072 6563 6f72 6473 0a20 2020 2069 6e73   records.    ins
+00008710: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
+00008720: 4e55 4c4c 2c20 6120 4e55 4c4c 2069 7320  NULL, a NULL is 
+00008730: 7265 7475 726e 6564 2e20 466f 7220 6120  returned. For a 
+00008740: 7369 6e67 6c65 2072 6f77 2c20 4e55 4c4c  single row, NULL
+00008750: 2069 7320 7265 7475 726e 6564 2061 7320   is returned as 
+00008760: 7361 6d70 6c65 2076 6172 6961 6e63 652e  sample variance.
+00008770: 0a20 2020 2041 6c69 6173 206f 6620 3a66  .    Alias of :f
+00008780: 756e 633a 6076 6172 6961 6e63 6560 0a0a  unc:`variance`..
+00008790: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+000087a0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000087b0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000087c0: 6174 6166 7261 6d65 285b 312c 202d 312c  ataframe([1, -1,
+000087d0: 2031 2c20 2d31 2c20 2d31 5d2c 2073 6368   1, -1, -1], sch
+000087e0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+000087f0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00008800: 2876 6172 5f73 616d 7028 636f 6c28 2261  (var_samp(col("a
+00008810: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+00008820: 2020 2020 2020 205b 526f 7728 5641 5249         [Row(VARI
+00008830: 414e 4345 2822 4122 293d 4465 6369 6d61  ANCE("A")=Decima
+00008840: 6c28 2731 2e32 3030 3030 3027 2929 5d0a  l('1.200000'))].
+00008850: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00008860: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00008870: 5f64 6174 6166 7261 6d65 285b 312c 204e  _dataframe([1, N
+00008880: 6f6e 652c 2032 2c20 332c 204e 6f6e 652c  one, 2, 3, None,
+00008890: 2035 2c20 365d 2c20 7363 6865 6d61 3d5b   5, 6], schema=[
+000088a0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+000088b0: 3e20 6466 2e73 656c 6563 7428 7661 725f  > df.select(var_
+000088c0: 7361 6d70 2863 6f6c 2822 6122 2929 292e  samp(col("a"))).
+000088d0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000088e0: 2020 5b52 6f77 2856 4152 4941 4e43 4528    [Row(VARIANCE(
+000088f0: 2241 2229 3d44 6563 696d 616c 2827 342e  "A")=Decimal('4.
+00008900: 3330 3030 3030 2729 295d 0a0a 2020 2020  300000'))]..    
+00008910: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00008920: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00008930: 6672 616d 6528 5b4e 6f6e 652c 204e 6f6e  frame([None, Non
+00008940: 652c 204e 6f6e 655d 2c20 7363 6865 6d61  e, None], schema
+00008950: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00008960: 3e3e 3e20 6466 2e73 656c 6563 7428 7661  >>> df.select(va
+00008970: 725f 7361 6d70 2863 6f6c 2822 6122 2929  r_samp(col("a"))
+00008980: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00008990: 2020 2020 5b52 6f77 2856 4152 4941 4e43      [Row(VARIANC
+000089a0: 4528 2241 2229 3d4e 6f6e 6529 5d0a 0a20  E("A")=None)].. 
+000089b0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000089c0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000089d0: 6174 6166 7261 6d65 285b 3432 5d2c 2073  ataframe([42], s
+000089e0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+000089f0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00008a00: 6374 2876 6172 5f73 616d 7028 636f 6c28  ct(var_samp(col(
+00008a10: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
+00008a20: 0a20 2020 2020 2020 205b 526f 7728 5641  .        [Row(VA
+00008a30: 5249 414e 4345 2822 4122 293d 4e6f 6e65  RIANCE("A")=None
+00008a40: 295d 0a0a 2020 2020 2222 220a 2020 2020  )]..    """.    
+00008a50: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00008a60: 7472 2865 2c20 2276 6172 5f73 616d 7022  tr(e, "var_samp"
+00008a70: 290a 2020 2020 7265 7475 726e 2076 6172  ).    return var
+00008a80: 6961 6e63 6528 6329 0a0a 0a64 6566 2076  iance(c)...def v
+00008a90: 6172 5f70 6f70 2865 3a20 436f 6c75 6d6e  ar_pop(e: Column
+00008aa0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00008ab0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00008ac0: 7320 7468 6520 706f 7075 6c61 7469 6f6e  s the population
+00008ad0: 2076 6172 6961 6e63 6520 6f66 206e 6f6e   variance of non
+00008ae0: 2d4e 554c 4c20 7265 636f 7264 7320 696e  -NULL records in
+00008af0: 2061 2067 726f 7570 2e20 4966 2061 6c6c   a group. If all
+00008b00: 2072 6563 6f72 6473 0a20 2020 2069 6e73   records.    ins
+00008b10: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
+00008b20: 4e55 4c4c 2c20 6120 4e55 4c4c 2069 7320  NULL, a NULL is 
+00008b30: 7265 7475 726e 6564 2e20 5468 6520 706f  returned. The po
+00008b40: 7075 6c61 7469 6f6e 2076 6172 6961 6e63  pulation varianc
+00008b50: 6520 6f66 2061 2073 696e 676c 6520 726f  e of a single ro
+00008b60: 7720 6973 2030 2e30 2e0a 0a20 2020 2045  w is 0.0...    E
+00008b70: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00008b80: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00008b90: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00008ba0: 616d 6528 5b31 2c20 2d31 2c20 312c 202d  ame([1, -1, 1, -
+00008bb0: 312c 202d 315d 2c20 7363 6865 6d61 3d5b  1, -1], schema=[
+00008bc0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00008bd0: 3e20 6466 2e73 656c 6563 7428 7661 725f  > df.select(var_
+00008be0: 706f 7028 636f 6c28 2261 2229 2929 2e63  pop(col("a"))).c
+00008bf0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00008c00: 205b 526f 7728 5641 525f 504f 5028 2241   [Row(VAR_POP("A
+00008c10: 2229 3d44 6563 696d 616c 2827 302e 3936  ")=Decimal('0.96
+00008c20: 3030 3030 2729 295d 0a0a 2020 2020 2020  0000'))]..      
+00008c30: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00008c40: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00008c50: 616d 6528 5b31 2c20 4e6f 6e65 2c20 322c  ame([1, None, 2,
+00008c60: 2033 2c20 4e6f 6e65 2c20 352c 2036 5d2c   3, None, 5, 6],
+00008c70: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00008c80: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00008c90: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
+00008ca0: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+00008cb0: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
+00008cc0: 4152 5f50 4f50 2822 4122 293d 4465 6369  AR_POP("A")=Deci
+00008cd0: 6d61 6c28 2733 2e34 3430 3030 3027 2929  mal('3.440000'))
+00008ce0: 5d0a 0a20 2020 2020 2020 203e 3e3e 2064  ]..        >>> d
+00008cf0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00008d00: 7465 5f64 6174 6166 7261 6d65 285b 4e6f  te_dataframe([No
+00008d10: 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c  ne, None, None],
+00008d20: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00008d30: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00008d40: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
+00008d50: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+00008d60: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
+00008d70: 4152 5f50 4f50 2822 4122 293d 4e6f 6e65  AR_POP("A")=None
+00008d80: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
+00008d90: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00008da0: 6174 655f 6461 7461 6672 616d 6528 5b34  ate_dataframe([4
+00008db0: 325d 2c20 7363 6865 6d61 3d5b 2261 225d  2], schema=["a"]
+00008dc0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00008dd0: 2e73 656c 6563 7428 7661 725f 706f 7028  .select(var_pop(
+00008de0: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
+00008df0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00008e00: 7728 5641 525f 504f 5028 2241 2229 3d44  w(VAR_POP("A")=D
+00008e10: 6563 696d 616c 2827 302e 3030 3030 3030  ecimal('0.000000
+00008e20: 2729 295d 0a0a 2020 2020 2222 220a 2020  '))]..    """.  
+00008e30: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00008e40: 5f73 7472 2865 2c20 2276 6172 5f70 6f70  _str(e, "var_pop
+00008e50: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00008e60: 696c 7469 6e28 2276 6172 5f70 6f70 2229  iltin("var_pop")
+00008e70: 2863 290a 0a0a 6465 6620 6170 7072 6f78  (c)...def approx
+00008e80: 5f70 6572 6365 6e74 696c 6528 636f 6c3a  _percentile(col:
+00008e90: 2043 6f6c 756d 6e4f 724e 616d 652c 2070   ColumnOrName, p
+00008ea0: 6572 6365 6e74 696c 653a 2066 6c6f 6174  ercentile: float
+00008eb0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00008ec0: 2022 2222 5265 7475 726e 7320 616e 2061   """Returns an a
+00008ed0: 7070 726f 7869 6d61 7465 6420 7661 6c75  pproximated valu
+00008ee0: 6520 666f 7220 7468 6520 6465 7369 7265  e for the desire
+00008ef0: 6420 7065 7263 656e 7469 6c65 2e20 5468  d percentile. Th
+00008f00: 6973 2066 756e 6374 696f 6e20 7573 6573  is function uses
+00008f10: 2074 6865 2074 2d44 6967 6573 7420 616c   the t-Digest al
+00008f20: 676f 7269 7468 6d2e 0a0a 2020 2020 4578  gorithm...    Ex
+00008f30: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00008f40: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00008f50: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00008f60: 6528 5b30 2c31 2c32 2c33 2c34 2c35 2c36  e([0,1,2,3,4,5,6
+00008f70: 2c37 2c38 2c39 5d2c 2073 6368 656d 613d  ,7,8,9], schema=
+00008f80: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+00008f90: 3e3e 2064 662e 7365 6c65 6374 2861 7070  >> df.select(app
+00008fa0: 726f 785f 7065 7263 656e 7469 6c65 2822  rox_percentile("
+00008fb0: 6122 2c20 302e 3529 2e61 6c69 6173 2822  a", 0.5).alias("
+00008fc0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00008fd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00008fe0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00008ff0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+00009000: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00009010: 2020 2020 2020 2020 7c34 2e35 2020 2020          |4.5    
+00009020: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00009030: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00009040: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00009050: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00009060: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+00009070: 2c20 2261 7070 726f 785f 7065 7263 656e  , "approx_percen
+00009080: 7469 6c65 2229 0a20 2020 2072 6574 7572  tile").    retur
+00009090: 6e20 6275 696c 7469 6e28 2261 7070 726f  n builtin("appro
+000090a0: 785f 7065 7263 656e 7469 6c65 2229 2863  x_percentile")(c
+000090b0: 2c20 6c69 7428 7065 7263 656e 7469 6c65  , lit(percentile
+000090c0: 2929 0a0a 0a64 6566 2061 7070 726f 785f  ))...def approx_
+000090d0: 7065 7263 656e 7469 6c65 5f61 6363 756d  percentile_accum
+000090e0: 756c 6174 6528 636f 6c3a 2043 6f6c 756d  ulate(col: Colum
+000090f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00009100: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00009110: 6e73 2074 6865 2069 6e74 6572 6e61 6c20  ns the internal 
+00009120: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
+00009130: 6620 7468 6520 742d 4469 6765 7374 2073  f the t-Digest s
+00009140: 7461 7465 2028 6173 2061 204a 534f 4e20  tate (as a JSON 
+00009150: 6f62 6a65 6374 2920 6174 2074 6865 2065  object) at the e
+00009160: 6e64 206f 6620 6167 6772 6567 6174 696f  nd of aggregatio
+00009170: 6e2e 0a20 2020 2054 6869 7320 6675 6e63  n..    This func
+00009180: 7469 6f6e 2075 7365 7320 7468 6520 742d  tion uses the t-
+00009190: 4469 6765 7374 2061 6c67 6f72 6974 686d  Digest algorithm
+000091a0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000091b0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000091c0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000091d0: 5f64 6174 6166 7261 6d65 285b 312c 322c  _dataframe([1,2,
+000091e0: 332c 342c 355d 2c20 7363 6865 6d61 3d5b  3,4,5], schema=[
+000091f0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00009200: 3e20 6466 2e73 656c 6563 7428 6170 7072  > df.select(appr
+00009210: 6f78 5f70 6572 6365 6e74 696c 655f 6163  ox_percentile_ac
+00009220: 6375 6d75 6c61 7465 2822 6122 292e 616c  cumulate("a").al
+00009230: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+00009240: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00009250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00009270: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00009280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009290: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000092a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000092b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000092c0: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 7c0a 2020 2020 2020 2020 7c20 2022 7374  |.        |  "st
+000092f0: 6174 6522 3a20 5b20 2020 2020 2020 2020  ate": [         
+00009300: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00009310: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
+00009320: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
+00009330: 2020 2020 2020 2020 7c20 2020 2031 2e30          |    1.0
+00009340: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
+00009350: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
+00009360: 2020 2020 322e 3030 3030 3030 3030 3030      2.0000000000
+00009370: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
+00009380: 2020 2020 2020 7c20 2020 2031 2e30 3030        |    1.000
+00009390: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
+000093a0: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
+000093b0: 2020 332e 3030 3030 3030 3030 3030 3030    3.000000000000
+000093c0: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
+000093d0: 2020 2020 7c20 2020 2031 2e30 3030 3030      |    1.00000
+000093e0: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
+000093f0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+00009400: 342e 3030 3030 3030 3030 3030 3030 3030  4.00000000000000
+00009410: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
+00009420: 2020 7c20 2020 2031 2e30 3030 3030 3030    |    1.0000000
+00009430: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
+00009440: 0a20 2020 2020 2020 207c 2020 2020 352e  .        |    5.
+00009450: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
+00009460: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
+00009470: 7c20 2020 2031 2e30 3030 3030 3030 3030  |    1.000000000
+00009480: 3030 3030 3030 652b 3030 2020 207c 0a20  000000e+00   |. 
+00009490: 2020 2020 2020 207c 2020 5d2c 2020 2020         |  ],    
+000094a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094b0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+000094c0: 2022 7479 7065 223a 2022 7464 6967 6573   "type": "tdiges
+000094d0: 7422 2c20 2020 2020 2020 207c 0a20 2020  t",        |.   
+000094e0: 2020 2020 207c 2020 2276 6572 7369 6f6e       |  "version
+000094f0: 223a 2031 2020 2020 2020 2020 2020 2020  ": 1            
+00009500: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
+00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009520: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00009530: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00009540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009550: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00009560: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00009570: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00009580: 5f73 7472 2863 6f6c 2c20 2261 7070 726f  _str(col, "appro
+00009590: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
+000095a0: 756d 756c 6174 6522 290a 2020 2020 7265  umulate").    re
+000095b0: 7475 726e 2062 7569 6c74 696e 2822 6170  turn builtin("ap
+000095c0: 7072 6f78 5f70 6572 6365 6e74 696c 655f  prox_percentile_
+000095d0: 6163 6375 6d75 6c61 7465 2229 2863 290a  accumulate")(c).
+000095e0: 0a0a 6465 6620 6170 7072 6f78 5f70 6572  ..def approx_per
+000095f0: 6365 6e74 696c 655f 6573 7469 6d61 7465  centile_estimate
+00009600: 2873 7461 7465 3a20 436f 6c75 6d6e 4f72  (state: ColumnOr
+00009610: 4e61 6d65 2c20 7065 7263 656e 7469 6c65  Name, percentile
+00009620: 3a20 666c 6f61 7429 202d 3e20 436f 6c75  : float) -> Colu
+00009630: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00009640: 6e73 2074 6865 2064 6573 6972 6564 2061  ns the desired a
+00009650: 7070 726f 7869 6d61 7465 6420 7065 7263  pproximated perc
+00009660: 656e 7469 6c65 2076 616c 7565 2066 6f72  entile value for
+00009670: 2074 6865 2073 7065 6369 6669 6564 2074   the specified t
+00009680: 2d44 6967 6573 7420 7374 6174 652e 0a20  -Digest state.. 
+00009690: 2020 2041 5050 524f 585f 5045 5243 454e     APPROX_PERCEN
+000096a0: 5449 4c45 5f45 5354 494d 4154 4528 4150  TILE_ESTIMATE(AP
+000096b0: 5052 4f58 5f50 4552 4345 4e54 494c 455f  PROX_PERCENTILE_
+000096c0: 4143 4355 4d55 4c41 5445 282e 2929 2069  ACCUMULATE(.)) i
+000096d0: 7320 6571 7569 7661 6c65 6e74 2074 6f0a  s equivalent to.
+000096e0: 2020 2020 4150 5052 4f58 5f50 4552 4345      APPROX_PERCE
+000096f0: 4e54 494c 4528 2e29 2e0a 0a20 2020 2045  NTILE(.)...    E
+00009700: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00009710: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00009720: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00009730: 6d65 285b 312c 322c 332c 342c 355d 2c20  me([1,2,3,4,5], 
+00009740: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00009750: 2020 2020 2020 3e3e 3e20 6466 5f61 6363        >>> df_acc
+00009760: 7520 3d20 6466 2e73 656c 6563 7428 6170  u = df.select(ap
+00009770: 7072 6f78 5f70 6572 6365 6e74 696c 655f  prox_percentile_
+00009780: 6163 6375 6d75 6c61 7465 2822 6122 292e  accumulate("a").
+00009790: 616c 6961 7328 2261 7070 5f70 6572 6365  alias("app_perce
+000097a0: 6e74 696c 655f 6163 6375 2229 290a 2020  ntile_accu")).  
+000097b0: 2020 2020 2020 3e3e 3e20 6466 5f61 6363        >>> df_acc
+000097c0: 752e 7365 6c65 6374 2861 7070 726f 785f  u.select(approx_
+000097d0: 7065 7263 656e 7469 6c65 5f65 7374 696d  percentile_estim
+000097e0: 6174 6528 2261 7070 5f70 6572 6365 6e74  ate("app_percent
+000097f0: 696c 655f 6163 6375 222c 2030 2e35 292e  ile_accu", 0.5).
+00009800: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00009810: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00009820: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00009830: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00009840: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00009850: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00009860: 332e 3020 2020 2020 2020 7c0a 2020 2020  3.0       |.    
+00009870: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00009880: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00009890: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+000098a0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+000098b0: 7374 7228 7374 6174 652c 2022 6170 7072  str(state, "appr
+000098c0: 6f78 5f70 6572 6365 6e74 696c 655f 6573  ox_percentile_es
+000098d0: 7469 6d61 7465 2229 0a20 2020 2072 6574  timate").    ret
+000098e0: 7572 6e20 6275 696c 7469 6e28 2261 7070  urn builtin("app
+000098f0: 726f 785f 7065 7263 656e 7469 6c65 5f65  rox_percentile_e
+00009900: 7374 696d 6174 6522 2928 632c 206c 6974  stimate")(c, lit
+00009910: 2870 6572 6365 6e74 696c 6529 290a 0a0a  (percentile))...
+00009920: 6465 6620 6170 7072 6f78 5f70 6572 6365  def approx_perce
+00009930: 6e74 696c 655f 636f 6d62 696e 6528 7374  ntile_combine(st
+00009940: 6174 653a 2043 6f6c 756d 6e4f 724e 616d  ate: ColumnOrNam
+00009950: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00009960: 2020 2222 2243 6f6d 6269 6e65 7320 286d    """Combines (m
+00009970: 6572 6765 7329 2070 6572 6365 6e74 696c  erges) percentil
+00009980: 6520 696e 7075 7420 7374 6174 6573 2069  e input states i
+00009990: 6e74 6f20 6120 7369 6e67 6c65 206f 7574  nto a single out
+000099a0: 7075 7420 7374 6174 652e 0a20 2020 2054  put state..    T
+000099b0: 6869 7320 616c 6c6f 7773 2073 6365 6e61  his allows scena
+000099c0: 7269 6f73 2077 6865 7265 2041 5050 524f  rios where APPRO
+000099d0: 585f 5045 5243 454e 5449 4c45 5f41 4343  X_PERCENTILE_ACC
+000099e0: 554d 554c 4154 4520 6973 2072 756e 206f  UMULATE is run o
+000099f0: 7665 7220 686f 7269 7a6f 6e74 616c 2070  ver horizontal p
+00009a00: 6172 7469 7469 6f6e 730a 2020 2020 6f66  artitions.    of
+00009a10: 2074 6865 2073 616d 6520 7461 626c 652c   the same table,
+00009a20: 2070 726f 6475 6369 6e67 2061 6e20 616c   producing an al
+00009a30: 676f 7269 7468 6d20 7374 6174 6520 666f  gorithm state fo
+00009a40: 7220 6561 6368 2074 6162 6c65 2070 6172  r each table par
+00009a50: 7469 7469 6f6e 2e20 5468 6573 6520 7374  tition. These st
+00009a60: 6174 6573 2063 616e 0a20 2020 206c 6174  ates can.    lat
+00009a70: 6572 2062 6520 636f 6d62 696e 6564 2075  er be combined u
+00009a80: 7369 6e67 2041 5050 524f 585f 5045 5243  sing APPROX_PERC
+00009a90: 454e 5449 4c45 5f43 4f4d 4249 4e45 2c20  ENTILE_COMBINE, 
+00009aa0: 7072 6f64 7563 696e 6720 7468 6520 7361  producing the sa
+00009ab0: 6d65 206f 7574 7075 7420 7374 6174 6520  me output state 
+00009ac0: 6173 2061 0a20 2020 2073 696e 676c 6520  as a.    single 
+00009ad0: 7275 6e20 6f66 2041 5050 524f 585f 5045  run of APPROX_PE
+00009ae0: 5243 454e 5449 4c45 5f41 4343 554d 554c  RCENTILE_ACCUMUL
+00009af0: 4154 4520 6f76 6572 2074 6865 2065 6e74  ATE over the ent
+00009b00: 6972 6520 7461 626c 652e 0a0a 2020 2020  ire table...    
+00009b10: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+00009b20: 2020 3e3e 3e20 6466 3120 3d20 7365 7373    >>> df1 = sess
+00009b30: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00009b40: 7261 6d65 285b 312c 322c 332c 342c 355d  rame([1,2,3,4,5]
+00009b50: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00009b60: 2020 2020 2020 2020 3e3e 3e20 6466 3220          >>> df2 
+00009b70: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00009b80: 5f64 6174 6166 7261 6d65 285b 362c 372c  _dataframe([6,7,
+00009b90: 382c 392c 3130 5d2c 2073 6368 656d 613d  8,9,10], schema=
+00009ba0: 5b22 6222 5d29 0a20 2020 2020 2020 203e  ["b"]).        >
+00009bb0: 3e3e 2064 665f 6163 6375 3120 3d20 6466  >> df_accu1 = df
+00009bc0: 312e 7365 6c65 6374 2861 7070 726f 785f  1.select(approx_
+00009bd0: 7065 7263 656e 7469 6c65 5f61 6363 756d  percentile_accum
+00009be0: 756c 6174 6528 2261 2229 2e61 6c69 6173  ulate("a").alias
+00009bf0: 2822 6170 705f 7065 7263 656e 7469 6c65  ("app_percentile
+00009c00: 5f61 6363 7522 2929 0a20 2020 2020 2020  _accu")).       
+00009c10: 203e 3e3e 2064 665f 6163 6375 3220 3d20   >>> df_accu2 = 
+00009c20: 6466 322e 7365 6c65 6374 2861 7070 726f  df2.select(appro
+00009c30: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
+00009c40: 756d 756c 6174 6528 2262 2229 2e61 6c69  umulate("b").ali
+00009c50: 6173 2822 6170 705f 7065 7263 656e 7469  as("app_percenti
+00009c60: 6c65 5f61 6363 7522 2929 0a20 2020 2020  le_accu")).     
+00009c70: 2020 203e 3e3e 2064 665f 6163 6375 312e     >>> df_accu1.
+00009c80: 756e 696f 6e28 6466 5f61 6363 7532 292e  union(df_accu2).
+00009c90: 7365 6c65 6374 2861 7070 726f 785f 7065  select(approx_pe
+00009ca0: 7263 656e 7469 6c65 5f63 6f6d 6269 6e65  rcentile_combine
+00009cb0: 2822 6170 705f 7065 7263 656e 7469 6c65  ("app_percentile
+00009cc0: 5f61 6363 7522 292e 616c 6961 7328 2272  _accu").alias("r
+00009cd0: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00009ce0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00009cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009d00: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00009d10: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
+00009d20: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00009d30: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00009d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009d50: 2d2d 2d2d 0a20 2020 2020 2020 207c 7b20  ----.        |{ 
+00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d70: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00009d80: 2020 2020 7c20 2022 7374 6174 6522 3a20      |  "state": 
+00009d90: 5b20 2020 2020 2020 2020 2020 2020 2020  [               
+00009da0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+00009db0: 312e 3030 3030 3030 3030 3030 3030 3030  1.00000000000000
+00009dc0: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
+00009dd0: 2020 7c20 2020 2031 2e30 3030 3030 3030    |    1.0000000
+00009de0: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
+00009df0: 0a20 2020 2020 2020 207c 2020 2020 322e  .        |    2.
+00009e00: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
+00009e10: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
+00009e20: 7c20 2020 2031 2e30 3030 3030 3030 3030  |    1.000000000
+00009e30: 3030 3030 3030 652b 3030 2c20 207c 0a20  000000e+00,  |. 
+00009e40: 2020 2020 2020 207c 2020 2020 332e 3030         |    3.00
+00009e50: 3030 3030 3030 3030 3030 3030 3065 2b30  0000000000000e+0
+00009e60: 302c 2020 7c0a 2020 2020 2020 2020 7c20  0,  |.        | 
+00009e70: 2020 2031 2e30 3030 3030 3030 3030 3030     1.00000000000
+00009e80: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
+00009e90: 2020 2020 207c 2020 2020 342e 3030 3030       |    4.0000
+00009ea0: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
+00009eb0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+00009ec0: 2031 2e30 3030 3030 3030 3030 3030 3030   1.0000000000000
+00009ed0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
+00009ee0: 2020 207c 2020 2020 352e 3030 3030 3030     |    5.000000
+00009ef0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
+00009f00: 7c0a 2020 2020 2020 2020 7c20 2020 2031  |.        |    1
+00009f10: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
+00009f20: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
+00009f30: 207c 2020 2020 362e 3030 3030 3030 3030   |    6.00000000
+00009f40: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
+00009f50: 2020 2020 2020 2020 7c20 2020 2031 2e30          |    1.0
+00009f60: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
+00009f70: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
+00009f80: 2020 2020 372e 3030 3030 3030 3030 3030      7.0000000000
+00009f90: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
+00009fa0: 2020 2020 2020 7c20 2020 2031 2e30 3030        |    1.000
+00009fb0: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
+00009fc0: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
+00009fd0: 2020 382e 3030 3030 3030 3030 3030 3030    8.000000000000
+00009fe0: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
+00009ff0: 2020 2020 7c20 2020 2031 2e30 3030 3030      |    1.00000
+0000a000: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
+0000a010: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+0000a020: 392e 3030 3030 3030 3030 3030 3030 3030  9.00000000000000
+0000a030: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
+0000a040: 2020 7c20 2020 2031 2e30 3030 3030 3030    |    1.0000000
+0000a050: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
+0000a060: 0a20 2020 2020 2020 207c 2020 2020 312e  .        |    1.
+0000a070: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
+0000a080: 2b30 312c 2020 7c0a 2020 2020 2020 2020  +01,  |.        
+0000a090: 7c20 2020 2031 2e30 3030 3030 3030 3030  |    1.000000000
+0000a0a0: 3030 3030 3030 652b 3030 2020 207c 0a20  000000e+00   |. 
+0000a0b0: 2020 2020 2020 207c 2020 5d2c 2020 2020         |  ],    
+0000a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0d0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0000a0e0: 2022 7479 7065 223a 2022 7464 6967 6573   "type": "tdiges
+0000a0f0: 7422 2c20 2020 2020 2020 207c 0a20 2020  t",        |.   
+0000a100: 2020 2020 207c 2020 2276 6572 7369 6f6e       |  "version
+0000a110: 223a 2031 2020 2020 2020 2020 2020 2020  ": 1            
+0000a120: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
+0000a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a140: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0000a150: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0000a160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a170: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0000a180: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0000a190: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0000a1a0: 5f73 7472 2873 7461 7465 2c20 2261 7070  _str(state, "app
+0000a1b0: 726f 785f 7065 7263 656e 7469 6c65 5f63  rox_percentile_c
+0000a1c0: 6f6d 6269 6e65 2229 0a20 2020 2072 6574  ombine").    ret
+0000a1d0: 7572 6e20 6275 696c 7469 6e28 2261 7070  urn builtin("app
+0000a1e0: 726f 785f 7065 7263 656e 7469 6c65 5f63  rox_percentile_c
+0000a1f0: 6f6d 6269 6e65 2229 2863 290a 0a0a 6465  ombine")(c)...de
+0000a200: 6620 6578 706c 6f64 6528 636f 6c3a 2043  f explode(col: C
+0000a210: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0000a220: 5461 626c 6546 756e 6374 696f 6e43 616c  TableFunctionCal
+0000a230: 6c3a 0a20 2020 2022 2222 466c 6174 7465  l:.    """Flatte
+0000a240: 6e73 2061 2067 6976 656e 2061 7272 6179  ns a given array
+0000a250: 206f 7220 6d61 7020 7479 7065 2063 6f6c   or map type col
+0000a260: 756d 6e20 696e 746f 2069 6e64 6976 6964  umn into individ
+0000a270: 7561 6c20 726f 7773 2e20 5468 6520 6465  ual rows. The de
+0000a280: 6661 756c 740a 2020 2020 636f 6c75 6d6e  fault.    column
+0000a290: 206e 616d 6520 666f 7220 7468 6520 6f75   name for the ou
+0000a2a0: 7470 7574 2063 6f6c 756d 6e20 696e 2063  tput column in c
+0000a2b0: 6173 6520 6f66 2061 7272 6179 2069 6e70  ase of array inp
+0000a2c0: 7574 2063 6f6c 756d 6e20 6973 2060 6056  ut column is ``V
+0000a2d0: 414c 5545 6060 2c0a 2020 2020 616e 6420  ALUE``,.    and 
+0000a2e0: 6973 2060 604b 4559 6060 2061 6e64 2060  is ``KEY`` and `
+0000a2f0: 6056 414c 5545 6060 2069 6e20 6361 7365  `VALUE`` in case
+0000a300: 206f 6620 6d61 7020 696e 7075 7420 636f   of map input co
+0000a310: 6c75 6d6e 2e0a 0a20 2020 2045 7861 6d70  lumn...    Examp
+0000a320: 6c65 733a 3a0a 2020 2020 2020 2020 3e3e  les::.        >>
+0000a330: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0000a340: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0000a350: 5b5b 312c 205b 312c 2032 2c20 335d 2c20  [[1, [1, 2, 3], 
+0000a360: 7b22 4173 6869 2047 6172 616d 6922 3a20  {"Ashi Garami": 
+0000a370: 2253 696e 676c 6520 4c65 6720 5822 7d2c  "Single Leg X"},
+0000a380: 2022 4b69 6d75 7261 225d 2c0a 2020 2020   "Kimura"],.    
+0000a390: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3b0: 2020 2020 2020 205b 322c 205b 3131 2c20         [2, [11, 
+0000a3c0: 3232 5d2c 207b 2253 616e 6b61 6b75 223a  22], {"Sankaku":
+0000a3d0: 2022 5472 6961 6e67 6c65 227d 2c20 2243   "Triangle"}, "C
+0000a3e0: 6f66 6665 6522 5d5d 2c0a 2020 2020 2020  offee"]],.      
+0000a3f0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0000a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a410: 2020 2020 2073 6368 656d 613d 5b22 6964       schema=["id
+0000a420: 7822 2c20 226c 6973 7473 222c 2022 6d61  x", "lists", "ma
+0000a430: 7073 222c 2022 7374 7273 225d 290a 2020  ps", "strs"]).  
+0000a440: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0000a450: 6563 7428 6466 2e69 6478 2c20 6578 706c  ect(df.idx, expl
+0000a460: 6f64 6528 6466 2e6c 6973 7473 2929 2e73  ode(df.lists)).s
+0000a470: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0000a480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a490: 2d0a 2020 2020 2020 2020 7c22 4944 5822  -.        |"IDX"
+0000a4a0: 2020 7c22 5641 4c55 4522 2020 7c0a 2020    |"VALUE"  |.  
+0000a4b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000a4c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000a4d0: 2020 7c31 2020 2020 2020 7c31 2020 2020    |1      |1    
+0000a4e0: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
+0000a4f0: 2020 2020 2020 7c32 2020 2020 2020 2020        |2        
+0000a500: 7c0a 2020 2020 2020 2020 7c31 2020 2020  |.        |1    
+0000a510: 2020 7c33 2020 2020 2020 2020 7c0a 2020    |3        |.  
+0000a520: 2020 2020 2020 7c32 2020 2020 2020 7c31        |2      |1
+0000a530: 3120 2020 2020 2020 7c0a 2020 2020 2020  1       |.      
+0000a540: 2020 7c32 2020 2020 2020 7c32 3220 2020    |2      |22   
+0000a550: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0000a560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a570: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0000a580: 4c49 4e45 3e0a 0a20 2020 2020 2020 203e  LINE>..        >
+0000a590: 3e3e 2064 662e 7365 6c65 6374 2864 662e  >> df.select(df.
+0000a5a0: 7374 7273 2c20 6578 706c 6f64 6528 6466  strs, explode(df
+0000a5b0: 2e6d 6170 7329 292e 7368 6f77 2829 0a20  .maps)).show(). 
+0000a5c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000a5d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a5e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a5f0: 0a20 2020 2020 2020 207c 2253 5452 5322  .        |"STRS"
+0000a600: 2020 7c22 4b45 5922 2020 2020 2020 2020    |"KEY"        
+0000a610: 7c22 5641 4c55 4522 2020 2020 2020 2020  |"VALUE"        
+0000a620: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0000a630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a650: 2d2d 2d2d 0a20 2020 2020 2020 207c 4b69  ----.        |Ki
+0000a660: 6d75 7261 2020 7c41 7368 6920 4761 7261  mura  |Ashi Gara
+0000a670: 6d69 2020 7c22 5369 6e67 6c65 204c 6567  mi  |"Single Leg
+0000a680: 2058 2220 207c 0a20 2020 2020 2020 207c   X"  |.        |
+0000a690: 436f 6666 6565 2020 7c53 616e 6b61 6b75  Coffee  |Sankaku
+0000a6a0: 2020 2020 2020 7c22 5472 6961 6e67 6c65        |"Triangle
+0000a6b0: 2220 2020 2020 207c 0a20 2020 2020 2020  "      |.       
+0000a6c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0000a6d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a6e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000a6f0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
+0000a700: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000a710: 656c 6563 7428 6578 706c 6f64 6528 636f  elect(explode(co
+0000a720: 6c28 226c 6973 7473 2229 292e 616c 6961  l("lists")).alia
+0000a730: 7328 2275 6e6f 2229 292e 7368 6f77 2829  s("uno")).show()
+0000a740: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000a750: 2d2d 0a20 2020 2020 2020 207c 2255 4e4f  --.        |"UNO
+0000a760: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0000a770: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0000a780: 3120 2020 2020 207c 0a20 2020 2020 2020  1      |.       
+0000a790: 207c 3220 2020 2020 207c 0a20 2020 2020   |2      |.     
+0000a7a0: 2020 207c 3320 2020 2020 207c 0a20 2020     |3      |.   
+0000a7b0: 2020 2020 207c 3131 2020 2020 207c 0a20       |11     |. 
+0000a7c0: 2020 2020 2020 207c 3232 2020 2020 207c         |22     |
+0000a7d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000a7e0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0000a7f0: 4b4c 494e 453e 0a0a 2020 2020 2020 2020  KLINE>..        
+0000a800: 3e3e 3e20 6466 2e73 656c 6563 7428 6578  >>> df.select(ex
+0000a810: 706c 6f64 6528 276d 6170 7327 292e 6173  plode('maps').as
+0000a820: 5f28 2270 7269 6d6f 222c 2022 7365 6375  _("primo", "secu
+0000a830: 6e64 6f22 2929 2e73 686f 7728 290a 2020  ndo")).show().  
+0000a840: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000a850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a860: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0000a870: 2250 5249 4d4f 2220 2020 2020 207c 2253  "PRIMO"      |"S
+0000a880: 4543 554e 444f 2220 2020 2020 2020 7c0a  ECUNDO"       |.
+0000a890: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000a8a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a8b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000a8c0: 207c 4173 6869 2047 6172 616d 6920 207c   |Ashi Garami  |
+0000a8d0: 2253 696e 676c 6520 4c65 6720 5822 2020  "Single Leg X"  
+0000a8e0: 7c0a 2020 2020 2020 2020 7c53 616e 6b61  |.        |Sanka
+0000a8f0: 6b75 2020 2020 2020 7c22 5472 6961 6e67  ku      |"Triang
+0000a900: 6c65 2220 2020 2020 207c 0a20 2020 2020  le"      |.     
+0000a910: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0000a920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a930: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0000a940: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0000a950: 2020 2020 6675 6e63 5f63 616c 6c20 3d20      func_call = 
+0000a960: 5f45 7870 6c6f 6465 4675 6e63 7469 6f6e  _ExplodeFunction
+0000a970: 4361 6c6c 2863 6f6c 290a 2020 2020 6675  Call(col).    fu
+0000a980: 6e63 5f63 616c 6c2e 5f73 6574 5f61 7069  nc_call._set_api
+0000a990: 5f63 616c 6c5f 736f 7572 6365 2822 6675  _call_source("fu
+0000a9a0: 6e63 7469 6f6e 732e 6578 706c 6f64 6522  nctions.explode"
+0000a9b0: 290a 2020 2020 7265 7475 726e 2066 756e  ).    return fun
+0000a9c0: 635f 6361 6c6c 0a0a 0a64 6566 2067 726f  c_call...def gro
+0000a9d0: 7570 696e 6728 2a63 6f6c 733a 2043 6f6c  uping(*cols: Col
+0000a9e0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+0000a9f0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+0000aa00: 2020 4465 7363 7269 6265 7320 7768 6963    Describes whic
+0000aa10: 6820 6f66 2061 206c 6973 7420 6f66 2065  h of a list of e
+0000aa20: 7870 7265 7373 696f 6e73 2061 7265 2067  xpressions are g
+0000aa30: 726f 7570 6564 2069 6e20 6120 726f 7720  rouped in a row 
+0000aa40: 7072 6f64 7563 6564 2062 7920 6120 4752  produced by a GR
+0000aa50: 4f55 5020 4259 2071 7565 7279 2e0a 0a20  OUP BY query... 
+0000aa60: 2020 203a 6675 6e63 3a60 6772 6f75 7069     :func:`groupi
+0000aa70: 6e67 5f69 6460 2069 7320 616e 2061 6c69  ng_id` is an ali
+0000aa80: 6173 206f 6620 3a66 756e 633a 6067 726f  as of :func:`gro
+0000aa90: 7570 696e 6760 2e0a 0a20 2020 2045 7861  uping`...    Exa
+0000aaa0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+0000aab0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0000aac0: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
+0000aad0: 7420 4772 6f75 7069 6e67 5365 7473 0a20  t GroupingSets. 
+0000aae0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000aaf0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0000ab00: 6174 6166 7261 6d65 285b 5b31 2c20 322c  ataframe([[1, 2,
+0000ab10: 2033 5d2c 205b 342c 2035 2c20 365d 5d2c   3], [4, 5, 6]],
+0000ab20: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
+0000ab30: 2c20 2263 225d 290a 2020 2020 2020 2020  , "c"]).        
+0000ab40: 3e3e 3e20 6772 6f75 7069 6e67 5f73 6574  >>> grouping_set
+0000ab50: 7320 3d20 4772 6f75 7069 6e67 5365 7473  s = GroupingSets
+0000ab60: 285b 636f 6c28 2261 2229 5d2c 205b 636f  ([col("a")], [co
+0000ab70: 6c28 2262 2229 5d2c 205b 636f 6c28 2261  l("b")], [col("a
+0000ab80: 2229 2c20 636f 6c28 2262 2229 5d29 0a20  "), col("b")]). 
+0000ab90: 2020 2020 2020 203e 3e3e 2064 662e 6772         >>> df.gr
+0000aba0: 6f75 705f 6279 5f67 726f 7570 696e 675f  oup_by_grouping_
+0000abb0: 7365 7473 2867 726f 7570 696e 675f 7365  sets(grouping_se
+0000abc0: 7473 292e 6167 6728 5b63 6f75 6e74 2822  ts).agg([count("
+0000abd0: 6322 292c 2067 726f 7570 696e 6728 2261  c"), grouping("a
+0000abe0: 2229 2c20 6772 6f75 7069 6e67 2822 6222  "), grouping("b"
+0000abf0: 292c 2067 726f 7570 696e 6728 2261 222c  ), grouping("a",
+0000ac00: 2022 6222 295d 292e 636f 6c6c 6563 7428   "b")]).collect(
+0000ac10: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+0000ac20: 3d31 2c20 423d 322c 2043 4f55 4e54 2843  =1, B=2, COUNT(C
+0000ac30: 293d 312c 2047 524f 5550 494e 4728 4129  )=1, GROUPING(A)
+0000ac40: 3d30 2c20 4752 4f55 5049 4e47 2842 293d  =0, GROUPING(B)=
+0000ac50: 302c 2047 524f 5550 494e 4728 412c 2042  0, GROUPING(A, B
+0000ac60: 293d 3029 2c20 5c0a 526f 7728 413d 342c  )=0), \.Row(A=4,
+0000ac70: 2042 3d35 2c20 434f 554e 5428 4329 3d31   B=5, COUNT(C)=1
+0000ac80: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
+0000ac90: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
+0000aca0: 4752 4f55 5049 4e47 2841 2c20 4229 3d30  GROUPING(A, B)=0
+0000acb0: 292c 205c 0a52 6f77 2841 3d31 2c20 423d  ), \.Row(A=1, B=
+0000acc0: 4e6f 6e65 2c20 434f 554e 5428 4329 3d31  None, COUNT(C)=1
+0000acd0: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
+0000ace0: 2047 524f 5550 494e 4728 4229 3d31 2c20   GROUPING(B)=1, 
+0000acf0: 4752 4f55 5049 4e47 2841 2c20 4229 3d31  GROUPING(A, B)=1
+0000ad00: 292c 205c 0a52 6f77 2841 3d34 2c20 423d  ), \.Row(A=4, B=
+0000ad10: 4e6f 6e65 2c20 434f 554e 5428 4329 3d31  None, COUNT(C)=1
+0000ad20: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
+0000ad30: 2047 524f 5550 494e 4728 4229 3d31 2c20   GROUPING(B)=1, 
+0000ad40: 4752 4f55 5049 4e47 2841 2c20 4229 3d31  GROUPING(A, B)=1
+0000ad50: 292c 205c 0a52 6f77 2841 3d4e 6f6e 652c  ), \.Row(A=None,
+0000ad60: 2042 3d32 2c20 434f 554e 5428 4329 3d31   B=2, COUNT(C)=1
+0000ad70: 2c20 4752 4f55 5049 4e47 2841 293d 312c  , GROUPING(A)=1,
+0000ad80: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
+0000ad90: 4752 4f55 5049 4e47 2841 2c20 4229 3d32  GROUPING(A, B)=2
+0000ada0: 292c 205c 0a52 6f77 2841 3d4e 6f6e 652c  ), \.Row(A=None,
+0000adb0: 2042 3d35 2c20 434f 554e 5428 4329 3d31   B=5, COUNT(C)=1
+0000adc0: 2c20 4752 4f55 5049 4e47 2841 293d 312c  , GROUPING(A)=1,
+0000add0: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
+0000ade0: 4752 4f55 5049 4e47 2841 2c20 4229 3d32  GROUPING(A, B)=2
+0000adf0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0000ae00: 6f6c 756d 6e73 203d 205b 5f74 6f5f 636f  olumns = [_to_co
+0000ae10: 6c5f 6966 5f73 7472 2863 2c20 2267 726f  l_if_str(c, "gro
+0000ae20: 7570 696e 6722 2920 666f 7220 6320 696e  uping") for c in
+0000ae30: 2063 6f6c 735d 0a20 2020 2072 6574 7572   cols].    retur
+0000ae40: 6e20 6275 696c 7469 6e28 2267 726f 7570  n builtin("group
+0000ae50: 696e 6722 2928 2a63 6f6c 756d 6e73 290a  ing")(*columns).
+0000ae60: 0a0a 6772 6f75 7069 6e67 5f69 6420 3d20  ..grouping_id = 
+0000ae70: 6772 6f75 7069 6e67 0a0a 0a64 6566 2063  grouping...def c
+0000ae80: 6f61 6c65 7363 6528 2a65 3a20 436f 6c75  oalesce(*e: Colu
+0000ae90: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0000aea0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0000aeb0: 726e 7320 7468 6520 6669 7273 7420 6e6f  rns the first no
+0000aec0: 6e2d 4e55 4c4c 2065 7870 7265 7373 696f  n-NULL expressio
+0000aed0: 6e20 616d 6f6e 6720 6974 7320 6172 6775  n among its argu
+0000aee0: 6d65 6e74 732c 206f 7220 4e55 4c4c 2069  ments, or NULL i
+0000aef0: 6620 616c 6c20 6974 730a 2020 2020 6172  f all its.    ar
+0000af00: 6775 6d65 6e74 7320 6172 6520 4e55 4c4c  guments are NULL
+0000af10: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0000af20: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+0000af30: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0000af40: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
+0000af50: 2032 2c20 335d 2c20 5b4e 6f6e 652c 2032   2, 3], [None, 2
+0000af60: 2c20 335d 2c20 5b4e 6f6e 652c 204e 6f6e  , 3], [None, Non
+0000af70: 652c 2033 5d2c 205b 4e6f 6e65 2c20 4e6f  e, 3], [None, No
+0000af80: 6e65 2c20 4e6f 6e65 5d5d 2c20 7363 6865  ne, None]], sche
+0000af90: 6d61 3d5b 2761 272c 2027 6227 2c20 2763  ma=['a', 'b', 'c
+0000afa0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+0000afb0: 6466 2e73 656c 6563 7428 6466 2e61 2c20  df.select(df.a, 
+0000afc0: 6466 2e62 2c20 6466 2e63 2c20 636f 616c  df.b, df.c, coal
+0000afd0: 6573 6365 2864 662e 612c 2064 662e 622c  esce(df.a, df.b,
+0000afe0: 2064 662e 6329 2e61 735f 2822 434f 414c   df.c).as_("COAL
+0000aff0: 4553 4345 2229 292e 7368 6f77 2829 0a20  ESCE")).show(). 
+0000b000: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000b010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b020: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000b030: 2020 207c 2241 2220 2020 7c22 4222 2020     |"A"   |"B"  
+0000b040: 207c 2243 2220 2020 7c22 434f 414c 4553   |"C"   |"COALES
+0000b050: 4345 2220 207c 0a20 2020 2020 2020 202d  CE"  |.        -
+0000b060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b080: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
+0000b090: 2020 7c32 2020 2020 207c 3320 2020 2020    |2     |3     
+0000b0a0: 7c31 2020 2020 2020 2020 2020 207c 0a20  |1           |. 
+0000b0b0: 2020 2020 2020 207c 4e55 4c4c 2020 7c32         |NULL  |2
+0000b0c0: 2020 2020 207c 3320 2020 2020 7c32 2020       |3     |2  
+0000b0d0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0000b0e0: 2020 207c 4e55 4c4c 2020 7c4e 554c 4c20     |NULL  |NULL 
+0000b0f0: 207c 3320 2020 2020 7c33 2020 2020 2020   |3     |3      
+0000b100: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0000b110: 4e55 4c4c 2020 7c4e 554c 4c20 207c 4e55  NULL  |NULL  |NU
+0000b120: 4c4c 2020 7c4e 554c 4c20 2020 2020 2020  LL  |NULL       
+0000b130: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0000b140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b150: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0000b160: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0000b170: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+0000b180: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
+0000b190: 7472 2865 782c 2022 636f 616c 6573 6365  tr(ex, "coalesce
+0000b1a0: 2229 2066 6f72 2065 7820 696e 2065 5d0a  ") for ex in e].
+0000b1b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000b1c0: 696e 2822 636f 616c 6573 6365 2229 282a  in("coalesce")(*
+0000b1d0: 6329 0a0a 0a64 6566 2065 7175 616c 5f6e  c)...def equal_n
+0000b1e0: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
+0000b1f0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000b200: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+0000b210: 6e20 7472 7565 2069 6620 7468 6520 7661  n true if the va
+0000b220: 6c75 6520 696e 2074 6865 2063 6f6c 756d  lue in the colum
+0000b230: 6e20 6973 206e 6f74 2061 206e 756d 6265  n is not a numbe
+0000b240: 7220 284e 614e 292e 0a0a 2020 2020 4578  r (NaN)...    Ex
+0000b250: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0000b260: 203e 3e3e 2069 6d70 6f72 7420 6d61 7468   >>> import math
+0000b270: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000b280: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000b290: 5f64 6174 6166 7261 6d65 285b 312e 312c  _dataframe([1.1,
+0000b2a0: 206d 6174 682e 6e61 6e2c 2032 2e33 5d2c   math.nan, 2.3],
+0000b2b0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0000b2c0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0000b2d0: 6c65 6374 2865 7175 616c 5f6e 616e 2864  lect(equal_nan(d
+0000b2e0: 665b 2261 225d 292e 616c 6961 7328 2265  f["a"]).alias("e
+0000b2f0: 7175 616c 5f6e 616e 2229 292e 636f 6c6c  qual_nan")).coll
+0000b300: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0000b310: 6f77 2845 5155 414c 5f4e 414e 3d46 616c  ow(EQUAL_NAN=Fal
+0000b320: 7365 292c 2052 6f77 2845 5155 414c 5f4e  se), Row(EQUAL_N
+0000b330: 414e 3d54 7275 6529 2c20 526f 7728 4551  AN=True), Row(EQ
+0000b340: 5541 4c5f 4e41 4e3d 4661 6c73 6529 5d0a  UAL_NAN=False)].
+0000b350: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0000b360: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+0000b370: 2c20 2265 7175 616c 5f6e 616e 2229 0a20  , "equal_nan"). 
+0000b380: 2020 2072 6574 7572 6e20 632e 6571 7561     return c.equa
+0000b390: 6c5f 6e61 6e28 290a 0a0a 6465 6620 6973  l_nan()...def is
+0000b3a0: 5f6e 756c 6c28 653a 2043 6f6c 756d 6e4f  _null(e: ColumnO
+0000b3b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000b3c0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0000b3d0: 7475 726e 2074 7275 6520 6966 2074 6865  turn true if the
+0000b3e0: 2076 616c 7565 2069 6e20 7468 6520 636f   value in the co
+0000b3f0: 6c75 6d6e 2069 7320 6e75 6c6c 2e0a 0a20  lumn is null... 
+0000b400: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0000b410: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0000b420: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0000b430: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+0000b440: 7274 2069 735f 6e75 6c6c 0a20 2020 2020  rt is_null.     
+0000b450: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0000b460: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0000b470: 7261 6d65 285b 312e 322c 2066 6c6f 6174  rame([1.2, float
+0000b480: 2822 6e61 6e22 292c 204e 6f6e 652c 2031  ("nan"), None, 1
+0000b490: 2e30 5d2c 2073 6368 656d 613d 5b22 6122  .0], schema=["a"
+0000b4a0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0000b4b0: 662e 7365 6c65 6374 2869 735f 6e75 6c6c  f.select(is_null
+0000b4c0: 2822 6122 292e 6173 5f28 2261 2229 292e  ("a").as_("a")).
+0000b4d0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0000b4e0: 2020 5b52 6f77 2841 3d46 616c 7365 292c    [Row(A=False),
+0000b4f0: 2052 6f77 2841 3d46 616c 7365 292c 2052   Row(A=False), R
+0000b500: 6f77 2841 3d54 7275 6529 2c20 526f 7728  ow(A=True), Row(
+0000b510: 413d 4661 6c73 6529 5d0a 2020 2020 2222  A=False)].    ""
+0000b520: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0000b530: 6c5f 6966 5f73 7472 2865 2c20 2269 735f  l_if_str(e, "is_
+0000b540: 6e75 6c6c 2229 0a20 2020 2072 6574 7572  null").    retur
+0000b550: 6e20 632e 6973 5f6e 756c 6c28 290a 0a0a  n c.is_null()...
+0000b560: 6465 6620 6e65 6761 7465 2865 3a20 436f  def negate(e: Co
+0000b570: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000b580: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+0000b590: 7475 726e 7320 7468 6520 6e65 6761 7469  turns the negati
+0000b5a0: 6f6e 206f 6620 7468 6520 7661 6c75 6520  on of the value 
+0000b5b0: 696e 2074 6865 2063 6f6c 756d 6e20 2865  in the column (e
+0000b5c0: 7175 6976 616c 656e 7420 746f 2061 2075  quivalent to a u
+0000b5d0: 6e61 7279 206d 696e 7573 292e 0a0a 2020  nary minus)...  
+0000b5e0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0000b5f0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000b600: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0000b610: 6166 7261 6d65 285b 5b31 5d5d 2c20 7363  aframe([[1]], sc
+0000b620: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0000b630: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0000b640: 7428 6e65 6761 7465 2863 6f6c 2822 6122  t(negate(col("a"
+0000b650: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+0000b660: 2929 292e 7368 6f77 2829 0a20 2020 2020  ))).show().     
+0000b670: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0000b680: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0000b690: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0000b6a0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000b6b0: 2020 7c2d 3120 2020 2020 2020 207c 0a20    |-1        |. 
+0000b6c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000b6d0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0000b6e0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0000b6f0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0000b700: 5f69 665f 7374 7228 652c 2022 6e65 6761  _if_str(e, "nega
+0000b710: 7465 2229 0a20 2020 2072 6574 7572 6e20  te").    return 
+0000b720: 2d63 0a0a 0a64 6566 206e 6f74 5f28 653a  -c...def not_(e:
+0000b730: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0000b740: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0000b750: 2252 6574 7572 6e73 2074 6865 2069 6e76  "Returns the inv
+0000b760: 6572 7365 206f 6620 6120 626f 6f6c 6561  erse of a boolea
+0000b770: 6e20 6578 7072 6573 7369 6f6e 2e0a 0a20  n expression... 
+0000b780: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0000b790: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000b7a0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000b7b0: 7461 6672 616d 6528 5b5b 5472 7565 5d5d  taframe([[True]]
+0000b7c0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0000b7d0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000b7e0: 656c 6563 7428 6e6f 745f 2863 6f6c 2822  elect(not_(col("
+0000b7f0: 6122 292e 616c 6961 7328 2272 6573 756c  a").alias("resul
+0000b800: 7422 2929 292e 7368 6f77 2829 0a20 2020  t"))).show().   
+0000b810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000b820: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0000b830: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0000b840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000b850: 2020 2020 7c46 616c 7365 2020 2020 207c      |False     |
+0000b860: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000b870: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0000b880: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0000b890: 220a 0a20 2020 2063 203d 205f 746f 5f63  "..    c = _to_c
+0000b8a0: 6f6c 5f69 665f 7374 7228 652c 2022 6e6f  ol_if_str(e, "no
+0000b8b0: 745f 2229 0a20 2020 2072 6574 7572 6e20  t_").    return 
+0000b8c0: 7e63 0a0a 0a64 6566 2072 616e 646f 6d28  ~c...def random(
+0000b8d0: 7365 6564 3a20 4f70 7469 6f6e 616c 5b69  seed: Optional[i
+0000b8e0: 6e74 5d20 3d20 4e6f 6e65 2920 2d3e 2043  nt] = None) -> C
+0000b8f0: 6f6c 756d 6e3a 0a20 2020 2022 2222 4561  olumn:.    """Ea
+0000b900: 6368 2063 616c 6c20 7265 7475 726e 7320  ch call returns 
+0000b910: 6120 7073 6575 646f 2d72 616e 646f 6d20  a pseudo-random 
+0000b920: 3634 2d62 6974 2069 6e74 6567 6572 2e0a  64-bit integer..
+0000b930: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000b940: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000b950: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
+0000b960: 6563 7420 3122 290a 2020 2020 2020 2020  ect 1").        
+0000b970: 3e3e 3e20 6466 203d 2064 662e 7365 6c65  >>> df = df.sele
+0000b980: 6374 2872 616e 646f 6d28 3132 3329 2e61  ct(random(123).a
+0000b990: 6c69 6173 2822 7265 7375 6c74 2229 290a  lias("result")).
+0000b9a0: 2020 2020 2222 220a 2020 2020 7320 3d20      """.    s = 
+0000b9b0: 7365 6564 2069 6620 7365 6564 2069 7320  seed if seed is 
+0000b9c0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 7261  not None else ra
+0000b9d0: 6e64 696e 7428 2d28 322a 2a36 3329 2c20  ndint(-(2**63), 
+0000b9e0: 322a 2a36 3320 2d20 3129 0a20 2020 2072  2**63 - 1).    r
+0000b9f0: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
+0000ba00: 616e 646f 6d22 2928 4c69 7465 7261 6c28  andom")(Literal(
+0000ba10: 7329 290a 0a0a 6465 6620 756e 6966 6f72  s))...def unifor
+0000ba20: 6d28 0a20 2020 206d 696e 5f3a 2055 6e69  m(.    min_: Uni
+0000ba30: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+0000ba40: 2069 6e74 2c20 666c 6f61 745d 2c0a 2020   int, float],.  
+0000ba50: 2020 6d61 785f 3a20 556e 696f 6e5b 436f    max_: Union[Co
+0000ba60: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
+0000ba70: 2066 6c6f 6174 5d2c 0a20 2020 2067 656e   float],.    gen
+0000ba80: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+0000ba90: 4e61 6d65 2c20 696e 742c 2066 6c6f 6174  Name, int, float
+0000baa0: 5d2c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  ],.) -> Column:.
+0000bab0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+0000bac0: 726e 7320 6120 756e 6966 6f72 6d6c 7920  rns a uniformly 
+0000bad0: 7261 6e64 6f6d 206e 756d 6265 722e 0a0a  random number...
+0000bae0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0000baf0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+0000bb00: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
+0000bb10: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000bb20: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000bb30: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+0000bb40: 2020 2020 205b 5b31 5d5d 2c0a 2020 2020       [[1]],.    
+0000bb50: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+0000bb60: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
+0000bb70: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+0000bb80: 3e3e 3e20 6466 2e73 656c 6563 7428 756e  >>> df.select(un
+0000bb90: 6966 6f72 6d28 312c 2031 3030 2c20 636f  iform(1, 100, co
+0000bba0: 6c28 2261 2229 292e 616c 6961 7328 2255  l("a")).alias("U
+0000bbb0: 4e49 464f 524d 2229 292e 636f 6c6c 6563  NIFORM")).collec
+0000bbc0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0000bbd0: 2855 4e49 464f 524d 3d36 3229 5d0a 2020  (UNIFORM=62)].  
+0000bbe0: 2020 2222 220a 0a20 2020 2064 6566 2063    """..    def c
+0000bbf0: 6f6e 7665 7274 5f6c 696d 6974 5f74 6f5f  onvert_limit_to_
+0000bc00: 636f 6c28 6c69 6d69 7429 3a0a 2020 2020  col(limit):.    
+0000bc10: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0000bc20: 6528 6c69 6d69 742c 2069 6e74 293a 0a20  e(limit, int):. 
+0000bc30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000bc40: 6e20 6c69 7428 6c69 6d69 7429 0a20 2020  n lit(limit).   
+0000bc50: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+0000bc60: 616e 6365 286c 696d 6974 2c20 666c 6f61  ance(limit, floa
+0000bc70: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0000bc80: 7265 7475 726e 206c 6974 286c 696d 6974  return lit(limit
+0000bc90: 292e 6361 7374 2846 6c6f 6174 5479 7065  ).cast(FloatType
+0000bca0: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
+0000bcb0: 726e 205f 746f 5f63 6f6c 5f69 665f 7374  rn _to_col_if_st
+0000bcc0: 7228 6c69 6d69 742c 2022 756e 6966 6f72  r(limit, "unifor
+0000bcd0: 6d22 290a 0a20 2020 206d 696e 5f63 6f6c  m")..    min_col
+0000bce0: 203d 2063 6f6e 7665 7274 5f6c 696d 6974   = convert_limit
+0000bcf0: 5f74 6f5f 636f 6c28 6d69 6e5f 290a 2020  _to_col(min_).  
+0000bd00: 2020 6d61 785f 636f 6c20 3d20 636f 6e76    max_col = conv
+0000bd10: 6572 745f 6c69 6d69 745f 746f 5f63 6f6c  ert_limit_to_col
+0000bd20: 286d 6178 5f29 0a20 2020 2067 656e 5f63  (max_).    gen_c
+0000bd30: 6f6c 203d 2028 0a20 2020 2020 2020 206c  ol = (.        l
+0000bd40: 6974 2867 656e 2920 6966 2069 7369 6e73  it(gen) if isins
+0000bd50: 7461 6e63 6528 6765 6e2c 2028 696e 742c  tance(gen, (int,
+0000bd60: 2066 6c6f 6174 2929 2065 6c73 6520 5f74   float)) else _t
+0000bd70: 6f5f 636f 6c5f 6966 5f73 7472 2867 656e  o_col_if_str(gen
+0000bd80: 2c20 2275 6e69 666f 726d 2229 0a20 2020  , "uniform").   
+0000bd90: 2029 0a20 2020 2072 6574 7572 6e20 6275   ).    return bu
+0000bda0: 696c 7469 6e28 2275 6e69 666f 726d 2229  iltin("uniform")
+0000bdb0: 286d 696e 5f63 6f6c 2c20 6d61 785f 636f  (min_col, max_co
+0000bdc0: 6c2c 2067 656e 5f63 6f6c 290a 0a0a 6465  l, gen_col)...de
+0000bdd0: 6620 7365 7131 2873 6967 6e3a 2069 6e74  f seq1(sign: int
+0000bde0: 203d 2030 2920 2d3e 2043 6f6c 756d 6e3a   = 0) -> Column:
+0000bdf0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+0000be00: 6120 7365 7175 656e 6365 206f 6620 6d6f  a sequence of mo
+0000be10: 6e6f 746f 6e69 6361 6c6c 7920 696e 6372  notonically incr
+0000be20: 6561 7369 6e67 2069 6e74 6567 6572 732c  easing integers,
+0000be30: 2077 6974 6820 7772 6170 2d61 726f 756e   with wrap-aroun
+0000be40: 640a 2020 2020 7768 6963 6820 6861 7070  d.    which happ
+0000be50: 656e 7320 6166 7465 7220 6c61 7267 6573  ens after larges
+0000be60: 7420 7265 7072 6573 656e 7461 626c 6520  t representable 
+0000be70: 696e 7465 6765 7220 6f66 2069 6e74 6567  integer of integ
+0000be80: 6572 2077 6964 7468 2031 2062 7974 652e  er width 1 byte.
+0000be90: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+0000bea0: 2020 2020 7369 676e 3a20 5768 656e 2030      sign: When 0
+0000beb0: 2c20 7468 6520 7365 7175 656e 6365 2063  , the sequence c
+0000bec0: 6f6e 7469 6e75 6573 2061 7420 3020 6166  ontinues at 0 af
+0000bed0: 7465 7220 7772 6170 2d61 726f 756e 642e  ter wrap-around.
+0000bee0: 2057 6865 6e20 312c 2074 6865 2073 6571   When 1, the seq
+0000bef0: 7565 6e63 650a 2020 2020 2020 2020 2020  uence.          
+0000bf00: 2020 636f 6e74 696e 7565 7320 6174 2073    continues at s
+0000bf10: 6d61 6c6c 6573 7420 7265 7072 6573 656e  mallest represen
+0000bf20: 7461 626c 6520 3120 6279 7465 2069 6e74  table 1 byte int
+0000bf30: 6567 6572 2e20 4465 6661 756c 7473 2074  eger. Defaults t
+0000bf40: 6f20 302e 0a0a 2020 2020 5365 6520 416c  o 0...    See Al
+0000bf50: 736f 3a0a 2020 2020 2020 2020 2d20 3a6d  so:.        - :m
+0000bf60: 6574 683a 6053 6573 7369 6f6e 2e67 656e  eth:`Session.gen
+0000bf70: 6572 6174 6f72 602c 2077 6869 6368 2063  erator`, which c
+0000bf80: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
+0000bf90: 6e65 7261 7465 2069 6e20 7461 6e64 656d  nerate in tandem
+0000bfa0: 2077 6974 6820 6073 6571 3160 2074 6f0a   with `seq1` to.
+0000bfb0: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
+0000bfc0: 7261 7465 2073 6571 7565 6e63 6573 2e0a  rate sequences..
+0000bfd0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000bfe0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000bff0: 7365 7373 696f 6e2e 6765 6e65 7261 746f  session.generato
+0000c000: 7228 7365 7131 2830 292c 2072 6f77 636f  r(seq1(0), rowco
+0000c010: 756e 743d 3329 0a20 2020 2020 2020 203e  unt=3).        >
+0000c020: 3e3e 2064 662e 636f 6c6c 6563 7428 290a  >> df.collect().
+0000c030: 2020 2020 2020 2020 5b52 6f77 2853 4551          [Row(SEQ
+0000c040: 3128 3029 3d30 292c 2052 6f77 2853 4551  1(0)=0), Row(SEQ
+0000c050: 3128 3029 3d31 292c 2052 6f77 2853 4551  1(0)=1), Row(SEQ
+0000c060: 3128 3029 3d32 295d 0a20 2020 2022 2222  1(0)=2)].    """
+0000c070: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000c080: 7469 6e28 2273 6571 3122 2928 4c69 7465  tin("seq1")(Lite
+0000c090: 7261 6c28 7369 676e 2929 0a0a 0a64 6566  ral(sign))...def
+0000c0a0: 2073 6571 3228 7369 676e 3a20 696e 7420   seq2(sign: int 
+0000c0b0: 3d20 3029 202d 3e20 436f 6c75 6d6e 3a0a  = 0) -> Column:.
+0000c0c0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+0000c0d0: 2073 6571 7565 6e63 6520 6f66 206d 6f6e   sequence of mon
+0000c0e0: 6f74 6f6e 6963 616c 6c79 2069 6e63 7265  otonically incre
+0000c0f0: 6173 696e 6720 696e 7465 6765 7273 2c20  asing integers, 
+0000c100: 7769 7468 2077 7261 702d 6172 6f75 6e64  with wrap-around
+0000c110: 0a20 2020 2077 6869 6368 2068 6170 7065  .    which happe
+0000c120: 6e73 2061 6674 6572 206c 6172 6765 7374  ns after largest
+0000c130: 2072 6570 7265 7365 6e74 6162 6c65 2069   representable i
+0000c140: 6e74 6567 6572 206f 6620 696e 7465 6765  nteger of intege
+0000c150: 7220 7769 6474 6820 3220 6279 7465 2e0a  r width 2 byte..
+0000c160: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0000c170: 2020 2073 6967 6e3a 2057 6865 6e20 302c     sign: When 0,
+0000c180: 2074 6865 2073 6571 7565 6e63 6520 636f   the sequence co
+0000c190: 6e74 696e 7565 7320 6174 2030 2061 6674  ntinues at 0 aft
+0000c1a0: 6572 2077 7261 702d 6172 6f75 6e64 2e20  er wrap-around. 
+0000c1b0: 5768 656e 2031 2c20 7468 6520 7365 7175  When 1, the sequ
+0000c1c0: 656e 6365 0a20 2020 2020 2020 2020 2020  ence.           
+0000c1d0: 2063 6f6e 7469 6e75 6573 2061 7420 736d   continues at sm
+0000c1e0: 616c 6c65 7374 2072 6570 7265 7365 6e74  allest represent
+0000c1f0: 6162 6c65 2032 2062 7974 6520 696e 7465  able 2 byte inte
+0000c200: 6765 722e 2044 6566 6175 6c74 7320 746f  ger. Defaults to
+0000c210: 2030 2e0a 0a20 2020 2053 6565 2041 6c73   0...    See Als
+0000c220: 6f3a 0a20 2020 2020 2020 202d 203a 6d65  o:.        - :me
+0000c230: 7468 3a60 5365 7373 696f 6e2e 6765 6e65  th:`Session.gene
+0000c240: 7261 746f 7260 2c20 7768 6963 6820 6361  rator`, which ca
+0000c250: 6e20 6265 2075 7365 6420 746f 2067 656e  n be used to gen
+0000c260: 6572 6174 6520 696e 2074 616e 6465 6d20  erate in tandem 
+0000c270: 7769 7468 2060 7365 7132 6020 746f 0a20  with `seq2` to. 
+0000c280: 2020 2020 2020 2020 2020 2067 656e 6572             gener
+0000c290: 6174 6520 7365 7175 656e 6365 732e 0a0a  ate sequences...
+0000c2a0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0000c2b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000c2c0: 6573 7369 6f6e 2e67 656e 6572 6174 6f72  ession.generator
+0000c2d0: 2873 6571 3228 3029 2c20 726f 7763 6f75  (seq2(0), rowcou
+0000c2e0: 6e74 3d33 290a 2020 2020 2020 2020 3e3e  nt=3).        >>
+0000c2f0: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
+0000c300: 2020 2020 2020 205b 526f 7728 5345 5132         [Row(SEQ2
+0000c310: 2830 293d 3029 2c20 526f 7728 5345 5132  (0)=0), Row(SEQ2
+0000c320: 2830 293d 3129 2c20 526f 7728 5345 5132  (0)=1), Row(SEQ2
+0000c330: 2830 293d 3229 5d0a 2020 2020 2222 220a  (0)=2)].    """.
+0000c340: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000c350: 696e 2822 7365 7132 2229 284c 6974 6572  in("seq2")(Liter
+0000c360: 616c 2873 6967 6e29 290a 0a0a 6465 6620  al(sign))...def 
+0000c370: 7365 7134 2873 6967 6e3a 2069 6e74 203d  seq4(sign: int =
+0000c380: 2030 2920 2d3e 2043 6f6c 756d 6e3a 0a20   0) -> Column:. 
+0000c390: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
+0000c3a0: 7365 7175 656e 6365 206f 6620 6d6f 6e6f  sequence of mono
+0000c3b0: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
+0000c3c0: 7369 6e67 2069 6e74 6567 6572 732c 2077  sing integers, w
+0000c3d0: 6974 6820 7772 6170 2d61 726f 756e 640a  ith wrap-around.
+0000c3e0: 2020 2020 7768 6963 6820 6861 7070 656e      which happen
+0000c3f0: 7320 6166 7465 7220 6c61 7267 6573 7420  s after largest 
+0000c400: 7265 7072 6573 656e 7461 626c 6520 696e  representable in
+0000c410: 7465 6765 7220 6f66 2069 6e74 6567 6572  teger of integer
+0000c420: 2077 6964 7468 2034 2062 7974 652e 0a0a   width 4 byte...
+0000c430: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0000c440: 2020 7369 676e 3a20 5768 656e 2030 2c20    sign: When 0, 
+0000c450: 7468 6520 7365 7175 656e 6365 2063 6f6e  the sequence con
+0000c460: 7469 6e75 6573 2061 7420 3020 6166 7465  tinues at 0 afte
+0000c470: 7220 7772 6170 2d61 726f 756e 642e 2057  r wrap-around. W
+0000c480: 6865 6e20 312c 2074 6865 2073 6571 7565  hen 1, the seque
+0000c490: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
+0000c4a0: 636f 6e74 696e 7565 7320 6174 2073 6d61  continues at sma
+0000c4b0: 6c6c 6573 7420 7265 7072 6573 656e 7461  llest representa
+0000c4c0: 626c 6520 3420 6279 7465 2069 6e74 6567  ble 4 byte integ
+0000c4d0: 6572 2e20 4465 6661 756c 7473 2074 6f20  er. Defaults to 
+0000c4e0: 302e 0a0a 2020 2020 5365 6520 416c 736f  0...    See Also
+0000c4f0: 3a0a 2020 2020 2020 2020 2d20 3a6d 6574  :.        - :met
+0000c500: 683a 6053 6573 7369 6f6e 2e67 656e 6572  h:`Session.gener
+0000c510: 6174 6f72 602c 2077 6869 6368 2063 616e  ator`, which can
+0000c520: 2062 6520 7573 6564 2074 6f20 6765 6e65   be used to gene
+0000c530: 7261 7465 2069 6e20 7461 6e64 656d 2077  rate in tandem w
+0000c540: 6974 6820 6073 6571 3460 2074 6f0a 2020  ith `seq4` to.  
+0000c550: 2020 2020 2020 2020 2020 6765 6e65 7261            genera
+0000c560: 7465 2073 6571 7565 6e63 6573 2e0a 0a20  te sequences... 
+0000c570: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+0000c580: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000c590: 7373 696f 6e2e 6765 6e65 7261 746f 7228  ssion.generator(
+0000c5a0: 7365 7134 2830 292c 2072 6f77 636f 756e  seq4(0), rowcoun
+0000c5b0: 743d 3329 0a20 2020 2020 2020 203e 3e3e  t=3).        >>>
+0000c5c0: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+0000c5d0: 2020 2020 2020 5b52 6f77 2853 4551 3428        [Row(SEQ4(
+0000c5e0: 3029 3d30 292c 2052 6f77 2853 4551 3428  0)=0), Row(SEQ4(
+0000c5f0: 3029 3d31 292c 2052 6f77 2853 4551 3428  0)=1), Row(SEQ4(
+0000c600: 3029 3d32 295d 0a20 2020 2022 2222 0a20  0)=2)].    """. 
+0000c610: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0000c620: 6e28 2273 6571 3422 2928 4c69 7465 7261  n("seq4")(Litera
+0000c630: 6c28 7369 676e 2929 0a0a 0a64 6566 2073  l(sign))...def s
+0000c640: 6571 3828 7369 676e 3a20 696e 7420 3d20  eq8(sign: int = 
+0000c650: 3029 202d 3e20 436f 6c75 6d6e 3a0a 2020  0) -> Column:.  
+0000c660: 2020 2222 2252 6574 7572 6e73 2061 2073    """Returns a s
+0000c670: 6571 7565 6e63 6520 6f66 206d 6f6e 6f74  equence of monot
+0000c680: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
+0000c690: 696e 6720 696e 7465 6765 7273 2c20 7769  ing integers, wi
+0000c6a0: 7468 2077 7261 702d 6172 6f75 6e64 0a20  th wrap-around. 
+0000c6b0: 2020 2077 6869 6368 2068 6170 7065 6e73     which happens
+0000c6c0: 2061 6674 6572 206c 6172 6765 7374 2072   after largest r
+0000c6d0: 6570 7265 7365 6e74 6162 6c65 2069 6e74  epresentable int
+0000c6e0: 6567 6572 206f 6620 696e 7465 6765 7220  eger of integer 
+0000c6f0: 7769 6474 6820 3820 6279 7465 2e0a 0a20  width 8 byte... 
+0000c700: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0000c710: 2073 6967 6e3a 2057 6865 6e20 302c 2074   sign: When 0, t
+0000c720: 6865 2073 6571 7565 6e63 6520 636f 6e74  he sequence cont
+0000c730: 696e 7565 7320 6174 2030 2061 6674 6572  inues at 0 after
+0000c740: 2077 7261 702d 6172 6f75 6e64 2e20 5768   wrap-around. Wh
+0000c750: 656e 2031 2c20 7468 6520 7365 7175 656e  en 1, the sequen
+0000c760: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
+0000c770: 6f6e 7469 6e75 6573 2061 7420 736d 616c  ontinues at smal
+0000c780: 6c65 7374 2072 6570 7265 7365 6e74 6162  lest representab
+0000c790: 6c65 2038 2062 7974 6520 696e 7465 6765  le 8 byte intege
+0000c7a0: 722e 2044 6566 6175 6c74 7320 746f 2030  r. Defaults to 0
+0000c7b0: 2e0a 0a20 2020 2053 6565 2041 6c73 6f3a  ...    See Also:
+0000c7c0: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
+0000c7d0: 3a60 5365 7373 696f 6e2e 6765 6e65 7261  :`Session.genera
+0000c7e0: 746f 7260 2c20 7768 6963 6820 6361 6e20  tor`, which can 
+0000c7f0: 6265 2075 7365 6420 746f 2067 656e 6572  be used to gener
+0000c800: 6174 6520 696e 2074 616e 6465 6d20 7769  ate in tandem wi
+0000c810: 7468 2060 7365 7138 6020 746f 0a20 2020  th `seq8` to.   
+0000c820: 2020 2020 2020 2020 2067 656e 6572 6174           generat
+0000c830: 6520 7365 7175 656e 6365 732e 0a0a 2020  e sequences...  
+0000c840: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000c850: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000c860: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
+0000c870: 6571 3828 3029 2c20 726f 7763 6f75 6e74  eq8(0), rowcount
+0000c880: 3d33 290a 2020 2020 2020 2020 3e3e 3e20  =3).        >>> 
+0000c890: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+0000c8a0: 2020 2020 205b 526f 7728 5345 5138 2830       [Row(SEQ8(0
+0000c8b0: 293d 3029 2c20 526f 7728 5345 5138 2830  )=0), Row(SEQ8(0
+0000c8c0: 293d 3129 2c20 526f 7728 5345 5138 2830  )=1), Row(SEQ8(0
+0000c8d0: 293d 3229 5d0a 2020 2020 2222 220a 2020  )=2)].    """.  
+0000c8e0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000c8f0: 2822 7365 7138 2229 284c 6974 6572 616c  ("seq8")(Literal
+0000c900: 2873 6967 6e29 290a 0a0a 6465 6620 746f  (sign))...def to
+0000c910: 5f64 6563 696d 616c 2865 3a20 436f 6c75  _decimal(e: Colu
+0000c920: 6d6e 4f72 4e61 6d65 2c20 7072 6563 6973  mnOrName, precis
+0000c930: 696f 6e3a 2069 6e74 2c20 7363 616c 653a  ion: int, scale:
+0000c940: 2069 6e74 2920 2d3e 2043 6f6c 756d 6e3a   int) -> Column:
+0000c950: 0a20 2020 2022 2222 436f 6e76 6572 7473  .    """Converts
+0000c960: 2061 6e20 696e 7075 7420 6578 7072 6573   an input expres
+0000c970: 7369 6f6e 2074 6f20 6120 6465 6369 6d61  sion to a decima
+0000c980: 6c2e 0a0a 2020 2020 4578 616d 706c 653a  l...    Example:
+0000c990: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0000c9a0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0000c9b0: 655f 6461 7461 6672 616d 6528 5b27 3132  e_dataframe(['12
+0000c9c0: 272c 2027 3131 2e33 272c 2027 2d39 302e  ', '11.3', '-90.
+0000c9d0: 3132 3334 3527 5d2c 2073 6368 656d 613d  12345'], schema=
+0000c9e0: 5b27 6127 5d29 0a20 2020 2020 2020 203e  ['a']).        >
+0000c9f0: 3e3e 2064 662e 7365 6c65 6374 2874 6f5f  >> df.select(to_
+0000ca00: 6465 6369 6d61 6c28 636f 6c28 2761 2729  decimal(col('a')
+0000ca10: 2c20 3338 2c20 3029 2e61 735f 2827 616e  , 38, 0).as_('an
+0000ca20: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
+0000ca30: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+0000ca40: 3132 292c 2052 6f77 2841 4e53 3d31 3129  12), Row(ANS=11)
+0000ca50: 2c20 526f 7728 414e 533d 2d39 3029 5d0a  , Row(ANS=-90)].
+0000ca60: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000ca70: 7365 6c65 6374 2874 6f5f 6465 6369 6d61  select(to_decima
+0000ca80: 6c28 636f 6c28 2761 2729 2c20 3338 2c20  l(col('a'), 38, 
+0000ca90: 3229 2e61 735f 2827 616e 7327 2929 2e63  2).as_('ans')).c
+0000caa0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0000cab0: 205b 526f 7728 414e 533d 4465 6369 6d61   [Row(ANS=Decima
+0000cac0: 6c28 2731 322e 3030 2729 292c 2052 6f77  l('12.00')), Row
+0000cad0: 2841 4e53 3d44 6563 696d 616c 2827 3131  (ANS=Decimal('11
+0000cae0: 2e33 3027 2929 2c20 526f 7728 414e 533d  .30')), Row(ANS=
+0000caf0: 4465 6369 6d61 6c28 272d 3930 2e31 3227  Decimal('-90.12'
+0000cb00: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+0000cb10: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0000cb20: 7472 2865 2c20 2274 6f5f 6465 6369 6d61  tr(e, "to_decima
+0000cb30: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
+0000cb40: 7569 6c74 696e 2822 746f 5f64 6563 696d  uiltin("to_decim
+0000cb50: 616c 2229 2863 2c20 6c69 7428 7072 6563  al")(c, lit(prec
+0000cb60: 6973 696f 6e29 2c20 6c69 7428 7363 616c  ision), lit(scal
+0000cb70: 6529 290a 0a0a 6465 6620 6469 7630 280a  e))...def div0(.
+0000cb80: 2020 2020 6469 7669 6465 6e64 3a20 556e      dividend: Un
+0000cb90: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+0000cba0: 2c20 696e 742c 2066 6c6f 6174 5d2c 2064  , int, float], d
+0000cbb0: 6976 6973 6f72 3a20 556e 696f 6e5b 436f  ivisor: Union[Co
+0000cbc0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
+0000cbd0: 2066 6c6f 6174 5d0a 2920 2d3e 2043 6f6c   float].) -> Col
+0000cbe0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0000cbf0: 2050 6572 666f 726d 7320 6469 7669 7369   Performs divisi
+0000cc00: 6f6e 206c 696b 6520 7468 6520 6469 7669  on like the divi
+0000cc10: 7369 6f6e 206f 7065 7261 746f 7220 282f  sion operator (/
+0000cc20: 292c 0a20 2020 2062 7574 2072 6574 7572  ),.    but retur
+0000cc30: 6e73 2030 2077 6865 6e20 7468 6520 6469  ns 0 when the di
+0000cc40: 7669 736f 7220 6973 2030 2028 7261 7468  visor is 0 (rath
+0000cc50: 6572 2074 6861 6e20 7265 706f 7274 696e  er than reportin
+0000cc60: 6720 616e 2065 7272 6f72 292e 0a0a 2020  g an error)...  
+0000cc70: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0000cc80: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000cc90: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0000cca0: 6166 7261 6d65 285b 315d 2c20 7363 6865  aframe([1], sche
+0000ccb0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0000ccc0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0000ccd0: 6469 7630 2864 665b 2261 225d 2c20 3129  div0(df["a"], 1)
+0000cce0: 2e61 6c69 6173 2822 6469 7669 6465 645f  .alias("divided_
+0000ccf0: 6279 5f6f 6e65 2229 2c20 6469 7630 2864  by_one"), div0(d
+0000cd00: 665b 2261 225d 2c20 3029 2e61 6c69 6173  f["a"], 0).alias
+0000cd10: 2822 6469 7669 6465 645f 6279 5f7a 6572  ("divided_by_zer
+0000cd20: 6f22 2929 2e63 6f6c 6c65 6374 2829 0a20  o")).collect(). 
+0000cd30: 2020 2020 2020 205b 526f 7728 4449 5649         [Row(DIVI
+0000cd40: 4445 445f 4259 5f4f 4e45 3d44 6563 696d  DED_BY_ONE=Decim
+0000cd50: 616c 2827 312e 3030 3030 3030 2729 2c20  al('1.000000'), 
+0000cd60: 4449 5649 4445 445f 4259 5f5a 4552 4f3d  DIVIDED_BY_ZERO=
+0000cd70: 4465 6369 6d61 6c28 2730 2e30 3030 3030  Decimal('0.00000
+0000cd80: 3027 2929 5d0a 2020 2020 2222 220a 2020  0'))].    """.  
+0000cd90: 2020 6469 7669 6465 6e64 5f63 6f6c 203d    dividend_col =
+0000cda0: 2028 0a20 2020 2020 2020 206c 6974 2864   (.        lit(d
+0000cdb0: 6976 6964 656e 6429 0a20 2020 2020 2020  ividend).       
+0000cdc0: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+0000cdd0: 6976 6964 656e 642c 2028 696e 742c 2066  ividend, (int, f
+0000cde0: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
+0000cdf0: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
+0000ce00: 7472 2864 6976 6964 656e 642c 2022 6469  tr(dividend, "di
+0000ce10: 7630 2229 0a20 2020 2029 0a20 2020 2064  v0").    ).    d
+0000ce20: 6976 6973 6f72 5f63 6f6c 203d 2028 0a20  ivisor_col = (. 
+0000ce30: 2020 2020 2020 206c 6974 2864 6976 6973         lit(divis
+0000ce40: 6f72 290a 2020 2020 2020 2020 6966 2069  or).        if i
+0000ce50: 7369 6e73 7461 6e63 6528 6469 7669 736f  sinstance(diviso
+0000ce60: 722c 2028 696e 742c 2066 6c6f 6174 2929  r, (int, float))
+0000ce70: 0a20 2020 2020 2020 2065 6c73 6520 5f74  .        else _t
+0000ce80: 6f5f 636f 6c5f 6966 5f73 7472 2864 6976  o_col_if_str(div
+0000ce90: 6973 6f72 2c20 2264 6976 3022 290a 2020  isor, "div0").  
+0000cea0: 2020 290a 2020 2020 7265 7475 726e 2062    ).    return b
+0000ceb0: 7569 6c74 696e 2822 6469 7630 2229 2864  uiltin("div0")(d
+0000cec0: 6976 6964 656e 645f 636f 6c2c 2064 6976  ividend_col, div
+0000ced0: 6973 6f72 5f63 6f6c 290a 0a0a 6465 6620  isor_col)...def 
+0000cee0: 7371 7274 2865 3a20 436f 6c75 6d6e 4f72  sqrt(e: ColumnOr
+0000cef0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0000cf00: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+0000cf10: 7468 6520 7371 7561 7265 2d72 6f6f 7420  the square-root 
+0000cf20: 6f66 2061 206e 6f6e 2d6e 6567 6174 6976  of a non-negativ
+0000cf30: 6520 6e75 6d65 7269 6320 6578 7072 6573  e numeric expres
+0000cf40: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
+0000cf50: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+0000cf60: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0000cf70: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+0000cf80: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0000cf90: 5b34 2c20 395d 2c0a 2020 2020 2020 2020  [4, 9],.        
+0000cfa0: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
+0000cfb0: 224e 225d 2c0a 2020 2020 2020 2020 2e2e  "N"],.        ..
+0000cfc0: 2e20 292e 7365 6c65 6374 2873 7172 7428  . ).select(sqrt(
+0000cfd0: 636f 6c28 224e 2229 2929 0a20 2020 2020  col("N"))).     
+0000cfe0: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
+0000cff0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0000d000: 2853 5152 5428 224e 2229 3d32 2e30 292c  (SQRT("N")=2.0),
+0000d010: 2052 6f77 2853 5152 5428 224e 2229 3d33   Row(SQRT("N")=3
+0000d020: 2e30 295d 0a20 2020 2022 2222 0a20 2020  .0)].    """.   
+0000d030: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+0000d040: 7374 7228 652c 2022 7371 7274 2229 0a20  str(e, "sqrt"). 
+0000d050: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0000d060: 6e28 2273 7172 7422 2928 6329 0a0a 0a64  n("sqrt")(c)...d
+0000d070: 6566 2061 6273 2865 3a20 436f 6c75 6d6e  ef abs(e: Column
+0000d080: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0000d090: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+0000d0a0: 7320 7468 6520 6162 736f 6c75 7465 2076  s the absolute v
+0000d0b0: 616c 7565 206f 6620 6120 6e75 6d65 7269  alue of a numeri
+0000d0c0: 6320 6578 7072 6573 7369 6f6e 2e0a 0a20  c expression... 
+0000d0d0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+0000d0e0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000d0f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0000d100: 6166 7261 6d65 285b 5b2d 315d 5d2c 2073  aframe([[-1]], s
+0000d110: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0000d120: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0000d130: 6374 2861 6273 2863 6f6c 2822 6122 2929  ct(abs(col("a"))
+0000d140: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0000d150: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0000d160: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0000d170: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+0000d180: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0000d190: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000d1a0: 7c31 2020 2020 2020 2020 207c 0a20 2020  |1         |.   
+0000d1b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000d1c0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0000d1d0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0000d1e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0000d1f0: 5f73 7472 2865 2c20 2261 6273 2229 0a20  _str(e, "abs"). 
+0000d200: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0000d210: 6e28 2261 6273 2229 2863 290a 0a0a 6465  n("abs")(c)...de
+0000d220: 6620 6163 6f73 2865 3a20 436f 6c75 6d6e  f acos(e: Column
+0000d230: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0000d240: 6e3a 0a20 2020 2022 2222 436f 6d70 7574  n:.    """Comput
+0000d250: 6573 2074 6865 2069 6e76 6572 7365 2063  es the inverse c
+0000d260: 6f73 696e 6520 2861 7263 2063 6f73 696e  osine (arc cosin
+0000d270: 6529 206f 6620 6974 7320 696e 7075 743b  e) of its input;
+0000d280: 0a20 2020 2074 6865 2072 6573 756c 7420  .    the result 
+0000d290: 6973 2061 206e 756d 6265 7220 696e 2074  is a number in t
+0000d2a0: 6865 2069 6e74 6572 7661 6c20 5b2d 7069  he interval [-pi
+0000d2b0: 2c20 7069 5d2e 0a0a 2020 2020 4578 616d  , pi]...    Exam
+0000d2c0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+0000d2d0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+0000d2e0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+0000d2f0: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
+0000d300: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+0000d310: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000d320: 7465 5f64 6174 6166 7261 6d65 285b 5b30  te_dataframe([[0
+0000d330: 2e35 5d5d 2c20 7363 6865 6d61 3d5b 2264  .5]], schema=["d
+0000d340: 6567 225d 290a 2020 2020 2020 2020 3e3e  eg"]).        >>
+0000d350: 3e20 6466 2e73 656c 6563 7428 6163 6f73  > df.select(acos
+0000d360: 2863 6f6c 2822 6465 6722 2929 2e63 6173  (col("deg")).cas
+0000d370: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
+0000d380: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
+0000d390: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0000d3a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000d3b0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0000d3c0: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0000d3d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000d3e0: 2020 2020 2020 207c 312e 3034 3720 2020         |1.047   
+0000d3f0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000d400: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000d410: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0000d420: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0000d430: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+0000d440: 6163 6f73 2229 0a20 2020 2072 6574 7572  acos").    retur
+0000d450: 6e20 6275 696c 7469 6e28 2261 636f 7322  n builtin("acos"
+0000d460: 2928 6329 0a0a 0a64 6566 2061 7369 6e28  )(c)...def asin(
+0000d470: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0000d480: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000d490: 2222 2243 6f6d 7075 7465 7320 7468 6520  """Computes the 
+0000d4a0: 696e 7665 7273 6520 7369 6e65 2028 6172  inverse sine (ar
+0000d4b0: 6320 7369 6e65 2920 6f66 2069 7473 2069  c sine) of its i
+0000d4c0: 6e70 7574 3b0a 2020 2020 7468 6520 7265  nput;.    the re
+0000d4d0: 7375 6c74 2069 7320 6120 6e75 6d62 6572  sult is a number
+0000d4e0: 2069 6e20 7468 6520 696e 7465 7276 616c   in the interval
+0000d4f0: 205b 2d70 692c 2070 695d 2e0a 0a20 2020   [-pi, pi]...   
+0000d500: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0000d510: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0000d520: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0000d530: 7970 6573 2069 6d70 6f72 7420 4465 6369  ypes import Deci
+0000d540: 6d61 6c54 7970 650a 2020 2020 2020 2020  malType.        
+0000d550: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0000d560: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0000d570: 6528 5b5b 315d 5d2c 2073 6368 656d 613d  e([[1]], schema=
+0000d580: 5b22 6465 6722 5d29 0a20 2020 2020 2020  ["deg"]).       
+0000d590: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+0000d5a0: 7369 6e28 636f 6c28 2264 6567 2229 292e  sin(col("deg")).
+0000d5b0: 6361 7374 2844 6563 696d 616c 5479 7065  cast(DecimalType
+0000d5c0: 2873 6361 6c65 3d33 2929 2e61 6c69 6173  (scale=3)).alias
+0000d5d0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+0000d5e0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0000d5f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000d600: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
+0000d610: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000d620: 2d0a 2020 2020 2020 2020 7c31 2e35 3731  -.        |1.571
+0000d630: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0000d640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000d650: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0000d660: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0000d670: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+0000d680: 2c20 2261 7369 6e22 290a 2020 2020 7265  , "asin").    re
+0000d690: 7475 726e 2062 7569 6c74 696e 2822 6173  turn builtin("as
+0000d6a0: 696e 2229 2863 290a 0a0a 6465 6620 6174  in")(c)...def at
+0000d6b0: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
+0000d6c0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000d6d0: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
+0000d6e0: 6865 2069 6e76 6572 7365 2074 616e 6765  he inverse tange
+0000d6f0: 6e74 2028 6172 6320 7461 6e67 656e 7429  nt (arc tangent)
+0000d700: 206f 6620 6974 7320 696e 7075 743b 0a20   of its input;. 
+0000d710: 2020 2074 6865 2072 6573 756c 7420 6973     the result is
+0000d720: 2061 206e 756d 6265 7220 696e 2074 6865   a number in the
+0000d730: 2069 6e74 6572 7661 6c20 5b2d 7069 2c20   interval [-pi, 
+0000d740: 7069 5d2e 0a0a 2020 2020 4578 616d 706c  pi]...    Exampl
+0000d750: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0000d760: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0000d770: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+0000d780: 706f 7274 2044 6563 696d 616c 5479 7065  port DecimalType
+0000d790: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000d7a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000d7b0: 5f64 6174 6166 7261 6d65 285b 5b31 5d5d  _dataframe([[1]]
+0000d7c0: 2c20 7363 6865 6d61 3d5b 2264 6567 225d  , schema=["deg"]
+0000d7d0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0000d7e0: 2e73 656c 6563 7428 6174 616e 2863 6f6c  .select(atan(col
+0000d7f0: 2822 6465 6722 2929 2e63 6173 7428 4465  ("deg")).cast(De
+0000d800: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000d810: 3329 292e 616c 6961 7328 2272 6573 756c  3)).alias("resul
+0000d820: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+0000d830: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0000d840: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+0000d850: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+0000d860: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000d870: 2020 207c 302e 3738 3520 2020 2020 7c0a     |0.785     |.
+0000d880: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000d890: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0000d8a0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0000d8b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0000d8c0: 5f69 665f 7374 7228 652c 2022 6174 616e  _if_str(e, "atan
+0000d8d0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0000d8e0: 696c 7469 6e28 2261 7461 6e22 2928 6329  iltin("atan")(c)
+0000d8f0: 0a0a 0a64 6566 2061 7461 6e32 2879 3a20  ...def atan2(y: 
+0000d900: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 783a  ColumnOrName, x:
+0000d910: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0000d920: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0000d930: 2243 6f6d 7075 7465 7320 7468 6520 696e  "Computes the in
+0000d940: 7665 7273 6520 7461 6e67 656e 7420 2861  verse tangent (a
+0000d950: 7263 2074 616e 6765 6e74 2920 6f66 2069  rc tangent) of i
+0000d960: 7473 2069 6e70 7574 3b0a 2020 2020 7468  ts input;.    th
+0000d970: 6520 7265 7375 6c74 2069 7320 6120 6e75  e result is a nu
+0000d980: 6d62 6572 2069 6e20 7468 6520 696e 7465  mber in the inte
+0000d990: 7276 616c 205b 2d70 692c 2070 695d 2e0a  rval [-pi, pi]..
+0000d9a0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000d9b0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0000d9c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0000d9d0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+0000d9e0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
+0000d9f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000da00: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0000da10: 6672 616d 6528 5b5b 312c 2032 5d5d 2c20  frame([[1, 2]], 
+0000da20: 7363 6865 6d61 3d5b 2278 222c 2022 7922  schema=["x", "y"
+0000da30: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0000da40: 662e 7365 6c65 6374 2861 7461 6e32 2864  f.select(atan2(d
+0000da50: 662e 782c 2064 662e 7929 2e63 6173 7428  f.x, df.y).cast(
+0000da60: 4465 6369 6d61 6c54 7970 6528 7363 616c  DecimalType(scal
+0000da70: 653d 3329 292e 616c 6961 7328 2272 6573  e=3)).alias("res
+0000da80: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0000da90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000daa0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0000dab0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+0000dac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0000dad0: 2020 2020 207c 302e 3436 3420 2020 2020       |0.464     
+0000dae0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000daf0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0000db00: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0000db10: 2222 0a20 2020 2079 5f63 6f6c 203d 205f  "".    y_col = _
+0000db20: 746f 5f63 6f6c 5f69 665f 7374 7228 792c  to_col_if_str(y,
+0000db30: 2022 6174 616e 3222 290a 2020 2020 785f   "atan2").    x_
+0000db40: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
+0000db50: 5f73 7472 2878 2c20 2261 7461 6e32 2229  _str(x, "atan2")
+0000db60: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000db70: 7469 6e28 2261 7461 6e32 2229 2879 5f63  tin("atan2")(y_c
+0000db80: 6f6c 2c20 785f 636f 6c29 0a0a 0a64 6566  ol, x_col)...def
+0000db90: 2063 6569 6c28 653a 2043 6f6c 756d 6e4f   ceil(e: ColumnO
+0000dba0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000dbb0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+0000dbc0: 2076 616c 7565 7320 6672 6f6d 2074 6865   values from the
+0000dbd0: 2073 7065 6369 6669 6564 2063 6f6c 756d   specified colum
+0000dbe0: 6e20 726f 756e 6465 6420 746f 2074 6865  n rounded to the
+0000dbf0: 206e 6561 7265 7374 2065 7175 616c 206f   nearest equal o
+0000dc00: 7220 6c61 7267 6572 0a20 2020 2069 6e74  r larger.    int
+0000dc10: 6567 6572 2e0a 0a20 2020 2045 7861 6d70  eger...    Examp
+0000dc20: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0000dc30: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0000dc40: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0000dc50: 5b31 3335 2e31 3335 2c20 2d39 3735 2e39  [135.135, -975.9
+0000dc60: 3735 5d2c 2073 6368 656d 613d 5b22 6122  75], schema=["a"
+0000dc70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0000dc80: 662e 7365 6c65 6374 2863 6569 6c28 6466  f.select(ceil(df
+0000dc90: 5b22 6122 5d29 2e61 6c69 6173 2822 6365  ["a"]).alias("ce
+0000dca0: 696c 2229 292e 636f 6c6c 6563 7428 290a  il")).collect().
+0000dcb0: 2020 2020 2020 2020 5b52 6f77 2843 4549          [Row(CEI
+0000dcc0: 4c3d 3133 362e 3029 2c20 526f 7728 4345  L=136.0), Row(CE
+0000dcd0: 494c 3d2d 3937 352e 3029 5d0a 2020 2020  IL=-975.0)].    
+0000dce0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0000dcf0: 636f 6c5f 6966 5f73 7472 2865 2c20 2263  col_if_str(e, "c
+0000dd00: 6569 6c22 290a 2020 2020 7265 7475 726e  eil").    return
+0000dd10: 2062 7569 6c74 696e 2822 6365 696c 2229   builtin("ceil")
+0000dd20: 2863 290a 0a0a 6465 6620 636f 7328 653a  (c)...def cos(e:
+0000dd30: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0000dd40: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0000dd50: 2243 6f6d 7075 7465 7320 7468 6520 636f  "Computes the co
+0000dd60: 7369 6e65 206f 6620 6974 7320 6172 6775  sine of its argu
+0000dd70: 6d65 6e74 3b20 7468 6520 6172 6775 6d65  ment; the argume
+0000dd80: 6e74 2073 686f 756c 6420 6265 2065 7870  nt should be exp
+0000dd90: 7265 7373 6564 2069 6e20 7261 6469 616e  ressed in radian
+0000dda0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+0000ddb0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0000ddc0: 6d20 6d61 7468 2069 6d70 6f72 7420 7069  m math import pi
+0000ddd0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000dde0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000ddf0: 5f64 6174 6166 7261 6d65 285b 5b70 695d  _dataframe([[pi]
+0000de00: 5d2c 2073 6368 656d 613d 5b22 6465 6722  ], schema=["deg"
+0000de10: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0000de20: 662e 7365 6c65 6374 2863 6f73 2863 6f6c  f.select(cos(col
+0000de30: 2822 6465 6722 2929 2e61 6c69 6173 2822  ("deg")).alias("
+0000de40: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0000de50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000de60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0000de70: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+0000de80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0000de90: 2020 2020 2020 2020 7c2d 312e 3020 2020          |-1.0   
+0000dea0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0000deb0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000dec0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+0000ded0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0000dee0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0000def0: 2263 6f73 2229 0a20 2020 2072 6574 7572  "cos").    retur
+0000df00: 6e20 6275 696c 7469 6e28 2263 6f73 2229  n builtin("cos")
+0000df10: 2863 290a 0a0a 6465 6620 636f 7368 2865  (c)...def cosh(e
+0000df20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0000df30: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0000df40: 2222 436f 6d70 7574 6573 2074 6865 2068  ""Computes the h
+0000df50: 7970 6572 626f 6c69 6320 636f 7369 6e65  yperbolic cosine
+0000df60: 206f 6620 6974 7320 6172 6775 6d65 6e74   of its argument
+0000df70: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
+0000df80: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0000df90: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0000dfa0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+0000dfb0: 2044 6563 696d 616c 5479 7065 0a20 2020   DecimalType.   
+0000dfc0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000dfd0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0000dfe0: 6166 7261 6d65 285b 5b30 5d5d 2c20 7363  aframe([[0]], sc
+0000dff0: 6865 6d61 3d5b 2264 6567 225d 290a 2020  hema=["deg"]).  
+0000e000: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0000e010: 6563 7428 636f 7368 2863 6f6c 2822 6465  ect(cosh(col("de
+0000e020: 6722 2929 2e61 6c69 6173 2822 7265 7375  g")).alias("resu
+0000e030: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0000e040: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000e050: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0000e060: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0000e070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000e080: 2020 2020 7c31 2e30 2020 2020 2020 207c      |1.0       |
+0000e090: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000e0a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0000e0b0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0000e0c0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0000e0d0: 6c5f 6966 5f73 7472 2865 2c20 2263 6f73  l_if_str(e, "cos
+0000e0e0: 6822 290a 2020 2020 7265 7475 726e 2062  h").    return b
+0000e0f0: 7569 6c74 696e 2822 636f 7368 2229 2863  uiltin("cosh")(c
+0000e100: 290a 0a0a 6465 6620 6578 7028 653a 2043  )...def exp(e: C
+0000e110: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0000e120: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+0000e130: 2020 2020 436f 6d70 7574 6573 2045 756c      Computes Eul
+0000e140: 6572 2773 206e 756d 6265 7220 6520 7261  er's number e ra
+0000e150: 6973 6564 2074 6f20 6120 666c 6f61 7469  ised to a floati
+0000e160: 6e67 2d70 6f69 6e74 2076 616c 7565 2e0a  ng-point value..
+0000e170: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0000e180: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0000e190: 7274 206d 6174 680a 2020 2020 2020 2020  rt math.        
+0000e1a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0000e1b0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+0000e1c0: 7320 696d 706f 7274 2049 6e74 6567 6572  s import Integer
+0000e1d0: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+0000e1e0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0000e1f0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0000e200: 302e 302c 206d 6174 682e 6c6f 6728 3130  0.0, math.log(10
+0000e210: 295d 2c20 7363 6865 6d61 3d5b 2261 225d  )], schema=["a"]
+0000e220: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0000e230: 2e73 656c 6563 7428 6578 7028 6466 5b22  .select(exp(df["
+0000e240: 6122 5d29 2e63 6173 7428 496e 7465 6765  a"]).cast(Intege
+0000e250: 7254 7970 6528 2929 2e61 6c69 6173 2822  rType()).alias("
+0000e260: 6578 7022 2929 2e63 6f6c 6c65 6374 2829  exp")).collect()
+0000e270: 0a20 2020 2020 2020 205b 526f 7728 4558  .        [Row(EX
+0000e280: 503d 3129 2c20 526f 7728 4558 503d 3130  P=1), Row(EXP=10
+0000e290: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0000e2a0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0000e2b0: 7228 652c 2022 6578 7022 290a 2020 2020  r(e, "exp").    
+0000e2c0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000e2d0: 6578 7022 2928 6329 0a0a 0a64 6566 2066  exp")(c)...def f
+0000e2e0: 6163 746f 7269 616c 2865 3a20 436f 6c75  actorial(e: Colu
+0000e2f0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0000e300: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0000e310: 2043 6f6d 7075 7465 7320 7468 6520 6661   Computes the fa
+0000e320: 6374 6f72 6961 6c20 6f66 2069 7473 2069  ctorial of its i
+0000e330: 6e70 7574 2e20 5468 6520 696e 7075 7420  nput. The input 
+0000e340: 6172 6775 6d65 6e74 206d 7573 7420 6265  argument must be
+0000e350: 2061 6e20 696e 7465 6765 720a 2020 2020   an integer.    
+0000e360: 6578 7072 6573 7369 6f6e 2069 6e20 7468  expression in th
+0000e370: 6520 7261 6e67 6520 6f66 2030 2074 6f20  e range of 0 to 
+0000e380: 3333 2e0a 0a20 2020 2045 7861 6d70 6c65  33...    Example
+0000e390: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0000e3a0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0000e3b0: 6174 655f 6461 7461 6672 616d 6528 5b30  ate_dataframe([0
+0000e3c0: 2c20 312c 2035 2c20 3130 5d2c 2073 6368  , 1, 5, 10], sch
+0000e3d0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+0000e3e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0000e3f0: 2866 6163 746f 7269 616c 2864 665b 2261  (factorial(df["a
+0000e400: 225d 292e 616c 6961 7328 2266 6163 746f  "]).alias("facto
+0000e410: 7269 616c 2229 292e 636f 6c6c 6563 7428  rial")).collect(
+0000e420: 290a 2020 2020 2020 2020 5b52 6f77 2846  ).        [Row(F
+0000e430: 4143 544f 5249 414c 3d31 292c 2052 6f77  ACTORIAL=1), Row
+0000e440: 2846 4143 544f 5249 414c 3d31 292c 2052  (FACTORIAL=1), R
+0000e450: 6f77 2846 4143 544f 5249 414c 3d31 3230  ow(FACTORIAL=120
+0000e460: 292c 2052 6f77 2846 4143 544f 5249 414c  ), Row(FACTORIAL
+0000e470: 3d33 3632 3838 3030 295d 0a20 2020 2022  =3628800)].    "
+0000e480: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0000e490: 6f6c 5f69 665f 7374 7228 652c 2022 6661  ol_if_str(e, "fa
+0000e4a0: 6374 6f72 6961 6c22 290a 2020 2020 7265  ctorial").    re
+0000e4b0: 7475 726e 2062 7569 6c74 696e 2822 6661  turn builtin("fa
+0000e4c0: 6374 6f72 6961 6c22 2928 6329 0a0a 0a64  ctorial")(c)...d
+0000e4d0: 6566 2066 6c6f 6f72 2865 3a20 436f 6c75  ef floor(e: Colu
+0000e4e0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0000e4f0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0000e500: 2052 6574 7572 6e73 2076 616c 7565 7320   Returns values 
+0000e510: 6672 6f6d 2074 6865 2073 7065 6369 6669  from the specifi
+0000e520: 6564 2063 6f6c 756d 6e20 726f 756e 6465  ed column rounde
+0000e530: 6420 746f 2074 6865 206e 6561 7265 7374  d to the nearest
+0000e540: 2065 7175 616c 206f 720a 2020 2020 736d   equal or.    sm
+0000e550: 616c 6c65 7220 696e 7465 6765 722e 0a0a  aller integer...
+0000e560: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
+0000e570: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000e580: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0000e590: 6461 7461 6672 616d 6528 5b31 3335 2e31  dataframe([135.1
+0000e5a0: 3335 2c20 2d39 3735 2e39 3735 5d2c 2073  35, -975.975], s
+0000e5b0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0000e5c0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0000e5d0: 6374 2866 6c6f 6f72 2864 665b 2261 225d  ct(floor(df["a"]
+0000e5e0: 292e 616c 6961 7328 2266 6c6f 6f72 2229  ).alias("floor")
+0000e5f0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0000e600: 2020 2020 5b52 6f77 2846 4c4f 4f52 3d31      [Row(FLOOR=1
+0000e610: 3335 2e30 292c 2052 6f77 2846 4c4f 4f52  35.0), Row(FLOOR
+0000e620: 3d2d 3937 362e 3029 5d0a 2020 2020 2222  =-976.0)].    ""
+0000e630: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0000e640: 6c5f 6966 5f73 7472 2865 2c20 2266 6c6f  l_if_str(e, "flo
+0000e650: 6f72 2229 0a20 2020 2072 6574 7572 6e20  or").    return 
+0000e660: 6275 696c 7469 6e28 2266 6c6f 6f72 2229  builtin("floor")
+0000e670: 2863 290a 0a0a 6465 6620 666f 726d 6174  (c)...def format
+0000e680: 5f6e 756d 6265 7228 636f 6c3a 2043 6f6c  _number(col: Col
+0000e690: 756d 6e4f 724e 616d 652c 2064 3a20 556e  umnOrName, d: Un
+0000e6a0: 696f 6e5b 436f 6c75 6d6e 2c20 696e 745d  ion[Column, int]
+0000e6b0: 293a 0a20 2020 2022 2222 466f 726d 6174  ):.    """Format
+0000e6c0: 206e 756d 6265 7273 2074 6f20 6120 7370   numbers to a sp
+0000e6d0: 6563 6966 6963 206e 756d 6265 7220 6f66  ecific number of
+0000e6e0: 2064 6563 696d 616c 2070 6c61 6365 7320   decimal places 
+0000e6f0: 7769 7468 2048 414c 465f 544f 5f45 5645  with HALF_TO_EVE
+0000e700: 4e20 726f 756e 6469 6e67 2e0a 0a20 2020  N rounding...   
+0000e710: 204e 6f74 653a 0a20 2020 2020 2020 2031   Note:.        1
+0000e720: 2e20 5468 6520 6461 7461 2074 7970 6520  . The data type 
+0000e730: 6f66 2074 6865 2065 7870 7265 7373 696f  of the expressio
+0000e740: 6e20 6d75 7374 2062 6520 6f6e 6520 6f66  n must be one of
+0000e750: 2074 6865 2060 6461 7461 2074 7970 6573   the `data types
+0000e760: 2066 6f72 2061 2066 6978 6564 2d70 6f69   for a fixed-poi
+0000e770: 6e74 206e 756d 6265 720a 2020 2020 2020  nt number.      
+0000e780: 2020 3c68 7474 7073 3a2f 2f64 6f63 732e    <https://docs.
+0000e790: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
+0000e7a0: 2f73 716c 2d72 6566 6572 656e 6365 2f64  /sql-reference/d
+0000e7b0: 6174 612d 7479 7065 732d 6e75 6d65 7269  ata-types-numeri
+0000e7c0: 632e 6874 6d6c 236c 6162 656c 2d64 6174  c.html#label-dat
+0000e7d0: 612d 7479 7065 732d 666f 722d 6669 7865  a-types-for-fixe
+0000e7e0: 642d 706f 696e 742d 6e75 6d62 6572 733e  d-point-numbers>
+0000e7f0: 605f 2e0a 0a20 2020 2020 2020 2032 2e20  `_...        2. 
+0000e800: 4461 7461 2074 7970 6573 2066 6f72 2066  Data types for f
+0000e810: 6c6f 6174 696e 6720 706f 696e 7420 6e75  loating point nu
+0000e820: 6d62 6572 7320 2865 2e67 2e20 464c 4f41  mbers (e.g. FLOA
+0000e830: 5429 2061 7265 206e 6f74 2073 7570 706f  T) are not suppo
+0000e840: 7274 6564 2077 6974 6820 7468 6973 2061  rted with this a
+0000e850: 7267 756d 656e 742e 0a0a 2020 2020 2020  rgument...      
+0000e860: 2020 332e 2049 6620 7468 6520 6578 7072    3. If the expr
+0000e870: 6573 7369 6f6e 2064 6174 6120 7479 7065  ession data type
+0000e880: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+0000e890: 642c 2074 6865 2065 7870 7265 7373 696f  d, the expressio
+0000e8a0: 6e20 6d75 7374 2062 6520 6578 706c 6963  n must be explic
+0000e8b0: 6974 6c79 2063 6173 7420 746f 2064 6563  itly cast to dec
+0000e8c0: 696d 616c 2062 6566 6f72 6520 6361 6c6c  imal before call
+0000e8d0: 696e 672e 0a0a 2020 2020 4578 616d 706c  ing...    Exampl
+0000e8e0: 653a 3a0a 2020 2020 2020 2020 2020 2020  e::.            
+0000e8f0: 3e3e 3e20 696d 706f 7274 2064 6563 696d  >>> import decim
+0000e900: 616c 0a20 2020 2020 2020 2020 2020 203e  al.            >
+0000e910: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0000e920: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
+0000e930: 696f 6e73 2069 6d70 6f72 7420 666f 726d  ions import form
+0000e940: 6174 5f6e 756d 6265 720a 2020 2020 2020  at_number.      
+0000e950: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+0000e960: 205b 2831 2c20 6465 6369 6d61 6c2e 4465   [(1, decimal.De
+0000e970: 6369 6d61 6c28 332e 3134 3135 3929 292c  cimal(3.14159)),
+0000e980: 2028 322c 2064 6563 696d 616c 2e44 6563   (2, decimal.Dec
+0000e990: 696d 616c 2832 2e37 3138 3238 2929 2c20  imal(2.71828)), 
+0000e9a0: 2833 2c20 6465 6369 6d61 6c2e 4465 6369  (3, decimal.Deci
+0000e9b0: 6d61 6c28 312e 3431 3432 3129 295d 0a20  mal(1.41421))]. 
+0000e9c0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+0000e9d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000e9e0: 7465 4461 7461 4672 616d 6528 6461 7461  teDataFrame(data
+0000e9f0: 2c20 5b22 6964 222c 2022 7661 6c75 6522  , ["id", "value"
+0000ea00: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
+0000ea10: 3e3e 2064 662e 7365 6c65 6374 2822 6964  >> df.select("id
+0000ea20: 222c 666f 726d 6174 5f6e 756d 6265 7228  ",format_number(
+0000ea30: 2276 616c 7565 222c 3229 2e61 6c69 6173  "value",2).alias
+0000ea40: 2822 7661 6c75 6522 2929 2e73 686f 7728  ("value")).show(
+0000ea50: 290a 2020 2020 2020 2020 2020 2020 2d2d  ).            --
+0000ea60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ea70: 0a20 2020 2020 2020 2020 2020 207c 2249  .            |"I
+0000ea80: 4422 2020 7c22 5641 4c55 4522 2020 7c0a  D"  |"VALUE"  |.
+0000ea90: 2020 2020 2020 2020 2020 2020 2d2d 2d2d              ----
+0000eaa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0000eab0: 2020 2020 2020 2020 2020 207c 3120 2020             |1   
+0000eac0: 2020 7c33 2e31 3420 2020 2020 7c0a 2020    |3.14     |.  
+0000ead0: 2020 2020 2020 2020 2020 7c32 2020 2020            |2    
+0000eae0: 207c 322e 3732 2020 2020 207c 0a20 2020   |2.72     |.   
+0000eaf0: 2020 2020 2020 2020 207c 3320 2020 2020           |3     
+0000eb00: 7c31 2e34 3120 2020 2020 7c0a 2020 2020  |1.41     |.    
+0000eb10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000eb20: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000eb30: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0000eb40: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+0000eb50: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
+0000eb60: 7374 7228 636f 6c2c 2022 666f 726d 6174  str(col, "format
+0000eb70: 5f6e 756d 6265 7222 290a 2020 2020 7265  _number").    re
+0000eb80: 7475 726e 2062 726f 756e 6428 636f 6c2c  turn bround(col,
+0000eb90: 2064 292e 6361 7374 2853 7472 696e 6754   d).cast(StringT
+0000eba0: 7970 6528 2929 0a0a 0a64 6566 2073 696e  ype())...def sin
+0000ebb0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0000ebc0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0000ebd0: 2022 2222 436f 6d70 7574 6573 2074 6865   """Computes the
+0000ebe0: 2073 696e 6520 6f66 2069 7473 2061 7267   sine of its arg
+0000ebf0: 756d 656e 743b 2074 6865 2061 7267 756d  ument; the argum
+0000ec00: 656e 7420 7368 6f75 6c64 2062 6520 6578  ent should be ex
+0000ec10: 7072 6573 7365 6420 696e 2072 6164 6961  pressed in radia
+0000ec20: 6e73 2e0a 0a20 2020 2045 7861 6d70 6c65  ns...    Example
+0000ec30: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+0000ec40: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+0000ec50: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+0000ec60: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
+0000ec70: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000ec80: 2073 6573 7369 6f6e 2e67 656e 6572 6174   session.generat
+0000ec90: 6f72 2873 6571 3128 3029 2c20 726f 7763  or(seq1(0), rowc
+0000eca0: 6f75 6e74 3d33 292e 7365 6c65 6374 2873  ount=3).select(s
+0000ecb0: 696e 2873 6571 3128 3029 292e 6361 7374  in(seq1(0)).cast
+0000ecc0: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
+0000ecd0: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
+0000ece0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+0000ecf0: 0a20 2020 2020 2020 205b 526f 7728 4341  .        [Row(CA
+0000ed00: 5354 2028 5349 4e28 5345 5131 2830 2929  ST (SIN(SEQ1(0))
+0000ed10: 2041 5320 4e55 4d42 4552 2833 382c 2034   AS NUMBER(38, 4
+0000ed20: 2929 3d44 6563 696d 616c 2827 302e 3030  ))=Decimal('0.00
+0000ed30: 3030 2729 292c 2052 6f77 2843 4153 5420  00')), Row(CAST 
+0000ed40: 2853 494e 2853 4551 3128 3029 2920 4153  (SIN(SEQ1(0)) AS
+0000ed50: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
+0000ed60: 4465 6369 6d61 6c28 2730 2e38 3431 3527  Decimal('0.8415'
+0000ed70: 2929 2c20 526f 7728 4341 5354 2028 5349  )), Row(CAST (SI
+0000ed80: 4e28 5345 5131 2830 2929 2041 5320 4e55  N(SEQ1(0)) AS NU
+0000ed90: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+0000eda0: 696d 616c 2827 302e 3930 3933 2729 295d  imal('0.9093'))]
+0000edb0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0000edc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000edd0: 652c 2022 7369 6e22 290a 2020 2020 7265  e, "sin").    re
+0000ede0: 7475 726e 2062 7569 6c74 696e 2822 7369  turn builtin("si
+0000edf0: 6e22 2928 6329 0a0a 0a64 6566 2073 696e  n")(c)...def sin
+0000ee00: 6828 653a 2043 6f6c 756d 6e4f 724e 616d  h(e: ColumnOrNam
+0000ee10: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0000ee20: 2020 2222 2243 6f6d 7075 7465 7320 7468    """Computes th
+0000ee30: 6520 6879 7065 7262 6f6c 6963 2073 696e  e hyperbolic sin
+0000ee40: 6520 6f66 2069 7473 2061 7267 756d 656e  e of its argumen
+0000ee50: 742e 0a0a 2020 2020 4578 616d 706c 653a  t...    Example:
+0000ee60: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+0000ee70: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0000ee80: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+0000ee90: 7274 2044 6563 696d 616c 5479 7065 0a20  rt DecimalType. 
+0000eea0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000eeb0: 7365 7373 696f 6e2e 6765 6e65 7261 746f  session.generato
+0000eec0: 7228 7365 7131 2830 292c 2072 6f77 636f  r(seq1(0), rowco
+0000eed0: 756e 743d 3329 2e73 656c 6563 7428 7369  unt=3).select(si
+0000eee0: 6e68 2873 6571 3128 3029 292e 6361 7374  nh(seq1(0)).cast
+0000eef0: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
+0000ef00: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
+0000ef10: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+0000ef20: 0a20 2020 2020 2020 205b 526f 7728 4341  .        [Row(CA
+0000ef30: 5354 2028 5349 4e48 2853 4551 3128 3029  ST (SINH(SEQ1(0)
+0000ef40: 2920 4153 204e 554d 4245 5228 3338 2c20  ) AS NUMBER(38, 
+0000ef50: 3429 293d 4465 6369 6d61 6c28 2730 2e30  4))=Decimal('0.0
+0000ef60: 3030 3027 2929 2c20 526f 7728 4341 5354  000')), Row(CAST
+0000ef70: 2028 5349 4e48 2853 4551 3128 3029 2920   (SINH(SEQ1(0)) 
+0000ef80: 4153 204e 554d 4245 5228 3338 2c20 3429  AS NUMBER(38, 4)
+0000ef90: 293d 4465 6369 6d61 6c28 2731 2e31 3735  )=Decimal('1.175
+0000efa0: 3227 2929 2c20 526f 7728 4341 5354 2028  2')), Row(CAST (
+0000efb0: 5349 4e48 2853 4551 3128 3029 2920 4153  SINH(SEQ1(0)) AS
+0000efc0: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
+0000efd0: 4465 6369 6d61 6c28 2733 2e36 3236 3927  Decimal('3.6269'
+0000efe0: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+0000eff0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0000f000: 7472 2865 2c20 2273 696e 6822 290a 2020  tr(e, "sinh").  
+0000f010: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000f020: 2822 7369 6e68 2229 2863 290a 0a0a 6465  ("sinh")(c)...de
+0000f030: 6620 7461 6e28 653a 2043 6f6c 756d 6e4f  f tan(e: ColumnO
+0000f040: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000f050: 3a0a 2020 2020 2222 2243 6f6d 7075 7465  :.    """Compute
+0000f060: 7320 7468 6520 7461 6e67 656e 7420 6f66  s the tangent of
+0000f070: 2069 7473 2061 7267 756d 656e 743b 2074   its argument; t
+0000f080: 6865 2061 7267 756d 656e 7420 7368 6f75  he argument shou
+0000f090: 6c64 2062 6520 6578 7072 6573 7365 6420  ld be expressed 
+0000f0a0: 696e 2072 6164 6961 6e73 2e0a 0a20 2020  in radians...   
+0000f0b0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0000f0c0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0000f0d0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
+0000f0e0: 7065 7320 696d 706f 7274 2044 6563 696d  pes import Decim
+0000f0f0: 616c 5479 7065 0a20 2020 2020 2020 3e3e  alType.       >>
+0000f100: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0000f110: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0000f120: 5b30 2c20 315d 2c20 7363 6865 6d61 3d5b  [0, 1], schema=[
+0000f130: 224e 225d 292e 7365 6c65 6374 280a 2020  "N"]).select(.  
+0000f140: 2020 2020 202e 2e2e 2020 2020 2074 616e       ...     tan
+0000f150: 2863 6f6c 2822 4e22 2929 2e63 6173 7428  (col("N")).cast(
+0000f160: 4465 6369 6d61 6c54 7970 6528 7363 616c  DecimalType(scal
+0000f170: 653d 3429 290a 2020 2020 2020 202e 2e2e  e=4)).       ...
+0000f180: 2029 0a20 2020 2020 2020 3e3e 3e20 6466   ).       >>> df
+0000f190: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0000f1a0: 2020 5b52 6f77 2843 4153 5420 2854 414e    [Row(CAST (TAN
+0000f1b0: 2822 4e22 2920 4153 204e 554d 4245 5228  ("N") AS NUMBER(
+0000f1c0: 3338 2c20 3429 293d 4465 6369 6d61 6c28  38, 4))=Decimal(
+0000f1d0: 2730 2e30 3030 3027 2929 2c20 526f 7728  '0.0000')), Row(
+0000f1e0: 4341 5354 2028 5441 4e28 224e 2229 2041  CAST (TAN("N") A
+0000f1f0: 5320 4e55 4d42 4552 2833 382c 2034 2929  S NUMBER(38, 4))
+0000f200: 3d44 6563 696d 616c 2827 312e 3535 3734  =Decimal('1.5574
+0000f210: 2729 295d 0a20 2020 2022 2222 0a20 2020  '))].    """.   
+0000f220: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+0000f230: 7374 7228 652c 2022 7461 6e22 290a 2020  str(e, "tan").  
+0000f240: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000f250: 2822 7461 6e22 2928 6329 0a0a 0a64 6566  ("tan")(c)...def
+0000f260: 2074 616e 6828 653a 2043 6f6c 756d 6e4f   tanh(e: ColumnO
+0000f270: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000f280: 3a0a 2020 2020 2222 2243 6f6d 7075 7465  :.    """Compute
+0000f290: 7320 7468 6520 6879 7065 7262 6f6c 6963  s the hyperbolic
+0000f2a0: 2074 616e 6765 6e74 206f 6620 6974 7320   tangent of its 
+0000f2b0: 6172 6775 6d65 6e74 2e0a 0a20 2020 2045  argument...    E
+0000f2c0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0000f2d0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0000f2e0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0000f2f0: 6573 2069 6d70 6f72 7420 4465 6369 6d61  es import Decima
+0000f300: 6c54 7970 650a 2020 2020 2020 2020 3e3e  lType.        >>
+0000f310: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0000f320: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0000f330: 5b30 2c20 315d 2c20 7363 6865 6d61 3d5b  [0, 1], schema=[
+0000f340: 224e 225d 292e 7365 6c65 6374 280a 2020  "N"]).select(.  
+0000f350: 2020 2020 2020 2e2e 2e20 2020 2020 7461        ...     ta
+0000f360: 6e68 2863 6f6c 2822 4e22 292e 6361 7374  nh(col("N").cast
+0000f370: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
+0000f380: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
+0000f390: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+0000f3a0: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
+0000f3b0: 2020 2020 2020 205b 526f 7728 5441 4e48         [Row(TANH
+0000f3c0: 2820 4341 5354 2028 224e 2220 4153 204e  ( CAST ("N" AS N
+0000f3d0: 554d 4245 5228 3338 2c20 3429 2929 3d30  UMBER(38, 4)))=0
+0000f3e0: 2e30 292c 2052 6f77 2854 414e 4828 2043  .0), Row(TANH( C
+0000f3f0: 4153 5420 2822 4e22 2041 5320 4e55 4d42  AST ("N" AS NUMB
+0000f400: 4552 2833 382c 2034 2929 293d 302e 3736  ER(38, 4)))=0.76
+0000f410: 3135 3934 3135 3539 3535 3736 3439 295d  15941559557649)]
+0000f420: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0000f430: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000f440: 652c 2022 7461 6e68 2229 0a20 2020 2072  e, "tanh").    r
+0000f450: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+0000f460: 616e 6822 2928 6329 0a0a 0a64 6566 2064  anh")(c)...def d
+0000f470: 6567 7265 6573 2865 3a20 436f 6c75 6d6e  egrees(e: Column
+0000f480: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0000f490: 6e3a 0a20 2020 2022 2222 0a20 2020 2043  n:.    """.    C
+0000f4a0: 6f6e 7665 7274 7320 7261 6469 616e 7320  onverts radians 
+0000f4b0: 746f 2064 6567 7265 6573 2e0a 0a20 2020  to degrees...   
+0000f4c0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0000f4d0: 2020 2020 3e3e 3e20 696d 706f 7274 206d      >>> import m
+0000f4e0: 6174 680a 2020 2020 2020 2020 3e3e 3e20  ath.        >>> 
+0000f4f0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0000f500: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+0000f510: 706f 7274 2053 7472 7563 7454 7970 652c  port StructType,
+0000f520: 2053 7472 7563 7446 6965 6c64 2c20 446f   StructField, Do
+0000f530: 7562 6c65 5479 7065 2c20 496e 7465 6765  ubleType, Intege
+0000f540: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
+0000f550: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0000f560: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0000f570: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0000f580: 205b 6d61 7468 2e70 6920 2f20 332c 206d   [math.pi / 3, m
+0000f590: 6174 682e 7069 2c20 3320 2a20 6d61 7468  ath.pi, 3 * math
+0000f5a0: 2e70 695d 2c0a 2020 2020 2020 2020 2e2e  .pi],.        ..
+0000f5b0: 2e20 2020 2020 7363 6865 6d61 3d53 7472  .     schema=Str
+0000f5c0: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
+0000f5d0: 6965 6c64 2822 6122 2c20 446f 7562 6c65  ield("a", Double
+0000f5e0: 5479 7065 2829 295d 292c 0a20 2020 2020  Type())]),.     
+0000f5f0: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
+0000f600: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+0000f610: 6567 7265 6573 2863 6f6c 2822 6122 2929  egrees(col("a"))
+0000f620: 2e63 6173 7428 496e 7465 6765 7254 7970  .cast(IntegerTyp
+0000f630: 6528 2929 2e61 6c69 6173 2822 4445 4752  e()).alias("DEGR
+0000f640: 4545 5322 2929 2e63 6f6c 6c65 6374 2829  EES")).collect()
+0000f650: 0a20 2020 2020 2020 205b 526f 7728 4445  .        [Row(DE
+0000f660: 4752 4545 533d 3630 292c 2052 6f77 2844  GREES=60), Row(D
+0000f670: 4547 5245 4553 3d31 3830 292c 2052 6f77  EGREES=180), Row
+0000f680: 2844 4547 5245 4553 3d35 3430 295d 0a20  (DEGREES=540)]. 
+0000f690: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0000f6a0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+0000f6b0: 2022 6465 6772 6565 7322 290a 2020 2020   "degrees").    
+0000f6c0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000f6d0: 6465 6772 6565 7322 2928 6329 0a0a 0a64  degrees")(c)...d
+0000f6e0: 6566 2072 6164 6961 6e73 2865 3a20 436f  ef radians(e: Co
+0000f6f0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000f700: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+0000f710: 6e76 6572 7473 2064 6567 7265 6573 2074  nverts degrees t
+0000f720: 6f20 7261 6469 616e 732e 0a0a 2020 2020  o radians...    
+0000f730: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
+0000f740: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000f750: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0000f760: 6672 616d 6528 5b5b 312e 3131 315d 2c20  frame([[1.111], 
+0000f770: 5b32 2e32 3232 5d2c 205b 332e 3333 335d  [2.222], [3.333]
+0000f780: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+0000f790: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000f7a0: 7365 6c65 6374 2872 6164 6961 6e73 2863  select(radians(c
+0000f7b0: 6f6c 2822 6122 2929 2e63 6173 7428 226e  ol("a")).cast("n
+0000f7c0: 756d 6265 7228 3338 2c20 3529 2229 2e61  umber(38, 5)").a
+0000f7d0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+0000f7e0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+0000f7f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000f800: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+0000f810: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000f820: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c30  -----.        |0
+0000f830: 2e30 3139 3339 2020 207c 0a20 2020 2020  .01939   |.     
+0000f840: 2020 207c 302e 3033 3837 3820 2020 7c0a     |0.03878   |.
+0000f850: 2020 2020 2020 2020 7c30 2e30 3538 3137          |0.05817
+0000f860: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0000f870: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000f880: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+0000f890: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0000f8a0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0000f8b0: 2272 6164 6961 6e73 2229 0a20 2020 2072  "radians").    r
+0000f8c0: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
+0000f8d0: 6164 6961 6e73 2229 2863 290a 0a0a 6465  adians")(c)...de
+0000f8e0: 6620 6d64 3528 653a 2043 6f6c 756d 6e4f  f md5(e: ColumnO
+0000f8f0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000f900: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0000f910: 7475 726e 7320 6120 3332 2d63 6861 7261  turns a 32-chara
+0000f920: 6374 6572 2068 6578 2d65 6e63 6f64 6564  cter hex-encoded
+0000f930: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
+0000f940: 6e67 2074 6865 2031 3238 2d62 6974 204d  ng the 128-bit M
+0000f950: 4435 206d 6573 7361 6765 2064 6967 6573  D5 message diges
+0000f960: 742e 0a0a 2020 2020 2045 7861 6d70 6c65  t...     Example
+0000f970: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0000f980: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0000f990: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
+0000f9a0: 6122 2c20 2262 225d 2c20 7363 6865 6d61  a", "b"], schema
+0000f9b0: 3d5b 2263 6f6c 225d 292e 7365 6c65 6374  =["col"]).select
+0000f9c0: 286d 6435 2822 636f 6c22 2929 0a20 2020  (md5("col")).   
+0000f9d0: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
+0000f9e0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0000f9f0: 6f77 284d 4435 2822 434f 4c22 293d 2730  ow(MD5("COL")='0
+0000fa00: 6363 3137 3562 3963 3066 3162 3661 3833  cc175b9c0f1b6a83
+0000fa10: 3163 3339 3965 3236 3937 3732 3636 3127  1c399e269772661'
+0000fa20: 292c 2052 6f77 284d 4435 2822 434f 4c22  ), Row(MD5("COL"
+0000fa30: 293d 2739 3265 6235 6666 6565 3661 6532  )='92eb5ffee6ae2
+0000fa40: 6665 6333 6164 3731 6337 3737 3533 3135  fec3ad71c7775315
+0000fa50: 3738 6627 295d 0a20 2020 2022 2222 0a20  78f')].    """. 
+0000fa60: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000fa70: 665f 7374 7228 652c 2022 6d64 3522 290a  f_str(e, "md5").
+0000fa80: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000fa90: 696e 2822 6d64 3522 2928 6329 0a0a 0a64  in("md5")(c)...d
+0000faa0: 6566 2073 6861 3128 653a 2043 6f6c 756d  ef sha1(e: Colum
+0000fab0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0000fac0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0000fad0: 6e73 2061 2034 302d 6368 6172 6163 7465  ns a 40-characte
+0000fae0: 7220 6865 782d 656e 636f 6465 6420 7374  r hex-encoded st
+0000faf0: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
+0000fb00: 7468 6520 3136 302d 6269 7420 5348 412d  the 160-bit SHA-
+0000fb10: 3120 6d65 7373 6167 6520 6469 6765 7374  1 message digest
+0000fb20: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0000fb30: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000fb40: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000fb50: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
+0000fb60: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
+0000fb70: 636f 6c22 5d29 2e73 656c 6563 7428 7368  col"]).select(sh
+0000fb80: 6131 2822 636f 6c22 2929 0a20 2020 2020  a1("col")).     
+0000fb90: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
+0000fba0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0000fbb0: 2853 4841 3128 2243 4f4c 2229 3d27 3836  (SHA1("COL")='86
+0000fbc0: 6637 6534 3337 6661 6135 6137 6663 6531  f7e437faa5a7fce1
+0000fbd0: 3564 3164 6463 6239 6561 6561 6561 3337  5d1ddcb9eaeaea37
+0000fbe0: 3736 3637 6238 2729 2c20 526f 7728 5348  7667b8'), Row(SH
+0000fbf0: 4131 2822 434f 4c22 293d 2765 3964 3731  A1("COL")='e9d71
+0000fc00: 6635 6565 3763 3932 6436 6463 3965 3932  f5ee7c92d6dc9e92
+0000fc10: 6666 6461 6431 3762 3862 6434 3934 3138  ffdad17b8bd49418
+0000fc20: 6639 3827 295d 0a20 2020 2022 2222 0a20  f98')].    """. 
+0000fc30: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000fc40: 665f 7374 7228 652c 2022 7368 6131 2229  f_str(e, "sha1")
+0000fc50: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000fc60: 7469 6e28 2273 6861 3122 2928 6329 0a0a  tin("sha1")(c)..
+0000fc70: 0a64 6566 2073 6861 3228 653a 2043 6f6c  .def sha2(e: Col
+0000fc80: 756d 6e4f 724e 616d 652c 206e 756d 5f62  umnOrName, num_b
+0000fc90: 6974 733a 2069 6e74 2920 2d3e 2043 6f6c  its: int) -> Col
+0000fca0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0000fcb0: 726e 7320 6120 6865 782d 656e 636f 6465  rns a hex-encode
+0000fcc0: 6420 7374 7269 6e67 2063 6f6e 7461 696e  d string contain
+0000fcd0: 696e 6720 7468 6520 4e2d 6269 7420 5348  ing the N-bit SH
+0000fce0: 412d 3220 6d65 7373 6167 6520 6469 6765  A-2 message dige
+0000fcf0: 7374 2c0a 2020 2020 7768 6572 6520 4e20  st,.    where N 
+0000fd00: 6973 2074 6865 2073 7065 6369 6669 6564  is the specified
+0000fd10: 206f 7574 7075 7420 6469 6765 7374 2073   output digest s
+0000fd20: 697a 652e 0a0a 2020 2020 4578 616d 706c  ize...    Exampl
+0000fd30: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0000fd40: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0000fd50: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
+0000fd60: 6122 2c20 2262 225d 2c20 7363 6865 6d61  a", "b"], schema
+0000fd70: 3d5b 2263 6f6c 225d 292e 7365 6c65 6374  =["col"]).select
+0000fd80: 2873 6861 3228 2263 6f6c 222c 2032 3536  (sha2("col", 256
+0000fd90: 2929 0a20 2020 2020 2020 203e 3e3e 2064  )).        >>> d
+0000fda0: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+0000fdb0: 2020 2020 5b52 6f77 2853 4841 3228 2243      [Row(SHA2("C
+0000fdc0: 4f4c 222c 2032 3536 293d 2763 6139 3738  OL", 256)='ca978
+0000fdd0: 3131 3263 6131 6262 6463 6166 6163 3233  112ca1bbdcafac23
+0000fde0: 3162 3339 6132 3364 6334 6461 3738 3665  1b39a23dc4da786e
+0000fdf0: 6666 3831 3437 6334 6537 3262 3938 3037  ff8147c4e72b9807
+0000fe00: 3738 3561 6665 6534 3862 6227 292c 2052  785afee48bb'), R
+0000fe10: 6f77 2853 4841 3228 2243 4f4c 222c 2032  ow(SHA2("COL", 2
+0000fe20: 3536 293d 2733 6532 3365 3831 3630 3033  56)='3e23e816003
+0000fe30: 3935 3934 6133 3338 3934 6636 3536 3465  9594a33894f6564e
+0000fe40: 3162 3133 3438 6262 6437 6130 3038 3864  1b1348bbd7a0088d
+0000fe50: 3432 6334 6163 6237 3365 6561 6564 3539  42c4acb73eeaed59
+0000fe60: 6330 3039 6427 295d 0a20 2020 2022 2222  c009d')].    """
+0000fe70: 0a20 2020 2070 6572 6d69 7474 6564 5f76  .    permitted_v
+0000fe80: 616c 7565 7320 3d20 5b30 2c20 3232 342c  alues = [0, 224,
+0000fe90: 2032 3536 2c20 3338 342c 2035 3132 5d0a   256, 384, 512].
+0000fea0: 2020 2020 6966 206e 756d 5f62 6974 7320      if num_bits 
+0000feb0: 6e6f 7420 696e 2070 6572 6d69 7474 6564  not in permitted
+0000fec0: 5f76 616c 7565 733a 0a20 2020 2020 2020  _values:.       
+0000fed0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000fee0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
+0000fef0: 226e 756d 5f62 6974 7320 7b6e 756d 5f62  "num_bits {num_b
+0000ff00: 6974 737d 2069 7320 6e6f 7420 696e 2074  its} is not in t
+0000ff10: 6865 2070 6572 6d69 7474 6564 2076 616c  he permitted val
+0000ff20: 7565 7320 7b70 6572 6d69 7474 6564 5f76  ues {permitted_v
+0000ff30: 616c 7565 737d 220a 2020 2020 2020 2020  alues}".        
+0000ff40: 290a 2020 2020 6320 3d20 5f74 6f5f 636f  ).    c = _to_co
+0000ff50: 6c5f 6966 5f73 7472 2865 2c20 2273 6861  l_if_str(e, "sha
+0000ff60: 3222 290a 2020 2020 7265 7475 726e 2062  2").    return b
+0000ff70: 7569 6c74 696e 2822 7368 6132 2229 2863  uiltin("sha2")(c
+0000ff80: 2c20 6e75 6d5f 6269 7473 290a 0a0a 6465  , num_bits)...de
+0000ff90: 6620 6861 7368 282a 636f 6c73 3a20 436f  f hash(*cols: Co
+0000ffa0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000ffb0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+0000ffc0: 2020 2052 6574 7572 6e73 2061 2073 6967     Returns a sig
+0000ffd0: 6e65 6420 3634 2d62 6974 2068 6173 6820  ned 64-bit hash 
+0000ffe0: 7661 6c75 652e 204e 6f74 6520 7468 6174  value. Note that
+0000fff0: 2048 4153 4820 6e65 7665 7220 7265 7475   HASH never retu
+00010000: 726e 7320 4e55 4c4c 2c20 6576 656e 2066  rns NULL, even f
+00010010: 6f72 204e 554c 4c20 696e 7075 7473 2e0a  or NULL inputs..
+00010020: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+00010030: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00010040: 6f72 7420 6465 6369 6d61 6c0a 2020 2020  ort decimal.    
+00010050: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00010060: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00010070: 6672 616d 6528 5b5b 3130 2c20 2231 3022  frame([[10, "10"
+00010080: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
+00010090: 6c28 3130 292c 2031 302e 305d 5d2c 2073  l(10), 10.0]], s
+000100a0: 6368 656d 613d 5b22 6122 2c20 2262 222c  chema=["a", "b",
+000100b0: 2022 6322 2c20 2264 225d 290a 2020 2020   "c", "d"]).    
+000100c0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000100d0: 7428 6861 7368 2822 6122 292e 616c 6961  t(hash("a").alia
+000100e0: 7328 2268 6173 685f 6122 292c 2068 6173  s("hash_a"), has
+000100f0: 6828 2262 2229 2e61 6c69 6173 2822 6861  h("b").alias("ha
+00010100: 7368 5f62 2229 2c20 6861 7368 2822 6322  sh_b"), hash("c"
+00010110: 292e 616c 6961 7328 2268 6173 685f 6322  ).alias("hash_c"
+00010120: 292c 2068 6173 6828 2264 2229 2e61 6c69  ), hash("d").ali
+00010130: 6173 2822 6861 7368 5f64 2229 292e 636f  as("hash_d")).co
+00010140: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00010150: 5b52 6f77 2848 4153 485f 413d 3135 3939  [Row(HASH_A=1599
+00010160: 3632 3737 3036 3832 3239 3633 3036 382c  627706822963068,
+00010170: 2048 4153 485f 423d 3336 3232 3439 3439   HASH_B=36224949
+00010180: 3830 3434 3031 3038 3938 342c 2048 4153  80440108984, HAS
+00010190: 485f 433d 3135 3939 3632 3737 3036 3832  H_C=159962770682
+000101a0: 3239 3633 3036 382c 2048 4153 485f 443d  2963068, HASH_D=
+000101b0: 3135 3939 3632 3737 3036 3832 3239 3633  1599627706822963
+000101c0: 3036 3829 5d0a 2020 2020 2020 2020 3e3e  068)].        >>
+000101d0: 3e20 6466 2e73 656c 6563 7428 6861 7368  > df.select(hash
+000101e0: 286c 6974 284e 6f6e 6529 292e 616c 6961  (lit(None)).alia
+000101f0: 7328 226f 6e65 2229 2c20 6861 7368 286c  s("one"), hash(l
+00010200: 6974 284e 6f6e 6529 2c20 6c69 7428 4e6f  it(None), lit(No
+00010210: 6e65 2929 2e61 6c69 6173 2822 7477 6f22  ne)).alias("two"
+00010220: 292c 2068 6173 6828 6c69 7428 4e6f 6e65  ), hash(lit(None
+00010230: 292c 206c 6974 284e 6f6e 6529 2c20 6c69  ), lit(None), li
+00010240: 7428 4e6f 6e65 2929 2e61 6c69 6173 2822  t(None)).alias("
+00010250: 7468 7265 6522 2929 2e63 6f6c 6c65 6374  three")).collect
+00010260: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00010270: 4f4e 453d 3838 3137 3937 3537 3032 3339  ONE=881797570239
+00010280: 3336 3139 3336 382c 2054 574f 3d39 3533  3619368, TWO=953
+00010290: 3936 3332 3538 3335 3131 3034 3136 302c  963258351104160,
+000102a0: 2054 4852 4545 3d32 3934 3139 3438 3336   THREE=294194836
+000102b0: 3338 3435 3638 3434 3132 295d 0a20 2020  3845684412)].   
+000102c0: 2022 2222 0a20 2020 2063 6f6c 756d 6e73   """.    columns
+000102d0: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
+000102e0: 7472 2863 2c20 2268 6173 6822 2920 666f  tr(c, "hash") fo
+000102f0: 7220 6320 696e 2063 6f6c 735d 0a20 2020  r c in cols].   
+00010300: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00010310: 2268 6173 6822 2928 636f 6c75 6d6e 7329  "hash")(columns)
+00010320: 0a0a 0a64 6566 2061 7363 6969 2865 3a20  ...def ascii(e: 
+00010330: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00010340: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00010350: 5265 7475 726e 7320 7468 6520 4153 4349  Returns the ASCI
+00010360: 4920 636f 6465 2066 6f72 2074 6865 2066  I code for the f
+00010370: 6972 7374 2063 6861 7261 6374 6572 206f  irst character o
+00010380: 6620 6120 7374 7269 6e67 2e20 4966 2074  f a string. If t
+00010390: 6865 2073 7472 696e 6720 6973 2065 6d70  he string is emp
+000103a0: 7479 2c0a 2020 2020 6120 7661 6c75 6520  ty,.    a value 
+000103b0: 6f66 2030 2069 7320 7265 7475 726e 6564  of 0 is returned
+000103c0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000103d0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+000103e0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+000103f0: 655f 6461 7461 6672 616d 6528 5b27 2127  e_dataframe(['!'
+00010400: 2c20 2741 272c 2027 6127 2c20 2727 2c20  , 'A', 'a', '', 
+00010410: 2762 6364 272c 204e 6f6e 655d 2c20 7363  'bcd', None], sc
+00010420: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
+00010430: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00010440: 7428 6466 2e61 2c20 6173 6369 6928 6466  t(df.a, ascii(df
+00010450: 2e61 292e 6173 5f28 2761 7363 6969 2729  .a).as_('ascii')
+00010460: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00010470: 2020 2020 5b52 6f77 2841 3d27 2127 2c20      [Row(A='!', 
+00010480: 4153 4349 493d 3333 292c 2052 6f77 2841  ASCII=33), Row(A
+00010490: 3d27 4127 2c20 4153 4349 493d 3635 292c  ='A', ASCII=65),
+000104a0: 2052 6f77 2841 3d27 6127 2c20 4153 4349   Row(A='a', ASCI
+000104b0: 493d 3937 292c 2052 6f77 2841 3d27 272c  I=97), Row(A='',
+000104c0: 2041 5343 4949 3d30 292c 2052 6f77 2841   ASCII=0), Row(A
+000104d0: 3d27 6263 6427 2c20 4153 4349 493d 3938  ='bcd', ASCII=98
+000104e0: 292c 2052 6f77 2841 3d4e 6f6e 652c 2041  ), Row(A=None, A
+000104f0: 5343 4949 3d4e 6f6e 6529 5d0a 2020 2020  SCII=None)].    
+00010500: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00010510: 636f 6c5f 6966 5f73 7472 2865 2c20 2261  col_if_str(e, "a
+00010520: 7363 6969 2229 0a20 2020 2072 6574 7572  scii").    retur
+00010530: 6e20 6275 696c 7469 6e28 2261 7363 6969  n builtin("ascii
+00010540: 2229 2863 290a 0a0a 6465 6620 696e 6974  ")(c)...def init
+00010550: 6361 7028 653a 2043 6f6c 756d 6e4f 724e  cap(e: ColumnOrN
+00010560: 616d 652c 2064 656c 696d 6974 6572 733a  ame, delimiters:
+00010570: 2043 6f6c 756d 6e4f 724e 616d 6520 3d20   ColumnOrName = 
+00010580: 4e6f 6e65 2920 2d3e 2043 6f6c 756d 6e3a  None) -> Column:
+00010590: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+000105a0: 7572 6e73 2074 6865 2069 6e70 7574 2073  urns the input s
+000105b0: 7472 696e 6720 7769 7468 2074 6865 2066  tring with the f
+000105c0: 6972 7374 206c 6574 7465 7220 6f66 2065  irst letter of e
+000105d0: 6163 6820 776f 7264 2069 6e20 7570 7065  ach word in uppe
+000105e0: 7263 6173 650a 2020 2020 616e 6420 7468  rcase.    and th
+000105f0: 6520 7375 6273 6571 7565 6e74 206c 6574  e subsequent let
+00010600: 7465 7273 2069 6e20 6c6f 7765 7263 6173  ters in lowercas
+00010610: 652e 0a0a 2020 2020 6060 6465 6c69 6d69  e...    ``delimi
+00010620: 7465 7273 6060 2069 7320 616e 206f 7074  ters`` is an opt
+00010630: 696f 6e61 6c20 6172 6775 6d65 6e74 2073  ional argument s
+00010640: 7065 6369 6679 696e 6720 6120 7374 7269  pecifying a stri
+00010650: 6e67 206f 6620 6f6e 6520 6f72 206d 6f72  ng of one or mor
+00010660: 650a 2020 2020 6368 6172 6163 7465 7273  e.    characters
+00010670: 2074 6861 7420 6060 696e 6974 6361 7060   that ``initcap`
+00010680: 6020 7573 6573 2061 7320 7365 7061 7261  ` uses as separa
+00010690: 746f 7273 2066 6f72 2077 6f72 6473 2069  tors for words i
+000106a0: 6e20 7468 6520 696e 7075 7420 6578 7072  n the input expr
+000106b0: 6573 7369 6f6e 2e0a 0a20 2020 2049 6620  ession...    If 
+000106c0: 6060 6465 6c69 6d69 7465 7273 6060 2069  ``delimiters`` i
+000106d0: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
+000106e0: 2061 6e79 206f 6620 7468 6520 666f 6c6c   any of the foll
+000106f0: 6f77 696e 6720 6368 6172 6163 7465 7273  owing characters
+00010700: 2069 6e20 7468 650a 2020 2020 696e 7075   in the.    inpu
+00010710: 7420 6578 7072 6573 7369 6f6e 7320 6172  t expressions ar
+00010720: 6520 7472 6561 7465 6420 6173 2077 6f72  e treated as wor
+00010730: 6420 7365 7061 7261 746f 7273 3a0a 0a20  d separators:.. 
+00010740: 2020 2020 2020 2060 603c 7768 6974 6573         ``<whites
+00010750: 7061 6365 3e20 2120 3f20 4020 2220 5e20  pace> ! ? @ " ^ 
+00010760: 2320 2420 2620 7e20 5f20 2c20 2e20 3a20  # $ & ~ _ , . : 
+00010770: 3b20 2b20 2d20 2a20 2520 2f20 7c20 5c5c  ; + - * % / | \\
+00010780: 205b 205d 2028 2029 207b 207d 203c 203e   [ ] ( ) { } < >
+00010790: 6060 0a0a 2020 2020 4578 616d 706c 6573  ``..    Examples
+000107a0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+000107b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+000107c0: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
+000107d0: 7468 6520 736b 7920 6973 2062 6c75 6522  the sky is blue"
+000107e0: 2c20 2257 4520 4341 4e20 4841 4e44 4c45  , "WE CAN HANDLE
+000107f0: 2054 4849 5322 2c20 22c3 84c3 a4c3 96c3   THIS", ".......
+00010800: b6c3 9fc3 9cc3 bc22 2c20 4e6f 6e65 5d2c  .......", None],
+00010810: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00010820: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00010830: 6c65 6374 2869 6e69 7463 6170 2864 665b  lect(initcap(df[
+00010840: 2261 225d 292e 616c 6961 7328 2269 6e69  "a"]).alias("ini
+00010850: 7463 6170 2229 292e 636f 6c6c 6563 7428  tcap")).collect(
+00010860: 290a 2020 2020 2020 2020 5b52 6f77 2849  ).        [Row(I
+00010870: 4e49 5443 4150 3d27 5468 6520 536b 7920  NITCAP='The Sky 
+00010880: 4973 2042 6c75 6527 292c 2052 6f77 2849  Is Blue'), Row(I
+00010890: 4e49 5443 4150 3d27 5765 2043 616e 2048  NITCAP='We Can H
+000108a0: 616e 646c 6520 5468 6973 2729 2c20 526f  andle This'), Ro
+000108b0: 7728 494e 4954 4341 503d 27c3 84c3 a4c3  w(INITCAP='.....
+000108c0: b6c3 b6c3 9fc3 bcc3 bc27 292c 2052 6f77  .........'), Row
+000108d0: 2849 4e49 5443 4150 3d4e 6f6e 6529 5d0a  (INITCAP=None)].
+000108e0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+000108f0: 656c 6563 7428 696e 6974 6361 7028 6466  elect(initcap(df
+00010900: 5b22 6122 5d2c 206c 6974 2827 2729 292e  ["a"], lit('')).
+00010910: 616c 6961 7328 2269 6e69 7463 6170 2229  alias("initcap")
+00010920: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00010930: 2020 2020 5b52 6f77 2849 4e49 5443 4150      [Row(INITCAP
+00010940: 3d27 5468 6520 736b 7920 6973 2062 6c75  ='The sky is blu
+00010950: 6527 292c 2052 6f77 2849 4e49 5443 4150  e'), Row(INITCAP
+00010960: 3d27 5765 2063 616e 2068 616e 646c 6520  ='We can handle 
+00010970: 7468 6973 2729 2c20 526f 7728 494e 4954  this'), Row(INIT
+00010980: 4341 503d 27c3 84c3 a4c3 b6c3 b6c3 9fc3  CAP='...........
+00010990: bcc3 bc27 292c 2052 6f77 2849 4e49 5443  ...'), Row(INITC
+000109a0: 4150 3d4e 6f6e 6529 5d0a 2020 2020 2222  AP=None)].    ""
+000109b0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+000109c0: 6c5f 6966 5f73 7472 2865 2c20 2269 6e69  l_if_str(e, "ini
+000109d0: 7463 6170 2229 0a20 2020 2069 6620 6465  tcap").    if de
+000109e0: 6c69 6d69 7465 7273 2069 7320 4e6f 6e65  limiters is None
+000109f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00010a00: 2062 7569 6c74 696e 2822 696e 6974 6361   builtin("initca
+00010a10: 7022 2928 6329 0a20 2020 2064 656c 696d  p")(c).    delim
+00010a20: 6974 6572 5f63 6f6c 203d 205f 746f 5f63  iter_col = _to_c
+00010a30: 6f6c 5f69 665f 7374 7228 6465 6c69 6d69  ol_if_str(delimi
+00010a40: 7465 7273 2c20 2269 6e69 7463 6170 2229  ters, "initcap")
+00010a50: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00010a60: 7469 6e28 2269 6e69 7463 6170 2229 2863  tin("initcap")(c
+00010a70: 2c20 6465 6c69 6d69 7465 725f 636f 6c29  , delimiter_col)
+00010a80: 0a0a 0a64 6566 206c 656e 6774 6828 653a  ...def length(e:
+00010a90: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00010aa0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00010ab0: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
+00010ac0: 6520 6c65 6e67 7468 206f 6620 616e 2069  e length of an i
+00010ad0: 6e70 7574 2073 7472 696e 6720 6f72 2062  nput string or b
+00010ae0: 696e 6172 7920 7661 6c75 652e 2046 6f72  inary value. For
+00010af0: 2073 7472 696e 6773 2c0a 2020 2020 7468   strings,.    th
+00010b00: 6520 6c65 6e67 7468 2069 7320 7468 6520  e length is the 
+00010b10: 6e75 6d62 6572 206f 6620 6368 6172 6163  number of charac
+00010b20: 7465 7273 2c20 616e 6420 5554 462d 3820  ters, and UTF-8 
+00010b30: 6368 6172 6163 7465 7273 2061 7265 2063  characters are c
+00010b40: 6f75 6e74 6564 2061 7320 610a 2020 2020  ounted as a.    
+00010b50: 7369 6e67 6c65 2063 6861 7261 6374 6572  single character
+00010b60: 2e20 466f 7220 6269 6e61 7279 2c20 7468  . For binary, th
+00010b70: 6520 6c65 6e67 7468 2069 7320 7468 6520  e length is the 
+00010b80: 6e75 6d62 6572 206f 6620 6279 7465 732e  number of bytes.
+00010b90: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00010ba0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00010bb0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00010bc0: 5f64 6174 6166 7261 6d65 285b 2274 6865  _dataframe(["the
+00010bd0: 2073 6b79 2069 7320 626c 7565 222c 2022   sky is blue", "
+00010be0: 5745 2043 414e 2048 414e 444c 4520 5448  WE CAN HANDLE TH
+00010bf0: 4953 222c 2022 c384 c3a4 c396 c3b6 c39f  IS", "..........
+00010c00: c39c c3bc 222c 204e 6f6e 655d 2c20 7363  ....", None], sc
+00010c10: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00010c20: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00010c30: 7428 6c65 6e67 7468 2864 665b 2261 225d  t(length(df["a"]
+00010c40: 292e 616c 6961 7328 226c 656e 6774 6822  ).alias("length"
+00010c50: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00010c60: 2020 2020 205b 526f 7728 4c45 4e47 5448       [Row(LENGTH
+00010c70: 3d31 3529 2c20 526f 7728 4c45 4e47 5448  =15), Row(LENGTH
+00010c80: 3d31 3829 2c20 526f 7728 4c45 4e47 5448  =18), Row(LENGTH
+00010c90: 3d37 292c 2052 6f77 284c 454e 4754 483d  =7), Row(LENGTH=
+00010ca0: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
+00010cb0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00010cc0: 665f 7374 7228 652c 2022 6c65 6e67 7468  f_str(e, "length
+00010cd0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00010ce0: 696c 7469 6e28 226c 656e 6774 6822 2928  iltin("length")(
+00010cf0: 6329 0a0a 0a64 6566 206c 6f77 6572 2865  c)...def lower(e
+00010d00: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00010d10: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00010d20: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+00010d30: 6865 2069 6e70 7574 2073 7472 696e 6720  he input string 
+00010d40: 7769 7468 2061 6c6c 2063 6861 7261 6374  with all charact
+00010d50: 6572 7320 636f 6e76 6572 7465 6420 746f  ers converted to
+00010d60: 206c 6f77 6572 6361 7365 2e0a 0a20 2020   lowercase...   
+00010d70: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00010d80: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00010d90: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00010da0: 6672 616d 6528 5b27 6162 6327 2c20 2741  frame(['abc', 'A
+00010db0: 6263 272c 2027 6142 4327 2c20 2741 6e66  bc', 'aBC', 'Anf
+00010dc0: c3bc 6872 756e 6773 7a65 6963 6865 6e27  ..hrungszeichen'
+00010dd0: 2c20 2731 342e 3935 20e2 82ac 275d 2c20  , '14.95 ...'], 
+00010de0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00010df0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00010e00: 6563 7428 6c6f 7765 7228 636f 6c28 2261  ect(lower(col("a
+00010e10: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+00010e20: 2020 2020 2020 205b 526f 7728 4c4f 5745         [Row(LOWE
+00010e30: 5228 2241 2229 3d27 6162 6327 292c 2052  R("A")='abc'), R
+00010e40: 6f77 284c 4f57 4552 2822 4122 293d 2761  ow(LOWER("A")='a
+00010e50: 6263 2729 2c20 526f 7728 4c4f 5745 5228  bc'), Row(LOWER(
+00010e60: 2241 2229 3d27 6162 6327 292c 2052 6f77  "A")='abc'), Row
+00010e70: 284c 4f57 4552 2822 4122 293d 2761 6e66  (LOWER("A")='anf
+00010e80: c3bc 6872 756e 6773 7a65 6963 6865 6e27  ..hrungszeichen'
+00010e90: 292c 2052 6f77 284c 4f57 4552 2822 4122  ), Row(LOWER("A"
+00010ea0: 293d 2731 342e 3935 20e2 82ac 2729 5d0a  )='14.95 ...')].
+00010eb0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00010ec0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+00010ed0: 2c20 226c 6f77 6572 2229 0a20 2020 2072  , "lower").    r
+00010ee0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
+00010ef0: 6f77 6572 2229 2863 290a 0a0a 6465 6620  ower")(c)...def 
+00010f00: 6c70 6164 2865 3a20 436f 6c75 6d6e 4f72  lpad(e: ColumnOr
+00010f10: 4e61 6d65 2c20 6c65 6e3a 2055 6e69 6f6e  Name, len: Union
+00010f20: 5b43 6f6c 756d 6e2c 2069 6e74 5d2c 2070  [Column, int], p
+00010f30: 6164 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ad: ColumnOrName
+00010f40: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00010f50: 2022 2222 0a20 2020 204c 6566 742d 7061   """.    Left-pa
+00010f60: 6473 2061 2073 7472 696e 6720 7769 7468  ds a string with
+00010f70: 2063 6861 7261 6374 6572 7320 6672 6f6d   characters from
+00010f80: 2061 6e6f 7468 6572 2073 7472 696e 672c   another string,
+00010f90: 206f 7220 6c65 6674 2d70 6164 7320 610a   or left-pads a.
+00010fa0: 2020 2020 6269 6e61 7279 2076 616c 7565      binary value
+00010fb0: 2077 6974 6820 6279 7465 7320 6672 6f6d   with bytes from
+00010fc0: 2061 6e6f 7468 6572 2062 696e 6172 7920   another binary 
+00010fd0: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
+00010fe0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00010ff0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+00011000: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
+00011010: 696f 6e73 2069 6d70 6f72 7420 6c69 740a  ions import lit.
+00011020: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00011030: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00011040: 6461 7461 6672 616d 6528 5b5b 2261 225d  dataframe([["a"]
+00011050: 2c20 5b22 6222 5d2c 205b 2263 225d 5d2c  , ["b"], ["c"]],
+00011060: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00011070: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00011080: 6c65 6374 286c 7061 6428 636f 6c28 2261  lect(lpad(col("a
+00011090: 2229 2c20 332c 206c 6974 2822 6b22 2929  "), 3, lit("k"))
+000110a0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+000110b0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+000110c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+000110d0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+000110e0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000110f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00011100: 7c6b 6b61 2020 2020 2020 207c 0a20 2020  |kka       |.   
+00011110: 2020 2020 207c 6b6b 6220 2020 2020 2020       |kkb       
+00011120: 7c0a 2020 2020 2020 2020 7c6b 6b63 2020  |.        |kkc  
+00011130: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00011140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00011150: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00011160: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00011170: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+00011180: 2c20 226c 7061 6422 290a 2020 2020 7020  , "lpad").    p 
+00011190: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000111a0: 2870 6164 2c20 226c 7061 6422 290a 2020  (pad, "lpad").  
+000111b0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000111c0: 2822 6c70 6164 2229 2863 2c20 6c69 7428  ("lpad")(c, lit(
+000111d0: 6c65 6e29 2c20 7029 0a0a 0a64 6566 206c  len), p)...def l
+000111e0: 7472 696d 2865 3a20 436f 6c75 6d6e 4f72  trim(e: ColumnOr
+000111f0: 4e61 6d65 2c20 7472 696d 5f73 7472 696e  Name, trim_strin
+00011200: 673a 204f 7074 696f 6e61 6c5b 436f 6c75  g: Optional[Colu
+00011210: 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f 6e65  mnOrName] = None
+00011220: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00011230: 2022 2222 0a20 2020 2052 656d 6f76 6573   """.    Removes
+00011240: 206c 6561 6469 6e67 2063 6861 7261 6374   leading charact
+00011250: 6572 732c 2069 6e63 6c75 6469 6e67 2077  ers, including w
+00011260: 6869 7465 7370 6163 652c 2066 726f 6d20  hitespace, from 
+00011270: 6120 7374 7269 6e67 2e0a 0a20 2020 2045  a string...    E
+00011280: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00011290: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+000112a0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+000112b0: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
+000112c0: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
+000112d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000112e0: 7465 5f64 6174 6166 7261 6d65 285b 5b22  te_dataframe([["
+000112f0: 6173 7373 225d 2c20 5b22 6273 7373 225d  asss"], ["bsss"]
+00011300: 2c20 5b22 6373 7373 225d 5d2c 2073 6368  , ["csss"]], sch
+00011310: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00011320: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00011330: 2872 7472 696d 2863 6f6c 2822 6122 292c  (rtrim(col("a"),
+00011340: 2074 7269 6d5f 7374 7269 6e67 3d6c 6974   trim_string=lit
+00011350: 2822 7373 7322 2929 2e61 6c69 6173 2822  ("sss")).alias("
+00011360: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00011370: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00011380: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00011390: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+000113a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000113b0: 2020 2020 2020 2020 7c61 2020 2020 2020          |a      
+000113c0: 2020 207c 0a20 2020 2020 2020 207c 6220     |.        |b 
+000113d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000113e0: 2020 7c63 2020 2020 2020 2020 207c 0a20    |c         |. 
+000113f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00011400: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00011410: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00011420: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00011430: 6966 5f73 7472 2865 2c20 226c 7472 696d  if_str(e, "ltrim
+00011440: 2229 0a20 2020 2074 203d 205f 746f 5f63  ").    t = _to_c
+00011450: 6f6c 5f69 665f 7374 7228 7472 696d 5f73  ol_if_str(trim_s
+00011460: 7472 696e 672c 2022 6c74 7269 6d22 2920  tring, "ltrim") 
+00011470: 6966 2074 7269 6d5f 7374 7269 6e67 2069  if trim_string i
+00011480: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+00011490: 4e6f 6e65 0a20 2020 2072 6574 7572 6e20  None.    return 
+000114a0: 6275 696c 7469 6e28 226c 7472 696d 2229  builtin("ltrim")
+000114b0: 2863 2c20 7429 2069 6620 7420 6973 206e  (c, t) if t is n
+000114c0: 6f74 204e 6f6e 6520 656c 7365 2062 7569  ot None else bui
+000114d0: 6c74 696e 2822 6c74 7269 6d22 2928 6329  ltin("ltrim")(c)
+000114e0: 0a0a 0a64 6566 2072 7061 6428 653a 2043  ...def rpad(e: C
+000114f0: 6f6c 756d 6e4f 724e 616d 652c 206c 656e  olumnOrName, len
+00011500: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
+00011510: 696e 745d 2c20 7061 643a 2043 6f6c 756d  int], pad: Colum
+00011520: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00011530: 6d6e 3a0a 2020 2020 2222 2252 6967 6874  mn:.    """Right
+00011540: 2d70 6164 7320 6120 7374 7269 6e67 2077  -pads a string w
+00011550: 6974 6820 6368 6172 6163 7465 7273 2066  ith characters f
+00011560: 726f 6d20 616e 6f74 6865 7220 7374 7269  rom another stri
+00011570: 6e67 2c20 6f72 2072 6967 6874 2d70 6164  ng, or right-pad
+00011580: 7320 610a 2020 2020 6269 6e61 7279 2076  s a.    binary v
+00011590: 616c 7565 2077 6974 6820 6279 7465 7320  alue with bytes 
+000115a0: 6672 6f6d 2061 6e6f 7468 6572 2062 696e  from another bin
+000115b0: 6172 7920 7661 6c75 652e 2057 6865 6e20  ary value. When 
+000115c0: 6361 6c6c 6564 2c20 6065 6020 6973 2070  called, `e` is p
+000115d0: 6164 6465 6420 746f 206c 656e 6774 6820  added to length 
+000115e0: 606c 656e 600a 2020 2020 7769 7468 2063  `len`.    with c
+000115f0: 6861 7261 6374 6572 732f 6279 7465 7320  haracters/bytes 
+00011600: 6672 6f6d 2060 7061 6460 2e0a 0a20 2020  from `pad`...   
+00011610: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00011620: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00011630: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00011640: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+00011650: 206c 6974 0a20 2020 2020 2020 203e 3e3e   lit.        >>>
+00011660: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00011670: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00011680: 5b22 6122 5d2c 205b 2262 225d 2c20 5b22  ["a"], ["b"], ["
+00011690: 6322 5d5d 2c20 7363 6865 6d61 3d5b 2261  c"]], schema=["a
+000116a0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000116b0: 6466 2e73 656c 6563 7428 7270 6164 2863  df.select(rpad(c
+000116c0: 6f6c 2822 6122 292c 2033 2c20 6c69 7428  ol("a"), 3, lit(
+000116d0: 226b 2229 292e 616c 6961 7328 2272 6573  "k")).alias("res
+000116e0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+000116f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00011700: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00011710: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00011720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00011730: 2020 2020 207c 616b 6b20 2020 2020 2020       |akk       
+00011740: 7c0a 2020 2020 2020 2020 7c62 6b6b 2020  |.        |bkk  
+00011750: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00011760: 636b 6b20 2020 2020 2020 7c0a 2020 2020  ckk       |.    
+00011770: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00011780: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00011790: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+000117a0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+000117b0: 7374 7228 652c 2022 7270 6164 2229 0a20  str(e, "rpad"). 
+000117c0: 2020 2070 203d 205f 746f 5f63 6f6c 5f69     p = _to_col_i
+000117d0: 665f 7374 7228 7061 642c 2022 7270 6164  f_str(pad, "rpad
+000117e0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+000117f0: 696c 7469 6e28 2272 7061 6422 2928 632c  iltin("rpad")(c,
+00011800: 206c 6974 286c 656e 292c 2070 290a 0a0a   lit(len), p)...
+00011810: 6465 6620 7274 7269 6d28 653a 2043 6f6c  def rtrim(e: Col
+00011820: 756d 6e4f 724e 616d 652c 2074 7269 6d5f  umnOrName, trim_
+00011830: 7374 7269 6e67 3a20 4f70 7469 6f6e 616c  string: Optional
+00011840: 5b43 6f6c 756d 6e4f 724e 616d 655d 203d  [ColumnOrName] =
+00011850: 204e 6f6e 6529 202d 3e20 436f 6c75 6d6e   None) -> Column
+00011860: 3a0a 2020 2020 2222 2252 656d 6f76 6573  :.    """Removes
+00011870: 2074 7261 696c 696e 6720 6368 6172 6163   trailing charac
+00011880: 7465 7273 2c20 696e 636c 7564 696e 6720  ters, including 
+00011890: 7768 6974 6573 7061 6365 2c20 6672 6f6d  whitespace, from
+000118a0: 2061 2073 7472 696e 672e 0a0a 2020 2020   a string...    
+000118b0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000118c0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+000118d0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+000118e0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+000118f0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
+00011900: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00011910: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
+00011920: 2261 7373 7322 5d2c 205b 2262 7373 7322  "asss"], ["bsss"
+00011930: 5d2c 205b 2263 7373 7322 5d5d 2c20 7363  ], ["csss"]], sc
+00011940: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00011950: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00011960: 7428 7274 7269 6d28 636f 6c28 2261 2229  t(rtrim(col("a")
+00011970: 2c20 7472 696d 5f73 7472 696e 673d 6c69  , trim_string=li
+00011980: 7428 2273 7373 2229 292e 616c 6961 7328  t("sss")).alias(
+00011990: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+000119a0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+000119b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+000119c0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+000119d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000119e0: 0a20 2020 2020 2020 207c 6120 2020 2020  .        |a     
+000119f0: 2020 2020 7c0a 2020 2020 2020 2020 7c62      |.        |b
+00011a00: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00011a10: 2020 207c 6320 2020 2020 2020 2020 7c0a     |c         |.
+00011a20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00011a30: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00011a40: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00011a50: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00011a60: 5f69 665f 7374 7228 652c 2022 7274 7269  _if_str(e, "rtri
+00011a70: 6d22 290a 2020 2020 7420 3d20 5f74 6f5f  m").    t = _to_
+00011a80: 636f 6c5f 6966 5f73 7472 2874 7269 6d5f  col_if_str(trim_
+00011a90: 7374 7269 6e67 2c20 2272 7472 696d 2229  string, "rtrim")
+00011aa0: 2069 6620 7472 696d 5f73 7472 696e 6720   if trim_string 
+00011ab0: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+00011ac0: 204e 6f6e 650a 2020 2020 7265 7475 726e   None.    return
+00011ad0: 2062 7569 6c74 696e 2822 7274 7269 6d22   builtin("rtrim"
+00011ae0: 2928 632c 2074 2920 6966 2074 2069 7320  )(c, t) if t is 
+00011af0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 6275  not None else bu
+00011b00: 696c 7469 6e28 2272 7472 696d 2229 2863  iltin("rtrim")(c
+00011b10: 290a 0a0a 6465 6620 7265 7065 6174 2873  )...def repeat(s
+00011b20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+00011b30: 6e3a 2055 6e69 6f6e 5b43 6f6c 756d 6e2c  n: Union[Column,
+00011b40: 2069 6e74 5d29 202d 3e20 436f 6c75 6d6e   int]) -> Column
+00011b50: 3a0a 2020 2020 2222 2242 7569 6c64 7320  :.    """Builds 
+00011b60: 6120 7374 7269 6e67 2062 7920 7265 7065  a string by repe
+00011b70: 6174 696e 6720 7468 6520 696e 7075 7420  ating the input 
+00011b80: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
+00011b90: 6420 6e75 6d62 6572 206f 6620 7469 6d65  d number of time
+00011ba0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+00011bb0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00011bc0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00011bd0: 7465 5f64 6174 6166 7261 6d65 285b 5b22  te_dataframe([["
+00011be0: 6122 5d2c 205b 2262 225d 2c20 5b22 6322  a"], ["b"], ["c"
+00011bf0: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
+00011c00: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00011c10: 2e73 656c 6563 7428 7265 7065 6174 2863  .select(repeat(c
+00011c20: 6f6c 2822 6122 292c 2033 292e 616c 6961  ol("a"), 3).alia
+00011c30: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00011c40: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00011c50: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00011c60: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00011c70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00011c80: 2d2d 0a20 2020 2020 2020 207c 6161 6120  --.        |aaa 
+00011c90: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00011ca0: 7c62 6262 2020 2020 2020 207c 0a20 2020  |bbb       |.   
+00011cb0: 2020 2020 207c 6363 6320 2020 2020 2020       |ccc       
+00011cc0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00011cd0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00011ce0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00011cf0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00011d00: 6f6c 5f69 665f 7374 7228 732c 2022 7265  ol_if_str(s, "re
+00011d10: 7065 6174 2229 0a20 2020 2072 6574 7572  peat").    retur
+00011d20: 6e20 6275 696c 7469 6e28 2272 6570 6561  n builtin("repea
+00011d30: 7422 2928 632c 206c 6974 286e 2929 0a0a  t")(c, lit(n))..
+00011d40: 0a64 6566 2072 6576 6572 7365 2863 6f6c  .def reverse(col
+00011d50: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00011d60: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00011d70: 2222 5265 7665 7273 6573 2074 6865 206f  ""Reverses the o
+00011d80: 7264 6572 206f 6620 6368 6172 6163 7465  rder of characte
+00011d90: 7273 2069 6e20 6120 7374 7269 6e67 2c20  rs in a string, 
+00011da0: 6f72 206f 6620 6279 7465 7320 696e 2061  or of bytes in a
+00011db0: 2062 696e 6172 7920 7661 6c75 652e 0a0a   binary value...
+00011dc0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00011dd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00011de0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00011df0: 6174 6166 7261 6d65 285b 5b22 4865 6c6c  ataframe([["Hell
+00011e00: 6f22 5d2c 205b 2261 6263 225d 5d2c 2073  o"], ["abc"]], s
+00011e10: 6368 656d 613d 5b22 636f 6c31 225d 290a  chema=["col1"]).
+00011e20: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00011e30: 656c 6563 7428 7265 7665 7273 6528 636f  elect(reverse(co
+00011e40: 6c28 2263 6f6c 3122 2929 292e 7368 6f77  l("col1"))).show
+00011e50: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00011e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00011e70: 2d2d 0a20 2020 2020 2020 207c 2252 4556  --.        |"REV
+00011e80: 4552 5345 2822 2243 4f4c 3122 2229 2220  ERSE(""COL1"")" 
+00011e90: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00011ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00011eb0: 2d2d 0a20 2020 2020 2020 207c 6f6c 6c65  --.        |olle
+00011ec0: 4820 2020 2020 2020 2020 2020 2020 2020  H               
+00011ed0: 207c 0a20 2020 2020 2020 207c 6362 6120   |.        |cba 
+00011ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ef0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00011f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00011f10: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00011f20: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00011f30: 2020 2063 6f6c 203d 205f 746f 5f63 6f6c     col = _to_col
+00011f40: 5f69 665f 7374 7228 636f 6c2c 2022 7265  _if_str(col, "re
+00011f50: 7665 7273 6522 290a 2020 2020 7265 7475  verse").    retu
+00011f60: 726e 2062 7569 6c74 696e 2822 7265 7665  rn builtin("reve
+00011f70: 7273 6522 2928 636f 6c29 0a0a 0a64 6566  rse")(col)...def
+00011f80: 2073 6f75 6e64 6578 2865 3a20 436f 6c75   soundex(e: Colu
+00011f90: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00011fa0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00011fb0: 726e 7320 6120 7374 7269 6e67 2074 6861  rns a string tha
+00011fc0: 7420 636f 6e74 6169 6e73 2061 2070 686f  t contains a pho
+00011fd0: 6e65 7469 6320 7265 7072 6573 656e 7461  netic representa
+00011fe0: 7469 6f6e 206f 6620 7468 6520 696e 7075  tion of the inpu
+00011ff0: 7420 7374 7269 6e67 2e0a 0a20 2020 2045  t string...    E
+00012000: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00012010: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00012020: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00012030: 6d65 285b 224d 6172 7368 6122 2c20 224d  me(["Marsha", "M
+00012040: 6172 6369 6122 5d2c 2073 6368 656d 613d  arcia"], schema=
+00012050: 5b22 5622 5d29 2e73 656c 6563 7428 736f  ["V"]).select(so
+00012060: 756e 6465 7828 636f 6c28 2256 2229 2929  undex(col("V")))
+00012070: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00012080: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00012090: 2020 5b52 6f77 2853 4f55 4e44 4558 2822    [Row(SOUNDEX("
+000120a0: 5622 293d 274d 3632 3027 292c 2052 6f77  V")='M620'), Row
+000120b0: 2853 4f55 4e44 4558 2822 5622 293d 274d  (SOUNDEX("V")='M
+000120c0: 3632 3027 295d 0a20 2020 2022 2222 0a20  620')].    """. 
+000120d0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+000120e0: 665f 7374 7228 652c 2022 736f 756e 6465  f_str(e, "sounde
+000120f0: 7822 290a 2020 2020 7265 7475 726e 2062  x").    return b
+00012100: 7569 6c74 696e 2822 736f 756e 6465 7822  uiltin("soundex"
+00012110: 2928 6329 0a0a 0a64 6566 2074 7269 6d28  )(c)...def trim(
+00012120: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
+00012130: 2074 7269 6d5f 7374 7269 6e67 3a20 4f70   trim_string: Op
+00012140: 7469 6f6e 616c 5b43 6f6c 756d 6e4f 724e  tional[ColumnOrN
+00012150: 616d 655d 203d 204e 6f6e 6529 202d 3e20  ame] = None) -> 
+00012160: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00012170: 656d 6f76 6573 206c 6561 6469 6e67 2061  emoves leading a
+00012180: 6e64 2074 7261 696c 696e 6720 6368 6172  nd trailing char
+00012190: 6163 7465 7273 2066 726f 6d20 6120 7374  acters from a st
+000121a0: 7269 6e67 2e20 5065 7220 6465 6661 756c  ring. Per defaul
+000121b0: 7420 6f6e 6c79 2077 6869 7465 7370 6163  t only whitespac
+000121c0: 6520 2720 2720 6368 6172 6163 7465 7273  e ' ' characters
+000121d0: 2061 7265 2072 656d 6f76 6564 2e0a 0a20   are removed... 
+000121e0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+000121f0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00012200: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00012210: 7461 6672 616d 6528 5b27 6865 6c6c 6f27  taframe(['hello'
+00012220: 2c20 2720 776f 726c 6427 2c20 2720 2020  , ' world', '   
+00012230: 2120 2020 275d 2c20 7363 6865 6d61 3d5b  !   '], schema=[
+00012240: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00012250: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
+00012260: 2020 2020 2020 205b 526f 7728 413d 2768         [Row(A='h
+00012270: 656c 6c6f 2729 2c20 526f 7728 413d 2720  ello'), Row(A=' 
+00012280: 776f 726c 6427 292c 2052 6f77 2841 3d27  world'), Row(A='
+00012290: 2020 2021 2020 2027 295d 0a20 2020 2020     !   ')].     
+000122a0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000122b0: 2874 7269 6d28 636f 6c28 2261 2229 2929  (trim(col("a")))
+000122c0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000122d0: 2020 205b 526f 7728 5452 494d 2822 4122     [Row(TRIM("A"
+000122e0: 293d 2768 656c 6c6f 2729 2c20 526f 7728  )='hello'), Row(
+000122f0: 5452 494d 2822 4122 293d 2777 6f72 6c64  TRIM("A")='world
+00012300: 2729 2c20 526f 7728 5452 494d 2822 4122  '), Row(TRIM("A"
+00012310: 293d 2721 2729 5d0a 0a20 2020 2045 7861  )='!')]..    Exa
+00012320: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00012330: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00012340: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00012350: 6528 5b27 4555 5220 3132 2e39 3627 2c20  e(['EUR 12.96', 
+00012360: 2737 2e38 3955 5344 272c 2027 352e 3939  '7.89USD', '5.99
+00012370: 4527 5d2c 2073 6368 656d 613d 5b22 6122  E'], schema=["a"
+00012380: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00012390: 662e 7365 6c65 6374 2874 7269 6d28 636f  f.select(trim(co
+000123a0: 6c28 2261 2229 2c20 6c69 7428 2245 5552  l("a"), lit("EUR
+000123b0: 5553 4420 2229 292e 6173 5f28 2261 6e73  USD ")).as_("ans
+000123c0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+000123d0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
+000123e0: 3132 2e39 3627 292c 2052 6f77 2841 4e53  12.96'), Row(ANS
+000123f0: 3d27 372e 3839 2729 2c20 526f 7728 414e  ='7.89'), Row(AN
+00012400: 533d 2735 2e39 3927 295d 0a0a 2020 2020  S='5.99')]..    
+00012410: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00012420: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00012430: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00012440: 7261 6d65 285b 2761 6263 3132 2034 3561  rame(['abc12 45a
+00012450: 2037 3962 6321 275d 2c20 7363 6865 6d61   79bc!'], schema
+00012460: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00012470: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
+00012480: 696d 2863 6f6c 2822 6122 292c 206c 6974  im(col("a"), lit
+00012490: 2822 6162 6321 2229 292e 6173 5f28 2261  ("abc!")).as_("a
+000124a0: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
+000124b0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+000124c0: 3d27 3132 2034 3561 2037 3927 295d 0a0a  ='12 45a 79')]..
+000124d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+000124e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+000124f0: 2c20 2274 7269 6d22 290a 2020 2020 7420  , "trim").    t 
+00012500: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00012510: 2874 7269 6d5f 7374 7269 6e67 2c20 2274  (trim_string, "t
+00012520: 7269 6d22 2920 6966 2074 7269 6d5f 7374  rim") if trim_st
+00012530: 7269 6e67 2069 7320 6e6f 7420 4e6f 6e65  ring is not None
+00012540: 2065 6c73 6520 4e6f 6e65 0a20 2020 2072   else None.    r
+00012550: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+00012560: 7269 6d22 2928 632c 2074 2920 6966 2074  rim")(c, t) if t
+00012570: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+00012580: 6520 6275 696c 7469 6e28 2274 7269 6d22  e builtin("trim"
+00012590: 2928 6329 0a0a 0a64 6566 2075 7070 6572  )(c)...def upper
+000125a0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+000125b0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000125c0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+000125d0: 696e 7075 7420 7374 7269 6e67 2077 6974  input string wit
+000125e0: 6820 616c 6c20 6368 6172 6163 7465 7273  h all characters
+000125f0: 2063 6f6e 7665 7274 6564 2074 6f20 7570   converted to up
+00012600: 7065 7263 6173 652e 0a20 2020 2020 2020  percase..       
+00012610: 556e 6963 6f64 6520 6368 6172 6163 7465  Unicode characte
+00012620: 7273 2061 7265 2073 7570 706f 7274 6564  rs are supported
+00012630: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00012640: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00012650: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00012660: 655f 6461 7461 6672 616d 6528 5b27 6162  e_dataframe(['ab
+00012670: 6327 2c20 2741 6263 272c 2027 6142 4327  c', 'Abc', 'aBC'
+00012680: 2c20 2741 6e66 c3bc 6872 756e 6773 7a65  , 'Anf..hrungsze
+00012690: 6963 6865 6e27 2c20 2731 342e 3935 20e2  ichen', '14.95 .
+000126a0: 82ac 275d 2c20 7363 6865 6d61 3d5b 2261  ..'], schema=["a
+000126b0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000126c0: 6466 2e73 656c 6563 7428 7570 7065 7228  df.select(upper(
+000126d0: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
+000126e0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+000126f0: 7728 5550 5045 5228 2241 2229 3d27 4142  w(UPPER("A")='AB
+00012700: 4327 292c 2052 6f77 2855 5050 4552 2822  C'), Row(UPPER("
+00012710: 4122 293d 2741 4243 2729 2c20 526f 7728  A")='ABC'), Row(
+00012720: 5550 5045 5228 2241 2229 3d27 4142 4327  UPPER("A")='ABC'
+00012730: 292c 2052 6f77 2855 5050 4552 2822 4122  ), Row(UPPER("A"
+00012740: 293d 2741 4e46 c39c 4852 554e 4753 5a45  )='ANF..HRUNGSZE
+00012750: 4943 4845 4e27 292c 2052 6f77 2855 5050  ICHEN'), Row(UPP
+00012760: 4552 2822 4122 293d 2731 342e 3935 20e2  ER("A")='14.95 .
+00012770: 82ac 2729 5d0a 2020 2020 2222 220a 2020  ..')].    """.  
+00012780: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00012790: 5f73 7472 2865 2c20 2275 7070 6572 2229  _str(e, "upper")
+000127a0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+000127b0: 7469 6e28 2275 7070 6572 2229 2863 290a  tin("upper")(c).
+000127c0: 0a0a 6465 6620 7374 7274 6f6b 5f74 6f5f  ..def strtok_to_
+000127d0: 6172 7261 7928 0a20 2020 2074 6578 743a  array(.    text:
+000127e0: 2043 6f6c 756d 6e4f 724e 616d 652c 2064   ColumnOrName, d
+000127f0: 656c 696d 6974 6572 3a20 4f70 7469 6f6e  elimiter: Option
+00012800: 616c 5b43 6f6c 756d 6e4f 724e 616d 655d  al[ColumnOrName]
+00012810: 203d 204e 6f6e 650a 2920 2d3e 2043 6f6c   = None.) -> Col
+00012820: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00012830: 2054 6f6b 656e 697a 6573 2074 6865 2067   Tokenizes the g
+00012840: 6976 656e 2073 7472 696e 6720 7573 696e  iven string usin
+00012850: 6720 7468 6520 6769 7665 6e20 7365 7420  g the given set 
+00012860: 6f66 2064 656c 696d 6974 6572 7320 616e  of delimiters an
+00012870: 6420 7265 7475 726e 7320 7468 6520 746f  d returns the to
+00012880: 6b65 6e73 2061 7320 616e 2061 7272 6179  kens as an array
+00012890: 2e0a 0a20 2020 2049 6620 6569 7468 6572  ...    If either
+000128a0: 2070 6172 616d 6574 6572 2069 7320 6120   parameter is a 
+000128b0: 4e55 4c4c 2c20 6120 4e55 4c4c 2069 7320  NULL, a NULL is 
+000128c0: 7265 7475 726e 6564 2e20 416e 2065 6d70  returned. An emp
+000128d0: 7479 2061 7272 6179 2069 7320 7265 7475  ty array is retu
+000128e0: 726e 6564 2069 6620 746f 6b65 6e69 7a61  rned if tokeniza
+000128f0: 7469 6f6e 2070 726f 6475 6365 7320 6e6f  tion produces no
+00012900: 2074 6f6b 656e 732e 0a0a 2020 2020 4578   tokens...    Ex
+00012910: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00012920: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00012930: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00012940: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+00012950: 2020 205b 5b22 612e 622e 6322 2c20 222e     [["a.b.c", ".
+00012960: 225d 2c20 5b22 312c 322e 3322 2c20 222c  "], ["1,2.3", ",
+00012970: 225d 5d2c 0a20 2020 2020 2020 202e 2e2e  "]],.        ...
+00012980: 2020 2020 2073 6368 656d 613d 5b22 7465       schema=["te
+00012990: 7874 222c 2022 6465 6c69 6d69 7465 7222  xt", "delimiter"
+000129a0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+000129b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000129c0: 7365 6c65 6374 2873 7472 746f 6b5f 746f  select(strtok_to
+000129d0: 5f61 7272 6179 2822 7465 7874 222c 2022  _array("text", "
+000129e0: 6465 6c69 6d69 7465 7222 292e 616c 6961  delimiter").alia
+000129f0: 7328 2254 494d 455f 4652 4f4d 5f50 4152  s("TIME_FROM_PAR
+00012a00: 5453 2229 292e 636f 6c6c 6563 7428 290a  TS")).collect().
+00012a10: 2020 2020 2020 2020 5b52 6f77 2854 494d          [Row(TIM
+00012a20: 455f 4652 4f4d 5f50 4152 5453 3d27 5b5c  E_FROM_PARTS='[\
+00012a30: 5c6e 2020 2261 222c 5c5c 6e20 2022 6222  \n  "a",\\n  "b"
+00012a40: 2c5c 5c6e 2020 2263 225c 5c6e 5d27 292c  ,\\n  "c"\\n]'),
+00012a50: 2052 6f77 2854 494d 455f 4652 4f4d 5f50   Row(TIME_FROM_P
+00012a60: 4152 5453 3d27 5b5c 5c6e 2020 2231 222c  ARTS='[\\n  "1",
+00012a70: 5c5c 6e20 2022 322e 3322 5c5c 6e5d 2729  \\n  "2.3"\\n]')
+00012a80: 5d0a 2020 2020 2222 220a 2020 2020 7420  ].    """.    t 
+00012a90: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00012aa0: 2874 6578 742c 2022 7374 7274 6f6b 5f74  (text, "strtok_t
+00012ab0: 6f5f 6172 7261 7922 290a 2020 2020 6420  o_array").    d 
+00012ac0: 3d20 280a 2020 2020 2020 2020 5f74 6f5f  = (.        _to_
+00012ad0: 636f 6c5f 6966 5f73 7472 2864 656c 696d  col_if_str(delim
+00012ae0: 6974 6572 2c20 2273 7472 746f 6b5f 746f  iter, "strtok_to
+00012af0: 5f61 7272 6179 2229 0a20 2020 2020 2020  _array").       
+00012b00: 2069 6620 2864 656c 696d 6974 6572 2069   if (delimiter i
+00012b10: 7320 6e6f 7420 4e6f 6e65 290a 2020 2020  s not None).    
+00012b20: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
+00012b30: 2020 290a 2020 2020 7265 7475 726e 2028    ).    return (
+00012b40: 0a20 2020 2020 2020 2062 7569 6c74 696e  .        builtin
+00012b50: 2822 7374 7274 6f6b 5f74 6f5f 6172 7261  ("strtok_to_arra
+00012b60: 7922 2928 742c 2064 290a 2020 2020 2020  y")(t, d).      
+00012b70: 2020 6966 2028 6465 6c69 6d69 7465 7220    if (delimiter 
+00012b80: 6973 206e 6f74 204e 6f6e 6529 0a20 2020  is not None).   
+00012b90: 2020 2020 2065 6c73 6520 6275 696c 7469       else builti
+00012ba0: 6e28 2273 7472 746f 6b5f 746f 5f61 7272  n("strtok_to_arr
+00012bb0: 6179 2229 2874 290a 2020 2020 290a 0a0a  ay")(t).    )...
+00012bc0: 6465 6620 7374 7275 6374 282a 636f 6c73  def struct(*cols
+00012bd0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00012be0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00012bf0: 2222 0a20 2020 2052 6574 7572 6e73 2061  "".    Returns a
+00012c00: 6e20 4f42 4a45 4354 2063 6f6e 7374 7275  n OBJECT constru
+00012c10: 6374 6564 2077 6974 6820 7468 6520 6769  cted with the gi
+00012c20: 7665 6e20 636f 6c75 6d6e 732e 0a0a 2020  ven columns...  
+00012c30: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00012c40: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00012c50: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00012c60: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+00012c70: 2073 7472 7563 740a 2020 2020 2020 2020   struct.        
+00012c80: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00012c90: 2e63 7265 6174 6544 6174 6146 7261 6d65  .createDataFrame
+00012ca0: 285b 2822 426f 6222 2c20 3830 292c 2028  ([("Bob", 80), (
+00012cb0: 2241 6c69 6365 222c 204e 6f6e 6529 5d2c  "Alice", None)],
+00012cc0: 205b 226e 616d 6522 2c20 2261 6765 225d   ["name", "age"]
+00012cd0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
+00012ce0: 7320 3d20 6466 2e73 656c 6563 7428 7374  s = df.select(st
+00012cf0: 7275 6374 2822 6167 6522 2c20 226e 616d  ruct("age", "nam
+00012d00: 6522 292e 616c 6961 7328 2273 7472 7563  e").alias("struc
+00012d10: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+00012d20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00012d30: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00012d40: 2020 7c22 5354 5255 4354 2220 2020 2020    |"STRUCT"     
 00012d50: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00012d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00012d70: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00012d80: 0a20 2020 2022 2222 0a20 2020 2073 203d  .    """.    s =
-00012d90: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00012da0: 7374 725f 6578 7072 2c20 2272 6967 6874  str_expr, "right
-00012db0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00012dc0: 696c 7469 6e28 2272 6967 6874 2229 2873  iltin("right")(s
-00012dd0: 2c20 6c69 7428 6c65 6e67 7468 2929 0a0a  , lit(length))..
-00012de0: 0a64 6566 2063 6861 7228 636f 6c3a 2043  .def char(col: C
-00012df0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00012e00: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-00012e10: 6f6e 7665 7274 7320 6120 556e 6963 6f64  onverts a Unicod
-00012e20: 6520 636f 6465 2070 6f69 6e74 2028 696e  e code point (in
-00012e30: 636c 7564 696e 6720 372d 6269 7420 4153  cluding 7-bit AS
-00012e40: 4349 4929 2069 6e74 6f20 7468 6520 6368  CII) into the ch
-00012e50: 6172 6163 7465 7220 7468 6174 0a20 2020  aracter that.   
-00012e60: 206d 6174 6368 6573 2074 6865 2069 6e70   matches the inp
-00012e70: 7574 2055 6e69 636f 6465 2e0a 0a20 2020  ut Unicode...   
-00012e80: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00012e90: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00012ea0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00012eb0: 6672 616d 6528 5b38 332c 2033 332c 2031  frame([83, 33, 1
-00012ec0: 3639 2c20 3833 3634 2c20 4e6f 6e65 5d2c  69, 8364, None],
-00012ed0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
-00012ee0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00012ef0: 6c65 6374 2864 662e 612c 2063 6861 7228  lect(df.a, char(
-00012f00: 6466 2e61 292e 6173 5f28 2763 6861 7227  df.a).as_('char'
-00012f10: 2929 2e73 6f72 7428 6466 2e61 292e 7368  )).sort(df.a).sh
-00012f20: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00012f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00012f40: 2020 2020 2020 207c 2241 2220 2020 7c22         |"A"   |"
-00012f50: 4348 4152 2220 207c 0a20 2020 2020 2020  CHAR"  |.       
-00012f60: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00012f70: 2d2d 0a20 2020 2020 2020 207c 4e55 4c4c  --.        |NULL
-00012f80: 2020 7c4e 554c 4c20 2020 207c 0a20 2020    |NULL    |.   
-00012f90: 2020 2020 207c 3333 2020 2020 7c21 2020       |33    |!  
-00012fa0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00012fb0: 3833 2020 2020 7c53 2020 2020 2020 207c  83    |S       |
-00012fc0: 0a20 2020 2020 2020 207c 3136 3920 2020  .        |169   
-00012fd0: 7cc2 a920 2020 2020 2020 7c0a 2020 2020  |..       |.    
-00012fe0: 2020 2020 7c38 3336 3420 207c e282 ac20      |8364  |... 
-00012ff0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00013000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013010: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00013020: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00013030: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00013040: 5f73 7472 2863 6f6c 2c20 2263 6861 7222  _str(col, "char"
-00013050: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00013060: 6c74 696e 2822 6368 6172 2229 2863 290a  ltin("char")(c).
-00013070: 0a0a 6465 6620 746f 5f63 6861 7228 633a  ..def to_char(c:
-00013080: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
-00013090: 6f72 6d61 743a 204f 7074 696f 6e61 6c5b  ormat: Optional[
-000130a0: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
-000130b0: 7472 5d20 3d20 4e6f 6e65 2920 2d3e 2043  tr] = None) -> C
-000130c0: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
-000130d0: 6e76 6572 7473 2061 2055 6e69 636f 6465  nverts a Unicode
-000130e0: 2063 6f64 6520 706f 696e 7420 2869 6e63   code point (inc
-000130f0: 6c75 6469 6e67 2037 2d62 6974 2041 5343  luding 7-bit ASC
-00013100: 4949 2920 696e 746f 2074 6865 2063 6861  II) into the cha
-00013110: 7261 6374 6572 2074 6861 740a 2020 2020  racter that.    
-00013120: 6d61 7463 6865 7320 7468 6520 696e 7075  matches the inpu
-00013130: 7420 556e 6963 6f64 652e 0a0a 2020 2020  t Unicode...    
-00013140: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-00013150: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00013160: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00013170: 616d 6528 5b31 2c20 322c 2033 2c20 345d  ame([1, 2, 3, 4]
-00013180: 2c20 7363 6865 6d61 3d5b 2761 275d 290a  , schema=['a']).
-00013190: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000131a0: 656c 6563 7428 746f 5f63 6861 7228 636f  elect(to_char(co
-000131b0: 6c28 2761 2729 292e 6173 5f28 2761 6e73  l('a')).as_('ans
-000131c0: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
-000131d0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-000131e0: 3127 292c 2052 6f77 2841 4e53 3d27 3227  1'), Row(ANS='2'
-000131f0: 292c 2052 6f77 2841 4e53 3d27 3327 292c  ), Row(ANS='3'),
-00013200: 2052 6f77 2841 4e53 3d27 3427 295d 0a0a   Row(ANS='4')]..
-00013210: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00013220: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00013230: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
-00013240: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00013250: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00013260: 7261 6d65 285b 6461 7465 7469 6d65 2e64  rame([datetime.d
-00013270: 6174 6574 696d 6528 3230 3233 2c20 342c  atetime(2023, 4,
-00013280: 2031 3629 2c20 6461 7465 7469 6d65 2e64   16), datetime.d
-00013290: 6174 6574 696d 6528 3230 3137 2c20 342c  atetime(2017, 4,
-000132a0: 2033 2c20 322c 2035 392c 2033 372c 2031   3, 2, 59, 37, 1
-000132b0: 3533 295d 2c20 7363 6865 6d61 3d5b 2761  53)], schema=['a
-000132c0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-000132d0: 6466 2e73 656c 6563 7428 746f 5f63 6861  df.select(to_cha
-000132e0: 7228 636f 6c28 2761 2729 292e 6173 5f28  r(col('a')).as_(
-000132f0: 2761 6e73 2729 292e 636f 6c6c 6563 7428  'ans')).collect(
-00013300: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00013310: 4e53 3d27 3230 3233 2d30 342d 3136 2030  NS='2023-04-16 0
-00013320: 303a 3030 3a30 302e 3030 3027 292c 2052  0:00:00.000'), R
-00013330: 6f77 2841 4e53 3d27 3230 3137 2d30 342d  ow(ANS='2017-04-
-00013340: 3033 2030 323a 3539 3a33 372e 3030 3027  03 02:59:37.000'
-00013350: 295d 0a0a 2020 2020 2222 220a 2020 2020  )]..    """.    
-00013360: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00013370: 7472 2863 2c20 2274 6f5f 6368 6172 2229  tr(c, "to_char")
-00013380: 0a20 2020 2072 6574 7572 6e20 280a 2020  .    return (.  
-00013390: 2020 2020 2020 6275 696c 7469 6e28 2274        builtin("t
-000133a0: 6f5f 6368 6172 2229 2863 2c20 6c69 7428  o_char")(c, lit(
-000133b0: 666f 726d 6174 2929 0a20 2020 2020 2020  format)).       
-000133c0: 2069 6620 666f 726d 6174 2069 7320 6e6f   if format is no
-000133d0: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
-000133e0: 6c73 6520 6275 696c 7469 6e28 2274 6f5f  lse builtin("to_
-000133f0: 6368 6172 2229 2863 290a 2020 2020 290a  char")(c).    ).
-00013400: 0a0a 6465 6620 746f 5f74 696d 6528 653a  ..def to_time(e:
-00013410: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
-00013420: 6d74 3a20 4f70 7469 6f6e 616c 5b22 436f  mt: Optional["Co
-00013430: 6c75 6d6e 225d 203d 204e 6f6e 6529 202d  lumn"] = None) -
-00013440: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00013450: 2243 6f6e 7665 7274 7320 616e 2069 6e70  "Converts an inp
-00013460: 7574 2065 7870 7265 7373 696f 6e20 696e  ut expression in
-00013470: 746f 2074 6865 2063 6f72 7265 7370 6f6e  to the correspon
-00013480: 6469 6e67 2074 696d 652e 0a0a 2020 2020  ding time...    
-00013490: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000134a0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000134b0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000134c0: 7261 6d65 285b 2730 343a 3135 3a32 392e  rame(['04:15:29.
-000134d0: 3939 3927 5d2c 2073 6368 656d 613d 5b27  999'], schema=['
-000134e0: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
-000134f0: 2064 662e 7365 6c65 6374 2874 6f5f 7469   df.select(to_ti
-00013500: 6d65 2863 6f6c 2822 6122 2929 292e 636f  me(col("a"))).co
-00013510: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00013520: 5b52 6f77 2854 4f5f 5449 4d45 2822 4122  [Row(TO_TIME("A"
-00013530: 293d 6461 7465 7469 6d65 2e74 696d 6528  )=datetime.time(
-00013540: 342c 2031 352c 2032 392c 2039 3939 3030  4, 15, 29, 99900
-00013550: 3029 295d 0a20 2020 2022 2222 0a20 2020  0))].    """.   
-00013560: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00013570: 7374 7228 652c 2022 746f 5f74 696d 6522  str(e, "to_time"
-00013580: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00013590: 6c74 696e 2822 746f 5f74 696d 6522 2928  ltin("to_time")(
-000135a0: 632c 2066 6d74 2920 6966 2066 6d74 2069  c, fmt) if fmt i
-000135b0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-000135c0: 6275 696c 7469 6e28 2274 6f5f 7469 6d65  builtin("to_time
-000135d0: 2229 2863 290a 0a0a 6465 6620 746f 5f74  ")(c)...def to_t
-000135e0: 696d 6573 7461 6d70 2865 3a20 436f 6c75  imestamp(e: Colu
-000135f0: 6d6e 4f72 4e61 6d65 2c20 666d 743a 204f  mnOrName, fmt: O
-00013600: 7074 696f 6e61 6c5b 2243 6f6c 756d 6e22  ptional["Column"
-00013610: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
-00013620: 756d 6e3a 0a20 2020 2022 2222 436f 6e76  umn:.    """Conv
-00013630: 6572 7473 2061 6e20 696e 7075 7420 6578  erts an input ex
-00013640: 7072 6573 7369 6f6e 2069 6e74 6f20 7468  pression into th
-00013650: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
-00013660: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
-00013670: 5065 7220 6465 6661 756c 7420 666d 7420  Per default fmt 
-00013680: 6973 2073 6574 2074 6f20 6175 746f 2c20  is set to auto, 
-00013690: 7768 6963 6820 6d61 6b65 7320 536e 6f77  which makes Snow
-000136a0: 666c 616b 6520 6465 7465 6374 2074 6865  flake detect the
-000136b0: 2066 6f72 6d61 7420 6175 746f 6d61 7469   format automati
-000136c0: 6361 6c6c 792e 2057 6974 6820 6074 6f5f  cally. With `to_
-000136d0: 7469 6d65 7374 616d 7060 2073 7472 696e  timestamp` strin
-000136e0: 6773 0a20 2020 2063 616e 2062 6520 636f  gs.    can be co
-000136f0: 6e76 6572 7465 6420 746f 2074 696d 6573  nverted to times
-00013700: 7461 6d70 732e 2054 6865 2066 6f72 6d61  tamps. The forma
-00013710: 7420 6861 7320 746f 2062 6520 7370 6563  t has to be spec
-00013720: 6966 6965 6420 6163 636f 7264 696e 6720  ified according 
-00013730: 746f 2074 6865 2072 756c 6573 2073 6574  to the rules set
-00013740: 2066 6f72 7468 2069 6e0a 2020 2020 3c68   forth in.    <h
-00013750: 7474 7073 3a2f 2f64 6f63 732e 736e 6f77  ttps://docs.snow
-00013760: 666c 616b 652e 636f 6d2f 656e 2f73 716c  flake.com/en/sql
-00013770: 2d72 6566 6572 656e 6365 2f66 756e 6374  -reference/funct
-00013780: 696f 6e73 2d63 6f6e 7665 7273 696f 6e23  ions-conversion#
-00013790: 6461 7465 2d61 6e64 2d74 696d 652d 666f  date-and-time-fo
-000137a0: 726d 6174 732d 696e 2d63 6f6e 7665 7273  rmats-in-convers
-000137b0: 696f 6e2d 6675 6e63 7469 6f6e 733e 0a0a  ion-functions>..
-000137c0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-000137d0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000137e0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000137f0: 7461 6672 616d 6528 5b27 3230 3139 2d30  taframe(['2019-0
-00013800: 312d 3331 2030 313a 3032 3a30 332e 3030  1-31 01:02:03.00
-00013810: 3427 5d2c 2073 6368 656d 613d 5b27 6127  4'], schema=['a'
-00013820: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00013830: 662e 7365 6c65 6374 2874 6f5f 7469 6d65  f.select(to_time
-00013840: 7374 616d 7028 636f 6c28 2261 2229 292e  stamp(col("a")).
-00013850: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
-00013860: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00013870: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
-00013880: 6461 7465 7469 6d65 2832 3031 392c 2031  datetime(2019, 1
-00013890: 2c20 3331 2c20 312c 2032 2c20 332c 2034  , 31, 1, 2, 3, 4
-000138a0: 3030 3029 295d 0a20 2020 2020 2020 203e  000))].        >
-000138b0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000138c0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000138d0: 285b 2232 3032 302d 3035 2d30 3120 3133  (["2020-05-01 13
-000138e0: 3a31 313a 3230 2e30 3030 225d 2c20 7363  :11:20.000"], sc
-000138f0: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
-00013900: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00013910: 7428 746f 5f74 696d 6573 7461 6d70 2863  t(to_timestamp(c
-00013920: 6f6c 2822 6122 292c 206c 6974 2822 5959  ol("a"), lit("YY
-00013930: 5959 2d4d 4d2d 4444 2048 4832 343a 4d49  YY-MM-DD HH24:MI
-00013940: 3a53 532e 4646 3322 2929 2e61 735f 2822  :SS.FF3")).as_("
-00013950: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
-00013960: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-00013970: 533d 6461 7465 7469 6d65 2e64 6174 6574  S=datetime.datet
-00013980: 696d 6528 3230 3230 2c20 352c 2031 2c20  ime(2020, 5, 1, 
-00013990: 3133 2c20 3131 2c20 3230 2929 5d0a 0a20  13, 11, 20))].. 
-000139a0: 2020 2041 6e6f 7468 6572 206f 7074 696f     Another optio
-000139b0: 6e20 6973 2074 6f20 636f 6e76 6572 7420  n is to convert 
-000139c0: 6461 7465 7320 696e 746f 2074 696d 6573  dates into times
-000139d0: 7461 6d70 730a 0a20 2020 2045 7861 6d70  tamps..    Examp
-000139e0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-000139f0: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-00013a00: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00013a10: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00013a20: 4461 7461 4672 616d 6528 5b64 6174 6574  DataFrame([datet
-00013a30: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-00013a40: 322c 2031 322c 2032 352c 2031 332c 2035  2, 12, 25, 13, 5
-00013a50: 392c 2033 382c 2034 3637 295d 2c20 7363  9, 38, 467)], sc
-00013a60: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00013a70: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00013a80: 7428 746f 5f74 696d 6573 7461 6d70 2863  t(to_timestamp(c
-00013a90: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
-00013aa0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00013ab0: 2854 4f5f 5449 4d45 5354 414d 5028 2241  (TO_TIMESTAMP("A
-00013ac0: 2229 3d64 6174 6574 696d 652e 6461 7465  ")=datetime.date
-00013ad0: 7469 6d65 2832 3032 322c 2031 322c 2032  time(2022, 12, 2
-00013ae0: 352c 2031 332c 2035 392c 2033 382c 2034  5, 13, 59, 38, 4
-00013af0: 3637 2929 5d0a 2020 2020 2020 2020 3e3e  67))].        >>
-00013b00: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00013b10: 7265 6174 6544 6174 6146 7261 6d65 285b  reateDataFrame([
-00013b20: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-00013b30: 3233 2c20 332c 2031 295d 2c20 7363 6865  23, 3, 1)], sche
-00013b40: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00013b50: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00013b60: 746f 5f74 696d 6573 7461 6d70 2863 6f6c  to_timestamp(col
-00013b70: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-00013b80: 290a 2020 2020 2020 2020 5b52 6f77 2854  ).        [Row(T
-00013b90: 4f5f 5449 4d45 5354 414d 5028 2241 2229  O_TIMESTAMP("A")
-00013ba0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-00013bb0: 6d65 2832 3032 332c 2033 2c20 312c 2030  me(2023, 3, 1, 0
-00013bc0: 2c20 3029 295d 0a0a 2020 2020 496e 7465  , 0))]..    Inte
-00013bd0: 6765 7273 2063 616e 2062 6520 636f 6e76  gers can be conv
-00013be0: 6572 7465 6420 696e 746f 2061 2074 696d  erted into a tim
-00013bf0: 6573 7461 6d70 2061 7320 7765 6c6c 2c20  estamp as well, 
-00013c00: 6279 2070 726f 7669 6469 6e67 206f 7074  by providing opt
-00013c10: 696f 6e61 6c6c 7920 6120 7363 616c 6520  ionally a scale 
-00013c20: 6173 2061 6e20 696e 7465 6765 7220 6173  as an integer as
-00013c30: 206c 696e 6564 206f 7574 2069 6e0a 2020   lined out in.  
-00013c40: 2020 3c68 7474 7073 3a2f 2f64 6f63 732e    <https://docs.
-00013c50: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
-00013c60: 2f73 716c 2d72 6566 6572 656e 6365 2f66  /sql-reference/f
-00013c70: 756e 6374 696f 6e73 2f74 6f5f 7469 6d65  unctions/to_time
-00013c80: 7374 616d 7023 7573 6167 652d 6e6f 7465  stamp#usage-note
-00013c90: 733e 2e20 4375 7272 656e 746c 7920 536e  s>. Currently Sn
-00013ca0: 6f77 7061 726b 2064 6f65 7320 7375 7070  owpark does supp
-00013cb0: 6f72 740a 2020 2020 696e 7465 6765 7273  ort.    integers
-00013cc0: 2069 6e20 7468 6520 7261 6e67 6520 6f66   in the range of
-00013cd0: 2061 6e20 382d 6279 7465 2073 6967 6e65   an 8-byte signe
-00013ce0: 6420 696e 7465 6765 7220 6f6e 6c79 2e0a  d integer only..
-00013cf0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00013d00: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00013d10: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
-00013d20: 7461 4672 616d 6528 5b32 302c 2033 3135  taFrame([20, 315
-00013d30: 3336 3030 3030 3030 5d2c 2073 6368 656d  36000000], schem
-00013d40: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
-00013d50: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
-00013d60: 6f5f 7469 6d65 7374 616d 7028 636f 6c28  o_timestamp(col(
-00013d70: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
-00013d80: 0a20 2020 2020 2020 205b 526f 7728 544f  .        [Row(TO
-00013d90: 5f54 494d 4553 5441 4d50 2822 4122 293d  _TIMESTAMP("A")=
-00013da0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00013db0: 6528 3139 3730 2c20 312c 2031 2c20 302c  e(1970, 1, 1, 0,
-00013dc0: 2030 2c20 3230 2929 2c20 526f 7728 544f   0, 20)), Row(TO
-00013dd0: 5f54 494d 4553 5441 4d50 2822 4122 293d  _TIMESTAMP("A")=
-00013de0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00013df0: 6528 3239 3639 2c20 352c 2033 2c20 302c  e(2969, 5, 3, 0,
-00013e00: 2030 2929 5d0a 2020 2020 2020 2020 3e3e   0))].        >>
-00013e10: 3e20 6466 2e73 656c 6563 7428 746f 5f74  > df.select(to_t
-00013e20: 696d 6573 7461 6d70 2863 6f6c 2822 6122  imestamp(col("a"
-00013e30: 292c 206c 6974 2839 2929 292e 636f 6c6c  ), lit(9))).coll
-00013e40: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00013e50: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
-00013e60: 2241 222c 2039 293d 6461 7465 7469 6d65  "A", 9)=datetime
-00013e70: 2e64 6174 6574 696d 6528 3139 3730 2c20  .datetime(1970, 
-00013e80: 312c 2031 2c20 302c 2030 2929 2c20 526f  1, 1, 0, 0)), Ro
-00013e90: 7728 544f 5f54 494d 4553 5441 4d50 2822  w(TO_TIMESTAMP("
-00013ea0: 4122 2c20 3929 3d64 6174 6574 696d 652e  A", 9)=datetime.
-00013eb0: 6461 7465 7469 6d65 2831 3937 302c 2031  datetime(1970, 1
-00013ec0: 2c20 312c 2030 2c20 302c 2033 312c 2035  , 1, 0, 0, 31, 5
-00013ed0: 3336 3030 3029 295d 0a0a 2020 2020 4c61  36000))]..    La
-00013ee0: 7267 6572 206e 756d 6265 7273 2073 746f  rger numbers sto
-00013ef0: 7265 6420 696e 2061 2073 7472 696e 6720  red in a string 
-00013f00: 6361 6e20 6265 2061 6c73 6f20 636f 6e76  can be also conv
-00013f10: 6572 7465 6420 7669 6120 7468 6973 2061  erted via this a
-00013f20: 7070 726f 6163 680a 0a20 2020 2045 7861  pproach..    Exa
-00013f30: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-00013f40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00013f50: 6372 6561 7465 4461 7461 4672 616d 6528  createDataFrame(
-00013f60: 5b27 3230 272c 2027 3331 3533 3630 3030  ['20', '31536000
-00013f70: 3030 3027 2c20 2733 3135 3336 3030 3030  000', '315360000
-00013f80: 3030 3030 3027 2c20 2733 3135 3336 3030  00000', '3153600
-00013f90: 3030 3030 3030 3030 3030 275d 2c20 7363  0000000000'], sc
-00013fa0: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
-00013fb0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00013fc0: 7428 746f 5f74 696d 6573 7461 6d70 2863  t(to_timestamp(c
-00013fd0: 6f6c 2822 6122 2929 2e61 735f 2822 616e  ol("a")).as_("an
-00013fe0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-00013ff0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-00014000: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00014010: 6528 3139 3730 2c20 312c 2031 2c20 302c  e(1970, 1, 1, 0,
-00014020: 2030 2c20 3230 2929 2c20 526f 7728 414e   0, 20)), Row(AN
-00014030: 533d 6461 7465 7469 6d65 2e64 6174 6574  S=datetime.datet
-00014040: 696d 6528 3139 3731 2c20 312c 2031 2c20  ime(1971, 1, 1, 
-00014050: 302c 2030 2929 2c20 526f 7728 414e 533d  0, 0)), Row(ANS=
-00014060: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00014070: 6528 3139 3731 2c20 312c 2031 2c20 302c  e(1971, 1, 1, 0,
-00014080: 2030 2929 2c20 526f 7728 414e 533d 6461   0)), Row(ANS=da
-00014090: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-000140a0: 3139 3731 2c20 312c 2031 2c20 302c 2030  1971, 1, 1, 0, 0
-000140b0: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-000140c0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-000140d0: 7472 2865 2c20 2274 6f5f 7469 6d65 7374  tr(e, "to_timest
-000140e0: 616d 7022 290a 2020 2020 7265 7475 726e  amp").    return
-000140f0: 2028 0a20 2020 2020 2020 2062 7569 6c74   (.        built
-00014100: 696e 2822 746f 5f74 696d 6573 7461 6d70  in("to_timestamp
-00014110: 2229 2863 2c20 666d 7429 0a20 2020 2020  ")(c, fmt).     
-00014120: 2020 2069 6620 666d 7420 6973 206e 6f74     if fmt is not
-00014130: 204e 6f6e 650a 2020 2020 2020 2020 656c   None.        el
-00014140: 7365 2062 7569 6c74 696e 2822 746f 5f74  se builtin("to_t
-00014150: 696d 6573 7461 6d70 2229 2863 290a 2020  imestamp")(c).  
-00014160: 2020 290a 0a0a 6465 6620 746f 5f64 6174    )...def to_dat
-00014170: 6528 653a 2043 6f6c 756d 6e4f 724e 616d  e(e: ColumnOrNam
-00014180: 652c 2066 6d74 3a20 4f70 7469 6f6e 616c  e, fmt: Optional
-00014190: 5b22 436f 6c75 6d6e 225d 203d 204e 6f6e  ["Column"] = Non
-000141a0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-000141b0: 2020 2222 2243 6f6e 7665 7274 7320 616e    """Converts an
-000141c0: 2069 6e70 7574 2065 7870 7265 7373 696f   input expressio
-000141d0: 6e20 696e 746f 2061 2064 6174 652e 0a0a  n into a date...
-000141e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-000141f0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00014200: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00014210: 6174 6166 7261 6d65 285b 2732 3031 332d  ataframe(['2013-
-00014220: 3035 2d31 3727 2c20 2732 3031 332d 3035  05-17', '2013-05
-00014230: 2d31 3727 5d2c 2073 6368 656d 613d 5b27  -17'], schema=['
-00014240: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
-00014250: 2064 662e 7365 6c65 6374 2874 6f5f 6461   df.select(to_da
-00014260: 7465 2863 6f6c 2827 6127 2929 2e61 735f  te(col('a')).as_
-00014270: 2827 616e 7327 2929 2e63 6f6c 6c65 6374  ('ans')).collect
-00014280: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00014290: 414e 533d 6461 7465 7469 6d65 2e64 6174  ANS=datetime.dat
-000142a0: 6528 3230 3133 2c20 352c 2031 3729 292c  e(2013, 5, 17)),
-000142b0: 2052 6f77 2841 4e53 3d64 6174 6574 696d   Row(ANS=datetim
-000142c0: 652e 6461 7465 2832 3031 332c 2035 2c20  e.date(2013, 5, 
-000142d0: 3137 2929 5d0a 0a20 2020 2020 2020 203e  17))]..        >
-000142e0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000142f0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00014300: 285b 2733 3135 3336 3030 3030 3030 3030  (['3153600000000
-00014310: 3027 2c20 2737 3135 3336 3030 3430 3030  0', '71536004000
-00014320: 3030 3027 5d2c 2073 6368 656d 613d 5b27  000'], schema=['
-00014330: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
-00014340: 2064 662e 7365 6c65 6374 2874 6f5f 6461   df.select(to_da
-00014350: 7465 2863 6f6c 2827 6127 2929 2e61 735f  te(col('a')).as_
-00014360: 2827 616e 7327 2929 2e63 6f6c 6c65 6374  ('ans')).collect
-00014370: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00014380: 414e 533d 6461 7465 7469 6d65 2e64 6174  ANS=datetime.dat
-00014390: 6528 3139 3731 2c20 312c 2031 2929 2c20  e(1971, 1, 1)), 
-000143a0: 526f 7728 414e 533d 6461 7465 7469 6d65  Row(ANS=datetime
-000143b0: 2e64 6174 6528 3139 3732 2c20 342c 2037  .date(1972, 4, 7
-000143c0: 2929 5d0a 0a20 2020 2022 2222 0a20 2020  ))]..    """.   
-000143d0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-000143e0: 7374 7228 652c 2022 746f 5f64 6174 6522  str(e, "to_date"
-000143f0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00014400: 6c74 696e 2822 746f 5f64 6174 6522 2928  ltin("to_date")(
-00014410: 632c 2066 6d74 2920 6966 2066 6d74 2069  c, fmt) if fmt i
-00014420: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00014430: 6275 696c 7469 6e28 2274 6f5f 6461 7465  builtin("to_date
-00014440: 2229 2863 290a 0a0a 6465 6620 6375 7272  ")(c)...def curr
-00014450: 656e 745f 7469 6d65 7374 616d 7028 2920  ent_timestamp() 
-00014460: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00014470: 2222 5265 7475 726e 7320 7468 6520 6375  ""Returns the cu
-00014480: 7272 656e 7420 7469 6d65 7374 616d 7020  rrent timestamp 
-00014490: 666f 7220 7468 6520 7379 7374 656d 2e0a  for the system..
-000144a0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-000144b0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-000144c0: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
-000144d0: 2020 3e3e 3e20 7265 7375 6c74 203d 2073    >>> result = s
-000144e0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000144f0: 7461 6672 616d 6528 5b31 5d29 2e73 656c  taframe([1]).sel
-00014500: 6563 7428 6375 7272 656e 745f 7469 6d65  ect(current_time
-00014510: 7374 616d 7028 2929 2e63 6f6c 6c65 6374  stamp()).collect
-00014520: 2829 0a20 2020 2020 2020 203e 3e3e 2061  ().        >>> a
-00014530: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-00014540: 2872 6573 756c 745b 305d 5b22 4355 5252  (result[0]["CURR
-00014550: 454e 545f 5449 4d45 5354 414d 5028 2922  ENT_TIMESTAMP()"
-00014560: 5d2c 2064 6174 6574 696d 652e 6461 7465  ], datetime.date
-00014570: 7469 6d65 290a 2020 2020 2222 220a 0a20  time).    """.. 
-00014580: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00014590: 6e28 2263 7572 7265 6e74 5f74 696d 6573  n("current_times
-000145a0: 7461 6d70 2229 2829 0a0a 0a64 6566 2063  tamp")()...def c
-000145b0: 7572 7265 6e74 5f64 6174 6528 2920 2d3e  urrent_date() ->
-000145c0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000145d0: 5265 7475 726e 7320 7468 6520 6375 7272  Returns the curr
-000145e0: 656e 7420 6461 7465 2066 6f72 2074 6865  ent date for the
-000145f0: 2073 7973 7465 6d2e 0a0a 2020 2020 4578   system...    Ex
-00014600: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00014610: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00014620: 6d65 0a20 2020 2020 2020 203e 3e3e 2072  me.        >>> r
-00014630: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
-00014640: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00014650: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
-00014660: 7265 6e74 5f64 6174 6528 2929 2e63 6f6c  rent_date()).col
-00014670: 6c65 6374 2829 0a20 2020 2020 2020 203e  lect().        >
-00014680: 3e3e 2061 7373 6572 7420 6973 696e 7374  >> assert isinst
-00014690: 616e 6365 2872 6573 756c 745b 305d 5b22  ance(result[0]["
-000146a0: 4355 5252 454e 545f 4441 5445 2829 225d  CURRENT_DATE()"]
-000146b0: 2c20 6461 7465 7469 6d65 2e64 6174 6529  , datetime.date)
-000146c0: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
-000146d0: 7572 6e20 6275 696c 7469 6e28 2263 7572  urn builtin("cur
-000146e0: 7265 6e74 5f64 6174 6522 2928 290a 0a0a  rent_date")()...
-000146f0: 6465 6620 6375 7272 656e 745f 7469 6d65  def current_time
-00014700: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-00014710: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00014720: 2063 7572 7265 6e74 2074 696d 6520 666f   current time fo
-00014730: 7220 7468 6520 7379 7374 656d 2e0a 0a20  r the system... 
-00014740: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00014750: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00014760: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-00014770: 3e3e 3e20 7265 7375 6c74 203d 2073 6573  >>> result = ses
-00014780: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00014790: 6672 616d 6528 5b31 5d29 2e73 656c 6563  frame([1]).selec
-000147a0: 7428 6375 7272 656e 745f 7469 6d65 2829  t(current_time()
-000147b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-000147c0: 2020 2020 3e3e 3e20 6173 7365 7274 2069      >>> assert i
-000147d0: 7369 6e73 7461 6e63 6528 7265 7375 6c74  sinstance(result
-000147e0: 5b30 5d5b 2243 5552 5245 4e54 5f54 494d  [0]["CURRENT_TIM
-000147f0: 4528 2922 5d2c 2064 6174 6574 696d 652e  E()"], datetime.
-00014800: 7469 6d65 290a 2020 2020 2222 220a 2020  time).    """.  
-00014810: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00014820: 2822 6375 7272 656e 745f 7469 6d65 2229  ("current_time")
-00014830: 2829 0a0a 0a64 6566 2068 6f75 7228 653a  ()...def hour(e:
-00014840: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00014850: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00014860: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
-00014870: 6865 2068 6f75 7220 6672 6f6d 2061 2064  he hour from a d
-00014880: 6174 6520 6f72 2074 696d 6573 7461 6d70  ate or timestamp
-00014890: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-000148a0: 0a0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
-000148b0: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
-000148c0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000148d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000148e0: 7461 6672 616d 6528 5b0a 2020 2020 2020  taframe([.      
-000148f0: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
-00014900: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-00014910: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
-00014920: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
-00014930: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-00014940: 2553 2e25 6622 292c 0a20 2020 2020 2020  %S.%f"),.       
-00014950: 202e 2e2e 2020 2020 2064 6174 6574 696d   ...     datetim
-00014960: 652e 6461 7465 7469 6d65 2e73 7472 7074  e.datetime.strpt
-00014970: 696d 6528 2232 3032 302d 3038 2d32 3120  ime("2020-08-21 
-00014980: 3031 3a33 303a 3035 2e30 3030 222c 2022  01:30:05.000", "
-00014990: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
-000149a0: 532e 2566 2229 0a20 2020 2020 2020 202e  S.%f").        .
-000149b0: 2e2e 205d 2c20 7363 6865 6d61 3d5b 2261  .. ], schema=["a
-000149c0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000149d0: 6466 2e73 656c 6563 7428 686f 7572 2822  df.select(hour("
-000149e0: 6122 2929 2e63 6f6c 6c65 6374 2829 0a20  a")).collect(). 
-000149f0: 2020 2020 2020 205b 526f 7728 484f 5552         [Row(HOUR
-00014a00: 2822 4122 293d 3133 292c 2052 6f77 2848  ("A")=13), Row(H
-00014a10: 4f55 5228 2241 2229 3d31 295d 0a20 2020  OUR("A")=1)].   
-00014a20: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00014a30: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00014a40: 686f 7572 2229 0a20 2020 2072 6574 7572  hour").    retur
-00014a50: 6e20 6275 696c 7469 6e28 2268 6f75 7222  n builtin("hour"
-00014a60: 2928 6329 0a0a 0a64 6566 206c 6173 745f  )(c)...def last_
-00014a70: 6461 7928 653a 2043 6f6c 756d 6e4f 724e  day(e: ColumnOrN
-00014a80: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00014a90: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-00014aa0: 726e 7320 7468 6520 6c61 7374 2064 6179  rns the last day
-00014ab0: 206f 6620 7468 6520 7370 6563 6966 6965   of the specifie
-00014ac0: 6420 6461 7465 2070 6172 7420 666f 7220  d date part for 
-00014ad0: 6120 6461 7465 206f 7220 7469 6d65 7374  a date or timest
-00014ae0: 616d 702e 0a20 2020 2043 6f6d 6d6f 6e6c  amp..    Commonl
-00014af0: 7920 7573 6564 2074 6f20 7265 7475 726e  y used to return
-00014b00: 2074 6865 206c 6173 7420 6461 7920 6f66   the last day of
-00014b10: 2074 6865 206d 6f6e 7468 2066 6f72 2061   the month for a
-00014b20: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
-00014b30: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
-00014b40: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00014b50: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-00014b60: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00014b70: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00014b80: 6461 7461 6672 616d 6528 5b0a 2020 2020  dataframe([.    
-00014b90: 2020 2020 2e2e 2e20 2020 2020 6461 7465      ...     date
-00014ba0: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
-00014bb0: 7270 7469 6d65 2822 3230 3230 2d30 352d  rptime("2020-05-
-00014bc0: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
-00014bd0: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
-00014be0: 4d3a 2553 2e25 6622 292c 0a20 2020 2020  M:%S.%f"),.     
-00014bf0: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
-00014c00: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-00014c10: 7074 696d 6528 2232 3032 302d 3038 2d32  ptime("2020-08-2
-00014c20: 3120 3031 3a33 303a 3035 2e30 3030 222c  1 01:30:05.000",
-00014c30: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-00014c40: 3a25 532e 2566 2229 0a20 2020 2020 2020  :%S.%f").       
-00014c50: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
-00014c60: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00014c70: 3e20 6466 2e73 656c 6563 7428 6c61 7374  > df.select(last
-00014c80: 5f64 6179 2822 6122 2929 2e63 6f6c 6c65  _day("a")).colle
-00014c90: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00014ca0: 7728 4c41 5354 5f44 4159 2822 4122 293d  w(LAST_DAY("A")=
-00014cb0: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-00014cc0: 3230 2c20 352c 2033 3129 292c 2052 6f77  20, 5, 31)), Row
-00014cd0: 284c 4153 545f 4441 5928 2241 2229 3d64  (LAST_DAY("A")=d
-00014ce0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-00014cf0: 302c 2038 2c20 3331 2929 5d0a 2020 2020  0, 8, 31))].    
-00014d00: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00014d10: 636f 6c5f 6966 5f73 7472 2865 2c20 226c  col_if_str(e, "l
-00014d20: 6173 745f 6461 7922 290a 2020 2020 7265  ast_day").    re
-00014d30: 7475 726e 2062 7569 6c74 696e 2822 6c61  turn builtin("la
-00014d40: 7374 5f64 6179 2229 2863 290a 0a0a 6465  st_day")(c)...de
-00014d50: 6620 6d69 6e75 7465 2865 3a20 436f 6c75  f minute(e: Colu
-00014d60: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00014d70: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00014d80: 2045 7874 7261 6374 7320 7468 6520 6d69   Extracts the mi
-00014d90: 6e75 7465 2066 726f 6d20 6120 6461 7465  nute from a date
-00014da0: 206f 7220 7469 6d65 7374 616d 702e 0a0a   or timestamp...
-00014db0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00014dc0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00014dd0: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
-00014de0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00014df0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00014e00: 7261 6d65 285b 0a20 2020 2020 2020 202e  rame([.        .
-00014e10: 2e2e 2020 2020 2064 6174 6574 696d 652e  ..     datetime.
-00014e20: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
-00014e30: 6528 2232 3032 302d 3035 2d30 3120 3133  e("2020-05-01 13
-00014e40: 3a31 313a 3230 2e30 3030 222c 2022 2559  :11:20.000", "%Y
-00014e50: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
-00014e60: 2566 2229 2c0a 2020 2020 2020 2020 2e2e  %f"),.        ..
-00014e70: 2e20 2020 2020 6461 7465 7469 6d65 2e64  .     datetime.d
-00014e80: 6174 6574 696d 652e 7374 7270 7469 6d65  atetime.strptime
-00014e90: 2822 3230 3230 2d30 382d 3231 2030 313a  ("2020-08-21 01:
-00014ea0: 3330 3a30 352e 3030 3022 2c20 2225 592d  30:05.000", "%Y-
-00014eb0: 256d 2d25 6420 2548 3a25 4d3a 2553 2e25  %m-%d %H:%M:%S.%
-00014ec0: 6622 290a 2020 2020 2020 2020 2e2e 2e20  f").        ... 
-00014ed0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00014ee0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00014ef0: 7365 6c65 6374 286d 696e 7574 6528 2261  select(minute("a
-00014f00: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00014f10: 2020 2020 2020 5b52 6f77 284d 494e 5554        [Row(MINUT
-00014f20: 4528 2241 2229 3d31 3129 2c20 526f 7728  E("A")=11), Row(
-00014f30: 4d49 4e55 5445 2822 4122 293d 3330 295d  MINUTE("A")=30)]
-00014f40: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00014f50: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00014f60: 652c 2022 6d69 6e75 7465 2229 0a20 2020  e, "minute").   
-00014f70: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00014f80: 226d 696e 7574 6522 2928 6329 0a0a 0a64  "minute")(c)...d
-00014f90: 6566 206e 6578 745f 6461 7928 6461 7465  ef next_day(date
-00014fa0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00014fb0: 6461 795f 6f66 5f77 6565 6b3a 2043 6f6c  day_of_week: Col
-00014fc0: 756d 6e4f 724c 6974 6572 616c 2920 2d3e  umnOrLiteral) ->
-00014fd0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00014fe0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
-00014ff0: 2064 6174 6520 6f66 2074 6865 2066 6972   date of the fir
-00015000: 7374 2073 7065 6369 6669 6564 2044 4f57  st specified DOW
-00015010: 2028 6461 7920 6f66 2077 6565 6b29 2074   (day of week) t
-00015020: 6861 7420 6f63 6375 7273 2061 6674 6572  hat occurs after
-00015030: 2074 6865 2069 6e70 7574 2064 6174 652e   the input date.
-00015040: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00015050: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00015060: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-00015070: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00015080: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00015090: 6166 7261 6d65 285b 0a20 2020 2020 2020  aframe([.       
-000150a0: 202e 2e2e 2020 2020 2028 6461 7465 7469   ...     (dateti
-000150b0: 6d65 2e64 6174 652e 6672 6f6d 6973 6f66  me.date.fromisof
-000150c0: 6f72 6d61 7428 2232 3032 302d 3038 2d30  ormat("2020-08-0
-000150d0: 3122 292c 2022 6d6f 2229 2c0a 2020 2020  1"), "mo"),.    
-000150e0: 2020 2020 2e2e 2e20 2020 2020 2864 6174      ...     (dat
-000150f0: 6574 696d 652e 6461 7465 2e66 726f 6d69  etime.date.fromi
-00015100: 736f 666f 726d 6174 2822 3230 3230 2d31  soformat("2020-1
-00015110: 322d 3031 2229 2c20 2277 6522 292c 0a20  2-01"), "we"),. 
-00015120: 2020 2020 2020 202e 2e2e 205d 2c20 7363         ... ], sc
-00015130: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
-00015140: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00015150: 7365 6c65 6374 286e 6578 745f 6461 7928  select(next_day(
-00015160: 2261 222c 2063 6f6c 2822 6222 2929 292e  "a", col("b"))).
-00015170: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00015180: 2020 5b52 6f77 284e 4558 545f 4441 5928    [Row(NEXT_DAY(
-00015190: 2241 222c 2022 4222 293d 6461 7465 7469  "A", "B")=dateti
-000151a0: 6d65 2e64 6174 6528 3230 3230 2c20 382c  me.date(2020, 8,
-000151b0: 2033 2929 2c20 526f 7728 4e45 5854 5f44   3)), Row(NEXT_D
-000151c0: 4159 2822 4122 2c20 2242 2229 3d64 6174  AY("A", "B")=dat
-000151d0: 6574 696d 652e 6461 7465 2832 3032 302c  etime.date(2020,
-000151e0: 2031 322c 2032 2929 5d0a 2020 2020 2020   12, 2))].      
-000151f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00015200: 6e65 7874 5f64 6179 2822 6122 2c20 2266  next_day("a", "f
-00015210: 7222 2929 2e63 6f6c 6c65 6374 2829 0a20  r")).collect(). 
-00015220: 2020 2020 2020 205b 526f 7728 4e45 5854         [Row(NEXT
-00015230: 5f44 4159 2822 4122 2c20 2746 5227 293d  _DAY("A", 'FR')=
-00015240: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-00015250: 3230 2c20 382c 2037 2929 2c20 526f 7728  20, 8, 7)), Row(
-00015260: 4e45 5854 5f44 4159 2822 4122 2c20 2746  NEXT_DAY("A", 'F
-00015270: 5227 293d 6461 7465 7469 6d65 2e64 6174  R')=datetime.dat
-00015280: 6528 3230 3230 2c20 3132 2c20 3429 295d  e(2020, 12, 4))]
-00015290: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-000152a0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-000152b0: 6461 7465 2c20 226e 6578 745f 6461 7922  date, "next_day"
-000152c0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-000152d0: 6c74 696e 2822 6e65 7874 5f64 6179 2229  ltin("next_day")
-000152e0: 2863 2c20 436f 6c75 6d6e 2e5f 746f 5f65  (c, Column._to_e
-000152f0: 7870 7228 6461 795f 6f66 5f77 6565 6b29  xpr(day_of_week)
-00015300: 290a 0a0a 6465 6620 7072 6576 696f 7573  )...def previous
-00015310: 5f64 6179 2864 6174 653a 2043 6f6c 756d  _day(date: Colum
-00015320: 6e4f 724e 616d 652c 2064 6179 5f6f 665f  nOrName, day_of_
-00015330: 7765 656b 3a20 436f 6c75 6d6e 4f72 4c69  week: ColumnOrLi
-00015340: 7465 7261 6c29 202d 3e20 436f 6c75 6d6e  teral) -> Column
-00015350: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00015360: 7475 726e 7320 7468 6520 6461 7465 206f  turns the date o
-00015370: 6620 7468 6520 6669 7273 7420 7370 6563  f the first spec
-00015380: 6966 6965 6420 444f 5720 2864 6179 206f  ified DOW (day o
-00015390: 6620 7765 656b 2920 7468 6174 206f 6363  f week) that occ
-000153a0: 7572 7320 6265 666f 7265 2074 6865 2069  urs before the i
-000153b0: 6e70 7574 2064 6174 652e 0a0a 2020 2020  nput date...    
-000153c0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000153d0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-000153e0: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-000153f0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00015400: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00015410: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
-00015420: 2020 2028 6461 7465 7469 6d65 2e64 6174     (datetime.dat
-00015430: 652e 6672 6f6d 6973 6f66 6f72 6d61 7428  e.fromisoformat(
-00015440: 2232 3032 302d 3038 2d30 3122 292c 2022  "2020-08-01"), "
-00015450: 6d6f 2229 2c0a 2020 2020 2020 2020 2e2e  mo"),.        ..
-00015460: 2e20 2020 2020 2864 6174 6574 696d 652e  .     (datetime.
-00015470: 6461 7465 2e66 726f 6d69 736f 666f 726d  date.fromisoform
-00015480: 6174 2822 3230 3230 2d31 322d 3031 2229  at("2020-12-01")
-00015490: 2c20 2277 6522 292c 0a20 2020 2020 2020  , "we"),.       
-000154a0: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
-000154b0: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-000154c0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000154d0: 2870 7265 7669 6f75 735f 6461 7928 2261  (previous_day("a
-000154e0: 222c 2063 6f6c 2822 6222 2929 292e 636f  ", col("b"))).co
-000154f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00015500: 5b52 6f77 2850 5245 5649 4f55 535f 4441  [Row(PREVIOUS_DA
-00015510: 5928 2241 222c 2022 4222 293d 6461 7465  Y("A", "B")=date
-00015520: 7469 6d65 2e64 6174 6528 3230 3230 2c20  time.date(2020, 
-00015530: 372c 2032 3729 292c 2052 6f77 2850 5245  7, 27)), Row(PRE
-00015540: 5649 4f55 535f 4441 5928 2241 222c 2022  VIOUS_DAY("A", "
-00015550: 4222 293d 6461 7465 7469 6d65 2e64 6174  B")=datetime.dat
-00015560: 6528 3230 3230 2c20 3131 2c20 3235 2929  e(2020, 11, 25))
-00015570: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-00015580: 2e73 656c 6563 7428 7072 6576 696f 7573  .select(previous
-00015590: 5f64 6179 2822 6122 2c20 2266 7222 2929  _day("a", "fr"))
-000155a0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000155b0: 2020 205b 526f 7728 5052 4556 494f 5553     [Row(PREVIOUS
-000155c0: 5f44 4159 2822 4122 2c20 2746 5227 293d  _DAY("A", 'FR')=
-000155d0: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-000155e0: 3230 2c20 372c 2033 3129 292c 2052 6f77  20, 7, 31)), Row
-000155f0: 2850 5245 5649 4f55 535f 4441 5928 2241  (PREVIOUS_DAY("A
-00015600: 222c 2027 4652 2729 3d64 6174 6574 696d  ", 'FR')=datetim
-00015610: 652e 6461 7465 2832 3032 302c 2031 312c  e.date(2020, 11,
-00015620: 2032 3729 295d 0a20 2020 2022 2222 0a20   27))].    """. 
-00015630: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00015640: 665f 7374 7228 6461 7465 2c20 2270 7265  f_str(date, "pre
-00015650: 7669 6f75 735f 6461 7922 290a 2020 2020  vious_day").    
-00015660: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00015670: 7072 6576 696f 7573 5f64 6179 2229 2863  previous_day")(c
-00015680: 2c20 436f 6c75 6d6e 2e5f 746f 5f65 7870  , Column._to_exp
-00015690: 7228 6461 795f 6f66 5f77 6565 6b29 290a  r(day_of_week)).
-000156a0: 0a0a 6465 6620 7365 636f 6e64 2865 3a20  ..def second(e: 
-000156b0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-000156c0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000156d0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
-000156e0: 6520 7365 636f 6e64 2066 726f 6d20 6120  e second from a 
-000156f0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
-00015700: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-00015710: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-00015720: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-00015730: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00015740: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00015750: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
-00015760: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
-00015770: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-00015780: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
-00015790: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
-000157a0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-000157b0: 3a25 532e 2566 2229 2c0a 2020 2020 2020  :%S.%f"),.      
-000157c0: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
-000157d0: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-000157e0: 7469 6d65 2822 3230 3230 2d30 382d 3231  time("2020-08-21
-000157f0: 2030 313a 3330 3a30 352e 3030 3022 2c20   01:30:05.000", 
-00015800: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-00015810: 2553 2e25 6622 290a 2020 2020 2020 2020  %S.%f").        
-00015820: 2e2e 2e20 5d2c 2073 6368 656d 613d 5b22  ... ], schema=["
-00015830: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00015840: 2064 662e 7365 6c65 6374 2873 6563 6f6e   df.select(secon
-00015850: 6428 2261 2229 292e 636f 6c6c 6563 7428  d("a")).collect(
-00015860: 290a 2020 2020 2020 2020 5b52 6f77 2853  ).        [Row(S
-00015870: 4543 4f4e 4428 2241 2229 3d32 3029 2c20  ECOND("A")=20), 
-00015880: 526f 7728 5345 434f 4e44 2822 4122 293d  Row(SECOND("A")=
-00015890: 3529 5d0a 2020 2020 2222 220a 2020 2020  5)].    """.    
-000158a0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-000158b0: 7472 2865 2c20 2273 6563 6f6e 6422 290a  tr(e, "second").
-000158c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000158d0: 696e 2822 7365 636f 6e64 2229 2863 290a  in("second")(c).
-000158e0: 0a0a 6465 6620 6d6f 6e74 6828 653a 2043  ..def month(e: C
-000158f0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00015900: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00015910: 2020 2020 4578 7472 6163 7473 2074 6865      Extracts the
-00015920: 206d 6f6e 7468 2066 726f 6d20 6120 6461   month from a da
-00015930: 7465 206f 7220 7469 6d65 7374 616d 702e  te or timestamp.
-00015940: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00015950: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00015960: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-00015970: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00015980: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00015990: 6166 7261 6d65 285b 0a20 2020 2020 2020  aframe([.       
-000159a0: 202e 2e2e 2020 2020 2064 6174 6574 696d   ...     datetim
-000159b0: 652e 6461 7465 7469 6d65 2e73 7472 7074  e.datetime.strpt
-000159c0: 696d 6528 2232 3032 302d 3035 2d30 3120  ime("2020-05-01 
-000159d0: 3133 3a31 313a 3230 2e30 3030 222c 2022  13:11:20.000", "
-000159e0: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
-000159f0: 532e 2566 2229 2c0a 2020 2020 2020 2020  S.%f"),.        
-00015a00: 2e2e 2e20 2020 2020 6461 7465 7469 6d65  ...     datetime
-00015a10: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
-00015a20: 6d65 2822 3230 3230 2d30 382d 3231 2030  me("2020-08-21 0
-00015a30: 313a 3330 3a30 352e 3030 3022 2c20 2225  1:30:05.000", "%
-00015a40: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-00015a50: 2e25 6622 290a 2020 2020 2020 2020 2e2e  .%f").        ..
-00015a60: 2e20 5d2c 2073 6368 656d 613d 5b22 6122  . ], schema=["a"
-00015a70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00015a80: 662e 7365 6c65 6374 286d 6f6e 7468 2822  f.select(month("
-00015a90: 6122 2929 2e63 6f6c 6c65 6374 2829 0a20  a")).collect(). 
-00015aa0: 2020 2020 2020 205b 526f 7728 4d4f 4e54         [Row(MONT
-00015ab0: 4828 2241 2229 3d35 292c 2052 6f77 284d  H("A")=5), Row(M
-00015ac0: 4f4e 5448 2822 4122 293d 3829 5d0a 2020  ONTH("A")=8)].  
-00015ad0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00015ae0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00015af0: 226d 6f6e 7468 2229 0a20 2020 2072 6574  "month").    ret
-00015b00: 7572 6e20 6275 696c 7469 6e28 226d 6f6e  urn builtin("mon
-00015b10: 7468 2229 2863 290a 0a0a 6465 6620 6d6f  th")(c)...def mo
-00015b20: 6e74 686e 616d 6528 653a 2043 6f6c 756d  nthname(e: Colum
-00015b30: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00015b40: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00015b50: 4578 7472 6163 7473 2074 6865 2074 6872  Extracts the thr
-00015b60: 6565 2d6c 6574 7465 7220 6d6f 6e74 6820  ee-letter month 
-00015b70: 6e61 6d65 2066 726f 6d20 7468 6520 7370  name from the sp
-00015b80: 6563 6966 6965 6420 6461 7465 206f 7220  ecified date or 
-00015b90: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
-00015ba0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00015bb0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00015bc0: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-00015bd0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00015be0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00015bf0: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
-00015c00: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
-00015c10: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
-00015c20: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
-00015c30: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
-00015c40: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
-00015c50: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00015c60: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
-00015c70: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
-00015c80: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
-00015c90: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
-00015ca0: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
-00015cb0: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
-00015cc0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00015cd0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00015ce0: 6374 286d 6f6e 7468 6e61 6d65 2822 6122  ct(monthname("a"
-00015cf0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00015d00: 2020 2020 205b 526f 7728 4d4f 4e54 484e       [Row(MONTHN
-00015d10: 414d 4528 2241 2229 3d27 4d61 7927 292c  AME("A")='May'),
-00015d20: 2052 6f77 284d 4f4e 5448 4e41 4d45 2822   Row(MONTHNAME("
-00015d30: 4122 293d 2741 7567 2729 5d0a 2020 2020  A")='Aug')].    
-00015d40: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00015d50: 636f 6c5f 6966 5f73 7472 2865 2c20 226d  col_if_str(e, "m
-00015d60: 6f6e 7468 6e61 6d65 2229 0a20 2020 2072  onthname").    r
-00015d70: 6574 7572 6e20 6275 696c 7469 6e28 226d  eturn builtin("m
-00015d80: 6f6e 7468 6e61 6d65 2229 2863 290a 0a0a  onthname")(c)...
-00015d90: 6465 6620 7175 6172 7465 7228 653a 2043  def quarter(e: C
-00015da0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00015db0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00015dc0: 2020 2020 4578 7472 6163 7473 2074 6865      Extracts the
-00015dd0: 2071 7561 7274 6572 2066 726f 6d20 6120   quarter from a 
-00015de0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
-00015df0: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-00015e00: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-00015e10: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-00015e20: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00015e30: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00015e40: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
-00015e50: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
-00015e60: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-00015e70: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
-00015e80: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
-00015e90: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-00015ea0: 3a25 532e 2566 2229 2c0a 2020 2020 2020  :%S.%f"),.      
-00015eb0: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
-00015ec0: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-00015ed0: 7469 6d65 2822 3230 3230 2d30 382d 3231  time("2020-08-21
-00015ee0: 2030 313a 3330 3a30 352e 3030 3022 2c20   01:30:05.000", 
-00015ef0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-00015f00: 2553 2e25 6622 290a 2020 2020 2020 2020  %S.%f").        
-00015f10: 2e2e 2e20 5d2c 2073 6368 656d 613d 5b22  ... ], schema=["
-00015f20: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00015f30: 2064 662e 7365 6c65 6374 2871 7561 7274   df.select(quart
-00015f40: 6572 2822 6122 2929 2e63 6f6c 6c65 6374  er("a")).collect
-00015f50: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00015f60: 5155 4152 5445 5228 2241 2229 3d32 292c  QUARTER("A")=2),
-00015f70: 2052 6f77 2851 5541 5254 4552 2822 4122   Row(QUARTER("A"
-00015f80: 293d 3329 5d0a 2020 2020 2222 220a 2020  )=3)].    """.  
-00015f90: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00015fa0: 5f73 7472 2865 2c20 2271 7561 7274 6572  _str(e, "quarter
-00015fb0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00015fc0: 696c 7469 6e28 2271 7561 7274 6572 2229  iltin("quarter")
-00015fd0: 2863 290a 0a0a 6465 6620 7965 6172 2865  (c)...def year(e
-00015fe0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00015ff0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00016000: 2222 0a20 2020 2045 7874 7261 6374 7320  "".    Extracts 
-00016010: 7468 6520 7965 6172 2066 726f 6d20 6120  the year from a 
-00016020: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
-00016030: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-00016040: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-00016050: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-00016060: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00016070: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00016080: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
-00016090: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
-000160a0: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-000160b0: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
-000160c0: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
-000160d0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-000160e0: 3a25 532e 2566 2229 2c0a 2020 2020 2020  :%S.%f"),.      
-000160f0: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
-00016100: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-00016110: 7469 6d65 2822 3230 3230 2d30 382d 3231  time("2020-08-21
-00016120: 2030 313a 3330 3a30 352e 3030 3022 2c20   01:30:05.000", 
-00016130: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-00016140: 2553 2e25 6622 290a 2020 2020 2020 2020  %S.%f").        
-00016150: 2e2e 2e20 5d2c 2073 6368 656d 613d 5b22  ... ], schema=["
-00016160: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00016170: 2064 662e 7365 6c65 6374 2879 6561 7228   df.select(year(
-00016180: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
-00016190: 2020 2020 2020 2020 5b52 6f77 2859 4541          [Row(YEA
-000161a0: 5228 2241 2229 3d32 3032 3029 2c20 526f  R("A")=2020), Ro
-000161b0: 7728 5945 4152 2822 4122 293d 3230 3230  w(YEAR("A")=2020
-000161c0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-000161d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000161e0: 7228 652c 2022 7965 6172 2229 0a20 2020  r(e, "year").   
-000161f0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00016200: 2279 6561 7222 2928 6329 0a0a 0a64 6566  "year")(c)...def
-00016210: 2073 7973 6461 7465 2829 202d 3e20 436f   sysdate() -> Co
-00016220: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00016230: 2020 5265 7475 726e 7320 7468 6520 6375    Returns the cu
-00016240: 7272 656e 7420 7469 6d65 7374 616d 7020  rrent timestamp 
-00016250: 666f 7220 7468 6520 7379 7374 656d 2c20  for the system, 
-00016260: 6275 7420 696e 2074 6865 2055 5443 2074  but in the UTC t
-00016270: 696d 6520 7a6f 6e65 2e0a 0a20 2020 2045  ime zone...    E
-00016280: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00016290: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000162a0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000162b0: 616d 6528 5b31 5d2c 2073 6368 656d 613d  ame([1], schema=
-000162c0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-000162d0: 3e3e 2064 662e 7365 6c65 6374 2873 7973  >> df.select(sys
-000162e0: 6461 7465 2829 292e 636f 6c6c 6563 7428  date()).collect(
-000162f0: 2920 6973 206e 6f74 204e 6f6e 650a 2020  ) is not None.  
-00016300: 2020 2020 2020 5472 7565 0a20 2020 2022        True.    "
-00016310: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00016320: 696c 7469 6e28 2273 7973 6461 7465 2229  iltin("sysdate")
-00016330: 2829 0a0a 0a64 6566 206d 6f6e 7468 735f  ()...def months_
-00016340: 6265 7477 6565 6e28 6461 7465 313a 2043  between(date1: C
-00016350: 6f6c 756d 6e4f 724e 616d 652c 2064 6174  olumnOrName, dat
-00016360: 6532 3a20 436f 6c75 6d6e 4f72 4e61 6d65  e2: ColumnOrName
-00016370: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00016380: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-00016390: 2074 6865 206e 756d 6265 7220 6f66 206d   the number of m
-000163a0: 6f6e 7468 7320 6265 7477 6565 6e20 7477  onths between tw
-000163b0: 6f20 4441 5445 206f 7220 5449 4d45 5354  o DATE or TIMEST
-000163c0: 414d 5020 7661 6c75 6573 2e0a 0a20 2020  AMP values...   
-000163d0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-000163e0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-000163f0: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-00016400: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00016410: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00016420: 6528 5b5b 0a20 2020 2020 2020 202e 2e2e  e([[.        ...
-00016430: 2020 2020 2064 6174 6574 696d 652e 6461       datetime.da
-00016440: 7465 7469 6d65 2e73 7472 7074 696d 6528  tetime.strptime(
-00016450: 2232 3032 302d 3035 2d30 3120 3133 3a31  "2020-05-01 13:1
-00016460: 313a 3230 2e30 3030 222c 2022 2559 2d25  1:20.000", "%Y-%
-00016470: 6d2d 2564 2025 483a 254d 3a25 532e 2566  m-%d %H:%M:%S.%f
-00016480: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
-00016490: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
-000164a0: 6574 696d 652e 7374 7270 7469 6d65 2822  etime.strptime("
-000164b0: 3230 3230 2d30 382d 3231 2030 313a 3330  2020-08-21 01:30
-000164c0: 3a30 352e 3030 3022 2c20 2225 592d 256d  :05.000", "%Y-%m
-000164d0: 2d25 6420 2548 3a25 4d3a 2553 2e25 6622  -%d %H:%M:%S.%f"
-000164e0: 290a 2020 2020 2020 2020 2e2e 2e20 5d5d  ).        ... ]]
-000164f0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-00016500: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
-00016510: 2064 662e 7365 6c65 6374 286d 6f6e 7468   df.select(month
-00016520: 735f 6265 7477 6565 6e28 2261 222c 2022  s_between("a", "
-00016530: 6222 2929 2e63 6f6c 6c65 6374 2829 0a20  b")).collect(). 
-00016540: 2020 2020 2020 205b 526f 7728 4d4f 4e54         [Row(MONT
-00016550: 4853 5f42 4554 5745 454e 2822 4122 2c20  HS_BETWEEN("A", 
-00016560: 2242 2229 3d44 6563 696d 616c 2827 2d33  "B")=Decimal('-3
-00016570: 2e36 3239 3435 3227 2929 5d0a 2020 2020  .629452'))].    
-00016580: 2222 220a 2020 2020 6331 203d 205f 746f  """.    c1 = _to
-00016590: 5f63 6f6c 5f69 665f 7374 7228 6461 7465  _col_if_str(date
-000165a0: 312c 2022 6d6f 6e74 6873 5f62 6574 7765  1, "months_betwe
-000165b0: 656e 2229 0a20 2020 2063 3220 3d20 5f74  en").    c2 = _t
-000165c0: 6f5f 636f 6c5f 6966 5f73 7472 2864 6174  o_col_if_str(dat
-000165d0: 6532 2c20 226d 6f6e 7468 735f 6265 7477  e2, "months_betw
-000165e0: 6565 6e22 290a 2020 2020 7265 7475 726e  een").    return
-000165f0: 2062 7569 6c74 696e 2822 6d6f 6e74 6873   builtin("months
-00016600: 5f62 6574 7765 656e 2229 2863 312c 2063  _between")(c1, c
-00016610: 3229 0a0a 0a64 6566 2074 6f5f 6765 6f67  2)...def to_geog
-00016620: 7261 7068 7928 653a 2043 6f6c 756d 6e4f  raphy(e: ColumnO
-00016630: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00016640: 3a0a 2020 2020 2222 2250 6172 7365 7320  :.    """Parses 
-00016650: 616e 2069 6e70 7574 2061 6e64 2072 6574  an input and ret
-00016660: 7572 6e73 2061 2076 616c 7565 206f 6620  urns a value of 
-00016670: 7479 7065 2047 454f 4752 4150 4859 2e20  type GEOGRAPHY. 
-00016680: 5375 7070 6f72 7465 6420 696e 7075 7473  Supported inputs
-00016690: 2061 7265 2073 7472 696e 6773 2069 6e0a   are strings in.
-000166a0: 0a20 2020 2020 2020 202d 2057 4b54 2028  .        - WKT (
-000166b0: 7765 6c6c 2d6b 6e6f 776e 2074 6578 7429  well-known text)
-000166c0: 2e0a 2020 2020 2020 2020 2d20 574b 4220  ..        - WKB 
-000166d0: 2877 656c 6c2d 6b6e 6f77 6e20 6269 6e61  (well-known bina
-000166e0: 7279 2920 696e 2068 6578 6164 6563 696d  ry) in hexadecim
-000166f0: 616c 2066 6f72 6d61 7420 2877 6974 686f  al format (witho
-00016700: 7574 2061 206c 6561 6469 6e67 2030 7829  ut a leading 0x)
-00016710: 2e0a 2020 2020 2020 2020 2d20 4557 4b54  ..        - EWKT
-00016720: 2028 6578 7465 6e64 6564 2077 656c 6c2d   (extended well-
-00016730: 6b6e 6f77 6e20 7465 7874 292e 0a20 2020  known text)..   
-00016740: 2020 2020 202d 2045 574b 4220 2865 7874       - EWKB (ext
-00016750: 656e 6465 6420 7765 6c6c 2d6b 6e6f 776e  ended well-known
-00016760: 2062 696e 6172 7929 2069 6e20 6865 7861   binary) in hexa
-00016770: 6465 6369 6d61 6c20 666f 726d 6174 2028  decimal format (
-00016780: 7769 7468 6f75 7420 6120 6c65 6164 696e  without a leadin
-00016790: 6720 3078 292e 0a20 2020 2020 2020 202d  g 0x)..        -
-000167a0: 2047 656f 4a53 4f4e 2e0a 0a20 2020 2066   GeoJSON...    f
-000167b0: 6f72 6d61 742e 0a0a 2020 2020 4578 616d  ormat...    Exam
-000167c0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-000167d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000167e0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000167f0: 5b27 504f 494e 5428 2d31 3232 2e33 3520  ['POINT(-122.35 
-00016800: 3337 2e35 3529 272c 2027 504f 494e 5428  37.55)', 'POINT(
-00016810: 3230 2e39 3220 3433 2e33 3329 275d 2c20  20.92 43.33)'], 
-00016820: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
-00016830: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00016840: 6563 7428 746f 5f67 656f 6772 6170 6879  ect(to_geography
-00016850: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
-00016860: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00016870: 6f77 2854 4f5f 4745 4f47 5241 5048 5928  ow(TO_GEOGRAPHY(
-00016880: 2241 2229 3d27 7b5c 5c6e 2020 2263 6f6f  "A")='{\\n  "coo
-00016890: 7264 696e 6174 6573 223a 205b 5c5c 6e20  rdinates": [\\n 
-000168a0: 2020 202d 3132 322e 3335 2c5c 5c6e 2020     -122.35,\\n  
-000168b0: 2020 3337 2e35 355c 5c6e 2020 5d2c 5c5c    37.55\\n  ],\\
-000168c0: 6e20 2022 7479 7065 223a 2022 506f 696e  n  "type": "Poin
-000168d0: 7422 5c5c 6e7d 2729 2c20 526f 7728 544f  t"\\n}'), Row(TO
-000168e0: 5f47 454f 4752 4150 4859 2822 4122 293d  _GEOGRAPHY("A")=
-000168f0: 277b 5c5c 6e20 2022 636f 6f72 6469 6e61  '{\\n  "coordina
-00016900: 7465 7322 3a20 5b5c 5c6e 2020 2020 3230  tes": [\\n    20
-00016910: 2e39 322c 5c5c 6e20 2020 2034 332e 3333  .92,\\n    43.33
-00016920: 5c5c 6e20 205d 2c5c 5c6e 2020 2274 7970  \\n  ],\\n  "typ
-00016930: 6522 3a20 2250 6f69 6e74 225c 5c6e 7d27  e": "Point"\\n}'
-00016940: 295d 0a0a 2020 2020 4265 7369 6465 7320  )]..    Besides 
-00016950: 7374 7269 6e67 732c 2062 696e 6172 7920  strings, binary 
-00016960: 7265 7072 6573 656e 7461 7469 6f6e 2069  representation i
-00016970: 6e20 574b 4220 616e 6420 4557 4b42 2066  n WKB and EWKB f
-00016980: 6f72 6d61 7420 6361 6e20 6265 2070 6172  ormat can be par
-00016990: 7365 642c 206f 7220 6f62 6a65 6374 7320  sed, or objects 
-000169a0: 6164 6865 7269 6e67 2074 6f20 4765 6f4a  adhering to GeoJ
-000169b0: 534f 4e20 666f 726d 6174 2e0a 2020 2020  SON format..    
-000169c0: 466f 7220 616c 6c20 7375 7070 6f72 7465  For all supporte
-000169d0: 6420 666f 726d 6174 7320 636f 6e66 6572  d formats confer
-000169e0: 2068 7474 7073 3a2f 2f64 6f63 732e 736e   https://docs.sn
-000169f0: 6f77 666c 616b 652e 636f 6d2f 656e 2f73  owflake.com/en/s
-00016a00: 716c 2d72 6566 6572 656e 6365 2f64 6174  ql-reference/dat
-00016a10: 612d 7479 7065 732d 6765 6f73 7061 7469  a-types-geospati
-00016a20: 616c 2373 7570 706f 7274 6564 2d67 656f  al#supported-geo
-00016a30: 7370 6174 6961 6c2d 6f62 6a65 6374 2d74  spatial-object-t
-00016a40: 7970 6573 2e0a 2020 2020 2222 220a 2020  ypes..    """.  
-00016a50: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00016a60: 5f73 7472 2865 2c20 2274 6f5f 6765 6f67  _str(e, "to_geog
-00016a70: 7261 7068 7922 290a 2020 2020 7265 7475  raphy").    retu
-00016a80: 726e 2062 7569 6c74 696e 2822 746f 5f67  rn builtin("to_g
-00016a90: 656f 6772 6170 6879 2229 2863 290a 0a0a  eography")(c)...
-00016aa0: 6465 6620 6172 7261 7973 5f6f 7665 726c  def arrays_overl
-00016ab0: 6170 2861 7272 6179 313a 2043 6f6c 756d  ap(array1: Colum
-00016ac0: 6e4f 724e 616d 652c 2061 7272 6179 323a  nOrName, array2:
-00016ad0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00016ae0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00016af0: 2243 6f6d 7061 7265 7320 7768 6574 6865  "Compares whethe
-00016b00: 7220 7477 6f20 4152 5241 5973 2068 6176  r two ARRAYs hav
-00016b10: 6520 6174 206c 6561 7374 206f 6e65 2065  e at least one e
-00016b20: 6c65 6d65 6e74 2069 6e20 636f 6d6d 6f6e  lement in common
-00016b30: 2e20 5265 7475 726e 7320 5452 5545 0a20  . Returns TRUE. 
-00016b40: 2020 2069 6620 7468 6572 6520 6973 2061     if there is a
-00016b50: 7420 6c65 6173 7420 6f6e 6520 656c 656d  t least one elem
-00016b60: 656e 7420 696e 2063 6f6d 6d6f 6e3b 206f  ent in common; o
-00016b70: 7468 6572 7769 7365 2072 6574 7572 6e73  therwise returns
-00016b80: 2046 414c 5345 2e20 5468 6520 6675 6e63   FALSE. The func
-00016b90: 7469 6f6e 0a20 2020 2069 7320 4e55 4c4c  tion.    is NULL
-00016ba0: 2d73 6166 652c 206d 6561 6e69 6e67 2069  -safe, meaning i
-00016bb0: 7420 7472 6561 7473 204e 554c 4c73 2061  t treats NULLs a
-00016bc0: 7320 6b6e 6f77 6e20 7661 6c75 6573 2066  s known values f
-00016bd0: 6f72 2063 6f6d 7061 7269 6e67 2065 7175  or comparing equ
-00016be0: 616c 6974 792e 2222 220a 2020 2020 6131  ality.""".    a1
-00016bf0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00016c00: 7228 6172 7261 7931 2c20 2261 7272 6179  r(array1, "array
-00016c10: 735f 6f76 6572 6c61 7022 290a 2020 2020  s_overlap").    
-00016c20: 6132 203d 205f 746f 5f63 6f6c 5f69 665f  a2 = _to_col_if_
-00016c30: 7374 7228 6172 7261 7932 2c20 2261 7272  str(array2, "arr
-00016c40: 6179 735f 6f76 6572 6c61 7022 290a 2020  ays_overlap").  
-00016c50: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00016c60: 2822 6172 7261 7973 5f6f 7665 726c 6170  ("arrays_overlap
-00016c70: 2229 2861 312c 2061 3229 0a0a 0a64 6566  ")(a1, a2)...def
-00016c80: 2061 7272 6179 5f69 6e74 6572 7365 6374   array_intersect
-00016c90: 696f 6e28 6172 7261 7931 3a20 436f 6c75  ion(array1: Colu
-00016ca0: 6d6e 4f72 4e61 6d65 2c20 6172 7261 7932  mnOrName, array2
-00016cb0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00016cc0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00016cd0: 2222 5265 7475 726e 7320 616e 2061 7272  ""Returns an arr
-00016ce0: 6179 2074 6861 7420 636f 6e74 6169 6e73  ay that contains
-00016cf0: 2074 6865 206d 6174 6368 696e 6720 656c   the matching el
-00016d00: 656d 656e 7473 2069 6e20 7468 6520 7477  ements in the tw
-00016d10: 6f20 696e 7075 7420 6172 7261 7973 2e0a  o input arrays..
-00016d20: 0a20 2020 2054 6865 2066 756e 6374 696f  .    The functio
-00016d30: 6e20 6973 204e 554c 4c2d 7361 6665 2c20  n is NULL-safe, 
-00016d40: 6d65 616e 696e 6720 6974 2074 7265 6174  meaning it treat
-00016d50: 7320 4e55 4c4c 7320 6173 206b 6e6f 776e  s NULLs as known
-00016d60: 2076 616c 7565 7320 666f 7220 636f 6d70   values for comp
-00016d70: 6172 696e 6720 6571 7561 6c69 7479 2e0a  aring equality..
-00016d80: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00016d90: 2020 2061 7272 6179 313a 2041 6e20 4152     array1: An AR
-00016da0: 5241 5920 7468 6174 2063 6f6e 7461 696e  RAY that contain
-00016db0: 7320 656c 656d 656e 7473 2074 6f20 6265  s elements to be
-00016dc0: 2063 6f6d 7061 7265 642e 0a20 2020 2020   compared..     
-00016dd0: 2020 2061 7272 6179 323a 2041 6e20 4152     array2: An AR
-00016de0: 5241 5920 7468 6174 2063 6f6e 7461 696e  RAY that contain
-00016df0: 7320 656c 656d 656e 7473 2074 6f20 6265  s elements to be
-00016e00: 2063 6f6d 7061 7265 642e 2222 220a 2020   compared.""".  
-00016e10: 2020 6131 203d 205f 746f 5f63 6f6c 5f69    a1 = _to_col_i
-00016e20: 665f 7374 7228 6172 7261 7931 2c20 2261  f_str(array1, "a
-00016e30: 7272 6179 5f69 6e74 6572 7365 6374 696f  rray_intersectio
-00016e40: 6e22 290a 2020 2020 6132 203d 205f 746f  n").    a2 = _to
-00016e50: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
-00016e60: 7932 2c20 2261 7272 6179 5f69 6e74 6572  y2, "array_inter
-00016e70: 7365 6374 696f 6e22 290a 2020 2020 7265  section").    re
-00016e80: 7475 726e 2062 7569 6c74 696e 2822 6172  turn builtin("ar
-00016e90: 7261 795f 696e 7465 7273 6563 7469 6f6e  ray_intersection
-00016ea0: 2229 2861 312c 2061 3229 0a0a 0a64 6566  ")(a1, a2)...def
-00016eb0: 2064 6174 6564 6966 6628 7061 7274 3a20   datediff(part: 
-00016ec0: 7374 722c 2063 6f6c 313a 2043 6f6c 756d  str, col1: Colum
-00016ed0: 6e4f 724e 616d 652c 2063 6f6c 323a 2043  nOrName, col2: C
-00016ee0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00016ef0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-00016f00: 616c 6375 6c61 7465 7320 7468 6520 6469  alculates the di
-00016f10: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
-00016f20: 2074 776f 2064 6174 652c 2074 696d 652c   two date, time,
-00016f30: 206f 7220 7469 6d65 7374 616d 7020 636f   or timestamp co
-00016f40: 6c75 6d6e 7320 6261 7365 6420 6f6e 2074  lumns based on t
-00016f50: 6865 2064 6174 6520 6f72 2074 696d 6520  he date or time 
-00016f60: 7061 7274 2072 6571 7565 7374 6564 2e0a  part requested..
-00016f70: 0a20 2020 2060 5375 7070 6f72 7465 6420  .    `Supported 
-00016f80: 6461 7465 2061 6e64 2074 696d 6520 7061  date and time pa
-00016f90: 7274 7320 3c68 7474 7073 3a2f 2f64 6f63  rts <https://doc
-00016fa0: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
-00016fb0: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
-00016fc0: 2f66 756e 6374 696f 6e73 2d64 6174 652d  /functions-date-
-00016fd0: 7469 6d65 2e68 746d 6c23 6c61 6265 6c2d  time.html#label-
-00016fe0: 7375 7070 6f72 7465 642d 6461 7465 2d74  supported-date-t
-00016ff0: 696d 652d 7061 7274 733e 605f 0a0a 2020  ime-parts>`_..  
-00017000: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-00017010: 2020 2020 203e 3e3e 2023 2079 6561 7220       >>> # year 
-00017020: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
-00017030: 656e 2074 776f 2064 6174 6520 636f 6c75  en two date colu
-00017040: 6d6e 730a 2020 2020 2020 2020 3e3e 3e20  mns.        >>> 
-00017050: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-00017060: 2020 2020 2020 2020 3e3e 3e20 6461 7465          >>> date
-00017070: 5f64 6620 3d20 7365 7373 696f 6e2e 6372  _df = session.cr
-00017080: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00017090: 5b64 6174 6574 696d 652e 6461 7465 2832  [datetime.date(2
-000170a0: 3032 302c 2031 2c20 3129 2c20 6461 7465  020, 1, 1), date
-000170b0: 7469 6d65 2e64 6174 6528 3230 3231 2c20  time.date(2021, 
-000170c0: 312c 2031 295d 5d2c 2073 6368 656d 613d  1, 1)]], schema=
-000170d0: 5b22 6461 7465 5f63 6f6c 3122 2c20 2264  ["date_col1", "d
-000170e0: 6174 655f 636f 6c32 225d 290a 2020 2020  ate_col2"]).    
-000170f0: 2020 2020 3e3e 3e20 6461 7465 5f64 662e      >>> date_df.
-00017100: 7365 6c65 6374 2864 6174 6564 6966 6628  select(datediff(
-00017110: 2279 6561 7222 2c20 636f 6c28 2264 6174  "year", col("dat
-00017120: 655f 636f 6c31 2229 2c20 636f 6c28 2264  e_col1"), col("d
-00017130: 6174 655f 636f 6c32 2229 292e 616c 6961  ate_col2")).alia
-00017140: 7328 2279 6561 725f 6469 6666 2229 292e  s("year_diff")).
-00017150: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00017160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00017170: 2020 2020 2020 207c 2259 4541 525f 4449         |"YEAR_DI
-00017180: 4646 2220 207c 0a20 2020 2020 2020 202d  FF"  |.        -
-00017190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-000171a0: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
-000171b0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-000171c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00012d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00012d70: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c7b  -----.        |{
+00012d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d90: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
+00012da0: 6167 6522 3a20 3830 2c20 2020 2020 2020  age": 80,       
+00012db0: 7c0a 2020 2020 2020 2020 7c20 2022 6e61  |.        |  "na
+00012dc0: 6d65 223a 2022 426f 6222 2020 2020 7c0a  me": "Bob"    |.
+00012dd0: 2020 2020 2020 2020 7c7d 2020 2020 2020          |}      
+00012de0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00012df0: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
+00012e00: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00012e10: 2020 2020 7c20 2022 6167 6522 3a20 6e75      |  "age": nu
+00012e20: 6c6c 2c20 2020 2020 7c0a 2020 2020 2020  ll,     |.      
+00012e30: 2020 7c20 2022 6e61 6d65 223a 2022 416c    |  "name": "Al
+00012e40: 6963 6522 2020 7c0a 2020 2020 2020 2020  ice"  |.        
+00012e50: 7c7d 2020 2020 2020 2020 2020 2020 2020  |}              
+00012e60: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00012e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00012e80: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00012e90: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00012ea0: 0a20 2020 2064 6566 2066 6c61 7474 656e  .    def flatten
+00012eb0: 5f63 6f6c 5f6c 6973 7428 6f62 6a29 3a0a  _col_list(obj):.
+00012ec0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00012ed0: 7461 6e63 6528 6f62 6a2c 2073 7472 2920  tance(obj, str) 
+00012ee0: 6f72 2069 7369 6e73 7461 6e63 6528 6f62  or isinstance(ob
+00012ef0: 6a2c 2043 6f6c 756d 6e29 3a0a 2020 2020  j, Column):.    
+00012f00: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00012f10: 6f62 6a5d 0a20 2020 2020 2020 2065 6c69  obj].        eli
+00012f20: 6620 6861 7361 7474 7228 6f62 6a2c 2022  f hasattr(obj, "
+00012f30: 5f5f 6974 6572 5f5f 2229 3a0a 2020 2020  __iter__"):.    
+00012f40: 2020 2020 2020 2020 6163 6320 3d20 5b5d          acc = []
+00012f50: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00012f60: 2069 6e6e 6572 4f62 6a20 696e 206f 626a   innerObj in obj
+00012f70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00012f80: 2020 6163 6320 3d20 6163 6320 2b20 666c    acc = acc + fl
+00012f90: 6174 7465 6e5f 636f 6c5f 6c69 7374 2869  atten_col_list(i
+00012fa0: 6e6e 6572 4f62 6a29 0a20 2020 2020 2020  nnerObj).       
+00012fb0: 2020 2020 2072 6574 7572 6e20 6163 630a       return acc.
+00012fc0: 0a20 2020 206e 6577 5f63 6f6c 7320 3d20  .    new_cols = 
+00012fd0: 5b5d 0a20 2020 2066 6f72 2063 2069 6e20  [].    for c in 
+00012fe0: 666c 6174 7465 6e5f 636f 6c5f 6c69 7374  flatten_col_list
+00012ff0: 2863 6f6c 7329 3a0a 2020 2020 2020 2020  (cols):.        
+00013000: 2320 6669 7273 7420 696e 7365 7274 2066  # first insert f
+00013010: 6965 6c64 5f6e 616d 650a 2020 2020 2020  ield_name.      
+00013020: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00013030: 632c 2073 7472 293a 0a20 2020 2020 2020  c, str):.       
+00013040: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
+00013050: 7065 6e64 286c 6974 2863 2929 0a20 2020  pend(lit(c)).   
+00013060: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00013070: 2020 2020 2020 206e 616d 6520 3d20 632e         name = c.
+00013080: 5f65 7870 7265 7373 696f 6e2e 6e61 6d65  _expression.name
+00013090: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+000130a0: 6520 3d20 6e61 6d65 5b31 3a5d 2069 6620  e = name[1:] if 
+000130b0: 6e61 6d65 2e73 7461 7274 7377 6974 6828  name.startswith(
+000130c0: 2722 2729 2065 6c73 6520 6e61 6d65 0a20  '"') else name. 
+000130d0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+000130e0: 3d20 6e61 6d65 5b3a 2d31 5d20 6966 206e  = name[:-1] if n
+000130f0: 616d 652e 656e 6473 7769 7468 2827 2227  ame.endswith('"'
+00013100: 2920 656c 7365 206e 616d 650a 2020 2020  ) else name.    
+00013110: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
+00013120: 2e61 7070 656e 6428 6c69 7428 6e61 6d65  .append(lit(name
+00013130: 2929 0a20 2020 2020 2020 2023 206e 6578  )).        # nex
+00013140: 7420 696e 7365 7274 2066 6965 6c64 2076  t insert field v
+00013150: 616c 7565 0a20 2020 2020 2020 2063 203d  alue.        c =
+00013160: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00013170: 632c 2022 7374 7275 6374 2229 0a20 2020  c, "struct").   
+00013180: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00013190: 6365 2863 2c20 436f 6c75 6d6e 2920 616e  ce(c, Column) an
+000131a0: 6420 6973 696e 7374 616e 6365 2863 2e5f  d isinstance(c._
+000131b0: 6578 7072 6573 7369 6f6e 2c20 416c 6961  expression, Alia
+000131c0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+000131d0: 6e65 775f 636f 6c73 2e61 7070 656e 6428  new_cols.append(
+000131e0: 636f 6c28 632e 5f65 7870 7265 7373 696f  col(c._expressio
+000131f0: 6e2e 6368 696c 6472 656e 5b30 5d29 290a  n.children[0])).
+00013200: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00013210: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
+00013220: 6c73 2e61 7070 656e 6428 6329 0a20 2020  ls.append(c).   
+00013230: 2072 6574 7572 6e20 6f62 6a65 6374 5f63   return object_c
+00013240: 6f6e 7374 7275 6374 5f6b 6565 705f 6e75  onstruct_keep_nu
+00013250: 6c6c 282a 6e65 775f 636f 6c73 290a 0a0a  ll(*new_cols)...
+00013260: 6465 6620 6c6f 6728 0a20 2020 2062 6173  def log(.    bas
+00013270: 653a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  e: Union[ColumnO
+00013280: 724e 616d 652c 2069 6e74 2c20 666c 6f61  rName, int, floa
+00013290: 745d 2c20 783a 2055 6e69 6f6e 5b43 6f6c  t], x: Union[Col
+000132a0: 756d 6e4f 724e 616d 652c 2069 6e74 2c20  umnOrName, int, 
+000132b0: 666c 6f61 745d 0a29 202d 3e20 436f 6c75  float].) -> Colu
+000132c0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000132d0: 5265 7475 726e 7320 7468 6520 6c6f 6761  Returns the loga
+000132e0: 7269 7468 6d20 6f66 2061 206e 756d 6572  rithm of a numer
+000132f0: 6963 2065 7870 7265 7373 696f 6e2e 0a0a  ic expression...
+00013300: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00013310: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00013320: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00013330: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+00013340: 496e 7465 6765 7254 7970 650a 2020 2020  IntegerType.    
+00013350: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00013360: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00013370: 6672 616d 6528 5b31 2c20 3130 5d2c 2073  frame([1, 10], s
+00013380: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00013390: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+000133a0: 6374 286c 6f67 2831 302c 2064 665b 2261  ct(log(10, df["a
+000133b0: 225d 292e 6361 7374 2849 6e74 6567 6572  "]).cast(Integer
+000133c0: 5479 7065 2829 292e 616c 6961 7328 226c  Type()).alias("l
+000133d0: 6f67 2229 292e 636f 6c6c 6563 7428 290a  og")).collect().
+000133e0: 2020 2020 2020 2020 5b52 6f77 284c 4f47          [Row(LOG
+000133f0: 3d30 292c 2052 6f77 284c 4f47 3d31 295d  =0), Row(LOG=1)]
+00013400: 0a20 2020 2022 2222 0a20 2020 2062 203d  .    """.    b =
+00013410: 206c 6974 2862 6173 6529 2069 6620 6973   lit(base) if is
+00013420: 696e 7374 616e 6365 2862 6173 652c 2028  instance(base, (
+00013430: 696e 742c 2066 6c6f 6174 2929 2065 6c73  int, float)) els
+00013440: 6520 5f74 6f5f 636f 6c5f 6966 5f73 7472  e _to_col_if_str
+00013450: 2862 6173 652c 2022 6c6f 6722 290a 2020  (base, "log").  
+00013460: 2020 6172 6720 3d20 6c69 7428 7829 2069    arg = lit(x) i
+00013470: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
+00013480: 2869 6e74 2c20 666c 6f61 7429 2920 656c  (int, float)) el
+00013490: 7365 205f 746f 5f63 6f6c 5f69 665f 7374  se _to_col_if_st
+000134a0: 7228 782c 2022 6c6f 6722 290a 2020 2020  r(x, "log").    
+000134b0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+000134c0: 6c6f 6722 2928 622c 2061 7267 290a 0a0a  log")(b, arg)...
+000134d0: 6465 6620 706f 7728 0a20 2020 206c 6566  def pow(.    lef
+000134e0: 743a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  t: Union[ColumnO
+000134f0: 724e 616d 652c 2069 6e74 2c20 666c 6f61  rName, int, floa
+00013500: 745d 2c20 7269 6768 743a 2055 6e69 6f6e  t], right: Union
+00013510: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00013520: 6e74 2c20 666c 6f61 745d 0a29 202d 3e20  nt, float].) -> 
+00013530: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00013540: 6574 7572 6e73 2061 206e 756d 6265 7220  eturns a number 
+00013550: 286c 6566 7429 2072 6169 7365 6420 746f  (left) raised to
+00013560: 2074 6865 2073 7065 6369 6669 6564 2070   the specified p
+00013570: 6f77 6572 2028 7269 6768 7429 2e0a 0a20  ower (right)... 
+00013580: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00013590: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000135a0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000135b0: 6166 7261 6d65 285b 5b32 2c20 335d 2c20  aframe([[2, 3], 
+000135c0: 5b33 2c20 345d 5d2c 2073 6368 656d 613d  [3, 4]], schema=
+000135d0: 5b22 7822 2c20 2279 225d 290a 2020 2020  ["x", "y"]).    
+000135e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000135f0: 7428 706f 7728 636f 6c28 2278 2229 2c20  t(pow(col("x"), 
+00013600: 636f 6c28 2279 2229 292e 616c 6961 7328  col("y")).alias(
+00013610: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00013620: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00013630: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00013640: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+00013650: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00013660: 0a20 2020 2020 2020 207c 382e 3020 2020  .        |8.0   
+00013670: 2020 2020 7c0a 2020 2020 2020 2020 7c38      |.        |8
+00013680: 312e 3020 2020 2020 207c 0a20 2020 2020  1.0      |.     
+00013690: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000136a0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+000136b0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+000136c0: 6e75 6d62 6572 203d 2028 0a20 2020 2020  number = (.     
+000136d0: 2020 206c 6974 286c 6566 7429 2069 6620     lit(left) if 
+000136e0: 6973 696e 7374 616e 6365 286c 6566 742c  isinstance(left,
+000136f0: 2028 696e 742c 2066 6c6f 6174 2929 2065   (int, float)) e
+00013700: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
+00013710: 7472 286c 6566 742c 2022 706f 7722 290a  tr(left, "pow").
+00013720: 2020 2020 290a 2020 2020 706f 7765 7220      ).    power 
+00013730: 3d20 280a 2020 2020 2020 2020 6c69 7428  = (.        lit(
+00013740: 7269 6768 7429 2069 6620 6973 696e 7374  right) if isinst
+00013750: 616e 6365 2872 6967 6874 2c20 2869 6e74  ance(right, (int
+00013760: 2c20 666c 6f61 7429 2920 656c 7365 205f  , float)) else _
+00013770: 746f 5f63 6f6c 5f69 665f 7374 7228 7269  to_col_if_str(ri
+00013780: 6768 742c 2022 706f 7722 290a 2020 2020  ght, "pow").    
+00013790: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+000137a0: 6c74 696e 2822 706f 7722 2928 6e75 6d62  ltin("pow")(numb
+000137b0: 6572 2c20 706f 7765 7229 0a0a 0a64 6566  er, power)...def
+000137c0: 2072 6f75 6e64 2865 3a20 436f 6c75 6d6e   round(e: Column
+000137d0: 4f72 4e61 6d65 2c20 7363 616c 653a 2055  OrName, scale: U
+000137e0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+000137f0: 652c 2069 6e74 2c20 666c 6f61 745d 203d  e, int, float] =
+00013800: 2030 2920 2d3e 2043 6f6c 756d 6e3a 0a20   0) -> Column:. 
+00013810: 2020 2022 2222 5265 7475 726e 7320 726f     """Returns ro
+00013820: 756e 6465 6420 7661 6c75 6573 2066 726f  unded values fro
+00013830: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
+00013840: 636f 6c75 6d6e 2e0a 0a20 2020 2045 7861  column...    Exa
+00013850: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00013860: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00013870: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00013880: 6528 5b5b 312e 3131 5d2c 205b 322e 3232  e([[1.11], [2.22
+00013890: 5d2c 205b 332e 3333 5d5d 2c20 7363 6865  ], [3.33]], sche
+000138a0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+000138b0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000138c0: 726f 756e 6428 636f 6c28 2261 2229 292e  round(col("a")).
+000138d0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+000138e0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+000138f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00013900: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00013910: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00013920: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00013930: 312e 3020 2020 2020 2020 7c0a 2020 2020  1.0       |.    
+00013940: 2020 2020 7c32 2e30 2020 2020 2020 207c      |2.0       |
+00013950: 0a20 2020 2020 2020 207c 332e 3020 2020  .        |3.0   
+00013960: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00013970: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00013980: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00013990: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+000139a0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+000139b0: 2022 726f 756e 6422 290a 2020 2020 7363   "round").    sc
+000139c0: 616c 655f 636f 6c20 3d20 280a 2020 2020  ale_col = (.    
+000139d0: 2020 2020 6c69 7428 7363 616c 6529 0a20      lit(scale). 
+000139e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000139f0: 616e 6365 2873 6361 6c65 2c20 2869 6e74  ance(scale, (int
+00013a00: 2c20 666c 6f61 7429 290a 2020 2020 2020  , float)).      
+00013a10: 2020 656c 7365 205f 746f 5f63 6f6c 5f69    else _to_col_i
+00013a20: 665f 7374 7228 7363 616c 652c 2022 726f  f_str(scale, "ro
+00013a30: 756e 6422 290a 2020 2020 290a 2020 2020  und").    ).    
+00013a40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00013a50: 726f 756e 6422 2928 632c 2073 6361 6c65  round")(c, scale
+00013a60: 5f63 6f6c 290a 0a0a 6465 6620 7370 6c69  _col)...def spli
+00013a70: 7428 0a20 2020 2073 7472 3a20 436f 6c75  t(.    str: Colu
+00013a80: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 7061  mnOrName,.    pa
+00013a90: 7474 6572 6e3a 2043 6f6c 756d 6e4f 724e  ttern: ColumnOrN
+00013aa0: 616d 652c 0a29 202d 3e20 436f 6c75 6d6e  ame,.) -> Column
+00013ab0: 3a0a 2020 2020 2222 2253 706c 6974 7320  :.    """Splits 
+00013ac0: 6120 6769 7665 6e20 7374 7269 6e67 2077  a given string w
+00013ad0: 6974 6820 6120 6769 7665 6e20 7365 7061  ith a given sepa
+00013ae0: 7261 746f 7220 616e 6420 7265 7475 726e  rator and return
+00013af0: 7320 7468 6520 7265 7375 6c74 2069 6e20  s the result in 
+00013b00: 616e 2061 7272 6179 0a20 2020 206f 6620  an array.    of 
+00013b10: 7374 7269 6e67 732e 2054 6f20 7370 6563  strings. To spec
+00013b20: 6966 7920 6120 7374 7269 6e67 2073 6570  ify a string sep
+00013b30: 6172 6174 6f72 2c20 7573 6520 7468 6520  arator, use the 
+00013b40: 3a66 756e 633a 606c 6974 2829 6020 6675  :func:`lit()` fu
+00013b50: 6e63 7469 6f6e 2e0a 0a20 2020 2045 7861  nction...    Exa
+00013b60: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+00013b70: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00013b80: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00013b90: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+00013ba0: 2020 5b5b 226d 616e 792d 6d61 6e79 2d77    [["many-many-w
+00013bb0: 6f72 6473 222c 2022 2d22 5d2c 205b 2268  ords", "-"], ["h
+00013bc0: 656c 6c6f 2d2d 6865 6c6c 6f22 2c20 222d  ello--hello", "-
+00013bd0: 2d22 5d5d 2c0a 2020 2020 2020 2020 2e2e  -"]],.        ..
+00013be0: 2e20 2020 2020 7363 6865 6d61 3d5b 2256  .     schema=["V
+00013bf0: 222c 2022 4422 5d2c 0a20 2020 2020 2020  ", "D"],.       
+00013c00: 202e 2e2e 2029 2e73 656c 6563 7428 7370   ... ).select(sp
+00013c10: 6c69 7428 636f 6c28 2256 2229 2c20 636f  lit(col("V"), co
+00013c20: 6c28 2244 2229 2929 0a20 2020 2020 2020  l("D"))).       
+00013c30: 203e 3e3e 2064 662e 7368 6f77 2829 0a20   >>> df.show(). 
+00013c40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00013c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00013c60: 0a20 2020 2020 2020 207c 2253 504c 4954  .        |"SPLIT
+00013c70: 2822 2256 2222 2c20 2222 4422 2229 2220  (""V"", ""D"")" 
+00013c80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00013c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00013ca0: 2d2d 2d2d 0a20 2020 2020 2020 207c 5b20  ----.        |[ 
+00013cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cc0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00013cd0: 2020 226d 616e 7922 2c20 2020 2020 2020    "many",       
+00013ce0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00013cf0: 207c 2020 226d 616e 7922 2c20 2020 2020   |  "many",     
+00013d00: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00013d10: 2020 207c 2020 2277 6f72 6473 2220 2020     |  "words"   
+00013d20: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+00013d30: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
+00013d40: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+00013d50: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+00013d60: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00013d70: 0a20 2020 2020 2020 207c 2020 2268 656c  .        |  "hel
+00013d80: 6c6f 222c 2020 2020 2020 2020 2020 2020  lo",            
+00013d90: 207c 0a20 2020 2020 2020 207c 2020 2268   |.        |  "h
+00013da0: 656c 6c6f 2220 2020 2020 2020 2020 2020  ello"           
+00013db0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
+00013dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013dd0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00013de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00013df0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00013e00: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00013e10: 2022 2222 0a20 2020 2073 203d 205f 746f   """.    s = _to
+00013e20: 5f63 6f6c 5f69 665f 7374 7228 7374 722c  _col_if_str(str,
+00013e30: 2022 7370 6c69 7422 290a 2020 2020 7020   "split").    p 
+00013e40: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00013e50: 2870 6174 7465 726e 2c20 2273 706c 6974  (pattern, "split
+00013e60: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00013e70: 696c 7469 6e28 2273 706c 6974 2229 2873  iltin("split")(s
+00013e80: 2c20 7029 0a0a 0a64 6566 2073 7562 7374  , p)...def subst
+00013e90: 7269 6e67 280a 2020 2020 7374 723a 2043  ring(.    str: C
+00013ea0: 6f6c 756d 6e4f 724e 616d 652c 2070 6f73  olumnOrName, pos
+00013eb0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
+00013ec0: 696e 745d 2c20 6c65 6e3a 2055 6e69 6f6e  int], len: Union
+00013ed0: 5b43 6f6c 756d 6e2c 2069 6e74 5d0a 2920  [Column, int].) 
+00013ee0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00013ef0: 2222 5265 7475 726e 7320 7468 6520 706f  ""Returns the po
+00013f00: 7274 696f 6e20 6f66 2074 6865 2073 7472  rtion of the str
+00013f10: 696e 6720 6f72 2062 696e 6172 7920 7661  ing or binary va
+00013f20: 6c75 6520 7374 722c 2073 7461 7274 696e  lue str, startin
+00013f30: 6720 6672 6f6d 2074 6865 0a20 2020 2063  g from the.    c
+00013f40: 6861 7261 6374 6572 2f62 7974 6520 7370  haracter/byte sp
+00013f50: 6563 6966 6965 6420 6279 2070 6f73 2c20  ecified by pos, 
+00013f60: 7769 7468 206c 696d 6974 6564 206c 656e  with limited len
+00013f70: 6774 682e 2054 6865 206c 656e 6774 6820  gth. The length 
+00013f80: 7368 6f75 6c64 2062 6520 6772 6561 7465  should be greate
+00013f90: 720a 2020 2020 7468 616e 206f 7220 6571  r.    than or eq
+00013fa0: 7561 6c20 746f 207a 6572 6f2e 2049 6620  ual to zero. If 
+00013fb0: 7468 6520 6c65 6e67 7468 2069 7320 6120  the length is a 
+00013fc0: 6e65 6761 7469 7665 206e 756d 6265 722c  negative number,
+00013fd0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
+00013fe0: 7475 726e 7320 616e 0a20 2020 2065 6d70  turns an.    emp
+00013ff0: 7479 2073 7472 696e 672e 0a0a 2020 2020  ty string...    
+00014000: 4e6f 7465 3a0a 2020 2020 2020 2020 466f  Note:.        Fo
+00014010: 7220 6060 706f 7360 602c 2031 2069 7320  r ``pos``, 1 is 
+00014020: 7468 6520 6669 7273 7420 6368 6172 6163  the first charac
+00014030: 7465 7220 6f66 2074 6865 2073 7472 696e  ter of the strin
+00014040: 6720 696e 2053 6e6f 7766 6c61 6b65 2064  g in Snowflake d
+00014050: 6174 6162 6173 652e 0a0a 2020 2020 3a66  atabase...    :f
+00014060: 756e 633a 6073 7562 7374 7260 2069 7320  unc:`substr` is 
+00014070: 616e 2061 6c69 6173 206f 6620 3a66 756e  an alias of :fun
+00014080: 633a 6073 7562 7374 7269 6e67 602e 0a0a  c:`substring`...
+00014090: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+000140a0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000140b0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000140c0: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+000140d0: 202e 2e2e 2020 2020 205b 2261 6263 222c   ...     ["abc",
+000140e0: 2022 6465 6622 5d2c 0a20 2020 2020 2020   "def"],.       
+000140f0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00014100: 5b22 5322 5d2c 0a20 2020 2020 2020 202e  ["S"],.        .
+00014110: 2e2e 2029 2e73 656c 6563 7428 7375 6273  .. ).select(subs
+00014120: 7472 696e 6728 636f 6c28 2253 2229 2c20  tring(col("S"), 
+00014130: 312c 2031 2929 0a20 2020 2020 2020 203e  1, 1)).        >
+00014140: 3e3e 2064 662e 636f 6c6c 6563 7428 290a  >> df.collect().
+00014150: 2020 2020 2020 2020 5b52 6f77 2853 5542          [Row(SUB
+00014160: 5354 5249 4e47 2822 5322 2c20 312c 2031  STRING("S", 1, 1
+00014170: 293d 2761 2729 2c20 526f 7728 5355 4253  )='a'), Row(SUBS
+00014180: 5452 494e 4728 2253 222c 2031 2c20 3129  TRING("S", 1, 1)
+00014190: 3d27 6427 295d 0a20 2020 2022 2222 0a20  ='d')].    """. 
+000141a0: 2020 2073 203d 205f 746f 5f63 6f6c 5f69     s = _to_col_i
+000141b0: 665f 7374 7228 7374 722c 2022 7375 6273  f_str(str, "subs
+000141c0: 7472 696e 6722 290a 2020 2020 7020 3d20  tring").    p = 
+000141d0: 706f 7320 6966 2069 7369 6e73 7461 6e63  pos if isinstanc
+000141e0: 6528 706f 732c 2043 6f6c 756d 6e29 2065  e(pos, Column) e
+000141f0: 6c73 6520 6c69 7428 706f 7329 0a20 2020  lse lit(pos).   
+00014200: 206c 656e 6774 6820 3d20 6c65 6e20 6966   length = len if
+00014210: 2069 7369 6e73 7461 6e63 6528 6c65 6e2c   isinstance(len,
+00014220: 2043 6f6c 756d 6e29 2065 6c73 6520 6c69   Column) else li
+00014230: 7428 6c65 6e29 0a20 2020 2072 6574 7572  t(len).    retur
+00014240: 6e20 6275 696c 7469 6e28 2273 7562 7374  n builtin("subst
+00014250: 7269 6e67 2229 2873 2c20 702c 206c 656e  ring")(s, p, len
+00014260: 6774 6829 0a0a 0a64 6566 2073 7562 7374  gth)...def subst
+00014270: 7269 6e67 5f69 6e64 6578 280a 2020 2020  ring_index(.    
+00014280: 7465 7874 3a20 436f 6c75 6d6e 4f72 4e61  text: ColumnOrNa
+00014290: 6d65 2c20 6465 6c69 6d3a 2043 6f6c 756d  me, delim: Colum
+000142a0: 6e4f 724c 6974 6572 616c 5374 722c 2063  nOrLiteralStr, c
+000142b0: 6f75 6e74 3a20 696e 740a 2920 2d3e 2043  ount: int.) -> C
+000142c0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+000142d0: 2020 2052 6574 7572 6e73 2074 6865 2073     Returns the s
+000142e0: 7562 7374 7269 6e67 2066 726f 6d20 7374  ubstring from st
+000142f0: 7269 6e67 2060 6074 6578 7460 6020 6265  ring ``text`` be
+00014300: 666f 7265 2060 6063 6f75 6e74 6060 206f  fore ``count`` o
+00014310: 6363 7572 7265 6e63 6573 206f 6620 7468  ccurrences of th
+00014320: 6520 6465 6c69 6d69 7465 7220 6060 6465  e delimiter ``de
+00014330: 6c69 6d60 602e 0a20 2020 2049 6620 6060  lim``..    If ``
+00014340: 636f 756e 7460 6020 6973 2070 6f73 6974  count`` is posit
+00014350: 6976 652c 2065 7665 7279 7468 696e 6720  ive, everything 
+00014360: 746f 2074 6865 206c 6566 7420 6f66 2074  to the left of t
+00014370: 6865 2066 696e 616c 2064 656c 696d 6974  he final delimit
+00014380: 6572 2028 636f 756e 7469 6e67 2066 726f  er (counting fro
+00014390: 6d20 6c65 6674 2920 6973 0a20 2020 2072  m left) is.    r
+000143a0: 6574 7572 6e65 642e 2049 6620 6060 636f  eturned. If ``co
+000143b0: 756e 7460 6020 6973 206e 6567 6174 6976  unt`` is negativ
+000143c0: 652c 2065 7665 7279 7468 696e 6720 746f  e, everything to
+000143d0: 2074 6865 2072 6967 6874 206f 6620 7468   the right of th
+000143e0: 6520 6669 6e61 6c20 6465 6c69 6d69 7465  e final delimite
+000143f0: 7220 2863 6f75 6e74 696e 6720 6672 6f6d  r (counting from
+00014400: 2074 6865 0a20 2020 2072 6967 6874 2920   the.    right) 
+00014410: 6973 2072 6574 7572 6e65 642e 2049 6620  is returned. If 
+00014420: 6060 636f 756e 7460 6020 6973 207a 6572  ``count`` is zer
+00014430: 6f2c 2072 6574 7572 6e73 2065 6d70 7479  o, returns empty
+00014440: 2073 7472 696e 672e 0a0a 2020 2020 4578   string...    Ex
+00014450: 616d 706c 6520 313a 3a0a 2020 2020 2020  ample 1::.      
+00014460: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00014470: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00014480: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+00014490: 2020 2020 205b 2261 2e62 2e63 2e64 225d       ["a.b.c.d"]
+000144a0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+000144b0: 2020 7363 6865 6d61 3d5b 2253 225d 2c0a    schema=["S"],.
+000144c0: 2020 2020 2020 2020 2e2e 2e20 292e 7365          ... ).se
+000144d0: 6c65 6374 2873 7562 7374 7269 6e67 5f69  lect(substring_i
+000144e0: 6e64 6578 2863 6f6c 2822 5322 292c 2022  ndex(col("S"), "
+000144f0: 2e22 2c20 3229 2e61 6c69 6173 2822 7265  .", 2).alias("re
+00014500: 7375 6c74 2229 290a 2020 2020 2020 2020  sult")).        
+00014510: 3e3e 3e20 6466 2e73 686f 7728 290a 2020  >>> df.show().  
+00014520: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00014530: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00014540: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00014550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00014560: 2020 2020 207c 612e 6220 2020 2020 2020       |a.b       
+00014570: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00014580: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00014590: 424c 414e 4b4c 494e 453e 0a0a 2020 2020  BLANKLINE>..    
+000145a0: 4578 616d 706c 6520 323a 3a0a 2020 2020  Example 2::.    
+000145b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000145c0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000145d0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+000145e0: 2e2e 2020 2020 205b 5b22 612e 622e 632e  ..     [["a.b.c.
+000145f0: 6422 2c20 222e 225d 5d2c 0a20 2020 2020  d", "."]],.     
+00014600: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
+00014610: 613d 5b22 5322 2c20 2264 656c 696d 6974  a=["S", "delimit
+00014620: 6572 225d 2c0a 2020 2020 2020 2020 2e2e  er"],.        ..
+00014630: 2e20 292e 7365 6c65 6374 2873 7562 7374  . ).select(subst
+00014640: 7269 6e67 5f69 6e64 6578 2863 6f6c 2822  ring_index(col("
+00014650: 5322 292c 2063 6f6c 2822 6465 6c69 6d69  S"), col("delimi
+00014660: 7465 7222 292c 2032 292e 616c 6961 7328  ter"), 2).alias(
+00014670: 2272 6573 756c 7422 2929 0a20 2020 2020  "result")).     
+00014680: 2020 203e 3e3e 2064 662e 7368 6f77 2829     >>> df.show()
+00014690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000146a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+000146b0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+000146c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000146d0: 2020 2020 2020 2020 7c61 2e62 2020 2020          |a.b    
+000146e0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+000146f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00014700: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00014710: 2020 2222 220a 2020 2020 7320 3d20 5f74    """.    s = _t
+00014720: 6f5f 636f 6c5f 6966 5f73 7472 2874 6578  o_col_if_str(tex
+00014730: 742c 2022 7375 6273 7472 696e 675f 696e  t, "substring_in
+00014740: 6465 7822 290a 2020 2020 7374 7274 6f6b  dex").    strtok
+00014750: 5f61 7272 6179 203d 2062 7569 6c74 696e  _array = builtin
+00014760: 2822 7374 7274 6f6b 5f74 6f5f 6172 7261  ("strtok_to_arra
+00014770: 7922 2928 732c 2064 656c 696d 290a 2020  y")(s, delim).  
+00014780: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00014790: 2822 6172 7261 795f 746f 5f73 7472 696e  ("array_to_strin
+000147a0: 6722 2928 0a20 2020 2020 2020 2062 7569  g")(.        bui
+000147b0: 6c74 696e 2822 6172 7261 795f 736c 6963  ltin("array_slic
+000147c0: 6522 2928 0a20 2020 2020 2020 2020 2020  e")(.           
+000147d0: 2073 7472 746f 6b5f 6172 7261 792c 0a20   strtok_array,. 
+000147e0: 2020 2020 2020 2020 2020 2030 2069 6620             0 if 
+000147f0: 636f 756e 7420 3e3d 2030 2065 6c73 6520  count >= 0 else 
+00014800: 6275 696c 7469 6e28 2261 7272 6179 5f73  builtin("array_s
+00014810: 697a 6522 2928 7374 7274 6f6b 5f61 7272  ize")(strtok_arr
+00014820: 6179 2920 2b20 636f 756e 742c 0a20 2020  ay) + count,.   
+00014830: 2020 2020 2020 2020 2063 6f75 6e74 2069           count i
+00014840: 6620 636f 756e 7420 3e3d 2030 2065 6c73  f count >= 0 els
+00014850: 6520 6275 696c 7469 6e28 2261 7272 6179  e builtin("array
+00014860: 5f73 697a 6522 2928 7374 7274 6f6b 5f61  _size")(strtok_a
+00014870: 7272 6179 292c 0a20 2020 2020 2020 2029  rray),.        )
+00014880: 2c0a 2020 2020 2020 2020 6465 6c69 6d2c  ,.        delim,
+00014890: 0a20 2020 2029 0a0a 0a64 6566 2072 6567  .    )...def reg
+000148a0: 6578 705f 636f 756e 7428 0a20 2020 2073  exp_count(.    s
+000148b0: 7562 6a65 6374 3a20 436f 6c75 6d6e 4f72  ubject: ColumnOr
+000148c0: 4e61 6d65 2c0a 2020 2020 7061 7474 6572  Name,.    patter
+000148d0: 6e3a 2043 6f6c 756d 6e4f 724c 6974 6572  n: ColumnOrLiter
+000148e0: 616c 5374 722c 0a20 2020 2070 6f73 6974  alStr,.    posit
+000148f0: 696f 6e3a 2055 6e69 6f6e 5b43 6f6c 756d  ion: Union[Colum
+00014900: 6e2c 2069 6e74 5d20 3d20 312c 0a20 2020  n, int] = 1,.   
+00014910: 202a 7061 7261 6d65 7465 7273 3a20 436f   *parameters: Co
+00014920: 6c75 6d6e 4f72 4c69 7465 7261 6c2c 0a29  lumnOrLiteral,.)
+00014930: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00014940: 2222 2252 6574 7572 6e73 2074 6865 206e  """Returns the n
+00014950: 756d 6265 7220 6f66 2074 696d 6573 2074  umber of times t
+00014960: 6861 7420 6120 7061 7474 6572 6e20 6f63  hat a pattern oc
+00014970: 6375 7273 2069 6e20 7468 6520 7375 626a  curs in the subj
+00014980: 6563 742e 0a0a 2020 2020 4578 616d 706c  ect...    Exampl
+00014990: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+000149a0: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+000149b0: 6c28 2273 656c 6563 7420 2a20 6672 6f6d  l("select * from
+000149c0: 2076 616c 7565 7328 2761 7070 6c65 2729   values('apple')
+000149d0: 2c28 2762 616e 616e 6127 292c 2827 7065  ,('banana'),('pe
+000149e0: 6163 6827 2920 6173 2054 2861 2922 290a  ach') as T(a)").
+000149f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00014a00: 656c 6563 7428 7265 6765 7870 5f63 6f75  elect(regexp_cou
+00014a10: 6e74 2863 6f6c 2822 6122 292c 2022 6122  nt(col("a"), "a"
+00014a20: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00014a30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00014a40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00014a50: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00014a60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00014a70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00014a80: 207c 3120 2020 2020 2020 2020 7c0a 2020   |1         |.  
+00014a90: 2020 2020 2020 7c33 2020 2020 2020 2020        |3        
+00014aa0: 207c 0a20 2020 2020 2020 207c 3120 2020   |.        |1   
+00014ab0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00014ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00014ad0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00014ae0: 0a20 2020 2022 2222 0a20 2020 2073 716c  .    """.    sql
+00014af0: 5f66 756e 635f 6e61 6d65 203d 2022 7265  _func_name = "re
+00014b00: 6765 7870 5f63 6f75 6e74 220a 2020 2020  gexp_count".    
+00014b10: 7375 6220 3d20 5f74 6f5f 636f 6c5f 6966  sub = _to_col_if
+00014b20: 5f73 7472 2873 7562 6a65 6374 2c20 7371  _str(subject, sq
+00014b30: 6c5f 6675 6e63 5f6e 616d 6529 0a20 2020  l_func_name).   
+00014b40: 2070 6174 203d 206c 6974 2870 6174 7465   pat = lit(patte
+00014b50: 726e 290a 2020 2020 706f 7320 3d20 6c69  rn).    pos = li
+00014b60: 7428 706f 7369 7469 6f6e 290a 0a20 2020  t(position)..   
+00014b70: 2070 6172 616d 7320 3d20 5b6c 6974 2870   params = [lit(p
+00014b80: 2920 666f 7220 7020 696e 2070 6172 616d  ) for p in param
+00014b90: 6574 6572 735d 0a20 2020 2072 6574 7572  eters].    retur
+00014ba0: 6e20 6275 696c 7469 6e28 7371 6c5f 6675  n builtin(sql_fu
+00014bb0: 6e63 5f6e 616d 6529 2873 7562 2c20 7061  nc_name)(sub, pa
+00014bc0: 742c 2070 6f73 2c20 2a70 6172 616d 7329  t, pos, *params)
+00014bd0: 0a0a 0a64 6566 2072 6567 6578 705f 6578  ...def regexp_ex
+00014be0: 7472 6163 7428 0a20 2020 2076 616c 7565  tract(.    value
+00014bf0: 3a20 436f 6c75 6d6e 4f72 4c69 7465 7261  : ColumnOrLitera
+00014c00: 6c53 7472 2c20 7265 6765 7870 3a20 436f  lStr, regexp: Co
+00014c10: 6c75 6d6e 4f72 4c69 7465 7261 6c53 7472  lumnOrLiteralStr
+00014c20: 2c20 6964 783a 2069 6e74 0a29 202d 3e20  , idx: int.) -> 
+00014c30: 436f 6c75 6d6e 3a0a 2020 2020 7222 2222  Column:.    r"""
+00014c40: 0a20 2020 2045 7874 7261 6374 2061 2073  .    Extract a s
+00014c50: 7065 6369 6669 6320 6772 6f75 7020 6d61  pecific group ma
+00014c60: 7463 6865 6420 6279 2061 2072 6567 6578  tched by a regex
+00014c70: 2c20 6672 6f6d 2074 6865 2073 7065 6369  , from the speci
+00014c80: 6669 6564 2073 7472 696e 6720 636f 6c75  fied string colu
+00014c90: 6d6e 2e0a 2020 2020 4966 2074 6865 2072  mn..    If the r
+00014ca0: 6567 6578 2064 6964 206e 6f74 206d 6174  egex did not mat
+00014cb0: 6368 2c20 6f72 2074 6865 2073 7065 6369  ch, or the speci
+00014cc0: 6669 6564 2067 726f 7570 2064 6964 206e  fied group did n
+00014cd0: 6f74 206d 6174 6368 2c0a 2020 2020 616e  ot match,.    an
+00014ce0: 2065 6d70 7479 2073 7472 696e 6720 6973   empty string is
+00014cf0: 2072 6574 7572 6e65 642e 0a0a 2020 2020   returned...    
+00014d00: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00014d10: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00014d20: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+00014d30: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+00014d40: 7265 6765 7870 5f65 7874 7261 6374 0a20  regexp_extract. 
+00014d50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00014d60: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
+00014d70: 7461 4672 616d 6528 5b5b 2269 645f 3230  taFrame([["id_20
+00014d80: 5f33 3022 2c20 3130 5d2c 205b 2269 645f  _30", 10], ["id_
+00014d90: 3430 5f35 3022 2c20 3330 5d5d 2c20 5b22  40_50", 30]], ["
+00014da0: 6964 222c 2022 6167 6522 5d29 0a20 2020  id", "age"]).   
+00014db0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00014dc0: 6374 2872 6567 6578 705f 6578 7472 6163  ct(regexp_extrac
+00014dd0: 7428 2269 6422 2c20 7222 285c 642b 2922  t("id", r"(\d+)"
+00014de0: 2c20 3129 2e61 6c69 6173 2822 5245 5322  , 1).alias("RES"
+00014df0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00014e00: 2020 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020    ---------.    
+00014e10: 2020 2020 7c22 5245 5322 2020 7c0a 2020      |"RES"  |.  
+00014e20: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a        ---------.
+00014e30: 2020 2020 2020 2020 7c32 3020 2020 2020          |20     
+00014e40: 7c0a 2020 2020 2020 2020 7c34 3020 2020  |.        |40   
+00014e50: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00014e60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00014e70: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+00014e80: 220a 2020 2020 7661 6c75 6520 3d20 5f74  ".    value = _t
+00014e90: 6f5f 636f 6c5f 6966 5f73 7472 2876 616c  o_col_if_str(val
+00014ea0: 7565 2c20 2272 6567 6578 705f 6578 7472  ue, "regexp_extr
+00014eb0: 6163 7422 290a 2020 2020 7265 6765 7870  act").    regexp
+00014ec0: 203d 205f 746f 5f63 6f6c 5f69 665f 6c69   = _to_col_if_li
+00014ed0: 7428 7265 6765 7870 2c20 2272 6567 6578  t(regexp, "regex
+00014ee0: 705f 6578 7472 6163 7422 290a 2020 2020  p_extract").    
+00014ef0: 6964 7820 3d20 5f74 6f5f 636f 6c5f 6966  idx = _to_col_if
+00014f00: 5f6c 6974 2869 6478 2c20 2272 6567 6578  _lit(idx, "regex
+00014f10: 705f 6578 7472 6163 7422 290a 2020 2020  p_extract").    
+00014f20: 7265 7475 726e 2063 6f61 6c65 7363 6528  return coalesce(
+00014f30: 0a20 2020 2020 2020 2063 616c 6c5f 6275  .        call_bu
+00014f40: 696c 7469 6e28 2272 6567 6578 705f 7375  iltin("regexp_su
+00014f50: 6273 7472 222c 2076 616c 7565 2c20 7265  bstr", value, re
+00014f60: 6765 7870 2c20 6c69 7428 3129 2c20 6c69  gexp, lit(1), li
+00014f70: 7428 3129 2c20 6c69 7428 2265 2229 2c20  t(1), lit("e"), 
+00014f80: 6964 7829 2c0a 2020 2020 2020 2020 6c69  idx),.        li
+00014f90: 7428 2222 292c 0a20 2020 2029 0a0a 0a64  t(""),.    )...d
+00014fa0: 6566 2072 6567 6578 705f 7265 706c 6163  ef regexp_replac
+00014fb0: 6528 0a20 2020 2073 7562 6a65 6374 3a20  e(.    subject: 
+00014fc0: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
+00014fd0: 2020 7061 7474 6572 6e3a 2043 6f6c 756d    pattern: Colum
+00014fe0: 6e4f 724c 6974 6572 616c 5374 722c 0a20  nOrLiteralStr,. 
+00014ff0: 2020 2072 6570 6c61 6365 6d65 6e74 3a20     replacement: 
+00015000: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
+00015010: 7472 203d 2022 222c 0a20 2020 2070 6f73  tr = "",.    pos
+00015020: 6974 696f 6e3a 2055 6e69 6f6e 5b43 6f6c  ition: Union[Col
+00015030: 756d 6e2c 2069 6e74 5d20 3d20 312c 0a20  umn, int] = 1,. 
+00015040: 2020 206f 6363 7572 7265 6e63 6573 3a20     occurrences: 
+00015050: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
+00015060: 745d 203d 2030 2c0a 2020 2020 2a70 6172  t] = 0,.    *par
+00015070: 616d 6574 6572 733a 2043 6f6c 756d 6e4f  ameters: ColumnO
+00015080: 724c 6974 6572 616c 2c0a 2920 2d3e 2043  rLiteral,.) -> C
+00015090: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+000150a0: 7475 726e 7320 7468 6520 7375 626a 6563  turns the subjec
+000150b0: 7420 7769 7468 2074 6865 2073 7065 6369  t with the speci
+000150c0: 6669 6564 2070 6174 7465 726e 2028 6f72  fied pattern (or
+000150d0: 2061 6c6c 206f 6363 7572 7265 6e63 6573   all occurrences
+000150e0: 206f 6620 7468 6520 7061 7474 6572 6e29   of the pattern)
+000150f0: 2065 6974 6865 7220 7265 6d6f 7665 6420   either removed 
+00015100: 6f72 2072 6570 6c61 6365 6420 6279 2061  or replaced by a
+00015110: 2072 6570 6c61 6365 6d65 6e74 2073 7472   replacement str
+00015120: 696e 672e 0a20 2020 2049 6620 6e6f 206d  ing..    If no m
+00015130: 6174 6368 6573 2061 7265 2066 6f75 6e64  atches are found
+00015140: 2c20 7265 7475 726e 7320 7468 6520 6f72  , returns the or
+00015150: 6967 696e 616c 2073 7562 6a65 6374 2e0a  iginal subject..
+00015160: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00015170: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00015180: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00015190: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
+000151a0: 2020 2e2e 2e20 2020 2020 5b5b 2249 7420    ...     [["It 
+000151b0: 7761 7320 7468 6520 6265 7374 206f 6620  was the best of 
+000151c0: 7469 6d65 732c 2069 7420 7761 7320 7468  times, it was th
+000151d0: 6520 776f 7273 7420 6f66 2074 696d 6573  e worst of times
+000151e0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
+000151f0: 5d0a 2020 2020 2020 2020 2e2e 2e20 290a  ].        ... ).
+00015200: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00015210: 656c 6563 7428 7265 6765 7870 5f72 6570  elect(regexp_rep
+00015220: 6c61 6365 2863 6f6c 2822 6122 292c 206c  lace(col("a"), l
+00015230: 6974 2822 2820 297b 312c 7d22 292c 206c  it("( ){1,}"), l
+00015240: 6974 2822 2229 292e 616c 6961 7328 2272  it("")).alias("r
+00015250: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00015260: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00015270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015290: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+000152a0: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
+000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152c0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000152d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000152e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000152f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00015300: 2020 2020 2020 207c 4974 7761 7374 6865         |Itwasthe
+00015310: 6265 7374 6f66 7469 6d65 732c 6974 7761  bestoftimes,itwa
+00015320: 7374 6865 776f 7273 746f 6674 696d 6573  stheworstoftimes
+00015330: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00015340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015360: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00015370: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00015380: 2022 2222 0a20 2020 2073 716c 5f66 756e   """.    sql_fun
+00015390: 635f 6e61 6d65 203d 2022 7265 6765 7870  c_name = "regexp
+000153a0: 5f72 6570 6c61 6365 220a 2020 2020 7375  _replace".    su
+000153b0: 6220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  b = _to_col_if_s
+000153c0: 7472 2873 7562 6a65 6374 2c20 7371 6c5f  tr(subject, sql_
+000153d0: 6675 6e63 5f6e 616d 6529 0a20 2020 2070  func_name).    p
+000153e0: 6174 203d 206c 6974 2870 6174 7465 726e  at = lit(pattern
+000153f0: 290a 2020 2020 7265 7020 3d20 6c69 7428  ).    rep = lit(
+00015400: 7265 706c 6163 656d 656e 7429 0a20 2020  replacement).   
+00015410: 2070 6f73 203d 206c 6974 2870 6f73 6974   pos = lit(posit
+00015420: 696f 6e29 0a20 2020 206f 6363 203d 206c  ion).    occ = l
+00015430: 6974 286f 6363 7572 7265 6e63 6573 290a  it(occurrences).
+00015440: 0a20 2020 2070 6172 616d 7320 3d20 5b6c  .    params = [l
+00015450: 6974 2870 2920 666f 7220 7020 696e 2070  it(p) for p in p
+00015460: 6172 616d 6574 6572 735d 0a20 2020 2072  arameters].    r
+00015470: 6574 7572 6e20 6275 696c 7469 6e28 7371  eturn builtin(sq
+00015480: 6c5f 6675 6e63 5f6e 616d 6529 2873 7562  l_func_name)(sub
+00015490: 2c20 7061 742c 2072 6570 2c20 706f 732c  , pat, rep, pos,
+000154a0: 206f 6363 2c20 2a70 6172 616d 7329 0a0a   occ, *params)..
+000154b0: 0a64 6566 2072 6570 6c61 6365 280a 2020  .def replace(.  
+000154c0: 2020 7375 626a 6563 743a 2043 6f6c 756d    subject: Colum
+000154d0: 6e4f 724e 616d 652c 0a20 2020 2070 6174  nOrName,.    pat
+000154e0: 7465 726e 3a20 436f 6c75 6d6e 4f72 4c69  tern: ColumnOrLi
+000154f0: 7465 7261 6c53 7472 2c0a 2020 2020 7265  teralStr,.    re
+00015500: 706c 6163 656d 656e 743a 2043 6f6c 756d  placement: Colum
+00015510: 6e4f 724c 6974 6572 616c 5374 7220 3d20  nOrLiteralStr = 
+00015520: 2222 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  "",.) -> Column:
+00015530: 0a20 2020 2022 2222 0a20 2020 2052 656d  .    """.    Rem
+00015540: 6f76 6573 2061 6c6c 206f 6363 7572 7265  oves all occurre
+00015550: 6e63 6573 206f 6620 6120 7370 6563 6966  nces of a specif
+00015560: 6965 6420 7375 626a 6563 7420 616e 6420  ied subject and 
+00015570: 6f70 7469 6f6e 616c 6c79 2072 6570 6c61  optionally repla
+00015580: 6365 7320 7468 656d 2077 6974 6820 7265  ces them with re
+00015590: 706c 6163 656d 656e 742e 0a0a 2020 2020  placement...    
+000155a0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000155b0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000155c0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000155d0: 7261 6d65 285b 5b22 6170 706c 6522 5d2c  rame([["apple"],
+000155e0: 205b 2261 7070 6c65 2070 6965 225d 2c20   ["apple pie"], 
+000155f0: 5b22 6170 706c 6520 6a75 6963 6522 5d5d  ["apple juice"]]
+00015600: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00015610: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00015620: 656c 6563 7428 7265 706c 6163 6528 636f  elect(replace(co
+00015630: 6c28 2261 2229 2c20 2261 7070 6c65 222c  l("a"), "apple",
+00015640: 2022 6f72 616e 6765 2229 2e61 6c69 6173   "orange").alias
+00015650: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+00015660: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00015670: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00015680: 2020 2020 7c22 5245 5355 4c54 2220 2020      |"RESULT"   
+00015690: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+000156a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+000156b0: 2020 2020 2020 7c6f 7261 6e67 6520 2020        |orange   
+000156c0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+000156d0: 6f72 616e 6765 2070 6965 2020 2020 7c0a  orange pie    |.
+000156e0: 2020 2020 2020 2020 7c6f 7261 6e67 6520          |orange 
+000156f0: 6a75 6963 6520 207c 0a20 2020 2020 2020  juice  |.       
+00015700: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00015710: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00015720: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00015730: 2020 7371 6c5f 6675 6e63 5f6e 616d 6520    sql_func_name 
+00015740: 3d20 2272 6570 6c61 6365 220a 2020 2020  = "replace".    
+00015750: 7375 6220 3d20 5f74 6f5f 636f 6c5f 6966  sub = _to_col_if
+00015760: 5f73 7472 2873 7562 6a65 6374 2c20 7371  _str(subject, sq
+00015770: 6c5f 6675 6e63 5f6e 616d 6529 0a20 2020  l_func_name).   
+00015780: 2070 6174 203d 206c 6974 2870 6174 7465   pat = lit(patte
+00015790: 726e 290a 2020 2020 7265 7020 3d20 6c69  rn).    rep = li
+000157a0: 7428 7265 706c 6163 656d 656e 7429 0a20  t(replacement). 
+000157b0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+000157c0: 6e28 7371 6c5f 6675 6e63 5f6e 616d 6529  n(sql_func_name)
+000157d0: 2873 7562 2c20 7061 742c 2072 6570 290a  (sub, pat, rep).
+000157e0: 0a0a 6465 6620 6368 6172 696e 6465 7828  ..def charindex(
+000157f0: 0a20 2020 2074 6172 6765 745f 6578 7072  .    target_expr
+00015800: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
+00015810: 2020 2020 736f 7572 6365 5f65 7870 723a      source_expr:
+00015820: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
+00015830: 2020 2070 6f73 6974 696f 6e3a 204f 7074     position: Opt
+00015840: 696f 6e61 6c5b 556e 696f 6e5b 436f 6c75  ional[Union[Colu
+00015850: 6d6e 2c20 696e 745d 5d20 3d20 4e6f 6e65  mn, int]] = None
+00015860: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
+00015870: 2020 2022 2222 5365 6172 6368 6573 2066     """Searches f
+00015880: 6f72 2060 6074 6172 6765 745f 6578 7072  or ``target_expr
+00015890: 6060 2069 6e20 6060 736f 7572 6365 5f65  `` in ``source_e
+000158a0: 7870 7260 6020 616e 642c 2069 6620 7375  xpr`` and, if su
+000158b0: 6363 6573 7366 756c 2c0a 2020 2020 7265  ccessful,.    re
+000158c0: 7475 726e 7320 7468 6520 706f 7369 7469  turns the positi
+000158d0: 6f6e 2028 312d 6261 7365 6429 206f 6620  on (1-based) of 
+000158e0: 7468 6520 6060 7461 7267 6574 5f65 7870  the ``target_exp
+000158f0: 7260 6020 696e 2060 6073 6f75 7263 655f  r`` in ``source_
+00015900: 6578 7072 6060 2e0a 0a20 2020 2041 7267  expr``...    Arg
+00015910: 733a 0a20 2020 2020 2020 2074 6172 6765  s:.        targe
+00015920: 745f 6578 7072 3a20 4120 7374 7269 6e67  t_expr: A string
+00015930: 206f 7220 6269 6e61 7279 2065 7870 7265   or binary expre
+00015940: 7373 696f 6e20 7265 7072 6573 656e 7469  ssion representi
+00015950: 6e67 2074 6865 2076 616c 7565 2074 6f20  ng the value to 
+00015960: 6c6f 6f6b 2066 6f72 2e0a 2020 2020 2020  look for..      
+00015970: 2020 736f 7572 6365 5f65 7870 723a 2041    source_expr: A
+00015980: 2073 7472 696e 6720 6f72 2062 696e 6172   string or binar
+00015990: 7920 6578 7072 6573 7369 6f6e 2072 6570  y expression rep
+000159a0: 7265 7365 6e74 696e 6720 7468 6520 7661  resenting the va
+000159b0: 6c75 6520 746f 2073 6561 7263 682e 0a20  lue to search.. 
+000159c0: 2020 2020 2020 2070 6f73 6974 696f 6e3a         position:
+000159d0: 2041 206e 756d 6265 7220 696e 6469 6361   A number indica
+000159e0: 7469 6f6e 2074 6865 2070 6f73 6974 696f  tion the positio
+000159f0: 6e20 2831 2d62 6173 6564 2920 6672 6f6d  n (1-based) from
+00015a00: 2077 6865 7265 2074 6f20 7374 6172 7420   where to start 
+00015a10: 7468 6520 7365 6172 6368 2e20 4465 6661  the search. Defa
+00015a20: 756c 7473 2074 6f20 4e6f 6e65 2e0a 0a20  ults to None... 
+00015a30: 2020 2045 7861 6d70 6c65 733a 3a0a 2020     Examples::.  
+00015a40: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00015a50: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00015a60: 7461 6672 616d 6528 5b22 6261 6e61 6e61  taframe(["banana
+00015a70: 225d 2c20 7363 6865 6d61 3d5b 2761 275d  "], schema=['a']
+00015a80: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00015a90: 2e73 656c 6563 7428 6368 6172 696e 6465  .select(charinde
+00015aa0: 7828 6c69 7428 2261 6e22 292c 2064 662e  x(lit("an"), df.
+00015ab0: 612c 2031 292e 6173 5f28 2272 6573 756c  a, 1).as_("resul
+00015ac0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+00015ad0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00015ae0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+00015af0: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+00015b00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00015b10: 2020 207c 3220 2020 2020 2020 2020 7c0a     |2         |.
+00015b20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00015b30: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00015b40: 414e 4b4c 494e 453e 0a0a 2020 2020 2020  ANKLINE>..      
+00015b50: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00015b60: 6368 6172 696e 6465 7828 6c69 7428 2261  charindex(lit("a
+00015b70: 6e22 292c 2064 662e 612c 2033 292e 6173  n"), df.a, 3).as
+00015b80: 5f28 2272 6573 756c 7422 2929 2e73 686f  _("result")).sho
+00015b90: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00015ba0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00015bb0: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00015bc0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00015bd0: 2d2d 0a20 2020 2020 2020 207c 3420 2020  --.        |4   
+00015be0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00015bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00015c00: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00015c10: 0a20 2020 2022 2222 0a20 2020 2074 203d  .    """.    t =
+00015c20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00015c30: 7461 7267 6574 5f65 7870 722c 2022 6368  target_expr, "ch
+00015c40: 6172 696e 6465 7822 290a 2020 2020 7320  arindex").    s 
+00015c50: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00015c60: 2873 6f75 7263 655f 6578 7072 2c20 2263  (source_expr, "c
+00015c70: 6861 7269 6e64 6578 2229 0a20 2020 2072  harindex").    r
+00015c80: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
+00015c90: 6275 696c 7469 6e28 2263 6861 7269 6e64  builtin("charind
+00015ca0: 6578 2229 2874 2c20 732c 206c 6974 2870  ex")(t, s, lit(p
+00015cb0: 6f73 6974 696f 6e29 290a 2020 2020 2020  osition)).      
+00015cc0: 2020 6966 2070 6f73 6974 696f 6e20 6973    if position is
+00015cd0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+00015ce0: 2020 656c 7365 2062 7569 6c74 696e 2822    else builtin("
+00015cf0: 6368 6172 696e 6465 7822 2928 742c 2073  charindex")(t, s
+00015d00: 290a 2020 2020 290a 0a0a 6465 6620 636f  ).    )...def co
+00015d10: 6c6c 6174 6528 653a 2043 6f6c 756d 6e2c  llate(e: Column,
+00015d20: 2063 6f6c 6c61 7469 6f6e 5f73 7065 633a   collation_spec:
+00015d30: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
+00015d40: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00015d50: 6120 636f 7079 206f 6620 7468 6520 6f72  a copy of the or
+00015d60: 6967 696e 616c 203a 636c 6173 733a 6043  iginal :class:`C
+00015d70: 6f6c 756d 6e60 2077 6974 6820 7468 6520  olumn` with the 
+00015d80: 7370 6563 6966 6965 6420 6060 636f 6c6c  specified ``coll
+00015d90: 6174 696f 6e5f 7370 6563 6060 0a20 2020  ation_spec``.   
+00015da0: 2070 726f 7065 7274 792c 2072 6174 6865   property, rathe
+00015db0: 7220 7468 616e 2074 6865 206f 7269 6769  r than the origi
+00015dc0: 6e61 6c20 636f 6c6c 6174 696f 6e20 7370  nal collation sp
+00015dd0: 6563 6966 6963 6174 696f 6e20 7072 6f70  ecification prop
+00015de0: 6572 7479 2e0a 0a20 2020 2046 6f72 2064  erty...    For d
+00015df0: 6574 6169 6c73 2c20 7365 6520 7468 6520  etails, see the 
+00015e00: 536e 6f77 666c 616b 6520 646f 6375 6d65  Snowflake docume
+00015e10: 6e74 6174 696f 6e20 6f6e 0a20 2020 2060  ntation on.    `
+00015e20: 636f 6c6c 6174 696f 6e20 7370 6563 6966  collation specif
+00015e30: 6963 6174 696f 6e73 203c 6874 7470 733a  ications <https:
+00015e40: 2f2f 646f 6373 2e73 6e6f 7766 6c61 6b65  //docs.snowflake
+00015e50: 2e63 6f6d 2f65 6e2f 7371 6c2d 7265 6665  .com/en/sql-refe
+00015e60: 7265 6e63 652f 636f 6c6c 6174 696f 6e2e  rence/collation.
+00015e70: 6874 6d6c 236c 6162 656c 2d63 6f6c 6c61  html#label-colla
+00015e80: 7469 6f6e 2d73 7065 6369 6669 6361 7469  tion-specificati
+00015e90: 6f6e 3e60 5f2e 0a0a 2020 2020 4578 616d  on>`_...    Exam
+00015ea0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00015eb0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00015ec0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00015ed0: 5b27 c3b1 275d 2c20 7363 6865 6d61 3d5b  ['..'], schema=[
+00015ee0: 2776 275d 290a 2020 2020 2020 2020 3e3e  'v']).        >>
+00015ef0: 3e20 6466 2e73 656c 6563 7428 6466 2e76  > df.select(df.v
+00015f00: 203d 3d20 6c69 7428 27c3 9127 292c 2063   == lit('..'), c
+00015f10: 6f6c 6c61 7465 2864 662e 762c 2027 7370  ollate(df.v, 'sp
+00015f20: 2d75 7070 6572 2729 203d 3d20 6c69 7428  -upper') == lit(
+00015f30: 27c3 9127 2929 2e73 686f 7728 290a 2020  '..')).show().  
+00015f40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00015f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f80: 0a20 2020 2020 2020 207c 2228 2222 5622  .        |"(""V"
+00015f90: 2220 3d20 27c3 9127 2922 2020 7c22 2843  " = '..')"  |"(C
+00015fa0: 4f4c 4c41 5445 2822 2256 2222 2c20 2753  OLLATE(""V"", 'S
+00015fb0: 502d 5550 5045 5227 2920 3d20 27c3 9127  P-UPPER') = '..'
+00015fc0: 2922 2020 7c0a 2020 2020 2020 2020 2d2d  )"  |.        --
+00015fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015fe0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ff0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016000: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00016010: 207c 4661 6c73 6520 2020 2020 2020 2020   |False         
+00016020: 2020 207c 5472 7565 2020 2020 2020 2020     |True        
+00016030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016040: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00016050: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00016060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00016090: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+000160a0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+000160b0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+000160c0: 7228 652c 2022 636f 6c6c 6174 6522 290a  r(e, "collate").
+000160d0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000160e0: 696e 2822 636f 6c6c 6174 6522 2928 632c  in("collate")(c,
+000160f0: 2063 6f6c 6c61 7469 6f6e 5f73 7065 6329   collation_spec)
+00016100: 0a0a 0a64 6566 2063 6f6c 6c61 7469 6f6e  ...def collation
+00016110: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00016120: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00016130: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+00016140: 636f 6c6c 6174 696f 6e20 7370 6563 6966  collation specif
+00016150: 6963 6174 696f 6e20 6f66 2065 7870 722e  ication of expr.
+00016160: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00016170: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00016180: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00016190: 6461 7461 6672 616d 6528 5b27 c3b1 275d  dataframe(['..']
+000161a0: 2c20 7363 6865 6d61 3d5b 2776 275d 290a  , schema=['v']).
+000161b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+000161c0: 656c 6563 7428 636f 6c6c 6174 696f 6e28  elect(collation(
+000161d0: 636f 6c6c 6174 6528 6466 2e76 2c20 2773  collate(df.v, 's
+000161e0: 702d 7570 7065 7227 2929 292e 7368 6f77  p-upper'))).show
+000161f0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00016200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016220: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00016230: 2243 4f4c 4c41 5449 4f4e 2843 4f4c 4c41  "COLLATION(COLLA
+00016240: 5445 2822 2256 2222 2c20 2753 502d 5550  TE(""V"", 'SP-UP
+00016250: 5045 5227 2929 2220 207c 0a20 2020 2020  PER'))"  |.     
+00016260: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00016270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00016290: 2020 2020 2020 207c 7370 2d75 7070 6572         |sp-upper
+000162a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162c0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000162d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000162e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000162f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00016300: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00016310: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00016320: 6f6c 5f69 665f 7374 7228 652c 2022 636f  ol_if_str(e, "co
+00016330: 6c6c 6174 696f 6e22 290a 2020 2020 7265  llation").    re
+00016340: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
+00016350: 6c6c 6174 696f 6e22 2928 6329 0a0a 0a64  llation")(c)...d
+00016360: 6566 2063 6f6e 6361 7428 2a63 6f6c 733a  ef concat(*cols:
+00016370: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00016380: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00016390: 2243 6f6e 6361 7465 6e61 7465 7320 6f6e  "Concatenates on
+000163a0: 6520 6f72 206d 6f72 6520 7374 7269 6e67  e or more string
+000163b0: 732c 206f 7220 636f 6e63 6174 656e 6174  s, or concatenat
+000163c0: 6573 206f 6e65 206f 7220 6d6f 7265 2062  es one or more b
+000163d0: 696e 6172 7920 7661 6c75 6573 2e20 4966  inary values. If
+000163e0: 2061 6e79 206f 6620 7468 6520 7661 6c75   any of the valu
+000163f0: 6573 2069 7320 6e75 6c6c 2c20 7468 6520  es is null, the 
+00016400: 7265 7375 6c74 2069 7320 616c 736f 206e  result is also n
+00016410: 756c 6c2e 0a0a 2020 2020 4578 616d 706c  ull...    Exampl
+00016420: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00016430: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00016440: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
+00016450: 2748 656c 6c6f 272c 2027 576f 726c 6427  'Hello', 'World'
+00016460: 5d5d 2c20 7363 6865 6d61 3d5b 2761 272c  ]], schema=['a',
+00016470: 2027 6227 5d29 0a20 2020 2020 2020 203e   'b']).        >
+00016480: 3e3e 2064 662e 7365 6c65 6374 2863 6f6e  >> df.select(con
+00016490: 6361 7428 6466 2e61 2c20 6466 2e62 2929  cat(df.a, df.b))
+000164a0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+000164b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000164c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000164d0: 2020 207c 2243 4f4e 4341 5428 2222 4122     |"CONCAT(""A"
+000164e0: 222c 2022 2242 2222 2922 2020 7c0a 2020  ", ""B"")"  |.  
+000164f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00016500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016510: 0a20 2020 2020 2020 207c 4865 6c6c 6f57  .        |HelloW
+00016520: 6f72 6c64 2020 2020 2020 2020 2020 2020  orld            
+00016530: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00016540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016550: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00016560: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00016570: 2222 0a0a 2020 2020 636f 6c75 6d6e 7320  ""..    columns 
+00016580: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
+00016590: 7228 632c 2022 636f 6e63 6174 2229 2066  r(c, "concat") f
+000165a0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
+000165b0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000165c0: 2822 636f 6e63 6174 2229 282a 636f 6c75  ("concat")(*colu
+000165d0: 6d6e 7329 0a0a 0a64 6566 2063 6f6e 6361  mns)...def conca
+000165e0: 745f 7773 282a 636f 6c73 3a20 436f 6c75  t_ws(*cols: Colu
+000165f0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00016600: 756d 6e3a 0a20 2020 2022 2222 436f 6e63  umn:.    """Conc
+00016610: 6174 656e 6174 6573 2074 776f 206f 7220  atenates two or 
+00016620: 6d6f 7265 2073 7472 696e 6773 2c20 6f72  more strings, or
+00016630: 2063 6f6e 6361 7465 6e61 7465 7320 7477   concatenates tw
+00016640: 6f20 6f72 206d 6f72 6520 6269 6e61 7279  o or more binary
+00016650: 2076 616c 7565 732e 2049 6620 616e 7920   values. If any 
+00016660: 6f66 2074 6865 2076 616c 7565 7320 6973  of the values is
+00016670: 206e 756c 6c2c 2074 6865 2072 6573 756c   null, the resul
+00016680: 7420 6973 2061 6c73 6f20 6e75 6c6c 2e0a  t is also null..
+00016690: 2020 2020 5468 6520 434f 4e43 4154 5f57      The CONCAT_W
+000166a0: 5320 6f70 6572 6174 6f72 2072 6571 7569  S operator requi
+000166b0: 7265 7320 6174 206c 6561 7374 2074 776f  res at least two
+000166c0: 2061 7267 756d 656e 7473 2c20 616e 6420   arguments, and 
+000166d0: 7573 6573 2074 6865 2066 6972 7374 2061  uses the first a
+000166e0: 7267 756d 656e 7420 746f 2073 6570 6172  rgument to separ
+000166f0: 6174 6520 616c 6c20 666f 6c6c 6f77 696e  ate all followin
+00016700: 6720 6172 6775 6d65 6e74 732e 0a0a 2020  g arguments...  
+00016710: 2020 4578 616d 706c 6573 3a3a 0a20 2020    Examples::.   
+00016720: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00016730: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00016740: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+00016750: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
+00016760: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00016770: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00016780: 5b5b 2748 656c 6c6f 272c 2027 576f 726c  [['Hello', 'Worl
+00016790: 6427 5d5d 2c20 7363 6865 6d61 3d5b 2761  d']], schema=['a
+000167a0: 272c 2027 6227 5d29 0a20 2020 2020 2020  ', 'b']).       
+000167b0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
+000167c0: 6f6e 6361 745f 7773 286c 6974 2827 2c27  oncat_ws(lit(','
+000167d0: 292c 2064 662e 612c 2064 662e 6229 292e  ), df.a, df.b)).
+000167e0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+000167f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016810: 2d0a 2020 2020 2020 2020 7c22 434f 4e43  -.        |"CONC
+00016820: 4154 5f57 5328 272c 272c 2022 2241 2222  AT_WS(',', ""A""
+00016830: 2c20 2222 4222 2229 2220 207c 0a20 2020  , ""B"")"  |.   
+00016840: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00016850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016860: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016870: 7c48 656c 6c6f 2c57 6f72 6c64 2020 2020  |Hello,World    
+00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016890: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000168a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000168b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+000168c0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+000168d0: 3e0a 0a20 2020 2020 2020 203e 3e3e 2064  >..        >>> d
+000168e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000168f0: 7465 5f64 6174 6166 7261 6d65 285b 5b27  te_dataframe([['
+00016900: 4865 6c6c 6f27 2c20 2757 6f72 6c64 272c  Hello', 'World',
+00016910: 2027 2c27 5d5d 2c20 7363 6865 6d61 3d5b   ',']], schema=[
+00016920: 2761 272c 2027 6227 2c20 2773 6570 275d  'a', 'b', 'sep']
+00016930: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00016940: 2e73 656c 6563 7428 636f 6e63 6174 5f77  .select(concat_w
+00016950: 7328 2773 6570 272c 2064 662e 612c 2064  s('sep', df.a, d
+00016960: 662e 6229 292e 7368 6f77 2829 0a20 2020  f.b)).show().   
+00016970: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00016980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000169a0: 2020 2020 7c22 434f 4e43 4154 5f57 5328      |"CONCAT_WS(
+000169b0: 2222 5345 5022 222c 2022 2241 2222 2c20  ""SEP"", ""A"", 
+000169c0: 2222 4222 2229 2220 207c 0a20 2020 2020  ""B"")"  |.     
+000169d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+000169e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000169f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00016a00: 2020 7c48 656c 6c6f 2c57 6f72 6c64 2020    |Hello,World  
+00016a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a20: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00016a30: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00016a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016a50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016a60: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+00016a70: 2222 220a 2020 2020 636f 6c75 6d6e 7320  """.    columns 
+00016a80: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
+00016a90: 7228 632c 2022 636f 6e63 6174 5f77 7322  r(c, "concat_ws"
+00016aa0: 2920 666f 7220 6320 696e 2063 6f6c 735d  ) for c in cols]
+00016ab0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00016ac0: 7469 6e28 2263 6f6e 6361 745f 7773 2229  tin("concat_ws")
+00016ad0: 282a 636f 6c75 6d6e 7329 0a0a 0a64 6566  (*columns)...def
+00016ae0: 2074 7261 6e73 6c61 7465 280a 2020 2020   translate(.    
+00016af0: 7372 633a 2043 6f6c 756d 6e4f 724e 616d  src: ColumnOrNam
+00016b00: 652c 0a20 2020 2073 6f75 7263 655f 616c  e,.    source_al
+00016b10: 7068 6162 6574 3a20 436f 6c75 6d6e 4f72  phabet: ColumnOr
+00016b20: 4e61 6d65 2c0a 2020 2020 7461 7267 6574  Name,.    target
+00016b30: 5f61 6c70 6861 6265 743a 2043 6f6c 756d  _alphabet: Colum
+00016b40: 6e4f 724e 616d 652c 0a29 202d 3e20 436f  nOrName,.) -> Co
+00016b50: 6c75 6d6e 3a0a 2020 2020 2222 2254 7261  lumn:.    """Tra
+00016b60: 6e73 6c61 7465 7320 7372 6320 6672 6f6d  nslates src from
+00016b70: 2074 6865 2063 6861 7261 6374 6572 7320   the characters 
+00016b80: 696e 2073 6f75 7263 655f 616c 7068 6162  in source_alphab
+00016b90: 6574 2074 6f20 7468 6520 6368 6172 6163  et to the charac
+00016ba0: 7465 7273 2069 6e0a 2020 2020 7461 7267  ters in.    targ
+00016bb0: 6574 5f61 6c70 6861 6265 742e 2045 6163  et_alphabet. Eac
+00016bc0: 6820 6368 6172 6163 7465 7220 6d61 7463  h character matc
+00016bd0: 6869 6e67 2061 2063 6861 7261 6374 6572  hing a character
+00016be0: 2061 7420 706f 7369 7469 6f6e 2069 2069   at position i i
+00016bf0: 6e20 7468 6520 736f 7572 6365 5f61 6c70  n the source_alp
+00016c00: 6861 6265 7420 6973 2072 6570 6c61 6365  habet is replace
+00016c10: 640a 2020 2020 7769 7468 2074 6865 2063  d.    with the c
+00016c20: 6861 7261 6374 6572 2061 7420 706f 7369  haracter at posi
+00016c30: 7469 6f6e 2069 2069 6e20 7468 6520 7461  tion i in the ta
+00016c40: 7267 6574 5f61 6c70 6861 6265 742e 2049  rget_alphabet. I
+00016c50: 6620 7461 7267 6574 5f61 6c70 6861 6265  f target_alphabe
+00016c60: 7420 6973 2073 686f 7274 6572 2c20 616e  t is shorter, an
+00016c70: 6420 7468 6572 6520 6973 206e 6f20 636f  d there is no co
+00016c80: 7272 6573 706f 6e64 696e 670a 2020 2020  rresponding.    
+00016c90: 6368 6172 6163 7465 7220 7468 6520 6368  character the ch
+00016ca0: 6172 6163 7465 7220 6973 206f 6d69 7474  aracter is omitt
+00016cb0: 6564 2e20 7461 7267 6574 5f61 6c70 6861  ed. target_alpha
+00016cc0: 6265 7420 6361 6e20 6e6f 7420 6265 206c  bet can not be l
+00016cd0: 6f6e 6765 7220 7468 616e 2073 6f75 7263  onger than sourc
+00016ce0: 655f 616c 7068 6162 6574 2e0a 0a20 2020  e_alphabet...   
+00016cf0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00016d00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00016d10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00016d20: 6672 616d 6528 5b22 6162 6364 6566 222c  frame(["abcdef",
+00016d30: 2022 6162 6261 225d 2c20 7363 6865 6d61   "abba"], schema
+00016d40: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00016d50: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
+00016d60: 616e 736c 6174 6528 636f 6c28 2261 2229  anslate(col("a")
+00016d70: 2c20 6c69 7428 2261 6263 2229 2c20 6c69  , lit("abc"), li
+00016d80: 7428 2241 4243 2229 292e 6173 5f28 2261  t("ABC")).as_("a
+00016d90: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
+00016da0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+00016db0: 3d27 4142 4364 6566 2729 2c20 526f 7728  ='ABCdef'), Row(
+00016dc0: 414e 533d 2741 4242 4127 295d 0a0a 2020  ANS='ABBA')]..  
+00016dd0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00016de0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00016df0: 7461 6672 616d 6528 5b22 6669 6c65 2077  taframe(["file w
+00016e00: 6974 6820 7370 6163 6573 2e74 7874 222c  ith spaces.txt",
+00016e10: 2022 5c5c 7474 6573 7422 5d2c 2073 6368   "\\ttest"], sch
+00016e20: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00016e30: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00016e40: 2874 7261 6e73 6c61 7465 2863 6f6c 2822  (translate(col("
+00016e50: 6122 292c 206c 6974 2822 205c 5c74 2229  a"), lit(" \\t")
+00016e60: 2c20 6c69 7428 225f 2229 292e 6173 5f28  , lit("_")).as_(
+00016e70: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
+00016e80: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+00016e90: 4e53 3d27 6669 6c65 5f77 6974 685f 7370  NS='file_with_sp
+00016ea0: 6163 6573 2e74 7874 2729 2c20 526f 7728  aces.txt'), Row(
+00016eb0: 414e 533d 2774 6573 7427 295d 0a0a 2020  ANS='test')]..  
+00016ec0: 2020 2222 220a 2020 2020 736f 7572 6365    """.    source
+00016ed0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00016ee0: 7228 7372 632c 2022 7472 616e 736c 6174  r(src, "translat
+00016ef0: 6522 290a 2020 2020 736f 7572 6365 5f61  e").    source_a
+00016f00: 6c70 6861 6265 7420 3d20 5f74 6f5f 636f  lphabet = _to_co
+00016f10: 6c5f 6966 5f73 7472 2873 6f75 7263 655f  l_if_str(source_
+00016f20: 616c 7068 6162 6574 2c20 2274 7261 6e73  alphabet, "trans
+00016f30: 6c61 7465 2229 0a20 2020 2074 6172 6765  late").    targe
+00016f40: 745f 616c 7068 6162 6574 203d 205f 746f  t_alphabet = _to
+00016f50: 5f63 6f6c 5f69 665f 7374 7228 7461 7267  _col_if_str(targ
+00016f60: 6574 5f61 6c70 6861 6265 742c 2022 7472  et_alphabet, "tr
+00016f70: 616e 736c 6174 6522 290a 2020 2020 7265  anslate").    re
+00016f80: 7475 726e 2062 7569 6c74 696e 2822 7472  turn builtin("tr
+00016f90: 616e 736c 6174 6522 2928 736f 7572 6365  anslate")(source
+00016fa0: 2c20 736f 7572 6365 5f61 6c70 6861 6265  , source_alphabe
+00016fb0: 742c 2074 6172 6765 745f 616c 7068 6162  t, target_alphab
+00016fc0: 6574 290a 0a0a 6465 6620 636f 6e74 6169  et)...def contai
+00016fd0: 6e73 2863 6f6c 3a20 436f 6c75 6d6e 4f72  ns(col: ColumnOr
+00016fe0: 4e61 6d65 2c20 7374 7269 6e67 3a20 436f  Name, string: Co
+00016ff0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00017000: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00017010: 7475 726e 7320 6966 2060 636f 6c60 2063  turns if `col` c
+00017020: 6f6e 7461 696e 7320 6073 7472 696e 6760  ontains `string`
+00017030: 2066 6f72 2065 6163 6820 726f 772e 2053   for each row. S
+00017040: 6565 2060 434f 4e54 4149 4e53 203c 6874  ee `CONTAINS <ht
+00017050: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
+00017060: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
+00017070: 7265 6665 7265 6e63 652f 6675 6e63 7469  reference/functi
+00017080: 6f6e 732f 636f 6e74 6169 6e73 3e60 0a0a  ons/contains>`..
+00017090: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+000170a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000170b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000170c0: 6166 7261 6d65 285b 5b31 2c32 5d2c 205b  aframe([[1,2], [
+000170d0: 332c 345d 2c20 5b35 2c35 5d20 5d2c 2073  3,4], [5,5] ], s
+000170e0: 6368 656d 613d 5b22 6122 2c22 6222 5d29  chema=["a","b"])
+000170f0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00017100: 7365 6c65 6374 2863 6f6e 7461 696e 7328  select(contains(
+00017110: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
+00017120: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
+00017130: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+00017140: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00017150: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+00017160: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+00017170: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00017180: 2020 207c 4661 6c73 6520 2020 2020 7c0a     |False     |.
+00017190: 2020 2020 2020 2020 7c46 616c 7365 2020          |False  
+000171a0: 2020 207c 0a20 2020 2020 2020 207c 5472     |.        |Tr
+000171b0: 7565 2020 2020 2020 7c0a 2020 2020 2020  ue      |.      
+000171c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
 000171d0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000171e0: 453e 0a0a 2020 2020 4172 6773 3a0a 2020  E>..    Args:.  
-000171f0: 2020 2020 2020 7061 7274 3a20 5468 6520        part: The 
-00017200: 7469 6d65 2070 6172 7420 746f 2075 7365  time part to use
-00017210: 2066 6f72 2063 616c 6375 6c61 7469 6e67   for calculating
-00017220: 2074 6865 2064 6966 6665 7265 6e63 650a   the difference.
-00017230: 2020 2020 2020 2020 636f 6c31 3a20 5468          col1: Th
-00017240: 6520 6669 7273 7420 7469 6d65 7374 616d  e first timestam
-00017250: 7020 636f 6c75 6d6e 206f 7220 6d69 6e75  p column or minu
-00017260: 656e 6420 696e 2074 6865 2064 6174 6564  end in the dated
-00017270: 6966 660a 2020 2020 2020 2020 636f 6c32  iff.        col2
-00017280: 3a20 5468 6520 7365 636f 6e64 2074 696d  : The second tim
-00017290: 6573 7461 6d70 2063 6f6c 756d 6e20 6f72  estamp column or
-000172a0: 2074 6865 2073 7562 7472 6168 656e 6420   the subtrahend 
-000172b0: 696e 2074 6865 2064 6174 6564 6966 660a  in the datediff.
-000172c0: 2020 2020 2222 220a 2020 2020 6966 206e      """.    if n
-000172d0: 6f74 2069 7369 6e73 7461 6e63 6528 7061  ot isinstance(pa
-000172e0: 7274 2c20 7374 7229 3a0a 2020 2020 2020  rt, str):.      
-000172f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00017300: 6f72 2822 7061 7274 206d 7573 7420 6265  or("part must be
-00017310: 2061 2073 7472 696e 6722 290a 2020 2020   a string").    
-00017320: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
-00017330: 7374 7228 636f 6c31 2c20 2264 6174 6564  str(col1, "dated
-00017340: 6966 6622 290a 2020 2020 6332 203d 205f  iff").    c2 = _
-00017350: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-00017360: 6c32 2c20 2264 6174 6564 6966 6622 290a  l2, "datediff").
-00017370: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00017380: 696e 2822 6461 7465 6469 6666 2229 2870  in("datediff")(p
-00017390: 6172 742c 2063 312c 2063 3229 0a0a 0a64  art, c1, c2)...d
-000173a0: 6566 2074 7275 6e63 2865 3a20 436f 6c75  ef trunc(e: Colu
-000173b0: 6d6e 4f72 4e61 6d65 2c20 7363 616c 653a  mnOrName, scale:
-000173c0: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
-000173d0: 616d 652c 2069 6e74 2c20 666c 6f61 745d  ame, int, float]
-000173e0: 203d 2030 2920 2d3e 2043 6f6c 756d 6e3a   = 0) -> Column:
-000173f0: 0a20 2020 2022 2222 526f 756e 6473 2074  .    """Rounds t
-00017400: 6865 2069 6e70 7574 2065 7870 7265 7373  he input express
-00017410: 696f 6e20 646f 776e 2074 6f20 7468 6520  ion down to the 
-00017420: 6e65 6172 6573 7420 286f 7220 6571 7561  nearest (or equa
-00017430: 6c29 2069 6e74 6567 6572 2063 6c6f 7365  l) integer close
-00017440: 7220 746f 207a 6572 6f2c 0a20 2020 206f  r to zero,.    o
-00017450: 7220 746f 2074 6865 206e 6561 7265 7374  r to the nearest
-00017460: 2065 7175 616c 206f 7220 736d 616c 6c65   equal or smalle
-00017470: 7220 7661 6c75 6520 7769 7468 2074 6865  r value with the
-00017480: 2073 7065 6369 6669 6564 206e 756d 6265   specified numbe
-00017490: 7220 6f66 0a20 2020 2070 6c61 6365 7320  r of.    places 
-000174a0: 6166 7465 7220 7468 6520 6465 6369 6d61  after the decima
-000174b0: 6c20 706f 696e 742e 0a0a 2020 2020 4578  l point...    Ex
-000174c0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-000174d0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000174e0: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
-000174f0: 6528 5b2d 312e 302c 202d 302e 392c 202d  e([-1.0, -0.9, -
-00017500: 2e35 2c20 2d2e 322c 2030 2e30 2c20 302e  .5, -.2, 0.0, 0.
-00017510: 322c 2030 2e35 2c20 302e 392c 2031 2e31  2, 0.5, 0.9, 1.1
-00017520: 2c20 332e 3134 3135 395d 2c20 7363 6865  , 3.14159], sche
-00017530: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00017540: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00017550: 7472 756e 6328 636f 6c28 2261 2229 2929  trunc(col("a")))
-00017560: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00017570: 2020 205b 526f 7728 5452 554e 4328 2241     [Row(TRUNC("A
-00017580: 222c 2030 293d 2d31 2e30 292c 2052 6f77  ", 0)=-1.0), Row
-00017590: 2854 5255 4e43 2822 4122 2c20 3029 3d30  (TRUNC("A", 0)=0
-000175a0: 2e30 292c 2052 6f77 2854 5255 4e43 2822  .0), Row(TRUNC("
-000175b0: 4122 2c20 3029 3d30 2e30 292c 2052 6f77  A", 0)=0.0), Row
-000175c0: 2854 5255 4e43 2822 4122 2c20 3029 3d30  (TRUNC("A", 0)=0
-000175d0: 2e30 292c 2052 6f77 2854 5255 4e43 2822  .0), Row(TRUNC("
-000175e0: 4122 2c20 3029 3d30 2e30 292c 2052 6f77  A", 0)=0.0), Row
-000175f0: 2854 5255 4e43 2822 4122 2c20 3029 3d30  (TRUNC("A", 0)=0
-00017600: 2e30 292c 2052 6f77 2854 5255 4e43 2822  .0), Row(TRUNC("
-00017610: 4122 2c20 3029 3d30 2e30 292c 2052 6f77  A", 0)=0.0), Row
-00017620: 2854 5255 4e43 2822 4122 2c20 3029 3d30  (TRUNC("A", 0)=0
-00017630: 2e30 292c 2052 6f77 2854 5255 4e43 2822  .0), Row(TRUNC("
-00017640: 4122 2c20 3029 3d31 2e30 292c 2052 6f77  A", 0)=1.0), Row
-00017650: 2854 5255 4e43 2822 4122 2c20 3029 3d33  (TRUNC("A", 0)=3
-00017660: 2e30 295d 0a0a 2020 2020 2020 2020 3e3e  .0)]..        >>
-00017670: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00017680: 7265 6174 6544 6174 6146 7261 6d65 285b  reateDataFrame([
-00017690: 2d31 2e33 3233 2c20 342e 3536 372c 2030  -1.323, 4.567, 0
-000176a0: 2e30 3132 335d 2c20 7363 6865 6d61 3d5b  .0123], schema=[
-000176b0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-000176c0: 3e20 6466 2e73 656c 6563 7428 7472 756e  > df.select(trun
-000176d0: 6328 636f 6c28 2261 2229 2c20 6c69 7428  c(col("a"), lit(
-000176e0: 3029 2929 2e63 6f6c 6c65 6374 2829 0a20  0))).collect(). 
-000176f0: 2020 2020 2020 205b 526f 7728 5452 554e         [Row(TRUN
-00017700: 4328 2241 222c 2030 293d 2d31 2e30 292c  C("A", 0)=-1.0),
-00017710: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
-00017720: 3029 3d34 2e30 292c 2052 6f77 2854 5255  0)=4.0), Row(TRU
-00017730: 4e43 2822 4122 2c20 3029 3d30 2e30 295d  NC("A", 0)=0.0)]
-00017740: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00017750: 7365 6c65 6374 2874 7275 6e63 2863 6f6c  select(trunc(col
-00017760: 2822 6122 292c 206c 6974 2831 2929 292e  ("a"), lit(1))).
-00017770: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00017780: 2020 5b52 6f77 2854 5255 4e43 2822 4122    [Row(TRUNC("A"
-00017790: 2c20 3129 3d2d 312e 3329 2c20 526f 7728  , 1)=-1.3), Row(
-000177a0: 5452 554e 4328 2241 222c 2031 293d 342e  TRUNC("A", 1)=4.
-000177b0: 3529 2c20 526f 7728 5452 554e 4328 2241  5), Row(TRUNC("A
-000177c0: 222c 2031 293d 302e 3029 5d0a 2020 2020  ", 1)=0.0)].    
-000177d0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000177e0: 7428 7472 756e 6328 636f 6c28 2261 2229  t(trunc(col("a")
-000177f0: 2c20 6c69 7428 3229 2929 2e63 6f6c 6c65  , lit(2))).colle
-00017800: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00017810: 7728 5452 554e 4328 2241 222c 2032 293d  w(TRUNC("A", 2)=
-00017820: 2d31 2e33 3229 2c20 526f 7728 5452 554e  -1.32), Row(TRUN
-00017830: 4328 2241 222c 2032 293d 342e 3536 292c  C("A", 2)=4.56),
-00017840: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
-00017850: 3229 3d30 2e30 3129 5d0a 0a20 2020 204e  2)=0.01)]..    N
-00017860: 6f74 6520 7468 6174 2074 6865 2066 756e  ote that the fun
-00017870: 6374 696f 6e20 6060 7472 756e 6360 6020  ction ``trunc`` 
-00017880: 6973 206f 7665 726c 6f61 6465 6420 7769  is overloaded wi
-00017890: 7468 2060 6064 6174 655f 7472 756e 6360  th ``date_trunc`
-000178a0: 6020 666f 7220 6461 7465 7469 6d65 2074  ` for datetime t
-000178b0: 7970 6573 2e20 4974 2061 6c6c 6f77 7320  ypes. It allows 
-000178c0: 746f 2072 6f75 6e64 2064 6174 6574 696d  to round datetim
-000178d0: 650a 2020 2020 6f62 6a65 6374 732e 0a0a  e.    objects...
-000178e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-000178f0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00017900: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
-00017910: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00017920: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
-00017930: 616d 6528 5b64 6174 6574 696d 652e 6461  ame([datetime.da
-00017940: 7465 2832 3032 322c 2031 322c 2032 3529  te(2022, 12, 25)
-00017950: 2c20 6461 7465 7469 6d65 2e64 6174 6528  , datetime.date(
-00017960: 3230 3232 2c20 312c 2031 3029 2c20 6461  2022, 1, 10), da
-00017970: 7465 7469 6d65 2e64 6174 6528 3230 3232  tetime.date(2022
-00017980: 2c20 372c 2037 295d 2c20 7363 6865 6d61  , 7, 7)], schema
-00017990: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-000179a0: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
-000179b0: 756e 6328 636f 6c28 2261 2229 2c20 6c69  unc(col("a"), li
-000179c0: 7428 2251 5541 5254 4552 2229 2929 2e63  t("QUARTER"))).c
-000179d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-000179e0: 205b 526f 7728 5452 554e 4328 2241 222c   [Row(TRUNC("A",
-000179f0: 2027 5155 4152 5445 5227 293d 6461 7465   'QUARTER')=date
-00017a00: 7469 6d65 2e64 6174 6528 3230 3232 2c20  time.date(2022, 
-00017a10: 3130 2c20 3129 292c 2052 6f77 2854 5255  10, 1)), Row(TRU
-00017a20: 4e43 2822 4122 2c20 2751 5541 5254 4552  NC("A", 'QUARTER
-00017a30: 2729 3d64 6174 6574 696d 652e 6461 7465  ')=datetime.date
-00017a40: 2832 3032 322c 2031 2c20 3129 292c 2052  (2022, 1, 1)), R
-00017a50: 6f77 2854 5255 4e43 2822 4122 2c20 2751  ow(TRUNC("A", 'Q
-00017a60: 5541 5254 4552 2729 3d64 6174 6574 696d  UARTER')=datetim
-00017a70: 652e 6461 7465 2832 3032 322c 2037 2c20  e.date(2022, 7, 
-00017a80: 3129 295d 0a0a 2020 2020 2020 2020 3e3e  1))]..        >>
-00017a90: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00017aa0: 7265 6174 6544 6174 6146 7261 6d65 285b  reateDataFrame([
-00017ab0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00017ac0: 6528 3230 3232 2c20 3132 2c20 3235 2c20  e(2022, 12, 25, 
-00017ad0: 3133 2c20 3539 2c20 3338 2c20 3436 3729  13, 59, 38, 467)
-00017ae0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00017af0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00017b00: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00017b10: 2020 5b52 6f77 2841 3d64 6174 6574 696d    [Row(A=datetim
-00017b20: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-00017b30: 2031 322c 2032 352c 2031 332c 2035 392c   12, 25, 13, 59,
-00017b40: 2033 382c 2034 3637 2929 5d0a 2020 2020   38, 467))].    
-00017b50: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00017b60: 7428 7472 756e 6328 636f 6c28 2261 2229  t(trunc(col("a")
-00017b70: 2c20 6c69 7428 224d 494e 5554 4522 2929  , lit("MINUTE"))
-00017b80: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00017b90: 2020 2020 5b52 6f77 2854 5255 4e43 2822      [Row(TRUNC("
-00017ba0: 4122 2c20 274d 494e 5554 4527 293d 6461  A", 'MINUTE')=da
-00017bb0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-00017bc0: 3230 3232 2c20 3132 2c20 3235 2c20 3133  2022, 12, 25, 13
-00017bd0: 2c20 3539 2929 5d0a 0a20 2020 2022 2222  , 59))]..    """
-00017be0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00017bf0: 5f69 665f 7374 7228 652c 2022 7472 756e  _if_str(e, "trun
-00017c00: 6322 290a 2020 2020 7363 616c 655f 636f  c").    scale_co
-00017c10: 6c20 3d20 280a 2020 2020 2020 2020 6c69  l = (.        li
-00017c20: 7428 7363 616c 6529 0a20 2020 2020 2020  t(scale).       
-00017c30: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-00017c40: 6361 6c65 2c20 2869 6e74 2c20 666c 6f61  cale, (int, floa
-00017c50: 7429 290a 2020 2020 2020 2020 656c 7365  t)).        else
-00017c60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00017c70: 7363 616c 652c 2022 7472 756e 6322 290a  scale, "trunc").
-00017c80: 2020 2020 290a 2020 2020 7265 7475 726e      ).    return
-00017c90: 2062 7569 6c74 696e 2822 7472 756e 6322   builtin("trunc"
-00017ca0: 2928 632c 2073 6361 6c65 5f63 6f6c 290a  )(c, scale_col).
-00017cb0: 0a0a 6465 6620 6461 7465 6164 6428 7061  ..def dateadd(pa
-00017cc0: 7274 3a20 7374 722c 2063 6f6c 313a 2043  rt: str, col1: C
-00017cd0: 6f6c 756d 6e4f 724e 616d 652c 2063 6f6c  olumnOrName, col
-00017ce0: 323a 2043 6f6c 756d 6e4f 724e 616d 6529  2: ColumnOrName)
-00017cf0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00017d00: 2222 2241 6464 7320 7468 6520 7370 6563  """Adds the spec
-00017d10: 6966 6965 6420 7661 6c75 6520 666f 7220  ified value for 
-00017d20: 7468 6520 7370 6563 6966 6965 6420 6461  the specified da
-00017d30: 7465 206f 7220 7469 6d65 2070 6172 7420  te or time part 
-00017d40: 746f 2064 6174 6520 6f72 2074 696d 6520  to date or time 
-00017d50: 6578 7072 2e0a 0a20 2020 2060 5375 7070  expr...    `Supp
-00017d60: 6f72 7465 6420 6461 7465 2061 6e64 2074  orted date and t
-00017d70: 696d 6520 7061 7274 7320 3c68 7474 7073  ime parts <https
-00017d80: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
-00017d90: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
-00017da0: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
-00017db0: 2d64 6174 652d 7469 6d65 2e68 746d 6c23  -date-time.html#
-00017dc0: 6c61 6265 6c2d 7375 7070 6f72 7465 642d  label-supported-
-00017dd0: 6461 7465 2d74 696d 652d 7061 7274 733e  date-time-parts>
-00017de0: 605f 0a0a 2020 2020 4578 616d 706c 653a  `_..    Example:
-00017df0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2023  :..        >>> #
-00017e00: 2061 6464 206f 6e65 2079 6561 7220 6f6e   add one year on
-00017e10: 2064 6174 6573 0a20 2020 2020 2020 203e   dates.        >
-00017e20: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00017e30: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
-00017e40: 6174 655f 6466 203d 2073 6573 7369 6f6e  ate_df = session
-00017e50: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00017e60: 6528 5b5b 6461 7465 7469 6d65 2e64 6174  e([[datetime.dat
-00017e70: 6528 3230 3230 2c20 312c 2031 295d 5d2c  e(2020, 1, 1)]],
-00017e80: 2073 6368 656d 613d 5b22 6461 7465 5f63   schema=["date_c
-00017e90: 6f6c 225d 290a 2020 2020 2020 2020 3e3e  ol"]).        >>
-00017ea0: 3e20 6461 7465 5f64 662e 7365 6c65 6374  > date_df.select
-00017eb0: 2864 6174 6561 6464 2822 7965 6172 222c  (dateadd("year",
-00017ec0: 206c 6974 2831 292c 2063 6f6c 2822 6461   lit(1), col("da
-00017ed0: 7465 5f63 6f6c 2229 292e 616c 6961 7328  te_col")).alias(
-00017ee0: 2279 6561 725f 6164 6465 6422 2929 2e73  "year_added")).s
-00017ef0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00017f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00017f10: 2020 2020 2020 207c 2259 4541 525f 4144         |"YEAR_AD
-00017f20: 4445 4422 2020 7c0a 2020 2020 2020 2020  DED"  |.        
-00017f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00017f40: 0a20 2020 2020 2020 207c 3230 3231 2d30  .        |2021-0
-00017f50: 312d 3031 2020 2020 7c0a 2020 2020 2020  1-01    |.      
-00017f60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00017f70: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00017f80: 4b4c 494e 453e 0a20 2020 2020 2020 203e  KLINE>.        >
-00017f90: 3e3e 2064 6174 655f 6466 2e73 656c 6563  >> date_df.selec
-00017fa0: 7428 6461 7465 6164 6428 226d 6f6e 7468  t(dateadd("month
-00017fb0: 222c 206c 6974 2831 292c 2063 6f6c 2822  ", lit(1), col("
-00017fc0: 6461 7465 5f63 6f6c 2229 292e 616c 6961  date_col")).alia
-00017fd0: 7328 226d 6f6e 7468 5f61 6464 6564 2229  s("month_added")
-00017fe0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00017ff0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00018000: 2d2d 0a20 2020 2020 2020 207c 224d 4f4e  --.        |"MON
-00018010: 5448 5f41 4444 4544 2220 207c 0a20 2020  TH_ADDED"  |.   
-00018020: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00018030: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00018040: 3230 3230 2d30 322d 3031 2020 2020 207c  2020-02-01     |
-00018050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00018060: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00018070: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-00018080: 2020 2020 2020 203e 3e3e 2064 6174 655f         >>> date_
-00018090: 6466 2e73 656c 6563 7428 6461 7465 6164  df.select(datead
-000180a0: 6428 2264 6179 222c 206c 6974 2831 292c  d("day", lit(1),
-000180b0: 2063 6f6c 2822 6461 7465 5f63 6f6c 2229   col("date_col")
-000180c0: 292e 616c 6961 7328 2264 6179 5f61 6464  ).alias("day_add
-000180d0: 6564 2229 292e 7368 6f77 2829 0a20 2020  ed")).show().   
-000180e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-000180f0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2244  ----.        |"D
-00018100: 4159 5f41 4444 4544 2220 207c 0a20 2020  AY_ADDED"  |.   
-00018110: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00018120: 2d2d 2d2d 0a20 2020 2020 2020 207c 3230  ----.        |20
-00018130: 3230 2d30 312d 3032 2020 207c 0a20 2020  20-01-02   |.   
-00018140: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00018150: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00018160: 414e 4b4c 494e 453e 0a0a 2020 2020 4172  ANKLINE>..    Ar
-00018170: 6773 3a0a 2020 2020 2020 2020 7061 7274  gs:.        part
-00018180: 3a20 5468 6520 7469 6d65 2070 6172 7420  : The time part 
-00018190: 746f 2075 7365 2066 6f72 2074 6865 2061  to use for the a
-000181a0: 6464 6974 696f 6e0a 2020 2020 2020 2020  ddition.        
-000181b0: 636f 6c31 3a20 5468 6520 6669 7273 7420  col1: The first 
-000181c0: 7469 6d65 7374 616d 7020 636f 6c75 6d6e  timestamp column
-000181d0: 206f 7220 6164 6465 6e64 2069 6e20 7468   or addend in th
-000181e0: 6520 6461 7465 6164 640a 2020 2020 2020  e dateadd.      
-000181f0: 2020 636f 6c32 3a20 5468 6520 7365 636f    col2: The seco
-00018200: 6e64 2074 696d 6573 7461 6d70 2063 6f6c  nd timestamp col
-00018210: 756d 6e20 6f72 2074 6865 2061 6464 656e  umn or the adden
-00018220: 6420 696e 2074 6865 2064 6174 6561 6464  d in the dateadd
-00018230: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-00018240: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-00018250: 6172 742c 2073 7472 293a 0a20 2020 2020  art, str):.     
-00018260: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00018270: 726f 7228 2270 6172 7420 6d75 7374 2062  ror("part must b
-00018280: 6520 6120 7374 7269 6e67 2229 0a20 2020  e a string").   
-00018290: 2063 3120 3d20 5f74 6f5f 636f 6c5f 6966   c1 = _to_col_if
-000182a0: 5f73 7472 2863 6f6c 312c 2022 6461 7465  _str(col1, "date
-000182b0: 6164 6422 290a 2020 2020 6332 203d 205f  add").    c2 = _
-000182c0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-000182d0: 6c32 2c20 2264 6174 6561 6464 2229 0a20  l2, "dateadd"). 
-000182e0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-000182f0: 6e28 2264 6174 6561 6464 2229 2870 6172  n("dateadd")(par
-00018300: 742c 2063 312c 2063 3229 0a0a 0a64 6566  t, c1, c2)...def
-00018310: 2064 6174 655f 7061 7274 2870 6172 743a   date_part(part:
-00018320: 2073 7472 2c20 653a 2043 6f6c 756d 6e4f   str, e: ColumnO
-00018330: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00018340: 3a0a 2020 2020 2222 220a 2020 2020 4578  :.    """.    Ex
-00018350: 7472 6163 7473 2074 6865 2073 7065 6369  tracts the speci
-00018360: 6669 6564 2064 6174 6520 6f72 2074 696d  fied date or tim
-00018370: 6520 7061 7274 2066 726f 6d20 6120 6461  e part from a da
-00018380: 7465 2c20 7469 6d65 2c20 6f72 2074 696d  te, time, or tim
-00018390: 6573 7461 6d70 2e20 5365 650a 2020 2020  estamp. See.    
-000183a0: 6044 4154 455f 5041 5254 203c 6874 7470  `DATE_PART <http
-000183b0: 733a 2f2f 646f 6373 2e73 6e6f 7766 6c61  s://docs.snowfla
-000183c0: 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d 7265  ke.com/en/sql-re
-000183d0: 6665 7265 6e63 652f 6675 6e63 7469 6f6e  ference/function
-000183e0: 732f 6461 7465 5f70 6172 742e 6874 6d6c  s/date_part.html
-000183f0: 3e60 5f20 666f 7220 6465 7461 696c 732e  >`_ for details.
-00018400: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-00018410: 2020 2020 7061 7274 3a20 5468 6520 7469      part: The ti
-00018420: 6d65 2070 6172 7420 746f 2075 7365 2066  me part to use f
-00018430: 6f72 2074 6865 2061 6464 6974 696f 6e2e  or the addition.
-00018440: 0a20 2020 2020 2020 2065 3a20 5468 6520  .        e: The 
-00018450: 636f 6c75 6d6e 2065 7870 7265 7373 696f  column expressio
-00018460: 6e20 6f66 2061 2064 6174 652c 2074 696d  n of a date, tim
-00018470: 652c 206f 7220 7469 6d65 7374 616d 702e  e, or timestamp.
-00018480: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00018490: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-000184a0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-000184b0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000184c0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000184d0: 6166 7261 6d65 285b 5b64 6174 6574 696d  aframe([[datetim
-000184e0: 652e 6461 7465 7469 6d65 2832 3032 332c  e.datetime(2023,
-000184f0: 2031 2c20 312c 2031 2c20 312c 2031 295d   1, 1, 1, 1, 1)]
-00018500: 5d2c 2073 6368 656d 613d 5b22 7473 5f63  ], schema=["ts_c
-00018510: 6f6c 225d 290a 2020 2020 2020 2020 3e3e  ol"]).        >>
-00018520: 3e20 6466 2e73 656c 6563 7428 6461 7465  > df.select(date
-00018530: 5f70 6172 7428 2279 6561 7222 2c20 636f  _part("year", co
-00018540: 6c28 2274 735f 636f 6c22 2929 2e61 6c69  l("ts_col")).ali
-00018550: 6173 2822 7965 6172 2229 2c20 6461 7465  as("year"), date
-00018560: 5f70 6172 7428 2265 706f 6368 5f73 6563  _part("epoch_sec
-00018570: 6f6e 6422 2c20 636f 6c28 2274 735f 636f  ond", col("ts_co
-00018580: 6c22 2929 2e61 6c69 6173 2822 6570 6f63  l")).alias("epoc
-00018590: 685f 7365 636f 6e64 2229 292e 7368 6f77  h_second")).show
-000185a0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-000185b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000185c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-000185d0: 2259 4541 5222 2020 7c22 4550 4f43 485f  "YEAR"  |"EPOCH_
-000185e0: 5345 434f 4e44 2220 207c 0a20 2020 2020  SECOND"  |.     
-000185f0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00018600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00018610: 2020 2020 2020 207c 3230 3233 2020 2020         |2023    
-00018620: 7c31 3637 3235 3334 3836 3120 2020 2020  |1672534861     
-00018630: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00018640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00018650: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00018660: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00018670: 2222 0a20 2020 2069 6620 6e6f 7420 6973  "".    if not is
-00018680: 696e 7374 616e 6365 2870 6172 742c 2073  instance(part, s
-00018690: 7472 293a 0a20 2020 2020 2020 2072 6169  tr):.        rai
-000186a0: 7365 2056 616c 7565 4572 726f 7228 2270  se ValueError("p
-000186b0: 6172 7420 6d75 7374 2062 6520 6120 7374  art must be a st
-000186c0: 7269 6e67 2229 0a20 2020 2063 203d 205f  ring").    c = _
-000186d0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-000186e0: 2022 6461 7465 5f70 6172 7422 290a 2020   "date_part").  
-000186f0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00018700: 2822 6461 7465 5f70 6172 7422 2928 7061  ("date_part")(pa
-00018710: 7274 2c20 6329 0a0a 0a64 6566 2064 6174  rt, c)...def dat
-00018720: 655f 6672 6f6d 5f70 6172 7473 280a 2020  e_from_parts(.  
-00018730: 2020 793a 2055 6e69 6f6e 5b43 6f6c 756d    y: Union[Colum
-00018740: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-00018750: 2020 206d 3a20 556e 696f 6e5b 436f 6c75     m: Union[Colu
-00018760: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
-00018770: 2020 2020 643a 2055 6e69 6f6e 5b43 6f6c      d: Union[Col
-00018780: 756d 6e4f 724e 616d 652c 2069 6e74 5d2c  umnOrName, int],
-00018790: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
-000187a0: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-000187b0: 7320 6120 6461 7465 2066 726f 6d20 696e  s a date from in
-000187c0: 6469 7669 6475 616c 206e 756d 6572 6963  dividual numeric
-000187d0: 2063 6f6d 706f 6e65 6e74 7320 7468 6174   components that
-000187e0: 2072 6570 7265 7365 6e74 2074 6865 2079   represent the y
-000187f0: 6561 722c 206d 6f6e 7468 2c20 616e 6420  ear, month, and 
-00018800: 6461 7920 6f66 2074 6865 206d 6f6e 7468  day of the month
-00018810: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00018820: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00018830: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00018840: 5f64 6174 6166 7261 6d65 285b 5b32 3032  _dataframe([[202
-00018850: 322c 2034 2c20 315d 5d2c 2073 6368 656d  2, 4, 1]], schem
-00018860: 613d 5b22 7965 6172 222c 2022 6d6f 6e74  a=["year", "mont
-00018870: 6822 2c20 2264 6179 225d 290a 2020 2020  h", "day"]).    
-00018880: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00018890: 7428 6461 7465 5f66 726f 6d5f 7061 7274  t(date_from_part
-000188a0: 7328 2279 6561 7222 2c20 226d 6f6e 7468  s("year", "month
-000188b0: 222c 2022 6461 7922 2929 2e63 6f6c 6c65  ", "day")).colle
-000188c0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-000188d0: 7728 4441 5445 5f46 524f 4d5f 5041 5254  w(DATE_FROM_PART
-000188e0: 5328 2259 4541 5222 2c20 224d 4f4e 5448  S("YEAR", "MONTH
-000188f0: 222c 2022 4441 5922 293d 6461 7465 7469  ", "DAY")=dateti
-00018900: 6d65 2e64 6174 6528 3230 3232 2c20 342c  me.date(2022, 4,
-00018910: 2031 2929 5d0a 2020 2020 2020 2020 3e3e   1))].        >>
-00018920: 3e20 7365 7373 696f 6e2e 7461 626c 6528  > session.table(
-00018930: 2264 7561 6c22 292e 7365 6c65 6374 2864  "dual").select(d
-00018940: 6174 655f 6672 6f6d 5f70 6172 7473 2832  ate_from_parts(2
-00018950: 3032 322c 2034 2c20 3129 292e 636f 6c6c  022, 4, 1)).coll
-00018960: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00018970: 6f77 2844 4154 455f 4652 4f4d 5f50 4152  ow(DATE_FROM_PAR
-00018980: 5453 2832 3032 322c 2034 2c20 3129 3d64  TS(2022, 4, 1)=d
-00018990: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-000189a0: 322c 2034 2c20 3129 295d 0a20 2020 2022  2, 4, 1))].    "
-000189b0: 2222 0a20 2020 2079 5f63 6f6c 203d 205f  "".    y_col = _
-000189c0: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
-000189d0: 5f69 6e74 2879 2c20 2264 6174 655f 6672  _int(y, "date_fr
-000189e0: 6f6d 5f70 6172 7473 2229 0a20 2020 206d  om_parts").    m
-000189f0: 5f63 6f6c 203d 205f 746f 5f63 6f6c 5f69  _col = _to_col_i
-00018a00: 665f 7374 725f 6f72 5f69 6e74 286d 2c20  f_str_or_int(m, 
-00018a10: 2264 6174 655f 6672 6f6d 5f70 6172 7473  "date_from_parts
-00018a20: 2229 0a20 2020 2064 5f63 6f6c 203d 205f  ").    d_col = _
-00018a30: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
-00018a40: 5f69 6e74 2864 2c20 2264 6174 655f 6672  _int(d, "date_fr
-00018a50: 6f6d 5f70 6172 7473 2229 0a20 2020 2072  om_parts").    r
-00018a60: 6574 7572 6e20 6275 696c 7469 6e28 2264  eturn builtin("d
-00018a70: 6174 655f 6672 6f6d 5f70 6172 7473 2229  ate_from_parts")
-00018a80: 2879 5f63 6f6c 2c20 6d5f 636f 6c2c 2064  (y_col, m_col, d
-00018a90: 5f63 6f6c 290a 0a0a 6465 6620 6461 7465  _col)...def date
-00018aa0: 5f74 7275 6e63 2870 6172 743a 2043 6f6c  _trunc(part: Col
-00018ab0: 756d 6e4f 724e 616d 652c 2065 7870 723a  umnOrName, expr:
-00018ac0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00018ad0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00018ae0: 220a 2020 2020 5472 756e 6361 7465 7320  ".    Truncates 
-00018af0: 6120 4441 5445 2c20 5449 4d45 2c20 6f72  a DATE, TIME, or
-00018b00: 2054 494d 4553 5441 4d50 2074 6f20 7468   TIMESTAMP to th
-00018b10: 6520 7370 6563 6966 6965 6420 7072 6563  e specified prec
-00018b20: 6973 696f 6e2e 0a0a 2020 2020 4e6f 7465  ision...    Note
-00018b30: 2074 6861 7420 7472 756e 6361 7469 6f6e   that truncation
-00018b40: 2069 7320 6e6f 7420 7468 6520 7361 6d65   is not the same
-00018b50: 2061 7320 6578 7472 6163 7469 6f6e 2e20   as extraction. 
-00018b60: 466f 7220 6578 616d 706c 653a 0a20 2020  For example:.   
-00018b70: 202d 2054 7275 6e63 6174 696e 6720 6120   - Truncating a 
-00018b80: 7469 6d65 7374 616d 7020 646f 776e 2074  timestamp down t
-00018b90: 6f20 7468 6520 7175 6172 7465 7220 7265  o the quarter re
-00018ba0: 7475 726e 7320 7468 6520 7469 6d65 7374  turns the timest
-00018bb0: 616d 7020 636f 7272 6573 706f 6e64 696e  amp correspondin
-00018bc0: 6720 746f 206d 6964 6e69 6768 7420 6f66  g to midnight of
-00018bd0: 2074 6865 2066 6972 7374 2064 6179 206f   the first day o
-00018be0: 6620 7468 650a 2020 2020 7175 6172 7465  f the.    quarte
-00018bf0: 7220 666f 7220 7468 6520 696e 7075 7420  r for the input 
-00018c00: 7469 6d65 7374 616d 702e 0a20 2020 202d  timestamp..    -
-00018c10: 2045 7874 7261 6374 696e 6720 7468 6520   Extracting the 
-00018c20: 7175 6172 7465 7220 6461 7465 2070 6172  quarter date par
-00018c30: 7420 6672 6f6d 2061 2074 696d 6573 7461  t from a timesta
-00018c40: 6d70 2072 6574 7572 6e73 2074 6865 2071  mp returns the q
-00018c50: 7561 7274 6572 206e 756d 6265 7220 6f66  uarter number of
-00018c60: 2074 6865 2079 6561 7220 696e 2074 6865   the year in the
-00018c70: 2074 696d 6573 7461 6d70 2e0a 0a20 2020   timestamp...   
-00018c80: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-00018c90: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00018ca0: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-00018cb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00018cc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00018cd0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-00018ce0: 2020 5b5b 6461 7465 7469 6d65 2e64 6174    [[datetime.dat
-00018cf0: 6574 696d 652e 7374 7270 7469 6d65 2822  etime.strptime("
-00018d00: 3230 3230 2d30 352d 3031 2031 333a 3131  2020-05-01 13:11
-00018d10: 3a32 302e 3030 3022 2c20 2225 592d 256d  :20.000", "%Y-%m
-00018d20: 2d25 6420 2548 3a25 4d3a 2553 2e25 6622  -%d %H:%M:%S.%f"
-00018d30: 295d 5d2c 0a20 2020 2020 2020 202e 2e2e  )]],.        ...
-00018d40: 2020 2020 2073 6368 656d 613d 5b22 6122       schema=["a"
-00018d50: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
-00018d60: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00018d70: 7365 6c65 6374 2864 6174 655f 7472 756e  select(date_trun
-00018d80: 6328 2259 4541 5222 2c20 2261 2229 2c20  c("YEAR", "a"), 
-00018d90: 6461 7465 5f74 7275 6e63 2822 4d4f 4e54  date_trunc("MONT
-00018da0: 4822 2c20 2261 2229 2c20 6461 7465 5f74  H", "a"), date_t
-00018db0: 7275 6e63 2822 4441 5922 2c20 2261 2229  runc("DAY", "a")
-00018dc0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00018dd0: 2020 2020 5b52 6f77 2844 4154 455f 5452      [Row(DATE_TR
-00018de0: 554e 4328 2259 4541 5222 2c20 2241 2229  UNC("YEAR", "A")
-00018df0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-00018e00: 6d65 2832 3032 302c 2031 2c20 312c 2030  me(2020, 1, 1, 0
-00018e10: 2c20 3029 2c20 4441 5445 5f54 5255 4e43  , 0), DATE_TRUNC
-00018e20: 2822 4d4f 4e54 4822 2c20 2241 2229 3d64  ("MONTH", "A")=d
-00018e30: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-00018e40: 2832 3032 302c 2035 2c20 312c 2030 2c20  (2020, 5, 1, 0, 
-00018e50: 3029 2c20 4441 5445 5f54 5255 4e43 2822  0), DATE_TRUNC("
-00018e60: 4441 5922 2c20 2241 2229 3d64 6174 6574  DAY", "A")=datet
-00018e70: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-00018e80: 302c 2035 2c20 312c 2030 2c20 3029 295d  0, 5, 1, 0, 0))]
-00018e90: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00018ea0: 7365 6c65 6374 2864 6174 655f 7472 756e  select(date_trun
-00018eb0: 6328 2248 4f55 5222 2c20 2261 2229 2c20  c("HOUR", "a"), 
-00018ec0: 6461 7465 5f74 7275 6e63 2822 4d49 4e55  date_trunc("MINU
-00018ed0: 5445 222c 2022 6122 292c 2064 6174 655f  TE", "a"), date_
-00018ee0: 7472 756e 6328 2253 4543 4f4e 4422 2c20  trunc("SECOND", 
-00018ef0: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
-00018f00: 2020 2020 2020 2020 5b52 6f77 2844 4154          [Row(DAT
-00018f10: 455f 5452 554e 4328 2248 4f55 5222 2c20  E_TRUNC("HOUR", 
-00018f20: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
-00018f30: 7465 7469 6d65 2832 3032 302c 2035 2c20  tetime(2020, 5, 
-00018f40: 312c 2031 332c 2030 292c 2044 4154 455f  1, 13, 0), DATE_
-00018f50: 5452 554e 4328 224d 494e 5554 4522 2c20  TRUNC("MINUTE", 
-00018f60: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
-00018f70: 7465 7469 6d65 2832 3032 302c 2035 2c20  tetime(2020, 5, 
-00018f80: 312c 2031 332c 2031 3129 2c20 4441 5445  1, 13, 11), DATE
-00018f90: 5f54 5255 4e43 2822 5345 434f 4e44 222c  _TRUNC("SECOND",
-00018fa0: 2022 4122 293d 6461 7465 7469 6d65 2e64   "A")=datetime.d
-00018fb0: 6174 6574 696d 6528 3230 3230 2c20 352c  atetime(2020, 5,
-00018fc0: 2031 2c20 3133 2c20 3131 2c20 3230 2929   1, 13, 11, 20))
-00018fd0: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-00018fe0: 2e73 656c 6563 7428 6461 7465 5f74 7275  .select(date_tru
-00018ff0: 6e63 2822 5155 4152 5445 5222 2c20 2261  nc("QUARTER", "a
-00019000: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00019010: 2020 2020 2020 5b52 6f77 2844 4154 455f        [Row(DATE_
-00019020: 5452 554e 4328 2251 5541 5254 4552 222c  TRUNC("QUARTER",
-00019030: 2022 4122 293d 6461 7465 7469 6d65 2e64   "A")=datetime.d
-00019040: 6174 6574 696d 6528 3230 3230 2c20 342c  atetime(2020, 4,
-00019050: 2031 2c20 302c 2030 2929 5d0a 2020 2020   1, 0, 0))].    
-00019060: 2222 220a 2020 2020 7061 7274 5f63 6f6c  """.    part_col
-00019070: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00019080: 7228 7061 7274 2c20 2264 6174 655f 7472  r(part, "date_tr
-00019090: 756e 6322 290a 2020 2020 6578 7072 5f63  unc").    expr_c
-000190a0: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
-000190b0: 7374 7228 6578 7072 2c20 2264 6174 655f  str(expr, "date_
-000190c0: 7472 756e 6322 290a 2020 2020 7265 7475  trunc").    retu
-000190d0: 726e 2062 7569 6c74 696e 2822 6461 7465  rn builtin("date
-000190e0: 5f74 7275 6e63 2229 2870 6172 745f 636f  _trunc")(part_co
-000190f0: 6c2c 2065 7870 725f 636f 6c29 0a0a 0a64  l, expr_col)...d
-00019100: 6566 2064 6179 6e61 6d65 2865 3a20 436f  ef dayname(e: Co
-00019110: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00019120: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00019130: 2020 2045 7874 7261 6374 7320 7468 6520     Extracts the 
-00019140: 7468 7265 652d 6c65 7474 6572 2064 6179  three-letter day
-00019150: 2d6f 662d 7765 656b 206e 616d 6520 6672  -of-week name fr
-00019160: 6f6d 2074 6865 2073 7065 6369 6669 6564  om the specified
-00019170: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
-00019180: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
-00019190: 3a3a 0a20 2020 2020 2020 203e 3e3e 2069  ::.        >>> i
-000191a0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-000191b0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000191c0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000191d0: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-000191e0: 2020 2e2e 2e20 2020 2020 5b5b 6461 7465    ...     [[date
-000191f0: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
-00019200: 7270 7469 6d65 2822 3230 3230 2d30 352d  rptime("2020-05-
-00019210: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
-00019220: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
-00019230: 4d3a 2553 2e25 6622 295d 5d2c 0a20 2020  M:%S.%f")]],.   
-00019240: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
-00019250: 656d 613d 5b22 6122 5d2c 0a20 2020 2020  ema=["a"],.     
-00019260: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-00019270: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
-00019280: 6179 6e61 6d65 2822 6122 2929 2e63 6f6c  ayname("a")).col
-00019290: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000192a0: 526f 7728 4441 594e 414d 4528 2241 2229  Row(DAYNAME("A")
-000192b0: 3d27 4672 6927 295d 0a20 2020 2022 2222  ='Fri')].    """
-000192c0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-000192d0: 5f69 665f 7374 7228 652c 2022 6461 796e  _if_str(e, "dayn
-000192e0: 616d 6522 290a 2020 2020 7265 7475 726e  ame").    return
-000192f0: 2062 7569 6c74 696e 2822 6461 796e 616d   builtin("daynam
-00019300: 6522 2928 6329 0a0a 0a64 6566 2064 6179  e")(c)...def day
-00019310: 6f66 6d6f 6e74 6828 653a 2043 6f6c 756d  ofmonth(e: Colum
-00019320: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00019330: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00019340: 4578 7472 6163 7473 2074 6865 2063 6f72  Extracts the cor
-00019350: 7265 7370 6f6e 6469 6e67 2064 6179 2028  responding day (
-00019360: 6e75 6d62 6572 2920 6f66 2074 6865 206d  number) of the m
-00019370: 6f6e 7468 2066 726f 6d20 6120 6461 7465  onth from a date
-00019380: 206f 7220 7469 6d65 7374 616d 702e 0a0a   or timestamp...
-00019390: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-000193a0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-000193b0: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
-000193c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000193d0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000193e0: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-000193f0: 2020 2020 205b 5b64 6174 6574 696d 652e       [[datetime.
-00019400: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
-00019410: 6528 2232 3032 302d 3035 2d30 3120 3133  e("2020-05-01 13
-00019420: 3a31 313a 3230 2e30 3030 222c 2022 2559  :11:20.000", "%Y
-00019430: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
-00019440: 2566 2229 5d5d 2c0a 2020 2020 2020 2020  %f")]],.        
-00019450: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
-00019460: 2261 225d 2c0a 2020 2020 2020 2020 2e2e  "a"],.        ..
-00019470: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-00019480: 6466 2e73 656c 6563 7428 6461 796f 666d  df.select(dayofm
-00019490: 6f6e 7468 2822 6122 2929 2e63 6f6c 6c65  onth("a")).colle
-000194a0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-000194b0: 7728 4441 594f 464d 4f4e 5448 2822 4122  w(DAYOFMONTH("A"
-000194c0: 293d 3129 5d0a 2020 2020 2222 220a 2020  )=1)].    """.  
-000194d0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-000194e0: 5f73 7472 2865 2c20 2264 6179 6f66 6d6f  _str(e, "dayofmo
-000194f0: 6e74 6822 290a 2020 2020 7265 7475 726e  nth").    return
-00019500: 2062 7569 6c74 696e 2822 6461 796f 666d   builtin("dayofm
-00019510: 6f6e 7468 2229 2863 290a 0a0a 6465 6620  onth")(c)...def 
-00019520: 6461 796f 6677 6565 6b28 653a 2043 6f6c  dayofweek(e: Col
-00019530: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00019540: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00019550: 2020 4578 7472 6163 7473 2074 6865 2063    Extracts the c
-00019560: 6f72 7265 7370 6f6e 6469 6e67 2064 6179  orresponding day
-00019570: 2028 6e75 6d62 6572 2920 6f66 2074 6865   (number) of the
-00019580: 2077 6565 6b20 6672 6f6d 2061 2064 6174   week from a dat
-00019590: 6520 6f72 2074 696d 6573 7461 6d70 2e0a  e or timestamp..
-000195a0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-000195b0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-000195c0: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
-000195d0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000195e0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000195f0: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-00019600: 2e20 2020 2020 5b5b 6461 7465 7469 6d65  .     [[datetime
-00019610: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
-00019620: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
-00019630: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
-00019640: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-00019650: 2e25 6622 295d 5d2c 0a20 2020 2020 2020  .%f")]],.       
-00019660: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-00019670: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
-00019680: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-00019690: 2064 662e 7365 6c65 6374 2864 6179 6f66   df.select(dayof
-000196a0: 7765 656b 2822 6122 2929 2e63 6f6c 6c65  week("a")).colle
-000196b0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-000196c0: 7728 4441 594f 4657 4545 4b28 2241 2229  w(DAYOFWEEK("A")
-000196d0: 3d35 295d 0a20 2020 2022 2222 0a20 2020  =5)].    """.   
-000196e0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-000196f0: 7374 7228 652c 2022 6461 796f 6677 6565  str(e, "dayofwee
-00019700: 6b22 290a 2020 2020 7265 7475 726e 2062  k").    return b
-00019710: 7569 6c74 696e 2822 6461 796f 6677 6565  uiltin("dayofwee
-00019720: 6b22 2928 6329 0a0a 0a64 6566 2064 6179  k")(c)...def day
-00019730: 6f66 7965 6172 2865 3a20 436f 6c75 6d6e  ofyear(e: Column
-00019740: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00019750: 6e3a 0a20 2020 2022 2222 0a20 2020 2045  n:.    """.    E
-00019760: 7874 7261 6374 7320 7468 6520 636f 7272  xtracts the corr
-00019770: 6573 706f 6e64 696e 6720 6461 7920 286e  esponding day (n
-00019780: 756d 6265 7229 206f 6620 7468 6520 7965  umber) of the ye
-00019790: 6172 2066 726f 6d20 6120 6461 7465 206f  ar from a date o
-000197a0: 7220 7469 6d65 7374 616d 702e 0a0a 2020  r timestamp...  
-000197b0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-000197c0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-000197d0: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-000197e0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000197f0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00019800: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-00019810: 2020 205b 5b64 6174 6574 696d 652e 6461     [[datetime.da
-00019820: 7465 7469 6d65 2e73 7472 7074 696d 6528  tetime.strptime(
-00019830: 2232 3032 302d 3035 2d30 3120 3133 3a31  "2020-05-01 13:1
-00019840: 313a 3230 2e30 3030 222c 2022 2559 2d25  1:20.000", "%Y-%
-00019850: 6d2d 2564 2025 483a 254d 3a25 532e 2566  m-%d %H:%M:%S.%f
-00019860: 2229 5d5d 2c0a 2020 2020 2020 2020 2e2e  ")]],.        ..
-00019870: 2e20 2020 2020 7363 6865 6d61 3d5b 2261  .     schema=["a
-00019880: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
-00019890: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000198a0: 2e73 656c 6563 7428 6461 796f 6679 6561  .select(dayofyea
-000198b0: 7228 2261 2229 292e 636f 6c6c 6563 7428  r("a")).collect(
-000198c0: 290a 2020 2020 2020 2020 5b52 6f77 2844  ).        [Row(D
-000198d0: 4159 4f46 5945 4152 2822 4122 293d 3132  AYOFYEAR("A")=12
-000198e0: 3229 5d0a 2020 2020 2222 220a 2020 2020  2)].    """.    
-000198f0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00019900: 7472 2865 2c20 2264 6179 6f66 7965 6172  tr(e, "dayofyear
-00019910: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00019920: 696c 7469 6e28 2264 6179 6f66 7965 6172  iltin("dayofyear
-00019930: 2229 2863 290a 0a0a 6465 6620 6973 5f61  ")(c)...def is_a
-00019940: 7272 6179 2863 6f6c 3a20 436f 6c75 6d6e  rray(col: Column
-00019950: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00019960: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-00019970: 6574 7572 6e73 2074 7275 6520 6966 2074  eturns true if t
-00019980: 6865 2073 7065 6369 6669 6564 2056 4152  he specified VAR
-00019990: 4941 4e54 2063 6f6c 756d 6e20 636f 6e74  IANT column cont
-000199a0: 6169 6e73 2061 6e20 4152 5241 5920 7661  ains an ARRAY va
-000199b0: 6c75 652e 0a0a 2020 2020 4578 616d 706c  lue...    Exampl
-000199c0: 6573 3a3a 0a0a 2020 2020 2020 2020 3e3e  es::..        >>
-000199d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000199e0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000199f0: 5b5b 5b22 656c 656d 656e 7422 5d2c 2054  [[["element"], T
-00019a00: 7275 655d 5d2c 2073 6368 656d 613d 5b22  rue]], schema=["
-00019a10: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
-00019a20: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00019a30: 6973 5f61 7272 6179 2864 665b 2261 225d  is_array(df["a"]
-00019a40: 292e 616c 6961 7328 2269 735f 6172 7261  ).alias("is_arra
-00019a50: 795f 6122 292c 2069 735f 6172 7261 7928  y_a"), is_array(
-00019a60: 6466 5b22 6222 5d29 2e61 6c69 6173 2822  df["b"]).alias("
-00019a70: 6973 5f61 7272 6179 5f62 2229 292e 636f  is_array_b")).co
-00019a80: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00019a90: 5b52 6f77 2849 535f 4152 5241 595f 413d  [Row(IS_ARRAY_A=
-00019aa0: 5472 7565 2c20 4953 5f41 5252 4159 5f42  True, IS_ARRAY_B
-00019ab0: 3d46 616c 7365 295d 0a20 2020 2022 2222  =False)].    """
-00019ac0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00019ad0: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
-00019ae0: 5f61 7272 6179 2229 0a20 2020 2072 6574  _array").    ret
-00019af0: 7572 6e20 6275 696c 7469 6e28 2269 735f  urn builtin("is_
-00019b00: 6172 7261 7922 2928 6329 0a0a 0a64 6566  array")(c)...def
-00019b10: 2069 735f 626f 6f6c 6561 6e28 636f 6c3a   is_boolean(col:
-00019b20: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00019b30: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00019b40: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
-00019b50: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
-00019b60: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
-00019b70: 6d6e 2063 6f6e 7461 696e 7320 6120 626f  mn contains a bo
-00019b80: 6f6c 6561 6e20 7661 6c75 652e 0a0a 2020  olean value...  
-00019b90: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
-00019ba0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00019bb0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00019bc0: 6b2e 7479 7065 7320 696d 706f 7274 2053  k.types import S
-00019bd0: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
-00019be0: 616e 7454 7970 650a 2020 2020 2020 2020  antType.        
-00019bf0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00019c00: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00019c10: 6528 5b5b 5472 7565 2c20 2758 275d 5d2c  e([[True, 'X']],
-00019c20: 2073 6368 656d 613d 5b22 6122 2c20 2262   schema=["a", "b
-00019c30: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00019c40: 6466 2e73 656c 6563 7428 6973 5f62 6f6f  df.select(is_boo
-00019c50: 6c65 616e 2874 6f5f 7661 7269 616e 7428  lean(to_variant(
-00019c60: 6466 5b22 6122 5d29 292e 616c 6961 7328  df["a"])).alias(
-00019c70: 2262 6f6f 6c65 616e 2229 2c20 6973 5f62  "boolean"), is_b
-00019c80: 6f6f 6c65 616e 2874 6f5f 7661 7269 616e  oolean(to_varian
-00019c90: 7428 6466 5b22 6222 5d29 292e 616c 6961  t(df["b"])).alia
-00019ca0: 7328 2276 6172 6368 6172 2229 292e 636f  s("varchar")).co
-00019cb0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00019cc0: 5b52 6f77 2842 4f4f 4c45 414e 3d54 7275  [Row(BOOLEAN=Tru
-00019cd0: 652c 2056 4152 4348 4152 3d46 616c 7365  e, VARCHAR=False
-00019ce0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-00019cf0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00019d00: 7228 636f 6c2c 2022 6973 5f62 6f6f 6c65  r(col, "is_boole
-00019d10: 616e 2229 0a20 2020 2072 6574 7572 6e20  an").    return 
-00019d20: 6275 696c 7469 6e28 2269 735f 626f 6f6c  builtin("is_bool
-00019d30: 6561 6e22 2928 6329 0a0a 0a64 6566 2069  ean")(c)...def i
-00019d40: 735f 6269 6e61 7279 2863 6f6c 3a20 436f  s_binary(col: Co
-00019d50: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00019d60: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00019d70: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
-00019d80: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
-00019d90: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
-00019da0: 636f 6e74 6169 6e73 2061 2062 696e 6172  contains a binar
-00019db0: 7920 7661 6c75 652e 0a0a 2020 2020 4578  y value...    Ex
-00019dc0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
-00019dd0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00019de0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-00019df0: 7065 7320 696d 706f 7274 2053 7472 7563  pes import Struc
-00019e00: 7446 6965 6c64 2c20 5661 7269 616e 7454  tField, VariantT
-00019e10: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
-00019e20: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00019e30: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00019e40: 6222 736e 6f77 222c 2022 736e 6f77 225d  b"snow", "snow"]
-00019e50: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-00019e60: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
-00019e70: 3e20 6466 2e73 656c 6563 7428 6973 5f62  > df.select(is_b
-00019e80: 696e 6172 7928 746f 5f76 6172 6961 6e74  inary(to_variant
-00019e90: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
-00019ea0: 2822 6269 6e61 7279 2229 2c20 6973 5f62  ("binary"), is_b
-00019eb0: 696e 6172 7928 746f 5f76 6172 6961 6e74  inary(to_variant
-00019ec0: 2864 665b 2262 225d 2929 2e61 6c69 6173  (df["b"])).alias
-00019ed0: 2822 7661 7263 6861 7222 2929 2e63 6f6c  ("varchar")).col
-00019ee0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00019ef0: 526f 7728 4249 4e41 5259 3d54 7275 652c  Row(BINARY=True,
-00019f00: 2056 4152 4348 4152 3d46 616c 7365 295d   VARCHAR=False)]
-00019f10: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00019f20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00019f30: 636f 6c2c 2022 6973 5f62 696e 6172 7922  col, "is_binary"
-00019f40: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00019f50: 6c74 696e 2822 6973 5f62 696e 6172 7922  ltin("is_binary"
-00019f60: 2928 6329 0a0a 0a64 6566 2069 735f 6368  )(c)...def is_ch
-00019f70: 6172 2863 6f6c 3a20 436f 6c75 6d6e 4f72  ar(col: ColumnOr
-00019f80: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00019f90: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-00019fa0: 7572 6e73 2074 7275 6520 6966 2074 6865  urns true if the
-00019fb0: 2073 7065 6369 6669 6564 2056 4152 4941   specified VARIA
-00019fc0: 4e54 2063 6f6c 756d 6e20 636f 6e74 6169  NT column contai
-00019fd0: 6e73 2061 2073 7472 696e 672e 0a0a 2020  ns a string...  
-00019fe0: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
-00019ff0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0001a000: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0001a010: 6b2e 7479 7065 7320 696d 706f 7274 2053  k.types import S
-0001a020: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
-0001a030: 616e 7454 7970 650a 2020 2020 2020 2020  antType.        
-0001a040: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0001a050: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0001a060: 6528 5b5b 2261 6263 222c 2031 3233 5d5d  e([["abc", 123]]
-0001a070: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-0001a080: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
-0001a090: 2064 662e 7365 6c65 6374 2869 735f 6368   df.select(is_ch
-0001a0a0: 6172 2874 6f5f 7661 7269 616e 7428 6466  ar(to_variant(df
-0001a0b0: 5b22 6122 5d29 292e 616c 6961 7328 2276  ["a"])).alias("v
-0001a0c0: 6172 6368 6172 2229 2c20 6973 5f63 6861  archar"), is_cha
-0001a0d0: 7228 746f 5f76 6172 6961 6e74 2864 665b  r(to_variant(df[
-0001a0e0: 2262 225d 2929 2e61 6c69 6173 2822 696e  "b"])).alias("in
-0001a0f0: 7422 2929 2e63 6f6c 6c65 6374 2829 0a20  t")).collect(). 
-0001a100: 2020 2020 2020 205b 526f 7728 5641 5243         [Row(VARC
-0001a110: 4841 523d 5472 7565 2c20 494e 543d 4661  HAR=True, INT=Fa
-0001a120: 6c73 6529 5d0a 2020 2020 2222 220a 2020  lse)].    """.  
-0001a130: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0001a140: 5f73 7472 2863 6f6c 2c20 2269 735f 6368  _str(col, "is_ch
-0001a150: 6172 2229 0a20 2020 2072 6574 7572 6e20  ar").    return 
-0001a160: 6275 696c 7469 6e28 2269 735f 6368 6172  builtin("is_char
-0001a170: 2229 2863 290a 0a0a 6973 5f76 6172 6368  ")(c)...is_varch
-0001a180: 6172 203d 2069 735f 6368 6172 0a0a 0a64  ar = is_char...d
-0001a190: 6566 2069 735f 6461 7465 2863 6f6c 3a20  ef is_date(col: 
-0001a1a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0001a1b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0001a1c0: 0a20 2020 2052 6574 7572 6e73 2074 7275  .    Returns tru
-0001a1d0: 6520 6966 2074 6865 2073 7065 6369 6669  e if the specifi
-0001a1e0: 6564 2056 4152 4941 4e54 2063 6f6c 756d  ed VARIANT colum
-0001a1f0: 6e20 636f 6e74 6169 6e73 2061 2064 6174  n contains a dat
-0001a200: 6520 7661 6c75 652e 0a0a 2020 2020 4578  e value...    Ex
-0001a210: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
-0001a220: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
-0001a230: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
-0001a240: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0001a250: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-0001a260: 696d 706f 7274 2053 7472 7563 7446 6965  import StructFie
-0001a270: 6c64 2c20 5661 7269 616e 7454 7970 650a  ld, VariantType.
-0001a280: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0001a290: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0001a2a0: 6461 7461 6672 616d 6528 5b5b 6461 7465  dataframe([[date
-0001a2b0: 7469 6d65 2e64 6174 6528 3230 3233 2c20  time.date(2023, 
-0001a2c0: 332c 2032 292c 2031 3233 5d5d 2c20 7363  3, 2), 123]], sc
-0001a2d0: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
-0001a2e0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0001a2f0: 7365 6c65 6374 2869 735f 6461 7465 2874  select(is_date(t
-0001a300: 6f5f 7661 7269 616e 7428 6466 5b22 6122  o_variant(df["a"
-0001a310: 5d29 292e 616c 6961 7328 2264 6174 6522  ])).alias("date"
-0001a320: 292c 2069 735f 6461 7465 2874 6f5f 7661  ), is_date(to_va
-0001a330: 7269 616e 7428 6466 5b22 6222 5d29 292e  riant(df["b"])).
-0001a340: 616c 6961 7328 2269 6e74 2229 292e 636f  alias("int")).co
-0001a350: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001a360: 5b52 6f77 2844 4154 453d 5472 7565 2c20  [Row(DATE=True, 
-0001a370: 494e 543d 4661 6c73 6529 5d0a 2020 2020  INT=False)].    
-0001a380: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0001a390: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-0001a3a0: 2269 735f 6461 7465 2229 0a20 2020 2072  "is_date").    r
-0001a3b0: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
-0001a3c0: 735f 6461 7465 2229 2863 290a 0a0a 6973  s_date")(c)...is
-0001a3d0: 5f64 6174 655f 7661 6c75 6520 3d20 6973  _date_value = is
-0001a3e0: 5f64 6174 650a 0a0a 6465 6620 6973 5f64  _date...def is_d
-0001a3f0: 6563 696d 616c 2863 6f6c 3a20 436f 6c75  ecimal(col: Colu
-0001a400: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001a410: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0001a420: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
-0001a430: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
-0001a440: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
-0001a450: 6e74 6169 6e73 2061 2066 6978 6564 2d70  ntains a fixed-p
-0001a460: 6f69 6e74 2064 6563 696d 616c 2076 616c  oint decimal val
-0001a470: 7565 206f 7220 696e 7465 6765 722e 0a0a  ue or integer...
-0001a480: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
-0001a490: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0001a4a0: 7274 2064 6563 696d 616c 0a20 2020 2020  rt decimal.     
-0001a4b0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0001a4c0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0001a4d0: 7970 6573 2069 6d70 6f72 7420 5374 7275  ypes import Stru
-0001a4e0: 6374 4669 656c 642c 2056 6172 6961 6e74  ctField, Variant
-0001a4f0: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-0001a500: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0001a510: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-0001a520: 5b64 6563 696d 616c 2e44 6563 696d 616c  [decimal.Decimal
-0001a530: 2831 292c 2022 5822 5d5d 2c20 7363 6865  (1), "X"]], sche
-0001a540: 6d61 3d5b 2261 222c 2022 6222 5d29 0a20  ma=["a", "b"]). 
-0001a550: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001a560: 6c65 6374 2869 735f 6465 6369 6d61 6c28  lect(is_decimal(
-0001a570: 746f 5f76 6172 6961 6e74 2864 665b 2261  to_variant(df["a
-0001a580: 225d 2929 2e61 6c69 6173 2822 6465 6369  "])).alias("deci
-0001a590: 6d61 6c22 292c 2069 735f 6465 6369 6d61  mal"), is_decima
-0001a5a0: 6c28 746f 5f76 6172 6961 6e74 2864 665b  l(to_variant(df[
-0001a5b0: 2262 225d 2929 2e61 6c69 6173 2822 7661  "b"])).alias("va
-0001a5c0: 7263 6861 7222 2929 2e63 6f6c 6c65 6374  rchar")).collect
-0001a5d0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0001a5e0: 4445 4349 4d41 4c3d 5472 7565 2c20 5641  DECIMAL=True, VA
-0001a5f0: 5243 4841 523d 4661 6c73 6529 5d0a 2020  RCHAR=False)].  
-0001a600: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0001a610: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-0001a620: 2c20 2269 735f 6465 6369 6d61 6c22 290a  , "is_decimal").
-0001a630: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001a640: 696e 2822 6973 5f64 6563 696d 616c 2229  in("is_decimal")
-0001a650: 2863 290a 0a0a 6465 6620 6973 5f64 6f75  (c)...def is_dou
-0001a660: 626c 6528 636f 6c3a 2043 6f6c 756d 6e4f  ble(col: ColumnO
-0001a670: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0001a680: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0001a690: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
-0001a6a0: 6520 7370 6563 6966 6965 6420 5641 5249  e specified VARI
-0001a6b0: 414e 5420 636f 6c75 6d6e 2063 6f6e 7461  ANT column conta
-0001a6c0: 696e 7320 6120 666c 6f61 7469 6e67 2d70  ins a floating-p
-0001a6d0: 6f69 6e74 2076 616c 7565 2c20 6669 7865  oint value, fixe
-0001a6e0: 642d 706f 696e 7420 6465 6369 6d61 6c2c  d-point decimal,
-0001a6f0: 206f 7220 696e 7465 6765 722e 0a0a 2020   or integer...  
-0001a700: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
-0001a710: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0001a720: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0001a730: 6b2e 7479 7065 7320 696d 706f 7274 2053  k.types import S
-0001a740: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
-0001a750: 616e 7454 7970 650a 2020 2020 2020 2020  antType.        
-0001a760: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0001a770: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0001a780: 6528 5b5b 312e 322c 2022 5822 5d5d 2c20  e([[1.2, "X"]], 
-0001a790: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
-0001a7a0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0001a7b0: 662e 7365 6c65 6374 2869 735f 646f 7562  f.select(is_doub
-0001a7c0: 6c65 2874 6f5f 7661 7269 616e 7428 6466  le(to_variant(df
-0001a7d0: 5b22 6122 5d29 292e 616c 6961 7328 2264  ["a"])).alias("d
-0001a7e0: 6f75 626c 6522 292c 2069 735f 646f 7562  ouble"), is_doub
-0001a7f0: 6c65 2874 6f5f 7661 7269 616e 7428 6466  le(to_variant(df
-0001a800: 5b22 6222 5d29 292e 616c 6961 7328 2276  ["b"])).alias("v
-0001a810: 6172 6368 6172 2229 292e 636f 6c6c 6563  archar")).collec
-0001a820: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0001a830: 2844 4f55 424c 453d 5472 7565 2c20 5641  (DOUBLE=True, VA
-0001a840: 5243 4841 523d 4661 6c73 6529 5d0a 2020  RCHAR=False)].  
-0001a850: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0001a860: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-0001a870: 2c20 2269 735f 646f 7562 6c65 2229 0a20  , "is_double"). 
-0001a880: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0001a890: 6e28 2269 735f 646f 7562 6c65 2229 2863  n("is_double")(c
-0001a8a0: 290a 0a0a 6465 6620 6973 5f72 6561 6c28  )...def is_real(
-0001a8b0: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
-0001a8c0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0001a8d0: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-0001a8e0: 7320 7472 7565 2069 6620 7468 6520 7370  s true if the sp
-0001a8f0: 6563 6966 6965 6420 5641 5249 414e 5420  ecified VARIANT 
-0001a900: 636f 6c75 6d6e 2063 6f6e 7461 696e 7320  column contains 
-0001a910: 6120 666c 6f61 7469 6e67 2d70 6f69 6e74  a floating-point
-0001a920: 2076 616c 7565 2c20 6669 7865 642d 706f   value, fixed-po
-0001a930: 696e 7420 6465 6369 6d61 6c2c 206f 7220  int decimal, or 
-0001a940: 696e 7465 6765 722e 0a0a 2020 2020 4578  integer...    Ex
-0001a950: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0001a960: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0001a970: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-0001a980: 6374 696f 6e73 2069 6d70 6f72 7420 746f  ctions import to
-0001a990: 5f76 6172 6961 6e74 2c20 6973 5f72 6561  _variant, is_rea
-0001a9a0: 6c0a 2020 2020 2020 2020 3e3e 3e20 6466  l.        >>> df
-0001a9b0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0001a9c0: 655f 6461 7461 6672 616d 6528 5b5b 312e  e_dataframe([[1.
-0001a9d0: 322c 2022 5822 5d5d 2c20 7363 6865 6d61  2, "X"]], schema
-0001a9e0: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
-0001a9f0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001aa00: 6374 2869 735f 7265 616c 2874 6f5f 7661  ct(is_real(to_va
-0001aa10: 7269 616e 7428 2261 2229 292e 6173 5f28  riant("a")).as_(
-0001aa20: 2261 2229 2c20 6973 5f72 6561 6c28 746f  "a"), is_real(to
-0001aa30: 5f76 6172 6961 6e74 2822 6222 2929 2e61  _variant("b")).a
-0001aa40: 735f 2822 6222 2929 2e63 6f6c 6c65 6374  s_("b")).collect
-0001aa50: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0001aa60: 413d 5472 7565 2c20 423d 4661 6c73 6529  A=True, B=False)
-0001aa70: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0001aa80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001aa90: 2863 6f6c 2c20 2269 735f 7265 616c 2229  (col, "is_real")
-0001aaa0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001aab0: 7469 6e28 2269 735f 7265 616c 2229 2863  tin("is_real")(c
-0001aac0: 290a 0a0a 6465 6620 6973 5f69 6e74 6567  )...def is_integ
-0001aad0: 6572 2863 6f6c 3a20 436f 6c75 6d6e 4f72  er(col: ColumnOr
-0001aae0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0001aaf0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-0001ab00: 7572 6e73 2074 7275 6520 6966 2074 6865  urns true if the
-0001ab10: 2073 7065 6369 6669 6564 2056 4152 4941   specified VARIA
-0001ab20: 4e54 2063 6f6c 756d 6e20 636f 6e74 6169  NT column contai
-0001ab30: 6e73 2061 2069 6e74 6567 6572 2076 616c  ns a integer val
-0001ab40: 7565 2e0a 0a20 2020 2045 7861 6d70 6c65  ue...    Example
-0001ab50: 733a 3a0a 0a20 2020 2020 2020 203e 3e3e  s::..        >>>
-0001ab60: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0001ab70: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-0001ab80: 6d70 6f72 7420 5374 7275 6374 4669 656c  mport StructFiel
-0001ab90: 642c 2056 6172 6961 6e74 5479 7065 0a20  d, VariantType. 
-0001aba0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001abb0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001abc0: 6174 6166 7261 6d65 285b 5b31 2c20 2258  ataframe([[1, "X
-0001abd0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
-0001abe0: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-0001abf0: 3e3e 3e20 6466 2e73 656c 6563 7428 6973  >>> df.select(is
-0001ac00: 5f69 6e74 6567 6572 2874 6f5f 7661 7269  _integer(to_vari
-0001ac10: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
-0001ac20: 6961 7328 2269 6e74 2229 2c20 6973 5f69  ias("int"), is_i
-0001ac30: 6e74 6567 6572 2874 6f5f 7661 7269 616e  nteger(to_varian
-0001ac40: 7428 6466 5b22 6222 5d29 292e 616c 6961  t(df["b"])).alia
-0001ac50: 7328 2276 6172 6368 6172 2229 292e 636f  s("varchar")).co
-0001ac60: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001ac70: 5b52 6f77 2849 4e54 3d54 7275 652c 2056  [Row(INT=True, V
-0001ac80: 4152 4348 4152 3d46 616c 7365 295d 0a20  ARCHAR=False)]. 
-0001ac90: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0001aca0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-0001acb0: 6c2c 2022 6973 5f69 6e74 6567 6572 2229  l, "is_integer")
-0001acc0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001acd0: 7469 6e28 2269 735f 696e 7465 6765 7222  tin("is_integer"
-0001ace0: 2928 6329 0a0a 0a64 6566 2069 735f 6e75  )(c)...def is_nu
-0001acf0: 6c6c 5f76 616c 7565 2863 6f6c 3a20 436f  ll_value(col: Co
-0001ad00: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0001ad10: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-0001ad20: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
-0001ad30: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
-0001ad40: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
-0001ad50: 636f 6e74 6169 6e73 2061 204a 534f 4e20  contains a JSON 
-0001ad60: 6e75 6c6c 2076 616c 7565 2e0a 0a20 2020  null value...   
-0001ad70: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0001ad80: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-0001ad90: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0001ada0: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-0001adb0: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
-0001adc0: 6e75 6c6c 5f76 616c 7565 0a20 2020 2020  null_value.     
-0001add0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0001ade0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0001adf0: 7261 6d65 285b 5b7b 2261 223a 2022 666f  rame([[{"a": "fo
-0001ae00: 6f22 7d5d 2c20 5b7b 2261 223a 204e 6f6e  o"}], [{"a": Non
-0001ae10: 657d 5d2c 205b 4e6f 6e65 5d5d 2c20 7363  e}], [None]], sc
-0001ae20: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0001ae30: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0001ae40: 7428 6973 5f6e 756c 6c5f 7661 6c75 6528  t(is_null_value(
-0001ae50: 746f 5f76 6172 6961 6e74 2822 6122 295b  to_variant("a")[
-0001ae60: 2261 225d 292e 6173 5f28 2261 2229 292e  "a"]).as_("a")).
-0001ae70: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0001ae80: 2020 5b52 6f77 2841 3d46 616c 7365 292c    [Row(A=False),
-0001ae90: 2052 6f77 2841 3d54 7275 6529 2c20 526f   Row(A=True), Ro
-0001aea0: 7728 413d 4e6f 6e65 295d 0a20 2020 2022  w(A=None)].    "
-0001aeb0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0001aec0: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-0001aed0: 6973 5f6e 756c 6c5f 7661 6c75 6522 290a  is_null_value").
-0001aee0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001aef0: 696e 2822 6973 5f6e 756c 6c5f 7661 6c75  in("is_null_valu
-0001af00: 6522 2928 6329 0a0a 0a64 6566 2069 735f  e")(c)...def is_
-0001af10: 6f62 6a65 6374 2863 6f6c 3a20 436f 6c75  object(col: Colu
-0001af20: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001af30: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0001af40: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
-0001af50: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
-0001af60: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
-0001af70: 6e74 6169 6e73 2061 6e20 4f42 4a45 4354  ntains an OBJECT
-0001af80: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
-0001af90: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0001afa0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0001afb0: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-0001afc0: 7469 6f6e 7320 696d 706f 7274 2074 6f5f  tions import to_
-0001afd0: 7661 7269 616e 742c 2069 735f 6f62 6a65  variant, is_obje
-0001afe0: 6374 0a20 2020 2020 2020 203e 3e3e 2064  ct.        >>> d
-0001aff0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0001b000: 7465 5f64 6174 6166 7261 6d65 285b 5b5b  te_dataframe([[[
-0001b010: 312c 2032 5d2c 207b 2261 223a 2022 736e  1, 2], {"a": "sn
-0001b020: 6f77 227d 5d5d 2c20 7363 6865 6d61 3d5b  ow"}]], schema=[
-0001b030: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-0001b040: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0001b050: 2869 735f 6f62 6a65 6374 2874 6f5f 7661  (is_object(to_va
-0001b060: 7269 616e 7428 2261 2229 292e 6173 5f28  riant("a")).as_(
-0001b070: 2261 2229 2c20 6973 5f6f 626a 6563 7428  "a"), is_object(
-0001b080: 746f 5f76 6172 6961 6e74 2822 6222 2929  to_variant("b"))
-0001b090: 2e61 735f 2822 6222 2929 2e63 6f6c 6c65  .as_("b")).colle
-0001b0a0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0001b0b0: 7728 413d 4661 6c73 652c 2042 3d54 7275  w(A=False, B=Tru
-0001b0c0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-0001b0d0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0001b0e0: 7472 2863 6f6c 2c20 2269 735f 6f62 6a65  tr(col, "is_obje
-0001b0f0: 6374 2229 0a20 2020 2072 6574 7572 6e20  ct").    return 
-0001b100: 6275 696c 7469 6e28 2269 735f 6f62 6a65  builtin("is_obje
-0001b110: 6374 2229 2863 290a 0a0a 6465 6620 6973  ct")(c)...def is
-0001b120: 5f74 696d 6528 636f 6c3a 2043 6f6c 756d  _time(col: Colum
-0001b130: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0001b140: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0001b150: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
-0001b160: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
-0001b170: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
-0001b180: 7461 696e 7320 6120 5449 4d45 2076 616c  tains a TIME val
-0001b190: 7565 2e0a 0a20 2020 2045 7861 6d70 6c65  ue...    Example
-0001b1a0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001b1b0: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-0001b1c0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0001b1d0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0001b1e0: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
-0001b1f0: 706f 7274 2074 6f5f 7661 7269 616e 742c  port to_variant,
-0001b200: 2069 735f 7469 6d65 0a20 2020 2020 2020   is_time.       
-0001b210: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0001b220: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0001b230: 6d65 285b 5b64 6174 6574 696d 652e 7469  me([[datetime.ti
-0001b240: 6d65 2831 302c 2031 3029 2c20 2258 225d  me(10, 10), "X"]
-0001b250: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-0001b260: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
-0001b270: 3e20 6466 2e73 656c 6563 7428 6973 5f74  > df.select(is_t
-0001b280: 696d 6528 746f 5f76 6172 6961 6e74 2822  ime(to_variant("
-0001b290: 6122 2929 2e61 735f 2822 6122 292c 2069  a")).as_("a"), i
-0001b2a0: 735f 7469 6d65 2874 6f5f 7661 7269 616e  s_time(to_varian
-0001b2b0: 7428 2262 2229 292e 6173 5f28 2262 2229  t("b")).as_("b")
-0001b2c0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0001b2d0: 2020 2020 5b52 6f77 2841 3d54 7275 652c      [Row(A=True,
-0001b2e0: 2042 3d46 616c 7365 295d 0a20 2020 2022   B=False)].    "
-0001b2f0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0001b300: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-0001b310: 6973 5f74 696d 6522 290a 2020 2020 7265  is_time").    re
-0001b320: 7475 726e 2062 7569 6c74 696e 2822 6973  turn builtin("is
-0001b330: 5f74 696d 6522 2928 6329 0a0a 0a64 6566  _time")(c)...def
-0001b340: 2069 735f 7469 6d65 7374 616d 705f 6c74   is_timestamp_lt
-0001b350: 7a28 636f 6c3a 2043 6f6c 756d 6e4f 724e  z(col: ColumnOrN
-0001b360: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0001b370: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-0001b380: 726e 7320 7472 7565 2069 6620 7468 6520  rns true if the 
-0001b390: 7370 6563 6966 6965 6420 5641 5249 414e  specified VARIAN
-0001b3a0: 5420 636f 6c75 6d6e 2063 6f6e 7461 696e  T column contain
-0001b3b0: 7320 6120 5449 4d45 5354 414d 505f 4c54  s a TIMESTAMP_LT
-0001b3c0: 5a20 7661 6c75 6520 746f 2062 650a 2020  Z value to be.  
-0001b3d0: 2020 696e 7465 7270 7265 7465 6420 7573    interpreted us
-0001b3e0: 696e 6720 7468 6520 6c6f 6361 6c20 7469  ing the local ti
-0001b3f0: 6d65 207a 6f6e 652e 0a0a 2020 2020 4578  me zone...    Ex
-0001b400: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0001b410: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0001b420: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-0001b430: 6374 696f 6e73 2069 6d70 6f72 7420 746f  ctions import to
-0001b440: 5f76 6172 6961 6e74 2c20 6973 5f74 696d  _variant, is_tim
-0001b450: 6573 7461 6d70 5f6c 747a 0a20 2020 2020  estamp_ltz.     
-0001b460: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0001b470: 696f 6e2e 7371 6c28 2273 656c 6563 7420  ion.sql("select 
-0001b480: 746f 5f74 696d 6573 7461 6d70 5f6e 747a  to_timestamp_ntz
-0001b490: 2827 3230 3137 2d30 322d 3234 2031 323a  ('2017-02-24 12:
-0001b4a0: 3030 3a30 302e 3435 3627 2920 6173 2074  00:00.456') as t
-0001b4b0: 696d 6573 7461 6d70 5f6e 747a 312c 2022  imestamp_ntz1, "
-0001b4c0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0001b4d0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-0001b4e0: 6f5f 7469 6d65 7374 616d 705f 6c74 7a28  o_timestamp_ltz(
-0001b4f0: 2732 3031 372d 3032 2d32 3420 3133 3a30  '2017-02-24 13:0
-0001b500: 303a 3030 2e31 3233 202b 3031 3a30 3027  0:00.123 +01:00'
-0001b510: 2920 6173 2074 696d 6573 7461 6d70 5f6c  ) as timestamp_l
-0001b520: 747a 312c 2022 0a20 2020 2020 2020 202e  tz1, ".        .
-0001b530: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-0001b540: 2020 2020 2274 6f5f 7469 6d65 7374 616d      "to_timestam
-0001b550: 705f 747a 2827 3230 3137 2d30 322d 3234  p_tz('2017-02-24
-0001b560: 2031 333a 3030 3a30 302e 3132 3320 2b30   13:00:00.123 +0
-0001b570: 313a 3030 2729 2061 7320 7469 6d65 7374  1:00') as timest
-0001b580: 616d 705f 747a 3122 290a 2020 2020 2020  amp_tz1").      
-0001b590: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001b5a0: 6973 5f74 696d 6573 7461 6d70 5f6c 747a  is_timestamp_ltz
-0001b5b0: 2874 6f5f 7661 7269 616e 7428 2274 696d  (to_variant("tim
-0001b5c0: 6573 7461 6d70 5f6e 747a 3122 2929 2e61  estamp_ntz1")).a
-0001b5d0: 735f 2822 6122 292c 0a20 2020 2020 2020  s_("a"),.       
-0001b5e0: 202e 2e2e 2020 2020 2020 2020 2020 2069   ...           i
-0001b5f0: 735f 7469 6d65 7374 616d 705f 6c74 7a28  s_timestamp_ltz(
-0001b600: 746f 5f76 6172 6961 6e74 2822 7469 6d65  to_variant("time
-0001b610: 7374 616d 705f 6c74 7a31 2229 292e 6173  stamp_ltz1")).as
-0001b620: 5f28 2262 2229 2c0a 2020 2020 2020 2020  _("b"),.        
-0001b630: 2e2e 2e20 2020 2020 2020 2020 2020 6973  ...           is
-0001b640: 5f74 696d 6573 7461 6d70 5f6c 747a 2874  _timestamp_ltz(t
-0001b650: 6f5f 7661 7269 616e 7428 2274 696d 6573  o_variant("times
-0001b660: 7461 6d70 5f74 7a31 2229 292e 6173 5f28  tamp_tz1")).as_(
-0001b670: 2263 2229 292e 636f 6c6c 6563 7428 290a  "c")).collect().
-0001b680: 2020 2020 2020 2020 5b52 6f77 2841 3d46          [Row(A=F
-0001b690: 616c 7365 2c20 423d 5472 7565 2c20 433d  alse, B=True, C=
-0001b6a0: 4661 6c73 6529 5d0a 2020 2020 2222 220a  False)].    """.
-0001b6b0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0001b6c0: 6966 5f73 7472 2863 6f6c 2c20 2269 735f  if_str(col, "is_
-0001b6d0: 7469 6d65 7374 616d 705f 6c74 7a22 290a  timestamp_ltz").
-0001b6e0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001b6f0: 696e 2822 6973 5f74 696d 6573 7461 6d70  in("is_timestamp
-0001b700: 5f6c 747a 2229 2863 290a 0a0a 6465 6620  _ltz")(c)...def 
-0001b710: 6973 5f74 696d 6573 7461 6d70 5f6e 747a  is_timestamp_ntz
-0001b720: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-0001b730: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0001b740: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-0001b750: 6e73 2074 7275 6520 6966 2074 6865 2073  ns true if the s
-0001b760: 7065 6369 6669 6564 2056 4152 4941 4e54  pecified VARIANT
-0001b770: 2063 6f6c 756d 6e20 636f 6e74 6169 6e73   column contains
-0001b780: 2061 2054 494d 4553 5441 4d50 5f4e 545a   a TIMESTAMP_NTZ
-0001b790: 2076 616c 7565 2077 6974 6820 6e6f 2074   value with no t
-0001b7a0: 696d 6520 7a6f 6e65 2e0a 0a20 2020 2045  ime zone...    E
-0001b7b0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0001b7c0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0001b7d0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-0001b7e0: 6e63 7469 6f6e 7320 696d 706f 7274 2074  nctions import t
-0001b7f0: 6f5f 7661 7269 616e 742c 2069 735f 7469  o_variant, is_ti
-0001b800: 6d65 7374 616d 705f 6e74 7a0a 2020 2020  mestamp_ntz.    
-0001b810: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001b820: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
-0001b830: 2074 6f5f 7469 6d65 7374 616d 705f 6e74   to_timestamp_nt
-0001b840: 7a28 2732 3031 372d 3032 2d32 3420 3132  z('2017-02-24 12
-0001b850: 3a30 303a 3030 2e34 3536 2729 2061 7320  :00:00.456') as 
-0001b860: 7469 6d65 7374 616d 705f 6e74 7a31 2c20  timestamp_ntz1, 
-0001b870: 220a 2020 2020 2020 2020 2e2e 2e20 2020  ".        ...   
-0001b880: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b890: 746f 5f74 696d 6573 7461 6d70 5f6c 747a  to_timestamp_ltz
-0001b8a0: 2827 3230 3137 2d30 322d 3234 2031 333a  ('2017-02-24 13:
-0001b8b0: 3030 3a30 302e 3132 3320 2b30 313a 3030  00:00.123 +01:00
-0001b8c0: 2729 2061 7320 7469 6d65 7374 616d 705f  ') as timestamp_
-0001b8d0: 6c74 7a31 2c20 220a 2020 2020 2020 2020  ltz1, ".        
-0001b8e0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0001b8f0: 2020 2020 2022 746f 5f74 696d 6573 7461       "to_timesta
-0001b900: 6d70 5f74 7a28 2732 3031 372d 3032 2d32  mp_tz('2017-02-2
-0001b910: 3420 3133 3a30 303a 3030 2e31 3233 202b  4 13:00:00.123 +
-0001b920: 3031 3a30 3027 2920 6173 2074 696d 6573  01:00') as times
-0001b930: 7461 6d70 5f74 7a31 2229 0a20 2020 2020  tamp_tz1").     
-0001b940: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0001b950: 2869 735f 7469 6d65 7374 616d 705f 6e74  (is_timestamp_nt
-0001b960: 7a28 746f 5f76 6172 6961 6e74 2822 7469  z(to_variant("ti
-0001b970: 6d65 7374 616d 705f 6e74 7a31 2229 292e  mestamp_ntz1")).
-0001b980: 6173 5f28 2261 2229 2c0a 2020 2020 2020  as_("a"),.      
-0001b990: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0001b9a0: 6973 5f74 696d 6573 7461 6d70 5f6e 747a  is_timestamp_ntz
-0001b9b0: 2874 6f5f 7661 7269 616e 7428 2274 696d  (to_variant("tim
-0001b9c0: 6573 7461 6d70 5f6c 747a 3122 2929 2e61  estamp_ltz1")).a
-0001b9d0: 735f 2822 6222 292c 0a20 2020 2020 2020  s_("b"),.       
-0001b9e0: 202e 2e2e 2020 2020 2020 2020 2020 2069   ...           i
-0001b9f0: 735f 7469 6d65 7374 616d 705f 6e74 7a28  s_timestamp_ntz(
-0001ba00: 746f 5f76 6172 6961 6e74 2822 7469 6d65  to_variant("time
-0001ba10: 7374 616d 705f 747a 3122 2929 2e61 735f  stamp_tz1")).as_
-0001ba20: 2822 6322 2929 2e63 6f6c 6c65 6374 2829  ("c")).collect()
-0001ba30: 0a20 2020 2020 2020 205b 526f 7728 413d  .        [Row(A=
-0001ba40: 5472 7565 2c20 423d 4661 6c73 652c 2043  True, B=False, C
-0001ba50: 3d46 616c 7365 295d 0a20 2020 2022 2222  =False)].    """
-0001ba60: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0001ba70: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
-0001ba80: 5f74 696d 6573 7461 6d70 5f6e 747a 2229  _timestamp_ntz")
-0001ba90: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001baa0: 7469 6e28 2269 735f 7469 6d65 7374 616d  tin("is_timestam
-0001bab0: 705f 6e74 7a22 2928 6329 0a0a 0a64 6566  p_ntz")(c)...def
-0001bac0: 2069 735f 7469 6d65 7374 616d 705f 747a   is_timestamp_tz
-0001bad0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-0001bae0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0001baf0: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-0001bb00: 6e73 2074 7275 6520 6966 2074 6865 2073  ns true if the s
-0001bb10: 7065 6369 6669 6564 2056 4152 4941 4e54  pecified VARIANT
-0001bb20: 2063 6f6c 756d 6e20 636f 6e74 6169 6e73   column contains
-0001bb30: 2061 2054 494d 4553 5441 4d50 5f54 5a20   a TIMESTAMP_TZ 
-0001bb40: 7661 6c75 6520 7769 7468 2061 2074 696d  value with a tim
-0001bb50: 6520 7a6f 6e65 2e0a 0a20 2020 2045 7861  e zone...    Exa
-0001bb60: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0001bb70: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0001bb80: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-0001bb90: 7469 6f6e 7320 696d 706f 7274 2074 6f5f  tions import to_
-0001bba0: 7661 7269 616e 742c 2069 735f 7469 6d65  variant, is_time
-0001bbb0: 7374 616d 705f 747a 0a20 2020 2020 2020  stamp_tz.       
-0001bbc0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0001bbd0: 6e2e 7371 6c28 2273 656c 6563 7420 746f  n.sql("select to
-0001bbe0: 5f74 696d 6573 7461 6d70 5f6e 747a 2827  _timestamp_ntz('
-0001bbf0: 3230 3137 2d30 322d 3234 2031 323a 3030  2017-02-24 12:00
-0001bc00: 3a30 302e 3435 3627 2920 6173 2074 696d  :00.456') as tim
-0001bc10: 6573 7461 6d70 5f6e 747a 312c 2022 0a20  estamp_ntz1, ". 
-0001bc20: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0001bc30: 2020 2020 2020 2020 2020 2020 2274 6f5f              "to_
-0001bc40: 7469 6d65 7374 616d 705f 6c74 7a28 2732  timestamp_ltz('2
-0001bc50: 3031 372d 3032 2d32 3420 3133 3a30 303a  017-02-24 13:00:
-0001bc60: 3030 2e31 3233 202b 3031 3a30 3027 2920  00.123 +01:00') 
-0001bc70: 6173 2074 696d 6573 7461 6d70 5f6c 747a  as timestamp_ltz
-0001bc80: 312c 2022 0a20 2020 2020 2020 202e 2e2e  1, ".        ...
-0001bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bca0: 2020 2274 6f5f 7469 6d65 7374 616d 705f    "to_timestamp_
-0001bcb0: 747a 2827 3230 3137 2d30 322d 3234 2031  tz('2017-02-24 1
-0001bcc0: 333a 3030 3a30 302e 3132 3320 2b30 313a  3:00:00.123 +01:
-0001bcd0: 3030 2729 2061 7320 7469 6d65 7374 616d  00') as timestam
-0001bce0: 705f 747a 3122 290a 2020 2020 2020 2020  p_tz1").        
-0001bcf0: 3e3e 3e20 6466 2e73 656c 6563 7428 6973  >>> df.select(is
-0001bd00: 5f74 696d 6573 7461 6d70 5f74 7a28 746f  _timestamp_tz(to
-0001bd10: 5f76 6172 6961 6e74 2822 7469 6d65 7374  _variant("timest
-0001bd20: 616d 705f 6e74 7a31 2229 292e 6173 5f28  amp_ntz1")).as_(
-0001bd30: 2261 2229 2c0a 2020 2020 2020 2020 2e2e  "a"),.        ..
-0001bd40: 2e20 2020 2020 2020 2020 2020 6973 5f74  .           is_t
-0001bd50: 696d 6573 7461 6d70 5f74 7a28 746f 5f76  imestamp_tz(to_v
-0001bd60: 6172 6961 6e74 2822 7469 6d65 7374 616d  ariant("timestam
-0001bd70: 705f 6c74 7a31 2229 292e 6173 5f28 2262  p_ltz1")).as_("b
-0001bd80: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
-0001bd90: 2020 2020 2020 2020 2020 6973 5f74 696d            is_tim
-0001bda0: 6573 7461 6d70 5f74 7a28 746f 5f76 6172  estamp_tz(to_var
-0001bdb0: 6961 6e74 2822 7469 6d65 7374 616d 705f  iant("timestamp_
-0001bdc0: 747a 3122 2929 2e61 735f 2822 6322 2929  tz1")).as_("c"))
-0001bdd0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001bde0: 2020 205b 526f 7728 413d 4661 6c73 652c     [Row(A=False,
-0001bdf0: 2042 3d46 616c 7365 2c20 433d 5472 7565   B=False, C=True
-0001be00: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0001be10: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0001be20: 7228 636f 6c2c 2022 6973 5f74 696d 6573  r(col, "is_times
-0001be30: 7461 6d70 5f74 7a22 290a 2020 2020 7265  tamp_tz").    re
-0001be40: 7475 726e 2062 7569 6c74 696e 2822 6973  turn builtin("is
-0001be50: 5f74 696d 6573 7461 6d70 5f74 7a22 2928  _timestamp_tz")(
-0001be60: 6329 0a0a 0a64 6566 205f 636f 6c75 6d6e  c)...def _column
-0001be70: 735f 6672 6f6d 5f74 696d 6573 7461 6d70  s_from_timestamp
-0001be80: 5f70 6172 7473 280a 2020 2020 6675 6e63  _parts(.    func
-0001be90: 5f6e 616d 653a 2073 7472 2c20 2a61 7267  _name: str, *arg
-0001bea0: 733a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  s: Union[ColumnO
-0001beb0: 724e 616d 652c 2069 6e74 5d0a 2920 2d3e  rName, int].) ->
-0001bec0: 2054 7570 6c65 5b43 6f6c 756d 6e2c 202e   Tuple[Column, .
-0001bed0: 2e2e 5d3a 0a20 2020 2069 6620 6c65 6e28  ..]:.    if len(
-0001bee0: 6172 6773 2920 3d3d 2033 3a0a 2020 2020  args) == 3:.    
-0001bef0: 2020 2020 7965 6172 5f20 3d20 5f74 6f5f      year_ = _to_
-0001bf00: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
-0001bf10: 7428 6172 6773 5b30 5d2c 2066 756e 635f  t(args[0], func_
-0001bf20: 6e61 6d65 290a 2020 2020 2020 2020 6d6f  name).        mo
-0001bf30: 6e74 6820 3d20 5f74 6f5f 636f 6c5f 6966  nth = _to_col_if
-0001bf40: 5f73 7472 5f6f 725f 696e 7428 6172 6773  _str_or_int(args
-0001bf50: 5b31 5d2c 2066 756e 635f 6e61 6d65 290a  [1], func_name).
-0001bf60: 2020 2020 2020 2020 6461 7920 3d20 5f74          day = _t
-0001bf70: 6f5f 636f 6c5f 6966 5f73 7472 5f6f 725f  o_col_if_str_or_
-0001bf80: 696e 7428 6172 6773 5b32 5d2c 2066 756e  int(args[2], fun
-0001bf90: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
-0001bfa0: 7265 7475 726e 2079 6561 725f 2c20 6d6f  return year_, mo
-0001bfb0: 6e74 682c 2064 6179 0a20 2020 2065 6c69  nth, day.    eli
-0001bfc0: 6620 6c65 6e28 6172 6773 2920 3d3d 2036  f len(args) == 6
-0001bfd0: 3a0a 2020 2020 2020 2020 7965 6172 5f20  :.        year_ 
-0001bfe0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001bff0: 5f6f 725f 696e 7428 6172 6773 5b30 5d2c  _or_int(args[0],
-0001c000: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
-0001c010: 2020 2020 6d6f 6e74 6820 3d20 5f74 6f5f      month = _to_
-0001c020: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
-0001c030: 7428 6172 6773 5b31 5d2c 2066 756e 635f  t(args[1], func_
-0001c040: 6e61 6d65 290a 2020 2020 2020 2020 6461  name).        da
-0001c050: 7920 3d20 5f74 6f5f 636f 6c5f 6966 5f73  y = _to_col_if_s
-0001c060: 7472 5f6f 725f 696e 7428 6172 6773 5b32  tr_or_int(args[2
-0001c070: 5d2c 2066 756e 635f 6e61 6d65 290a 2020  ], func_name).  
-0001c080: 2020 2020 2020 686f 7572 203d 205f 746f        hour = _to
-0001c090: 5f63 6f6c 5f69 665f 7374 725f 6f72 5f69  _col_if_str_or_i
-0001c0a0: 6e74 2861 7267 735b 335d 2c20 6675 6e63  nt(args[3], func
-0001c0b0: 5f6e 616d 6529 0a20 2020 2020 2020 206d  _name).        m
-0001c0c0: 696e 7574 6520 3d20 5f74 6f5f 636f 6c5f  inute = _to_col_
-0001c0d0: 6966 5f73 7472 5f6f 725f 696e 7428 6172  if_str_or_int(ar
-0001c0e0: 6773 5b34 5d2c 2066 756e 635f 6e61 6d65  gs[4], func_name
-0001c0f0: 290a 2020 2020 2020 2020 7365 636f 6e64  ).        second
-0001c100: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0001c110: 725f 6f72 5f69 6e74 2861 7267 735b 355d  r_or_int(args[5]
-0001c120: 2c20 6675 6e63 5f6e 616d 6529 0a20 2020  , func_name).   
-0001c130: 2020 2020 2072 6574 7572 6e20 7965 6172       return year
-0001c140: 5f2c 206d 6f6e 7468 2c20 6461 792c 2068  _, month, day, h
-0001c150: 6f75 722c 206d 696e 7574 652c 2073 6563  our, minute, sec
-0001c160: 6f6e 640a 2020 2020 656c 7365 3a0a 2020  ond.    else:.  
-0001c170: 2020 2020 2020 2320 5368 6f75 6c64 206e        # Should n
-0001c180: 6576 6572 2068 6170 7065 6e20 7369 6e63  ever happen sinc
-0001c190: 6520 7765 206f 6e6c 7920 7573 6520 7468  e we only use th
-0001c1a0: 6973 2069 6e74 6572 6e61 6c6c 790a 2020  is internally.  
-0001c1b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001c1c0: 6545 7272 6f72 2866 2249 6e63 6f72 7265  eError(f"Incorre
-0001c1d0: 6374 206e 756d 6265 7220 6f66 2061 7267  ct number of arg
-0001c1e0: 7320 7061 7373 6564 2074 6f20 7b66 756e  s passed to {fun
-0001c1f0: 635f 6e61 6d65 7d22 290a 0a0a 6465 6620  c_name}")...def 
-0001c200: 5f74 696d 6573 7461 6d70 5f66 726f 6d5f  _timestamp_from_
-0001c210: 7061 7274 735f 696e 7465 726e 616c 280a  parts_internal(.
-0001c220: 2020 2020 6675 6e63 5f6e 616d 653a 2073      func_name: s
-0001c230: 7472 2c20 2a61 7267 733a 2055 6e69 6f6e  tr, *args: Union
-0001c240: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-0001c250: 6e74 5d2c 202a 2a6b 7761 7267 733a 2055  nt], **kwargs: U
-0001c260: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-0001c270: 652c 2069 6e74 5d0a 2920 2d3e 2054 7570  e, int].) -> Tup
-0001c280: 6c65 5b43 6f6c 756d 6e2c 202e 2e2e 5d3a  le[Column, ...]:
-0001c290: 0a20 2020 206e 756d 5f61 7267 7320 3d20  .    num_args = 
-0001c2a0: 6c65 6e28 6172 6773 290a 2020 2020 6966  len(args).    if
-0001c2b0: 206e 756d 5f61 7267 7320 3d3d 2032 3a0a   num_args == 2:.
-0001c2c0: 2020 2020 2020 2020 2320 6578 7072 6573          # expres
-0001c2d0: 7369 6f6e 206d 6f64 650a 2020 2020 2020  sion mode.      
-0001c2e0: 2020 6461 7465 5f65 7870 7220 3d20 5f74    date_expr = _t
-0001c2f0: 6f5f 636f 6c5f 6966 5f73 7472 2861 7267  o_col_if_str(arg
-0001c300: 735b 305d 2c20 6675 6e63 5f6e 616d 6529  s[0], func_name)
-0001c310: 0a20 2020 2020 2020 2074 696d 655f 6578  .        time_ex
-0001c320: 7072 203d 205f 746f 5f63 6f6c 5f69 665f  pr = _to_col_if_
-0001c330: 7374 7228 6172 6773 5b31 5d2c 2066 756e  str(args[1], fun
-0001c340: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
-0001c350: 7265 7475 726e 2064 6174 655f 6578 7072  return date_expr
-0001c360: 2c20 7469 6d65 5f65 7870 720a 2020 2020  , time_expr.    
-0001c370: 656c 6966 2036 203c 3d20 6e75 6d5f 6172  elif 6 <= num_ar
-0001c380: 6773 203c 3d20 383a 0a20 2020 2020 2020  gs <= 8:.       
-0001c390: 2023 2070 6172 7473 206d 6f64 650a 2020   # parts mode.  
-0001c3a0: 2020 2020 2020 792c 206d 2c20 642c 2068        y, m, d, h
-0001c3b0: 2c20 6d69 6e5f 2c20 7320 3d20 5f63 6f6c  , min_, s = _col
-0001c3c0: 756d 6e73 5f66 726f 6d5f 7469 6d65 7374  umns_from_timest
-0001c3d0: 616d 705f 7061 7274 7328 6675 6e63 5f6e  amp_parts(func_n
-0001c3e0: 616d 652c 202a 6172 6773 5b3a 365d 290a  ame, *args[:6]).
-0001c3f0: 2020 2020 2020 2020 6e73 5f61 7267 203d          ns_arg =
-0001c400: 2061 7267 735b 365d 2069 6620 6e75 6d5f   args[6] if num_
-0001c410: 6172 6773 203e 3d20 3720 656c 7365 206b  args >= 7 else k
-0001c420: 7761 7267 732e 6765 7428 226e 616e 6f73  wargs.get("nanos
-0001c430: 6563 6f6e 6473 2229 0a20 2020 2020 2020  econds").       
-0001c440: 2023 2054 696d 657a 6f6e 6520 6973 206f   # Timezone is o
-0001c450: 6e6c 7920 6163 6365 7074 6564 2069 6e20  nly accepted in 
-0001c460: 7469 6d65 7374 616d 705f 6672 6f6d 5f70  timestamp_from_p
-0001c470: 6172 7473 2066 756e 6374 696f 6e0a 2020  arts function.  
-0001c480: 2020 2020 2020 747a 5f61 7267 203d 2061        tz_arg = a
-0001c490: 7267 735b 375d 2069 6620 6e75 6d5f 6172  rgs[7] if num_ar
-0001c4a0: 6773 203d 3d20 3820 656c 7365 206b 7761  gs == 8 else kwa
-0001c4b0: 7267 732e 6765 7428 2274 696d 657a 6f6e  rgs.get("timezon
-0001c4c0: 6522 290a 2020 2020 2020 2020 6966 2074  e").        if t
-0001c4d0: 7a5f 6172 6720 6973 206e 6f74 204e 6f6e  z_arg is not Non
-0001c4e0: 6520 616e 6420 6675 6e63 5f6e 616d 6520  e and func_name 
-0001c4f0: 213d 2022 7469 6d65 7374 616d 705f 6672  != "timestamp_fr
-0001c500: 6f6d 5f70 6172 7473 223a 0a20 2020 2020  om_parts":.     
-0001c510: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001c520: 7565 4572 726f 7228 6622 7b66 756e 635f  ueError(f"{func_
-0001c530: 6e61 6d65 7d20 646f 6573 206e 6f74 2061  name} does not a
-0001c540: 6363 6570 7420 7469 6d65 7a6f 6e65 2061  ccept timezone a
-0001c550: 7320 616e 2061 7267 756d 656e 7422 290a  s an argument").
-0001c560: 2020 2020 2020 2020 6e73 203d 204e 6f6e          ns = Non
-0001c570: 6520 6966 206e 735f 6172 6720 6973 204e  e if ns_arg is N
-0001c580: 6f6e 6520 656c 7365 205f 746f 5f63 6f6c  one else _to_col
-0001c590: 5f69 665f 7374 725f 6f72 5f69 6e74 286e  _if_str_or_int(n
-0001c5a0: 735f 6172 672c 2066 756e 635f 6e61 6d65  s_arg, func_name
-0001c5b0: 290a 2020 2020 2020 2020 747a 203d 204e  ).        tz = N
-0001c5c0: 6f6e 6520 6966 2074 7a5f 6172 6720 6973  one if tz_arg is
-0001c5d0: 204e 6f6e 6520 656c 7365 205f 746f 5f63   None else _to_c
-0001c5e0: 6f6c 5f69 665f 7371 6c5f 6578 7072 2874  ol_if_sql_expr(t
-0001c5f0: 7a5f 6172 672c 2066 756e 635f 6e61 6d65  z_arg, func_name
-0001c600: 290a 2020 2020 2020 2020 6966 206e 7320  ).        if ns 
-0001c610: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-0001c620: 747a 2069 7320 6e6f 7420 4e6f 6e65 3a0a  tz is not None:.
-0001c630: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001c640: 726e 2079 2c20 6d2c 2064 2c20 682c 206d  rn y, m, d, h, m
-0001c650: 696e 5f2c 2073 2c20 6e73 2c20 747a 0a20  in_, s, ns, tz. 
-0001c660: 2020 2020 2020 2065 6c69 6620 6e73 2069         elif ns i
-0001c670: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0001c680: 2020 2020 2020 2020 7265 7475 726e 2079          return y
-0001c690: 2c20 6d2c 2064 2c20 682c 206d 696e 5f2c  , m, d, h, min_,
-0001c6a0: 2073 2c20 6e73 0a20 2020 2020 2020 2065   s, ns.        e
-0001c6b0: 6c69 6620 747a 2069 7320 6e6f 7420 4e6f  lif tz is not No
-0001c6c0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001c6d0: 2320 5765 206e 6565 6420 746f 2066 696c  # We need to fil
-0001c6e0: 6c20 696e 206e 616e 6f73 6563 6f6e 6473  l in nanoseconds
-0001c6f0: 2061 7320 3020 746f 206d 616b 6520 7468   as 0 to make th
-0001c700: 6520 7371 6c20 6675 6e63 7469 6f6e 2077  e sql function w
-0001c710: 6f72 6b0a 2020 2020 2020 2020 2020 2020  ork.            
-0001c720: 7265 7475 726e 2079 2c20 6d2c 2064 2c20  return y, m, d, 
-0001c730: 682c 206d 696e 5f2c 2073 2c20 6c69 7428  h, min_, s, lit(
-0001c740: 3029 2c20 747a 0a20 2020 2020 2020 2065  0), tz.        e
-0001c750: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001c760: 2072 6574 7572 6e20 792c 206d 2c20 642c   return y, m, d,
-0001c770: 2068 2c20 6d69 6e5f 2c20 730a 2020 2020   h, min_, s.    
-0001c780: 656c 7365 3a0a 2020 2020 2020 2020 7261  else:.        ra
-0001c790: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0001c7a0: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
-0001c7b0: 756e 635f 6e61 6d65 7d20 6578 7065 6374  unc_name} expect
-0001c7c0: 6564 2032 206f 7220 3620 7265 7175 6972  ed 2 or 6 requir
-0001c7d0: 6564 2061 7267 756d 656e 7473 2c20 676f  ed arguments, go
-0001c7e0: 7420 7b6e 756d 5f61 7267 737d 220a 2020  t {num_args}".  
-0001c7f0: 2020 2020 2020 290a 0a0a 6465 6620 7469        )...def ti
-0001c800: 6d65 5f66 726f 6d5f 7061 7274 7328 0a20  me_from_parts(. 
-0001c810: 2020 2068 6f75 723a 2055 6e69 6f6e 5b43     hour: Union[C
-0001c820: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
-0001c830: 5d2c 0a20 2020 206d 696e 7574 653a 2055  ],.    minute: U
-0001c840: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-0001c850: 652c 2069 6e74 5d2c 0a20 2020 2073 6563  e, int],.    sec
-0001c860: 6f6e 643a 2055 6e69 6f6e 5b43 6f6c 756d  ond: Union[Colum
-0001c870: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-0001c880: 2020 206e 616e 6f73 6563 6f6e 6473 3a20     nanoseconds: 
-0001c890: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b43  Optional[Union[C
-0001c8a0: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
-0001c8b0: 5d5d 203d 204e 6f6e 652c 0a29 202d 3e20  ]] = None,.) -> 
-0001c8c0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-0001c8d0: 2020 2020 4372 6561 7465 7320 6120 7469      Creates a ti
-0001c8e0: 6d65 2066 726f 6d20 696e 6469 7669 6475  me from individu
-0001c8f0: 616c 206e 756d 6572 6963 2063 6f6d 706f  al numeric compo
-0001c900: 6e65 6e74 732e 0a0a 2020 2020 5449 4d45  nents...    TIME
-0001c910: 5f46 524f 4d5f 5041 5254 5320 6973 2074  _FROM_PARTS is t
-0001c920: 7970 6963 616c 6c79 2075 7365 6420 746f  ypically used to
-0001c930: 2068 616e 646c 6520 7661 6c75 6573 2069   handle values i
-0001c940: 6e20 226e 6f72 6d61 6c22 2072 616e 6765  n "normal" range
-0001c950: 7320 2865 2e67 2e20 686f 7572 7320 302d  s (e.g. hours 0-
-0001c960: 3233 2c20 6d69 6e75 7465 7320 302d 3539  23, minutes 0-59
-0001c970: 292c 0a20 2020 2062 7574 2069 7420 616c  ),.    but it al
-0001c980: 736f 2068 616e 646c 6573 2076 616c 7565  so handles value
-0001c990: 7320 6672 6f6d 206f 7574 7369 6465 2074  s from outside t
-0001c9a0: 6865 7365 2072 616e 6765 732e 2054 6869  hese ranges. Thi
-0001c9b0: 7320 616c 6c6f 7773 2c20 666f 7220 6578  s allows, for ex
-0001c9c0: 616d 706c 652c 2063 686f 6f73 696e 6720  ample, choosing 
-0001c9d0: 7468 6520 4e2d 7468 206d 696e 7574 650a  the N-th minute.
-0001c9e0: 2020 2020 696e 2061 2064 6179 2c20 7768      in a day, wh
-0001c9f0: 6963 6820 6361 6e20 6265 2075 7365 6420  ich can be used 
-0001ca00: 746f 2073 696d 706c 6966 7920 736f 6d65  to simplify some
-0001ca10: 2063 6f6d 7075 7461 7469 6f6e 732e 0a0a   computations...
-0001ca20: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0001ca30: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001ca40: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001ca50: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-0001ca60: 2020 2e2e 2e20 2020 2020 5b5b 3131 2c20    ...     [[11, 
-0001ca70: 3131 2c20 302c 2039 3837 3635 3433 3231  11, 0, 987654321
-0001ca80: 5d2c 205b 3130 2c20 3130 2c20 302c 2039  ], [10, 10, 0, 9
-0001ca90: 3837 3635 3433 3231 5d5d 2c0a 2020 2020  87654321]],.    
-0001caa0: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-0001cab0: 6d61 3d5b 2268 6f75 7222 2c20 226d 696e  ma=["hour", "min
-0001cac0: 7574 6522 2c20 2273 6563 6f6e 6422 2c20  ute", "second", 
-0001cad0: 226e 616e 6f73 6563 6f6e 6473 225d 2c0a  "nanoseconds"],.
-0001cae0: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
-0001caf0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0001cb00: 6563 7428 7469 6d65 5f66 726f 6d5f 7061  ect(time_from_pa
-0001cb10: 7274 7328 0a20 2020 2020 2020 202e 2e2e  rts(.        ...
-0001cb20: 2020 2020 2022 686f 7572 222c 2022 6d69       "hour", "mi
-0001cb30: 6e75 7465 222c 2022 7365 636f 6e64 222c  nute", "second",
-0001cb40: 206e 616e 6f73 6563 6f6e 6473 3d22 6e61   nanoseconds="na
-0001cb50: 6e6f 7365 636f 6e64 7322 0a20 2020 2020  noseconds".     
-0001cb60: 2020 202e 2e2e 2029 2e61 6c69 6173 2822     ... ).alias("
-0001cb70: 5449 4d45 5f46 524f 4d5f 5041 5254 5322  TIME_FROM_PARTS"
-0001cb80: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0001cb90: 2020 2020 205b 526f 7728 5449 4d45 5f46       [Row(TIME_F
-0001cba0: 524f 4d5f 5041 5254 533d 6461 7465 7469  ROM_PARTS=dateti
-0001cbb0: 6d65 2e74 696d 6528 3131 2c20 3131 2c20  me.time(11, 11, 
-0001cbc0: 302c 2039 3837 3635 3429 292c 2052 6f77  0, 987654)), Row
-0001cbd0: 2854 494d 455f 4652 4f4d 5f50 4152 5453  (TIME_FROM_PARTS
-0001cbe0: 3d64 6174 6574 696d 652e 7469 6d65 2831  =datetime.time(1
-0001cbf0: 302c 2031 302c 2030 2c20 3938 3736 3534  0, 10, 0, 987654
-0001cc00: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-0001cc10: 682c 206d 2c20 7320 3d20 5f63 6f6c 756d  h, m, s = _colum
-0001cc20: 6e73 5f66 726f 6d5f 7469 6d65 7374 616d  ns_from_timestam
-0001cc30: 705f 7061 7274 7328 2274 696d 655f 6672  p_parts("time_fr
-0001cc40: 6f6d 5f70 6172 7473 222c 2068 6f75 722c  om_parts", hour,
-0001cc50: 206d 696e 7574 652c 2073 6563 6f6e 6429   minute, second)
-0001cc60: 0a20 2020 2069 6620 6e61 6e6f 7365 636f  .    if nanoseco
-0001cc70: 6e64 733a 0a20 2020 2020 2020 2072 6574  nds:.        ret
-0001cc80: 7572 6e20 6275 696c 7469 6e28 2274 696d  urn builtin("tim
-0001cc90: 655f 6672 6f6d 5f70 6172 7473 2229 280a  e_from_parts")(.
-0001cca0: 2020 2020 2020 2020 2020 2020 682c 206d              h, m
-0001ccb0: 2c20 732c 205f 746f 5f63 6f6c 5f69 665f  , s, _to_col_if_
-0001ccc0: 7374 725f 6f72 5f69 6e74 286e 616e 6f73  str_or_int(nanos
-0001ccd0: 6563 6f6e 6473 2c20 2274 696d 655f 6672  econds, "time_fr
-0001cce0: 6f6d 5f70 6172 7473 2229 0a20 2020 2020  om_parts").     
-0001ccf0: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
-0001cd00: 2020 2020 2020 2072 6574 7572 6e20 6275         return bu
-0001cd10: 696c 7469 6e28 2274 696d 655f 6672 6f6d  iltin("time_from
-0001cd20: 5f70 6172 7473 2229 2868 2c20 6d2c 2073  _parts")(h, m, s
-0001cd30: 290a 0a0a 406f 7665 726c 6f61 640a 6465  )...@overload.de
-0001cd40: 6620 7469 6d65 7374 616d 705f 6672 6f6d  f timestamp_from
-0001cd50: 5f70 6172 7473 2864 6174 655f 6578 7072  _parts(date_expr
-0001cd60: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-0001cd70: 7469 6d65 5f65 7870 723a 2043 6f6c 756d  time_expr: Colum
-0001cd80: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0001cd90: 6d6e 3a0a 2020 2020 2e2e 2e20 2023 2070  mn:.    ...  # p
-0001cda0: 7261 676d 613a 206e 6f20 636f 7665 720a  ragma: no cover.
-0001cdb0: 0a0a 406f 7665 726c 6f61 640a 6465 6620  ..@overload.def 
-0001cdc0: 7469 6d65 7374 616d 705f 6672 6f6d 5f70  timestamp_from_p
-0001cdd0: 6172 7473 280a 2020 2020 7965 6172 3a20  arts(.    year: 
-0001cde0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-0001cdf0: 6d65 2c20 696e 745d 2c0a 2020 2020 6d6f  me, int],.    mo
-0001ce00: 6e74 683a 2055 6e69 6f6e 5b43 6f6c 756d  nth: Union[Colum
-0001ce10: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-0001ce20: 2020 2064 6179 3a20 556e 696f 6e5b 436f     day: Union[Co
-0001ce30: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-0001ce40: 2c0a 2020 2020 686f 7572 3a20 556e 696f  ,.    hour: Unio
-0001ce50: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-0001ce60: 696e 745d 2c0a 2020 2020 6d69 6e75 7465  int],.    minute
-0001ce70: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-0001ce80: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-0001ce90: 7365 636f 6e64 3a20 556e 696f 6e5b 436f  second: Union[Co
-0001cea0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-0001ceb0: 2c0a 2020 2020 6e61 6e6f 7365 636f 6e64  ,.    nanosecond
-0001cec0: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
-0001ced0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-0001cee0: 6e74 5d5d 203d 204e 6f6e 652c 0a20 2020  nt]] = None,.   
-0001cef0: 2074 696d 657a 6f6e 653a 204f 7074 696f   timezone: Optio
-0001cf00: 6e61 6c5b 436f 6c75 6d6e 4f72 4c69 7465  nal[ColumnOrLite
-0001cf10: 7261 6c53 7472 5d20 3d20 4e6f 6e65 2c0a  ralStr] = None,.
-0001cf20: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0001cf30: 202e 2e2e 2020 2320 7072 6167 6d61 3a20   ...  # pragma: 
-0001cf40: 6e6f 2063 6f76 6572 0a0a 0a64 6566 2074  no cover...def t
-0001cf50: 696d 6573 7461 6d70 5f66 726f 6d5f 7061  imestamp_from_pa
-0001cf60: 7274 7328 2a61 7267 732c 202a 2a6b 7761  rts(*args, **kwa
-0001cf70: 7267 7329 202d 3e20 436f 6c75 6d6e 3a0a  rgs) -> Column:.
-0001cf80: 2020 2020 2222 220a 2020 2020 4372 6561      """.    Crea
-0001cf90: 7465 7320 6120 7469 6d65 7374 616d 7020  tes a timestamp 
-0001cfa0: 6672 6f6d 2069 6e64 6976 6964 7561 6c20  from individual 
-0001cfb0: 6e75 6d65 7269 6320 636f 6d70 6f6e 656e  numeric componen
-0001cfc0: 7473 2e20 4966 206e 6f20 7469 6d65 207a  ts. If no time z
-0001cfd0: 6f6e 6520 6973 2069 6e20 6566 6665 6374  one is in effect
-0001cfe0: 2c0a 2020 2020 7468 6520 6675 6e63 7469  ,.    the functi
-0001cff0: 6f6e 2063 616e 2062 6520 7573 6564 2074  on can be used t
-0001d000: 6f20 6372 6561 7465 2061 2074 696d 6573  o create a times
-0001d010: 7461 6d70 2066 726f 6d20 6120 6461 7465  tamp from a date
-0001d020: 2065 7870 7265 7373 696f 6e20 616e 6420   expression and 
-0001d030: 6120 7469 6d65 2065 7870 7265 7373 696f  a time expressio
-0001d040: 6e2e 0a0a 2020 2020 4578 616d 706c 6520  n...    Example 
-0001d050: 313a 3a0a 0a20 2020 2020 2020 203e 3e3e  1::..        >>>
-0001d060: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0001d070: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-0001d080: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001d090: 5b5b 3230 3232 2c20 342c 2031 2c20 3131  [[2022, 4, 1, 11
-0001d0a0: 2c20 3131 2c20 305d 2c20 5b32 3032 322c  , 11, 0], [2022,
-0001d0b0: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
-0001d0c0: 305d 5d2c 0a20 2020 2020 2020 202e 2e2e  0]],.        ...
-0001d0d0: 2020 2020 2073 6368 656d 613d 5b22 7965       schema=["ye
-0001d0e0: 6172 222c 2022 6d6f 6e74 6822 2c20 2264  ar", "month", "d
-0001d0f0: 6179 222c 2022 686f 7572 222c 2022 6d69  ay", "hour", "mi
-0001d100: 6e75 7465 222c 2022 7365 636f 6e64 225d  nute", "second"]
-0001d110: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
-0001d120: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0001d130: 656c 6563 7428 7469 6d65 7374 616d 705f  elect(timestamp_
-0001d140: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
-0001d150: 2020 2020 2e2e 2e20 2020 2020 2279 6561      ...     "yea
-0001d160: 7222 2c20 226d 6f6e 7468 222c 2022 6461  r", "month", "da
-0001d170: 7922 2c20 2268 6f75 7222 2c20 226d 696e  y", "hour", "min
-0001d180: 7574 6522 2c20 2273 6563 6f6e 6422 0a20  ute", "second". 
-0001d190: 2020 2020 2020 202e 2e2e 2029 2e61 6c69         ... ).ali
-0001d1a0: 6173 2822 5449 4d45 5354 414d 505f 4652  as("TIMESTAMP_FR
-0001d1b0: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
-0001d1c0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0001d1d0: 6f77 2854 494d 4553 5441 4d50 5f46 524f  ow(TIMESTAMP_FRO
-0001d1e0: 4d5f 5041 5254 533d 6461 7465 7469 6d65  M_PARTS=datetime
-0001d1f0: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
-0001d200: 342c 2031 2c20 3131 2c20 3131 2929 2c20  4, 1, 11, 11)), 
-0001d210: 526f 7728 5449 4d45 5354 414d 505f 4652  Row(TIMESTAMP_FR
-0001d220: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
-0001d230: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-0001d240: 2033 2c20 3331 2c20 3131 2c20 3131 2929   3, 31, 11, 11))
-0001d250: 5d0a 0a20 2020 2045 7861 6d70 6c65 2032  ]..    Example 2
-0001d260: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001d270: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001d280: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
-0001d290: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
-0001d2a0: 5b27 3230 3232 2d30 342d 3031 272c 2027  ['2022-04-01', '
-0001d2b0: 3131 3a31 313a 3030 275d 2c20 5b27 3230  11:11:00'], ['20
-0001d2c0: 3232 2d30 332d 3331 272c 2027 3131 3a31  22-03-31', '11:1
-0001d2d0: 313a 3030 275d 5d2c 0a20 2020 2020 2020  1:00']],.       
-0001d2e0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-0001d2f0: 5b22 6461 7465 222c 2022 7469 6d65 225d  ["date", "time"]
-0001d300: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-0001d310: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001d320: 6c65 6374 280a 2020 2020 2020 2020 2e2e  lect(.        ..
-0001d330: 2e20 2020 2020 7469 6d65 7374 616d 705f  .     timestamp_
-0001d340: 6672 6f6d 5f70 6172 7473 2874 6f5f 6461  from_parts(to_da
-0001d350: 7465 2822 6461 7465 2229 2c20 746f 5f74  te("date"), to_t
-0001d360: 696d 6528 2274 696d 6522 290a 2020 2020  ime("time").    
-0001d370: 2020 2020 2e2e 2e20 292e 616c 6961 7328      ... ).alias(
-0001d380: 2254 494d 4553 5441 4d50 5f46 524f 4d5f  "TIMESTAMP_FROM_
-0001d390: 5041 5254 5322 2929 2e63 6f6c 6c65 6374  PARTS")).collect
-0001d3a0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0001d3b0: 5449 4d45 5354 414d 505f 4652 4f4d 5f50  TIMESTAMP_FROM_P
-0001d3c0: 4152 5453 3d64 6174 6574 696d 652e 6461  ARTS=datetime.da
-0001d3d0: 7465 7469 6d65 2832 3032 322c 2034 2c20  tetime(2022, 4, 
-0001d3e0: 312c 2031 312c 2031 3129 292c 2052 6f77  1, 11, 11)), Row
-0001d3f0: 2854 494d 4553 5441 4d50 5f46 524f 4d5f  (TIMESTAMP_FROM_
-0001d400: 5041 5254 533d 6461 7465 7469 6d65 2e64  PARTS=datetime.d
-0001d410: 6174 6574 696d 6528 3230 3232 2c20 332c  atetime(2022, 3,
-0001d420: 2033 312c 2031 312c 2031 3129 295d 0a20   31, 11, 11))]. 
-0001d430: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-0001d440: 6e20 6275 696c 7469 6e28 2274 696d 6573  n builtin("times
-0001d450: 7461 6d70 5f66 726f 6d5f 7061 7274 7322  tamp_from_parts"
-0001d460: 2928 0a20 2020 2020 2020 202a 5f74 696d  )(.        *_tim
-0001d470: 6573 7461 6d70 5f66 726f 6d5f 7061 7274  estamp_from_part
-0001d480: 735f 696e 7465 726e 616c 2822 7469 6d65  s_internal("time
-0001d490: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
-0001d4a0: 222c 202a 6172 6773 2c20 2a2a 6b77 6172  ", *args, **kwar
-0001d4b0: 6773 290a 2020 2020 290a 0a0a 6465 6620  gs).    )...def 
-0001d4c0: 7469 6d65 7374 616d 705f 6c74 7a5f 6672  timestamp_ltz_fr
-0001d4d0: 6f6d 5f70 6172 7473 280a 2020 2020 7965  om_parts(.    ye
-0001d4e0: 6172 3a20 556e 696f 6e5b 436f 6c75 6d6e  ar: Union[Column
-0001d4f0: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
-0001d500: 2020 6d6f 6e74 683a 2055 6e69 6f6e 5b43    month: Union[C
-0001d510: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
-0001d520: 5d2c 0a20 2020 2064 6179 3a20 556e 696f  ],.    day: Unio
-0001d530: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-0001d540: 696e 745d 2c0a 2020 2020 686f 7572 3a20  int],.    hour: 
-0001d550: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-0001d560: 6d65 2c20 696e 745d 2c0a 2020 2020 6d69  me, int],.    mi
-0001d570: 6e75 7465 3a20 556e 696f 6e5b 436f 6c75  nute: Union[Colu
-0001d580: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
-0001d590: 2020 2020 7365 636f 6e64 3a20 556e 696f      second: Unio
-0001d5a0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-0001d5b0: 696e 745d 2c0a 2020 2020 6e61 6e6f 7365  int],.    nanose
-0001d5c0: 636f 6e64 733a 204f 7074 696f 6e61 6c5b  conds: Optional[
-0001d5d0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-0001d5e0: 6d65 2c20 696e 745d 5d20 3d20 4e6f 6e65  me, int]] = None
-0001d5f0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-0001d600: 2020 2022 2222 0a20 2020 2043 7265 6174     """.    Creat
-0001d610: 6573 2061 2074 696d 6573 7461 6d70 2066  es a timestamp f
-0001d620: 726f 6d20 696e 6469 7669 6475 616c 206e  rom individual n
-0001d630: 756d 6572 6963 2063 6f6d 706f 6e65 6e74  umeric component
-0001d640: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
-0001d650: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-0001d660: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-0001d670: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001d680: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001d690: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-0001d6a0: 2020 2e2e 2e20 2020 2020 5b5b 3230 3232    ...     [[2022
-0001d6b0: 2c20 342c 2031 2c20 3131 2c20 3131 2c20  , 4, 1, 11, 11, 
-0001d6c0: 305d 2c20 5b32 3032 322c 2033 2c20 3331  0], [2022, 3, 31
-0001d6d0: 2c20 3131 2c20 3131 2c20 305d 5d2c 0a20  , 11, 11, 0]],. 
-0001d6e0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-0001d6f0: 6368 656d 613d 5b22 7965 6172 222c 2022  chema=["year", "
-0001d700: 6d6f 6e74 6822 2c20 2264 6179 222c 2022  month", "day", "
-0001d710: 686f 7572 222c 2022 6d69 6e75 7465 222c  hour", "minute",
-0001d720: 2022 7365 636f 6e64 225d 2c0a 2020 2020   "second"],.    
-0001d730: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
-0001d740: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001d750: 7469 6d65 7374 616d 705f 6c74 7a5f 6672  timestamp_ltz_fr
-0001d760: 6f6d 5f70 6172 7473 280a 2020 2020 2020  om_parts(.      
-0001d770: 2020 2e2e 2e20 2020 2020 2279 6561 7222    ...     "year"
-0001d780: 2c20 226d 6f6e 7468 222c 2022 6461 7922  , "month", "day"
-0001d790: 2c20 2268 6f75 7222 2c20 226d 696e 7574  , "hour", "minut
-0001d7a0: 6522 2c20 2273 6563 6f6e 6422 0a20 2020  e", "second".   
-0001d7b0: 2020 2020 202e 2e2e 2029 2e61 6c69 6173       ... ).alias
-0001d7c0: 2822 5449 4d45 5354 414d 505f 4c54 5a5f  ("TIMESTAMP_LTZ_
-0001d7d0: 4652 4f4d 5f50 4152 5453 2229 292e 636f  FROM_PARTS")).co
-0001d7e0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001d7f0: 5b52 6f77 2854 494d 4553 5441 4d50 5f4c  [Row(TIMESTAMP_L
-0001d800: 545a 5f46 524f 4d5f 5041 5254 533d 6461  TZ_FROM_PARTS=da
-0001d810: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-0001d820: 3230 3232 2c20 342c 2031 2c20 3131 2c20  2022, 4, 1, 11, 
-0001d830: 3131 2c20 747a 696e 666f 3d3c 4473 7454  11, tzinfo=<DstT
-0001d840: 7a49 6e66 6f20 2741 6d65 7269 6361 2f4c  zInfo 'America/L
-0001d850: 6f73 5f41 6e67 656c 6573 2720 5044 542d  os_Angeles' PDT-
-0001d860: 3120 6461 792c 2031 373a 3030 3a30 3020  1 day, 17:00:00 
-0001d870: 4453 543e 2929 2c20 526f 7728 5449 4d45  DST>)), Row(TIME
-0001d880: 5354 414d 505f 4c54 5a5f 4652 4f4d 5f50  STAMP_LTZ_FROM_P
-0001d890: 4152 5453 3d64 6174 6574 696d 652e 6461  ARTS=datetime.da
-0001d8a0: 7465 7469 6d65 2832 3032 322c 2033 2c20  tetime(2022, 3, 
-0001d8b0: 3331 2c20 3131 2c20 3131 2c20 747a 696e  31, 11, 11, tzin
-0001d8c0: 666f 3d3c 4473 7454 7a49 6e66 6f20 2741  fo=<DstTzInfo 'A
-0001d8d0: 6d65 7269 6361 2f4c 6f73 5f41 6e67 656c  merica/Los_Angel
-0001d8e0: 6573 2720 5044 542d 3120 6461 792c 2031  es' PDT-1 day, 1
-0001d8f0: 373a 3030 3a30 3020 4453 543e 2929 5d0a  7:00:00 DST>))].
-0001d900: 2020 2020 2222 220a 2020 2020 6675 6e63      """.    func
-0001d910: 5f6e 616d 6520 3d20 2274 696d 6573 7461  _name = "timesta
-0001d920: 6d70 5f6c 747a 5f66 726f 6d5f 7061 7274  mp_ltz_from_part
-0001d930: 7322 0a20 2020 2079 2c20 6d2c 2064 2c20  s".    y, m, d, 
-0001d940: 682c 206d 696e 5f2c 2073 203d 205f 636f  h, min_, s = _co
-0001d950: 6c75 6d6e 735f 6672 6f6d 5f74 696d 6573  lumns_from_times
-0001d960: 7461 6d70 5f70 6172 7473 280a 2020 2020  tamp_parts(.    
-0001d970: 2020 2020 6675 6e63 5f6e 616d 652c 2079      func_name, y
-0001d980: 6561 722c 206d 6f6e 7468 2c20 6461 792c  ear, month, day,
-0001d990: 2068 6f75 722c 206d 696e 7574 652c 2073   hour, minute, s
-0001d9a0: 6563 6f6e 640a 2020 2020 290a 2020 2020  econd.    ).    
-0001d9b0: 6e73 203d 204e 6f6e 6520 6966 206e 616e  ns = None if nan
-0001d9c0: 6f73 6563 6f6e 6473 2069 7320 4e6f 6e65  oseconds is None
-0001d9d0: 2065 6c73 6520 5f74 6f5f 636f 6c5f 6966   else _to_col_if
-0001d9e0: 5f73 7472 5f6f 725f 696e 7428 6e61 6e6f  _str_or_int(nano
-0001d9f0: 7365 636f 6e64 732c 2066 756e 635f 6e61  seconds, func_na
-0001da00: 6d65 290a 2020 2020 7265 7475 726e 2028  me).    return (
-0001da10: 0a20 2020 2020 2020 2062 7569 6c74 696e  .        builtin
-0001da20: 2866 756e 635f 6e61 6d65 2928 792c 206d  (func_name)(y, m
-0001da30: 2c20 642c 2068 2c20 6d69 6e5f 2c20 7329  , d, h, min_, s)
-0001da40: 0a20 2020 2020 2020 2069 6620 6e73 2069  .        if ns i
-0001da50: 7320 4e6f 6e65 0a20 2020 2020 2020 2065  s None.        e
-0001da60: 6c73 6520 6275 696c 7469 6e28 6675 6e63  lse builtin(func
-0001da70: 5f6e 616d 6529 2879 2c20 6d2c 2064 2c20  _name)(y, m, d, 
-0001da80: 682c 206d 696e 5f2c 2073 2c20 6e73 290a  h, min_, s, ns).
-0001da90: 2020 2020 290a 0a0a 406f 7665 726c 6f61      )...@overloa
-0001daa0: 640a 6465 6620 7469 6d65 7374 616d 705f  d.def timestamp_
-0001dab0: 6e74 7a5f 6672 6f6d 5f70 6172 7473 280a  ntz_from_parts(.
-0001dac0: 2020 2020 6461 7465 5f65 7870 723a 2043      date_expr: C
-0001dad0: 6f6c 756d 6e4f 724e 616d 652c 2074 696d  olumnOrName, tim
-0001dae0: 655f 6578 7072 3a20 436f 6c75 6d6e 4f72  e_expr: ColumnOr
-0001daf0: 4e61 6d65 0a29 202d 3e20 436f 6c75 6d6e  Name.) -> Column
-0001db00: 3a0a 2020 2020 2e2e 2e20 2023 2070 7261  :.    ...  # pra
-0001db10: 676d 613a 206e 6f20 636f 7665 720a 0a0a  gma: no cover...
-0001db20: 406f 7665 726c 6f61 640a 6465 6620 7469  @overload.def ti
-0001db30: 6d65 7374 616d 705f 6e74 7a5f 6672 6f6d  mestamp_ntz_from
-0001db40: 5f70 6172 7473 280a 2020 2020 7965 6172  _parts(.    year
-0001db50: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-0001db60: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-0001db70: 6d6f 6e74 683a 2055 6e69 6f6e 5b43 6f6c  month: Union[Col
-0001db80: 756d 6e4f 724e 616d 652c 2069 6e74 5d2c  umnOrName, int],
-0001db90: 0a20 2020 2064 6179 3a20 556e 696f 6e5b  .    day: Union[
-0001dba0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-0001dbb0: 745d 2c0a 2020 2020 686f 7572 3a20 556e  t],.    hour: Un
-0001dbc0: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-0001dbd0: 2c20 696e 745d 2c0a 2020 2020 6d69 6e75  , int],.    minu
-0001dbe0: 7465 3a20 556e 696f 6e5b 436f 6c75 6d6e  te: Union[Column
-0001dbf0: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
-0001dc00: 2020 7365 636f 6e64 3a20 556e 696f 6e5b    second: Union[
-0001dc10: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-0001dc20: 745d 2c0a 2020 2020 6e61 6e6f 7365 636f  t],.    nanoseco
-0001dc30: 6e64 3a20 4f70 7469 6f6e 616c 5b55 6e69  nd: Optional[Uni
-0001dc40: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-0001dc50: 2069 6e74 5d5d 203d 204e 6f6e 652c 0a29   int]] = None,.)
-0001dc60: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0001dc70: 2e2e 2e20 2023 2070 7261 676d 613a 206e  ...  # pragma: n
-0001dc80: 6f20 636f 7665 720a 0a0a 6465 6620 7469  o cover...def ti
-0001dc90: 6d65 7374 616d 705f 6e74 7a5f 6672 6f6d  mestamp_ntz_from
-0001dca0: 5f70 6172 7473 282a 6172 6773 2c20 2a2a  _parts(*args, **
-0001dcb0: 6b77 6172 6773 2920 2d3e 2043 6f6c 756d  kwargs) -> Colum
-0001dcc0: 6e3a 0a20 2020 2022 2222 0a20 2020 2043  n:.    """.    C
-0001dcd0: 7265 6174 6573 2061 2074 696d 6573 7461  reates a timesta
-0001dce0: 6d70 2066 726f 6d20 696e 6469 7669 6475  mp from individu
-0001dcf0: 616c 206e 756d 6572 6963 2063 6f6d 706f  al numeric compo
-0001dd00: 6e65 6e74 732e 2054 6865 2066 756e 6374  nents. The funct
-0001dd10: 696f 6e20 6361 6e20 6265 2075 7365 6420  ion can be used 
-0001dd20: 746f 0a20 2020 2063 7265 6174 6520 6120  to.    create a 
-0001dd30: 7469 6d65 7374 616d 7020 6672 6f6d 2061  timestamp from a
-0001dd40: 2064 6174 6520 6578 7072 6573 7369 6f6e   date expression
-0001dd50: 2061 6e64 2061 2074 696d 6520 6578 7072   and a time expr
-0001dd60: 6573 7369 6f6e 2e0a 0a20 2020 2045 7861  ession...    Exa
-0001dd70: 6d70 6c65 2031 3a3a 0a0a 2020 2020 2020  mple 1::..      
-0001dd80: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0001dd90: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0001dda0: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-0001ddb0: 2020 2020 205b 5b32 3032 322c 2034 2c20       [[2022, 4, 
-0001ddc0: 312c 2031 312c 2031 312c 2030 5d2c 205b  1, 11, 11, 0], [
-0001ddd0: 3230 3232 2c20 332c 2033 312c 2031 312c  2022, 3, 31, 11,
-0001dde0: 2031 312c 2030 5d5d 2c0a 2020 2020 2020   11, 0]],.      
-0001ddf0: 2020 2e2e 2e20 2020 2020 7363 6865 6d61    ...     schema
-0001de00: 3d5b 2279 6561 7222 2c20 226d 6f6e 7468  =["year", "month
-0001de10: 222c 2022 6461 7922 2c20 2268 6f75 7222  ", "day", "hour"
-0001de20: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
-0001de30: 6f6e 6422 5d2c 0a20 2020 2020 2020 202e  ond"],.        .
-0001de40: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-0001de50: 2064 662e 7365 6c65 6374 2874 696d 6573   df.select(times
-0001de60: 7461 6d70 5f6e 747a 5f66 726f 6d5f 7061  tamp_ntz_from_pa
-0001de70: 7274 7328 0a20 2020 2020 2020 202e 2e2e  rts(.        ...
-0001de80: 2020 2020 2022 7965 6172 222c 2022 6d6f       "year", "mo
-0001de90: 6e74 6822 2c20 2264 6179 222c 2022 686f  nth", "day", "ho
-0001dea0: 7572 222c 2022 6d69 6e75 7465 222c 2022  ur", "minute", "
-0001deb0: 7365 636f 6e64 220a 2020 2020 2020 2020  second".        
-0001dec0: 2e2e 2e20 292e 616c 6961 7328 2254 494d  ... ).alias("TIM
-0001ded0: 4553 5441 4d50 5f4e 545a 5f46 524f 4d5f  ESTAMP_NTZ_FROM_
-0001dee0: 5041 5254 5322 2929 2e63 6f6c 6c65 6374  PARTS")).collect
-0001def0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0001df00: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
-0001df10: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
-0001df20: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-0001df30: 2034 2c20 312c 2031 312c 2031 3129 292c   4, 1, 11, 11)),
-0001df40: 2052 6f77 2854 494d 4553 5441 4d50 5f4e   Row(TIMESTAMP_N
-0001df50: 545a 5f46 524f 4d5f 5041 5254 533d 6461  TZ_FROM_PARTS=da
-0001df60: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-0001df70: 3230 3232 2c20 332c 2033 312c 2031 312c  2022, 3, 31, 11,
-0001df80: 2031 3129 295d 0a0a 2020 2020 4578 616d   11))]..    Exam
-0001df90: 706c 6520 323a 3a0a 0a20 2020 2020 2020  ple 2::..       
-0001dfa0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0001dfb0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0001dfc0: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
-0001dfd0: 2020 2020 5b5b 2732 3032 322d 3034 2d30      [['2022-04-0
-0001dfe0: 3127 2c20 2731 313a 3131 3a30 3027 5d2c  1', '11:11:00'],
-0001dff0: 205b 2732 3032 322d 3033 2d33 3127 2c20   ['2022-03-31', 
-0001e000: 2731 313a 3131 3a30 3027 5d5d 2c0a 2020  '11:11:00']],.  
-0001e010: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-0001e020: 6865 6d61 3d5b 2264 6174 6522 2c20 2274  hema=["date", "t
-0001e030: 696d 6522 5d0a 2020 2020 2020 2020 2e2e  ime"].        ..
-0001e040: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-0001e050: 6466 2e73 656c 6563 7428 0a20 2020 2020  df.select(.     
-0001e060: 2020 202e 2e2e 2020 2020 2074 696d 6573     ...     times
-0001e070: 7461 6d70 5f6e 747a 5f66 726f 6d5f 7061  tamp_ntz_from_pa
-0001e080: 7274 7328 746f 5f64 6174 6528 2264 6174  rts(to_date("dat
-0001e090: 6522 292c 2074 6f5f 7469 6d65 2822 7469  e"), to_time("ti
-0001e0a0: 6d65 2229 0a20 2020 2020 2020 202e 2e2e  me").        ...
-0001e0b0: 2029 2e61 6c69 6173 2822 5449 4d45 5354   ).alias("TIMEST
-0001e0c0: 414d 505f 4e54 5a5f 4652 4f4d 5f50 4152  AMP_NTZ_FROM_PAR
-0001e0d0: 5453 2229 292e 636f 6c6c 6563 7428 290a  TS")).collect().
-0001e0e0: 2020 2020 2020 2020 5b52 6f77 2854 494d          [Row(TIM
-0001e0f0: 4553 5441 4d50 5f4e 545a 5f46 524f 4d5f  ESTAMP_NTZ_FROM_
-0001e100: 5041 5254 533d 6461 7465 7469 6d65 2e64  PARTS=datetime.d
-0001e110: 6174 6574 696d 6528 3230 3232 2c20 342c  atetime(2022, 4,
-0001e120: 2031 2c20 3131 2c20 3131 2929 2c20 526f   1, 11, 11)), Ro
-0001e130: 7728 5449 4d45 5354 414d 505f 4e54 5a5f  w(TIMESTAMP_NTZ_
-0001e140: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
-0001e150: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-0001e160: 322c 2033 2c20 3331 2c20 3131 2c20 3131  2, 3, 31, 11, 11
-0001e170: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-0001e180: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0001e190: 7469 6d65 7374 616d 705f 6e74 7a5f 6672  timestamp_ntz_fr
-0001e1a0: 6f6d 5f70 6172 7473 2229 280a 2020 2020  om_parts")(.    
-0001e1b0: 2020 2020 2a5f 7469 6d65 7374 616d 705f      *_timestamp_
-0001e1c0: 6672 6f6d 5f70 6172 7473 5f69 6e74 6572  from_parts_inter
-0001e1d0: 6e61 6c28 2274 696d 6573 7461 6d70 5f6e  nal("timestamp_n
-0001e1e0: 747a 5f66 726f 6d5f 7061 7274 7322 2c20  tz_from_parts", 
-0001e1f0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0001e200: 0a20 2020 2029 0a0a 0a64 6566 2074 696d  .    )...def tim
-0001e210: 6573 7461 6d70 5f74 7a5f 6672 6f6d 5f70  estamp_tz_from_p
-0001e220: 6172 7473 280a 2020 2020 7965 6172 3a20  arts(.    year: 
-0001e230: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-0001e240: 6d65 2c20 696e 745d 2c0a 2020 2020 6d6f  me, int],.    mo
-0001e250: 6e74 683a 2055 6e69 6f6e 5b43 6f6c 756d  nth: Union[Colum
-0001e260: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-0001e270: 2020 2064 6179 3a20 556e 696f 6e5b 436f     day: Union[Co
-0001e280: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-0001e290: 2c0a 2020 2020 686f 7572 3a20 556e 696f  ,.    hour: Unio
-0001e2a0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-0001e2b0: 696e 745d 2c0a 2020 2020 6d69 6e75 7465  int],.    minute
-0001e2c0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-0001e2d0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-0001e2e0: 7365 636f 6e64 3a20 556e 696f 6e5b 436f  second: Union[Co
-0001e2f0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-0001e300: 2c0a 2020 2020 6e61 6e6f 7365 636f 6e64  ,.    nanosecond
-0001e310: 733a 204f 7074 696f 6e61 6c5b 556e 696f  s: Optional[Unio
-0001e320: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-0001e330: 696e 745d 5d20 3d20 4e6f 6e65 2c0a 2020  int]] = None,.  
-0001e340: 2020 7469 6d65 7a6f 6e65 3a20 4f70 7469    timezone: Opti
-0001e350: 6f6e 616c 5b43 6f6c 756d 6e4f 724c 6974  onal[ColumnOrLit
-0001e360: 6572 616c 5374 725d 203d 204e 6f6e 652c  eralStr] = None,
-0001e370: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
-0001e380: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-0001e390: 7320 6120 7469 6d65 7374 616d 7020 6672  s a timestamp fr
-0001e3a0: 6f6d 2069 6e64 6976 6964 7561 6c20 6e75  om individual nu
-0001e3b0: 6d65 7269 6320 636f 6d70 6f6e 656e 7473  meric components
-0001e3c0: 2061 6e64 2061 2073 7472 696e 6720 7469   and a string ti
-0001e3d0: 6d65 7a6f 6e65 2e0a 0a20 2020 2045 7861  mezone...    Exa
-0001e3e0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0001e3f0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0001e400: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0001e410: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-0001e420: 2020 205b 5b32 3032 322c 2034 2c20 312c     [[2022, 4, 1,
-0001e430: 2031 312c 2031 312c 2030 2c20 2741 6d65   11, 11, 0, 'Ame
-0001e440: 7269 6361 2f4c 6f73 5f41 6e67 656c 6573  rica/Los_Angeles
-0001e450: 275d 2c20 5b32 3032 322c 2033 2c20 3331  '], [2022, 3, 31
-0001e460: 2c20 3131 2c20 3131 2c20 302c 2027 416d  , 11, 11, 0, 'Am
-0001e470: 6572 6963 612f 4c6f 735f 416e 6765 6c65  erica/Los_Angele
-0001e480: 7327 5d5d 2c0a 2020 2020 2020 2020 2e2e  s']],.        ..
-0001e490: 2e20 2020 2020 7363 6865 6d61 3d5b 2279  .     schema=["y
-0001e4a0: 6561 7222 2c20 226d 6f6e 7468 222c 2022  ear", "month", "
-0001e4b0: 6461 7922 2c20 2268 6f75 7222 2c20 226d  day", "hour", "m
-0001e4c0: 696e 7574 6522 2c20 2273 6563 6f6e 6422  inute", "second"
-0001e4d0: 2c20 2274 696d 657a 6f6e 6522 5d2c 0a20  , "timezone"],. 
-0001e4e0: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-0001e4f0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001e500: 6374 2874 696d 6573 7461 6d70 5f74 7a5f  ct(timestamp_tz_
-0001e510: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
-0001e520: 2020 2020 2e2e 2e20 2020 2020 2279 6561      ...     "yea
-0001e530: 7222 2c20 226d 6f6e 7468 222c 2022 6461  r", "month", "da
-0001e540: 7922 2c20 2268 6f75 7222 2c20 226d 696e  y", "hour", "min
-0001e550: 7574 6522 2c20 2273 6563 6f6e 6422 2c20  ute", "second", 
-0001e560: 7469 6d65 7a6f 6e65 3d22 7469 6d65 7a6f  timezone="timezo
-0001e570: 6e65 220a 2020 2020 2020 2020 2e2e 2e20  ne".        ... 
-0001e580: 292e 616c 6961 7328 2254 494d 4553 5441  ).alias("TIMESTA
-0001e590: 4d50 5f54 5a5f 4652 4f4d 5f50 4152 5453  MP_TZ_FROM_PARTS
-0001e5a0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-0001e5b0: 2020 2020 2020 5b52 6f77 2854 494d 4553        [Row(TIMES
-0001e5c0: 5441 4d50 5f54 5a5f 4652 4f4d 5f50 4152  TAMP_TZ_FROM_PAR
-0001e5d0: 5453 3d64 6174 6574 696d 652e 6461 7465  TS=datetime.date
-0001e5e0: 7469 6d65 2832 3032 322c 2034 2c20 312c  time(2022, 4, 1,
-0001e5f0: 2031 312c 2031 312c 2074 7a69 6e66 6f3d   11, 11, tzinfo=
-0001e600: 7079 747a 2e46 6978 6564 4f66 6673 6574  pytz.FixedOffset
-0001e610: 282d 3432 3029 2929 2c20 526f 7728 5449  (-420))), Row(TI
-0001e620: 4d45 5354 414d 505f 545a 5f46 524f 4d5f  MESTAMP_TZ_FROM_
-0001e630: 5041 5254 533d 6461 7465 7469 6d65 2e64  PARTS=datetime.d
-0001e640: 6174 6574 696d 6528 3230 3232 2c20 332c  atetime(2022, 3,
-0001e650: 2033 312c 2031 312c 2031 312c 2074 7a69   31, 11, 11, tzi
-0001e660: 6e66 6f3d 7079 747a 2e46 6978 6564 4f66  nfo=pytz.FixedOf
-0001e670: 6673 6574 282d 3432 3029 2929 5d0a 2020  fset(-420)))].  
-0001e680: 2020 2222 220a 2020 2020 6675 6e63 5f6e    """.    func_n
-0001e690: 616d 6520 3d20 2274 696d 6573 7461 6d70  ame = "timestamp
-0001e6a0: 5f74 7a5f 6672 6f6d 5f70 6172 7473 220a  _tz_from_parts".
-0001e6b0: 2020 2020 792c 206d 2c20 642c 2068 2c20      y, m, d, h, 
-0001e6c0: 6d69 6e5f 2c20 7320 3d20 5f63 6f6c 756d  min_, s = _colum
-0001e6d0: 6e73 5f66 726f 6d5f 7469 6d65 7374 616d  ns_from_timestam
-0001e6e0: 705f 7061 7274 7328 0a20 2020 2020 2020  p_parts(.       
-0001e6f0: 2066 756e 635f 6e61 6d65 2c20 7965 6172   func_name, year
-0001e700: 2c20 6d6f 6e74 682c 2064 6179 2c20 686f  , month, day, ho
-0001e710: 7572 2c20 6d69 6e75 7465 2c20 7365 636f  ur, minute, seco
-0001e720: 6e64 0a20 2020 2029 0a20 2020 206e 7320  nd.    ).    ns 
-0001e730: 3d20 4e6f 6e65 2069 6620 6e61 6e6f 7365  = None if nanose
-0001e740: 636f 6e64 7320 6973 204e 6f6e 6520 656c  conds is None el
-0001e750: 7365 205f 746f 5f63 6f6c 5f69 665f 7374  se _to_col_if_st
-0001e760: 725f 6f72 5f69 6e74 286e 616e 6f73 6563  r_or_int(nanosec
-0001e770: 6f6e 6473 2c20 6675 6e63 5f6e 616d 6529  onds, func_name)
-0001e780: 0a20 2020 2074 7a20 3d20 4e6f 6e65 2069  .    tz = None i
-0001e790: 6620 7469 6d65 7a6f 6e65 2069 7320 4e6f  f timezone is No
-0001e7a0: 6e65 2065 6c73 6520 5f74 6f5f 636f 6c5f  ne else _to_col_
-0001e7b0: 6966 5f73 716c 5f65 7870 7228 7469 6d65  if_sql_expr(time
-0001e7c0: 7a6f 6e65 2c20 6675 6e63 5f6e 616d 6529  zone, func_name)
-0001e7d0: 0a20 2020 2069 6620 6e61 6e6f 7365 636f  .    if nanoseco
-0001e7e0: 6e64 7320 6973 206e 6f74 204e 6f6e 6520  nds is not None 
-0001e7f0: 616e 6420 7469 6d65 7a6f 6e65 2069 7320  and timezone is 
-0001e800: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0001e810: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0001e820: 2866 756e 635f 6e61 6d65 2928 792c 206d  (func_name)(y, m
-0001e830: 2c20 642c 2068 2c20 6d69 6e5f 2c20 732c  , d, h, min_, s,
-0001e840: 206e 732c 2074 7a29 0a20 2020 2065 6c69   ns, tz).    eli
-0001e850: 6620 6e61 6e6f 7365 636f 6e64 7320 6973  f nanoseconds is
-0001e860: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0001e870: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0001e880: 6e28 6675 6e63 5f6e 616d 6529 2879 2c20  n(func_name)(y, 
-0001e890: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
-0001e8a0: 2c20 6e73 290a 2020 2020 656c 6966 2074  , ns).    elif t
-0001e8b0: 696d 657a 6f6e 6520 6973 206e 6f74 204e  imezone is not N
-0001e8c0: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
-0001e8d0: 7572 6e20 6275 696c 7469 6e28 6675 6e63  urn builtin(func
-0001e8e0: 5f6e 616d 6529 2879 2c20 6d2c 2064 2c20  _name)(y, m, d, 
-0001e8f0: 682c 206d 696e 5f2c 2073 2c20 6c69 7428  h, min_, s, lit(
-0001e900: 3029 2c20 747a 290a 2020 2020 656c 7365  0), tz).    else
-0001e910: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001e920: 2062 7569 6c74 696e 2866 756e 635f 6e61   builtin(func_na
-0001e930: 6d65 2928 792c 206d 2c20 642c 2068 2c20  me)(y, m, d, h, 
-0001e940: 6d69 6e5f 2c20 7329 0a0a 0a64 6566 2077  min_, s)...def w
-0001e950: 6565 6b6f 6679 6561 7228 653a 2043 6f6c  eekofyear(e: Col
-0001e960: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0001e970: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-0001e980: 2020 4578 7472 6163 7473 2074 6865 2063    Extracts the c
-0001e990: 6f72 7265 7370 6f6e 6469 6e67 2077 6565  orresponding wee
-0001e9a0: 6b20 286e 756d 6265 7229 206f 6620 7468  k (number) of th
-0001e9b0: 6520 7965 6172 2066 726f 6d20 6120 6461  e year from a da
-0001e9c0: 7465 206f 7220 7469 6d65 7374 616d 702e  te or timestamp.
-0001e9d0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0001e9e0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0001e9f0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-0001ea00: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0001ea10: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0001ea20: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-0001ea30: 2e2e 2e20 2020 2020 5b5b 6461 7465 7469  ...     [[dateti
-0001ea40: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-0001ea50: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
-0001ea60: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
-0001ea70: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-0001ea80: 2553 2e25 6622 295d 5d2c 0a20 2020 2020  %S.%f")]],.     
-0001ea90: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-0001eaa0: 613d 5b22 6122 5d2c 0a20 2020 2020 2020  a=["a"],.       
-0001eab0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
-0001eac0: 3e3e 2064 662e 7365 6c65 6374 2877 6565  >> df.select(wee
-0001ead0: 6b6f 6679 6561 7228 2261 2229 292e 636f  kofyear("a")).co
-0001eae0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001eaf0: 5b52 6f77 2857 4545 4b4f 4659 4541 5228  [Row(WEEKOFYEAR(
-0001eb00: 2241 2229 3d31 3829 5d0a 2020 2020 2222  "A")=18)].    ""
-0001eb10: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0001eb20: 6c5f 6966 5f73 7472 2865 2c20 2277 6565  l_if_str(e, "wee
-0001eb30: 6b6f 6679 6561 7222 290a 2020 2020 7265  kofyear").    re
-0001eb40: 7475 726e 2062 7569 6c74 696e 2822 7765  turn builtin("we
-0001eb50: 656b 6f66 7965 6172 2229 2863 290a 0a0a  ekofyear")(c)...
-0001eb60: 6465 6620 7479 7065 6f66 2863 6f6c 3a20  def typeof(col: 
-0001eb70: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0001eb80: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0001eb90: 5265 706f 7274 7320 7468 6520 7479 7065  Reports the type
-0001eba0: 206f 6620 6120 7661 6c75 6520 7374 6f72   of a value stor
-0001ebb0: 6564 2069 6e20 6120 5641 5249 414e 5420  ed in a VARIANT 
-0001ebc0: 636f 6c75 6d6e 2e20 5468 6520 7479 7065  column. The type
-0001ebd0: 2069 7320 7265 7475 726e 6564 2061 7320   is returned as 
-0001ebe0: 6120 7374 7269 6e67 2e0a 0a20 2020 2046  a string...    F
-0001ebf0: 6f72 2063 6f6c 756d 6e73 2077 6865 7265  or columns where
-0001ec00: 2061 6c6c 2072 6f77 7320 7368 6172 6520   all rows share 
-0001ec10: 7468 6520 7361 6d65 2074 7970 652c 2074  the same type, t
-0001ec20: 6865 2072 6573 756c 7420 6f66 2060 7479  he result of `ty
-0001ec30: 7065 6f66 6020 6973 2074 6865 2075 6e64  peof` is the und
-0001ec40: 6572 6c79 696e 6720 536e 6f77 666c 616b  erlying Snowflak
-0001ec50: 6520 636f 6c75 6d6e 2074 7970 652e 0a0a  e column type...
-0001ec60: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0001ec70: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001ec80: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001ec90: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
-0001eca0: 335d 2c20 7363 6865 6d61 3d5b 2241 225d  3], schema=["A"]
-0001ecb0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0001ecc0: 2e73 656c 6563 7428 7479 7065 6f66 2863  .select(typeof(c
-0001ecd0: 6f6c 2822 4122 2929 2e61 735f 2822 616e  ol("A")).as_("an
-0001ece0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-0001ecf0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-0001ed00: 2749 4e54 4547 4552 2729 2c20 526f 7728  'INTEGER'), Row(
-0001ed10: 414e 533d 2749 4e54 4547 4552 2729 2c20  ANS='INTEGER'), 
-0001ed20: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
-0001ed30: 2729 5d0a 0a20 2020 2046 6f72 2063 6f6c  ')]..    For col
-0001ed40: 756d 6e73 206f 6620 5641 5249 414e 5420  umns of VARIANT 
-0001ed50: 7479 7065 2c20 7468 6520 756e 6465 726c  type, the underl
-0001ed60: 7969 6e67 2073 746f 7265 6420 7479 7065  ying stored type
-0001ed70: 2069 7320 7265 7475 726e 6564 2e0a 0a20   is returned... 
-0001ed80: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0001ed90: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0001eda0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0001edb0: 6b2e 7479 7065 7320 696d 706f 7274 2056  k.types import V
-0001edc0: 6172 6961 6e74 5479 7065 2c20 5374 7275  ariantType, Stru
-0001edd0: 6374 5479 7065 2c20 5374 7275 6374 4669  ctType, StructFi
-0001ede0: 656c 640a 2020 2020 2020 2020 3e3e 3e20  eld.        >>> 
-0001edf0: 7363 6865 6d61 203d 2053 7472 7563 7454  schema = StructT
-0001ee00: 7970 6528 5b53 7472 7563 7446 6965 6c64  ype([StructField
-0001ee10: 2822 4122 2c20 5661 7269 616e 7454 7970  ("A", VariantTyp
-0001ee20: 6528 2929 5d29 0a20 2020 2020 2020 203e  e())]).        >
-0001ee30: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0001ee40: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0001ee50: 285b 312c 2033 2e31 2c20 2774 6573 7427  ([1, 3.1, 'test'
-0001ee60: 5d2c 2073 6368 656d 613d 7363 6865 6d61  ], schema=schema
-0001ee70: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0001ee80: 2e73 656c 6563 7428 7479 7065 6f66 2863  .select(typeof(c
-0001ee90: 6f6c 2822 4122 2929 2e61 735f 2822 616e  ol("A")).as_("an
-0001eea0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-0001eeb0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-0001eec0: 2749 4e54 4547 4552 2729 2c20 526f 7728  'INTEGER'), Row(
-0001eed0: 414e 533d 2744 4543 494d 414c 2729 2c20  ANS='DECIMAL'), 
-0001eee0: 526f 7728 414e 533d 2756 4152 4348 4152  Row(ANS='VARCHAR
-0001eef0: 2729 5d0a 0a20 2020 2022 2222 0a20 2020  ')]..    """.   
-0001ef00: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-0001ef10: 7374 7228 636f 6c2c 2022 7479 7065 6f66  str(col, "typeof
-0001ef20: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-0001ef30: 696c 7469 6e28 2274 7970 656f 6622 2928  iltin("typeof")(
-0001ef40: 6329 0a0a 0a64 6566 2063 6865 636b 5f6a  c)...def check_j
-0001ef50: 736f 6e28 636f 6c3a 2043 6f6c 756d 6e4f  son(col: ColumnO
-0001ef60: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0001ef70: 3a0a 2020 2020 2222 2243 6865 636b 7320  :.    """Checks 
-0001ef80: 7468 6520 7661 6c69 6469 7479 206f 6620  the validity of 
-0001ef90: 6120 4a53 4f4e 2064 6f63 756d 656e 742e  a JSON document.
-0001efa0: 0a20 2020 2049 6620 7468 6520 696e 7075  .    If the inpu
-0001efb0: 7420 7374 7269 6e67 2069 7320 6120 7661  t string is a va
-0001efc0: 6c69 6420 4a53 4f4e 2064 6f63 756d 656e  lid JSON documen
-0001efd0: 7420 6f72 2061 204e 554c 4c20 2869 2e65  t or a NULL (i.e
-0001efe0: 2e20 6e6f 2065 7272 6f72 2077 6f75 6c64  . no error would
-0001eff0: 206f 6363 7572 2077 6865 6e0a 2020 2020   occur when.    
-0001f000: 7061 7273 696e 6720 7468 6520 696e 7075  parsing the inpu
-0001f010: 7420 7374 7269 6e67 292c 2074 6865 2066  t string), the f
-0001f020: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
-0001f030: 4e55 4c4c 2e0a 2020 2020 496e 2063 6173  NULL..    In cas
-0001f040: 6520 6f66 2061 204a 534f 4e20 7061 7273  e of a JSON pars
-0001f050: 696e 6720 6572 726f 722c 2074 6865 2066  ing error, the f
-0001f060: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
-0001f070: 6120 7374 7269 6e67 2074 6861 7420 636f  a string that co
-0001f080: 6e74 6169 6e73 2074 6865 2065 7272 6f72  ntains the error
-0001f090: 0a20 2020 206d 6573 7361 6765 2e0a 0a20  .    message... 
-0001f0a0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0001f0b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0001f0c0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0001f0d0: 7461 6672 616d 6528 5b22 7b27 5661 6c69  taframe(["{'Vali
-0001f0e0: 644b 6579 3127 3a20 2756 616c 6964 5661  dKey1': 'ValidVa
-0001f0f0: 6c75 6531 277d 222c 2022 7b27 4d61 6c66  lue1'}", "{'Malf
-0001f100: 6f72 6d65 6420 2d2d 206d 6973 7369 6e67  ormed -- missing
-0001f110: 2076 616c 273a 7d22 2c20 4e6f 6e65 5d2c   val':}", None],
-0001f120: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
-0001f130: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001f140: 6c65 6374 2863 6865 636b 5f6a 736f 6e28  lect(check_json(
-0001f150: 6466 2e61 2929 2e73 686f 7728 290a 2020  df.a)).show().  
-0001f160: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001f170: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0001f180: 2020 2020 2020 7c22 4348 4543 4b5f 4a53        |"CHECK_JS
-0001f190: 4f4e 2822 2241 2222 2922 2020 7c0a 2020  ON(""A"")"  |.  
-0001f1a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001f1b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0001f1c0: 2020 2020 2020 7c4e 554c 4c20 2020 2020        |NULL     
-0001f1d0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-0001f1e0: 2020 2020 2020 7c6d 6973 706c 6163 6564        |misplaced
-0001f1f0: 207d 2c20 706f 7320 3239 2020 7c0a 2020   }, pos 29  |.  
-0001f200: 2020 2020 2020 7c4e 554c 4c20 2020 2020        |NULL     
-0001f210: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-0001f220: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001f230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0001f240: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-0001f250: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
-0001f260: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001f270: 2863 6f6c 2c20 2263 6865 636b 5f6a 736f  (col, "check_jso
-0001f280: 6e22 290a 2020 2020 7265 7475 726e 2062  n").    return b
-0001f290: 7569 6c74 696e 2822 6368 6563 6b5f 6a73  uiltin("check_js
-0001f2a0: 6f6e 2229 2863 290a 0a0a 6465 6620 6368  on")(c)...def ch
-0001f2b0: 6563 6b5f 786d 6c28 636f 6c3a 2043 6f6c  eck_xml(col: Col
-0001f2c0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0001f2d0: 6c75 6d6e 3a0a 2020 2020 2222 2243 6865  lumn:.    """Che
-0001f2e0: 636b 7320 7468 6520 7661 6c69 6469 7479  cks the validity
-0001f2f0: 206f 6620 616e 2058 4d4c 2064 6f63 756d   of an XML docum
-0001f300: 656e 742e 0a20 2020 2049 6620 7468 6520  ent..    If the 
-0001f310: 696e 7075 7420 7374 7269 6e67 2069 7320  input string is 
-0001f320: 6120 7661 6c69 6420 584d 4c20 646f 6375  a valid XML docu
-0001f330: 6d65 6e74 206f 7220 6120 4e55 4c4c 2028  ment or a NULL (
-0001f340: 692e 652e 206e 6f20 6572 726f 7220 776f  i.e. no error wo
-0001f350: 756c 6420 6f63 6375 7220 7768 656e 2070  uld occur when p
-0001f360: 6172 7369 6e67 0a20 2020 2074 6865 2069  arsing.    the i
-0001f370: 6e70 7574 2073 7472 696e 6729 2c20 7468  nput string), th
-0001f380: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
-0001f390: 6e73 204e 554c 4c2e 0a20 2020 2049 6e20  ns NULL..    In 
-0001f3a0: 6361 7365 206f 6620 616e 2058 4d4c 2070  case of an XML p
-0001f3b0: 6172 7369 6e67 2065 7272 6f72 2c20 7468  arsing error, th
-0001f3c0: 6520 6f75 7470 7574 2073 7472 696e 6720  e output string 
-0001f3d0: 636f 6e74 6169 6e73 2074 6865 2065 7272  contains the err
-0001f3e0: 6f72 206d 6573 7361 6765 2e0a 0a20 2020  or message...   
-0001f3f0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0001f400: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001f410: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0001f420: 6672 616d 6528 5b22 3c6e 616d 653e 2056  frame(["<name> V
-0001f430: 616c 6964 203c 2f6e 616d 653e 222c 2022  alid </name>", "
-0001f440: 3c6e 616d 653e 2049 6e76 616c 6964 203c  <name> Invalid <
-0001f450: 2f57 524f 4e47 5f43 4c4f 5349 4e47 5f54  /WRONG_CLOSING_T
-0001f460: 4147 3e22 2c20 4e6f 6e65 5d2c 2073 6368  AG>", None], sch
-0001f470: 656d 613d 5b27 6127 5d29 0a20 2020 2020  ema=['a']).     
-0001f480: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0001f490: 2863 6865 636b 5f78 6d6c 2864 662e 6129  (check_xml(df.a)
-0001f4a0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0001f4b0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0001f4c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001f4d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001f4e0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2243  ----.        |"C
-0001f4f0: 4845 434b 5f58 4d4c 2822 2241 2222 2922  HECK_XML(""A"")"
-0001f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f510: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0001f520: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001f530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001f540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001f550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001f560: 2020 2020 207c 4e55 4c4c 2020 2020 2020       |NULL      
-0001f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f590: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0001f5a0: 207c 6e6f 206f 7065 6e69 6e67 2074 6167   |no opening tag
-0001f5b0: 2066 6f72 203c 2f57 524f 4e47 5f43 4c4f   for </WRONG_CLO
-0001f5c0: 5349 4e47 5f54 4147 3e2c 2070 6f73 2033  SING_TAG>, pos 3
-0001f5d0: 3520 207c 0a20 2020 2020 2020 207c 4e55  5  |.        |NU
-0001f5e0: 4c4c 2020 2020 2020 2020 2020 2020 2020  LL              
-0001f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f600: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0001f610: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001f620: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001f630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001f640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001f650: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0001f660: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0001f670: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0001f680: 636f 6c2c 2022 6368 6563 6b5f 786d 6c22  col, "check_xml"
-0001f690: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0001f6a0: 6c74 696e 2822 6368 6563 6b5f 786d 6c22  ltin("check_xml"
-0001f6b0: 2928 6329 0a0a 0a64 6566 206a 736f 6e5f  )(c)...def json_
-0001f6c0: 6578 7472 6163 745f 7061 7468 5f74 6578  extract_path_tex
-0001f6d0: 7428 636f 6c3a 2043 6f6c 756d 6e4f 724e  t(col: ColumnOrN
-0001f6e0: 616d 652c 2070 6174 683a 2043 6f6c 756d  ame, path: Colum
-0001f6f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0001f700: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0001f710: 5061 7273 6573 2061 204a 534f 4e20 7374  Parses a JSON st
-0001f720: 7269 6e67 2061 6e64 2072 6574 7572 6e73  ring and returns
-0001f730: 2074 6865 2076 616c 7565 206f 6620 616e   the value of an
-0001f740: 2065 6c65 6d65 6e74 2061 7420 6120 7370   element at a sp
-0001f750: 6563 6966 6965 6420 7061 7468 2069 6e20  ecified path in 
-0001f760: 7468 6520 7265 7375 6c74 696e 670a 2020  the resulting.  
-0001f770: 2020 4a53 4f4e 2064 6f63 756d 656e 742e    JSON document.
-0001f780: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0001f790: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0001f7a0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0001f7b0: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
-0001f7c0: 6d70 6f72 7420 6a73 6f6e 5f65 7874 7261  mport json_extra
-0001f7d0: 6374 5f70 6174 685f 7465 7874 2c20 746f  ct_path_text, to
-0001f7e0: 5f76 6172 6961 6e74 0a20 2020 2020 2020  _variant.       
-0001f7f0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0001f800: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0001f810: 6d65 285b 5b7b 2261 223a 2022 666f 6f22  me([[{"a": "foo"
-0001f820: 7d2c 2022 6122 5d2c 205b 7b22 6122 3a20  }, "a"], [{"a": 
-0001f830: 4e6f 6e65 7d2c 2022 6122 5d2c 205b 7b22  None}, "a"], [{"
-0001f840: 6122 3a20 2266 6f6f 227d 2c20 2262 225d  a": "foo"}, "b"]
-0001f850: 2c20 5b4e 6f6e 652c 2022 6122 5d5d 2c20  , [None, "a"]], 
-0001f860: 7363 6865 6d61 3d5b 226b 222c 2022 7622  schema=["k", "v"
-0001f870: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0001f880: 662e 7365 6c65 6374 286a 736f 6e5f 6578  f.select(json_ex
-0001f890: 7472 6163 745f 7061 7468 5f74 6578 7428  tract_path_text(
-0001f8a0: 746f 5f76 6172 6961 6e74 2822 6b22 292c  to_variant("k"),
-0001f8b0: 2022 7622 292e 6173 5f28 2272 6573 2229   "v").as_("res")
-0001f8c0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0001f8d0: 2020 2020 5b52 6f77 2852 4553 3d27 666f      [Row(RES='fo
-0001f8e0: 6f27 292c 2052 6f77 2852 4553 3d4e 6f6e  o'), Row(RES=Non
-0001f8f0: 6529 2c20 526f 7728 5245 533d 4e6f 6e65  e), Row(RES=None
-0001f900: 292c 2052 6f77 2852 4553 3d4e 6f6e 6529  ), Row(RES=None)
-0001f910: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0001f920: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001f930: 2863 6f6c 2c20 226a 736f 6e5f 6578 7472  (col, "json_extr
-0001f940: 6163 745f 7061 7468 5f74 6578 7422 290a  act_path_text").
-0001f950: 2020 2020 7020 3d20 5f74 6f5f 636f 6c5f      p = _to_col_
-0001f960: 6966 5f73 7472 2870 6174 682c 2022 6a73  if_str(path, "js
-0001f970: 6f6e 5f65 7874 7261 6374 5f70 6174 685f  on_extract_path_
-0001f980: 7465 7874 2229 0a20 2020 2072 6574 7572  text").    retur
-0001f990: 6e20 6275 696c 7469 6e28 226a 736f 6e5f  n builtin("json_
-0001f9a0: 6578 7472 6163 745f 7061 7468 5f74 6578  extract_path_tex
-0001f9b0: 7422 2928 632c 2070 290a 0a0a 6465 6620  t")(c, p)...def 
-0001f9c0: 7061 7273 655f 6a73 6f6e 2865 3a20 436f  parse_json(e: Co
-0001f9d0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0001f9e0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5061  olumn:.    """Pa
-0001f9f0: 7273 6520 7468 6520 7661 6c75 6520 6f66  rse the value of
-0001fa00: 2074 6865 2073 7065 6369 6669 6564 2063   the specified c
-0001fa10: 6f6c 756d 6e20 6173 2061 204a 534f 4e20  olumn as a JSON 
-0001fa20: 7374 7269 6e67 2061 6e64 2072 6574 7572  string and retur
-0001fa30: 6e73 2074 6865 0a20 2020 2072 6573 756c  ns the.    resul
-0001fa40: 7469 6e67 204a 534f 4e20 646f 6375 6d65  ting JSON docume
-0001fa50: 6e74 2e0a 0a20 2020 2045 7861 6d70 6c65  nt...    Example
-0001fa60: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001fa70: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001fa80: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-0001fa90: 277b 226b 6579 223a 2022 3122 7d27 5d5d  '{"key": "1"}']]
-0001faa0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0001fab0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0001fac0: 656c 6563 7428 7061 7273 655f 6a73 6f6e  elect(parse_json
-0001fad0: 2864 665b 2261 225d 292e 616c 6961 7328  (df["a"]).alias(
-0001fae0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0001faf0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0001fb00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001fb10: 2020 207c 2252 4553 554c 5422 2020 2020     |"RESULT"    
-0001fb20: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001fb30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001fb40: 2020 2020 207c 7b20 2020 2020 2020 2020       |{         
-0001fb50: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-0001fb60: 2022 6b65 7922 3a20 2231 2220 207c 0a20   "key": "1"  |. 
-0001fb70: 2020 2020 2020 207c 7d20 2020 2020 2020         |}       
-0001fb80: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0001fb90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001fba0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0001fbb0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0001fbc0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-0001fbd0: 7374 7228 652c 2022 7061 7273 655f 6a73  str(e, "parse_js
-0001fbe0: 6f6e 2229 0a20 2020 2072 6574 7572 6e20  on").    return 
-0001fbf0: 6275 696c 7469 6e28 2270 6172 7365 5f6a  builtin("parse_j
-0001fc00: 736f 6e22 2928 6329 0a0a 0a64 6566 2070  son")(c)...def p
-0001fc10: 6172 7365 5f78 6d6c 2865 3a20 436f 6c75  arse_xml(e: Colu
-0001fc20: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001fc30: 756d 6e3a 0a20 2020 2022 2222 5061 7273  umn:.    """Pars
-0001fc40: 6520 7468 6520 7661 6c75 6520 6f66 2074  e the value of t
-0001fc50: 6865 2073 7065 6369 6669 6564 2063 6f6c  he specified col
-0001fc60: 756d 6e20 6173 2061 204a 534f 4e20 7374  umn as a JSON st
-0001fc70: 7269 6e67 2061 6e64 2072 6574 7572 6e73  ring and returns
-0001fc80: 2074 6865 0a20 2020 2072 6573 756c 7469   the.    resulti
-0001fc90: 6e67 2058 4d4c 2064 6f63 756d 656e 742e  ng XML document.
-0001fca0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0001fcb0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0001fcc0: 3d20 7365 7373 696f 6e2e 7371 6c28 0a20  = session.sql(. 
-0001fcd0: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
-0001fce0: 7365 6c65 6374 2028 636f 6c75 6d6e 3129  select (column1)
-0001fcf0: 2061 7320 7620 6672 6f6d 2076 616c 7565   as v from value
-0001fd00: 7320 2827 3c74 313e 666f 6f3c 7432 3e62  s ('<t1>foo<t2>b
-0001fd10: 6172 3c2f 7432 3e3c 7433 3e3c 2f74 333e  ar</t2><t3></t3>
-0001fd20: 3c2f 7431 3e27 292c 2022 0a20 2020 2020  </t1>'), ".     
-0001fd30: 2020 202e 2e2e 2020 2020 2022 2827 3c74     ...     "('<t
-0001fd40: 313e 3c2f 7431 3e27 2922 0a20 2020 2020  1></t1>')".     
-0001fd50: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-0001fd60: 203e 3e3e 2064 662e 7365 6c65 6374 2870   >>> df.select(p
-0001fd70: 6172 7365 5f78 6d6c 2822 7622 292e 616c  arse_xml("v").al
-0001fd80: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-0001fd90: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0001fda0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001fdb0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-0001fdc0: 5422 2020 2020 2020 2020 7c0a 2020 2020  T"        |.    
-0001fdd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0001fde0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0001fdf0: 3c74 313e 2020 2020 2020 2020 2020 2020  <t1>            
-0001fe00: 7c0a 2020 2020 2020 2020 7c20 2066 6f6f  |.        |  foo
-0001fe10: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-0001fe20: 2020 2020 207c 2020 3c74 323e 6261 723c       |  <t2>bar<
-0001fe30: 2f74 323e 2020 7c0a 2020 2020 2020 2020  /t2>  |.        
-0001fe40: 7c20 203c 7433 3e3c 2f74 333e 2020 2020  |  <t3></t3>    
-0001fe50: 207c 0a20 2020 2020 2020 207c 3c2f 7431   |.        |</t1
-0001fe60: 3e20 2020 2020 2020 2020 2020 7c0a 2020  >           |.  
-0001fe70: 2020 2020 2020 7c3c 7431 3e3c 2f74 313e        |<t1></t1>
-0001fe80: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0001fe90: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0001fea0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-0001feb0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-0001fec0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0001fed0: 6966 5f73 7472 2865 2c20 2270 6172 7365  if_str(e, "parse
-0001fee0: 5f78 6d6c 2229 0a20 2020 2072 6574 7572  _xml").    retur
-0001fef0: 6e20 6275 696c 7469 6e28 2270 6172 7365  n builtin("parse
-0001ff00: 5f78 6d6c 2229 2863 290a 0a0a 6465 6620  _xml")(c)...def 
-0001ff10: 7374 7269 705f 6e75 6c6c 5f76 616c 7565  strip_null_value
-0001ff20: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-0001ff30: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0001ff40: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
-0001ff50: 204a 534f 4e20 226e 756c 6c22 2076 616c   JSON "null" val
-0001ff60: 7565 2069 6e20 7468 6520 7370 6563 6966  ue in the specif
-0001ff70: 6965 6420 636f 6c75 6d6e 2074 6f20 6120  ied column to a 
-0001ff80: 5351 4c20 4e55 4c4c 2076 616c 7565 2e0a  SQL NULL value..
-0001ff90: 2020 2020 416c 6c20 6f74 6865 7220 5641      All other VA
-0001ffa0: 5249 414e 5420 7661 6c75 6573 2069 6e20  RIANT values in 
-0001ffb0: 7468 6520 636f 6c75 6d6e 2061 7265 2072  the column are r
-0001ffc0: 6574 7572 6e65 6420 756e 6368 616e 6765  eturned unchange
-0001ffd0: 642e 2222 220a 2020 2020 6320 3d20 5f74  d.""".    c = _t
-0001ffe0: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-0001fff0: 2c20 2273 7472 6970 5f6e 756c 6c5f 7661  , "strip_null_va
-00020000: 6c75 6522 290a 2020 2020 7265 7475 726e  lue").    return
-00020010: 2062 7569 6c74 696e 2822 7374 7269 705f   builtin("strip_
-00020020: 6e75 6c6c 5f76 616c 7565 2229 2863 290a  null_value")(c).
-00020030: 0a0a 6465 6620 6172 7261 795f 6167 6728  ..def array_agg(
-00020040: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
-00020050: 652c 2069 735f 6469 7374 696e 6374 3a20  e, is_distinct: 
-00020060: 626f 6f6c 203d 2046 616c 7365 2920 2d3e  bool = False) ->
-00020070: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00020080: 5265 7475 726e 7320 7468 6520 696e 7075  Returns the inpu
-00020090: 7420 7661 6c75 6573 2c20 7069 766f 7465  t values, pivote
-000200a0: 6420 696e 746f 2061 6e20 4152 5241 592e  d into an ARRAY.
-000200b0: 2049 6620 7468 6520 696e 7075 7420 6973   If the input is
-000200c0: 2065 6d70 7479 2c20 616e 2065 6d70 7479   empty, an empty
-000200d0: 0a20 2020 2041 5252 4159 2069 7320 7265  .    ARRAY is re
-000200e0: 7475 726e 6564 2e22 2222 0a20 2020 2063  turned.""".    c
-000200f0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00020100: 7228 636f 6c2c 2022 6172 7261 795f 6167  r(col, "array_ag
-00020110: 6722 290a 2020 2020 7265 7475 726e 205f  g").    return _
-00020120: 6361 6c6c 5f66 756e 6374 696f 6e28 2261  call_function("a
-00020130: 7272 6179 5f61 6767 222c 2069 735f 6469  rray_agg", is_di
-00020140: 7374 696e 6374 2c20 6329 0a0a 0a64 6566  stinct, c)...def
-00020150: 2061 7272 6179 5f61 7070 656e 6428 6172   array_append(ar
-00020160: 7261 793a 2043 6f6c 756d 6e4f 724e 616d  ray: ColumnOrNam
-00020170: 652c 2065 6c65 6d65 6e74 3a20 436f 6c75  e, element: Colu
-00020180: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00020190: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000201a0: 726e 7320 616e 2041 5252 4159 2063 6f6e  rns an ARRAY con
-000201b0: 7461 696e 696e 6720 616c 6c20 656c 656d  taining all elem
-000201c0: 656e 7473 2066 726f 6d20 7468 6520 736f  ents from the so
-000201d0: 7572 6365 2041 5252 4159 2061 7320 7765  urce ARRAY as we
-000201e0: 6c6c 2061 7320 7468 6520 6e65 7720 656c  ll as the new el
-000201f0: 656d 656e 742e 0a20 2020 2054 6865 206e  ement..    The n
-00020200: 6577 2065 6c65 6d65 6e74 2069 7320 6c6f  ew element is lo
-00020210: 6361 7465 6420 6174 2065 6e64 206f 6620  cated at end of 
-00020220: 7468 6520 4152 5241 592e 0a0a 2020 2020  the ARRAY...    
-00020230: 4172 6773 3a0a 2020 2020 2020 2020 6172  Args:.        ar
-00020240: 7261 793a 2054 6865 2063 6f6c 756d 6e20  ray: The column 
-00020250: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
-00020260: 6f75 7263 6520 4152 5241 592e 0a20 2020  ource ARRAY..   
-00020270: 2020 2020 2065 6c65 6d65 6e74 3a20 5468       element: Th
-00020280: 6520 636f 6c75 6d6e 2063 6f6e 7461 696e  e column contain
-00020290: 696e 6720 7468 6520 656c 656d 656e 7420  ing the element 
-000202a0: 746f 2062 6520 6170 7065 6e64 6564 2e20  to be appended. 
-000202b0: 5468 6520 656c 656d 656e 7420 6d61 7920  The element may 
-000202c0: 6265 206f 6620 616c 6d6f 7374 0a20 2020  be of almost.   
-000202d0: 2020 2020 2020 2020 2061 6e79 2064 6174           any dat
-000202e0: 6120 7479 7065 2e20 5468 6520 6461 7461  a type. The data
-000202f0: 2074 7970 6520 646f 6573 206e 6f74 206e   type does not n
-00020300: 6565 6420 746f 206d 6174 6368 2074 6865  eed to match the
-00020310: 2064 6174 6120 7479 7065 2873 2920 6f66   data type(s) of
-00020320: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00020330: 2065 7869 7374 696e 6720 656c 656d 656e   existing elemen
-00020340: 7473 2069 6e20 7468 6520 4152 5241 592e  ts in the ARRAY.
-00020350: 2222 220a 2020 2020 6120 3d20 5f74 6f5f  """.    a = _to_
-00020360: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
-00020370: 2c20 2261 7272 6179 5f61 7070 656e 6422  , "array_append"
-00020380: 290a 2020 2020 6520 3d20 5f74 6f5f 636f  ).    e = _to_co
-00020390: 6c5f 6966 5f73 7472 2865 6c65 6d65 6e74  l_if_str(element
-000203a0: 2c20 2261 7272 6179 5f61 7070 656e 6422  , "array_append"
-000203b0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-000203c0: 6c74 696e 2822 6172 7261 795f 6170 7065  ltin("array_appe
-000203d0: 6e64 2229 2861 2c20 6529 0a0a 0a64 6566  nd")(a, e)...def
-000203e0: 2061 7272 6179 5f63 6174 2861 7272 6179   array_cat(array
-000203f0: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
-00020400: 2061 7272 6179 323a 2043 6f6c 756d 6e4f   array2: ColumnO
-00020410: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00020420: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-00020430: 2074 6865 2063 6f6e 6361 7465 6e61 7469   the concatenati
-00020440: 6f6e 206f 6620 7477 6f20 4152 5241 5973  on of two ARRAYs
-00020450: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00020460: 2020 2020 2061 7272 6179 313a 2043 6f6c       array1: Col
-00020470: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
-00020480: 6865 2073 6f75 7263 6520 4152 5241 592e  he source ARRAY.
-00020490: 0a20 2020 2020 2020 2061 7272 6179 323a  .        array2:
-000204a0: 2043 6f6c 756d 6e20 636f 6e74 6169 6e69   Column containi
-000204b0: 6e67 2074 6865 2041 5252 4159 2074 6f20  ng the ARRAY to 
-000204c0: 6265 2061 7070 656e 6465 6420 746f 2061  be appended to a
-000204d0: 7272 6179 312e 2222 220a 2020 2020 6131  rray1.""".    a1
-000204e0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000204f0: 7228 6172 7261 7931 2c20 2261 7272 6179  r(array1, "array
-00020500: 5f63 6174 2229 0a20 2020 2061 3220 3d20  _cat").    a2 = 
-00020510: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
-00020520: 7272 6179 322c 2022 6172 7261 795f 6361  rray2, "array_ca
-00020530: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
-00020540: 7569 6c74 696e 2822 6172 7261 795f 6361  uiltin("array_ca
-00020550: 7422 2928 6131 2c20 6132 290a 0a0a 6465  t")(a1, a2)...de
-00020560: 6620 6172 7261 795f 636f 6d70 6163 7428  f array_compact(
-00020570: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
-00020580: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00020590: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-000205a0: 2063 6f6d 7061 6374 6564 2041 5252 4159   compacted ARRAY
-000205b0: 2077 6974 6820 6d69 7373 696e 6720 616e   with missing an
-000205c0: 6420 6e75 6c6c 2076 616c 7565 7320 7265  d null values re
-000205d0: 6d6f 7665 642c 0a20 2020 2065 6666 6563  moved,.    effec
-000205e0: 7469 7665 6c79 2063 6f6e 7665 7274 696e  tively convertin
-000205f0: 6720 7370 6172 7365 2061 7272 6179 7320  g sparse arrays 
-00020600: 696e 746f 2064 656e 7365 2061 7272 6179  into dense array
-00020610: 732e 0a0a 2020 2020 4172 6773 3a0a 2020  s...    Args:.  
-00020620: 2020 2020 2020 6172 7261 793a 2043 6f6c        array: Col
-00020630: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
-00020640: 6865 2073 6f75 7263 6520 4152 5241 5920  he source ARRAY 
-00020650: 746f 2062 6520 636f 6d70 6163 7465 640a  to be compacted.
-00020660: 2020 2020 2222 220a 2020 2020 6120 3d20      """.    a = 
-00020670: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
-00020680: 7272 6179 2c20 2261 7272 6179 5f63 6f6d  rray, "array_com
-00020690: 7061 6374 2229 0a20 2020 2072 6574 7572  pact").    retur
-000206a0: 6e20 6275 696c 7469 6e28 2261 7272 6179  n builtin("array
-000206b0: 5f63 6f6d 7061 6374 2229 2861 290a 0a0a  _compact")(a)...
-000206c0: 6465 6620 6172 7261 795f 636f 6e73 7472  def array_constr
-000206d0: 7563 7428 2a63 6f6c 733a 2043 6f6c 756d  uct(*cols: Colum
-000206e0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-000206f0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00020700: 6e73 2061 6e20 4152 5241 5920 636f 6e73  ns an ARRAY cons
-00020710: 7472 7563 7465 6420 6672 6f6d 207a 6572  tructed from zer
-00020720: 6f2c 206f 6e65 2c20 6f72 206d 6f72 6520  o, one, or more 
-00020730: 696e 7075 7473 2e0a 0a20 2020 2041 7267  inputs...    Arg
-00020740: 733a 0a20 2020 2020 2020 2063 6f6c 733a  s:.        cols:
-00020750: 2043 6f6c 756d 6e73 2063 6f6e 7461 696e   Columns contain
-00020760: 696e 6720 7468 6520 7661 6c75 6573 2028  ing the values (
-00020770: 6f72 2065 7870 7265 7373 696f 6e73 2074  or expressions t
-00020780: 6861 7420 6576 616c 7561 7465 2074 6f20  hat evaluate to 
-00020790: 7661 6c75 6573 292e 2054 6865 0a20 2020  values). The.   
-000207a0: 2020 2020 2020 2020 2076 616c 7565 7320           values 
-000207b0: 646f 206e 6f74 2061 6c6c 206e 6565 6420  do not all need 
-000207c0: 746f 2062 6520 6f66 2074 6865 2073 616d  to be of the sam
-000207d0: 6520 6461 7461 2074 7970 652e 2222 220a  e data type.""".
-000207e0: 2020 2020 6373 203d 205b 5f74 6f5f 636f      cs = [_to_co
-000207f0: 6c5f 6966 5f73 7472 2863 2c20 2261 7272  l_if_str(c, "arr
-00020800: 6179 5f63 6f6e 7374 7275 6374 2229 2066  ay_construct") f
-00020810: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
-00020820: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00020830: 2822 6172 7261 795f 636f 6e73 7472 7563  ("array_construc
-00020840: 7422 2928 2a63 7329 0a0a 0a64 6566 2061  t")(*cs)...def a
-00020850: 7272 6179 5f63 6f6e 7374 7275 6374 5f63  rray_construct_c
-00020860: 6f6d 7061 6374 282a 636f 6c73 3a20 436f  ompact(*cols: Co
-00020870: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00020880: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00020890: 7475 726e 7320 616e 2041 5252 4159 2063  turns an ARRAY c
-000208a0: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
-000208b0: 7a65 726f 2c20 6f6e 652c 206f 7220 6d6f  zero, one, or mo
-000208c0: 7265 2069 6e70 7574 732e 0a20 2020 2054  re inputs..    T
-000208d0: 6865 2063 6f6e 7374 7275 6374 6564 2041  he constructed A
-000208e0: 5252 4159 206f 6d69 7473 2061 6e79 204e  RRAY omits any N
-000208f0: 554c 4c20 696e 7075 7420 7661 6c75 6573  ULL input values
-00020900: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00020910: 2020 2020 2063 6f6c 733a 2043 6f6c 756d       cols: Colum
-00020920: 6e73 2063 6f6e 7461 696e 696e 6720 7468  ns containing th
-00020930: 6520 7661 6c75 6573 2028 6f72 2065 7870  e values (or exp
-00020940: 7265 7373 696f 6e73 2074 6861 7420 6576  ressions that ev
-00020950: 616c 7561 7465 2074 6f20 7661 6c75 6573  aluate to values
-00020960: 292e 2054 6865 0a20 2020 2020 2020 2020  ). The.         
-00020970: 2020 2076 616c 7565 7320 646f 206e 6f74     values do not
-00020980: 2061 6c6c 206e 6565 6420 746f 2062 6520   all need to be 
-00020990: 6f66 2074 6865 2073 616d 6520 6461 7461  of the same data
-000209a0: 2074 7970 652e 0a20 2020 2022 2222 0a20   type..    """. 
-000209b0: 2020 2063 7320 3d20 5b5f 746f 5f63 6f6c     cs = [_to_col
-000209c0: 5f69 665f 7374 7228 632c 2022 6172 7261  _if_str(c, "arra
-000209d0: 795f 636f 6e73 7472 7563 745f 636f 6d70  y_construct_comp
-000209e0: 6163 7422 2920 666f 7220 6320 696e 2063  act") for c in c
-000209f0: 6f6c 735d 0a20 2020 2072 6574 7572 6e20  ols].    return 
-00020a00: 6275 696c 7469 6e28 2261 7272 6179 5f63  builtin("array_c
-00020a10: 6f6e 7374 7275 6374 5f63 6f6d 7061 6374  onstruct_compact
-00020a20: 2229 282a 6373 290a 0a0a 6465 6620 6172  ")(*cs)...def ar
-00020a30: 7261 795f 636f 6e74 6169 6e73 2876 6172  ray_contains(var
-00020a40: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
-00020a50: 6d65 2c20 6172 7261 793a 2043 6f6c 756d  me, array: Colum
-00020a60: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00020a70: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00020a80: 6e73 2054 7275 6520 6966 2074 6865 2073  ns True if the s
-00020a90: 7065 6369 6669 6564 2056 4152 4941 4e54  pecified VARIANT
-00020aa0: 2069 7320 666f 756e 6420 696e 2074 6865   is found in the
-00020ab0: 2073 7065 6369 6669 6564 2041 5252 4159   specified ARRAY
-00020ac0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00020ad0: 2020 2020 2076 6172 6961 6e74 3a20 436f       variant: Co
-00020ae0: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
-00020af0: 7468 6520 5641 5249 414e 5420 746f 2066  the VARIANT to f
-00020b00: 696e 642e 0a20 2020 2020 2020 2061 7272  ind..        arr
-00020b10: 6179 3a20 436f 6c75 6d6e 2063 6f6e 7461  ay: Column conta
-00020b20: 696e 696e 6720 7468 6520 4152 5241 5920  ining the ARRAY 
-00020b30: 746f 2073 6561 7263 682e 2222 220a 2020  to search.""".  
-00020b40: 2020 7620 3d20 5f74 6f5f 636f 6c5f 6966    v = _to_col_if
-00020b50: 5f73 7472 2876 6172 6961 6e74 2c20 2261  _str(variant, "a
-00020b60: 7272 6179 5f63 6f6e 7461 696e 7322 290a  rray_contains").
-00020b70: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
-00020b80: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
-00020b90: 7272 6179 5f63 6f6e 7461 696e 7322 290a  rray_contains").
-00020ba0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00020bb0: 696e 2822 6172 7261 795f 636f 6e74 6169  in("array_contai
-00020bc0: 6e73 2229 2876 2c20 6129 0a0a 0a64 6566  ns")(v, a)...def
-00020bd0: 2061 7272 6179 5f69 6e73 6572 7428 0a20   array_insert(. 
-00020be0: 2020 2061 7272 6179 3a20 436f 6c75 6d6e     array: Column
-00020bf0: 4f72 4e61 6d65 2c20 706f 733a 2043 6f6c  OrName, pos: Col
-00020c00: 756d 6e4f 724e 616d 652c 2065 6c65 6d65  umnOrName, eleme
-00020c10: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
-00020c20: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
-00020c30: 2020 2222 2252 6574 7572 6e73 2061 6e20    """Returns an 
-00020c40: 4152 5241 5920 636f 6e74 6169 6e69 6e67  ARRAY containing
-00020c50: 2061 6c6c 2065 6c65 6d65 6e74 7320 6672   all elements fr
-00020c60: 6f6d 2074 6865 2073 6f75 7263 6520 4152  om the source AR
-00020c70: 5241 5920 6173 2077 656c 6c20 6173 2074  RAY as well as t
-00020c80: 6865 206e 6577 2065 6c65 6d65 6e74 2e0a  he new element..
-00020c90: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00020ca0: 2020 2061 7272 6179 3a20 436f 6c75 6d6e     array: Column
-00020cb0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00020cc0: 736f 7572 6365 2041 5252 4159 2e0a 2020  source ARRAY..  
-00020cd0: 2020 2020 2020 706f 733a 2043 6f6c 756d        pos: Colum
-00020ce0: 6e20 636f 6e74 6169 6e69 6e67 2061 2028  n containing a (
-00020cf0: 7a65 726f 2d62 6173 6564 2920 706f 7369  zero-based) posi
-00020d00: 7469 6f6e 2069 6e20 7468 6520 736f 7572  tion in the sour
-00020d10: 6365 2041 5252 4159 2e0a 2020 2020 2020  ce ARRAY..      
-00020d20: 2020 2020 2020 5468 6520 6e65 7720 656c        The new el
-00020d30: 656d 656e 7420 6973 2069 6e73 6572 7465  ement is inserte
-00020d40: 6420 6174 2074 6869 7320 706f 7369 7469  d at this positi
-00020d50: 6f6e 2e20 5468 6520 6f72 6967 696e 616c  on. The original
-00020d60: 2065 6c65 6d65 6e74 2066 726f 6d20 7468   element from th
-00020d70: 6973 0a20 2020 2020 2020 2020 2020 2070  is.            p
-00020d80: 6f73 6974 696f 6e20 2869 6620 616e 7929  osition (if any)
-00020d90: 2061 6e64 2061 6c6c 2073 7562 7365 7175   and all subsequ
-00020da0: 656e 7420 656c 656d 656e 7473 2028 6966  ent elements (if
-00020db0: 2061 6e79 2920 6172 6520 7368 6966 7465   any) are shifte
-00020dc0: 6420 6279 206f 6e65 2070 6f73 6974 696f  d by one positio
-00020dd0: 6e0a 2020 2020 2020 2020 2020 2020 746f  n.            to
-00020de0: 2074 6865 2072 6967 6874 2069 6e20 7468   the right in th
-00020df0: 6520 7265 7375 6c74 696e 6720 6172 7261  e resulting arra
-00020e00: 7920 2869 2e65 2e20 696e 7365 7274 696e  y (i.e. insertin
-00020e10: 6720 6174 2070 6f73 6974 696f 6e20 3020  g at position 0 
-00020e20: 6861 7320 7468 6520 7361 6d65 0a20 2020  has the same.   
-00020e30: 2020 2020 2020 2020 2065 6666 6563 7420           effect 
-00020e40: 6173 2075 7369 6e67 2061 7272 6179 5f70  as using array_p
-00020e50: 7265 7065 6e64 292e 0a20 2020 2020 2020  repend)..       
-00020e60: 2020 2020 2041 206e 6567 6174 6976 6520       A negative 
-00020e70: 706f 7369 7469 6f6e 2069 7320 696e 7465  position is inte
-00020e80: 7270 7265 7465 6420 6173 2061 6e20 696e  rpreted as an in
-00020e90: 6465 7820 6672 6f6d 2074 6865 2062 6163  dex from the bac
-00020ea0: 6b20 6f66 2074 6865 2061 7272 6179 2028  k of the array (
-00020eb0: 652e 672e 0a20 2020 2020 2020 2020 2020  e.g..           
-00020ec0: 202d 3120 7265 7375 6c74 7320 696e 2069   -1 results in i
-00020ed0: 6e73 6572 7469 6f6e 2062 6566 6f72 6520  nsertion before 
-00020ee0: 7468 6520 6c61 7374 2065 6c65 6d65 6e74  the last element
-00020ef0: 2069 6e20 7468 6520 6172 7261 7929 2e0a   in the array)..
-00020f00: 2020 2020 2020 2020 656c 656d 656e 743a          element:
-00020f10: 2043 6f6c 756d 6e20 636f 6e74 6169 6e69   Column containi
-00020f20: 6e67 2074 6865 2065 6c65 6d65 6e74 2074  ng the element t
-00020f30: 6f20 6265 2069 6e73 6572 7465 642e 2054  o be inserted. T
-00020f40: 6865 206e 6577 2065 6c65 6d65 6e74 2069  he new element i
-00020f50: 7320 6c6f 6361 7465 6420 6174 0a20 2020  s located at.   
-00020f60: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
-00020f70: 6e20 706f 732e 2054 6865 2072 656c 6174  n pos. The relat
-00020f80: 6976 6520 6f72 6465 7220 6f66 2074 6865  ive order of the
-00020f90: 206f 7468 6572 2065 6c65 6d65 6e74 7320   other elements 
-00020fa0: 6672 6f6d 2074 6865 2073 6f75 7263 650a  from the source.
-00020fb0: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00020fc0: 7920 6973 2070 7265 7365 7276 6564 2e22  y is preserved."
-00020fd0: 2222 0a20 2020 2061 203d 205f 746f 5f63  "".    a = _to_c
-00020fe0: 6f6c 5f69 665f 7374 7228 6172 7261 792c  ol_if_str(array,
-00020ff0: 2022 6172 7261 795f 696e 7365 7274 2229   "array_insert")
-00021000: 0a20 2020 2070 203d 205f 746f 5f63 6f6c  .    p = _to_col
-00021010: 5f69 665f 7374 7228 706f 732c 2022 6172  _if_str(pos, "ar
-00021020: 7261 795f 696e 7365 7274 2229 0a20 2020  ray_insert").   
-00021030: 2065 203d 205f 746f 5f63 6f6c 5f69 665f   e = _to_col_if_
-00021040: 7374 7228 656c 656d 656e 742c 2022 6172  str(element, "ar
-00021050: 7261 795f 696e 7365 7274 2229 0a20 2020  ray_insert").   
-00021060: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00021070: 2261 7272 6179 5f69 6e73 6572 7422 2928  "array_insert")(
-00021080: 612c 2070 2c20 6529 0a0a 0a64 6566 2061  a, p, e)...def a
-00021090: 7272 6179 5f70 6f73 6974 696f 6e28 7661  rray_position(va
-000210a0: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
-000210b0: 616d 652c 2061 7272 6179 3a20 436f 6c75  ame, array: Colu
-000210c0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000210d0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000210e0: 726e 7320 7468 6520 696e 6465 7820 6f66  rns the index of
-000210f0: 2074 6865 2066 6972 7374 206f 6363 7572   the first occur
-00021100: 7265 6e63 6520 6f66 2061 6e20 656c 656d  rence of an elem
-00021110: 656e 7420 696e 2061 6e20 4152 5241 592e  ent in an ARRAY.
-00021120: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-00021130: 2020 2020 7661 7269 616e 743a 2043 6f6c      variant: Col
-00021140: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
-00021150: 6865 2056 4152 4941 4e54 2076 616c 7565  he VARIANT value
-00021160: 2074 6861 7420 796f 7520 7761 6e74 2074   that you want t
-00021170: 6f20 6669 6e64 2e20 5468 6520 6675 6e63  o find. The func
-00021180: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00021190: 2073 6561 7263 6865 7320 666f 7220 7468   searches for th
-000211a0: 6520 6669 7273 7420 6f63 6375 7272 656e  e first occurren
-000211b0: 6365 206f 6620 7468 6973 2076 616c 7565  ce of this value
-000211c0: 2069 6e20 7468 6520 6172 7261 792e 0a20   in the array.. 
-000211d0: 2020 2020 2020 2061 7272 6179 3a20 436f         array: Co
-000211e0: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
-000211f0: 7468 6520 4152 5241 5920 746f 2062 6520  the ARRAY to be 
-00021200: 7365 6172 6368 6564 2e22 2222 0a20 2020  searched.""".   
-00021210: 2076 203d 205f 746f 5f63 6f6c 5f69 665f   v = _to_col_if_
-00021220: 7374 7228 7661 7269 616e 742c 2022 6172  str(variant, "ar
-00021230: 7261 795f 706f 7369 7469 6f6e 2229 0a20  ray_position"). 
-00021240: 2020 2061 203d 205f 746f 5f63 6f6c 5f69     a = _to_col_i
-00021250: 665f 7374 7228 6172 7261 792c 2022 6172  f_str(array, "ar
-00021260: 7261 795f 706f 7369 7469 6f6e 2229 0a20  ray_position"). 
-00021270: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00021280: 6e28 2261 7272 6179 5f70 6f73 6974 696f  n("array_positio
-00021290: 6e22 2928 762c 2061 290a 0a0a 6465 6620  n")(v, a)...def 
-000212a0: 6172 7261 795f 7072 6570 656e 6428 6172  array_prepend(ar
-000212b0: 7261 793a 2043 6f6c 756d 6e4f 724e 616d  ray: ColumnOrNam
-000212c0: 652c 2065 6c65 6d65 6e74 3a20 436f 6c75  e, element: Colu
-000212d0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000212e0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000212f0: 726e 7320 616e 2041 5252 4159 2063 6f6e  rns an ARRAY con
-00021300: 7461 696e 696e 6720 7468 6520 6e65 7720  taining the new 
-00021310: 656c 656d 656e 7420 6173 2077 656c 6c20  element as well 
-00021320: 6173 2061 6c6c 2065 6c65 6d65 6e74 7320  as all elements 
-00021330: 6672 6f6d 2074 6865 2073 6f75 7263 6520  from the source 
-00021340: 4152 5241 592e 0a20 2020 2054 6865 206e  ARRAY..    The n
-00021350: 6577 2065 6c65 6d65 6e74 2069 7320 706f  ew element is po
-00021360: 7369 7469 6f6e 6564 2061 7420 7468 6520  sitioned at the 
-00021370: 6265 6769 6e6e 696e 6720 6f66 2074 6865  beginning of the
-00021380: 2041 5252 4159 2e0a 0a20 2020 2041 7267   ARRAY...    Arg
-00021390: 733a 0a20 2020 2020 2020 2061 7272 6179  s:.        array
-000213a0: 2043 6f6c 756d 6e20 636f 6e74 6169 6e69   Column containi
-000213b0: 6e67 2074 6865 2073 6f75 7263 6520 4152  ng the source AR
-000213c0: 5241 592e 0a20 2020 2020 2020 2065 6c65  RAY..        ele
-000213d0: 6d65 6e74 2043 6f6c 756d 6e20 636f 6e74  ment Column cont
-000213e0: 6169 6e69 6e67 2074 6865 2065 6c65 6d65  aining the eleme
-000213f0: 6e74 2074 6f20 6265 2070 7265 7065 6e64  nt to be prepend
-00021400: 6564 2e22 2222 0a20 2020 2061 203d 205f  ed.""".    a = _
-00021410: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
-00021420: 7261 792c 2022 6172 7261 795f 7072 6570  ray, "array_prep
-00021430: 656e 6422 290a 2020 2020 6520 3d20 5f74  end").    e = _t
-00021440: 6f5f 636f 6c5f 6966 5f73 7472 2865 6c65  o_col_if_str(ele
-00021450: 6d65 6e74 2c20 2261 7272 6179 5f70 7265  ment, "array_pre
-00021460: 7065 6e64 2229 0a20 2020 2072 6574 7572  pend").    retur
-00021470: 6e20 6275 696c 7469 6e28 2261 7272 6179  n builtin("array
-00021480: 5f70 7265 7065 6e64 2229 2861 2c20 6529  _prepend")(a, e)
-00021490: 0a0a 0a64 6566 2061 7272 6179 5f73 697a  ...def array_siz
-000214a0: 6528 6172 7261 793a 2043 6f6c 756d 6e4f  e(array: ColumnO
-000214b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-000214c0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-000214d0: 2074 6865 2073 697a 6520 6f66 2074 6865   the size of the
-000214e0: 2069 6e70 7574 2041 5252 4159 2e0a 0a20   input ARRAY... 
-000214f0: 2020 2049 6620 7468 6520 7370 6563 6966     If the specif
-00021500: 6965 6420 636f 6c75 6d6e 2063 6f6e 7461  ied column conta
-00021510: 696e 7320 6120 5641 5249 414e 5420 7661  ins a VARIANT va
-00021520: 6c75 6520 7468 6174 2063 6f6e 7461 696e  lue that contain
-00021530: 7320 616e 2041 5252 4159 2c20 7468 6520  s an ARRAY, the 
-00021540: 7369 7a65 206f 6620 7468 6520 4152 5241  size of the ARRA
-00021550: 590a 2020 2020 6973 2072 6574 7572 6e65  Y.    is returne
-00021560: 643b 206f 7468 6572 7769 7365 2c20 4e55  d; otherwise, NU
-00021570: 4c4c 2069 7320 7265 7475 726e 6564 2069  LL is returned i
-00021580: 6620 7468 6520 7661 6c75 6520 6973 206e  f the value is n
-00021590: 6f74 2061 6e20 4152 5241 592e 2222 220a  ot an ARRAY.""".
-000215a0: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
-000215b0: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
-000215c0: 7272 6179 5f73 697a 6522 290a 2020 2020  rray_size").    
-000215d0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000215e0: 6172 7261 795f 7369 7a65 2229 2861 290a  array_size")(a).
-000215f0: 0a0a 6465 6620 6172 7261 795f 736c 6963  ..def array_slic
-00021600: 6528 6172 7261 793a 2043 6f6c 756d 6e4f  e(array: ColumnO
-00021610: 724e 616d 652c 2066 726f 6d5f 3a20 436f  rName, from_: Co
-00021620: 6c75 6d6e 4f72 4e61 6d65 2c20 746f 3a20  lumnOrName, to: 
-00021630: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00021640: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00021650: 5265 7475 726e 7320 616e 2041 5252 4159  Returns an ARRAY
-00021660: 2063 6f6e 7374 7275 6374 6564 2066 726f   constructed fro
-00021670: 6d20 6120 7370 6563 6966 6965 6420 7375  m a specified su
-00021680: 6273 6574 206f 6620 656c 656d 656e 7473  bset of elements
-00021690: 206f 6620 7468 6520 696e 7075 7420 4152   of the input AR
-000216a0: 5241 592e 0a0a 2020 2020 4172 6773 3a0a  RAY...    Args:.
-000216b0: 2020 2020 2020 2020 6172 7261 793a 2043          array: C
-000216c0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
-000216d0: 2074 6865 2073 6f75 7263 6520 4152 5241   the source ARRA
-000216e0: 592e 0a20 2020 2020 2020 2066 726f 6d5f  Y..        from_
-000216f0: 3a20 436f 6c75 6d6e 2063 6f6e 7461 696e  : Column contain
-00021700: 696e 6720 6120 706f 7369 7469 6f6e 2069  ing a position i
-00021710: 6e20 7468 6520 736f 7572 6365 2041 5252  n the source ARR
-00021720: 4159 2e20 5468 6520 706f 7369 7469 6f6e  AY. The position
-00021730: 206f 6620 7468 6520 6669 7273 740a 2020   of the first.  
-00021740: 2020 2020 2020 2020 2020 656c 656d 656e            elemen
-00021750: 7420 6973 2030 2e20 456c 656d 656e 7473  t is 0. Elements
-00021760: 2066 726f 6d20 706f 7369 7469 6f6e 7320   from positions 
-00021770: 6c65 7373 2074 6861 6e20 7468 6973 2070  less than this p
-00021780: 6172 616d 6574 6572 2061 7265 0a20 2020  arameter are.   
-00021790: 2020 2020 2020 2020 206e 6f74 2069 6e63           not inc
-000217a0: 6c75 6465 6420 696e 2074 6865 2072 6573  luded in the res
-000217b0: 756c 7469 6e67 2041 5252 4159 2e0a 2020  ulting ARRAY..  
-000217c0: 2020 2020 2020 746f 3a20 436f 6c75 6d6e        to: Column
-000217d0: 2063 6f6e 7461 696e 696e 6720 6120 706f   containing a po
-000217e0: 7369 7469 6f6e 2069 6e20 7468 6520 736f  sition in the so
-000217f0: 7572 6365 2041 5252 4159 2e20 456c 656d  urce ARRAY. Elem
-00021800: 656e 7473 2066 726f 6d20 706f 7369 7469  ents from positi
-00021810: 6f6e 7320 6571 7561 6c20 746f 0a20 2020  ons equal to.   
-00021820: 2020 2020 2020 2020 206f 7220 6772 6561           or grea
-00021830: 7465 7220 7468 616e 2074 6869 7320 7061  ter than this pa
-00021840: 7261 6d65 7465 7220 6172 6520 6e6f 7420  rameter are not 
-00021850: 696e 636c 7564 6564 2069 6e20 7468 6520  included in the 
-00021860: 7265 7375 6c74 696e 6720 6172 7261 792e  resulting array.
-00021870: 2222 220a 2020 2020 6120 3d20 5f74 6f5f  """.    a = _to_
-00021880: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
-00021890: 2c20 2261 7272 6179 5f73 6c69 6365 2229  , "array_slice")
-000218a0: 0a20 2020 2066 203d 205f 746f 5f63 6f6c  .    f = _to_col
-000218b0: 5f69 665f 7374 7228 6672 6f6d 5f2c 2022  _if_str(from_, "
-000218c0: 6172 7261 795f 736c 6963 6522 290a 2020  array_slice").  
-000218d0: 2020 7420 3d20 5f74 6f5f 636f 6c5f 6966    t = _to_col_if
-000218e0: 5f73 7472 2874 6f2c 2022 6172 7261 795f  _str(to, "array_
-000218f0: 736c 6963 6522 290a 2020 2020 7265 7475  slice").    retu
-00021900: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
-00021910: 795f 736c 6963 6522 2928 612c 2066 2c20  y_slice")(a, f, 
-00021920: 7429 0a0a 0a64 6566 2061 7272 6179 5f74  t)...def array_t
-00021930: 6f5f 7374 7269 6e67 2861 7272 6179 3a20  o_string(array: 
-00021940: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7365  ColumnOrName, se
-00021950: 7061 7261 746f 723a 2043 6f6c 756d 6e4f  parator: ColumnO
-00021960: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00021970: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-00021980: 2061 6e20 696e 7075 7420 4152 5241 5920   an input ARRAY 
-00021990: 636f 6e76 6572 7465 6420 746f 2061 2073  converted to a s
-000219a0: 7472 696e 6720 6279 2063 6173 7469 6e67  tring by casting
-000219b0: 2061 6c6c 2076 616c 7565 7320 746f 2073   all values to s
-000219c0: 7472 696e 6773 2028 7573 696e 670a 2020  trings (using.  
-000219d0: 2020 544f 5f56 4152 4348 4152 2920 616e    TO_VARCHAR) an
-000219e0: 6420 636f 6e63 6174 656e 6174 696e 6720  d concatenating 
-000219f0: 7468 656d 2028 7573 696e 6720 7468 6520  them (using the 
-00021a00: 7374 7269 6e67 2066 726f 6d20 7468 6520  string from the 
-00021a10: 7365 636f 6e64 2061 7267 756d 656e 7420  second argument 
-00021a20: 746f 2073 6570 6172 6174 650a 2020 2020  to separate.    
-00021a30: 7468 6520 656c 656d 656e 7473 292e 0a0a  the elements)...
-00021a40: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00021a50: 2020 6172 7261 793a 2043 6f6c 756d 6e20    array: Column 
-00021a60: 636f 6e74 6169 6e69 6e67 2074 6865 2041  containing the A
-00021a70: 5252 4159 206f 6620 656c 656d 656e 7473  RRAY of elements
-00021a80: 2074 6f20 636f 6e76 6572 7420 746f 2061   to convert to a
-00021a90: 2073 7472 696e 672e 0a20 2020 2020 2020   string..       
-00021aa0: 2073 6570 6172 6174 6f72 3a20 436f 6c75   separator: Colu
-00021ab0: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
-00021ac0: 6520 7374 7269 6e67 2074 6f20 7075 7420  e string to put 
-00021ad0: 6265 7477 6565 6e20 6561 6368 2065 6c65  between each ele
-00021ae0: 6d65 6e74 2028 652e 672e 2061 2073 7061  ment (e.g. a spa
-00021af0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-00021b00: 636f 6d6d 612c 206f 7220 6f74 6865 7220  comma, or other 
-00021b10: 6875 6d61 6e2d 7265 6164 6162 6c65 2073  human-readable s
-00021b20: 6570 6172 6174 6f72 292e 2222 220a 2020  eparator).""".  
-00021b30: 2020 6120 3d20 5f74 6f5f 636f 6c5f 6966    a = _to_col_if
-00021b40: 5f73 7472 2861 7272 6179 2c20 2261 7272  _str(array, "arr
-00021b50: 6179 5f74 6f5f 7374 7269 6e67 2229 0a20  ay_to_string"). 
-00021b60: 2020 2073 203d 205f 746f 5f63 6f6c 5f69     s = _to_col_i
-00021b70: 665f 7374 7228 7365 7061 7261 746f 722c  f_str(separator,
-00021b80: 2022 6172 7261 795f 746f 5f73 7472 696e   "array_to_strin
-00021b90: 6722 290a 2020 2020 7265 7475 726e 2062  g").    return b
-00021ba0: 7569 6c74 696e 2822 6172 7261 795f 746f  uiltin("array_to
-00021bb0: 5f73 7472 696e 6722 2928 612c 2073 290a  _string")(a, s).
-00021bc0: 0a0a 6465 6620 6f62 6a65 6374 5f61 6767  ..def object_agg
-00021bd0: 286b 6579 3a20 436f 6c75 6d6e 4f72 4e61  (key: ColumnOrNa
-00021be0: 6d65 2c20 7661 6c75 653a 2043 6f6c 756d  me, value: Colum
-00021bf0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00021c00: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00021c10: 6e73 206f 6e65 204f 424a 4543 5420 7065  ns one OBJECT pe
-00021c20: 7220 6772 6f75 702e 2046 6f72 2065 6163  r group. For eac
-00021c30: 6820 6b65 792d 7661 6c75 6520 696e 7075  h key-value inpu
-00021c40: 7420 7061 6972 2c20 7768 6572 6520 6b65  t pair, where ke
-00021c50: 7920 6d75 7374 2062 6520 6120 5641 5243  y must be a VARC
-00021c60: 4841 520a 2020 2020 616e 6420 7661 6c75  HAR.    and valu
-00021c70: 6520 6d75 7374 2062 6520 6120 5641 5249  e must be a VARI
-00021c80: 414e 542c 2074 6865 2072 6573 756c 7469  ANT, the resulti
-00021c90: 6e67 204f 424a 4543 5420 636f 6e74 6169  ng OBJECT contai
-00021ca0: 6e73 2061 206b 6579 2d76 616c 7565 2066  ns a key-value f
-00021cb0: 6965 6c64 2e0a 0a20 2020 2045 7861 6d70  ield...    Examp
-00021cc0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00021cd0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-00021ce0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-00021cf0: 696d 706f 7274 2053 7472 7563 7454 7970  import StructTyp
-00021d00: 652c 2053 7472 7563 7446 6965 6c64 2c20  e, StructField, 
-00021d10: 5661 7269 616e 7454 7970 652c 2053 7472  VariantType, Str
-00021d20: 696e 6754 7970 650a 2020 2020 2020 2020  ingType.        
-00021d30: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00021d40: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00021d50: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-00021d60: 2020 205b 5b22 6e61 6d65 222c 2022 4a6f     [["name", "Jo
-00021d70: 6522 5d2c 205b 227a 6970 222c 2022 3938  e"], ["zip", "98
-00021d80: 3030 3422 5d5d 2c0a 2020 2020 2020 2020  004"]],.        
-00021d90: 2e2e 2e20 2020 2020 7363 6865 6d61 3d53  ...     schema=S
-00021da0: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
-00021db0: 7446 6965 6c64 2822 6b22 2c20 5374 7269  tField("k", Stri
-00021dc0: 6e67 5479 7065 2829 292c 2053 7472 7563  ngType()), Struc
-00021dd0: 7446 6965 6c64 2822 7622 2c20 5661 7269  tField("v", Vari
-00021de0: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
-00021df0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-00021e00: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00021e10: 286f 626a 6563 745f 6167 6728 636f 6c28  (object_agg(col(
-00021e20: 226b 2229 2c20 636f 6c28 2276 2229 292e  "k"), col("v")).
-00021e30: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00021e40: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00021e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00021e60: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-00021e70: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
-00021e80: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00021e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00021ea0: 2020 2020 2020 207c 7b20 2020 2020 2020         |{       
-00021eb0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00021ec0: 2020 2020 7c20 2022 6e61 6d65 223a 2022      |  "name": "
-00021ed0: 4a6f 6522 2c20 207c 0a20 2020 2020 2020  Joe",  |.       
-00021ee0: 207c 2020 227a 6970 223a 2022 3938 3030   |  "zip": "9800
-00021ef0: 3422 2020 7c0a 2020 2020 2020 2020 7c7d  4"  |.        |}
-00021f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f10: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00021f20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-00021f30: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00021f40: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-00021f50: 6b20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  k = _to_col_if_s
-00021f60: 7472 286b 6579 2c20 226f 626a 6563 745f  tr(key, "object_
-00021f70: 6167 6722 290a 2020 2020 7620 3d20 5f74  agg").    v = _t
-00021f80: 6f5f 636f 6c5f 6966 5f73 7472 2876 616c  o_col_if_str(val
-00021f90: 7565 2c20 226f 626a 6563 745f 6167 6722  ue, "object_agg"
-00021fa0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00021fb0: 6c74 696e 2822 6f62 6a65 6374 5f61 6767  ltin("object_agg
-00021fc0: 2229 286b 2c20 7629 0a0a 0a64 6566 206f  ")(k, v)...def o
-00021fd0: 626a 6563 745f 636f 6e73 7472 7563 7428  bject_construct(
-00021fe0: 2a6b 6579 5f76 616c 7565 733a 2043 6f6c  *key_values: Col
-00021ff0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00022000: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00022010: 7572 6e73 2061 6e20 4f42 4a45 4354 2063  urns an OBJECT c
-00022020: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
-00022030: 7468 6520 6172 6775 6d65 6e74 732e 0a0a  the arguments...
-00022040: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00022050: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00022060: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00022070: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-00022080: 5374 7275 6374 5479 7065 2c20 5374 7275  StructType, Stru
-00022090: 6374 4669 656c 642c 2056 6172 6961 6e74  ctField, Variant
-000220a0: 5479 7065 2c20 5374 7269 6e67 5479 7065  Type, StringType
-000220b0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000220c0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000220d0: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
-000220e0: 2020 2020 2e2e 2e20 2020 2020 5b5b 226e      ...     [["n
-000220f0: 616d 6522 2c20 224a 6f65 225d 2c20 5b22  ame", "Joe"], ["
-00022100: 7a69 7022 2c20 2239 3830 3034 225d 2c5b  zip", "98004"],[
-00022110: 2261 6765 222c 204e 6f6e 655d 2c20 5b4e  "age", None], [N
-00022120: 6f6e 652c 2022 7661 6c75 6522 5d5d 2c0a  one, "value"]],.
-00022130: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00022140: 7363 6865 6d61 3d53 7472 7563 7454 7970  schema=StructTyp
-00022150: 6528 5b53 7472 7563 7446 6965 6c64 2822  e([StructField("
-00022160: 6b22 2c20 5374 7269 6e67 5479 7065 2829  k", StringType()
-00022170: 292c 2053 7472 7563 7446 6965 6c64 2822  ), StructField("
-00022180: 7622 2c20 5661 7269 616e 7454 7970 6528  v", VariantType(
-00022190: 2929 5d29 0a20 2020 2020 2020 202e 2e2e  ))]).        ...
-000221a0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-000221b0: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
-000221c0: 636f 6e73 7472 7563 7428 636f 6c28 226b  construct(col("k
-000221d0: 2229 2c20 636f 6c28 2276 2229 292e 616c  "), col("v")).al
-000221e0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-000221f0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00022200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00022210: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-00022220: 554c 5422 2020 2020 2020 2020 2020 7c0a  ULT"          |.
-00022230: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00022240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00022250: 2020 2020 207c 7b20 2020 2020 2020 2020       |{         
-00022260: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00022270: 2020 7c20 2022 6e61 6d65 223a 2022 4a6f    |  "name": "Jo
-00022280: 6522 2020 207c 0a20 2020 2020 2020 207c  e"   |.        |
-00022290: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
-000222a0: 2020 7c0a 2020 2020 2020 2020 7c7b 2020    |.        |{  
-000222b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000222c0: 0a20 2020 2020 2020 207c 2020 227a 6970  .        |  "zip
-000222d0: 223a 2022 3938 3030 3422 2020 7c0a 2020  ": "98004"  |.  
-000222e0: 2020 2020 2020 7c7d 2020 2020 2020 2020        |}        
-000222f0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00022300: 2020 207c 7b7d 2020 2020 2020 2020 2020     |{}          
-00022310: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00022320: 7c7b 7d20 2020 2020 2020 2020 2020 2020  |{}             
-00022330: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00022340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00022350: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00022360: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00022370: 2020 6b76 7320 3d20 5b5f 746f 5f63 6f6c    kvs = [_to_col
-00022380: 5f69 665f 7374 7228 6b76 2c20 226f 626a  _if_str(kv, "obj
-00022390: 6563 745f 636f 6e73 7472 7563 7422 2920  ect_construct") 
-000223a0: 666f 7220 6b76 2069 6e20 6b65 795f 7661  for kv in key_va
-000223b0: 6c75 6573 5d0a 2020 2020 7265 7475 726e  lues].    return
-000223c0: 2062 7569 6c74 696e 2822 6f62 6a65 6374   builtin("object
-000223d0: 5f63 6f6e 7374 7275 6374 2229 282a 6b76  _construct")(*kv
-000223e0: 7329 0a0a 0a64 6566 206f 626a 6563 745f  s)...def object_
-000223f0: 636f 6e73 7472 7563 745f 6b65 6570 5f6e  construct_keep_n
-00022400: 756c 6c28 2a6b 6579 5f76 616c 7565 733a  ull(*key_values:
-00022410: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00022420: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00022430: 2252 6574 7572 6e73 2061 6e20 6f62 6a65  "Returns an obje
-00022440: 6374 2063 6f6e 7461 696e 696e 6720 7468  ct containing th
-00022450: 6520 636f 6e74 656e 7473 206f 6620 7468  e contents of th
-00022460: 6520 696e 7075 7420 2869 2e65 2e20 736f  e input (i.e. so
-00022470: 7572 6365 2920 6f62 6a65 6374 2077 6974  urce) object wit
-00022480: 6820 6f6e 6520 6f72 206d 6f72 650a 2020  h one or more.  
-00022490: 2020 6b65 7973 2072 656d 6f76 6564 2e0a    keys removed..
-000224a0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-000224b0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-000224c0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-000224d0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-000224e0: 2053 7472 7563 7454 7970 652c 2053 7472   StructType, Str
-000224f0: 7563 7446 6965 6c64 2c20 5661 7269 616e  uctField, Varian
-00022500: 7454 7970 652c 2053 7472 696e 6754 7970  tType, StringTyp
-00022510: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00022520: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00022530: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-00022540: 2020 2020 202e 2e2e 2020 2020 205b 5b22       ...     [["
-00022550: 6b65 795f 3122 2c20 226f 6e65 225d 2c20  key_1", "one"], 
-00022560: 5b22 6b65 795f 3222 2c20 4e6f 6e65 5d5d  ["key_2", None]]
-00022570: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00022580: 2020 7363 6865 6d61 3d53 7472 7563 7454    schema=StructT
-00022590: 7970 6528 5b53 7472 7563 7446 6965 6c64  ype([StructField
-000225a0: 2822 6b22 2c20 5374 7269 6e67 5479 7065  ("k", StringType
-000225b0: 2829 292c 2053 7472 7563 7446 6965 6c64  ()), StructField
-000225c0: 2822 7622 2c20 5661 7269 616e 7454 7970  ("v", VariantTyp
-000225d0: 6528 2929 5d29 0a20 2020 2020 2020 202e  e())]).        .
-000225e0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-000225f0: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
-00022600: 745f 636f 6e73 7472 7563 745f 6b65 6570  t_construct_keep
-00022610: 5f6e 756c 6c28 636f 6c28 226b 2229 2c20  _null(col("k"), 
-00022620: 636f 6c28 2276 2229 292e 616c 6961 7328  col("v")).alias(
-00022630: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00022640: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00022650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00022660: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00022670: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00022680: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00022690: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000226a0: 207c 7b20 2020 2020 2020 2020 2020 2020   |{             
-000226b0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-000226c0: 2022 6b65 795f 3122 3a20 226f 6e65 2220   "key_1": "one" 
-000226d0: 207c 0a20 2020 2020 2020 207c 7d20 2020   |.        |}   
-000226e0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-000226f0: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-00022700: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-00022710: 2020 2020 207c 2020 226b 6579 5f32 223a       |  "key_2":
-00022720: 206e 756c 6c20 2020 7c0a 2020 2020 2020   null   |.      
-00022730: 2020 7c7d 2020 2020 2020 2020 2020 2020    |}            
-00022740: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00022750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00022760: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00022770: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00022780: 2020 2020 6b76 7320 3d20 5b5f 746f 5f63      kvs = [_to_c
-00022790: 6f6c 5f69 665f 7374 7228 6b76 2c20 226f  ol_if_str(kv, "o
-000227a0: 626a 6563 745f 636f 6e73 7472 7563 745f  bject_construct_
-000227b0: 6b65 6570 5f6e 756c 6c22 2920 666f 7220  keep_null") for 
-000227c0: 6b76 2069 6e20 6b65 795f 7661 6c75 6573  kv in key_values
-000227d0: 5d0a 2020 2020 7265 7475 726e 2062 7569  ].    return bui
-000227e0: 6c74 696e 2822 6f62 6a65 6374 5f63 6f6e  ltin("object_con
-000227f0: 7374 7275 6374 5f6b 6565 705f 6e75 6c6c  struct_keep_null
-00022800: 2229 282a 6b76 7329 0a0a 0a64 6566 206f  ")(*kvs)...def o
-00022810: 626a 6563 745f 6465 6c65 7465 286f 626a  bject_delete(obj
-00022820: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00022830: 6b65 7931 3a20 436f 6c75 6d6e 4f72 4e61  key1: ColumnOrNa
-00022840: 6d65 2c20 2a6b 6579 733a 2043 6f6c 756d  me, *keys: Colum
-00022850: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00022860: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00022870: 6e73 2061 6e20 6f62 6a65 6374 2063 6f6e  ns an object con
-00022880: 7369 7374 696e 6720 6f66 2074 6865 2069  sisting of the i
-00022890: 6e70 7574 206f 626a 6563 7420 7769 7468  nput object with
-000228a0: 206f 6e65 206f 7220 6d6f 7265 206b 6579   one or more key
-000228b0: 7320 7265 6d6f 7665 642e 0a20 2020 2054  s removed..    T
-000228c0: 6865 2069 6e70 7574 206b 6579 206d 7573  he input key mus
-000228d0: 7420 6e6f 7420 6578 6973 7420 696e 2074  t not exist in t
-000228e0: 6865 206f 626a 6563 742e 0a0a 2020 2020  he object...    
-000228f0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00022900: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00022910: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-00022920: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-00022930: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
-00022940: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-00022950: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-00022960: 2020 2273 656c 6563 7420 6f62 6a65 6374    "select object
-00022970: 5f63 6f6e 7374 7275 6374 2861 2c62 2c63  _construct(a,b,c
-00022980: 2c64 2c65 2c66 2920 6173 206f 626a 2066  ,d,e,f) as obj f
-00022990: 726f 6d20 220a 2020 2020 2020 2020 2e2e  rom ".        ..
-000229a0: 2e20 2020 2020 2276 616c 7565 7328 2761  .     "values('a
-000229b0: 6765 272c 2032 312c 2027 7a69 7027 2c20  ge', 21, 'zip', 
-000229c0: 3231 3032 312c 2027 6e61 6d65 272c 2027  21021, 'name', '
-000229d0: 4a6f 6527 292c 220a 2020 2020 2020 2020  Joe'),".        
-000229e0: 2e2e 2e20 2020 2020 2228 2761 6765 272c  ...     "('age',
-000229f0: 2032 362c 2027 7a69 7027 2c20 3934 3032   26, 'zip', 9402
-00022a00: 312c 2027 6e61 6d65 272c 2027 4a61 7927  1, 'name', 'Jay'
-00022a10: 2920 6173 2054 2861 2c62 2c63 2c64 2c65  ) as T(a,b,c,d,e
-00022a20: 2c66 2922 0a20 2020 2020 2020 202e 2e2e  ,f)".        ...
-00022a30: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-00022a40: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
-00022a50: 6465 6c65 7465 2863 6f6c 2822 6f62 6a22  delete(col("obj"
-00022a60: 292c 206c 6974 2822 6167 6522 2929 2e61  ), lit("age")).a
-00022a70: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00022a80: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00022a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00022aa0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-00022ab0: 5355 4c54 2220 2020 2020 2020 2020 207c  SULT"          |
-00022ac0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00022ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00022ae0: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
-00022af0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00022b00: 2020 207c 2020 226e 616d 6522 3a20 224a     |  "name": "J
-00022b10: 6f65 222c 2020 7c0a 2020 2020 2020 2020  oe",  |.        
-00022b20: 7c20 2022 7a69 7022 3a20 3231 3032 3120  |  "zip": 21021 
-00022b30: 2020 207c 0a20 2020 2020 2020 207c 7d20     |.        |} 
-00022b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b50: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
-00022b60: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-00022b70: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
-00022b80: 3a20 224a 6179 222c 2020 7c0a 2020 2020  : "Jay",  |.    
-00022b90: 2020 2020 7c20 2022 7a69 7022 3a20 3934      |  "zip": 94
-00022ba0: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
-00022bb0: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
-00022bc0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-00022bd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00022be0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00022bf0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00022c00: 2020 206f 203d 205f 746f 5f63 6f6c 5f69     o = _to_col_i
-00022c10: 665f 7374 7228 6f62 6a2c 2022 6f62 6a65  f_str(obj, "obje
-00022c20: 6374 5f64 656c 6574 6522 290a 2020 2020  ct_delete").    
-00022c30: 6b31 203d 205f 746f 5f63 6f6c 5f69 665f  k1 = _to_col_if_
-00022c40: 7374 7228 6b65 7931 2c20 226f 626a 6563  str(key1, "objec
-00022c50: 745f 6465 6c65 7465 2229 0a20 2020 206b  t_delete").    k
-00022c60: 7320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  s = [_to_col_if_
-00022c70: 7374 7228 6b2c 2022 6f62 6a65 6374 5f64  str(k, "object_d
-00022c80: 656c 6574 6522 2920 666f 7220 6b20 696e  elete") for k in
-00022c90: 206b 6579 735d 0a20 2020 2072 6574 7572   keys].    retur
-00022ca0: 6e20 6275 696c 7469 6e28 226f 626a 6563  n builtin("objec
-00022cb0: 745f 6465 6c65 7465 2229 286f 2c20 6b31  t_delete")(o, k1
-00022cc0: 2c20 2a6b 7329 0a0a 0a64 6566 206f 626a  , *ks)...def obj
-00022cd0: 6563 745f 696e 7365 7274 280a 2020 2020  ect_insert(.    
-00022ce0: 6f62 6a3a 2043 6f6c 756d 6e4f 724e 616d  obj: ColumnOrNam
-00022cf0: 652c 0a20 2020 206b 6579 3a20 436f 6c75  e,.    key: Colu
-00022d00: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 7661  mnOrName,.    va
-00022d10: 6c75 653a 2043 6f6c 756d 6e4f 724e 616d  lue: ColumnOrNam
-00022d20: 652c 0a20 2020 2075 7064 6174 655f 666c  e,.    update_fl
-00022d30: 6167 3a20 4f70 7469 6f6e 616c 5b43 6f6c  ag: Optional[Col
-00022d40: 756d 6e4f 724e 616d 655d 203d 204e 6f6e  umnOrName] = Non
-00022d50: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
-00022d60: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-00022d70: 6e20 6f62 6a65 6374 2063 6f6e 7369 7374  n object consist
-00022d80: 696e 6720 6f66 2074 6865 2069 6e70 7574  ing of the input
-00022d90: 206f 626a 6563 7420 7769 7468 2061 206e   object with a n
-00022da0: 6577 206b 6579 2d76 616c 7565 2070 6169  ew key-value pai
-00022db0: 7220 696e 7365 7274 6564 2028 6f72 2061  r inserted (or a
-00022dc0: 6e0a 2020 2020 6578 6973 7469 6e67 206b  n.    existing k
-00022dd0: 6579 2075 7064 6174 6564 2077 6974 6820  ey updated with 
-00022de0: 6120 6e65 7720 7661 6c75 6529 2e0a 0a20  a new value)... 
-00022df0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-00022e00: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00022e10: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00022e20: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-00022e30: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
-00022e40: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
-00022e50: 716c 280a 2020 2020 2020 2020 2e2e 2e20  ql(.        ... 
-00022e60: 2020 2020 2273 656c 6563 7420 6f62 6a65      "select obje
-00022e70: 6374 5f63 6f6e 7374 7275 6374 2861 2c62  ct_construct(a,b
-00022e80: 2c63 2c64 2c65 2c66 2920 6173 206f 626a  ,c,d,e,f) as obj
-00022e90: 2c20 6b2c 2076 2066 726f 6d20 220a 2020  , k, v from ".  
-00022ea0: 2020 2020 2020 2e2e 2e20 2020 2020 2276        ...     "v
-00022eb0: 616c 7565 7328 2761 6765 272c 2032 312c  alues('age', 21,
-00022ec0: 2027 7a69 7027 2c20 3231 3032 312c 2027   'zip', 21021, '
-00022ed0: 6e61 6d65 272c 2027 4a6f 6527 2c20 2761  name', 'Joe', 'a
-00022ee0: 6765 272c 2030 292c 220a 2020 2020 2020  ge', 0),".      
-00022ef0: 2020 2e2e 2e20 2020 2020 2228 2761 6765    ...     "('age
-00022f00: 272c 2032 362c 2027 7a69 7027 2c20 3934  ', 26, 'zip', 94
-00022f10: 3032 312c 2027 6e61 6d65 272c 2027 4a61  021, 'name', 'Ja
-00022f20: 7927 2c20 2761 6765 272c 2030 2920 6173  y', 'age', 0) as
-00022f30: 2054 2861 2c62 2c63 2c64 2c65 2c66 2c6b   T(a,b,c,d,e,f,k
-00022f40: 2c76 2922 0a20 2020 2020 2020 202e 2e2e  ,v)".        ...
-00022f50: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-00022f60: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
-00022f70: 696e 7365 7274 2863 6f6c 2822 6f62 6a22  insert(col("obj"
-00022f80: 292c 206c 6974 2822 6b65 7922 292c 206c  ), lit("key"), l
-00022f90: 6974 2822 7622 2929 2e61 6c69 6173 2822  it("v")).alias("
-00022fa0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-00022fb0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00022fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00022fd0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00022fe0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00022ff0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00023000: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00023010: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
-00023020: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-00023030: 2261 6765 223a 2032 312c 2020 2020 2020  "age": 21,      
-00023040: 7c0a 2020 2020 2020 2020 7c20 2022 6b65  |.        |  "ke
-00023050: 7922 3a20 2276 222c 2020 2020 207c 0a20  y": "v",     |. 
-00023060: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
-00023070: 3a20 224a 6f65 222c 2020 7c0a 2020 2020  : "Joe",  |.    
-00023080: 2020 2020 7c20 2022 7a69 7022 3a20 3231      |  "zip": 21
-00023090: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
-000230a0: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
-000230b0: 2020 2020 7c0a 2020 2020 2020 2020 7c7b      |.        |{
-000230c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230d0: 207c 0a20 2020 2020 2020 207c 2020 2261   |.        |  "a
-000230e0: 6765 223a 2032 362c 2020 2020 2020 7c0a  ge": 26,      |.
-000230f0: 2020 2020 2020 2020 7c20 2022 6b65 7922          |  "key"
-00023100: 3a20 2276 222c 2020 2020 207c 0a20 2020  : "v",     |.   
-00023110: 2020 2020 207c 2020 226e 616d 6522 3a20       |  "name": 
-00023120: 224a 6179 222c 2020 7c0a 2020 2020 2020  "Jay",  |.      
-00023130: 2020 7c20 2022 7a69 7022 3a20 3934 3032    |  "zip": 9402
-00023140: 3120 2020 207c 0a20 2020 2020 2020 207c  1    |.        |
-00023150: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
-00023160: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00023170: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00023180: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00023190: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-000231a0: 206f 203d 205f 746f 5f63 6f6c 5f69 665f   o = _to_col_if_
-000231b0: 7374 7228 6f62 6a2c 2022 6f62 6a65 6374  str(obj, "object
-000231c0: 5f69 6e73 6572 7422 290a 2020 2020 6b20  _insert").    k 
-000231d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-000231e0: 286b 6579 2c20 226f 626a 6563 745f 696e  (key, "object_in
-000231f0: 7365 7274 2229 0a20 2020 2076 203d 205f  sert").    v = _
-00023200: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
-00023210: 6c75 652c 2022 6f62 6a65 6374 5f69 6e73  lue, "object_ins
-00023220: 6572 7422 290a 2020 2020 7566 203d 205f  ert").    uf = _
-00023230: 746f 5f63 6f6c 5f69 665f 7374 7228 7570  to_col_if_str(up
-00023240: 6461 7465 5f66 6c61 672c 2022 7570 6461  date_flag, "upda
-00023250: 7465 5f66 6c61 6722 2920 6966 2075 7064  te_flag") if upd
-00023260: 6174 655f 666c 6167 2069 7320 6e6f 7420  ate_flag is not 
-00023270: 4e6f 6e65 2065 6c73 6520 4e6f 6e65 0a20  None else None. 
-00023280: 2020 2069 6620 7566 2069 7320 6e6f 7420     if uf is not 
-00023290: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-000232a0: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
-000232b0: 6a65 6374 5f69 6e73 6572 7422 2928 6f2c  ject_insert")(o,
-000232c0: 206b 2c20 762c 2075 6629 0a20 2020 2065   k, v, uf).    e
-000232d0: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
-000232e0: 7572 6e20 6275 696c 7469 6e28 226f 626a  urn builtin("obj
-000232f0: 6563 745f 696e 7365 7274 2229 286f 2c20  ect_insert")(o, 
-00023300: 6b2c 2076 290a 0a0a 6465 6620 6f62 6a65  k, v)...def obje
-00023310: 6374 5f70 6963 6b28 6f62 6a3a 2043 6f6c  ct_pick(obj: Col
-00023320: 756d 6e4f 724e 616d 652c 206b 6579 313a  umnOrName, key1:
-00023330: 2043 6f6c 756d 6e4f 724e 616d 652c 202a   ColumnOrName, *
-00023340: 6b65 7973 3a20 436f 6c75 6d6e 4f72 4e61  keys: ColumnOrNa
-00023350: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00023360: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
-00023370: 6e65 7720 4f42 4a45 4354 2063 6f6e 7461  new OBJECT conta
-00023380: 696e 696e 6720 736f 6d65 206f 6620 7468  ining some of th
-00023390: 6520 6b65 792d 7661 6c75 6520 7061 6972  e key-value pair
-000233a0: 7320 6672 6f6d 2061 6e20 6578 6973 7469  s from an existi
-000233b0: 6e67 206f 626a 6563 742e 0a0a 2020 2020  ng object...    
-000233c0: 546f 2069 6465 6e74 6966 7920 7468 6520  To identify the 
-000233d0: 6b65 792d 7661 6c75 6520 7061 6972 7320  key-value pairs 
-000233e0: 746f 2069 6e63 6c75 6465 2069 6e20 7468  to include in th
-000233f0: 6520 6e65 7720 6f62 6a65 6374 2c20 7061  e new object, pa
-00023400: 7373 2069 6e20 7468 6520 6b65 7973 2061  ss in the keys a
-00023410: 7320 6172 6775 6d65 6e74 732c 0a20 2020  s arguments,.   
-00023420: 206f 7220 7061 7373 2069 6e20 616e 2061   or pass in an a
-00023430: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
-00023440: 7468 6520 6b65 7973 2e0a 0a20 2020 2049  the keys...    I
-00023450: 6620 6120 7370 6563 6966 6965 6420 6b65  f a specified ke
-00023460: 7920 6973 206e 6f74 2070 7265 7365 6e74  y is not present
-00023470: 2069 6e20 7468 6520 696e 7075 7420 6f62   in the input ob
-00023480: 6a65 6374 2c20 7468 6520 6b65 7920 6973  ject, the key is
-00023490: 2069 676e 6f72 6564 2e0a 0a20 2020 2045   ignored...    E
-000234a0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-000234b0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-000234c0: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-000234d0: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
-000234e0: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
-000234f0: 203d 2073 6573 7369 6f6e 2e73 716c 280a   = session.sql(.
-00023500: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00023510: 2273 656c 6563 7420 6f62 6a65 6374 5f63  "select object_c
-00023520: 6f6e 7374 7275 6374 2861 2c62 2c63 2c64  onstruct(a,b,c,d
-00023530: 2c65 2c66 2920 6173 206f 626a 2c20 6b2c  ,e,f) as obj, k,
-00023540: 2076 2066 726f 6d20 220a 2020 2020 2020   v from ".      
-00023550: 2020 2e2e 2e20 2020 2020 2276 616c 7565    ...     "value
-00023560: 7328 2761 6765 272c 2032 312c 2027 7a69  s('age', 21, 'zi
-00023570: 7027 2c20 3231 3032 312c 2027 6e61 6d65  p', 21021, 'name
-00023580: 272c 2027 4a6f 6527 2c20 2761 6765 272c  ', 'Joe', 'age',
-00023590: 2030 292c 220a 2020 2020 2020 2020 2e2e   0),".        ..
-000235a0: 2e20 2020 2020 2228 2761 6765 272c 2032  .     "('age', 2
-000235b0: 362c 2027 7a69 7027 2c20 3934 3032 312c  6, 'zip', 94021,
-000235c0: 2027 6e61 6d65 272c 2027 4a61 7927 2c20   'name', 'Jay', 
-000235d0: 2761 6765 272c 2030 2920 6173 2054 2861  'age', 0) as T(a
-000235e0: 2c62 2c63 2c64 2c65 2c66 2c6b 2c76 2922  ,b,c,d,e,f,k,v)"
-000235f0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-00023600: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00023610: 6c65 6374 286f 626a 6563 745f 7069 636b  lect(object_pick
-00023620: 2863 6f6c 2822 6f62 6a22 292c 2063 6f6c  (col("obj"), col
-00023630: 2822 6b22 292c 206c 6974 2822 6e61 6d65  ("k"), lit("name
-00023640: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-00023650: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00023660: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00023670: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00023680: 7c22 5245 5355 4c54 2220 2020 2020 2020  |"RESULT"       
-00023690: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000236a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-000236b0: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-000236c0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-000236d0: 2020 2020 7c20 2022 6167 6522 3a20 3231      |  "age": 21
-000236e0: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
-000236f0: 7c20 2022 6e61 6d65 223a 2022 4a6f 6522  |  "name": "Joe"
-00023700: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
-00023710: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00023720: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-00023730: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00023740: 2020 2020 7c20 2022 6167 6522 3a20 3236      |  "age": 26
-00023750: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
-00023760: 7c20 2022 6e61 6d65 223a 2022 4a61 7922  |  "name": "Jay"
-00023770: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
-00023780: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00023790: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000237a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000237b0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-000237c0: 2020 2020 2222 220a 2020 2020 6f20 3d20      """.    o = 
-000237d0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286f  _to_col_if_str(o
-000237e0: 626a 2c20 226f 626a 6563 745f 7069 636b  bj, "object_pick
-000237f0: 2229 0a20 2020 206b 3120 3d20 5f74 6f5f  ").    k1 = _to_
-00023800: 636f 6c5f 6966 5f73 7472 286b 6579 312c  col_if_str(key1,
-00023810: 2022 6f62 6a65 6374 5f70 6963 6b22 290a   "object_pick").
-00023820: 2020 2020 6b73 203d 205b 5f74 6f5f 636f      ks = [_to_co
-00023830: 6c5f 6966 5f73 7472 286b 2c20 226f 626a  l_if_str(k, "obj
-00023840: 6563 745f 7069 636b 2229 2066 6f72 206b  ect_pick") for k
-00023850: 2069 6e20 6b65 7973 5d0a 2020 2020 7265   in keys].    re
-00023860: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
-00023870: 6a65 6374 5f70 6963 6b22 2928 6f2c 206b  ject_pick")(o, k
-00023880: 312c 202a 6b73 290a 0a0a 6465 6620 6173  1, *ks)...def as
-00023890: 6328 633a 2043 6f6c 756d 6e4f 724e 616d  c(c: ColumnOrNam
-000238a0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-000238b0: 2020 2222 2252 6574 7572 6e73 2061 2043    """Returns a C
-000238c0: 6f6c 756d 6e20 6578 7072 6573 7369 6f6e  olumn expression
-000238d0: 2077 6974 6820 7661 6c75 6573 2073 6f72   with values sor
-000238e0: 7465 6420 696e 2061 7363 656e 6469 6e67  ted in ascending
-000238f0: 206f 7264 6572 2e0a 0a20 2020 2045 7861   order...    Exa
-00023900: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00023910: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00023920: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00023930: 6528 5b4e 6f6e 652c 2033 2c20 322c 2031  e([None, 3, 2, 1
-00023940: 2c20 4e6f 6e65 5d2c 2073 6368 656d 613d  , None], schema=
-00023950: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-00023960: 3e3e 2064 662e 736f 7274 2861 7363 2864  >> df.sort(asc(d
-00023970: 665b 2261 225d 2929 2e63 6f6c 6c65 6374  f["a"])).collect
-00023980: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00023990: 413d 4e6f 6e65 292c 2052 6f77 2841 3d4e  A=None), Row(A=N
-000239a0: 6f6e 6529 2c20 526f 7728 413d 3129 2c20  one), Row(A=1), 
-000239b0: 526f 7728 413d 3229 2c20 526f 7728 413d  Row(A=2), Row(A=
-000239c0: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
-000239d0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-000239e0: 7472 2863 2c20 2261 7363 2229 0a20 2020  tr(c, "asc").   
-000239f0: 2072 6574 7572 6e20 632e 6173 6328 290a   return c.asc().
-00023a00: 0a0a 6465 6620 6173 635f 6e75 6c6c 735f  ..def asc_nulls_
-00023a10: 6669 7273 7428 633a 2043 6f6c 756d 6e4f  first(c: ColumnO
-00023a20: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00023a30: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-00023a40: 2061 2043 6f6c 756d 6e20 6578 7072 6573   a Column expres
-00023a50: 7369 6f6e 2077 6974 6820 7661 6c75 6573  sion with values
-00023a60: 2073 6f72 7465 6420 696e 2061 7363 656e   sorted in ascen
-00023a70: 6469 6e67 206f 7264 6572 0a20 2020 2028  ding order.    (
-00023a80: 6e75 6c6c 2076 616c 7565 7320 736f 7274  null values sort
-00023a90: 6564 2062 6566 6f72 6520 6e6f 6e2d 6e75  ed before non-nu
-00023aa0: 6c6c 2076 616c 7565 7329 2e0a 0a20 2020  ll values)...   
-00023ab0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00023ac0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00023ad0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00023ae0: 6672 616d 6528 5b4e 6f6e 652c 2033 2c20  frame([None, 3, 
-00023af0: 322c 2031 2c20 4e6f 6e65 5d2c 2073 6368  2, 1, None], sch
-00023b00: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00023b10: 2020 203e 3e3e 2064 662e 736f 7274 2861     >>> df.sort(a
-00023b20: 7363 5f6e 756c 6c73 5f66 6972 7374 2864  sc_nulls_first(d
-00023b30: 665b 2261 225d 2929 2e63 6f6c 6c65 6374  f["a"])).collect
-00023b40: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00023b50: 413d 4e6f 6e65 292c 2052 6f77 2841 3d4e  A=None), Row(A=N
-00023b60: 6f6e 6529 2c20 526f 7728 413d 3129 2c20  one), Row(A=1), 
-00023b70: 526f 7728 413d 3229 2c20 526f 7728 413d  Row(A=2), Row(A=
-00023b80: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
-00023b90: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00023ba0: 7472 2863 2c20 2261 7363 5f6e 756c 6c73  tr(c, "asc_nulls
-00023bb0: 5f66 6972 7374 2229 0a20 2020 2072 6574  _first").    ret
-00023bc0: 7572 6e20 632e 6173 635f 6e75 6c6c 735f  urn c.asc_nulls_
-00023bd0: 6669 7273 7428 290a 0a0a 6465 6620 6173  first()...def as
-00023be0: 635f 6e75 6c6c 735f 6c61 7374 2863 3a20  c_nulls_last(c: 
-00023bf0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00023c00: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00023c10: 5265 7475 726e 7320 6120 436f 6c75 6d6e  Returns a Column
-00023c20: 2065 7870 7265 7373 696f 6e20 7769 7468   expression with
-00023c30: 2076 616c 7565 7320 736f 7274 6564 2069   values sorted i
-00023c40: 6e20 6173 6365 6e64 696e 6720 6f72 6465  n ascending orde
-00023c50: 720a 2020 2020 286e 756c 6c20 7661 6c75  r.    (null valu
-00023c60: 6573 2073 6f72 7465 6420 6166 7465 7220  es sorted after 
-00023c70: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
-00023c80: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00023c90: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00023ca0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00023cb0: 655f 6461 7461 6672 616d 6528 5b4e 6f6e  e_dataframe([Non
-00023cc0: 652c 2033 2c20 322c 2031 2c20 4e6f 6e65  e, 3, 2, 1, None
-00023cd0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00023ce0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00023cf0: 736f 7274 2861 7363 5f6e 756c 6c73 5f6c  sort(asc_nulls_l
-00023d00: 6173 7428 6466 5b22 6122 5d29 292e 636f  ast(df["a"])).co
-00023d10: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00023d20: 5b52 6f77 2841 3d31 292c 2052 6f77 2841  [Row(A=1), Row(A
-00023d30: 3d32 292c 2052 6f77 2841 3d33 292c 2052  =2), Row(A=3), R
-00023d40: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
-00023d50: 413d 4e6f 6e65 295d 0a20 2020 2022 2222  A=None)].    """
-00023d60: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00023d70: 5f69 665f 7374 7228 632c 2022 6173 635f  _if_str(c, "asc_
-00023d80: 6e75 6c6c 735f 6c61 7374 2229 0a20 2020  nulls_last").   
-00023d90: 2072 6574 7572 6e20 632e 6173 635f 6e75   return c.asc_nu
-00023da0: 6c6c 735f 6c61 7374 2829 0a0a 0a64 6566  lls_last()...def
-00023db0: 2064 6573 6328 633a 2043 6f6c 756d 6e4f   desc(c: ColumnO
-00023dc0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00023dd0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00023de0: 7475 726e 7320 6120 436f 6c75 6d6e 2065  turns a Column e
-00023df0: 7870 7265 7373 696f 6e20 7769 7468 2076  xpression with v
-00023e00: 616c 7565 7320 736f 7274 6564 2069 6e20  alues sorted in 
-00023e10: 6465 7363 656e 6469 6e67 206f 7264 6572  descending order
-00023e20: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00023e30: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00023e40: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00023e50: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
-00023e60: 322c 2033 2c20 4e6f 6e65 2c20 4e6f 6e65  2, 3, None, None
-00023e70: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00023e80: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00023e90: 736f 7274 2864 6573 6328 6466 5b22 6122  sort(desc(df["a"
-00023ea0: 5d29 292e 636f 6c6c 6563 7428 290a 2020  ])).collect().  
-00023eb0: 2020 2020 2020 5b52 6f77 2841 3d33 292c        [Row(A=3),
-00023ec0: 2052 6f77 2841 3d32 292c 2052 6f77 2841   Row(A=2), Row(A
-00023ed0: 3d31 292c 2052 6f77 2841 3d4e 6f6e 6529  =1), Row(A=None)
-00023ee0: 2c20 526f 7728 413d 4e6f 6e65 295d 0a20  , Row(A=None)]. 
-00023ef0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-00023f00: 746f 5f63 6f6c 5f69 665f 7374 7228 632c  to_col_if_str(c,
-00023f10: 2022 6465 7363 2229 0a20 2020 2072 6574   "desc").    ret
-00023f20: 7572 6e20 632e 6465 7363 2829 0a0a 0a64  urn c.desc()...d
-00023f30: 6566 2064 6573 635f 6e75 6c6c 735f 6669  ef desc_nulls_fi
-00023f40: 7273 7428 633a 2043 6f6c 756d 6e4f 724e  rst(c: ColumnOrN
-00023f50: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00023f60: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-00023f70: 726e 7320 6120 436f 6c75 6d6e 2065 7870  rns a Column exp
-00023f80: 7265 7373 696f 6e20 7769 7468 2076 616c  ression with val
-00023f90: 7565 7320 736f 7274 6564 2069 6e20 6465  ues sorted in de
-00023fa0: 7363 656e 6469 6e67 206f 7264 6572 0a20  scending order. 
-00023fb0: 2020 2028 6e75 6c6c 2076 616c 7565 7320     (null values 
-00023fc0: 736f 7274 6564 2062 6566 6f72 6520 6e6f  sorted before no
-00023fd0: 6e2d 6e75 6c6c 2076 616c 7565 7329 2e0a  n-null values)..
-00023fe0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00023ff0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00024000: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00024010: 6461 7461 6672 616d 6528 5b31 2c20 322c  dataframe([1, 2,
-00024020: 2033 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c   3, None, None],
-00024030: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00024040: 2020 2020 2020 203e 3e3e 2064 662e 736f         >>> df.so
-00024050: 7274 2864 6573 635f 6e75 6c6c 735f 6669  rt(desc_nulls_fi
-00024060: 7273 7428 6466 5b22 6122 5d29 292e 636f  rst(df["a"])).co
-00024070: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00024080: 5b52 6f77 2841 3d4e 6f6e 6529 2c20 526f  [Row(A=None), Ro
-00024090: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
-000240a0: 3d33 292c 2052 6f77 2841 3d32 292c 2052  =3), Row(A=2), R
-000240b0: 6f77 2841 3d31 295d 0a20 2020 2022 2222  ow(A=1)].    """
-000240c0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-000240d0: 5f69 665f 7374 7228 632c 2022 6465 7363  _if_str(c, "desc
-000240e0: 5f6e 756c 6c73 5f66 6972 7374 2229 0a20  _nulls_first"). 
-000240f0: 2020 2072 6574 7572 6e20 632e 6465 7363     return c.desc
-00024100: 5f6e 756c 6c73 5f66 6972 7374 2829 0a0a  _nulls_first()..
-00024110: 0a64 6566 2064 6573 635f 6e75 6c6c 735f  .def desc_nulls_
-00024120: 6c61 7374 2863 3a20 436f 6c75 6d6e 4f72  last(c: ColumnOr
-00024130: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00024140: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-00024150: 7572 6e73 2061 2043 6f6c 756d 6e20 6578  urns a Column ex
-00024160: 7072 6573 7369 6f6e 2077 6974 6820 7661  pression with va
-00024170: 6c75 6573 2073 6f72 7465 6420 696e 2064  lues sorted in d
-00024180: 6573 6365 6e64 696e 6720 6f72 6465 720a  escending order.
-00024190: 2020 2020 286e 756c 6c20 7661 6c75 6573      (null values
-000241a0: 2073 6f72 7465 6420 6166 7465 7220 6e6f   sorted after no
-000241b0: 6e2d 6e75 6c6c 2076 616c 7565 7329 2e0a  n-null values)..
-000241c0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-000241d0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-000241e0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-000241f0: 6461 7461 6672 616d 6528 5b31 2c20 322c  dataframe([1, 2,
-00024200: 2033 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c   3, None, None],
-00024210: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00024220: 2020 2020 2020 203e 3e3e 2064 662e 736f         >>> df.so
-00024230: 7274 2864 6573 635f 6e75 6c6c 735f 6c61  rt(desc_nulls_la
-00024240: 7374 2864 665b 2261 225d 2929 2e63 6f6c  st(df["a"])).col
-00024250: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00024260: 526f 7728 413d 3329 2c20 526f 7728 413d  Row(A=3), Row(A=
-00024270: 3229 2c20 526f 7728 413d 3129 2c20 526f  2), Row(A=1), Ro
-00024280: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
-00024290: 3d4e 6f6e 6529 5d0a 2020 2020 2222 220a  =None)].    """.
-000242a0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-000242b0: 6966 5f73 7472 2863 2c20 2264 6573 635f  if_str(c, "desc_
-000242c0: 6e75 6c6c 735f 6c61 7374 2229 0a20 2020  nulls_last").   
-000242d0: 2072 6574 7572 6e20 632e 6465 7363 5f6e   return c.desc_n
-000242e0: 756c 6c73 5f6c 6173 7428 290a 0a0a 6465  ulls_last()...de
-000242f0: 6620 6173 5f61 7272 6179 2876 6172 6961  f as_array(varia
-00024300: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
-00024310: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00024320: 2022 2222 4361 7374 7320 6120 5641 5249   """Casts a VARI
-00024330: 414e 5420 7661 6c75 6520 746f 2061 6e20  ANT value to an 
-00024340: 6172 7261 792e 2222 220a 2020 2020 6320  array.""".    c 
-00024350: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00024360: 2876 6172 6961 6e74 2c20 2261 735f 6172  (variant, "as_ar
-00024370: 7261 7922 290a 2020 2020 7265 7475 726e  ray").    return
-00024380: 2062 7569 6c74 696e 2822 6173 5f61 7272   builtin("as_arr
-00024390: 6179 2229 2863 290a 0a0a 6465 6620 6173  ay")(c)...def as
-000243a0: 5f62 696e 6172 7928 7661 7269 616e 743a  _binary(variant:
-000243b0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-000243c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000243d0: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
-000243e0: 2076 616c 7565 2074 6f20 6120 6269 6e61   value to a bina
-000243f0: 7279 2073 7472 696e 672e 2222 220a 2020  ry string.""".  
-00024400: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00024410: 5f73 7472 2876 6172 6961 6e74 2c20 2261  _str(variant, "a
-00024420: 735f 6269 6e61 7279 2229 0a20 2020 2072  s_binary").    r
-00024430: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-00024440: 735f 6269 6e61 7279 2229 2863 290a 0a0a  s_binary")(c)...
-00024450: 6465 6620 6173 5f63 6861 7228 7661 7269  def as_char(vari
-00024460: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
-00024470: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00024480: 2020 2222 2243 6173 7473 2061 2056 4152    """Casts a VAR
-00024490: 4941 4e54 2076 616c 7565 2074 6f20 6120  IANT value to a 
-000244a0: 7374 7269 6e67 2e0a 0a20 2020 2045 7861  string...    Exa
-000244b0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-000244c0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-000244d0: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-000244e0: 7469 6f6e 7320 696d 706f 7274 2061 735f  tions import as_
-000244f0: 6368 6172 2c20 746f 5f76 6172 6961 6e74  char, to_variant
-00024500: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00024510: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-00024520: 656c 6563 7420 2773 6f6d 6520 7374 7269  elect 'some stri
-00024530: 6e67 2720 6173 2063 6861 7222 290a 2020  ng' as char").  
-00024540: 2020 2020 2020 3e3e 3e20 6466 2e63 6861        >>> df.cha
-00024550: 725f 7620 3d20 746f 5f76 6172 6961 6e74  r_v = to_variant
-00024560: 2864 662e 6368 6172 290a 2020 2020 2020  (df.char).      
-00024570: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00024580: 6466 2e63 6861 725f 762e 6173 5f28 2263  df.char_v.as_("c
-00024590: 6861 7222 2929 2e63 6f6c 6c65 6374 2829  har")).collect()
-000245a0: 203d 3d20 6466 2e73 656c 6563 7428 6466   == df.select(df
-000245b0: 2e63 6861 7229 2e63 6f6c 6c65 6374 2829  .char).collect()
-000245c0: 0a20 2020 2020 2020 2046 616c 7365 0a20  .        False. 
-000245d0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-000245e0: 6c65 6374 2861 735f 6368 6172 2864 662e  lect(as_char(df.
-000245f0: 6368 6172 5f76 292e 6173 5f28 2263 6861  char_v).as_("cha
-00024600: 7222 2929 2e63 6f6c 6c65 6374 2829 203d  r")).collect() =
-00024610: 3d20 6466 2e73 656c 6563 7428 6466 2e63  = df.select(df.c
-00024620: 6861 7229 2e63 6f6c 6c65 6374 2829 0a20  har).collect(). 
-00024630: 2020 2020 2020 2054 7275 650a 2020 2020         True.    
-00024640: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00024650: 636f 6c5f 6966 5f73 7472 2876 6172 6961  col_if_str(varia
-00024660: 6e74 2c20 2261 735f 6368 6172 2229 0a20  nt, "as_char"). 
-00024670: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00024680: 6e28 2261 735f 6368 6172 2229 2863 290a  n("as_char")(c).
-00024690: 0a0a 6465 6620 6173 5f76 6172 6368 6172  ..def as_varchar
-000246a0: 2876 6172 6961 6e74 3a20 436f 6c75 6d6e  (variant: Column
-000246b0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-000246c0: 6e3a 0a20 2020 2022 2222 4361 7374 7320  n:.    """Casts 
-000246d0: 6120 5641 5249 414e 5420 7661 6c75 6520  a VARIANT value 
-000246e0: 746f 2061 2073 7472 696e 672e 0a0a 2020  to a string...  
-000246f0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-00024700: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00024710: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00024720: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-00024730: 7420 6173 5f76 6172 6368 6172 2c20 746f  t as_varchar, to
-00024740: 5f76 6172 6961 6e74 0a20 2020 2020 2020  _variant.       
-00024750: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00024760: 6e2e 7371 6c28 2273 656c 6563 7420 2773  n.sql("select 's
-00024770: 6f6d 6520 7374 7269 6e67 2720 6173 2063  ome string' as c
-00024780: 6861 7222 290a 2020 2020 2020 2020 3e3e  har").        >>
-00024790: 3e20 6466 2e63 6861 725f 7620 3d20 746f  > df.char_v = to
-000247a0: 5f76 6172 6961 6e74 2864 662e 6368 6172  _variant(df.char
-000247b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000247c0: 2e73 656c 6563 7428 6466 2e63 6861 725f  .select(df.char_
-000247d0: 762e 6173 5f28 2263 6861 7222 2929 2e63  v.as_("char")).c
-000247e0: 6f6c 6c65 6374 2829 203d 3d20 6466 2e73  ollect() == df.s
-000247f0: 656c 6563 7428 6466 2e63 6861 7229 2e63  elect(df.char).c
-00024800: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00024810: 2046 616c 7365 0a20 2020 2020 2020 203e   False.        >
-00024820: 3e3e 2064 662e 7365 6c65 6374 2861 735f  >> df.select(as_
-00024830: 7661 7263 6861 7228 6466 2e63 6861 725f  varchar(df.char_
-00024840: 7629 2e61 735f 2822 6368 6172 2229 292e  v).as_("char")).
-00024850: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
-00024860: 7365 6c65 6374 2864 662e 6368 6172 292e  select(df.char).
-00024870: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00024880: 2020 5472 7565 0a20 2020 2022 2222 0a20    True.    """. 
-00024890: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-000248a0: 665f 7374 7228 7661 7269 616e 742c 2022  f_str(variant, "
-000248b0: 6173 5f76 6172 6368 6172 2229 0a20 2020  as_varchar").   
-000248c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000248d0: 2261 735f 7661 7263 6861 7222 2928 6329  "as_varchar")(c)
-000248e0: 0a0a 0a64 6566 2061 735f 6461 7465 2876  ...def as_date(v
-000248f0: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-00024900: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00024910: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
-00024920: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-00024930: 2061 2064 6174 652e 2222 220a 2020 2020   a date.""".    
-00024940: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00024950: 7472 2876 6172 6961 6e74 2c20 2261 735f  tr(variant, "as_
-00024960: 6461 7465 2229 0a20 2020 2072 6574 7572  date").    retur
-00024970: 6e20 6275 696c 7469 6e28 2261 735f 6461  n builtin("as_da
-00024980: 7465 2229 2863 290a 0a0a 6465 6620 6361  te")(c)...def ca
-00024990: 7374 2863 6f6c 756d 6e3a 2043 6f6c 756d  st(column: Colum
-000249a0: 6e4f 724e 616d 652c 2074 6f3a 2055 6e69  nOrName, to: Uni
-000249b0: 6f6e 5b73 7472 2c20 4461 7461 5479 7065  on[str, DataType
-000249c0: 5d29 202d 3e20 436f 6c75 6d6e 3a0a 2020  ]) -> Column:.  
-000249d0: 2020 2222 2243 6f6e 7665 7274 7320 6120    """Converts a 
-000249e0: 7661 6c75 6520 6f66 206f 6e65 2064 6174  value of one dat
-000249f0: 6120 7479 7065 2069 6e74 6f20 616e 6f74  a type into anot
-00024a00: 6865 7220 6461 7461 2074 7970 652e 0a20  her data type.. 
-00024a10: 2020 2054 6865 2073 656d 616e 7469 6373     The semantics
-00024a20: 206f 6620 4341 5354 2061 7265 2074 6865   of CAST are the
-00024a30: 2073 616d 6520 6173 2074 6865 2073 656d   same as the sem
-00024a40: 616e 7469 6373 206f 6620 7468 6520 636f  antics of the co
-00024a50: 7272 6573 706f 6e64 696e 6720 746f 2064  rresponding to d
-00024a60: 6174 6174 7970 6520 636f 6e76 6572 7369  atatype conversi
-00024a70: 6f6e 2066 756e 6374 696f 6e73 2e0a 2020  on functions..  
-00024a80: 2020 4966 2074 6865 2063 6173 7420 6973    If the cast is
-00024a90: 206e 6f74 2070 6f73 7369 626c 652c 2061   not possible, a
-00024aa0: 2060 6053 6e6f 7770 6172 6b53 514c 4578   ``SnowparkSQLEx
-00024ab0: 6365 7074 696f 6e60 6020 6578 6365 7074  ception`` except
-00024ac0: 696f 6e20 6973 2074 6872 6f77 6e2e 0a0a  ion is thrown...
-00024ad0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00024ae0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00024af0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00024b00: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-00024b10: 4465 6369 6d61 6c54 7970 652c 2049 6e74  DecimalType, Int
-00024b20: 6567 6572 5479 7065 0a20 2020 2020 2020  egerType.       
-00024b30: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00024b40: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00024b50: 6d65 285b 5b31 2e35 3433 325d 5d2c 2073  me([[1.5432]], s
-00024b60: 6368 656d 613d 5b22 6422 5d29 0a20 2020  chema=["d"]).   
-00024b70: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00024b80: 6374 2863 6173 7428 6466 2e64 2c20 4465  ct(cast(df.d, De
-00024b90: 6369 6d61 6c54 7970 6528 3135 2c20 3229  cimalType(15, 2)
-00024ba0: 292e 6173 5f28 2244 4543 494d 414c 2229  ).as_("DECIMAL")
-00024bb0: 2c20 6361 7374 2864 662e 642c 2049 6e74  , cast(df.d, Int
-00024bc0: 6567 6572 5479 7065 2829 292e 6173 5f28  egerType()).as_(
-00024bd0: 2249 4e54 2229 292e 7368 6f77 2829 0a20  "INT")).show(). 
-00024be0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00024bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00024c00: 2020 2020 207c 2244 4543 494d 414c 2220       |"DECIMAL" 
-00024c10: 207c 2249 4e54 2220 207c 0a20 2020 2020   |"INT"  |.     
-00024c20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00024c30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00024c40: 207c 312e 3534 2020 2020 2020 207c 3220   |1.54       |2 
-00024c50: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00024c60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00024c70: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00024c80: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00024c90: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00024ca0: 5f69 665f 7374 7228 636f 6c75 6d6e 2c20  _if_str(column, 
-00024cb0: 2263 6173 7422 290a 2020 2020 7265 7475  "cast").    retu
-00024cc0: 726e 2063 2e63 6173 7428 746f 290a 0a0a  rn c.cast(to)...
-00024cd0: 6465 6620 7472 795f 6361 7374 2863 6f6c  def try_cast(col
-00024ce0: 756d 6e3a 2043 6f6c 756d 6e4f 724e 616d  umn: ColumnOrNam
-00024cf0: 652c 2074 6f3a 2055 6e69 6f6e 5b73 7472  e, to: Union[str
-00024d00: 2c20 4461 7461 5479 7065 5d29 202d 3e20  , DataType]) -> 
-00024d10: 436f 6c75 6d6e 3a0a 2020 2020 2222 2241  Column:.    """A
-00024d20: 2073 7065 6369 616c 2076 6572 7369 6f6e   special version
-00024d30: 206f 6620 4341 5354 2066 6f72 2061 2073   of CAST for a s
-00024d40: 7562 7365 7420 6f66 2064 6174 6120 7479  ubset of data ty
-00024d50: 7065 2063 6f6e 7665 7273 696f 6e73 2e0a  pe conversions..
-00024d60: 2020 2020 4974 2070 6572 666f 726d 7320      It performs 
-00024d70: 7468 6520 7361 6d65 206f 7065 7261 7469  the same operati
-00024d80: 6f6e 2028 692e 652e 2063 6f6e 7665 7274  on (i.e. convert
-00024d90: 7320 6120 7661 6c75 6520 6f66 206f 6e65  s a value of one
-00024da0: 2064 6174 6120 7479 7065 2069 6e74 6f20   data type into 
-00024db0: 616e 6f74 6865 7220 6461 7461 2074 7970  another data typ
-00024dc0: 6529 2c0a 2020 2020 6275 7420 7265 7475  e),.    but retu
-00024dd0: 726e 7320 6120 4e55 4c4c 2076 616c 7565  rns a NULL value
-00024de0: 2069 6e73 7465 6164 206f 6620 7261 6973   instead of rais
-00024df0: 696e 6720 616e 2065 7272 6f72 2077 6865  ing an error whe
-00024e00: 6e20 7468 6520 636f 6e76 6572 7369 6f6e  n the conversion
-00024e10: 2063 616e 206e 6f74 2062 6520 7065 7266   can not be perf
-00024e20: 6f72 6d65 642e 0a0a 2020 2020 5468 6520  ormed...    The 
-00024e30: 6060 636f 6c75 6d6e 6060 2061 7267 756d  ``column`` argum
-00024e40: 656e 7420 6d75 7374 2062 6520 6120 7374  ent must be a st
-00024e50: 7269 6e67 2063 6f6c 756d 6e20 696e 2053  ring column in S
-00024e60: 6e6f 7766 6c61 6b65 2e0a 0a20 2020 2045  nowflake...    E
-00024e70: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00024e80: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00024e90: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-00024ea0: 7065 7320 696d 706f 7274 2049 6e74 6567  pes import Integ
-00024eb0: 6572 5479 7065 2c20 466c 6f61 7454 7970  erType, FloatTyp
-00024ec0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00024ed0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00024ee0: 655f 6461 7461 6672 616d 6528 5b27 3027  e_dataframe(['0'
-00024ef0: 2c20 272d 3132 272c 2027 3232 272c 2027  , '-12', '22', '
-00024f00: 3130 3031 275d 2c20 7363 6865 6d61 3d5b  1001'], schema=[
-00024f10: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00024f20: 3e20 6466 2e73 656c 6563 7428 7472 795f  > df.select(try_
-00024f30: 6361 7374 2863 6f6c 2822 6122 292c 2049  cast(col("a"), I
-00024f40: 6e74 6567 6572 5479 7065 2829 292e 6173  ntegerType()).as
-00024f50: 5f28 2761 6e73 2729 292e 636f 6c6c 6563  _('ans')).collec
-00024f60: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00024f70: 2841 4e53 3d30 292c 2052 6f77 2841 4e53  (ANS=0), Row(ANS
-00024f80: 3d2d 3132 292c 2052 6f77 2841 4e53 3d32  =-12), Row(ANS=2
-00024f90: 3229 2c20 526f 7728 414e 533d 3130 3031  2), Row(ANS=1001
-00024fa0: 295d 0a0a 2020 2020 4578 616d 706c 653a  )]..    Example:
-00024fb0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-00024fc0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00024fd0: 7465 5f64 6174 6166 7261 6d65 285b 2730  te_dataframe(['0
-00024fe0: 2e31 3227 2c20 2755 5344 2032 372e 3930  .12', 'USD 27.90
-00024ff0: 272c 2027 3133 2e39 3720 5553 4427 2c20  ', '13.97 USD', 
-00025000: 27e2 82ac 3937 2e30 272c 2027 3137 2c2d  '...97.0', '17,-
-00025010: 275d 2c20 7363 6865 6d61 3d5b 2261 225d  '], schema=["a"]
-00025020: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00025030: 2e73 656c 6563 7428 7472 795f 6361 7374  .select(try_cast
-00025040: 2863 6f6c 2822 6122 292c 2046 6c6f 6174  (col("a"), Float
-00025050: 5479 7065 2829 292e 6173 5f28 2761 6e73  Type()).as_('ans
-00025060: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
-00025070: 2020 2020 2020 5b52 6f77 2841 4e53 3d30        [Row(ANS=0
-00025080: 2e31 3229 2c20 526f 7728 414e 533d 4e6f  .12), Row(ANS=No
-00025090: 6e65 292c 2052 6f77 2841 4e53 3d4e 6f6e  ne), Row(ANS=Non
-000250a0: 6529 2c20 526f 7728 414e 533d 4e6f 6e65  e), Row(ANS=None
-000250b0: 292c 2052 6f77 2841 4e53 3d4e 6f6e 6529  ), Row(ANS=None)
-000250c0: 5d0a 0a20 2020 2022 2222 0a20 2020 2063  ]..    """.    c
-000250d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000250e0: 7228 636f 6c75 6d6e 2c20 2274 7279 5f63  r(column, "try_c
-000250f0: 6173 7422 290a 2020 2020 7265 7475 726e  ast").    return
-00025100: 2063 2e74 7279 5f63 6173 7428 746f 290a   c.try_cast(to).
-00025110: 0a0a 6465 6620 5f61 735f 6465 6369 6d61  ..def _as_decima
-00025120: 6c5f 6f72 5f6e 756d 6265 7228 0a20 2020  l_or_number(.   
-00025130: 2063 6173 745f 7479 7065 3a20 7374 722c   cast_type: str,
-00025140: 0a20 2020 2076 6172 6961 6e74 3a20 436f  .    variant: Co
-00025150: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
-00025160: 7072 6563 6973 696f 6e3a 204f 7074 696f  precision: Optio
-00025170: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-00025180: 0a20 2020 2073 6361 6c65 3a20 4f70 7469  .    scale: Opti
-00025190: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
-000251a0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-000251b0: 2020 2022 2222 4865 6c70 6572 2066 756e     """Helper fun
-000251c0: 6374 696f 6e20 7468 6174 2063 6173 7473  ction that casts
-000251d0: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
-000251e0: 2074 6f20 6120 6465 6369 6d61 6c20 6f72   to a decimal or
-000251f0: 206e 756d 6265 722e 2222 220a 2020 2020   number.""".    
-00025200: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00025210: 7472 2876 6172 6961 6e74 2c20 6361 7374  tr(variant, cast
-00025220: 5f74 7970 6529 0a20 2020 2069 6620 7363  _type).    if sc
-00025230: 616c 6520 616e 6420 6e6f 7420 7072 6563  ale and not prec
-00025240: 6973 696f 6e3a 0a20 2020 2020 2020 2072  ision:.        r
-00025250: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00025260: 2243 616e 6e6f 7420 6465 6669 6e65 2073  "Cannot define s
-00025270: 6361 6c65 2077 6974 686f 7574 2070 7265  cale without pre
-00025280: 6369 7369 6f6e 2229 0a20 2020 2069 6620  cision").    if 
-00025290: 7072 6563 6973 696f 6e20 616e 6420 7363  precision and sc
-000252a0: 616c 653a 0a20 2020 2020 2020 2072 6574  ale:.        ret
-000252b0: 7572 6e20 6275 696c 7469 6e28 6361 7374  urn builtin(cast
-000252c0: 5f74 7970 6529 2863 2c20 7371 6c5f 6578  _type)(c, sql_ex
-000252d0: 7072 2873 7472 2870 7265 6369 7369 6f6e  pr(str(precision
-000252e0: 2929 2c20 7371 6c5f 6578 7072 2873 7472  )), sql_expr(str
-000252f0: 2873 6361 6c65 2929 290a 2020 2020 656c  (scale))).    el
-00025300: 6966 2070 7265 6369 7369 6f6e 3a0a 2020  if precision:.  
-00025310: 2020 2020 2020 7265 7475 726e 2062 7569        return bui
-00025320: 6c74 696e 2863 6173 745f 7479 7065 2928  ltin(cast_type)(
-00025330: 632c 2073 716c 5f65 7870 7228 7374 7228  c, sql_expr(str(
-00025340: 7072 6563 6973 696f 6e29 2929 0a20 2020  precision))).   
-00025350: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-00025360: 6574 7572 6e20 6275 696c 7469 6e28 6361  eturn builtin(ca
-00025370: 7374 5f74 7970 6529 2863 290a 0a0a 6465  st_type)(c)...de
-00025380: 6620 6173 5f64 6563 696d 616c 280a 2020  f as_decimal(.  
-00025390: 2020 7661 7269 616e 743a 2043 6f6c 756d    variant: Colum
-000253a0: 6e4f 724e 616d 652c 0a20 2020 2070 7265  nOrName,.    pre
-000253b0: 6369 7369 6f6e 3a20 4f70 7469 6f6e 616c  cision: Optional
-000253c0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-000253d0: 2020 7363 616c 653a 204f 7074 696f 6e61    scale: Optiona
-000253e0: 6c5b 696e 745d 203d 204e 6f6e 652c 0a29  l[int] = None,.)
-000253f0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00025400: 2222 2243 6173 7473 2061 2056 4152 4941  """Casts a VARIA
-00025410: 4e54 2076 616c 7565 2074 6f20 6120 6669  NT value to a fi
-00025420: 7865 642d 706f 696e 7420 6465 6369 6d61  xed-point decima
-00025430: 6c20 2864 6f65 7320 6e6f 7420 6d61 7463  l (does not matc
-00025440: 6820 666c 6f61 7469 6e67 2d70 6f69 6e74  h floating-point
-00025450: 2076 616c 7565 7329 2e22 2222 0a20 2020   values).""".   
-00025460: 2072 6574 7572 6e20 5f61 735f 6465 6369   return _as_deci
-00025470: 6d61 6c5f 6f72 5f6e 756d 6265 7228 2261  mal_or_number("a
-00025480: 735f 6465 6369 6d61 6c22 2c20 7661 7269  s_decimal", vari
-00025490: 616e 742c 2070 7265 6369 7369 6f6e 2c20  ant, precision, 
-000254a0: 7363 616c 6529 0a0a 0a64 6566 2061 735f  scale)...def as_
-000254b0: 6e75 6d62 6572 280a 2020 2020 7661 7269  number(.    vari
-000254c0: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
-000254d0: 652c 0a20 2020 2070 7265 6369 7369 6f6e  e,.    precision
-000254e0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-000254f0: 3d20 4e6f 6e65 2c0a 2020 2020 7363 616c  = None,.    scal
-00025500: 653a 204f 7074 696f 6e61 6c5b 696e 745d  e: Optional[int]
-00025510: 203d 204e 6f6e 652c 0a29 202d 3e20 436f   = None,.) -> Co
-00025520: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
-00025530: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
-00025540: 7565 2074 6f20 6120 6669 7865 642d 706f  ue to a fixed-po
-00025550: 696e 7420 6465 6369 6d61 6c20 2864 6f65  int decimal (doe
-00025560: 7320 6e6f 7420 6d61 7463 6820 666c 6f61  s not match floa
-00025570: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
-00025580: 7329 2e22 2222 0a20 2020 2072 6574 7572  s).""".    retur
-00025590: 6e20 5f61 735f 6465 6369 6d61 6c5f 6f72  n _as_decimal_or
-000255a0: 5f6e 756d 6265 7228 2261 735f 6e75 6d62  _number("as_numb
-000255b0: 6572 222c 2076 6172 6961 6e74 2c20 7072  er", variant, pr
-000255c0: 6563 6973 696f 6e2c 2073 6361 6c65 290a  ecision, scale).
-000255d0: 0a0a 6465 6620 6173 5f64 6f75 626c 6528  ..def as_double(
-000255e0: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
-000255f0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00025600: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
-00025610: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
-00025620: 6f20 6120 666c 6f61 7469 6e67 2d70 6f69  o a floating-poi
-00025630: 6e74 2076 616c 7565 2e22 2222 0a20 2020  nt value.""".   
-00025640: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00025650: 7374 7228 7661 7269 616e 742c 2022 6173  str(variant, "as
-00025660: 5f64 6f75 626c 6522 290a 2020 2020 7265  _double").    re
-00025670: 7475 726e 2062 7569 6c74 696e 2822 6173  turn builtin("as
-00025680: 5f64 6f75 626c 6522 2928 6329 0a0a 0a64  _double")(c)...d
-00025690: 6566 2061 735f 7265 616c 2876 6172 6961  ef as_real(varia
-000256a0: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
-000256b0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000256c0: 2022 2222 4361 7374 7320 6120 5641 5249   """Casts a VARI
-000256d0: 414e 5420 7661 6c75 6520 746f 2061 2066  ANT value to a f
-000256e0: 6c6f 6174 696e 672d 706f 696e 7420 7661  loating-point va
-000256f0: 6c75 652e 0a0a 2020 2020 4578 616d 706c  lue...    Exampl
-00025700: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-00025710: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-00025720: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-00025730: 6d70 6f72 7420 5661 7269 616e 7454 7970  mport VariantTyp
-00025740: 652c 2053 7472 7563 7454 7970 652c 2053  e, StructType, S
-00025750: 7472 7563 7446 6965 6c64 2c20 446f 7562  tructField, Doub
-00025760: 6c65 5479 7065 0a20 2020 2020 2020 203e  leType.        >
-00025770: 3e3e 2073 6368 656d 613d 5374 7275 6374  >> schema=Struct
-00025780: 5479 7065 285b 5374 7275 6374 4669 656c  Type([StructFiel
-00025790: 6428 2272 6164 6975 7322 2c20 446f 7562  d("radius", Doub
-000257a0: 6c65 5479 7065 2829 292c 2020 5374 7275  leType()),  Stru
-000257b0: 6374 4669 656c 6428 2272 6164 6975 735f  ctField("radius_
-000257c0: 7622 2c20 5661 7269 616e 7454 7970 6528  v", VariantType(
-000257d0: 2929 5d29 0a20 2020 2020 2020 203e 3e3e  ))]).        >>>
-000257e0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000257f0: 6561 7465 5f64 6174 6166 7261 6d65 2864  eate_dataframe(d
-00025800: 6174 613d 5b5b 322e 302c 204e 6f6e 655d  ata=[[2.0, None]
-00025810: 5d2c 2073 6368 656d 613d 7363 6865 6d61  ], schema=schema
-00025820: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00025830: 2e72 6164 6975 735f 7620 3d20 746f 5f76  .radius_v = to_v
-00025840: 6172 6961 6e74 2864 662e 7261 6469 7573  ariant(df.radius
-00025850: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00025860: 2e73 656c 6563 7428 6466 2e72 6164 6975  .select(df.radiu
-00025870: 735f 762e 6173 5f28 2272 6164 6975 735f  s_v.as_("radius_
-00025880: 7622 292c 2064 662e 7261 6469 7573 292e  v"), df.radius).
-00025890: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000258a0: 2020 5b52 6f77 2852 4144 4955 535f 563d    [Row(RADIUS_V=
-000258b0: 2732 2e30 3030 3030 3030 3030 3030 3030  '2.0000000000000
-000258c0: 3030 652b 3030 272c 2052 4144 4955 533d  00e+00', RADIUS=
-000258d0: 322e 3029 5d0a 2020 2020 2020 2020 3e3e  2.0)].        >>
-000258e0: 3e20 6466 2e73 656c 6563 7428 6173 5f72  > df.select(as_r
-000258f0: 6561 6c28 6466 2e72 6164 6975 735f 7629  eal(df.radius_v)
-00025900: 2e61 735f 2822 7265 616c 5f72 6164 6975  .as_("real_radiu
-00025910: 735f 7622 292c 2064 662e 7261 6469 7573  s_v"), df.radius
-00025920: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00025930: 2020 2020 5b52 6f77 2852 4541 4c5f 5241      [Row(REAL_RA
-00025940: 4449 5553 5f56 3d32 2e30 2c20 5241 4449  DIUS_V=2.0, RADI
-00025950: 5553 3d32 2e30 295d 0a20 2020 2022 2222  US=2.0)].    """
-00025960: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00025970: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
-00025980: 2022 6173 5f72 6561 6c22 290a 2020 2020   "as_real").    
-00025990: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000259a0: 6173 5f72 6561 6c22 2928 6329 0a0a 0a64  as_real")(c)...d
-000259b0: 6566 2061 735f 696e 7465 6765 7228 7661  ef as_integer(va
-000259c0: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
-000259d0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-000259e0: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
-000259f0: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
-00025a00: 616e 2069 6e74 6567 6572 2e22 2222 0a20  an integer.""". 
-00025a10: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00025a20: 665f 7374 7228 7661 7269 616e 742c 2022  f_str(variant, "
-00025a30: 6173 5f69 6e74 6567 6572 2229 0a20 2020  as_integer").   
-00025a40: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00025a50: 2261 735f 696e 7465 6765 7222 2928 6329  "as_integer")(c)
-00025a60: 0a0a 0a64 6566 2061 735f 6f62 6a65 6374  ...def as_object
-00025a70: 2876 6172 6961 6e74 3a20 436f 6c75 6d6e  (variant: Column
-00025a80: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00025a90: 6e3a 0a20 2020 2022 2222 4361 7374 7320  n:.    """Casts 
-00025aa0: 6120 5641 5249 414e 5420 7661 6c75 6520  a VARIANT value 
-00025ab0: 746f 2061 6e20 6f62 6a65 6374 2e22 2222  to an object."""
-00025ac0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00025ad0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
-00025ae0: 2022 6173 5f6f 626a 6563 7422 290a 2020   "as_object").  
-00025af0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00025b00: 2822 6173 5f6f 626a 6563 7422 2928 6329  ("as_object")(c)
-00025b10: 0a0a 0a64 6566 2061 735f 7469 6d65 2876  ...def as_time(v
-00025b20: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-00025b30: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00025b40: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
-00025b50: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-00025b60: 2061 2074 696d 6520 7661 6c75 652e 0a0a   a time value...
-00025b70: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00025b80: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00025b90: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00025ba0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-00025bb0: 6f72 7420 6173 5f74 696d 652c 2074 6f5f  ort as_time, to_
-00025bc0: 7661 7269 616e 740a 2020 2020 2020 2020  variant.        
-00025bd0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00025be0: 2e73 716c 2822 7365 6c65 6374 2054 4f5f  .sql("select TO_
-00025bf0: 5449 4d45 2827 3132 3a33 343a 3536 2729  TIME('12:34:56')
-00025c00: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
-00025c10: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
-00025c20: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
-00025c30: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
-00025c40: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00025c50: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
-00025c60: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-00025c70: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-00025c80: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-00025c90: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
-00025ca0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00025cb0: 2e73 656c 6563 7428 6173 5f74 696d 6528  .select(as_time(
-00025cc0: 6466 2e61 6c61 726d 5f76 292e 6173 5f28  df.alarm_v).as_(
-00025cd0: 2261 6c61 726d 2229 292e 636f 6c6c 6563  "alarm")).collec
-00025ce0: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
-00025cf0: 2864 662e 616c 6172 6d29 2e63 6f6c 6c65  (df.alarm).colle
-00025d00: 6374 2829 0a20 2020 2020 2020 2054 7275  ct().        Tru
-00025d10: 650a 2020 2020 2222 220a 2020 2020 6320  e.    """.    c 
-00025d20: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00025d30: 2876 6172 6961 6e74 2c20 2261 735f 7469  (variant, "as_ti
-00025d40: 6d65 2229 0a20 2020 2072 6574 7572 6e20  me").    return 
-00025d50: 6275 696c 7469 6e28 2261 735f 7469 6d65  builtin("as_time
-00025d60: 2229 2863 290a 0a0a 6465 6620 6173 5f74  ")(c)...def as_t
-00025d70: 696d 6573 7461 6d70 5f6c 747a 2876 6172  imestamp_ltz(var
-00025d80: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
-00025d90: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00025da0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
-00025db0: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-00025dc0: 2054 494d 4553 5441 4d50 2077 6974 6820   TIMESTAMP with 
-00025dd0: 6120 6c6f 6361 6c20 7469 6d65 7a6f 6e65  a local timezone
-00025de0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00025df0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00025e00: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00025e10: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
-00025e20: 696d 706f 7274 2061 735f 7469 6d65 7374  import as_timest
-00025e30: 616d 705f 6c74 7a2c 2074 6f5f 7661 7269  amp_ltz, to_vari
-00025e40: 616e 740a 2020 2020 2020 2020 3e3e 3e20  ant.        >>> 
-00025e50: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-00025e60: 2822 7365 6c65 6374 2054 4f5f 5449 4d45  ("select TO_TIME
-00025e70: 5354 414d 505f 4c54 5a28 2732 3031 382d  STAMP_LTZ('2018-
-00025e80: 3130 2d31 3020 3132 3a33 343a 3536 2729  10-10 12:34:56')
-00025e90: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
-00025ea0: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
-00025eb0: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
-00025ec0: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
-00025ed0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00025ee0: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
-00025ef0: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-00025f00: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-00025f10: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-00025f20: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
-00025f30: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00025f40: 2e73 656c 6563 7428 6173 5f74 696d 6573  .select(as_times
-00025f50: 7461 6d70 5f6c 747a 2864 662e 616c 6172  tamp_ltz(df.alar
-00025f60: 6d5f 7629 2e61 735f 2822 616c 6172 6d22  m_v).as_("alarm"
-00025f70: 2929 2e63 6f6c 6c65 6374 2829 203d 3d20  )).collect() == 
-00025f80: 6466 2e73 656c 6563 7428 6466 2e61 6c61  df.select(df.ala
-00025f90: 726d 292e 636f 6c6c 6563 7428 290a 2020  rm).collect().  
-00025fa0: 2020 2020 2020 5472 7565 0a20 2020 2022        True.    "
-00025fb0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00025fc0: 6f6c 5f69 665f 7374 7228 7661 7269 616e  ol_if_str(varian
-00025fd0: 742c 2022 6173 5f74 696d 6573 7461 6d70  t, "as_timestamp
-00025fe0: 5f6c 747a 2229 0a20 2020 2072 6574 7572  _ltz").    retur
-00025ff0: 6e20 6275 696c 7469 6e28 2261 735f 7469  n builtin("as_ti
-00026000: 6d65 7374 616d 705f 6c74 7a22 2928 6329  mestamp_ltz")(c)
-00026010: 0a0a 0a64 6566 2061 735f 7469 6d65 7374  ...def as_timest
-00026020: 616d 705f 6e74 7a28 7661 7269 616e 743a  amp_ntz(variant:
-00026030: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00026040: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00026050: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
-00026060: 2076 616c 7565 2074 6f20 6120 5449 4d45   value to a TIME
-00026070: 5354 414d 5020 7769 7468 206e 6f20 7469  STAMP with no ti
-00026080: 6d65 7a6f 6e65 2e0a 0a20 2020 2045 7861  mezone...    Exa
-00026090: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-000260a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-000260b0: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-000260c0: 7469 6f6e 7320 696d 706f 7274 2061 735f  tions import as_
-000260d0: 7469 6d65 7374 616d 705f 6e74 7a2c 2074  timestamp_ntz, t
-000260e0: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
-000260f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00026100: 6f6e 2e73 716c 2822 7365 6c65 6374 2054  on.sql("select T
-00026110: 4f5f 5449 4d45 5354 414d 505f 4e54 5a28  O_TIMESTAMP_NTZ(
-00026120: 2732 3031 382d 3130 2d31 3020 3132 3a33  '2018-10-10 12:3
-00026130: 343a 3536 2729 2061 7320 616c 6172 6d22  4:56') as alarm"
-00026140: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00026150: 2e61 6c61 726d 5f76 203d 2074 6f5f 7661  .alarm_v = to_va
-00026160: 7269 616e 7428 6466 2e61 6c61 726d 290a  riant(df.alarm).
-00026170: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00026180: 656c 6563 7428 6466 2e61 6c61 726d 5f76  elect(df.alarm_v
-00026190: 2e61 735f 2822 616c 6172 6d22 2929 2e63  .as_("alarm")).c
-000261a0: 6f6c 6c65 6374 2829 203d 3d20 6466 2e73  ollect() == df.s
-000261b0: 656c 6563 7428 6466 2e61 6c61 726d 292e  elect(df.alarm).
-000261c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000261d0: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
-000261e0: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
-000261f0: 5f74 696d 6573 7461 6d70 5f6e 747a 2864  _timestamp_ntz(d
-00026200: 662e 616c 6172 6d5f 7629 2e61 735f 2822  f.alarm_v).as_("
-00026210: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-00026220: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-00026230: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-00026240: 7428 290a 2020 2020 2020 2020 5472 7565  t().        True
-00026250: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00026260: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00026270: 7661 7269 616e 742c 2022 6173 5f74 696d  variant, "as_tim
-00026280: 6573 7461 6d70 5f6e 747a 2229 0a20 2020  estamp_ntz").   
-00026290: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000262a0: 2261 735f 7469 6d65 7374 616d 705f 6e74  "as_timestamp_nt
-000262b0: 7a22 2928 6329 0a0a 0a64 6566 2061 735f  z")(c)...def as_
-000262c0: 7469 6d65 7374 616d 705f 747a 2876 6172  timestamp_tz(var
-000262d0: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
-000262e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-000262f0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
-00026300: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-00026310: 2054 494d 4553 5441 4d50 2077 6974 6820   TIMESTAMP with 
-00026320: 6120 7469 6d65 7a6f 6e65 2e0a 0a20 2020  a timezone...   
-00026330: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00026340: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00026350: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00026360: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00026370: 2061 735f 7469 6d65 7374 616d 705f 747a   as_timestamp_tz
-00026380: 2c20 746f 5f76 6172 6961 6e74 0a20 2020  , to_variant.   
-00026390: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000263a0: 7373 696f 6e2e 7371 6c28 2273 656c 6563  ssion.sql("selec
-000263b0: 7420 544f 5f54 494d 4553 5441 4d50 5f54  t TO_TIMESTAMP_T
-000263c0: 5a28 2732 3031 382d 3130 2d31 3020 3132  Z('2018-10-10 12
-000263d0: 3a33 343a 3536 202b 3030 3030 2729 2061  :34:56 +0000') a
-000263e0: 7320 616c 6172 6d22 290a 2020 2020 2020  s alarm").      
-000263f0: 2020 3e3e 3e20 6466 2e61 6c61 726d 5f76    >>> df.alarm_v
-00026400: 203d 2074 6f5f 7661 7269 616e 7428 6466   = to_variant(df
-00026410: 2e61 6c61 726d 290a 2020 2020 2020 2020  .alarm).        
-00026420: 3e3e 3e20 6466 2e73 656c 6563 7428 6466  >>> df.select(df
-00026430: 2e61 6c61 726d 5f76 2e61 735f 2822 616c  .alarm_v.as_("al
-00026440: 6172 6d22 2929 2e63 6f6c 6c65 6374 2829  arm")).collect()
-00026450: 203d 3d20 6466 2e73 656c 6563 7428 6466   == df.select(df
-00026460: 2e61 6c61 726d 292e 636f 6c6c 6563 7428  .alarm).collect(
-00026470: 290a 2020 2020 2020 2020 4661 6c73 650a  ).        False.
-00026480: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00026490: 656c 6563 7428 6173 5f74 696d 6573 7461  elect(as_timesta
-000264a0: 6d70 5f74 7a28 6466 2e61 6c61 726d 5f76  mp_tz(df.alarm_v
-000264b0: 292e 6173 5f28 2261 6c61 726d 2229 292e  ).as_("alarm")).
-000264c0: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
-000264d0: 7365 6c65 6374 2864 662e 616c 6172 6d29  select(df.alarm)
-000264e0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000264f0: 2020 2054 7275 650a 2020 2020 2222 220a     True.    """.
-00026500: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00026510: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
-00026520: 2261 735f 7469 6d65 7374 616d 705f 747a  "as_timestamp_tz
-00026530: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00026540: 696c 7469 6e28 2261 735f 7469 6d65 7374  iltin("as_timest
-00026550: 616d 705f 747a 2229 2863 290a 0a0a 6465  amp_tz")(c)...de
-00026560: 6620 746f 5f62 696e 6172 7928 653a 2043  f to_binary(e: C
-00026570: 6f6c 756d 6e4f 724e 616d 652c 2066 6d74  olumnOrName, fmt
-00026580: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00026590: 3d20 4e6f 6e65 2920 2d3e 2043 6f6c 756d  = None) -> Colum
-000265a0: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
-000265b0: 7473 2074 6865 2069 6e70 7574 2065 7870  ts the input exp
-000265c0: 7265 7373 696f 6e20 746f 2061 2062 696e  ression to a bin
-000265d0: 6172 7920 7661 6c75 652e 2046 6f72 204e  ary value. For N
-000265e0: 554c 4c20 696e 7075 742c 2074 6865 206f  ULL input, the o
-000265f0: 7574 7075 7420 6973 204e 554c 4c2e 0a0a  utput is NULL...
-00026600: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00026610: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00026620: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00026630: 6174 6166 7261 6d65 285b 2730 3027 2c20  ataframe(['00', 
-00026640: 2736 3727 2c20 2730 3331 3227 5d2c 2073  '67', '0312'], s
-00026650: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
-00026660: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00026670: 6374 2874 6f5f 6269 6e61 7279 2863 6f6c  ct(to_binary(col
-00026680: 2827 6127 2929 2e61 735f 2827 616e 7327  ('a')).as_('ans'
-00026690: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-000266a0: 2020 2020 205b 526f 7728 414e 533d 6279       [Row(ANS=by
-000266b0: 7465 6172 7261 7928 6227 5c5c 7830 3027  tearray(b'\\x00'
-000266c0: 2929 2c20 526f 7728 414e 533d 6279 7465  )), Row(ANS=byte
-000266d0: 6172 7261 7928 6227 6727 2929 2c20 526f  array(b'g')), Ro
-000266e0: 7728 414e 533d 6279 7465 6172 7261 7928  w(ANS=bytearray(
-000266f0: 6227 5c5c 7830 335c 5c78 3132 2729 295d  b'\\x03\\x12'))]
-00026700: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00026710: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00026720: 655f 6461 7461 6672 616d 6528 5b27 6147  e_dataframe(['aG
-00026730: 5673 6247 383d 272c 2027 6432 3979 6247  VsbG8=', 'd29ybG
-00026740: 513d 272c 2027 4951 3d3d 275d 2c20 7363  Q=', 'IQ=='], sc
-00026750: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
-00026760: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00026770: 7428 746f 5f62 696e 6172 7928 636f 6c28  t(to_binary(col(
-00026780: 2761 2729 2c20 2742 4153 4536 3427 292e  'a'), 'BASE64').
-00026790: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
-000267a0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-000267b0: 6f77 2841 4e53 3d62 7974 6561 7272 6179  ow(ANS=bytearray
-000267c0: 2862 2768 656c 6c6f 2729 292c 2052 6f77  (b'hello')), Row
-000267d0: 2841 4e53 3d62 7974 6561 7272 6179 2862  (ANS=bytearray(b
-000267e0: 2777 6f72 6c64 2729 292c 2052 6f77 2841  'world')), Row(A
-000267f0: 4e53 3d62 7974 6561 7272 6179 2862 2721  NS=bytearray(b'!
-00026800: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
-00026810: 3e20 6466 2e73 656c 6563 7428 746f 5f62  > df.select(to_b
-00026820: 696e 6172 7928 636f 6c28 2761 2729 2c20  inary(col('a'), 
-00026830: 2755 5446 2d38 2729 2e61 735f 2827 616e  'UTF-8').as_('an
-00026840: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
-00026850: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-00026860: 6279 7465 6172 7261 7928 6227 6147 5673  bytearray(b'aGVs
-00026870: 6247 383d 2729 292c 2052 6f77 2841 4e53  bG8=')), Row(ANS
-00026880: 3d62 7974 6561 7272 6179 2862 2764 3239  =bytearray(b'd29
-00026890: 7962 4751 3d27 2929 2c20 526f 7728 414e  ybGQ=')), Row(AN
-000268a0: 533d 6279 7465 6172 7261 7928 6227 4951  S=bytearray(b'IQ
-000268b0: 3d3d 2729 295d 0a20 2020 2022 2222 0a20  =='))].    """. 
-000268c0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-000268d0: 665f 7374 7228 652c 2022 746f 5f62 696e  f_str(e, "to_bin
-000268e0: 6172 7922 290a 2020 2020 7265 7475 726e  ary").    return
-000268f0: 2062 7569 6c74 696e 2822 746f 5f62 696e   builtin("to_bin
-00026900: 6172 7922 2928 632c 2066 6d74 2920 6966  ary")(c, fmt) if
-00026910: 2066 6d74 2065 6c73 6520 6275 696c 7469   fmt else builti
-00026920: 6e28 2274 6f5f 6269 6e61 7279 2229 2863  n("to_binary")(c
-00026930: 290a 0a0a 6465 6620 746f 5f61 7272 6179  )...def to_array
-00026940: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00026950: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00026960: 2022 2222 436f 6e76 6572 7473 2061 6e79   """Converts any
-00026970: 2076 616c 7565 2074 6f20 616e 2041 5252   value to an ARR
-00026980: 4159 2076 616c 7565 206f 7220 4e55 4c4c  AY value or NULL
-00026990: 2028 6966 2069 6e70 7574 2069 7320 4e55   (if input is NU
-000269a0: 4c4c 292e 0a0a 2020 2020 4578 616d 706c  LL)...    Exampl
-000269b0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-000269c0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000269d0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-000269e0: 312c 2032 2c20 332c 2034 5d2c 2073 6368  1, 2, 3, 4], sch
-000269f0: 656d 613d 5b27 6127 5d29 0a20 2020 2020  ema=['a']).     
-00026a00: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00026a10: 2874 6f5f 6172 7261 7928 636f 6c28 2761  (to_array(col('a
-00026a20: 2729 292e 6173 5f28 2761 6e73 2729 292e  ')).as_('ans')).
-00026a30: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00026a40: 2020 5b52 6f77 2841 4e53 3d27 5b5c 5c6e    [Row(ANS='[\\n
-00026a50: 2020 315c 5c6e 5d27 292c 2052 6f77 2841    1\\n]'), Row(A
-00026a60: 4e53 3d27 5b5c 5c6e 2020 325c 5c6e 5d27  NS='[\\n  2\\n]'
-00026a70: 292c 2052 6f77 2841 4e53 3d27 5b5c 5c6e  ), Row(ANS='[\\n
-00026a80: 2020 335c 5c6e 5d27 292c 2052 6f77 2841    3\\n]'), Row(A
-00026a90: 4e53 3d27 5b5c 5c6e 2020 345c 5c6e 5d27  NS='[\\n  4\\n]'
-00026aa0: 295d 0a0a 0a20 2020 2020 2020 203e 3e3e  )]...        >>>
-00026ab0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-00026ac0: 736e 6f77 7061 726b 2069 6d70 6f72 7420  snowpark import 
-00026ad0: 526f 770a 2020 2020 2020 2020 3e3e 3e20  Row.        >>> 
-00026ae0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00026af0: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
-00026b00: 6f77 2861 3d5b 312c 2032 2c20 335d 292c  ow(a=[1, 2, 3]),
-00026b10: 2052 6f77 2861 3d4e 6f6e 6529 5d29 0a20   Row(a=None)]). 
-00026b20: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00026b30: 6c65 6374 2874 6f5f 6172 7261 7928 636f  lect(to_array(co
-00026b40: 6c28 2761 2729 292e 6173 5f28 2761 6e73  l('a')).as_('ans
-00026b50: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
-00026b60: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-00026b70: 5b5c 5c6e 2020 312c 5c5c 6e20 2032 2c5c  [\\n  1,\\n  2,\
-00026b80: 5c6e 2020 335c 5c6e 5d27 292c 2052 6f77  \n  3\\n]'), Row
-00026b90: 2841 4e53 3d4e 6f6e 6529 5d0a 2020 2020  (ANS=None)].    
-00026ba0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00026bb0: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
-00026bc0: 6f5f 6172 7261 7922 290a 2020 2020 7265  o_array").    re
-00026bd0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
-00026be0: 5f61 7272 6179 2229 2863 290a 0a0a 6465  _array")(c)...de
-00026bf0: 6620 746f 5f6a 736f 6e28 653a 2043 6f6c  f to_json(e: Col
-00026c00: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00026c10: 6c75 6d6e 3a0a 2020 2020 2222 2243 6f6e  lumn:.    """Con
-00026c20: 7665 7274 7320 616e 7920 5641 5249 414e  verts any VARIAN
-00026c30: 5420 7661 6c75 6520 746f 2061 2073 7472  T value to a str
-00026c40: 696e 6720 636f 6e74 6169 6e69 6e67 2074  ing containing t
-00026c50: 6865 204a 534f 4e20 7265 7072 6573 656e  he JSON represen
-00026c60: 7461 7469 6f6e 206f 6620 7468 650a 2020  tation of the.  
-00026c70: 2020 7661 6c75 652e 2049 6620 7468 6520    value. If the 
-00026c80: 696e 7075 7420 6973 204e 554c 4c2c 2074  input is NULL, t
-00026c90: 6865 2072 6573 756c 7420 6973 2061 6c73  he result is als
-00026ca0: 6f20 4e55 4c4c 2e0a 0a20 2020 2045 7861  o NULL...    Exa
-00026cb0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-00026cc0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00026cd0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00026ce0: 2069 6d70 6f72 7420 5661 7269 616e 7454   import VariantT
-00026cf0: 7970 652c 2053 7472 7563 7446 6965 6c64  ype, StructField
-00026d00: 2c20 5374 7275 6374 5479 7065 0a20 2020  , StructType.   
-00026d10: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00026d20: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00026d30: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
-00026d40: 2020 2020 3e3e 3e20 7363 6865 6d61 203d      >>> schema =
-00026d50: 2053 7472 7563 7454 7970 6528 5b53 7472   StructType([Str
-00026d60: 7563 7446 6965 6c64 2822 6122 2c20 5661  uctField("a", Va
-00026d70: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
-00026d80: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00026d90: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00026da0: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
-00026db0: 4e6f 6e65 292c 526f 7728 613d 3132 292c  None),Row(a=12),
-00026dc0: 526f 7728 613d 332e 3134 3129 2c52 6f77  Row(a=3.141),Row
-00026dd0: 2861 3d7b 2761 273a 3130 2c27 6227 3a32  (a={'a':10,'b':2
-00026de0: 307d 292c 526f 7728 613d 5b31 2c32 332c  0}),Row(a=[1,23,
-00026df0: 3435 365d 295d 2c20 7363 6865 6d61 3d73  456])], schema=s
-00026e00: 6368 656d 6129 0a20 2020 2020 2020 203e  chema).        >
-00026e10: 3e3e 2064 662e 7365 6c65 6374 2874 6f5f  >> df.select(to_
-00026e20: 6a73 6f6e 2863 6f6c 2822 6122 2929 2e61  json(col("a")).a
-00026e30: 735f 2827 616e 7327 2929 2e63 6f6c 6c65  s_('ans')).colle
-00026e40: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00026e50: 7728 414e 533d 4e6f 6e65 292c 2052 6f77  w(ANS=None), Row
-00026e60: 2841 4e53 3d27 3132 2729 2c20 526f 7728  (ANS='12'), Row(
-00026e70: 414e 533d 2733 2e31 3431 2729 2c20 526f  ANS='3.141'), Ro
-00026e80: 7728 414e 533d 277b 2261 223a 3130 2c22  w(ANS='{"a":10,"
-00026e90: 6222 3a32 307d 2729 2c20 526f 7728 414e  b":20}'), Row(AN
-00026ea0: 533d 275b 312c 3233 2c34 3536 5d27 295d  S='[1,23,456]')]
-00026eb0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00026ec0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00026ed0: 652c 2022 746f 5f6a 736f 6e22 290a 2020  e, "to_json").  
-00026ee0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00026ef0: 2822 746f 5f6a 736f 6e22 2928 6329 0a0a  ("to_json")(c)..
-00026f00: 0a64 6566 2074 6f5f 6f62 6a65 6374 2865  .def to_object(e
-00026f10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00026f20: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00026f30: 2222 436f 6e76 6572 7473 2061 6e79 2076  ""Converts any v
-00026f40: 616c 7565 2074 6f20 6120 4f42 4a45 4354  alue to a OBJECT
-00026f50: 2076 616c 7565 206f 7220 4e55 4c4c 2028   value or NULL (
-00026f60: 6966 2069 6e70 7574 2069 7320 4e55 4c4c  if input is NULL
-00026f70: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
-00026f80: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-00026f90: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00026fa0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-00026fb0: 7274 2056 6172 6961 6e74 5479 7065 2c20  rt VariantType, 
-00026fc0: 5374 7275 6374 4669 656c 642c 2053 7472  StructField, Str
-00026fd0: 7563 7454 7970 650a 2020 2020 2020 2020  uctType.        
-00026fe0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00026ff0: 6b65 2e73 6e6f 7770 6172 6b20 696d 706f  ke.snowpark impo
-00027000: 7274 2052 6f77 0a20 2020 2020 2020 203e  rt Row.        >
-00027010: 3e3e 2073 6368 656d 6120 3d20 5374 7275  >> schema = Stru
-00027020: 6374 5479 7065 285b 5374 7275 6374 4669  ctType([StructFi
-00027030: 656c 6428 2261 222c 2056 6172 6961 6e74  eld("a", Variant
-00027040: 5479 7065 2829 295d 290a 2020 2020 2020  Type())]).      
-00027050: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00027060: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00027070: 616d 6528 5b22 7b27 6127 3a31 302c 2762  ame(["{'a':10,'b
-00027080: 273a 3230 7d22 2c20 4e6f 6e65 5d2c 2073  ':20}", None], s
-00027090: 6368 656d 613d 7363 6865 6d61 290a 2020  chema=schema).  
-000270a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000270b0: 6563 7428 746f 5f6f 626a 6563 7428 636f  ect(to_object(co
-000270c0: 6c28 2261 2229 292e 6173 5f28 2761 6e73  l("a")).as_('ans
-000270d0: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
-000270e0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-000270f0: 7b5c 5c6e 2020 2261 223a 2031 302c 5c5c  {\\n  "a": 10,\\
-00027100: 6e20 2022 6222 3a20 3230 5c5c 6e7d 2729  n  "b": 20\\n}')
-00027110: 2c20 526f 7728 414e 533d 4e6f 6e65 295d  , Row(ANS=None)]
-00027120: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00027130: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00027140: 652c 2022 746f 5f6f 626a 6563 7422 290a  e, "to_object").
-00027150: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00027160: 696e 2822 746f 5f6f 626a 6563 7422 2928  in("to_object")(
-00027170: 6329 0a0a 0a64 6566 2074 6f5f 7661 7269  c)...def to_vari
-00027180: 616e 7428 653a 2043 6f6c 756d 6e4f 724e  ant(e: ColumnOrN
-00027190: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-000271a0: 2020 2020 2222 2243 6f6e 7665 7274 7320      """Converts 
-000271b0: 616e 7920 7661 6c75 6520 746f 2061 2056  any value to a V
-000271c0: 4152 4941 4e54 2076 616c 7565 206f 7220  ARIANT value or 
-000271d0: 4e55 4c4c 2028 6966 2069 6e70 7574 2069  NULL (if input i
-000271e0: 7320 4e55 4c4c 292e 0a0a 2020 2020 4578  s NULL)...    Ex
-000271f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00027200: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00027210: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00027220: 6d65 285b 312c 2032 2c20 332c 2034 5d2c  me([1, 2, 3, 4],
-00027230: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
-00027240: 2020 2020 2020 203e 3e3e 2064 665f 636f         >>> df_co
-00027250: 6e76 203d 2064 662e 7365 6c65 6374 2874  nv = df.select(t
-00027260: 6f5f 7661 7269 616e 7428 636f 6c28 2261  o_variant(col("a
-00027270: 2229 292e 6173 5f28 2261 6e73 2229 290a  ")).as_("ans")).
-00027280: 2020 2020 2020 2020 3e3e 3e20 6466 5f63          >>> df_c
-00027290: 6f6e 762e 636f 6c6c 6563 7428 290a 2020  onv.collect().  
-000272a0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-000272b0: 3127 292c 2052 6f77 2841 4e53 3d27 3227  1'), Row(ANS='2'
-000272c0: 292c 2052 6f77 2841 4e53 3d27 3327 292c  ), Row(ANS='3'),
-000272d0: 2052 6f77 2841 4e53 3d27 3427 295d 0a0a   Row(ANS='4')]..
-000272e0: 2020 2020 2020 2020 4166 7465 7220 636f          After co
-000272f0: 6e76 6572 7369 6f6e 2076 6961 2074 6f5f  nversion via to_
-00027300: 7661 7269 616e 742c 2061 6e6f 7468 6572  variant, another
-00027310: 2076 6172 6961 6e74 2064 6174 6166 7261   variant datafra
-00027320: 6d65 2063 616e 2062 6520 6d65 7267 6564  me can be merged
-00027330: 2e0a 0a20 2020 2020 2020 203e 3e3e 2066  ...        >>> f
-00027340: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00027350: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-00027360: 6f72 7420 5661 7269 616e 7454 7970 652c  ort VariantType,
-00027370: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
-00027380: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
-00027390: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-000273a0: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
-000273b0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
-000273c0: 3e3e 3e20 7363 6865 6d61 203d 2053 7472  >>> schema = Str
-000273d0: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
-000273e0: 6965 6c64 2822 6122 2c20 5661 7269 616e  ield("a", Varian
-000273f0: 7454 7970 6528 2929 5d29 0a20 2020 2020  tType())]).     
-00027400: 2020 203e 3e3e 2064 665f 6f74 6865 7220     >>> df_other 
-00027410: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00027420: 5f64 6174 6166 7261 6d65 285b 526f 7728  _dataframe([Row(
-00027430: 613d 3130 292c 2052 6f77 2861 3d27 7465  a=10), Row(a='te
-00027440: 7374 2729 2c20 526f 7728 613d 7b27 6127  st'), Row(a={'a'
-00027450: 3a20 3130 2c20 2762 273a 2032 307d 292c  : 10, 'b': 20}),
-00027460: 2052 6f77 2861 3d5b 312c 2032 2c20 335d   Row(a=[1, 2, 3]
-00027470: 295d 2c20 7363 6865 6d61 3d73 6368 656d  )], schema=schem
-00027480: 6129 0a20 2020 2020 2020 203e 3e3e 2064  a).        >>> d
-00027490: 665f 636f 6e76 2e75 6e69 6f6e 2864 665f  f_conv.union(df_
-000274a0: 6f74 6865 7229 2e73 656c 6563 7428 7479  other).select(ty
-000274b0: 7065 6f66 2863 6f6c 2822 616e 7322 2929  peof(col("ans"))
-000274c0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
-000274d0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000274e0: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
-000274f0: 2729 2c20 526f 7728 414e 533d 2749 4e54  '), Row(ANS='INT
-00027500: 4547 4552 2729 2c20 526f 7728 414e 533d  EGER'), Row(ANS=
-00027510: 2749 4e54 4547 4552 2729 2c20 526f 7728  'INTEGER'), Row(
-00027520: 414e 533d 2749 4e54 4547 4552 2729 2c20  ANS='INTEGER'), 
-00027530: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
-00027540: 2729 2c20 526f 7728 414e 533d 2756 4152  '), Row(ANS='VAR
-00027550: 4348 4152 2729 2c20 526f 7728 414e 533d  CHAR'), Row(ANS=
-00027560: 274f 424a 4543 5427 292c 2052 6f77 2841  'OBJECT'), Row(A
-00027570: 4e53 3d27 4152 5241 5927 295d 0a20 2020  NS='ARRAY')].   
-00027580: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00027590: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-000275a0: 746f 5f76 6172 6961 6e74 2229 0a20 2020  to_variant").   
-000275b0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000275c0: 2274 6f5f 7661 7269 616e 7422 2928 6329  "to_variant")(c)
-000275d0: 0a0a 0a64 6566 2074 6f5f 786d 6c28 653a  ...def to_xml(e:
-000275e0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-000275f0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00027600: 2243 6f6e 7665 7274 7320 616e 7920 5641  "Converts any VA
-00027610: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-00027620: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
-00027630: 6e67 2074 6865 2058 4d4c 2072 6570 7265  ng the XML repre
-00027640: 7365 6e74 6174 696f 6e20 6f66 2074 6865  sentation of the
-00027650: 0a20 2020 2076 616c 7565 2e20 4966 2074  .    value. If t
-00027660: 6865 2069 6e70 7574 2069 7320 4e55 4c4c  he input is NULL
-00027670: 2c20 7468 6520 7265 7375 6c74 2069 7320  , the result is 
-00027680: 616c 736f 204e 554c 4c2e 0a0a 2020 2020  also NULL...    
-00027690: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-000276a0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-000276b0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-000276c0: 7065 7320 696d 706f 7274 2056 6172 6961  pes import Varia
-000276d0: 6e74 5479 7065 2c20 5374 7275 6374 4669  ntType, StructFi
-000276e0: 656c 642c 2053 7472 7563 7454 7970 650a  eld, StructType.
-000276f0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00027700: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00027710: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
-00027720: 2020 2020 2020 203e 3e3e 2073 6368 656d         >>> schem
-00027730: 6120 3d20 5374 7275 6374 5479 7065 285b  a = StructType([
-00027740: 5374 7275 6374 4669 656c 6428 2261 222c  StructField("a",
-00027750: 2056 6172 6961 6e74 5479 7065 2829 295d   VariantType())]
-00027760: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00027770: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00027780: 655f 6461 7461 6672 616d 6528 5b52 6f77  e_dataframe([Row
-00027790: 2861 3d31 3029 2c20 526f 7728 613d 2774  (a=10), Row(a='t
-000277a0: 6573 7427 292c 2052 6f77 2861 3d7b 2761  est'), Row(a={'a
-000277b0: 273a 2031 302c 2027 6227 3a20 3230 7d29  ': 10, 'b': 20})
-000277c0: 2c20 526f 7728 613d 5b31 2c20 322c 2033  , Row(a=[1, 2, 3
-000277d0: 5d29 5d2c 2073 6368 656d 613d 7363 6865  ])], schema=sche
-000277e0: 6d61 290a 2020 2020 2020 2020 3e3e 3e20  ma).        >>> 
-000277f0: 6466 2e73 656c 6563 7428 746f 5f78 6d6c  df.select(to_xml
-00027800: 2863 6f6c 2822 4122 2929 2e61 735f 2822  (col("A")).as_("
-00027810: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
-00027820: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-00027830: 533d 273c 536e 6f77 666c 616b 6544 6174  S='<SnowflakeDat
-00027840: 6120 7479 7065 3d22 494e 5445 4745 5222  a type="INTEGER"
-00027850: 3e31 303c 2f53 6e6f 7766 6c61 6b65 4461  >10</SnowflakeDa
-00027860: 7461 3e27 292c 2052 6f77 2841 4e53 3d27  ta>'), Row(ANS='
-00027870: 3c53 6e6f 7766 6c61 6b65 4461 7461 2074  <SnowflakeData t
-00027880: 7970 653d 2256 4152 4348 4152 223e 7465  ype="VARCHAR">te
-00027890: 7374 3c2f 536e 6f77 666c 616b 6544 6174  st</SnowflakeDat
-000278a0: 613e 2729 2c20 526f 7728 414e 533d 273c  a>'), Row(ANS='<
-000278b0: 536e 6f77 666c 616b 6544 6174 6120 7479  SnowflakeData ty
-000278c0: 7065 3d22 4f42 4a45 4354 223e 3c61 2074  pe="OBJECT"><a t
-000278d0: 7970 653d 2249 4e54 4547 4552 223e 3130  ype="INTEGER">10
-000278e0: 3c2f 613e 3c62 2074 7970 653d 2249 4e54  </a><b type="INT
-000278f0: 4547 4552 223e 3230 3c2f 623e 3c2f 536e  EGER">20</b></Sn
-00027900: 6f77 666c 616b 6544 6174 613e 2729 2c20  owflakeData>'), 
-00027910: 526f 7728 414e 533d 273c 536e 6f77 666c  Row(ANS='<Snowfl
-00027920: 616b 6544 6174 6120 7479 7065 3d22 4152  akeData type="AR
-00027930: 5241 5922 3e3c 6520 7479 7065 3d22 494e  RAY"><e type="IN
-00027940: 5445 4745 5222 3e31 3c2f 653e 3c65 2074  TEGER">1</e><e t
-00027950: 7970 653d 2249 4e54 4547 4552 223e 323c  ype="INTEGER">2<
-00027960: 2f65 3e3c 6520 7479 7065 3d22 494e 5445  /e><e type="INTE
-00027970: 4745 5222 3e33 3c2f 653e 3c2f 536e 6f77  GER">3</e></Snow
-00027980: 666c 616b 6544 6174 613e 2729 5d0a 2020  flakeData>')].  
-00027990: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-000279a0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-000279b0: 2274 6f5f 786d 6c22 290a 2020 2020 7265  "to_xml").    re
-000279c0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
-000279d0: 5f78 6d6c 2229 2863 290a 0a0a 6465 6620  _xml")(c)...def 
-000279e0: 6765 745f 6967 6e6f 7265 5f63 6173 6528  get_ignore_case(
-000279f0: 6f62 6a3a 2043 6f6c 756d 6e4f 724e 616d  obj: ColumnOrNam
-00027a00: 652c 2066 6965 6c64 3a20 436f 6c75 6d6e  e, field: Column
-00027a10: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00027a20: 6e3a 0a20 2020 2022 2222 0a20 2020 2045  n:.    """.    E
-00027a30: 7874 7261 6374 7320 6120 6669 656c 6420  xtracts a field 
-00027a40: 7661 6c75 6520 6672 6f6d 2061 6e20 6f62  value from an ob
-00027a50: 6a65 6374 2e20 5265 7475 726e 7320 4e55  ject. Returns NU
-00027a60: 4c4c 2069 6620 6569 7468 6572 206f 6620  LL if either of 
-00027a70: 7468 6520 6172 6775 6d65 6e74 7320 6973  the arguments is
-00027a80: 204e 554c 4c2e 0a20 2020 2054 6869 7320   NULL..    This 
-00027a90: 6675 6e63 7469 6f6e 2069 7320 7369 6d69  function is simi
-00027aa0: 6c61 7220 746f 203a 6d65 7468 3a60 6765  lar to :meth:`ge
-00027ab0: 7460 2062 7574 2061 7070 6c69 6573 2063  t` but applies c
-00027ac0: 6173 652d 696e 7365 6e73 6974 6976 6520  ase-insensitive 
-00027ad0: 6d61 7463 6869 6e67 2074 6f20 6669 656c  matching to fiel
-00027ae0: 6420 6e61 6d65 732e 0a0a 2020 2020 4578  d names...    Ex
-00027af0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
-00027b00: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00027b10: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00027b20: 616d 6528 5b7b 2261 223a 207b 2261 6122  ame([{"a": {"aa"
-00027b30: 3a20 312c 2022 6262 223a 2032 2c20 2263  : 1, "bb": 2, "c
-00027b40: 6322 3a20 337d 7d5d 290a 2020 2020 2020  c": 3}}]).      
-00027b50: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00027b60: 6765 745f 6967 6e6f 7265 5f63 6173 6528  get_ignore_case(
-00027b70: 6466 5b22 6122 5d2c 206c 6974 2822 4141  df["a"], lit("AA
-00027b80: 2229 292e 616c 6961 7328 2267 6574 5f69  ")).alias("get_i
-00027b90: 676e 6f72 655f 6361 7365 2229 292e 636f  gnore_case")).co
-00027ba0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00027bb0: 5b52 6f77 2847 4554 5f49 474e 4f52 455f  [Row(GET_IGNORE_
-00027bc0: 4341 5345 3d27 3127 295d 0a20 2020 2022  CASE='1')].    "
-00027bd0: 2222 0a20 2020 2063 3120 3d20 5f74 6f5f  "".    c1 = _to_
-00027be0: 636f 6c5f 6966 5f73 7472 286f 626a 2c20  col_if_str(obj, 
-00027bf0: 2267 6574 5f69 676e 6f72 655f 6361 7365  "get_ignore_case
-00027c00: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
-00027c10: 636f 6c5f 6966 5f73 7472 2866 6965 6c64  col_if_str(field
-00027c20: 2c20 2267 6574 5f69 676e 6f72 655f 6361  , "get_ignore_ca
-00027c30: 7365 2229 0a20 2020 2072 6574 7572 6e20  se").    return 
-00027c40: 6275 696c 7469 6e28 2267 6574 5f69 676e  builtin("get_ign
-00027c50: 6f72 655f 6361 7365 2229 2863 312c 2063  ore_case")(c1, c
-00027c60: 3229 0a0a 0a64 6566 206f 626a 6563 745f  2)...def object_
-00027c70: 6b65 7973 286f 626a 3a20 436f 6c75 6d6e  keys(obj: Column
-00027c80: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00027c90: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00027ca0: 7320 616e 2061 7272 6179 2063 6f6e 7461  s an array conta
-00027cb0: 696e 696e 6720 7468 6520 6c69 7374 206f  ining the list o
-00027cc0: 6620 6b65 7973 2069 6e20 7468 6520 696e  f keys in the in
-00027cd0: 7075 7420 6f62 6a65 6374 2e0a 0a0a 2020  put object....  
-00027ce0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-00027cf0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00027d00: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00027d10: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00027d20: 206c 6974 0a20 2020 2020 2020 203e 3e3e   lit.        >>>
-00027d30: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
-00027d40: 6c28 0a20 2020 2020 2020 202e 2e2e 2020  l(.        ...  
-00027d50: 2020 2022 7365 6c65 6374 206f 626a 6563     "select objec
-00027d60: 745f 636f 6e73 7472 7563 7428 612c 622c  t_construct(a,b,
-00027d70: 632c 642c 652c 6629 2061 7320 6f62 6a2c  c,d,e,f) as obj,
-00027d80: 206b 2c20 7620 6672 6f6d 2022 0a20 2020   k, v from ".   
-00027d90: 2020 2020 202e 2e2e 2020 2020 2022 7661       ...     "va
-00027da0: 6c75 6573 2827 6167 6527 2c20 3231 2c20  lues('age', 21, 
-00027db0: 277a 6970 272c 2032 3130 3231 2c20 276e  'zip', 21021, 'n
-00027dc0: 616d 6527 2c20 274a 6f65 272c 2027 6167  ame', 'Joe', 'ag
-00027dd0: 6527 2c20 3029 2c22 0a20 2020 2020 2020  e', 0),".       
-00027de0: 202e 2e2e 2020 2020 2022 2827 6167 6527   ...     "('age'
-00027df0: 2c20 3236 2c20 277a 6970 272c 2039 3430  , 26, 'zip', 940
-00027e00: 3231 2c20 276e 616d 6527 2c20 274a 6179  21, 'name', 'Jay
-00027e10: 272c 2027 6167 6527 2c20 3029 2061 7320  ', 'age', 0) as 
-00027e20: 5428 612c 622c 632c 642c 652c 662c 6b2c  T(a,b,c,d,e,f,k,
-00027e30: 7629 220a 2020 2020 2020 2020 2e2e 2e20  v)".        ... 
-00027e40: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00027e50: 2e73 656c 6563 7428 6f62 6a65 6374 5f6b  .select(object_k
-00027e60: 6579 7328 636f 6c28 226f 626a 2229 292e  eys(col("obj")).
-00027e70: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00027e80: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00027e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00027ea0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00027eb0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00027ec0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00027ed0: 2020 7c5b 2020 2020 2020 2020 2020 7c0a    |[          |.
-00027ee0: 2020 2020 2020 2020 7c20 2022 6167 6522          |  "age"
-00027ef0: 2c20 2020 7c0a 2020 2020 2020 2020 7c20  ,   |.        | 
-00027f00: 2022 6e61 6d65 222c 2020 7c0a 2020 2020   "name",  |.    
-00027f10: 2020 2020 7c20 2022 7a69 7022 2020 2020      |  "zip"    
-00027f20: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00027f30: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00027f40: 7c5b 2020 2020 2020 2020 2020 7c0a 2020  |[          |.  
-00027f50: 2020 2020 2020 7c20 2022 6167 6522 2c20        |  "age", 
-00027f60: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
-00027f70: 6e61 6d65 222c 2020 7c0a 2020 2020 2020  name",  |.      
-00027f80: 2020 7c20 2022 7a69 7022 2020 2020 7c0a    |  "zip"    |.
-00027f90: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
-00027fa0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-00027fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00027fc0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00027fd0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00027fe0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286f  _to_col_if_str(o
-00027ff0: 626a 2c20 226f 626a 6563 745f 6b65 7973  bj, "object_keys
-00028000: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00028010: 696c 7469 6e28 226f 626a 6563 745f 6b65  iltin("object_ke
-00028020: 7973 2229 2863 290a 0a0a 6465 6620 786d  ys")(c)...def xm
-00028030: 6c67 6574 280a 2020 2020 786d 6c3a 2043  lget(.    xml: C
-00028040: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
-00028050: 2074 6167 3a20 436f 6c75 6d6e 4f72 4e61   tag: ColumnOrNa
-00028060: 6d65 2c0a 2020 2020 696e 7374 616e 6365  me,.    instance
-00028070: 5f6e 756d 3a20 556e 696f 6e5b 436f 6c75  _num: Union[Colu
-00028080: 6d6e 4f72 4e61 6d65 2c20 696e 745d 203d  mnOrName, int] =
-00028090: 2030 2c0a 2920 2d3e 2043 6f6c 756d 6e3a   0,.) -> Column:
-000280a0: 0a20 2020 2022 2222 4578 7472 6163 7473  .    """Extracts
-000280b0: 2061 6e20 584d 4c20 656c 656d 656e 7420   an XML element 
-000280c0: 6f62 6a65 6374 2028 6f66 7465 6e20 7265  object (often re
-000280d0: 6665 7272 6564 2074 6f20 6173 2073 696d  ferred to as sim
-000280e0: 706c 7920 6120 7461 6729 2066 726f 6d20  ply a tag) from 
-000280f0: 6120 636f 6e74 656e 7420 6f66 206f 7574  a content of out
-00028100: 6572 0a20 2020 2058 4d4c 2065 6c65 6d65  er.    XML eleme
-00028110: 6e74 206f 626a 6563 7420 6279 2074 6865  nt object by the
-00028120: 206e 616d 6520 6f66 2074 6865 2074 6167   name of the tag
-00028130: 2061 6e64 2069 7473 2069 6e73 7461 6e63   and its instanc
-00028140: 6520 6e75 6d62 6572 2028 636f 756e 7469  e number (counti
-00028150: 6e67 2066 726f 6d20 3029 2e0a 0a20 2020  ng from 0)...   
-00028160: 2054 6865 2066 6f6c 6c6f 7769 6e67 2065   The following e
-00028170: 7861 6d70 6c65 2072 6574 7572 6e73 2074  xample returns t
-00028180: 6865 2066 6972 7374 2069 6e6e 6572 206c  he first inner l
-00028190: 6576 656c 2028 6c65 7665 6c32 2920 6672  evel (level2) fr
-000281a0: 6f6d 2074 6865 2058 4d4c 206f 626a 6563  om the XML objec
-000281b0: 7420 6372 6561 7465 6420 7669 6120 6070  t created via `p
-000281c0: 6172 7365 5f78 6d6c 602e 0a0a 2020 2020  arse_xml`...    
-000281d0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000281e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000281f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00028200: 7261 6d65 285b 273c 6c65 7665 6c31 2061  rame(['<level1 a
-00028210: 7474 7231 3d22 6122 3e31 3c6c 6576 656c  ttr1="a">1<level
-00028220: 3220 6174 7472 323d 2262 223e 323c 6c65  2 attr2="b">2<le
-00028230: 7665 6c33 3e33 613c 2f6c 6576 656c 333e  vel3>3a</level3>
-00028240: 3c6c 6576 656c 333e 3362 3c2f 6c65 7665  <level3>3b</leve
-00028250: 6c33 3e3c 2f6c 6576 656c 323e 3c2f 6c65  l3></level2></le
-00028260: 7665 6c31 3e27 5d2c 2073 6368 656d 613d  vel1>'], schema=
-00028270: 5b22 7374 7222 5d29 2e73 656c 6563 7428  ["str"]).select(
-00028280: 7061 7273 655f 786d 6c28 2273 7472 2229  parse_xml("str")
-00028290: 2e61 735f 2822 6f62 6a22 2929 0a20 2020  .as_("obj")).   
-000282a0: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
-000282b0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-000282c0: 6f77 284f 424a 3d27 3c6c 6576 656c 3120  ow(OBJ='<level1 
-000282d0: 6174 7472 313d 2261 223e 5c5c 6e20 2031  attr1="a">\\n  1
-000282e0: 5c5c 6e20 203c 6c65 7665 6c32 2061 7474  \\n  <level2 att
-000282f0: 7232 3d22 6222 3e5c 5c6e 2020 2020 325c  r2="b">\\n    2\
-00028300: 5c6e 2020 2020 3c6c 6576 656c 333e 3361  \n    <level3>3a
-00028310: 3c2f 6c65 7665 6c33 3e5c 5c6e 2020 2020  </level3>\\n    
-00028320: 3c6c 6576 656c 333e 3362 3c2f 6c65 7665  <level3>3b</leve
-00028330: 6c33 3e5c 5c6e 2020 3c2f 6c65 7665 6c32  l3>\\n  </level2
-00028340: 3e5c 5c6e 3c2f 6c65 7665 6c31 3e27 295d  >\\n</level1>')]
-00028350: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00028360: 7365 6c65 6374 2878 6d6c 6765 7428 226f  select(xmlget("o
-00028370: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
-00028380: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-00028390: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000283a0: 2020 5b52 6f77 2841 4e53 3d27 3c6c 6576    [Row(ANS='<lev
-000283b0: 656c 3220 6174 7472 323d 2262 223e 5c5c  el2 attr2="b">\\
-000283c0: 6e20 2032 5c5c 6e20 203c 6c65 7665 6c33  n  2\\n  <level3
-000283d0: 3e33 613c 2f6c 6576 656c 333e 5c5c 6e20  >3a</level3>\\n 
-000283e0: 203c 6c65 7665 6c33 3e33 623c 2f6c 6576   <level3>3b</lev
-000283f0: 656c 333e 5c5c 6e3c 2f6c 6576 656c 323e  el3>\\n</level2>
-00028400: 2729 5d0a 0a20 2020 2057 6865 6e20 6d75  ')]..    When mu
-00028410: 6c74 6970 6c65 2074 6167 7320 6578 6973  ltiple tags exis
-00028420: 7420 6174 2061 206c 6576 656c 2c20 696e  t at a level, in
-00028430: 7374 616e 6365 5f6e 756d 2063 616e 2062  stance_num can b
-00028440: 6520 7573 6564 2074 6f20 6469 7374 696e  e used to distin
-00028450: 6775 6973 6820 7768 6963 6820 656c 656d  guish which elem
-00028460: 656e 7420 746f 2072 6574 7572 6e2e 0a0a  ent to return...
-00028470: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00028480: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00028490: 6c65 6374 2878 6d6c 6765 7428 786d 6c67  lect(xmlget(xmlg
-000284a0: 6574 2822 6f62 6a22 2c20 6c69 7428 226c  et("obj", lit("l
-000284b0: 6576 656c 3222 2929 2c20 6c69 7428 226c  evel2")), lit("l
-000284c0: 6576 656c 3322 292c 206c 6974 2830 2929  evel3"), lit(0))
-000284d0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
-000284e0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000284f0: 526f 7728 414e 533d 273c 6c65 7665 6c33  Row(ANS='<level3
-00028500: 3e33 613c 2f6c 6576 656c 333e 2729 5d0a  >3a</level3>')].
-00028510: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00028520: 656c 6563 7428 786d 6c67 6574 2878 6d6c  elect(xmlget(xml
-00028530: 6765 7428 226f 626a 222c 206c 6974 2822  get("obj", lit("
-00028540: 6c65 7665 6c32 2229 292c 206c 6974 2822  level2")), lit("
-00028550: 6c65 7665 6c33 2229 2c20 6c69 7428 3129  level3"), lit(1)
-00028560: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
-00028570: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00028580: 5b52 6f77 2841 4e53 3d27 3c6c 6576 656c  [Row(ANS='<level
-00028590: 333e 3362 3c2f 6c65 7665 6c33 3e27 295d  3>3b</level3>')]
-000285a0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000285b0: 7365 6c65 6374 2878 6d6c 6765 7428 226f  select(xmlget("o
-000285c0: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
-000285d0: 2229 2c20 6c69 7428 3529 292e 6173 5f28  "), lit(5)).as_(
-000285e0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-000285f0: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00028600: 4e53 3d4e 6f6e 6529 5d0a 0a20 2020 2049  NS=None)]..    I
-00028610: 6e20 6f72 6465 7220 746f 2067 6574 2074  n order to get t
-00028620: 6865 2074 6167 6e61 6d65 2c20 7468 6520  he tagname, the 
-00028630: 7661 6c75 6520 6f66 2061 6e20 6174 7472  value of an attr
-00028640: 6962 7574 6520 6f72 2074 6865 2063 6f6e  ibute or the con
-00028650: 7465 6e74 2077 6974 6869 6e20 6120 7461  tent within a ta
-00028660: 6720 7468 6520 6067 6574 6020 6675 6e63  g the `get` func
-00028670: 7469 6f6e 2063 616e 2062 6520 7573 6564  tion can be used
-00028680: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00028690: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-000286a0: 2e73 656c 6563 7428 6765 7428 786d 6c67  .select(get(xmlg
-000286b0: 6574 2822 6f62 6a22 2c20 6c69 7428 226c  et("obj", lit("l
-000286c0: 6576 656c 3222 2929 2c20 6c69 7428 2240  evel2")), lit("@
-000286d0: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-000286e0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000286f0: 2020 5b52 6f77 2841 4e53 3d27 226c 6576    [Row(ANS='"lev
-00028700: 656c 3222 2729 5d0a 2020 2020 2020 2020  el2"')].        
-00028710: 3e3e 3e20 6466 2e73 656c 6563 7428 6765  >>> df.select(ge
-00028720: 7428 786d 6c67 6574 2822 6f62 6a22 2c20  t(xmlget("obj", 
-00028730: 6c69 7428 226c 6576 656c 3222 2929 2c20  lit("level2")), 
-00028740: 6c69 7428 2224 2229 292e 6173 5f28 2261  lit("$")).as_("a
-00028750: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
-00028760: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-00028770: 3d27 5b5c 5c6e 2020 322c 5c5c 6e20 207b  ='[\\n  2,\\n  {
-00028780: 5c5c 6e20 2020 2022 2422 3a20 2233 6122  \\n    "$": "3a"
-00028790: 2c5c 5c6e 2020 2020 2240 223a 2022 6c65  ,\\n    "@": "le
-000287a0: 7665 6c33 225c 5c6e 2020 7d2c 5c5c 6e20  vel3"\\n  },\\n 
-000287b0: 207b 5c5c 6e20 2020 2022 2422 3a20 2233   {\\n    "$": "3
-000287c0: 6222 2c5c 5c6e 2020 2020 2240 223a 2022  b",\\n    "@": "
-000287d0: 6c65 7665 6c33 225c 5c6e 2020 7d5c 5c6e  level3"\\n  }\\n
-000287e0: 5d27 295d 0a20 2020 2020 2020 203e 3e3e  ]')].        >>>
-000287f0: 2064 662e 7365 6c65 6374 2867 6574 2878   df.select(get(x
-00028800: 6d6c 6765 7428 786d 6c67 6574 2822 6f62  mlget(xmlget("ob
-00028810: 6a22 2c20 6c69 7428 226c 6576 656c 3222  j", lit("level2"
-00028820: 2929 2c20 6c69 7428 226c 6576 656c 3322  )), lit("level3"
-00028830: 2929 2c20 6c69 7428 2224 2229 292e 6173  )), lit("$")).as
-00028840: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
-00028850: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00028860: 2841 4e53 3d27 2233 6122 2729 5d0a 2020  (ANS='"3a"')].  
-00028870: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00028880: 6563 7428 6765 7428 786d 6c67 6574 2822  ect(get(xmlget("
-00028890: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
-000288a0: 3222 2929 2c20 6c69 7428 2240 6174 7472  2")), lit("@attr
-000288b0: 3222 2929 2e61 735f 2822 616e 7322 2929  2")).as_("ans"))
-000288c0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000288d0: 2020 205b 526f 7728 414e 533d 2722 6222     [Row(ANS='"b"
-000288e0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-000288f0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
-00028900: 7374 7228 786d 6c2c 2022 786d 6c67 6574  str(xml, "xmlget
-00028910: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
-00028920: 636f 6c5f 6966 5f73 7472 2874 6167 2c20  col_if_str(tag, 
-00028930: 2278 6d6c 6765 7422 290a 2020 2020 6333  "xmlget").    c3
-00028940: 203d 2028 0a20 2020 2020 2020 2069 6e73   = (.        ins
-00028950: 7461 6e63 655f 6e75 6d0a 2020 2020 2020  tance_num.      
-00028960: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00028970: 696e 7374 616e 6365 5f6e 756d 2c20 696e  instance_num, in
-00028980: 7429 0a20 2020 2020 2020 2065 6c73 6520  t).        else 
-00028990: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2869  _to_col_if_str(i
-000289a0: 6e73 7461 6e63 655f 6e75 6d2c 2022 786d  nstance_num, "xm
-000289b0: 6c67 6574 2229 0a20 2020 2029 0a20 2020  lget").    ).   
-000289c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000289d0: 2278 6d6c 6765 7422 2928 6331 2c20 6332  "xmlget")(c1, c2
-000289e0: 2c20 6333 290a 0a0a 6465 6620 6765 745f  , c3)...def get_
-000289f0: 7061 7468 2863 6f6c 3a20 436f 6c75 6d6e  path(col: Column
-00028a00: 4f72 4e61 6d65 2c20 7061 7468 3a20 436f  OrName, path: Co
-00028a10: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00028a20: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00028a30: 2020 2045 7874 7261 6374 7320 6120 7661     Extracts a va
-00028a40: 6c75 6520 6672 6f6d 2073 656d 692d 7374  lue from semi-st
-00028a50: 7275 6374 7572 6564 2064 6174 6120 7573  ructured data us
-00028a60: 696e 6720 6120 7061 7468 206e 616d 652e  ing a path name.
-00028a70: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
-00028a80: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00028a90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00028aa0: 655f 6461 7461 6672 616d 6528 5b7b 2261  e_dataframe([{"a
-00028ab0: 223a 207b 2261 6122 3a20 7b22 6464 223a  ": {"aa": {"dd":
-00028ac0: 2034 7d2c 2022 6262 223a 2032 2c20 2263   4}, "bb": 2, "c
-00028ad0: 6322 3a20 337d 7d5d 290a 2020 2020 2020  c": 3}}]).      
-00028ae0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00028af0: 6765 745f 7061 7468 2864 665b 2261 225d  get_path(df["a"]
-00028b00: 2c20 6c69 7428 2261 612e 6464 2229 292e  , lit("aa.dd")).
-00028b10: 616c 6961 7328 2267 6574 5f70 6174 6822  alias("get_path"
-00028b20: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00028b30: 2020 2020 205b 526f 7728 4745 545f 5041       [Row(GET_PA
-00028b40: 5448 3d27 3427 295d 0a20 2020 2022 2222  TH='4')].    """
-00028b50: 0a20 2020 2063 3120 3d20 5f74 6f5f 636f  .    c1 = _to_co
-00028b60: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2267  l_if_str(col, "g
-00028b70: 6574 5f70 6174 6822 290a 2020 2020 6332  et_path").    c2
-00028b80: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00028b90: 7228 7061 7468 2c20 2267 6574 5f70 6174  r(path, "get_pat
-00028ba0: 6822 290a 2020 2020 7265 7475 726e 2062  h").    return b
-00028bb0: 7569 6c74 696e 2822 6765 745f 7061 7468  uiltin("get_path
-00028bc0: 2229 2863 312c 2063 3229 0a0a 0a64 6566  ")(c1, c2)...def
-00028bd0: 2067 6574 2863 6f6c 313a 2055 6e69 6f6e   get(col1: Union
-00028be0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00028bf0: 6e74 5d2c 2063 6f6c 323a 2055 6e69 6f6e  nt], col2: Union
-00028c00: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00028c10: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
-00028c20: 2020 2020 2222 2245 7874 7261 6374 7320      """Extracts 
-00028c30: 6120 7661 6c75 6520 6672 6f6d 2061 6e20  a value from an 
-00028c40: 6f62 6a65 6374 206f 7220 6172 7261 793b  object or array;
-00028c50: 2072 6574 7572 6e73 204e 554c 4c20 6966   returns NULL if
-00028c60: 2065 6974 6865 7220 6f66 2074 6865 2061   either of the a
-00028c70: 7267 756d 656e 7473 2069 7320 4e55 4c4c  rguments is NULL
-00028c80: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00028c90: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00028ca0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00028cb0: 6544 6174 6146 7261 6d65 285b 285b 312c  eDataFrame([([1,
-00028cc0: 2032 2c20 335d 2c29 2c20 285b 5d2c 295d   2, 3],), ([],)]
-00028cd0: 2c20 5b22 6461 7461 225d 290a 2020 2020  , ["data"]).    
-00028ce0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00028cf0: 7428 6765 7428 6466 2e64 6174 612c 2031  t(get(df.data, 1
-00028d00: 292e 6173 5f28 2269 6478 3122 2929 2e73  ).as_("idx1")).s
-00028d10: 6f72 7428 636f 6c28 2269 6478 3122 2929  ort(col("idx1"))
-00028d20: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00028d30: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00028d40: 2020 207c 2249 4458 3122 2020 7c0a 2020     |"IDX1"  |.  
-00028d50: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00028d60: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
-00028d70: 2020 7c0a 2020 2020 2020 2020 7c32 2020    |.        |2  
-00028d80: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00028d90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00028da0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00028db0: 2020 2222 220a 2020 2020 6331 203d 205f    """.    c1 = _
-00028dc0: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
-00028dd0: 5f69 6e74 2863 6f6c 312c 2022 6765 7422  _int(col1, "get"
-00028de0: 290a 2020 2020 6332 203d 205f 746f 5f63  ).    c2 = _to_c
-00028df0: 6f6c 5f69 665f 7374 725f 6f72 5f69 6e74  ol_if_str_or_int
-00028e00: 2863 6f6c 322c 2022 6765 7422 290a 2020  (col2, "get").  
-00028e10: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00028e20: 2822 6765 7422 2928 6331 2c20 6332 290a  ("get")(c1, c2).
-00028e30: 0a0a 6465 6620 7768 656e 2863 6f6e 6469  ..def when(condi
-00028e40: 7469 6f6e 3a20 436f 6c75 6d6e 4f72 5371  tion: ColumnOrSq
-00028e50: 6c45 7870 722c 2076 616c 7565 3a20 436f  lExpr, value: Co
-00028e60: 6c75 6d6e 4f72 4c69 7465 7261 6c29 202d  lumnOrLiteral) -
-00028e70: 3e20 4361 7365 4578 7072 3a0a 2020 2020  > CaseExpr:.    
-00028e80: 2222 2257 6f72 6b73 206c 696b 6520 6120  """Works like a 
-00028e90: 6361 7363 6164 696e 6720 6966 2d74 6865  cascading if-the
-00028ea0: 6e2d 656c 7365 2073 7461 7465 6d65 6e74  n-else statement
-00028eb0: 2e0a 2020 2020 4120 7365 7269 6573 206f  ..    A series o
-00028ec0: 6620 636f 6e64 6974 696f 6e73 2061 7265  f conditions are
-00028ed0: 2065 7661 6c75 6174 6564 2069 6e20 7365   evaluated in se
-00028ee0: 7175 656e 6365 2e0a 2020 2020 5768 656e  quence..    When
-00028ef0: 2061 2063 6f6e 6469 7469 6f6e 2065 7661   a condition eva
-00028f00: 6c75 6174 6573 2074 6f20 5452 5545 2c20  luates to TRUE, 
-00028f10: 7468 6520 6576 616c 7561 7469 6f6e 2073  the evaluation s
-00028f20: 746f 7073 2061 6e64 2074 6865 2061 7373  tops and the ass
-00028f30: 6f63 6961 7465 640a 2020 2020 7265 7375  ociated.    resu
-00028f40: 6c74 2028 6166 7465 7220 5448 454e 2920  lt (after THEN) 
-00028f50: 6973 2072 6574 7572 6e65 642e 2049 6620  is returned. If 
-00028f60: 6e6f 6e65 206f 6620 7468 6520 636f 6e64  none of the cond
-00028f70: 6974 696f 6e73 2065 7661 6c75 6174 6520  itions evaluate 
-00028f80: 746f 2054 5255 452c 0a20 2020 2074 6865  to TRUE,.    the
-00028f90: 6e20 7468 6520 7265 7375 6c74 2061 6674  n the result aft
-00028fa0: 6572 2074 6865 206f 7074 696f 6e61 6c20  er the optional 
-00028fb0: 4f54 4845 5257 4953 4520 6973 2072 6574  OTHERWISE is ret
-00028fc0: 7572 6e65 642c 2069 6620 7072 6573 656e  urned, if presen
-00028fd0: 743b 0a20 2020 206f 7468 6572 7769 7365  t;.    otherwise
-00028fe0: 204e 554c 4c20 6973 2072 6574 7572 6e65   NULL is returne
-00028ff0: 642e 0a0a 2020 2020 4172 6773 3a0a 2020  d...    Args:.  
-00029000: 2020 2020 2020 636f 6e64 6974 696f 6e3a        condition:
-00029010: 2041 203a 636c 6173 733a 6043 6f6c 756d   A :class:`Colum
-00029020: 6e60 2065 7870 7265 7373 696f 6e20 6f72  n` expression or
-00029030: 2053 514c 2074 6578 7420 7265 7072 6573   SQL text repres
-00029040: 656e 7469 6e67 2074 6865 2073 7065 6369  enting the speci
-00029050: 6669 6564 2063 6f6e 6469 7469 6f6e 2e0a  fied condition..
-00029060: 2020 2020 2020 2020 7661 6c75 653a 2041          value: A
-00029070: 203a 636c 6173 733a 6043 6f6c 756d 6e60   :class:`Column`
-00029080: 2065 7870 7265 7373 696f 6e20 6f72 2061   expression or a
-00029090: 206c 6974 6572 616c 2076 616c 7565 2c20   literal value, 
-000290a0: 7768 6963 6820 7769 6c6c 2062 6520 7265  which will be re
-000290b0: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
-000290c0: 2020 2069 6620 6060 636f 6e64 6974 696f     if ``conditio
-000290d0: 6e60 6020 6973 2074 7275 652e 0a0a 2020  n`` is true...  
-000290e0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-000290f0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00029100: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00029110: 6166 7261 6d65 285b 312c 204e 6f6e 652c  aframe([1, None,
-00029120: 2032 2c20 332c 204e 6f6e 652c 2035 2c20   2, 3, None, 5, 
-00029130: 365d 2c20 7363 6865 6d61 3d5b 2261 225d  6], schema=["a"]
-00029140: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00029150: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00029160: 2020 205b 526f 7728 413d 3129 2c20 526f     [Row(A=1), Ro
-00029170: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
-00029180: 3d32 292c 2052 6f77 2841 3d33 292c 2052  =2), Row(A=3), R
-00029190: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
-000291a0: 413d 3529 2c20 526f 7728 413d 3629 5d0a  A=5), Row(A=6)].
-000291b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000291c0: 656c 6563 7428 7768 656e 2863 6f6c 2822  elect(when(col("
-000291d0: 6122 2920 2520 3220 3d3d 2030 2c20 6c69  a") % 2 == 0, li
-000291e0: 7428 2265 7665 6e22 2929 2e61 735f 2822  t("even")).as_("
-000291f0: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
-00029200: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-00029210: 533d 4e6f 6e65 292c 2052 6f77 2841 4e53  S=None), Row(ANS
-00029220: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
-00029230: 2765 7665 6e27 292c 2052 6f77 2841 4e53  'even'), Row(ANS
-00029240: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
-00029250: 4e6f 6e65 292c 2052 6f77 2841 4e53 3d4e  None), Row(ANS=N
-00029260: 6f6e 6529 2c20 526f 7728 414e 533d 2765  one), Row(ANS='e
-00029270: 7665 6e27 295d 0a0a 2020 2020 4d75 6c74  ven')]..    Mult
-00029280: 6970 6c65 2077 6865 6e20 7374 6174 656d  iple when statem
-00029290: 656e 7473 2063 616e 2062 6520 6368 616e  ents can be chan
-000292a0: 6765 6420 616e 6420 606f 7468 6572 7769  ged and `otherwi
-000292b0: 7365 602f 6065 6c73 655f 6020 7573 6564  se`/`else_` used
-000292c0: 2074 6f20 6372 6561 7465 2065 7870 7265   to create expre
-000292d0: 7373 696f 6e73 2073 696d 696c 6172 2074  ssions similar t
-000292e0: 6f20 6060 4341 5345 2057 4845 4e20 2e2e  o ``CASE WHEN ..
-000292f0: 2e20 454c 5345 202e 2e2e 2045 4e44 6060  . ELSE ... END``
-00029300: 2069 6e20 5351 4c2e 0a0a 2020 2020 4578   in SQL...    Ex
-00029310: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00029320: 203e 3e3e 2064 662e 7365 6c65 6374 2877   >>> df.select(w
-00029330: 6865 6e28 636f 6c28 2261 2229 2025 2032  hen(col("a") % 2
-00029340: 203d 3d20 302c 206c 6974 2822 6576 656e   == 0, lit("even
-00029350: 2229 292e 7768 656e 2863 6f6c 2822 6122  ")).when(col("a"
-00029360: 2920 2520 3220 3d3d 2031 2c20 6c69 7428  ) % 2 == 1, lit(
-00029370: 226f 6464 2229 292e 6173 5f28 2261 6e73  "odd")).as_("ans
-00029380: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00029390: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-000293a0: 6f64 6427 292c 2052 6f77 2841 4e53 3d4e  odd'), Row(ANS=N
-000293b0: 6f6e 6529 2c20 526f 7728 414e 533d 2765  one), Row(ANS='e
-000293c0: 7665 6e27 292c 2052 6f77 2841 4e53 3d27  ven'), Row(ANS='
-000293d0: 6f64 6427 292c 2052 6f77 2841 4e53 3d4e  odd'), Row(ANS=N
-000293e0: 6f6e 6529 2c20 526f 7728 414e 533d 276f  one), Row(ANS='o
-000293f0: 6464 2729 2c20 526f 7728 414e 533d 2765  dd'), Row(ANS='e
-00029400: 7665 6e27 295d 0a20 2020 2020 2020 203e  ven')].        >
-00029410: 3e3e 2064 662e 7365 6c65 6374 2877 6865  >> df.select(whe
-00029420: 6e28 636f 6c28 2261 2229 2025 2032 203d  n(col("a") % 2 =
-00029430: 3d20 302c 206c 6974 2822 6576 656e 2229  = 0, lit("even")
-00029440: 292e 7768 656e 2863 6f6c 2822 6122 2920  ).when(col("a") 
-00029450: 2520 3220 3d3d 2031 2c20 6c69 7428 226f  % 2 == 1, lit("o
-00029460: 6464 2229 292e 6f74 6865 7277 6973 6528  dd")).otherwise(
-00029470: 6c69 7428 2275 6e6b 6e6f 776e 2229 292e  lit("unknown")).
-00029480: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
-00029490: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-000294a0: 6f77 2841 4e53 3d27 6f64 6427 292c 2052  ow(ANS='odd'), R
-000294b0: 6f77 2841 4e53 3d27 756e 6b6e 6f77 6e27  ow(ANS='unknown'
-000294c0: 292c 2052 6f77 2841 4e53 3d27 6576 656e  ), Row(ANS='even
-000294d0: 2729 2c20 526f 7728 414e 533d 276f 6464  '), Row(ANS='odd
-000294e0: 2729 2c20 526f 7728 414e 533d 2775 6e6b  '), Row(ANS='unk
-000294f0: 6e6f 776e 2729 2c20 526f 7728 414e 533d  nown'), Row(ANS=
-00029500: 276f 6464 2729 2c20 526f 7728 414e 533d  'odd'), Row(ANS=
-00029510: 2765 7665 6e27 295d 0a20 2020 2022 2222  'even')].    """
-00029520: 0a20 2020 2072 6574 7572 6e20 4361 7365  .    return Case
-00029530: 4578 7072 280a 2020 2020 2020 2020 4361  Expr(.        Ca
-00029540: 7365 5768 656e 280a 2020 2020 2020 2020  seWhen(.        
-00029550: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00029560: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00029570: 2020 2020 2020 2020 2020 2020 5f74 6f5f              _to_
-00029580: 636f 6c5f 6966 5f73 716c 5f65 7870 7228  col_if_sql_expr(
-00029590: 636f 6e64 6974 696f 6e2c 2022 7768 656e  condition, "when
-000295a0: 2229 2e5f 6578 7072 6573 7369 6f6e 2c0a  ")._expression,.
-000295b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295c0: 2020 2020 436f 6c75 6d6e 2e5f 746f 5f65      Column._to_e
-000295d0: 7870 7228 7661 6c75 6529 2c0a 2020 2020  xpr(value),.    
-000295e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000295f0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-00029600: 2020 2020 290a 2020 2020 290a 0a0a 6465      ).    )...de
-00029610: 6620 6966 6628 0a20 2020 2063 6f6e 6469  f iff(.    condi
-00029620: 7469 6f6e 3a20 436f 6c75 6d6e 4f72 5371  tion: ColumnOrSq
-00029630: 6c45 7870 722c 0a20 2020 2065 7870 7231  lExpr,.    expr1
-00029640: 3a20 436f 6c75 6d6e 4f72 4c69 7465 7261  : ColumnOrLitera
-00029650: 6c2c 0a20 2020 2065 7870 7232 3a20 436f  l,.    expr2: Co
-00029660: 6c75 6d6e 4f72 4c69 7465 7261 6c2c 0a29  lumnOrLiteral,.)
-00029670: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00029680: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
-00029690: 6f6e 6520 6f66 2074 776f 2073 7065 6369  one of two speci
-000296a0: 6669 6564 2065 7870 7265 7373 696f 6e73  fied expressions
-000296b0: 2c20 6465 7065 6e64 696e 6720 6f6e 2061  , depending on a
-000296c0: 2063 6f6e 6469 7469 6f6e 2e0a 2020 2020   condition..    
-000296d0: 5468 6973 2069 7320 6571 7569 7661 6c65  This is equivale
-000296e0: 6e74 2074 6f20 616e 2060 6069 662d 7468  nt to an ``if-th
-000296f0: 656e 2d65 6c73 6560 6020 6578 7072 6573  en-else`` expres
-00029700: 7369 6f6e 2e0a 0a20 2020 2041 7267 733a  sion...    Args:
-00029710: 0a20 2020 2020 2020 2063 6f6e 6469 7469  .        conditi
-00029720: 6f6e 3a20 4120 3a63 6c61 7373 3a60 436f  on: A :class:`Co
-00029730: 6c75 6d6e 6020 6578 7072 6573 7369 6f6e  lumn` expression
-00029740: 206f 7220 5351 4c20 7465 7874 2072 6570   or SQL text rep
-00029750: 7265 7365 6e74 696e 6720 7468 6520 7370  resenting the sp
-00029760: 6563 6966 6965 6420 636f 6e64 6974 696f  ecified conditio
-00029770: 6e2e 0a20 2020 2020 2020 2065 7870 7231  n..        expr1
-00029780: 3a20 4120 3a63 6c61 7373 3a60 436f 6c75  : A :class:`Colu
-00029790: 6d6e 6020 6578 7072 6573 7369 6f6e 206f  mn` expression o
-000297a0: 7220 6120 6c69 7465 7261 6c20 7661 6c75  r a literal valu
-000297b0: 652c 2077 6869 6368 2077 696c 6c20 6265  e, which will be
-000297c0: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
-000297d0: 2020 2020 2020 6966 2060 6063 6f6e 6469        if ``condi
-000297e0: 7469 6f6e 6060 2069 7320 7472 7565 2e0a  tion`` is true..
-000297f0: 2020 2020 2020 2020 6578 7072 323a 2041          expr2: A
-00029800: 203a 636c 6173 733a 6043 6f6c 756d 6e60   :class:`Column`
-00029810: 2065 7870 7265 7373 696f 6e20 6f72 2061   expression or a
-00029820: 206c 6974 6572 616c 2076 616c 7565 2c20   literal value, 
-00029830: 7768 6963 6820 7769 6c6c 2062 6520 7265  which will be re
-00029840: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
-00029850: 2020 2069 6620 6060 636f 6e64 6974 696f     if ``conditio
-00029860: 6e60 6020 6973 2066 616c 7365 2e0a 0a20  n`` is false... 
-00029870: 2020 2045 7861 6d70 6c65 733a 3a0a 0a20     Examples::.. 
-00029880: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00029890: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000298a0: 6174 6166 7261 6d65 285b 5472 7565 2c20  ataframe([True, 
-000298b0: 4661 6c73 652c 204e 6f6e 655d 2c20 7363  False, None], sc
-000298c0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-000298d0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000298e0: 7428 6966 6628 6466 5b22 6122 5d2c 206c  t(iff(df["a"], l
-000298f0: 6974 2822 7472 7565 2229 2c20 6c69 7428  it("true"), lit(
-00029900: 2266 616c 7365 2229 292e 616c 6961 7328  "false")).alias(
-00029910: 2269 6666 2229 292e 636f 6c6c 6563 7428  "iff")).collect(
-00029920: 290a 2020 2020 2020 2020 5b52 6f77 2849  ).        [Row(I
-00029930: 4646 3d27 7472 7565 2729 2c20 526f 7728  FF='true'), Row(
-00029940: 4946 463d 2766 616c 7365 2729 2c20 526f  IFF='false'), Ro
-00029950: 7728 4946 463d 2766 616c 7365 2729 5d0a  w(IFF='false')].
-00029960: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
-00029970: 726e 2062 7569 6c74 696e 2822 6966 6622  rn builtin("iff"
-00029980: 2928 5f74 6f5f 636f 6c5f 6966 5f73 716c  )(_to_col_if_sql
-00029990: 5f65 7870 7228 636f 6e64 6974 696f 6e2c  _expr(condition,
-000299a0: 2022 6966 6622 292c 2065 7870 7231 2c20   "iff"), expr1, 
-000299b0: 6578 7072 3229 0a0a 0a64 6566 2069 6e5f  expr2)...def in_
-000299c0: 280a 2020 2020 636f 6c73 3a20 4c69 7374  (.    cols: List
-000299d0: 5b43 6f6c 756d 6e4f 724e 616d 655d 2c0a  [ColumnOrName],.
-000299e0: 2020 2020 2a76 616c 733a 2055 6e69 6f6e      *vals: Union
-000299f0: 5b22 736e 6f77 666c 616b 652e 736e 6f77  ["snowflake.snow
-00029a00: 7061 726b 2e44 6174 6146 7261 6d65 222c  park.DataFrame",
-00029a10: 204c 6974 6572 616c 5479 7065 2c20 4974   LiteralType, It
-00029a20: 6572 6162 6c65 5b4c 6974 6572 616c 5479  erable[LiteralTy
-00029a30: 7065 5d5d 2c0a 2920 2d3e 2043 6f6c 756d  pe]],.) -> Colum
-00029a40: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00029a50: 7320 6120 636f 6e64 6974 696f 6e61 6c20  s a conditional 
-00029a60: 6578 7072 6573 7369 6f6e 2074 6861 7420  expression that 
-00029a70: 796f 7520 6361 6e20 7061 7373 2074 6f20  you can pass to 
-00029a80: 7468 6520 6669 6c74 6572 206f 7220 7768  the filter or wh
-00029a90: 6572 6520 6d65 7468 6f64 7320 746f 0a20  ere methods to. 
-00029aa0: 2020 2070 6572 666f 726d 2074 6865 2065     perform the e
-00029ab0: 7175 6976 616c 656e 7420 6f66 2061 2057  quivalent of a W
-00029ac0: 4845 5245 202e 2e2e 2049 4e20 7175 6572  HERE ... IN quer
-00029ad0: 7920 7468 6174 206d 6174 6368 6573 2072  y that matches r
-00029ae0: 6f77 7320 636f 6e74 6169 6e69 6e67 2061  ows containing a
-00029af0: 2073 6571 7565 6e63 6520 6f66 0a20 2020   sequence of.   
-00029b00: 2076 616c 7565 732e 0a0a 2020 2020 5468   values...    Th
-00029b10: 6520 6578 7072 6573 7369 6f6e 2065 7661  e expression eva
-00029b20: 6c75 6174 6573 2074 6f20 7472 7565 2069  luates to true i
-00029b30: 6620 7468 6520 7661 6c75 6573 2069 6e20  f the values in 
-00029b40: 6120 726f 7720 6d61 7463 6865 7320 7468  a row matches th
-00029b50: 6520 7661 6c75 6573 2069 6e20 6f6e 6520  e values in one 
-00029b60: 6f66 0a20 2020 2074 6865 2073 7065 6369  of.    the speci
-00029b70: 6669 6564 2073 6571 7565 6e63 6573 2e0a  fied sequences..
-00029b80: 0a20 2020 2054 6865 2066 6f6c 6c6f 7769  .    The followi
-00029b90: 6e67 2063 6f64 6520 7265 7475 726e 7320  ng code returns 
-00029ba0: 6120 4461 7461 4672 616d 6520 7468 6174  a DataFrame that
-00029bb0: 2063 6f6e 7461 696e 7320 7468 6520 726f   contains the ro
-00029bc0: 7773 2069 6e20 7768 6963 680a 2020 2020  ws in which.    
-00029bd0: 7468 6520 636f 6c75 6d6e 7320 6063 3160  the columns `c1`
-00029be0: 2061 6e64 2060 6332 6020 636f 6e74 6169   and `c2` contai
-00029bf0: 6e20 7468 6520 7661 6c75 6573 3a0a 2020  n the values:.  
-00029c00: 2020 2d20 6031 6020 616e 6420 6022 6122    - `1` and `"a"
-00029c10: 602c 206f 720a 2020 2020 2d20 6032 6020  `, or.    - `2` 
-00029c20: 616e 6420 6022 6222 600a 2020 2020 5468  and `"b"`.    Th
-00029c30: 6973 2069 7320 6571 7569 7661 6c65 6e74  is is equivalent
-00029c40: 2074 6f20 6060 5345 4c45 4354 202a 2046   to ``SELECT * F
-00029c50: 524f 4d20 7461 626c 6520 5748 4552 4520  ROM table WHERE 
-00029c60: 2863 312c 2063 3229 2049 4e20 2828 312c  (c1, c2) IN ((1,
-00029c70: 2027 6127 292c 2028 322c 2027 6227 2929   'a'), (2, 'b'))
-00029c80: 6060 2e0a 0a20 2020 2045 7861 6d70 6c65  ``...    Example
-00029c90: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00029ca0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00029cb0: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00029cc0: 312c 2022 6122 5d2c 205b 322c 2022 6222  1, "a"], [2, "b"
-00029cd0: 5d2c 205b 332c 2022 6322 5d5d 2c20 7363  ], [3, "c"]], sc
-00029ce0: 6865 6d61 3d5b 2263 6f6c 3122 2c20 2263  hema=["col1", "c
-00029cf0: 6f6c 3222 5d29 0a20 2020 2020 2020 203e  ol2"]).        >
-00029d00: 3e3e 2064 662e 6669 6c74 6572 2869 6e5f  >> df.filter(in_
-00029d10: 285b 636f 6c28 2263 6f6c 3122 292c 2063  ([col("col1"), c
-00029d20: 6f6c 2822 636f 6c32 2229 5d2c 205b 5b31  ol("col2")], [[1
-00029d30: 2c20 2261 225d 2c20 5b32 2c20 2262 225d  , "a"], [2, "b"]
-00029d40: 5d29 292e 7368 6f77 2829 0a20 2020 2020  ])).show().     
-00029d50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00029d60: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00029d70: 2243 4f4c 3122 2020 7c22 434f 4c32 2220  "COL1"  |"COL2" 
-00029d80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00029d90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00029da0: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
-00029db0: 7c61 2020 2020 2020 207c 0a20 2020 2020  |a       |.     
-00029dc0: 2020 207c 3220 2020 2020 2020 7c62 2020     |2       |b  
-00029dd0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00029de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029df0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00029e00: 4b4c 494e 453e 0a0a 2020 2020 5468 6520  KLINE>..    The 
-00029e10: 666f 6c6c 6f77 696e 6720 636f 6465 2072  following code r
-00029e20: 6574 7572 6e73 2061 2044 6174 6146 7261  eturns a DataFra
-00029e30: 6d65 2074 6861 7420 636f 6e74 6169 6e73  me that contains
-00029e40: 2074 6865 2072 6f77 7320 7768 6572 650a   the rows where.
-00029e50: 2020 2020 7468 6520 7661 6c75 6573 206f      the values o
-00029e60: 6620 7468 6520 636f 6c75 6d6e 7320 6063  f the columns `c
-00029e70: 3160 2061 6e64 2060 6332 6020 696e 2060  1` and `c2` in `
-00029e80: 6466 3260 206d 6174 6368 2074 6865 2076  df2` match the v
-00029e90: 616c 7565 7320 6f66 2074 6865 2063 6f6c  alues of the col
-00029ea0: 756d 6e73 0a20 2020 2060 6160 2061 6e64  umns.    `a` and
-00029eb0: 2060 6260 2069 6e20 6064 6631 602e 2054   `b` in `df1`. T
-00029ec0: 6869 7320 6973 2065 7175 6976 616c 656e  his is equivalen
-00029ed0: 7420 746f 0a20 2020 2060 6053 454c 4543  t to.    ``SELEC
-00029ee0: 5420 2a20 4652 4f4d 2074 6162 6c65 3220  T * FROM table2 
-00029ef0: 5748 4552 4520 2863 312c 2063 3229 2049  WHERE (c1, c2) I
-00029f00: 4e20 2853 454c 4543 5420 612c 2062 2046  N (SELECT a, b F
-00029f10: 524f 4d20 7461 626c 6531 2960 602e 0a0a  ROM table1)``...
-00029f20: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00029f30: 2020 2020 2020 203e 3e3e 2064 6631 203d         >>> df1 =
-00029f40: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
-00029f50: 6c65 6374 2031 2c20 2761 2722 290a 2020  lect 1, 'a'").  
-00029f60: 2020 2020 2020 3e3e 3e20 6466 2e66 696c        >>> df.fil
-00029f70: 7465 7228 696e 5f28 5b63 6f6c 2822 636f  ter(in_([col("co
-00029f80: 6c31 2229 2c20 636f 6c28 2263 6f6c 3222  l1"), col("col2"
-00029f90: 295d 2c20 6466 3129 292e 7368 6f77 2829  )], df1)).show()
-00029fa0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00029fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00029fc0: 2020 2020 207c 2243 4f4c 3122 2020 7c22       |"COL1"  |"
-00029fd0: 434f 4c32 2220 207c 0a20 2020 2020 2020  COL2"  |.       
-00029fe0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00029ff0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
-0002a000: 2020 2020 2020 7c61 2020 2020 2020 207c        |a       |
-0002a010: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002a020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002a030: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0002a040: 0a0a 2020 2020 4172 6773 3a3a 0a20 2020  ..    Args::.   
-0002a050: 2020 2020 2063 6f6c 733a 2041 206c 6973       cols: A lis
-0002a060: 7420 6f66 2074 6865 2063 6f6c 756d 6e73  t of the columns
-0002a070: 2074 6f20 636f 6d70 6172 6520 666f 7220   to compare for 
-0002a080: 7468 6520 494e 206f 7065 7261 7469 6f6e  the IN operation
-0002a090: 2e0a 2020 2020 2020 2020 7661 6c73 3a20  ..        vals: 
-0002a0a0: 4120 6c69 7374 2063 6f6e 7461 696e 696e  A list containin
-0002a0b0: 6720 7468 6520 7661 6c75 6573 2074 6f20  g the values to 
-0002a0c0: 636f 6d70 6172 6520 666f 7220 7468 6520  compare for the 
-0002a0d0: 494e 206f 7065 7261 7469 6f6e 2e0a 2020  IN operation..  
-0002a0e0: 2020 2222 220a 2020 2020 7661 6c73 203d    """.    vals =
-0002a0f0: 2070 6172 7365 5f70 6f73 6974 696f 6e61   parse_positiona
-0002a100: 6c5f 6172 6773 5f74 6f5f 6c69 7374 282a  l_args_to_list(*
-0002a110: 7661 6c73 290a 2020 2020 636f 6c75 6d6e  vals).    column
-0002a120: 7320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  s = [_to_col_if_
-0002a130: 7374 7228 632c 2022 696e 5f22 2920 666f  str(c, "in_") fo
-0002a140: 7220 6320 696e 2063 6f6c 735d 0a20 2020  r c in cols].   
-0002a150: 2072 6574 7572 6e20 436f 6c75 6d6e 284d   return Column(M
-0002a160: 756c 7469 706c 6545 7870 7265 7373 696f  ultipleExpressio
-0002a170: 6e28 5b63 2e5f 6578 7072 6573 7369 6f6e  n([c._expression
-0002a180: 2066 6f72 2063 2069 6e20 636f 6c75 6d6e   for c in column
-0002a190: 735d 2929 2e69 6e5f 2876 616c 7329 0a0a  s])).in_(vals)..
-0002a1a0: 0a64 6566 2063 756d 655f 6469 7374 2829  .def cume_dist()
-0002a1b0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0002a1c0: 2222 220a 2020 2020 4669 6e64 7320 7468  """.    Finds th
-0002a1d0: 6520 6375 6d75 6c61 7469 7665 2064 6973  e cumulative dis
-0002a1e0: 7472 6962 7574 696f 6e20 6f66 2061 2076  tribution of a v
-0002a1f0: 616c 7565 2077 6974 6820 7265 6761 7264  alue with regard
-0002a200: 2074 6f20 6f74 6865 7220 7661 6c75 6573   to other values
-0002a210: 0a20 2020 2077 6974 6869 6e20 7468 6520  .    within the 
-0002a220: 7361 6d65 2077 696e 646f 7720 7061 7274  same window part
-0002a230: 6974 696f 6e2e 0a0a 2020 2020 4578 616d  ition...    Exam
-0002a240: 706c 653a 0a0a 2020 2020 2020 2020 3e3e  ple:..        >>
-0002a250: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0002a260: 2e73 6e6f 7770 6172 6b2e 7769 6e64 6f77  .snowpark.window
-0002a270: 2069 6d70 6f72 7420 5769 6e64 6f77 0a20   import Window. 
-0002a280: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002a290: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002a2a0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-0002a2b0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
-0002a2c0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002a2d0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0002a2e0: 6672 616d 6528 5b5b 312c 2032 5d2c 205b  frame([[1, 2], [
-0002a2f0: 312c 2032 5d2c 205b 312c 335d 2c20 5b34  1, 2], [1,3], [4
-0002a300: 2c20 355d 2c20 5b32 2c20 335d 2c20 5b33  , 5], [2, 3], [3
-0002a310: 2c20 345d 2c20 5b34 2c20 375d 2c20 5b33  , 4], [4, 7], [3
-0002a320: 2c37 5d2c 205b 342c 355d 5d2c 2073 6368  ,7], [4,5]], sch
-0002a330: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-0002a340: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002a350: 656c 6563 7428 6375 6d65 5f64 6973 7428  elect(cume_dist(
-0002a360: 292e 6f76 6572 2857 696e 646f 772e 6f72  ).over(Window.or
-0002a370: 6465 725f 6279 2822 6122 2929 2e63 6173  der_by("a")).cas
-0002a380: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
-0002a390: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
-0002a3a0: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0002a3b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002a3c0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0002a3d0: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0002a3e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0002a3f0: 2020 2020 2020 207c 302e 3333 3320 2020         |0.333   
-0002a400: 2020 7c0a 2020 2020 2020 2020 7c30 2e33    |.        |0.3
-0002a410: 3333 2020 2020 207c 0a20 2020 2020 2020  33     |.       
-0002a420: 207c 302e 3333 3320 2020 2020 7c0a 2020   |0.333     |.  
-0002a430: 2020 2020 2020 7c30 2e34 3434 2020 2020        |0.444    
-0002a440: 207c 0a20 2020 2020 2020 207c 302e 3636   |.        |0.66
-0002a450: 3720 2020 2020 7c0a 2020 2020 2020 2020  7     |.        
-0002a460: 7c30 2e36 3637 2020 2020 207c 0a20 2020  |0.667     |.   
-0002a470: 2020 2020 207c 312e 3030 3020 2020 2020       |1.000     
-0002a480: 7c0a 2020 2020 2020 2020 7c31 2e30 3030  |.        |1.000
-0002a490: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0002a4a0: 312e 3030 3020 2020 2020 7c0a 2020 2020  1.000     |.    
-0002a4b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002a4c0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0002a4d0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0002a4e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0002a4f0: 2263 756d 655f 6469 7374 2229 2829 0a0a  "cume_dist")()..
-0002a500: 0a64 6566 2072 616e 6b28 2920 2d3e 2043  .def rank() -> C
-0002a510: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-0002a520: 2020 2052 6574 7572 6e73 2074 6865 2072     Returns the r
-0002a530: 616e 6b20 6f66 2061 2076 616c 7565 2077  ank of a value w
-0002a540: 6974 6869 6e20 616e 206f 7264 6572 6564  ithin an ordered
-0002a550: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
-0002a560: 2e0a 2020 2020 5468 6520 7261 6e6b 2076  ..    The rank v
-0002a570: 616c 7565 2073 7461 7274 7320 6174 2031  alue starts at 1
-0002a580: 2061 6e64 2063 6f6e 7469 6e75 6573 2075   and continues u
-0002a590: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-0002a5a0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-0002a5b0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-0002a5c0: 7770 6172 6b2e 7769 6e64 6f77 2069 6d70  wpark.window imp
-0002a5d0: 6f72 7420 5769 6e64 6f77 0a20 2020 2020  ort Window.     
-0002a5e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0002a5f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0002a600: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-0002a610: 2e20 2020 2020 5b0a 2020 2020 2020 2020  .     [.        
-0002a620: 2e2e 2e20 2020 2020 2020 2020 5b31 2c20  ...         [1, 
-0002a630: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
-0002a640: 2e2e 2020 2020 2020 2020 205b 312c 2032  ..         [1, 2
-0002a650: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
-0002a660: 2e20 2020 2020 2020 2020 5b32 2c20 312c  .         [2, 1,
-0002a670: 2031 305d 2c0a 2020 2020 2020 2020 2e2e   10],.        ..
-0002a680: 2e20 2020 2020 2020 2020 5b32 2c20 322c  .         [2, 2,
-0002a690: 2031 5d2c 0a20 2020 2020 2020 202e 2e2e   1],.        ...
-0002a6a0: 2020 2020 2020 2020 205b 322c 2032 2c20           [2, 2, 
-0002a6b0: 335d 2c0a 2020 2020 2020 2020 2e2e 2e20  3],.        ... 
-0002a6c0: 2020 2020 5d2c 0a20 2020 2020 2020 202e      ],.        .
-0002a6d0: 2e2e 2020 2020 2073 6368 656d 613d 5b22  ..     schema=["
-0002a6e0: 7822 2c20 2279 222c 2022 7a22 5d0a 2020  x", "y", "z"].  
-0002a6f0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
-0002a700: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002a710: 7428 7261 6e6b 2829 2e6f 7665 7228 5769  t(rank().over(Wi
-0002a720: 6e64 6f77 2e70 6172 7469 7469 6f6e 5f62  ndow.partition_b
-0002a730: 7928 636f 6c28 2258 2229 292e 6f72 6465  y(col("X")).orde
-0002a740: 725f 6279 2863 6f6c 2822 5922 2929 292e  r_by(col("Y"))).
-0002a750: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0002a760: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0002a770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002a780: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0002a790: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002a7a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002a7b0: 3120 2020 2020 2020 2020 7c0a 2020 2020  1         |.    
-0002a7c0: 2020 2020 7c32 2020 2020 2020 2020 207c      |2         |
-0002a7d0: 0a20 2020 2020 2020 207c 3220 2020 2020  .        |2     
-0002a7e0: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
-0002a7f0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0002a800: 2020 207c 3120 2020 2020 2020 2020 7c0a     |1         |.
-0002a810: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002a820: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0002a830: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0002a840: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0002a850: 7469 6e28 2272 616e 6b22 2928 290a 0a0a  tin("rank")()...
-0002a860: 6465 6620 7065 7263 656e 745f 7261 6e6b  def percent_rank
-0002a870: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-0002a880: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-0002a890: 7320 7468 6520 7265 6c61 7469 7665 2072  s the relative r
-0002a8a0: 616e 6b20 6f66 2061 2076 616c 7565 2077  ank of a value w
-0002a8b0: 6974 6869 6e20 6120 6772 6f75 7020 6f66  ithin a group of
-0002a8c0: 2076 616c 7565 732c 2073 7065 6369 6669   values, specifi
-0002a8d0: 6564 2061 7320 6120 7065 7263 656e 7461  ed as a percenta
-0002a8e0: 6765 0a20 2020 2072 616e 6769 6e67 2066  ge.    ranging f
-0002a8f0: 726f 6d20 302e 3020 746f 2031 2e30 2e0a  rom 0.0 to 1.0..
-0002a900: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0002a910: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002a920: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002a930: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
-0002a940: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
-0002a950: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002a960: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0002a970: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-0002a980: 2020 205b 0a20 2020 2020 2020 202e 2e2e     [.        ...
-0002a990: 2020 2020 2020 2020 205b 312c 2032 2c20           [1, 2, 
-0002a9a0: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
-0002a9b0: 2020 2020 2020 2020 5b31 2c20 322c 2033          [1, 2, 3
-0002a9c0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0002a9d0: 2020 2020 2020 205b 322c 2031 2c20 3130         [2, 1, 10
-0002a9e0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0002a9f0: 2020 2020 2020 205b 322c 2032 2c20 315d         [2, 2, 1]
-0002aa00: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0002aa10: 2020 2020 2020 5b32 2c20 322c 2033 5d2c        [2, 2, 3],
-0002aa20: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0002aa30: 205d 2c0a 2020 2020 2020 2020 2e2e 2e20   ],.        ... 
-0002aa40: 2020 2020 7363 6865 6d61 3d5b 2278 222c      schema=["x",
-0002aa50: 2022 7922 2c20 227a 225d 0a20 2020 2020   "y", "z"].     
-0002aa60: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-0002aa70: 203e 3e3e 2064 662e 7365 6c65 6374 2870   >>> df.select(p
-0002aa80: 6572 6365 6e74 5f72 616e 6b28 292e 6f76  ercent_rank().ov
-0002aa90: 6572 2857 696e 646f 772e 7061 7274 6974  er(Window.partit
-0002aaa0: 696f 6e5f 6279 2822 7822 292e 6f72 6465  ion_by("x").orde
-0002aab0: 725f 6279 2863 6f6c 2822 7922 2929 292e  r_by(col("y"))).
-0002aac0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0002aad0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0002aae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002aaf0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0002ab00: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002ab10: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002ab20: 302e 3020 2020 2020 2020 7c0a 2020 2020  0.0       |.    
-0002ab30: 2020 2020 7c30 2e35 2020 2020 2020 207c      |0.5       |
-0002ab40: 0a20 2020 2020 2020 207c 302e 3520 2020  .        |0.5   
-0002ab50: 2020 2020 7c0a 2020 2020 2020 2020 7c30      |.        |0
-0002ab60: 2e30 2020 2020 2020 207c 0a20 2020 2020  .0       |.     
-0002ab70: 2020 207c 302e 3020 2020 2020 2020 7c0a     |0.0       |.
-0002ab80: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002ab90: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0002aba0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0002abb0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0002abc0: 7469 6e28 2270 6572 6365 6e74 5f72 616e  tin("percent_ran
-0002abd0: 6b22 2928 290a 0a0a 6465 6620 6465 6e73  k")()...def dens
-0002abe0: 655f 7261 6e6b 2829 202d 3e20 436f 6c75  e_rank() -> Colu
-0002abf0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0002ac00: 5265 7475 726e 7320 7468 6520 7261 6e6b  Returns the rank
-0002ac10: 206f 6620 6120 7661 6c75 6520 7769 7468   of a value with
-0002ac20: 696e 2061 2067 726f 7570 206f 6620 7661  in a group of va
-0002ac30: 6c75 6573 2c20 7769 7468 6f75 7420 6761  lues, without ga
-0002ac40: 7073 2069 6e20 7468 6520 7261 6e6b 732e  ps in the ranks.
-0002ac50: 0a20 2020 2054 6865 2072 616e 6b20 7661  .    The rank va
-0002ac60: 6c75 6520 7374 6172 7473 2061 7420 3120  lue starts at 1 
-0002ac70: 616e 6420 636f 6e74 696e 7565 7320 7570  and continues up
-0002ac80: 2073 6571 7565 6e74 6961 6c6c 792e 0a20   sequentially.. 
-0002ac90: 2020 2049 6620 7477 6f20 7661 6c75 6573     If two values
-0002aca0: 2061 7265 2074 6865 2073 616d 652c 2074   are the same, t
-0002acb0: 6865 7920 7769 6c6c 2068 6176 6520 7468  hey will have th
-0002acc0: 6520 7361 6d65 2072 616e 6b2e 0a0a 2020  e same rank...  
-0002acd0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0002ace0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0002acf0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0002ad00: 2e77 696e 646f 7720 696d 706f 7274 2057  .window import W
-0002ad10: 696e 646f 770a 2020 2020 2020 2020 3e3e  indow.        >>
-0002ad20: 3e20 7769 6e64 6f77 203d 2057 696e 646f  > window = Windo
-0002ad30: 772e 6f72 6465 725f 6279 2822 6b65 7922  w.order_by("key"
-0002ad40: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002ad50: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0002ad60: 655f 6461 7461 6672 616d 6528 5b28 312c  e_dataframe([(1,
-0002ad70: 2022 3122 292c 2028 322c 2022 3222 292c   "1"), (2, "2"),
-0002ad80: 2028 312c 2022 3322 292c 2028 322c 2022   (1, "3"), (2, "
-0002ad90: 3422 295d 2c20 7363 6865 6d61 3d5b 226b  4")], schema=["k
-0002ada0: 6579 222c 2022 7661 6c75 6522 5d29 0a20  ey", "value"]). 
-0002adb0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002adc0: 6c65 6374 2864 656e 7365 5f72 616e 6b28  lect(dense_rank(
-0002add0: 292e 6f76 6572 2877 696e 646f 7729 2e61  ).over(window).a
-0002ade0: 735f 2822 6465 6e73 655f 7261 6e6b 2229  s_("dense_rank")
-0002adf0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0002ae00: 2020 2020 5b52 6f77 2844 454e 5345 5f52      [Row(DENSE_R
-0002ae10: 414e 4b3d 3129 2c20 526f 7728 4445 4e53  ANK=1), Row(DENS
-0002ae20: 455f 5241 4e4b 3d31 292c 2052 6f77 2844  E_RANK=1), Row(D
-0002ae30: 454e 5345 5f52 414e 4b3d 3229 2c20 526f  ENSE_RANK=2), Ro
-0002ae40: 7728 4445 4e53 455f 5241 4e4b 3d32 295d  w(DENSE_RANK=2)]
-0002ae50: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
-0002ae60: 7572 6e20 6275 696c 7469 6e28 2264 656e  urn builtin("den
-0002ae70: 7365 5f72 616e 6b22 2928 290a 0a0a 6465  se_rank")()...de
-0002ae80: 6620 726f 775f 6e75 6d62 6572 2829 202d  f row_number() -
-0002ae90: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0002aea0: 220a 2020 2020 5265 7475 726e 7320 6120  ".    Returns a 
-0002aeb0: 756e 6971 7565 2072 6f77 206e 756d 6265  unique row numbe
-0002aec0: 7220 666f 7220 6561 6368 2072 6f77 2077  r for each row w
-0002aed0: 6974 6869 6e20 6120 7769 6e64 6f77 2070  ithin a window p
-0002aee0: 6172 7469 7469 6f6e 2e0a 2020 2020 5468  artition..    Th
-0002aef0: 6520 726f 7720 6e75 6d62 6572 2073 7461  e row number sta
-0002af00: 7274 7320 6174 2031 2061 6e64 2063 6f6e  rts at 1 and con
-0002af10: 7469 6e75 6573 2075 7020 7365 7175 656e  tinues up sequen
-0002af20: 7469 616c 6c79 2e0a 0a20 2020 2045 7861  tially...    Exa
-0002af30: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0002af40: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0002af50: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
-0002af60: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
-0002af70: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002af80: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002af90: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
-0002afa0: 2020 2020 2e2e 2e20 2020 2020 5b0a 2020      ...     [.  
-0002afb0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0002afc0: 2020 5b31 2c20 322c 2031 5d2c 0a20 2020    [1, 2, 1],.   
-0002afd0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0002afe0: 205b 312c 2032 2c20 335d 2c0a 2020 2020   [1, 2, 3],.    
-0002aff0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0002b000: 5b32 2c20 312c 2031 305d 2c0a 2020 2020  [2, 1, 10],.    
-0002b010: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0002b020: 5b32 2c20 322c 2031 5d2c 0a20 2020 2020  [2, 2, 1],.     
-0002b030: 2020 202e 2e2e 2020 2020 2020 2020 205b     ...         [
-0002b040: 322c 2032 2c20 335d 2c0a 2020 2020 2020  2, 2, 3],.      
-0002b050: 2020 2e2e 2e20 2020 2020 5d2c 0a20 2020    ...     ],.   
-0002b060: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
-0002b070: 656d 613d 5b22 7822 2c20 2279 222c 2022  ema=["x", "y", "
-0002b080: 7a22 5d0a 2020 2020 2020 2020 2e2e 2e20  z"].        ... 
-0002b090: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002b0a0: 2e73 656c 6563 7428 726f 775f 6e75 6d62  .select(row_numb
-0002b0b0: 6572 2829 2e6f 7665 7228 5769 6e64 6f77  er().over(Window
-0002b0c0: 2e70 6172 7469 7469 6f6e 5f62 7928 636f  .partition_by(co
-0002b0d0: 6c28 2258 2229 292e 6f72 6465 725f 6279  l("X")).order_by
-0002b0e0: 2863 6f6c 2822 5922 2929 292e 616c 6961  (col("Y"))).alia
-0002b0f0: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-0002b100: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0002b110: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002b120: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-0002b130: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0002b140: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
-0002b150: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0002b160: 7c32 2020 2020 2020 2020 207c 0a20 2020  |2         |.   
-0002b170: 2020 2020 207c 3320 2020 2020 2020 2020       |3         
-0002b180: 7c0a 2020 2020 2020 2020 7c31 2020 2020  |.        |1    
-0002b190: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0002b1a0: 3220 2020 2020 2020 2020 7c0a 2020 2020  2         |.    
-0002b1b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002b1c0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0002b1d0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0002b1e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0002b1f0: 2272 6f77 5f6e 756d 6265 7222 2928 290a  "row_number")().
-0002b200: 0a0a 6465 6620 6c61 6728 0a20 2020 2065  ..def lag(.    e
-0002b210: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
-0002b220: 2020 2020 6f66 6673 6574 3a20 696e 7420      offset: int 
-0002b230: 3d20 312c 0a20 2020 2064 6566 6175 6c74  = 1,.    default
-0002b240: 5f76 616c 7565 3a20 4f70 7469 6f6e 616c  _value: Optional
-0002b250: 5b43 6f6c 756d 6e4f 724c 6974 6572 616c  [ColumnOrLiteral
-0002b260: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6967  ] = None,.    ig
-0002b270: 6e6f 7265 5f6e 756c 6c73 3a20 626f 6f6c  nore_nulls: bool
-0002b280: 203d 2046 616c 7365 2c0a 2920 2d3e 2043   = False,.) -> C
-0002b290: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-0002b2a0: 2020 2041 6363 6573 7365 7320 6461 7461     Accesses data
-0002b2b0: 2069 6e20 6120 7072 6576 696f 7573 2072   in a previous r
-0002b2c0: 6f77 2069 6e20 7468 6520 7361 6d65 2072  ow in the same r
-0002b2d0: 6573 756c 7420 7365 7420 7769 7468 6f75  esult set withou
-0002b2e0: 7420 6861 7669 6e67 2074 6f0a 2020 2020  t having to.    
-0002b2f0: 6a6f 696e 2074 6865 2074 6162 6c65 2074  join the table t
-0002b300: 6f20 6974 7365 6c66 2e0a 0a20 2020 2045  o itself...    E
-0002b310: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0002b320: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0002b330: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7769  lake.snowpark.wi
-0002b340: 6e64 6f77 2069 6d70 6f72 7420 5769 6e64  ndow import Wind
-0002b350: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
-0002b360: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0002b370: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-0002b380: 2020 2020 2020 2e2e 2e20 2020 2020 5b0a        ...     [.
-0002b390: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002b3a0: 2020 2020 5b31 2c20 322c 2031 5d2c 0a20      [1, 2, 1],. 
-0002b3b0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0002b3c0: 2020 205b 312c 2032 2c20 335d 2c0a 2020     [1, 2, 3],.  
-0002b3d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0002b3e0: 2020 5b32 2c20 312c 2031 305d 2c0a 2020    [2, 1, 10],.  
-0002b3f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0002b400: 2020 5b32 2c20 322c 2031 5d2c 0a20 2020    [2, 2, 1],.   
-0002b410: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0002b420: 205b 322c 2032 2c20 335d 2c0a 2020 2020   [2, 2, 3],.    
-0002b430: 2020 2020 2e2e 2e20 2020 2020 5d2c 0a20      ...     ],. 
-0002b440: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-0002b450: 6368 656d 613d 5b22 7822 2c20 2279 222c  chema=["x", "y",
-0002b460: 2022 7a22 5d0a 2020 2020 2020 2020 2e2e   "z"].        ..
-0002b470: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-0002b480: 6466 2e73 656c 6563 7428 6c61 6728 225a  df.select(lag("Z
-0002b490: 2229 2e6f 7665 7228 5769 6e64 6f77 2e70  ").over(Window.p
-0002b4a0: 6172 7469 7469 6f6e 5f62 7928 636f 6c28  artition_by(col(
-0002b4b0: 2258 2229 292e 6f72 6465 725f 6279 2863  "X")).order_by(c
-0002b4c0: 6f6c 2822 5922 2929 292e 616c 6961 7328  ol("Y"))).alias(
-0002b4d0: 2272 6573 756c 7422 2929 2e63 6f6c 6c65  "result")).colle
-0002b4e0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0002b4f0: 7728 5245 5355 4c54 3d4e 6f6e 6529 2c20  w(RESULT=None), 
-0002b500: 526f 7728 5245 5355 4c54 3d31 3029 2c20  Row(RESULT=10), 
-0002b510: 526f 7728 5245 5355 4c54 3d31 292c 2052  Row(RESULT=1), R
-0002b520: 6f77 2852 4553 554c 543d 4e6f 6e65 292c  ow(RESULT=None),
-0002b530: 2052 6f77 2852 4553 554c 543d 3129 5d0a   Row(RESULT=1)].
-0002b540: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0002b550: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0002b560: 2c20 226c 6167 2229 0a20 2020 2072 6574  , "lag").    ret
-0002b570: 7572 6e20 436f 6c75 6d6e 280a 2020 2020  urn Column(.    
-0002b580: 2020 2020 4c61 6728 632e 5f65 7870 7265      Lag(c._expre
-0002b590: 7373 696f 6e2c 206f 6666 7365 742c 2043  ssion, offset, C
-0002b5a0: 6f6c 756d 6e2e 5f74 6f5f 6578 7072 2864  olumn._to_expr(d
-0002b5b0: 6566 6175 6c74 5f76 616c 7565 292c 2069  efault_value), i
-0002b5c0: 676e 6f72 655f 6e75 6c6c 7329 0a20 2020  gnore_nulls).   
-0002b5d0: 2029 0a0a 0a64 6566 206c 6561 6428 0a20   )...def lead(. 
-0002b5e0: 2020 2065 3a20 436f 6c75 6d6e 4f72 4e61     e: ColumnOrNa
-0002b5f0: 6d65 2c0a 2020 2020 6f66 6673 6574 3a20  me,.    offset: 
-0002b600: 696e 7420 3d20 312c 0a20 2020 2064 6566  int = 1,.    def
-0002b610: 6175 6c74 5f76 616c 7565 3a20 4f70 7469  ault_value: Opti
-0002b620: 6f6e 616c 5b55 6e69 6f6e 5b43 6f6c 756d  onal[Union[Colum
-0002b630: 6e2c 204c 6974 6572 616c 5479 7065 5d5d  n, LiteralType]]
-0002b640: 203d 204e 6f6e 652c 0a20 2020 2069 676e   = None,.    ign
-0002b650: 6f72 655f 6e75 6c6c 733a 2062 6f6f 6c20  ore_nulls: bool 
-0002b660: 3d20 4661 6c73 652c 0a29 202d 3e20 436f  = False,.) -> Co
-0002b670: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-0002b680: 2020 4163 6365 7373 6573 2064 6174 6120    Accesses data 
-0002b690: 696e 2061 2073 7562 7365 7175 656e 7420  in a subsequent 
-0002b6a0: 726f 7720 696e 2074 6865 2073 616d 6520  row in the same 
-0002b6b0: 7265 7375 6c74 2073 6574 2077 6974 686f  result set witho
-0002b6c0: 7574 2068 6176 696e 6720 746f 0a20 2020  ut having to.   
-0002b6d0: 206a 6f69 6e20 7468 6520 7461 626c 6520   join the table 
-0002b6e0: 746f 2069 7473 656c 662e 0a0a 2020 2020  to itself...    
-0002b6f0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0002b700: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0002b710: 666c 616b 652e 736e 6f77 7061 726b 2e77  flake.snowpark.w
-0002b720: 696e 646f 7720 696d 706f 7274 2057 696e  indow import Win
-0002b730: 646f 770a 2020 2020 2020 2020 3e3e 3e20  dow.        >>> 
-0002b740: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002b750: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
-0002b760: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
-0002b770: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0002b780: 2020 2020 205b 312c 2032 2c20 315d 2c0a       [1, 2, 1],.
-0002b790: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002b7a0: 2020 2020 5b31 2c20 322c 2033 5d2c 0a20      [1, 2, 3],. 
-0002b7b0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0002b7c0: 2020 205b 322c 2031 2c20 3130 5d2c 0a20     [2, 1, 10],. 
-0002b7d0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0002b7e0: 2020 205b 322c 2032 2c20 315d 2c0a 2020     [2, 2, 1],.  
-0002b7f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0002b800: 2020 5b32 2c20 322c 2033 5d2c 0a20 2020    [2, 2, 3],.   
-0002b810: 2020 2020 202e 2e2e 2020 2020 205d 2c0a       ...     ],.
-0002b820: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002b830: 7363 6865 6d61 3d5b 2278 222c 2022 7922  schema=["x", "y"
-0002b840: 2c20 227a 225d 0a20 2020 2020 2020 202e  , "z"].        .
-0002b850: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-0002b860: 2064 662e 7365 6c65 6374 286c 6561 6428   df.select(lead(
-0002b870: 225a 2229 2e6f 7665 7228 5769 6e64 6f77  "Z").over(Window
-0002b880: 2e70 6172 7469 7469 6f6e 5f62 7928 636f  .partition_by(co
-0002b890: 6c28 2258 2229 292e 6f72 6465 725f 6279  l("X")).order_by
-0002b8a0: 2863 6f6c 2822 5922 2929 292e 616c 6961  (col("Y"))).alia
-0002b8b0: 7328 2272 6573 756c 7422 2929 2e63 6f6c  s("result")).col
-0002b8c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0002b8d0: 526f 7728 5245 5355 4c54 3d31 292c 2052  Row(RESULT=1), R
-0002b8e0: 6f77 2852 4553 554c 543d 3329 2c20 526f  ow(RESULT=3), Ro
-0002b8f0: 7728 5245 5355 4c54 3d4e 6f6e 6529 2c20  w(RESULT=None), 
-0002b900: 526f 7728 5245 5355 4c54 3d33 292c 2052  Row(RESULT=3), R
-0002b910: 6f77 2852 4553 554c 543d 4e6f 6e65 295d  ow(RESULT=None)]
-0002b920: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0002b930: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002b940: 652c 2022 6c65 6164 2229 0a20 2020 2072  e, "lead").    r
-0002b950: 6574 7572 6e20 436f 6c75 6d6e 280a 2020  eturn Column(.  
-0002b960: 2020 2020 2020 4c65 6164 2863 2e5f 6578        Lead(c._ex
-0002b970: 7072 6573 7369 6f6e 2c20 6f66 6673 6574  pression, offset
-0002b980: 2c20 436f 6c75 6d6e 2e5f 746f 5f65 7870  , Column._to_exp
-0002b990: 7228 6465 6661 756c 745f 7661 6c75 6529  r(default_value)
-0002b9a0: 2c20 6967 6e6f 7265 5f6e 756c 6c73 290a  , ignore_nulls).
-0002b9b0: 2020 2020 290a 0a0a 6465 6620 6c61 7374      )...def last
-0002b9c0: 5f76 616c 7565 280a 2020 2020 653a 2043  _value(.    e: C
-0002b9d0: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
-0002b9e0: 2069 676e 6f72 655f 6e75 6c6c 733a 2062   ignore_nulls: b
-0002b9f0: 6f6f 6c20 3d20 4661 6c73 652c 0a29 202d  ool = False,.) -
-0002ba00: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0002ba10: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
-0002ba20: 6520 6c61 7374 2076 616c 7565 2077 6974  e last value wit
-0002ba30: 6869 6e20 616e 206f 7264 6572 6564 2067  hin an ordered g
-0002ba40: 726f 7570 206f 6620 7661 6c75 6573 2e0a  roup of values..
-0002ba50: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0002ba60: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0002ba70: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0002ba80: 6172 6b2e 7769 6e64 6f77 2069 6d70 6f72  ark.window impor
-0002ba90: 7420 5769 6e64 6f77 0a20 2020 2020 2020  t Window.       
-0002baa0: 203e 3e3e 2077 696e 646f 7720 3d20 5769   >>> window = Wi
-0002bab0: 6e64 6f77 2e70 6172 7469 7469 6f6e 5f62  ndow.partition_b
-0002bac0: 7928 2263 6f6c 756d 6e31 2229 2e6f 7264  y("column1").ord
-0002bad0: 6572 5f62 7928 2263 6f6c 756d 6e32 2229  er_by("column2")
+000171e0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+000171f0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00017200: 7228 636f 6c2c 2022 636f 6e74 6169 6e73  r(col, "contains
+00017210: 2229 0a20 2020 2073 203d 205f 746f 5f63  ").    s = _to_c
+00017220: 6f6c 5f69 665f 7374 7228 7374 7269 6e67  ol_if_str(string
+00017230: 2c20 2263 6f6e 7461 696e 7322 290a 2020  , "contains").  
+00017240: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00017250: 2822 636f 6e74 6169 6e73 2229 2863 2c20  ("contains")(c, 
+00017260: 7329 0a0a 0a64 6566 2073 7461 7274 7377  s)...def startsw
+00017270: 6974 6828 636f 6c3a 2043 6f6c 756d 6e4f  ith(col: ColumnO
+00017280: 724e 616d 652c 2073 7472 3a20 436f 6c75  rName, str: Colu
+00017290: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+000172a0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+000172b0: 726e 7320 7472 7565 2069 6620 636f 6c20  rns true if col 
+000172c0: 7374 6172 7473 2077 6974 6820 7374 722e  starts with str.
+000172d0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+000172e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+000172f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00017300: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+00017310: 2020 202e 2e2e 2020 2020 205b 5b22 6162     ...     [["ab
+00017320: 6322 2c20 2261 225d 2c20 5b22 6162 6322  c", "a"], ["abc"
+00017330: 2c20 2273 225d 5d2c 0a20 2020 2020 2020  , "s"]],.       
+00017340: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00017350: 5b22 5322 2c20 2250 225d 2c0a 2020 2020  ["S", "P"],.    
+00017360: 2020 2020 2e2e 2e20 292e 7365 6c65 6374      ... ).select
+00017370: 2873 7461 7274 7377 6974 6828 636f 6c28  (startswith(col(
+00017380: 2253 2229 2c20 636f 6c28 2250 2229 2929  "S"), col("P")))
+00017390: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000173a0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000173b0: 2020 5b52 6f77 2853 5441 5254 5357 4954    [Row(STARTSWIT
+000173c0: 4828 2253 222c 2022 5022 293d 5472 7565  H("S", "P")=True
+000173d0: 292c 2052 6f77 2853 5441 5254 5357 4954  ), Row(STARTSWIT
+000173e0: 4828 2253 222c 2022 5022 293d 4661 6c73  H("S", "P")=Fals
+000173f0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+00017400: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00017410: 7472 2863 6f6c 2c20 2273 7461 7274 7377  tr(col, "startsw
+00017420: 6974 6822 290a 2020 2020 7320 3d20 5f74  ith").    s = _t
+00017430: 6f5f 636f 6c5f 6966 5f73 7472 2873 7472  o_col_if_str(str
+00017440: 2c20 2273 7461 7274 7377 6974 6822 290a  , "startswith").
+00017450: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00017460: 696e 2822 7374 6172 7473 7769 7468 2229  in("startswith")
+00017470: 2863 2c20 7329 0a0a 0a64 6566 2065 6e64  (c, s)...def end
+00017480: 7377 6974 6828 636f 6c3a 2043 6f6c 756d  swith(col: Colum
+00017490: 6e4f 724e 616d 652c 2073 7472 3a20 436f  nOrName, str: Co
+000174a0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000174b0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+000174c0: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
+000174d0: 6966 2063 6f6c 2065 6e64 7320 7769 7468  if col ends with
+000174e0: 2073 7472 2e0a 0a20 2020 2045 7861 6d70   str...    Examp
+000174f0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+00017500: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00017510: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00017520: 5b22 6170 706c 6522 2c20 2262 616e 616e  ["apple", "banan
+00017530: 6122 2c20 2270 6561 6368 225d 2c20 7363  a", "peach"], sc
+00017540: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00017550: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00017560: 7428 656e 6473 7769 7468 2864 665b 2261  t(endswith(df["a
+00017570: 225d 2c20 6c69 7428 2261 6e61 2229 292e  "], lit("ana")).
+00017580: 616c 6961 7328 2265 6e64 7377 6974 6822  alias("endswith"
+00017590: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000175a0: 2020 2020 205b 526f 7728 454e 4453 5749       [Row(ENDSWI
+000175b0: 5448 3d46 616c 7365 292c 2052 6f77 2845  TH=False), Row(E
+000175c0: 4e44 5357 4954 483d 5472 7565 292c 2052  NDSWITH=True), R
+000175d0: 6f77 2845 4e44 5357 4954 483d 4661 6c73  ow(ENDSWITH=Fals
+000175e0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+000175f0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00017600: 7472 2863 6f6c 2c20 2265 6e64 7377 6974  tr(col, "endswit
+00017610: 6822 290a 2020 2020 7320 3d20 5f74 6f5f  h").    s = _to_
+00017620: 636f 6c5f 6966 5f73 7472 2873 7472 2c20  col_if_str(str, 
+00017630: 2265 6e64 7377 6974 6822 290a 2020 2020  "endswith").    
+00017640: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00017650: 656e 6473 7769 7468 2229 2863 2c20 7329  endswith")(c, s)
+00017660: 0a0a 0a64 6566 2069 6e73 6572 7428 0a20  ...def insert(. 
+00017670: 2020 2062 6173 655f 6578 7072 3a20 436f     base_expr: Co
+00017680: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
+00017690: 706f 7369 7469 6f6e 3a20 556e 696f 6e5b  position: Union[
+000176a0: 436f 6c75 6d6e 2c20 696e 745d 2c0a 2020  Column, int],.  
+000176b0: 2020 6c65 6e67 7468 3a20 556e 696f 6e5b    length: Union[
+000176c0: 436f 6c75 6d6e 2c20 696e 745d 2c0a 2020  Column, int],.  
+000176d0: 2020 696e 7365 7274 5f65 7870 723a 2043    insert_expr: C
+000176e0: 6f6c 756d 6e4f 724e 616d 652c 0a29 202d  olumnOrName,.) -
+000176f0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00017700: 220a 2020 2020 5265 706c 6163 6573 2061  ".    Replaces a
+00017710: 2073 7562 7374 7269 6e67 206f 6620 7468   substring of th
+00017720: 6520 7370 6563 6966 6965 6420 6c65 6e67  e specified leng
+00017730: 7468 2c20 7374 6172 7469 6e67 2061 7420  th, starting at 
+00017740: 7468 6520 7370 6563 6966 6965 6420 706f  the specified po
+00017750: 7369 7469 6f6e 2c0a 2020 2020 7769 7468  sition,.    with
+00017760: 2061 206e 6577 2073 7472 696e 6720 6f72   a new string or
+00017770: 2062 696e 6172 7920 7661 6c75 652e 0a0a   binary value...
+00017780: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
+00017790: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+000177a0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+000177b0: 6461 7461 6672 616d 6528 5b22 6162 6322  dataframe(["abc"
+000177c0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+000177d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000177e0: 7365 6c65 6374 2869 6e73 6572 7428 6466  select(insert(df
+000177f0: 5b22 6122 5d2c 2031 2c20 322c 206c 6974  ["a"], 1, 2, lit
+00017800: 2822 5a22 2929 2e61 6c69 6173 2822 696e  ("Z")).alias("in
+00017810: 7365 7274 2229 292e 636f 6c6c 6563 7428  sert")).collect(
+00017820: 290a 2020 2020 2020 2020 5b52 6f77 2849  ).        [Row(I
+00017830: 4e53 4552 543d 275a 6327 295d 0a20 2020  NSERT='Zc')].   
+00017840: 2022 2222 0a20 2020 2062 203d 205f 746f   """.    b = _to
+00017850: 5f63 6f6c 5f69 665f 7374 7228 6261 7365  _col_if_str(base
+00017860: 5f65 7870 722c 2022 696e 7365 7274 2229  _expr, "insert")
+00017870: 0a20 2020 2069 203d 205f 746f 5f63 6f6c  .    i = _to_col
+00017880: 5f69 665f 7374 7228 696e 7365 7274 5f65  _if_str(insert_e
+00017890: 7870 722c 2022 696e 7365 7274 2229 0a20  xpr, "insert"). 
+000178a0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+000178b0: 6e28 2269 6e73 6572 7422 2928 622c 206c  n("insert")(b, l
+000178c0: 6974 2870 6f73 6974 696f 6e29 2c20 6c69  it(position), li
+000178d0: 7428 6c65 6e67 7468 292c 2069 290a 0a0a  t(length), i)...
+000178e0: 6465 6620 6c65 6674 2873 7472 5f65 7870  def left(str_exp
+000178f0: 723a 2043 6f6c 756d 6e4f 724e 616d 652c  r: ColumnOrName,
+00017900: 206c 656e 6774 683a 2055 6e69 6f6e 5b43   length: Union[C
+00017910: 6f6c 756d 6e2c 2069 6e74 5d29 202d 3e20  olumn, int]) -> 
+00017920: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00017930: 6574 7572 6e73 2061 206c 6566 7420 6d6f  eturns a left mo
+00017940: 7374 2073 7562 7374 7269 6e67 206f 6620  st substring of 
+00017950: 6060 7374 725f 6578 7072 6060 2e0a 0a20  ``str_expr``... 
+00017960: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00017970: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00017980: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00017990: 7461 6672 616d 6528 5b5b 2261 6263 225d  taframe([["abc"]
+000179a0: 2c20 5b22 6465 6622 5d5d 2c20 7363 6865  , ["def"]], sche
+000179b0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+000179c0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000179d0: 6c65 6674 2863 6f6c 2822 6122 292c 2032  left(col("a"), 2
+000179e0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+000179f0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00017a00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00017a10: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00017a20: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00017a30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00017a40: 207c 6162 2020 2020 2020 2020 7c0a 2020   |ab        |.  
+00017a50: 2020 2020 2020 7c64 6520 2020 2020 2020        |de       
+00017a60: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00017a70: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00017a80: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+00017a90: 2222 220a 2020 2020 7320 3d20 5f74 6f5f  """.    s = _to_
+00017aa0: 636f 6c5f 6966 5f73 7472 2873 7472 5f65  col_if_str(str_e
+00017ab0: 7870 722c 2022 6c65 6674 2229 0a20 2020  xpr, "left").   
+00017ac0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00017ad0: 226c 6566 7422 2928 732c 206c 6974 286c  "left")(s, lit(l
+00017ae0: 656e 6774 6829 290a 0a0a 6465 6620 7269  ength))...def ri
+00017af0: 6768 7428 7374 725f 6578 7072 3a20 436f  ght(str_expr: Co
+00017b00: 6c75 6d6e 4f72 4e61 6d65 2c20 6c65 6e67  lumnOrName, leng
+00017b10: 7468 3a20 556e 696f 6e5b 436f 6c75 6d6e  th: Union[Column
+00017b20: 2c20 696e 745d 2920 2d3e 2043 6f6c 756d  , int]) -> Colum
+00017b30: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00017b40: 7320 6120 7269 6768 7420 6d6f 7374 2073  s a right most s
+00017b50: 7562 7374 7269 6e67 206f 6620 6060 7374  ubstring of ``st
+00017b60: 725f 6578 7072 6060 2e0a 0a20 2020 2045  r_expr``...    E
+00017b70: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00017b80: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00017b90: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00017ba0: 616d 6528 5b5b 2261 6263 225d 2c20 5b22  ame([["abc"], ["
+00017bb0: 6465 6622 5d5d 2c20 7363 6865 6d61 3d5b  def"]], schema=[
+00017bc0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00017bd0: 3e20 6466 2e73 656c 6563 7428 7269 6768  > df.select(righ
+00017be0: 7428 636f 6c28 2261 2229 2c20 3229 2e61  t(col("a"), 2).a
+00017bf0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00017c00: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00017c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00017c20: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00017c30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00017c40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c62  -----.        |b
+00017c50: 6320 2020 2020 2020 207c 0a20 2020 2020  c        |.     
+00017c60: 2020 207c 6566 2020 2020 2020 2020 7c0a     |ef        |.
+00017c70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00017c80: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00017c90: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00017ca0: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
+00017cb0: 5f69 665f 7374 7228 7374 725f 6578 7072  _if_str(str_expr
+00017cc0: 2c20 2272 6967 6874 2229 0a20 2020 2072  , "right").    r
+00017cd0: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
+00017ce0: 6967 6874 2229 2873 2c20 6c69 7428 6c65  ight")(s, lit(le
+00017cf0: 6e67 7468 2929 0a0a 0a64 6566 2063 6861  ngth))...def cha
+00017d00: 7228 636f 6c3a 2043 6f6c 756d 6e4f 724e  r(col: ColumnOrN
+00017d10: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00017d20: 2020 2020 2222 2243 6f6e 7665 7274 7320      """Converts 
+00017d30: 6120 556e 6963 6f64 6520 636f 6465 2070  a Unicode code p
+00017d40: 6f69 6e74 2028 696e 636c 7564 696e 6720  oint (including 
+00017d50: 372d 6269 7420 4153 4349 4929 2069 6e74  7-bit ASCII) int
+00017d60: 6f20 7468 6520 6368 6172 6163 7465 7220  o the character 
+00017d70: 7468 6174 0a20 2020 206d 6174 6368 6573  that.    matches
+00017d80: 2074 6865 2069 6e70 7574 2055 6e69 636f   the input Unico
+00017d90: 6465 2e0a 0a20 2020 2045 7861 6d70 6c65  de...    Example
+00017da0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00017db0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00017dc0: 6174 655f 6461 7461 6672 616d 6528 5b38  ate_dataframe([8
+00017dd0: 332c 2033 332c 2031 3639 2c20 3833 3634  3, 33, 169, 8364
+00017de0: 2c20 4e6f 6e65 5d2c 2073 6368 656d 613d  , None], schema=
+00017df0: 5b27 6127 5d29 0a20 2020 2020 2020 203e  ['a']).        >
+00017e00: 3e3e 2064 662e 7365 6c65 6374 2864 662e  >> df.select(df.
+00017e10: 612c 2063 6861 7228 6466 2e61 292e 6173  a, char(df.a).as
+00017e20: 5f28 2763 6861 7227 2929 2e73 6f72 7428  _('char')).sort(
+00017e30: 6466 2e61 292e 7368 6f77 2829 0a20 2020  df.a).show().   
+00017e40: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00017e50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00017e60: 2241 2220 2020 7c22 4348 4152 2220 207c  "A"   |"CHAR"  |
+00017e70: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00017e80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00017e90: 2020 207c 4e55 4c4c 2020 7c4e 554c 4c20     |NULL  |NULL 
+00017ea0: 2020 207c 0a20 2020 2020 2020 207c 3333     |.        |33
+00017eb0: 2020 2020 7c21 2020 2020 2020 207c 0a20      |!       |. 
+00017ec0: 2020 2020 2020 207c 3833 2020 2020 7c53         |83    |S
+00017ed0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00017ee0: 207c 3136 3920 2020 7cc2 a920 2020 2020   |169   |..     
+00017ef0: 2020 7c0a 2020 2020 2020 2020 7c38 3336    |.        |836
+00017f00: 3420 207c e282 ac20 2020 2020 2020 7c0a  4  |...       |.
+00017f10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00017f20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00017f30: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00017f40: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00017f50: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+00017f60: 2c20 2263 6861 7222 290a 2020 2020 7265  , "char").    re
+00017f70: 7475 726e 2062 7569 6c74 696e 2822 6368  turn builtin("ch
+00017f80: 6172 2229 2863 290a 0a0a 6465 6620 746f  ar")(c)...def to
+00017f90: 5f63 6861 7228 633a 2043 6f6c 756d 6e4f  _char(c: ColumnO
+00017fa0: 724e 616d 652c 2066 6f72 6d61 743a 204f  rName, format: O
+00017fb0: 7074 696f 6e61 6c5b 436f 6c75 6d6e 4f72  ptional[ColumnOr
+00017fc0: 4c69 7465 7261 6c53 7472 5d20 3d20 4e6f  LiteralStr] = No
+00017fd0: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+00017fe0: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
+00017ff0: 2055 6e69 636f 6465 2063 6f64 6520 706f   Unicode code po
+00018000: 696e 7420 2869 6e63 6c75 6469 6e67 2037  int (including 7
+00018010: 2d62 6974 2041 5343 4949 2920 696e 746f  -bit ASCII) into
+00018020: 2074 6865 2063 6861 7261 6374 6572 2074   the character t
+00018030: 6861 740a 2020 2020 6d61 7463 6865 7320  hat.    matches 
+00018040: 7468 6520 696e 7075 7420 556e 6963 6f64  the input Unicod
+00018050: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
+00018060: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+00018070: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00018080: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+00018090: 322c 2033 2c20 345d 2c20 7363 6865 6d61  2, 3, 4], schema
+000180a0: 3d5b 2761 275d 290a 2020 2020 2020 2020  =['a']).        
+000180b0: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
+000180c0: 5f63 6861 7228 636f 6c28 2761 2729 292e  _char(col('a')).
+000180d0: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
+000180e0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+000180f0: 6f77 2841 4e53 3d27 3127 292c 2052 6f77  ow(ANS='1'), Row
+00018100: 2841 4e53 3d27 3227 292c 2052 6f77 2841  (ANS='2'), Row(A
+00018110: 4e53 3d27 3327 292c 2052 6f77 2841 4e53  NS='3'), Row(ANS
+00018120: 3d27 3427 295d 0a0a 2020 2020 4578 616d  ='4')]..    Exam
+00018130: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00018140: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00018150: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+00018160: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00018170: 7465 5f64 6174 6166 7261 6d65 285b 6461  te_dataframe([da
+00018180: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+00018190: 3230 3233 2c20 342c 2031 3629 2c20 6461  2023, 4, 16), da
+000181a0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+000181b0: 3230 3137 2c20 342c 2033 2c20 322c 2035  2017, 4, 3, 2, 5
+000181c0: 392c 2033 372c 2031 3533 295d 2c20 7363  9, 37, 153)], sc
+000181d0: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
+000181e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000181f0: 7428 746f 5f63 6861 7228 636f 6c28 2761  t(to_char(col('a
+00018200: 2729 292e 6173 5f28 2761 6e73 2729 292e  ')).as_('ans')).
+00018210: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00018220: 2020 5b52 6f77 2841 4e53 3d27 3230 3233    [Row(ANS='2023
+00018230: 2d30 342d 3136 2030 303a 3030 3a30 302e  -04-16 00:00:00.
+00018240: 3030 3027 292c 2052 6f77 2841 4e53 3d27  000'), Row(ANS='
+00018250: 3230 3137 2d30 342d 3033 2030 323a 3539  2017-04-03 02:59
+00018260: 3a33 372e 3030 3027 295d 0a0a 2020 2020  :37.000')]..    
+00018270: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00018280: 636f 6c5f 6966 5f73 7472 2863 2c20 2274  col_if_str(c, "t
+00018290: 6f5f 6368 6172 2229 0a20 2020 2072 6574  o_char").    ret
+000182a0: 7572 6e20 280a 2020 2020 2020 2020 6275  urn (.        bu
+000182b0: 696c 7469 6e28 2274 6f5f 6368 6172 2229  iltin("to_char")
+000182c0: 2863 2c20 6c69 7428 666f 726d 6174 2929  (c, lit(format))
+000182d0: 0a20 2020 2020 2020 2069 6620 666f 726d  .        if form
+000182e0: 6174 2069 7320 6e6f 7420 4e6f 6e65 0a20  at is not None. 
+000182f0: 2020 2020 2020 2065 6c73 6520 6275 696c         else buil
+00018300: 7469 6e28 2274 6f5f 6368 6172 2229 2863  tin("to_char")(c
+00018310: 290a 2020 2020 290a 0a0a 6465 6620 746f  ).    )...def to
+00018320: 5f74 696d 6528 653a 2043 6f6c 756d 6e4f  _time(e: ColumnO
+00018330: 724e 616d 652c 2066 6d74 3a20 4f70 7469  rName, fmt: Opti
+00018340: 6f6e 616c 5b22 436f 6c75 6d6e 225d 203d  onal["Column"] =
+00018350: 204e 6f6e 6529 202d 3e20 436f 6c75 6d6e   None) -> Column
+00018360: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
+00018370: 7320 616e 2069 6e70 7574 2065 7870 7265  s an input expre
+00018380: 7373 696f 6e20 696e 746f 2074 6865 2063  ssion into the c
+00018390: 6f72 7265 7370 6f6e 6469 6e67 2074 696d  orresponding tim
+000183a0: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
+000183b0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+000183c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000183d0: 7465 5f64 6174 6166 7261 6d65 285b 2730  te_dataframe(['0
+000183e0: 343a 3135 3a32 392e 3939 3927 5d2c 2073  4:15:29.999'], s
+000183f0: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
+00018400: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00018410: 6374 2874 6f5f 7469 6d65 2863 6f6c 2822  ct(to_time(col("
+00018420: 6122 2929 292e 636f 6c6c 6563 7428 290a  a"))).collect().
+00018430: 2020 2020 2020 2020 5b52 6f77 2854 4f5f          [Row(TO_
+00018440: 5449 4d45 2822 4122 293d 6461 7465 7469  TIME("A")=dateti
+00018450: 6d65 2e74 696d 6528 342c 2031 352c 2032  me.time(4, 15, 2
+00018460: 392c 2039 3939 3030 3029 295d 0a20 2020  9, 999000))].   
+00018470: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00018480: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00018490: 746f 5f74 696d 6522 290a 2020 2020 7265  to_time").    re
+000184a0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
+000184b0: 5f74 696d 6522 2928 632c 2066 6d74 2920  _time")(c, fmt) 
+000184c0: 6966 2066 6d74 2069 7320 6e6f 7420 4e6f  if fmt is not No
+000184d0: 6e65 2065 6c73 6520 6275 696c 7469 6e28  ne else builtin(
+000184e0: 2274 6f5f 7469 6d65 2229 2863 290a 0a0a  "to_time")(c)...
+000184f0: 6465 6620 746f 5f74 696d 6573 7461 6d70  def to_timestamp
+00018500: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00018510: 2c20 666d 743a 204f 7074 696f 6e61 6c5b  , fmt: Optional[
+00018520: 2243 6f6c 756d 6e22 5d20 3d20 4e6f 6e65  "Column"] = None
+00018530: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00018540: 2022 2222 436f 6e76 6572 7473 2061 6e20   """Converts an 
+00018550: 696e 7075 7420 6578 7072 6573 7369 6f6e  input expression
+00018560: 2069 6e74 6f20 7468 6520 636f 7272 6573   into the corres
+00018570: 706f 6e64 696e 6720 7469 6d65 7374 616d  ponding timestam
+00018580: 702e 0a0a 2020 2020 5065 7220 6465 6661  p...    Per defa
+00018590: 756c 7420 666d 7420 6973 2073 6574 2074  ult fmt is set t
+000185a0: 6f20 6175 746f 2c20 7768 6963 6820 6d61  o auto, which ma
+000185b0: 6b65 7320 536e 6f77 666c 616b 6520 6465  kes Snowflake de
+000185c0: 7465 6374 2074 6865 2066 6f72 6d61 7420  tect the format 
+000185d0: 6175 746f 6d61 7469 6361 6c6c 792e 2057  automatically. W
+000185e0: 6974 6820 6074 6f5f 7469 6d65 7374 616d  ith `to_timestam
+000185f0: 7060 2073 7472 696e 6773 0a20 2020 2063  p` strings.    c
+00018600: 616e 2062 6520 636f 6e76 6572 7465 6420  an be converted 
+00018610: 746f 2074 696d 6573 7461 6d70 732e 2054  to timestamps. T
+00018620: 6865 2066 6f72 6d61 7420 6861 7320 746f  he format has to
+00018630: 2062 6520 7370 6563 6966 6965 6420 6163   be specified ac
+00018640: 636f 7264 696e 6720 746f 2074 6865 2072  cording to the r
+00018650: 756c 6573 2073 6574 2066 6f72 7468 2069  ules set forth i
+00018660: 6e0a 2020 2020 3c68 7474 7073 3a2f 2f64  n.    <https://d
+00018670: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
+00018680: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
+00018690: 6365 2f66 756e 6374 696f 6e73 2d63 6f6e  ce/functions-con
+000186a0: 7665 7273 696f 6e23 6461 7465 2d61 6e64  version#date-and
+000186b0: 2d74 696d 652d 666f 726d 6174 732d 696e  -time-formats-in
+000186c0: 2d63 6f6e 7665 7273 696f 6e2d 6675 6e63  -conversion-func
+000186d0: 7469 6f6e 733e 0a0a 2020 2020 4578 616d  tions>..    Exam
+000186e0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+000186f0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00018700: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00018710: 5b27 3230 3139 2d30 312d 3331 2030 313a  ['2019-01-31 01:
+00018720: 3032 3a30 332e 3030 3427 5d2c 2073 6368  02:03.004'], sch
+00018730: 656d 613d 5b27 6127 5d29 0a20 2020 2020  ema=['a']).     
+00018740: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00018750: 2874 6f5f 7469 6d65 7374 616d 7028 636f  (to_timestamp(co
+00018760: 6c28 2261 2229 292e 6173 5f28 2261 6e73  l("a")).as_("ans
+00018770: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00018780: 2020 2020 2020 5b52 6f77 2841 4e53 3d64        [Row(ANS=d
+00018790: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+000187a0: 2832 3031 392c 2031 2c20 3331 2c20 312c  (2019, 1, 31, 1,
+000187b0: 2032 2c20 332c 2034 3030 3029 295d 0a20   2, 3, 4000))]. 
+000187c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000187d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000187e0: 6174 6166 7261 6d65 285b 2232 3032 302d  ataframe(["2020-
+000187f0: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
+00018800: 3030 225d 2c20 7363 6865 6d61 3d5b 2761  00"], schema=['a
+00018810: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+00018820: 6466 2e73 656c 6563 7428 746f 5f74 696d  df.select(to_tim
+00018830: 6573 7461 6d70 2863 6f6c 2822 6122 292c  estamp(col("a"),
+00018840: 206c 6974 2822 5959 5959 2d4d 4d2d 4444   lit("YYYY-MM-DD
+00018850: 2048 4832 343a 4d49 3a53 532e 4646 3322   HH24:MI:SS.FF3"
+00018860: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
+00018870: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00018880: 205b 526f 7728 414e 533d 6461 7465 7469   [Row(ANS=dateti
+00018890: 6d65 2e64 6174 6574 696d 6528 3230 3230  me.datetime(2020
+000188a0: 2c20 352c 2031 2c20 3133 2c20 3131 2c20  , 5, 1, 13, 11, 
+000188b0: 3230 2929 5d0a 0a20 2020 2041 6e6f 7468  20))]..    Anoth
+000188c0: 6572 206f 7074 696f 6e20 6973 2074 6f20  er option is to 
+000188d0: 636f 6e76 6572 7420 6461 7465 7320 696e  convert dates in
+000188e0: 746f 2074 696d 6573 7461 6d70 730a 0a20  to timestamps.. 
+000188f0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00018900: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+00018910: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
+00018920: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00018930: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
+00018940: 6528 5b64 6174 6574 696d 652e 6461 7465  e([datetime.date
+00018950: 7469 6d65 2832 3032 322c 2031 322c 2032  time(2022, 12, 2
+00018960: 352c 2031 332c 2035 392c 2033 382c 2034  5, 13, 59, 38, 4
+00018970: 3637 295d 2c20 7363 6865 6d61 3d5b 2261  67)], schema=["a
+00018980: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+00018990: 6466 2e73 656c 6563 7428 746f 5f74 696d  df.select(to_tim
+000189a0: 6573 7461 6d70 2863 6f6c 2822 6122 2929  estamp(col("a"))
+000189b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000189c0: 2020 2020 5b52 6f77 2854 4f5f 5449 4d45      [Row(TO_TIME
+000189d0: 5354 414d 5028 2241 2229 3d64 6174 6574  STAMP("A")=datet
+000189e0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+000189f0: 322c 2031 322c 2032 352c 2031 332c 2035  2, 12, 25, 13, 5
+00018a00: 392c 2033 382c 2034 3637 2929 5d0a 2020  9, 38, 467))].  
+00018a10: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00018a20: 6573 7369 6f6e 2e63 7265 6174 6544 6174  ession.createDat
+00018a30: 6146 7261 6d65 285b 6461 7465 7469 6d65  aFrame([datetime
+00018a40: 2e64 6174 6528 3230 3233 2c20 332c 2031  .date(2023, 3, 1
+00018a50: 295d 2c20 7363 6865 6d61 3d5b 2261 225d  )], schema=["a"]
+00018a60: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00018a70: 2e73 656c 6563 7428 746f 5f74 696d 6573  .select(to_times
+00018a80: 7461 6d70 2863 6f6c 2822 6122 2929 292e  tamp(col("a"))).
+00018a90: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00018aa0: 2020 5b52 6f77 2854 4f5f 5449 4d45 5354    [Row(TO_TIMEST
+00018ab0: 414d 5028 2241 2229 3d64 6174 6574 696d  AMP("A")=datetim
+00018ac0: 652e 6461 7465 7469 6d65 2832 3032 332c  e.datetime(2023,
+00018ad0: 2033 2c20 312c 2030 2c20 3029 295d 0a0a   3, 1, 0, 0))]..
+00018ae0: 2020 2020 496e 7465 6765 7273 2063 616e      Integers can
+00018af0: 2062 6520 636f 6e76 6572 7465 6420 696e   be converted in
+00018b00: 746f 2061 2074 696d 6573 7461 6d70 2061  to a timestamp a
+00018b10: 7320 7765 6c6c 2c20 6279 2070 726f 7669  s well, by provi
+00018b20: 6469 6e67 206f 7074 696f 6e61 6c6c 7920  ding optionally 
+00018b30: 6120 7363 616c 6520 6173 2061 6e20 696e  a scale as an in
+00018b40: 7465 6765 7220 6173 206c 696e 6564 206f  teger as lined o
+00018b50: 7574 2069 6e0a 2020 2020 3c68 7474 7073  ut in.    <https
+00018b60: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
+00018b70: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
+00018b80: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
+00018b90: 2f74 6f5f 7469 6d65 7374 616d 7023 7573  /to_timestamp#us
+00018ba0: 6167 652d 6e6f 7465 733e 2e20 4375 7272  age-notes>. Curr
+00018bb0: 656e 746c 7920 536e 6f77 7061 726b 2064  ently Snowpark d
+00018bc0: 6f65 7320 7375 7070 6f72 740a 2020 2020  oes support.    
+00018bd0: 696e 7465 6765 7273 2069 6e20 7468 6520  integers in the 
+00018be0: 7261 6e67 6520 6f66 2061 6e20 382d 6279  range of an 8-by
+00018bf0: 7465 2073 6967 6e65 6420 696e 7465 6765  te signed intege
+00018c00: 7220 6f6e 6c79 2e0a 0a20 2020 2045 7861  r only...    Exa
+00018c10: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+00018c20: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00018c30: 6372 6561 7465 4461 7461 4672 616d 6528  createDataFrame(
+00018c40: 5b32 302c 2033 3135 3336 3030 3030 3030  [20, 31536000000
+00018c50: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+00018c60: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00018c70: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+00018c80: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
+00018c90: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00018ca0: 205b 526f 7728 544f 5f54 494d 4553 5441   [Row(TO_TIMESTA
+00018cb0: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
+00018cc0: 2e64 6174 6574 696d 6528 3139 3730 2c20  .datetime(1970, 
+00018cd0: 312c 2031 2c20 302c 2030 2c20 3230 2929  1, 1, 0, 0, 20))
+00018ce0: 2c20 526f 7728 544f 5f54 494d 4553 5441  , Row(TO_TIMESTA
+00018cf0: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
+00018d00: 2e64 6174 6574 696d 6528 3239 3639 2c20  .datetime(2969, 
+00018d10: 352c 2033 2c20 302c 2030 2929 5d0a 2020  5, 3, 0, 0))].  
+00018d20: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00018d30: 6563 7428 746f 5f74 696d 6573 7461 6d70  ect(to_timestamp
+00018d40: 2863 6f6c 2822 6122 292c 206c 6974 2839  (col("a"), lit(9
+00018d50: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
+00018d60: 2020 2020 2020 5b52 6f77 2854 4f5f 5449        [Row(TO_TI
+00018d70: 4d45 5354 414d 5028 2241 222c 2039 293d  MESTAMP("A", 9)=
+00018d80: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00018d90: 6528 3139 3730 2c20 312c 2031 2c20 302c  e(1970, 1, 1, 0,
+00018da0: 2030 2929 2c20 526f 7728 544f 5f54 494d   0)), Row(TO_TIM
+00018db0: 4553 5441 4d50 2822 4122 2c20 3929 3d64  ESTAMP("A", 9)=d
+00018dc0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+00018dd0: 2831 3937 302c 2031 2c20 312c 2030 2c20  (1970, 1, 1, 0, 
+00018de0: 302c 2033 312c 2035 3336 3030 3029 295d  0, 31, 536000))]
+00018df0: 0a0a 2020 2020 4c61 7267 6572 206e 756d  ..    Larger num
+00018e00: 6265 7273 2073 746f 7265 6420 696e 2061  bers stored in a
+00018e10: 2073 7472 696e 6720 6361 6e20 6265 2061   string can be a
+00018e20: 6c73 6f20 636f 6e76 6572 7465 6420 7669  lso converted vi
+00018e30: 6120 7468 6973 2061 7070 726f 6163 680a  a this approach.
+00018e40: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00018e50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00018e60: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
+00018e70: 7461 4672 616d 6528 5b27 3230 272c 2027  taFrame(['20', '
+00018e80: 3331 3533 3630 3030 3030 3027 2c20 2733  31536000000', '3
+00018e90: 3135 3336 3030 3030 3030 3030 3027 2c20  1536000000000', 
+00018ea0: 2733 3135 3336 3030 3030 3030 3030 3030  '315360000000000
+00018eb0: 3030 275d 2c20 7363 6865 6d61 3d5b 2761  00'], schema=['a
+00018ec0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+00018ed0: 6466 2e73 656c 6563 7428 746f 5f74 696d  df.select(to_tim
+00018ee0: 6573 7461 6d70 2863 6f6c 2822 6122 2929  estamp(col("a"))
+00018ef0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
+00018f00: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00018f10: 526f 7728 414e 533d 6461 7465 7469 6d65  Row(ANS=datetime
+00018f20: 2e64 6174 6574 696d 6528 3139 3730 2c20  .datetime(1970, 
+00018f30: 312c 2031 2c20 302c 2030 2c20 3230 2929  1, 1, 0, 0, 20))
+00018f40: 2c20 526f 7728 414e 533d 6461 7465 7469  , Row(ANS=dateti
+00018f50: 6d65 2e64 6174 6574 696d 6528 3139 3731  me.datetime(1971
+00018f60: 2c20 312c 2031 2c20 302c 2030 2929 2c20  , 1, 1, 0, 0)), 
+00018f70: 526f 7728 414e 533d 6461 7465 7469 6d65  Row(ANS=datetime
+00018f80: 2e64 6174 6574 696d 6528 3139 3731 2c20  .datetime(1971, 
+00018f90: 312c 2031 2c20 302c 2030 2929 2c20 526f  1, 1, 0, 0)), Ro
+00018fa0: 7728 414e 533d 6461 7465 7469 6d65 2e64  w(ANS=datetime.d
+00018fb0: 6174 6574 696d 6528 3139 3731 2c20 312c  atetime(1971, 1,
+00018fc0: 2031 2c20 302c 2030 2929 5d0a 2020 2020   1, 0, 0))].    
+00018fd0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00018fe0: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
+00018ff0: 6f5f 7469 6d65 7374 616d 7022 290a 2020  o_timestamp").  
+00019000: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
+00019010: 2020 2062 7569 6c74 696e 2822 746f 5f74     builtin("to_t
+00019020: 696d 6573 7461 6d70 2229 2863 2c20 666d  imestamp")(c, fm
+00019030: 7429 0a20 2020 2020 2020 2069 6620 666d  t).        if fm
+00019040: 7420 6973 206e 6f74 204e 6f6e 650a 2020  t is not None.  
+00019050: 2020 2020 2020 656c 7365 2062 7569 6c74        else built
+00019060: 696e 2822 746f 5f74 696d 6573 7461 6d70  in("to_timestamp
+00019070: 2229 2863 290a 2020 2020 290a 0a0a 6465  ")(c).    )...de
+00019080: 6620 746f 5f64 6174 6528 653a 2043 6f6c  f to_date(e: Col
+00019090: 756d 6e4f 724e 616d 652c 2066 6d74 3a20  umnOrName, fmt: 
+000190a0: 4f70 7469 6f6e 616c 5b22 436f 6c75 6d6e  Optional["Column
+000190b0: 225d 203d 204e 6f6e 6529 202d 3e20 436f  "] = None) -> Co
+000190c0: 6c75 6d6e 3a0a 2020 2020 2222 2243 6f6e  lumn:.    """Con
+000190d0: 7665 7274 7320 616e 2069 6e70 7574 2065  verts an input e
+000190e0: 7870 7265 7373 696f 6e20 696e 746f 2061  xpression into a
+000190f0: 2064 6174 652e 0a0a 2020 2020 4578 616d   date...    Exam
+00019100: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00019110: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00019120: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00019130: 285b 2732 3031 332d 3035 2d31 3727 2c20  (['2013-05-17', 
+00019140: 2732 3031 332d 3035 2d31 3727 5d2c 2073  '2013-05-17'], s
+00019150: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
+00019160: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00019170: 6374 2874 6f5f 6461 7465 2863 6f6c 2827  ct(to_date(col('
+00019180: 6127 2929 2e61 735f 2827 616e 7327 2929  a')).as_('ans'))
+00019190: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000191a0: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
+000191b0: 7469 6d65 2e64 6174 6528 3230 3133 2c20  time.date(2013, 
+000191c0: 352c 2031 3729 292c 2052 6f77 2841 4e53  5, 17)), Row(ANS
+000191d0: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
+000191e0: 3031 332c 2035 2c20 3137 2929 5d0a 0a20  013, 5, 17))].. 
+000191f0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00019200: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00019210: 6174 6166 7261 6d65 285b 2733 3135 3336  ataframe(['31536
+00019220: 3030 3030 3030 3030 3027 2c20 2737 3135  000000000', '715
+00019230: 3336 3030 3430 3030 3030 3027 5d2c 2073  36004000000'], s
+00019240: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
+00019250: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00019260: 6374 2874 6f5f 6461 7465 2863 6f6c 2827  ct(to_date(col('
+00019270: 6127 2929 2e61 735f 2827 616e 7327 2929  a')).as_('ans'))
+00019280: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00019290: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
+000192a0: 7469 6d65 2e64 6174 6528 3139 3731 2c20  time.date(1971, 
+000192b0: 312c 2031 2929 2c20 526f 7728 414e 533d  1, 1)), Row(ANS=
+000192c0: 6461 7465 7469 6d65 2e64 6174 6528 3139  datetime.date(19
+000192d0: 3732 2c20 342c 2037 2929 5d0a 0a20 2020  72, 4, 7))]..   
+000192e0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+000192f0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00019300: 746f 5f64 6174 6522 290a 2020 2020 7265  to_date").    re
+00019310: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
+00019320: 5f64 6174 6522 2928 632c 2066 6d74 2920  _date")(c, fmt) 
+00019330: 6966 2066 6d74 2069 7320 6e6f 7420 4e6f  if fmt is not No
+00019340: 6e65 2065 6c73 6520 6275 696c 7469 6e28  ne else builtin(
+00019350: 2274 6f5f 6461 7465 2229 2863 290a 0a0a  "to_date")(c)...
+00019360: 6465 6620 6375 7272 656e 745f 7469 6d65  def current_time
+00019370: 7374 616d 7028 2920 2d3e 2043 6f6c 756d  stamp() -> Colum
+00019380: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00019390: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
+000193a0: 6d65 7374 616d 7020 666f 7220 7468 6520  mestamp for the 
+000193b0: 7379 7374 656d 2e0a 0a20 2020 2045 7861  system...    Exa
+000193c0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+000193d0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+000193e0: 650a 2020 2020 2020 2020 3e3e 3e20 7265  e.        >>> re
+000193f0: 7375 6c74 203d 2073 6573 7369 6f6e 2e63  sult = session.c
+00019400: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00019410: 5b31 5d29 2e73 656c 6563 7428 6375 7272  [1]).select(curr
+00019420: 656e 745f 7469 6d65 7374 616d 7028 2929  ent_timestamp())
+00019430: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00019440: 2020 203e 3e3e 2061 7373 6572 7420 6973     >>> assert is
+00019450: 696e 7374 616e 6365 2872 6573 756c 745b  instance(result[
+00019460: 305d 5b22 4355 5252 454e 545f 5449 4d45  0]["CURRENT_TIME
+00019470: 5354 414d 5028 2922 5d2c 2064 6174 6574  STAMP()"], datet
+00019480: 696d 652e 6461 7465 7469 6d65 290a 2020  ime.datetime).  
+00019490: 2020 2222 220a 0a20 2020 2072 6574 7572    """..    retur
+000194a0: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
+000194b0: 6e74 5f74 696d 6573 7461 6d70 2229 2829  nt_timestamp")()
+000194c0: 0a0a 0a64 6566 2063 7572 7265 6e74 5f64  ...def current_d
+000194d0: 6174 6528 2920 2d3e 2043 6f6c 756d 6e3a  ate() -> Column:
+000194e0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+000194f0: 7468 6520 6375 7272 656e 7420 6461 7465  the current date
+00019500: 2066 6f72 2074 6865 2073 7973 7465 6d2e   for the system.
+00019510: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
+00019520: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
+00019530: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
+00019540: 2020 203e 3e3e 2072 6573 756c 7420 3d20     >>> result = 
+00019550: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00019560: 6174 6166 7261 6d65 285b 315d 292e 7365  ataframe([1]).se
+00019570: 6c65 6374 2863 7572 7265 6e74 5f64 6174  lect(current_dat
+00019580: 6528 2929 2e63 6f6c 6c65 6374 2829 0a20  e()).collect(). 
+00019590: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
+000195a0: 7420 6973 696e 7374 616e 6365 2872 6573  t isinstance(res
+000195b0: 756c 745b 305d 5b22 4355 5252 454e 545f  ult[0]["CURRENT_
+000195c0: 4441 5445 2829 225d 2c20 6461 7465 7469  DATE()"], dateti
+000195d0: 6d65 2e64 6174 6529 0a20 2020 2022 2222  me.date).    """
+000195e0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+000195f0: 7469 6e28 2263 7572 7265 6e74 5f64 6174  tin("current_dat
+00019600: 6522 2928 290a 0a0a 6465 6620 6375 7272  e")()...def curr
+00019610: 656e 745f 7469 6d65 2829 202d 3e20 436f  ent_time() -> Co
+00019620: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00019630: 7572 6e73 2074 6865 2063 7572 7265 6e74  urns the current
+00019640: 2074 696d 6520 666f 7220 7468 6520 7379   time for the sy
+00019650: 7374 656d 2e0a 0a20 2020 2045 7861 6d70  stem...    Examp
+00019660: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00019670: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+00019680: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
+00019690: 6c74 203d 2073 6573 7369 6f6e 2e63 7265  lt = session.cre
+000196a0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+000196b0: 5d29 2e73 656c 6563 7428 6375 7272 656e  ]).select(curren
+000196c0: 745f 7469 6d65 2829 292e 636f 6c6c 6563  t_time()).collec
+000196d0: 7428 290a 2020 2020 2020 2020 3e3e 3e20  t().        >>> 
+000196e0: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+000196f0: 6528 7265 7375 6c74 5b30 5d5b 2243 5552  e(result[0]["CUR
+00019700: 5245 4e54 5f54 494d 4528 2922 5d2c 2064  RENT_TIME()"], d
+00019710: 6174 6574 696d 652e 7469 6d65 290a 2020  atetime.time).  
+00019720: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00019730: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
+00019740: 745f 7469 6d65 2229 2829 0a0a 0a64 6566  t_time")()...def
+00019750: 2068 6f75 7228 653a 2043 6f6c 756d 6e4f   hour(e: ColumnO
+00019760: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00019770: 3a0a 2020 2020 2222 220a 2020 2020 4578  :.    """.    Ex
+00019780: 7472 6163 7473 2074 6865 2068 6f75 7220  tracts the hour 
+00019790: 6672 6f6d 2061 2064 6174 6520 6f72 2074  from a date or t
+000197a0: 696d 6573 7461 6d70 2e0a 0a20 2020 2045  imestamp...    E
+000197b0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+000197c0: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
+000197d0: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
+000197e0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+000197f0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00019800: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
+00019810: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
+00019820: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
+00019830: 3230 2d30 352d 3031 2031 333a 3131 3a32  20-05-01 13:11:2
+00019840: 302e 3030 3022 2c20 2225 592d 256d 2d25  0.000", "%Y-%m-%
+00019850: 6420 2548 3a25 4d3a 2553 2e25 6622 292c  d %H:%M:%S.%f"),
+00019860: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00019870: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+00019880: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
+00019890: 302d 3038 2d32 3120 3031 3a33 303a 3035  0-08-21 01:30:05
+000198a0: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
+000198b0: 2025 483a 254d 3a25 532e 2566 2229 0a20   %H:%M:%S.%f"). 
+000198c0: 2020 2020 2020 202e 2e2e 205d 2c20 7363         ... ], sc
+000198d0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+000198e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000198f0: 7428 686f 7572 2822 6122 2929 2e63 6f6c  t(hour("a")).col
+00019900: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00019910: 526f 7728 484f 5552 2822 4122 293d 3133  Row(HOUR("A")=13
+00019920: 292c 2052 6f77 2848 4f55 5228 2241 2229  ), Row(HOUR("A")
+00019930: 3d31 295d 0a20 2020 2022 2222 0a20 2020  =1)].    """.   
+00019940: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00019950: 7374 7228 652c 2022 686f 7572 2229 0a20  str(e, "hour"). 
+00019960: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00019970: 6e28 2268 6f75 7222 2928 6329 0a0a 0a64  n("hour")(c)...d
+00019980: 6566 206c 6173 745f 6461 7928 653a 2043  ef last_day(e: C
+00019990: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+000199a0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+000199b0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+000199c0: 6c61 7374 2064 6179 206f 6620 7468 6520  last day of the 
+000199d0: 7370 6563 6966 6965 6420 6461 7465 2070  specified date p
+000199e0: 6172 7420 666f 7220 6120 6461 7465 206f  art for a date o
+000199f0: 7220 7469 6d65 7374 616d 702e 0a20 2020  r timestamp..   
+00019a00: 2043 6f6d 6d6f 6e6c 7920 7573 6564 2074   Commonly used t
+00019a10: 6f20 7265 7475 726e 2074 6865 206c 6173  o return the las
+00019a20: 7420 6461 7920 6f66 2074 6865 206d 6f6e  t day of the mon
+00019a30: 7468 2066 6f72 2061 2064 6174 6520 6f72  th for a date or
+00019a40: 2074 696d 6573 7461 6d70 2e0a 0a20 2020   timestamp...   
+00019a50: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00019a60: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+00019a70: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
+00019a80: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00019a90: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00019aa0: 6528 5b0a 2020 2020 2020 2020 2e2e 2e20  e([.        ... 
+00019ab0: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
+00019ac0: 6574 696d 652e 7374 7270 7469 6d65 2822  etime.strptime("
+00019ad0: 3230 3230 2d30 352d 3031 2031 333a 3131  2020-05-01 13:11
+00019ae0: 3a32 302e 3030 3022 2c20 2225 592d 256d  :20.000", "%Y-%m
+00019af0: 2d25 6420 2548 3a25 4d3a 2553 2e25 6622  -%d %H:%M:%S.%f"
+00019b00: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
+00019b10: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
+00019b20: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
+00019b30: 3032 302d 3038 2d32 3120 3031 3a33 303a  020-08-21 01:30:
+00019b40: 3035 2e30 3030 222c 2022 2559 2d25 6d2d  05.000", "%Y-%m-
+00019b50: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
+00019b60: 0a20 2020 2020 2020 202e 2e2e 205d 2c20  .        ... ], 
+00019b70: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00019b80: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00019b90: 6563 7428 6c61 7374 5f64 6179 2822 6122  ect(last_day("a"
+00019ba0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00019bb0: 2020 2020 205b 526f 7728 4c41 5354 5f44       [Row(LAST_D
+00019bc0: 4159 2822 4122 293d 6461 7465 7469 6d65  AY("A")=datetime
+00019bd0: 2e64 6174 6528 3230 3230 2c20 352c 2033  .date(2020, 5, 3
+00019be0: 3129 292c 2052 6f77 284c 4153 545f 4441  1)), Row(LAST_DA
+00019bf0: 5928 2241 2229 3d64 6174 6574 696d 652e  Y("A")=datetime.
+00019c00: 6461 7465 2832 3032 302c 2038 2c20 3331  date(2020, 8, 31
+00019c10: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+00019c20: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00019c30: 7472 2865 2c20 226c 6173 745f 6461 7922  tr(e, "last_day"
+00019c40: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00019c50: 6c74 696e 2822 6c61 7374 5f64 6179 2229  ltin("last_day")
+00019c60: 2863 290a 0a0a 6465 6620 6d69 6e75 7465  (c)...def minute
+00019c70: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00019c80: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00019c90: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
+00019ca0: 7320 7468 6520 6d69 6e75 7465 2066 726f  s the minute fro
+00019cb0: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
+00019cc0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
+00019cd0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00019ce0: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00019cf0: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+00019d00: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00019d10: 7465 5f64 6174 6166 7261 6d65 285b 0a20  te_dataframe([. 
+00019d20: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+00019d30: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+00019d40: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+00019d50: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
+00019d60: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+00019d70: 483a 254d 3a25 532e 2566 2229 2c0a 2020  H:%M:%S.%f"),.  
+00019d80: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
+00019d90: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+00019da0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+00019db0: 382d 3231 2030 313a 3330 3a30 352e 3030  8-21 01:30:05.00
+00019dc0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+00019dd0: 3a25 4d3a 2553 2e25 6622 290a 2020 2020  :%M:%S.%f").    
+00019de0: 2020 2020 2e2e 2e20 5d2c 2073 6368 656d      ... ], schem
+00019df0: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00019e00: 203e 3e3e 2064 662e 7365 6c65 6374 286d   >>> df.select(m
+00019e10: 696e 7574 6528 2261 2229 292e 636f 6c6c  inute("a")).coll
+00019e20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00019e30: 6f77 284d 494e 5554 4528 2241 2229 3d31  ow(MINUTE("A")=1
+00019e40: 3129 2c20 526f 7728 4d49 4e55 5445 2822  1), Row(MINUTE("
+00019e50: 4122 293d 3330 295d 0a20 2020 2022 2222  A")=30)].    """
+00019e60: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00019e70: 5f69 665f 7374 7228 652c 2022 6d69 6e75  _if_str(e, "minu
+00019e80: 7465 2229 0a20 2020 2072 6574 7572 6e20  te").    return 
+00019e90: 6275 696c 7469 6e28 226d 696e 7574 6522  builtin("minute"
+00019ea0: 2928 6329 0a0a 0a64 6566 206e 6578 745f  )(c)...def next_
+00019eb0: 6461 7928 6461 7465 3a20 436f 6c75 6d6e  day(date: Column
+00019ec0: 4f72 4e61 6d65 2c20 6461 795f 6f66 5f77  OrName, day_of_w
+00019ed0: 6565 6b3a 2043 6f6c 756d 6e4f 724c 6974  eek: ColumnOrLit
+00019ee0: 6572 616c 2920 2d3e 2043 6f6c 756d 6e3a  eral) -> Column:
+00019ef0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+00019f00: 7572 6e73 2074 6865 2064 6174 6520 6f66  urns the date of
+00019f10: 2074 6865 2066 6972 7374 2073 7065 6369   the first speci
+00019f20: 6669 6564 2044 4f57 2028 6461 7920 6f66  fied DOW (day of
+00019f30: 2077 6565 6b29 2074 6861 7420 6f63 6375   week) that occu
+00019f40: 7273 2061 6674 6572 2074 6865 2069 6e70  rs after the inp
+00019f50: 7574 2064 6174 652e 0a0a 2020 2020 4578  ut date...    Ex
+00019f60: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00019f70: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
+00019f80: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
+00019f90: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00019fa0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00019fb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00019fc0: 2028 6461 7465 7469 6d65 2e64 6174 652e   (datetime.date.
+00019fd0: 6672 6f6d 6973 6f66 6f72 6d61 7428 2232  fromisoformat("2
+00019fe0: 3032 302d 3038 2d30 3122 292c 2022 6d6f  020-08-01"), "mo
+00019ff0: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
+0001a000: 2020 2020 2864 6174 6574 696d 652e 6461      (datetime.da
+0001a010: 7465 2e66 726f 6d69 736f 666f 726d 6174  te.fromisoformat
+0001a020: 2822 3230 3230 2d31 322d 3031 2229 2c20  ("2020-12-01"), 
+0001a030: 2277 6522 292c 0a20 2020 2020 2020 202e  "we"),.        .
+0001a040: 2e2e 205d 2c20 7363 6865 6d61 3d5b 2261  .. ], schema=["a
+0001a050: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+0001a060: 203e 3e3e 2064 662e 7365 6c65 6374 286e   >>> df.select(n
+0001a070: 6578 745f 6461 7928 2261 222c 2063 6f6c  ext_day("a", col
+0001a080: 2822 6222 2929 292e 636f 6c6c 6563 7428  ("b"))).collect(
+0001a090: 290a 2020 2020 2020 2020 5b52 6f77 284e  ).        [Row(N
+0001a0a0: 4558 545f 4441 5928 2241 222c 2022 4222  EXT_DAY("A", "B"
+0001a0b0: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
+0001a0c0: 3230 3230 2c20 382c 2033 2929 2c20 526f  2020, 8, 3)), Ro
+0001a0d0: 7728 4e45 5854 5f44 4159 2822 4122 2c20  w(NEXT_DAY("A", 
+0001a0e0: 2242 2229 3d64 6174 6574 696d 652e 6461  "B")=datetime.da
+0001a0f0: 7465 2832 3032 302c 2031 322c 2032 2929  te(2020, 12, 2))
+0001a100: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+0001a110: 2e73 656c 6563 7428 6e65 7874 5f64 6179  .select(next_day
+0001a120: 2822 6122 2c20 2266 7222 2929 2e63 6f6c  ("a", "fr")).col
+0001a130: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0001a140: 526f 7728 4e45 5854 5f44 4159 2822 4122  Row(NEXT_DAY("A"
+0001a150: 2c20 2746 5227 293d 6461 7465 7469 6d65  , 'FR')=datetime
+0001a160: 2e64 6174 6528 3230 3230 2c20 382c 2037  .date(2020, 8, 7
+0001a170: 2929 2c20 526f 7728 4e45 5854 5f44 4159  )), Row(NEXT_DAY
+0001a180: 2822 4122 2c20 2746 5227 293d 6461 7465  ("A", 'FR')=date
+0001a190: 7469 6d65 2e64 6174 6528 3230 3230 2c20  time.date(2020, 
+0001a1a0: 3132 2c20 3429 295d 0a20 2020 2022 2222  12, 4))].    """
+0001a1b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0001a1c0: 5f69 665f 7374 7228 6461 7465 2c20 226e  _if_str(date, "n
+0001a1d0: 6578 745f 6461 7922 290a 2020 2020 7265  ext_day").    re
+0001a1e0: 7475 726e 2062 7569 6c74 696e 2822 6e65  turn builtin("ne
+0001a1f0: 7874 5f64 6179 2229 2863 2c20 436f 6c75  xt_day")(c, Colu
+0001a200: 6d6e 2e5f 746f 5f65 7870 7228 6461 795f  mn._to_expr(day_
+0001a210: 6f66 5f77 6565 6b29 290a 0a0a 6465 6620  of_week))...def 
+0001a220: 7072 6576 696f 7573 5f64 6179 2864 6174  previous_day(dat
+0001a230: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
+0001a240: 2064 6179 5f6f 665f 7765 656b 3a20 436f   day_of_week: Co
+0001a250: 6c75 6d6e 4f72 4c69 7465 7261 6c29 202d  lumnOrLiteral) -
+0001a260: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0001a270: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
+0001a280: 6520 6461 7465 206f 6620 7468 6520 6669  e date of the fi
+0001a290: 7273 7420 7370 6563 6966 6965 6420 444f  rst specified DO
+0001a2a0: 5720 2864 6179 206f 6620 7765 656b 2920  W (day of week) 
+0001a2b0: 7468 6174 206f 6363 7572 7320 6265 666f  that occurs befo
+0001a2c0: 7265 2074 6865 2069 6e70 7574 2064 6174  re the input dat
+0001a2d0: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
+0001a2e0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
+0001a2f0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+0001a300: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0001a310: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0001a320: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
+0001a330: 2020 202e 2e2e 2020 2020 2028 6461 7465     ...     (date
+0001a340: 7469 6d65 2e64 6174 652e 6672 6f6d 6973  time.date.fromis
+0001a350: 6f66 6f72 6d61 7428 2232 3032 302d 3038  oformat("2020-08
+0001a360: 2d30 3122 292c 2022 6d6f 2229 2c0a 2020  -01"), "mo"),.  
+0001a370: 2020 2020 2020 2e2e 2e20 2020 2020 2864        ...     (d
+0001a380: 6174 6574 696d 652e 6461 7465 2e66 726f  atetime.date.fro
+0001a390: 6d69 736f 666f 726d 6174 2822 3230 3230  misoformat("2020
+0001a3a0: 2d31 322d 3031 2229 2c20 2277 6522 292c  -12-01"), "we"),
+0001a3b0: 0a20 2020 2020 2020 202e 2e2e 205d 2c20  .        ... ], 
+0001a3c0: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
+0001a3d0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0001a3e0: 662e 7365 6c65 6374 2870 7265 7669 6f75  f.select(previou
+0001a3f0: 735f 6461 7928 2261 222c 2063 6f6c 2822  s_day("a", col("
+0001a400: 6222 2929 292e 636f 6c6c 6563 7428 290a  b"))).collect().
+0001a410: 2020 2020 2020 2020 5b52 6f77 2850 5245          [Row(PRE
+0001a420: 5649 4f55 535f 4441 5928 2241 222c 2022  VIOUS_DAY("A", "
+0001a430: 4222 293d 6461 7465 7469 6d65 2e64 6174  B")=datetime.dat
+0001a440: 6528 3230 3230 2c20 372c 2032 3729 292c  e(2020, 7, 27)),
+0001a450: 2052 6f77 2850 5245 5649 4f55 535f 4441   Row(PREVIOUS_DA
+0001a460: 5928 2241 222c 2022 4222 293d 6461 7465  Y("A", "B")=date
+0001a470: 7469 6d65 2e64 6174 6528 3230 3230 2c20  time.date(2020, 
+0001a480: 3131 2c20 3235 2929 5d0a 2020 2020 2020  11, 25))].      
+0001a490: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001a4a0: 7072 6576 696f 7573 5f64 6179 2822 6122  previous_day("a"
+0001a4b0: 2c20 2266 7222 2929 2e63 6f6c 6c65 6374  , "fr")).collect
+0001a4c0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0001a4d0: 5052 4556 494f 5553 5f44 4159 2822 4122  PREVIOUS_DAY("A"
+0001a4e0: 2c20 2746 5227 293d 6461 7465 7469 6d65  , 'FR')=datetime
+0001a4f0: 2e64 6174 6528 3230 3230 2c20 372c 2033  .date(2020, 7, 3
+0001a500: 3129 292c 2052 6f77 2850 5245 5649 4f55  1)), Row(PREVIOU
+0001a510: 535f 4441 5928 2241 222c 2027 4652 2729  S_DAY("A", 'FR')
+0001a520: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
+0001a530: 3032 302c 2031 312c 2032 3729 295d 0a20  020, 11, 27))]. 
+0001a540: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0001a550: 746f 5f63 6f6c 5f69 665f 7374 7228 6461  to_col_if_str(da
+0001a560: 7465 2c20 2270 7265 7669 6f75 735f 6461  te, "previous_da
+0001a570: 7922 290a 2020 2020 7265 7475 726e 2062  y").    return b
+0001a580: 7569 6c74 696e 2822 7072 6576 696f 7573  uiltin("previous
+0001a590: 5f64 6179 2229 2863 2c20 436f 6c75 6d6e  _day")(c, Column
+0001a5a0: 2e5f 746f 5f65 7870 7228 6461 795f 6f66  ._to_expr(day_of
+0001a5b0: 5f77 6565 6b29 290a 0a0a 6465 6620 7365  _week))...def se
+0001a5c0: 636f 6e64 2865 3a20 436f 6c75 6d6e 4f72  cond(e: ColumnOr
+0001a5d0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0001a5e0: 0a20 2020 2022 2222 0a20 2020 2045 7874  .    """.    Ext
+0001a5f0: 7261 6374 7320 7468 6520 7365 636f 6e64  racts the second
+0001a600: 2066 726f 6d20 6120 6461 7465 206f 7220   from a date or 
+0001a610: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
+0001a620: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001a630: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0001a640: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+0001a650: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0001a660: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0001a670: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
+0001a680: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
+0001a690: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
+0001a6a0: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
+0001a6b0: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
+0001a6c0: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
+0001a6d0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0001a6e0: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
+0001a6f0: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
+0001a700: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
+0001a710: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
+0001a720: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
+0001a730: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
+0001a740: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0001a750: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0001a760: 6374 2873 6563 6f6e 6428 2261 2229 292e  ct(second("a")).
+0001a770: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0001a780: 2020 5b52 6f77 2853 4543 4f4e 4428 2241    [Row(SECOND("A
+0001a790: 2229 3d32 3029 2c20 526f 7728 5345 434f  ")=20), Row(SECO
+0001a7a0: 4e44 2822 4122 293d 3529 5d0a 2020 2020  ND("A")=5)].    
+0001a7b0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0001a7c0: 636f 6c5f 6966 5f73 7472 2865 2c20 2273  col_if_str(e, "s
+0001a7d0: 6563 6f6e 6422 290a 2020 2020 7265 7475  econd").    retu
+0001a7e0: 726e 2062 7569 6c74 696e 2822 7365 636f  rn builtin("seco
+0001a7f0: 6e64 2229 2863 290a 0a0a 6465 6620 6d6f  nd")(c)...def mo
+0001a800: 6e74 6828 653a 2043 6f6c 756d 6e4f 724e  nth(e: ColumnOrN
+0001a810: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0001a820: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
+0001a830: 6163 7473 2074 6865 206d 6f6e 7468 2066  acts the month f
+0001a840: 726f 6d20 6120 6461 7465 206f 7220 7469  rom a date or ti
+0001a850: 6d65 7374 616d 702e 0a0a 2020 2020 4578  mestamp...    Ex
+0001a860: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0001a870: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
+0001a880: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
+0001a890: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0001a8a0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0001a8b0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001a8c0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+0001a8d0: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
+0001a8e0: 302d 3035 2d30 3120 3133 3a31 313a 3230  0-05-01 13:11:20
+0001a8f0: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
+0001a900: 2025 483a 254d 3a25 532e 2566 2229 2c0a   %H:%M:%S.%f"),.
+0001a910: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001a920: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001a930: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001a940: 2d30 382d 3231 2030 313a 3330 3a30 352e  -08-21 01:30:05.
+0001a950: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001a960: 2548 3a25 4d3a 2553 2e25 6622 290a 2020  %H:%M:%S.%f").  
+0001a970: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
+0001a980: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+0001a990: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0001a9a0: 286d 6f6e 7468 2822 6122 2929 2e63 6f6c  (month("a")).col
+0001a9b0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0001a9c0: 526f 7728 4d4f 4e54 4828 2241 2229 3d35  Row(MONTH("A")=5
+0001a9d0: 292c 2052 6f77 284d 4f4e 5448 2822 4122  ), Row(MONTH("A"
+0001a9e0: 293d 3829 5d0a 2020 2020 2222 220a 2020  )=8)].    """.  
+0001a9f0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0001aa00: 5f73 7472 2865 2c20 226d 6f6e 7468 2229  _str(e, "month")
+0001aa10: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0001aa20: 7469 6e28 226d 6f6e 7468 2229 2863 290a  tin("month")(c).
+0001aa30: 0a0a 6465 6620 6d6f 6e74 686e 616d 6528  ..def monthname(
+0001aa40: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0001aa50: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0001aa60: 2222 220a 2020 2020 4578 7472 6163 7473  """.    Extracts
+0001aa70: 2074 6865 2074 6872 6565 2d6c 6574 7465   the three-lette
+0001aa80: 7220 6d6f 6e74 6820 6e61 6d65 2066 726f  r month name fro
+0001aa90: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
+0001aaa0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
+0001aab0: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
+0001aac0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
+0001aad0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+0001aae0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0001aaf0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0001ab00: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
+0001ab10: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
+0001ab20: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
+0001ab30: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
+0001ab40: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
+0001ab50: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
+0001ab60: 3a25 532e 2566 2229 2c0a 2020 2020 2020  :%S.%f"),.      
+0001ab70: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
+0001ab80: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
+0001ab90: 7469 6d65 2822 3230 3230 2d30 382d 3231  time("2020-08-21
+0001aba0: 2030 313a 3330 3a30 352e 3030 3022 2c20   01:30:05.000", 
+0001abb0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
+0001abc0: 2553 2e25 6622 290a 2020 2020 2020 2020  %S.%f").        
+0001abd0: 2e2e 2e20 5d2c 2073 6368 656d 613d 5b22  ... ], schema=["
+0001abe0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+0001abf0: 2064 662e 7365 6c65 6374 286d 6f6e 7468   df.select(month
+0001ac00: 6e61 6d65 2822 6122 2929 2e63 6f6c 6c65  name("a")).colle
+0001ac10: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0001ac20: 7728 4d4f 4e54 484e 414d 4528 2241 2229  w(MONTHNAME("A")
+0001ac30: 3d27 4d61 7927 292c 2052 6f77 284d 4f4e  ='May'), Row(MON
+0001ac40: 5448 4e41 4d45 2822 4122 293d 2741 7567  THNAME("A")='Aug
+0001ac50: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+0001ac60: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0001ac70: 7472 2865 2c20 226d 6f6e 7468 6e61 6d65  tr(e, "monthname
+0001ac80: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0001ac90: 696c 7469 6e28 226d 6f6e 7468 6e61 6d65  iltin("monthname
+0001aca0: 2229 2863 290a 0a0a 6465 6620 7175 6172  ")(c)...def quar
+0001acb0: 7465 7228 653a 2043 6f6c 756d 6e4f 724e  ter(e: ColumnOrN
+0001acc0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0001acd0: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
+0001ace0: 6163 7473 2074 6865 2071 7561 7274 6572  acts the quarter
+0001acf0: 2066 726f 6d20 6120 6461 7465 206f 7220   from a date or 
+0001ad00: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
+0001ad10: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001ad20: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0001ad30: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+0001ad40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0001ad50: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0001ad60: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
+0001ad70: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
+0001ad80: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
+0001ad90: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
+0001ada0: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
+0001adb0: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
+0001adc0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0001add0: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
+0001ade0: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
+0001adf0: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
+0001ae00: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
+0001ae10: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
+0001ae20: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
+0001ae30: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0001ae40: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0001ae50: 6374 2871 7561 7274 6572 2822 6122 2929  ct(quarter("a"))
+0001ae60: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001ae70: 2020 205b 526f 7728 5155 4152 5445 5228     [Row(QUARTER(
+0001ae80: 2241 2229 3d32 292c 2052 6f77 2851 5541  "A")=2), Row(QUA
+0001ae90: 5254 4552 2822 4122 293d 3329 5d0a 2020  RTER("A")=3)].  
+0001aea0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0001aeb0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0001aec0: 2271 7561 7274 6572 2229 0a20 2020 2072  "quarter").    r
+0001aed0: 6574 7572 6e20 6275 696c 7469 6e28 2271  eturn builtin("q
+0001aee0: 7561 7274 6572 2229 2863 290a 0a0a 6465  uarter")(c)...de
+0001aef0: 6620 7965 6172 2865 3a20 436f 6c75 6d6e  f year(e: Column
+0001af00: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0001af10: 6e3a 0a20 2020 2022 2222 0a20 2020 2045  n:.    """.    E
+0001af20: 7874 7261 6374 7320 7468 6520 7965 6172  xtracts the year
+0001af30: 2066 726f 6d20 6120 6461 7465 206f 7220   from a date or 
+0001af40: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
+0001af50: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001af60: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0001af70: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+0001af80: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0001af90: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0001afa0: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
+0001afb0: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
+0001afc0: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
+0001afd0: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
+0001afe0: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
+0001aff0: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
+0001b000: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0001b010: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
+0001b020: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
+0001b030: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
+0001b040: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
+0001b050: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
+0001b060: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
+0001b070: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0001b080: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0001b090: 6374 2879 6561 7228 2261 2229 292e 636f  ct(year("a")).co
+0001b0a0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001b0b0: 5b52 6f77 2859 4541 5228 2241 2229 3d32  [Row(YEAR("A")=2
+0001b0c0: 3032 3029 2c20 526f 7728 5945 4152 2822  020), Row(YEAR("
+0001b0d0: 4122 293d 3230 3230 295d 0a20 2020 2022  A")=2020)].    "
+0001b0e0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001b0f0: 6f6c 5f69 665f 7374 7228 652c 2022 7965  ol_if_str(e, "ye
+0001b100: 6172 2229 0a20 2020 2072 6574 7572 6e20  ar").    return 
+0001b110: 6275 696c 7469 6e28 2279 6561 7222 2928  builtin("year")(
+0001b120: 6329 0a0a 0a64 6566 2073 7973 6461 7465  c)...def sysdate
+0001b130: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+0001b140: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+0001b150: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
+0001b160: 6d65 7374 616d 7020 666f 7220 7468 6520  mestamp for the 
+0001b170: 7379 7374 656d 2c20 6275 7420 696e 2074  system, but in t
+0001b180: 6865 2055 5443 2074 696d 6520 7a6f 6e65  he UTC time zone
+0001b190: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0001b1a0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+0001b1b0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001b1c0: 655f 6461 7461 6672 616d 6528 5b31 5d2c  e_dataframe([1],
+0001b1d0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0001b1e0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001b1f0: 6c65 6374 2873 7973 6461 7465 2829 292e  lect(sysdate()).
+0001b200: 636f 6c6c 6563 7428 2920 6973 206e 6f74  collect() is not
+0001b210: 204e 6f6e 650a 2020 2020 2020 2020 5472   None.        Tr
+0001b220: 7565 0a20 2020 2022 2222 0a20 2020 2072  ue.    """.    r
+0001b230: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
+0001b240: 7973 6461 7465 2229 2829 0a0a 0a64 6566  ysdate")()...def
+0001b250: 206d 6f6e 7468 735f 6265 7477 6565 6e28   months_between(
+0001b260: 6461 7465 313a 2043 6f6c 756d 6e4f 724e  date1: ColumnOrN
+0001b270: 616d 652c 2064 6174 6532 3a20 436f 6c75  ame, date2: Colu
+0001b280: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0001b290: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0001b2a0: 2052 6574 7572 6e73 2074 6865 206e 756d   Returns the num
+0001b2b0: 6265 7220 6f66 206d 6f6e 7468 7320 6265  ber of months be
+0001b2c0: 7477 6565 6e20 7477 6f20 4441 5445 206f  tween two DATE o
+0001b2d0: 7220 5449 4d45 5354 414d 5020 7661 6c75  r TIMESTAMP valu
+0001b2e0: 6573 2e0a 0a20 2020 2045 7861 6d70 6c65  es...    Example
+0001b2f0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0001b300: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+0001b310: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001b320: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0001b330: 6461 7461 6672 616d 6528 5b5b 0a20 2020  dataframe([[.   
+0001b340: 2020 2020 202e 2e2e 2020 2020 2064 6174       ...     dat
+0001b350: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
+0001b360: 7472 7074 696d 6528 2232 3032 302d 3035  trptime("2020-05
+0001b370: 2d30 3120 3133 3a31 313a 3230 2e30 3030  -01 13:11:20.000
+0001b380: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
+0001b390: 254d 3a25 532e 2566 2229 2c0a 2020 2020  %M:%S.%f"),.    
+0001b3a0: 2020 2020 2e2e 2e20 2020 2020 6461 7465      ...     date
+0001b3b0: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
+0001b3c0: 7270 7469 6d65 2822 3230 3230 2d30 382d  rptime("2020-08-
+0001b3d0: 3231 2030 313a 3330 3a30 352e 3030 3022  21 01:30:05.000"
+0001b3e0: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
+0001b3f0: 4d3a 2553 2e25 6622 290a 2020 2020 2020  M:%S.%f").      
+0001b400: 2020 2e2e 2e20 5d5d 2c20 7363 6865 6d61    ... ]], schema
+0001b410: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
+0001b420: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0001b430: 6374 286d 6f6e 7468 735f 6265 7477 6565  ct(months_betwee
+0001b440: 6e28 2261 222c 2022 6222 2929 2e63 6f6c  n("a", "b")).col
+0001b450: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0001b460: 526f 7728 4d4f 4e54 4853 5f42 4554 5745  Row(MONTHS_BETWE
+0001b470: 454e 2822 4122 2c20 2242 2229 3d44 6563  EN("A", "B")=Dec
+0001b480: 696d 616c 2827 2d33 2e36 3239 3435 3227  imal('-3.629452'
+0001b490: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+0001b4a0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
+0001b4b0: 7374 7228 6461 7465 312c 2022 6d6f 6e74  str(date1, "mont
+0001b4c0: 6873 5f62 6574 7765 656e 2229 0a20 2020  hs_between").   
+0001b4d0: 2063 3220 3d20 5f74 6f5f 636f 6c5f 6966   c2 = _to_col_if
+0001b4e0: 5f73 7472 2864 6174 6532 2c20 226d 6f6e  _str(date2, "mon
+0001b4f0: 7468 735f 6265 7477 6565 6e22 290a 2020  ths_between").  
+0001b500: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001b510: 2822 6d6f 6e74 6873 5f62 6574 7765 656e  ("months_between
+0001b520: 2229 2863 312c 2063 3229 0a0a 0a64 6566  ")(c1, c2)...def
+0001b530: 2074 6f5f 6765 6f67 7261 7068 7928 653a   to_geography(e:
+0001b540: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0001b550: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0001b560: 2250 6172 7365 7320 616e 2069 6e70 7574  "Parses an input
+0001b570: 2061 6e64 2072 6574 7572 6e73 2061 2076   and returns a v
+0001b580: 616c 7565 206f 6620 7479 7065 2047 454f  alue of type GEO
+0001b590: 4752 4150 4859 2e20 5375 7070 6f72 7465  GRAPHY. Supporte
+0001b5a0: 6420 696e 7075 7473 2061 7265 2073 7472  d inputs are str
+0001b5b0: 696e 6773 2069 6e0a 0a20 2020 2020 2020  ings in..       
+0001b5c0: 202d 2057 4b54 2028 7765 6c6c 2d6b 6e6f   - WKT (well-kno
+0001b5d0: 776e 2074 6578 7429 2e0a 2020 2020 2020  wn text)..      
+0001b5e0: 2020 2d20 574b 4220 2877 656c 6c2d 6b6e    - WKB (well-kn
+0001b5f0: 6f77 6e20 6269 6e61 7279 2920 696e 2068  own binary) in h
+0001b600: 6578 6164 6563 696d 616c 2066 6f72 6d61  exadecimal forma
+0001b610: 7420 2877 6974 686f 7574 2061 206c 6561  t (without a lea
+0001b620: 6469 6e67 2030 7829 2e0a 2020 2020 2020  ding 0x)..      
+0001b630: 2020 2d20 4557 4b54 2028 6578 7465 6e64    - EWKT (extend
+0001b640: 6564 2077 656c 6c2d 6b6e 6f77 6e20 7465  ed well-known te
+0001b650: 7874 292e 0a20 2020 2020 2020 202d 2045  xt)..        - E
+0001b660: 574b 4220 2865 7874 656e 6465 6420 7765  WKB (extended we
+0001b670: 6c6c 2d6b 6e6f 776e 2062 696e 6172 7929  ll-known binary)
+0001b680: 2069 6e20 6865 7861 6465 6369 6d61 6c20   in hexadecimal 
+0001b690: 666f 726d 6174 2028 7769 7468 6f75 7420  format (without 
+0001b6a0: 6120 6c65 6164 696e 6720 3078 292e 0a20  a leading 0x).. 
+0001b6b0: 2020 2020 2020 202d 2047 656f 4a53 4f4e         - GeoJSON
+0001b6c0: 2e0a 0a20 2020 2066 6f72 6d61 742e 0a0a  ...    format...
+0001b6d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0001b6e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0001b6f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0001b700: 7461 6672 616d 6528 5b27 504f 494e 5428  taframe(['POINT(
+0001b710: 2d31 3232 2e33 3520 3337 2e35 3529 272c  -122.35 37.55)',
+0001b720: 2027 504f 494e 5428 3230 2e39 3220 3433   'POINT(20.92 43
+0001b730: 2e33 3329 275d 2c20 7363 6865 6d61 3d5b  .33)'], schema=[
+0001b740: 2761 275d 290a 2020 2020 2020 2020 3e3e  'a']).        >>
+0001b750: 3e20 6466 2e73 656c 6563 7428 746f 5f67  > df.select(to_g
+0001b760: 656f 6772 6170 6879 2863 6f6c 2822 6122  eography(col("a"
+0001b770: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
+0001b780: 2020 2020 2020 5b52 6f77 2854 4f5f 4745        [Row(TO_GE
+0001b790: 4f47 5241 5048 5928 2241 2229 3d27 7b5c  OGRAPHY("A")='{\
+0001b7a0: 5c6e 2020 2263 6f6f 7264 696e 6174 6573  \n  "coordinates
+0001b7b0: 223a 205b 5c5c 6e20 2020 202d 3132 322e  ": [\\n    -122.
+0001b7c0: 3335 2c5c 5c6e 2020 2020 3337 2e35 355c  35,\\n    37.55\
+0001b7d0: 5c6e 2020 5d2c 5c5c 6e20 2022 7479 7065  \n  ],\\n  "type
+0001b7e0: 223a 2022 506f 696e 7422 5c5c 6e7d 2729  ": "Point"\\n}')
+0001b7f0: 2c20 526f 7728 544f 5f47 454f 4752 4150  , Row(TO_GEOGRAP
+0001b800: 4859 2822 4122 293d 277b 5c5c 6e20 2022  HY("A")='{\\n  "
+0001b810: 636f 6f72 6469 6e61 7465 7322 3a20 5b5c  coordinates": [\
+0001b820: 5c6e 2020 2020 3230 2e39 322c 5c5c 6e20  \n    20.92,\\n 
+0001b830: 2020 2034 332e 3333 5c5c 6e20 205d 2c5c     43.33\\n  ],\
+0001b840: 5c6e 2020 2274 7970 6522 3a20 2250 6f69  \n  "type": "Poi
+0001b850: 6e74 225c 5c6e 7d27 295d 0a0a 2020 2020  nt"\\n}')]..    
+0001b860: 4265 7369 6465 7320 7374 7269 6e67 732c  Besides strings,
+0001b870: 2062 696e 6172 7920 7265 7072 6573 656e   binary represen
+0001b880: 7461 7469 6f6e 2069 6e20 574b 4220 616e  tation in WKB an
+0001b890: 6420 4557 4b42 2066 6f72 6d61 7420 6361  d EWKB format ca
+0001b8a0: 6e20 6265 2070 6172 7365 642c 206f 7220  n be parsed, or 
+0001b8b0: 6f62 6a65 6374 7320 6164 6865 7269 6e67  objects adhering
+0001b8c0: 2074 6f20 4765 6f4a 534f 4e20 666f 726d   to GeoJSON form
+0001b8d0: 6174 2e0a 2020 2020 466f 7220 616c 6c20  at..    For all 
+0001b8e0: 7375 7070 6f72 7465 6420 666f 726d 6174  supported format
+0001b8f0: 7320 636f 6e66 6572 2068 7474 7073 3a2f  s confer https:/
+0001b900: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
+0001b910: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
+0001b920: 656e 6365 2f64 6174 612d 7479 7065 732d  ence/data-types-
+0001b930: 6765 6f73 7061 7469 616c 2373 7570 706f  geospatial#suppo
+0001b940: 7274 6564 2d67 656f 7370 6174 6961 6c2d  rted-geospatial-
+0001b950: 6f62 6a65 6374 2d74 7970 6573 2e0a 2020  object-types..  
+0001b960: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0001b970: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0001b980: 2274 6f5f 6765 6f67 7261 7068 7922 290a  "to_geography").
+0001b990: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001b9a0: 696e 2822 746f 5f67 656f 6772 6170 6879  in("to_geography
+0001b9b0: 2229 2863 290a 0a0a 6465 6620 6172 7261  ")(c)...def arra
+0001b9c0: 7973 5f6f 7665 726c 6170 2861 7272 6179  ys_overlap(array
+0001b9d0: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
+0001b9e0: 2061 7272 6179 323a 2043 6f6c 756d 6e4f   array2: ColumnO
+0001b9f0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0001ba00: 3a0a 2020 2020 2222 2243 6f6d 7061 7265  :.    """Compare
+0001ba10: 7320 7768 6574 6865 7220 7477 6f20 4152  s whether two AR
+0001ba20: 5241 5973 2068 6176 6520 6174 206c 6561  RAYs have at lea
+0001ba30: 7374 206f 6e65 2065 6c65 6d65 6e74 2069  st one element i
+0001ba40: 6e20 636f 6d6d 6f6e 2e20 5265 7475 726e  n common. Return
+0001ba50: 7320 5452 5545 0a20 2020 2069 6620 7468  s TRUE.    if th
+0001ba60: 6572 6520 6973 2061 7420 6c65 6173 7420  ere is at least 
+0001ba70: 6f6e 6520 656c 656d 656e 7420 696e 2063  one element in c
+0001ba80: 6f6d 6d6f 6e3b 206f 7468 6572 7769 7365  ommon; otherwise
+0001ba90: 2072 6574 7572 6e73 2046 414c 5345 2e20   returns FALSE. 
+0001baa0: 5468 6520 6675 6e63 7469 6f6e 0a20 2020  The function.   
+0001bab0: 2069 7320 4e55 4c4c 2d73 6166 652c 206d   is NULL-safe, m
+0001bac0: 6561 6e69 6e67 2069 7420 7472 6561 7473  eaning it treats
+0001bad0: 204e 554c 4c73 2061 7320 6b6e 6f77 6e20   NULLs as known 
+0001bae0: 7661 6c75 6573 2066 6f72 2063 6f6d 7061  values for compa
+0001baf0: 7269 6e67 2065 7175 616c 6974 792e 0a0a  ring equality...
+0001bb00: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0001bb10: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0001bb20: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0001bb30: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+0001bb40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0001bb50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0001bb60: 6166 7261 6d65 285b 526f 7728 5b31 2c20  aframe([Row([1, 
+0001bb70: 325d 2c20 5b31 2c20 335d 292c 2052 6f77  2], [1, 3]), Row
+0001bb80: 285b 312c 2032 5d2c 205b 332c 2034 5d29  ([1, 2], [3, 4])
+0001bb90: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+0001bba0: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
+0001bbb0: 3e20 6466 2e73 656c 6563 7428 6172 7261  > df.select(arra
+0001bbc0: 7973 5f6f 7665 726c 6170 2822 6122 2c20  ys_overlap("a", 
+0001bbd0: 2262 2229 2e61 6c69 6173 2822 7265 7375  "b").alias("resu
+0001bbe0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0001bbf0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0001bc00: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0001bc10: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0001bc20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0001bc30: 2020 2020 7c54 7275 6520 2020 2020 207c      |True      |
+0001bc40: 0a20 2020 2020 2020 207c 4661 6c73 6520  .        |False 
+0001bc50: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0001bc60: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001bc70: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+0001bc80: 2020 2022 2222 0a20 2020 2061 3120 3d20     """.    a1 = 
+0001bc90: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
+0001bca0: 7272 6179 312c 2022 6172 7261 7973 5f6f  rray1, "arrays_o
+0001bcb0: 7665 726c 6170 2229 0a20 2020 2061 3220  verlap").    a2 
+0001bcc0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001bcd0: 2861 7272 6179 322c 2022 6172 7261 7973  (array2, "arrays
+0001bce0: 5f6f 7665 726c 6170 2229 0a20 2020 2072  _overlap").    r
+0001bcf0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+0001bd00: 7272 6179 735f 6f76 6572 6c61 7022 2928  rrays_overlap")(
+0001bd10: 6131 2c20 6132 290a 0a0a 6465 6620 6172  a1, a2)...def ar
+0001bd20: 7261 795f 6469 7374 696e 6374 2863 6f6c  ray_distinct(col
+0001bd30: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 293a  : ColumnOrName):
+0001bd40: 0a20 2020 2022 2222 5468 6520 6675 6e63  .    """The func
+0001bd50: 7469 6f6e 2065 7863 6c75 6465 7320 616e  tion excludes an
+0001bd60: 7920 6475 706c 6963 6174 6520 656c 656d  y duplicate elem
+0001bd70: 656e 7473 2074 6861 7420 6172 6520 7072  ents that are pr
+0001bd80: 6573 656e 7420 696e 2074 6865 2069 6e70  esent in the inp
+0001bd90: 7574 2041 5252 4159 2e0a 2020 2020 5468  ut ARRAY..    Th
+0001bda0: 6520 6675 6e63 7469 6f6e 2069 7320 6e6f  e function is no
+0001bdb0: 7420 6775 6172 616e 7465 6564 2074 6f20  t guaranteed to 
+0001bdc0: 7265 7475 726e 2074 6865 2065 6c65 6d65  return the eleme
+0001bdd0: 6e74 7320 696e 2074 6865 2041 5252 4159  nts in the ARRAY
+0001bde0: 2069 6e20 6120 7370 6563 6966 6963 206f   in a specific o
+0001bdf0: 7264 6572 2e0a 2020 2020 5468 6520 6675  rder..    The fu
+0001be00: 6e63 7469 6f6e 2069 7320 4e55 4c4c 2073  nction is NULL s
+0001be10: 6166 652c 2077 6869 6368 206d 6561 6e73  afe, which means
+0001be20: 2074 6861 7420 6974 2074 7265 6174 7320   that it treats 
+0001be30: 4e55 4c4c 7320 6173 206b 6e6f 776e 2076  NULLs as known v
+0001be40: 616c 7565 7320 7768 656e 2069 6465 6e74  alues when ident
+0001be50: 6966 7969 6e67 2064 7570 6c69 6361 7465  ifying duplicate
+0001be60: 2065 6c65 6d65 6e74 732e 0a0a 2020 2020   elements...    
+0001be70: 4172 6773 3a0a 2020 2020 2020 2020 636f  Args:.        co
+0001be80: 6c3a 2054 6865 2061 7272 6179 2063 6f6c  l: The array col
+0001be90: 756d 6e0a 0a20 2020 2052 6574 7572 6e73  umn..    Returns
+0001bea0: 3a0a 2020 2020 2020 2020 5265 7475 726e  :.        Return
+0001beb0: 7320 6120 6e65 7720 4152 5241 5920 7468  s a new ARRAY th
+0001bec0: 6174 2063 6f6e 7461 696e 7320 6f6e 6c79  at contains only
+0001bed0: 2074 6865 2064 6973 7469 6e63 7420 656c   the distinct el
+0001bee0: 656d 656e 7473 2066 726f 6d20 7468 6520  ements from the 
+0001bef0: 696e 7075 7420 4152 5241 592e 0a0a 2020  input ARRAY...  
+0001bf00: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0001bf10: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0001bf20: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0001bf30: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+0001bf40: 7420 6172 7261 795f 636f 6e73 7472 7563  t array_construc
+0001bf50: 742c 6172 7261 795f 6469 7374 696e 6374  t,array_distinct
+0001bf60: 2c6c 6974 0a20 2020 2020 2020 203e 3e3e  ,lit.        >>>
+0001bf70: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0001bf80: 6561 7465 4461 7461 4672 616d 6528 5b5b  eateDataFrame([[
+0001bf90: 2231 225d 5d2c 205b 2241 225d 290a 2020  "1"]], ["A"]).  
+0001bfa0: 2020 2020 2020 3e3e 3e20 6466 203d 2064        >>> df = d
+0001bfb0: 662e 7769 7468 436f 6c75 6d6e 2822 6172  f.withColumn("ar
+0001bfc0: 7261 7922 2c20 6172 7261 795f 636f 6e73  ray", array_cons
+0001bfd0: 7472 7563 7428 6c69 7428 3129 2c20 6c69  truct(lit(1), li
+0001bfe0: 7428 3129 2c20 6c69 7428 3129 2c20 6c69  t(1), lit(1), li
+0001bff0: 7428 3229 2c20 6c69 7428 3329 2c20 6c69  t(2), lit(3), li
+0001c000: 7428 3229 2c20 6c69 7428 3229 2929 0a20  t(2), lit(2))). 
+0001c010: 2020 2020 2020 203e 3e3e 2064 662e 7769         >>> df.wi
+0001c020: 7468 436f 6c75 6d6e 2822 6172 7261 795f  thColumn("array_
+0001c030: 6422 2c20 6172 7261 795f 6469 7374 696e  d", array_distin
+0001c040: 6374 2822 4152 5241 5922 2929 2e73 686f  ct("ARRAY")).sho
+0001c050: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0001c060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001c070: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001c080: 2020 7c22 4122 2020 7c22 4152 5241 5922    |"A"  |"ARRAY"
+0001c090: 2020 7c22 4152 5241 595f 4422 2020 7c0a    |"ARRAY_D"  |.
+0001c0a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001c0b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001c0c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+0001c0d0: 2020 2020 7c5b 2020 2020 2020 2020 7c5b      |[        |[
+0001c0e0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0001c0f0: 2020 2020 7c20 2020 2020 7c20 2031 2c20      |     |  1, 
+0001c100: 2020 2020 7c20 2031 2c20 2020 2020 2020      |  1,       
+0001c110: 7c0a 2020 2020 2020 2020 7c20 2020 2020  |.        |     
+0001c120: 7c20 2031 2c20 2020 2020 7c20 2032 2c20  |  1,     |  2, 
+0001c130: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0001c140: 7c20 2020 2020 7c20 2031 2c20 2020 2020  |     |  1,     
+0001c150: 7c20 2033 2020 2020 2020 2020 7c0a 2020  |  3        |.  
+0001c160: 2020 2020 2020 7c20 2020 2020 7c20 2032        |     |  2
+0001c170: 2c20 2020 2020 7c5d 2020 2020 2020 2020  ,     |]        
+0001c180: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+0001c190: 2020 7c20 2033 2c20 2020 2020 7c20 2020    |  3,     |   
+0001c1a0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0001c1b0: 2020 7c20 2020 2020 7c20 2032 2c20 2020    |     |  2,   
+0001c1c0: 2020 7c20 2020 2020 2020 2020 2020 7c0a    |           |.
+0001c1d0: 2020 2020 2020 2020 7c20 2020 2020 7c20          |     | 
+0001c1e0: 2032 2020 2020 2020 7c20 2020 2020 2020   2      |       
+0001c1f0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0001c200: 2020 2020 7c5d 2020 2020 2020 2020 7c20      |]        | 
+0001c210: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0001c220: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0001c230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001c240: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0001c250: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0001c260: 2020 636f 6c20 3d20 5f74 6f5f 636f 6c5f    col = _to_col_
+0001c270: 6966 5f73 7472 2863 6f6c 2c20 2261 7272  if_str(col, "arr
+0001c280: 6179 5f64 6973 7469 6e63 7422 290a 2020  ay_distinct").  
+0001c290: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001c2a0: 2822 6172 7261 795f 6469 7374 696e 6374  ("array_distinct
+0001c2b0: 2229 2863 6f6c 290a 0a0a 6465 6620 6172  ")(col)...def ar
+0001c2c0: 7261 795f 696e 7465 7273 6563 7469 6f6e  ray_intersection
+0001c2d0: 2861 7272 6179 313a 2043 6f6c 756d 6e4f  (array1: ColumnO
+0001c2e0: 724e 616d 652c 2061 7272 6179 323a 2043  rName, array2: C
+0001c2f0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0001c300: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+0001c310: 6574 7572 6e73 2061 6e20 6172 7261 7920  eturns an array 
+0001c320: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
+0001c330: 6520 6d61 7463 6869 6e67 2065 6c65 6d65  e matching eleme
+0001c340: 6e74 7320 696e 2074 6865 2074 776f 2069  nts in the two i
+0001c350: 6e70 7574 2061 7272 6179 732e 0a0a 2020  nput arrays...  
+0001c360: 2020 5468 6520 6675 6e63 7469 6f6e 2069    The function i
+0001c370: 7320 4e55 4c4c 2d73 6166 652c 206d 6561  s NULL-safe, mea
+0001c380: 6e69 6e67 2069 7420 7472 6561 7473 204e  ning it treats N
+0001c390: 554c 4c73 2061 7320 6b6e 6f77 6e20 7661  ULLs as known va
+0001c3a0: 6c75 6573 2066 6f72 2063 6f6d 7061 7269  lues for compari
+0001c3b0: 6e67 2065 7175 616c 6974 792e 0a0a 2020  ng equality...  
+0001c3c0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0001c3d0: 6172 7261 7931 3a20 416e 2041 5252 4159  array1: An ARRAY
+0001c3e0: 2074 6861 7420 636f 6e74 6169 6e73 2065   that contains e
+0001c3f0: 6c65 6d65 6e74 7320 746f 2062 6520 636f  lements to be co
+0001c400: 6d70 6172 6564 2e0a 2020 2020 2020 2020  mpared..        
+0001c410: 6172 7261 7932 3a20 416e 2041 5252 4159  array2: An ARRAY
+0001c420: 2074 6861 7420 636f 6e74 6169 6e73 2065   that contains e
+0001c430: 6c65 6d65 6e74 7320 746f 2062 6520 636f  lements to be co
+0001c440: 6d70 6172 6564 2e0a 0a20 2020 2045 7861  mpared...    Exa
+0001c450: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+0001c460: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0001c470: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
+0001c480: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
+0001c490: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0001c4a0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0001c4b0: 5b52 6f77 285b 312c 2032 5d2c 205b 312c  [Row([1, 2], [1,
+0001c4c0: 2033 5d29 5d2c 2073 6368 656d 613d 5b22   3])], schema=["
+0001c4d0: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+0001c4e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001c4f0: 6172 7261 795f 696e 7465 7273 6563 7469  array_intersecti
+0001c500: 6f6e 2822 6122 2c20 2262 2229 2e61 6c69  on("a", "b").ali
+0001c510: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+0001c520: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+0001c530: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001c540: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+0001c550: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001c560: 2d2d 2d0a 2020 2020 2020 2020 7c5b 2020  ---.        |[  
+0001c570: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0001c580: 207c 2020 3120 2020 2020 2020 7c0a 2020   |  1       |.  
+0001c590: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
+0001c5a0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001c5b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001c5c0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0001c5d0: 2222 220a 2020 2020 6131 203d 205f 746f  """.    a1 = _to
+0001c5e0: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
+0001c5f0: 7931 2c20 2261 7272 6179 5f69 6e74 6572  y1, "array_inter
+0001c600: 7365 6374 696f 6e22 290a 2020 2020 6132  section").    a2
+0001c610: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001c620: 7228 6172 7261 7932 2c20 2261 7272 6179  r(array2, "array
+0001c630: 5f69 6e74 6572 7365 6374 696f 6e22 290a  _intersection").
+0001c640: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001c650: 696e 2822 6172 7261 795f 696e 7465 7273  in("array_inters
+0001c660: 6563 7469 6f6e 2229 2861 312c 2061 3229  ection")(a1, a2)
+0001c670: 0a0a 0a64 6566 2064 6174 655f 6164 6428  ...def date_add(
+0001c680: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
+0001c690: 652c 206e 756d 5f6f 665f 6461 7973 3a20  e, num_of_days: 
+0001c6a0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+0001c6b0: 6d65 2c20 696e 745d 293a 0a20 2020 2022  me, int]):.    "
+0001c6c0: 2222 0a20 2020 2041 6464 7320 6120 6e75  "".    Adds a nu
+0001c6d0: 6d62 6572 206f 6620 6461 7973 2074 6f20  mber of days to 
+0001c6e0: 6120 6461 7465 2063 6f6c 756d 6e2e 0a0a  a date column...
+0001c6f0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0001c700: 2020 636f 6c3a 2054 6865 2063 6f6c 756d    col: The colum
+0001c710: 6e20 746f 2061 6464 2074 6f2e 0a20 2020  n to add to..   
+0001c720: 2020 2020 206e 756d 5f6f 665f 6461 7973       num_of_days
+0001c730: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
+0001c740: 6461 7973 2074 6f20 6164 642e 0a0a 2020  days to add...  
+0001c750: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0001c760: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0001c770: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0001c780: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+0001c790: 7420 6461 7465 5f61 6464 2c20 746f 5f64  t date_add, to_d
+0001c7a0: 6174 650a 2020 2020 2020 2020 3e3e 3e20  ate.        >>> 
+0001c7b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001c7c0: 6174 6544 6174 6146 7261 6d65 285b 2822  ateDataFrame([("
+0001c7d0: 3139 3736 2d30 312d 3036 2229 5d2c 205b  1976-01-06")], [
+0001c7e0: 2264 6174 6522 5d29 0a20 2020 2020 2020  "date"]).       
+0001c7f0: 203e 3e3e 2064 6620 3d20 6466 2e77 6974   >>> df = df.wit
+0001c800: 6843 6f6c 756d 6e28 2264 6174 6522 2c20  hColumn("date", 
+0001c810: 746f 5f64 6174 6528 2264 6174 6522 2929  to_date("date"))
+0001c820: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+0001c830: 203d 2064 662e 7769 7468 436f 6c75 6d6e   = df.withColumn
+0001c840: 2822 6461 7465 222c 2064 6174 655f 6164  ("date", date_ad
+0001c850: 6428 2264 6174 6522 2c20 3429 292e 7368  d("date", 4)).sh
+0001c860: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+0001c870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0001c880: 2020 2020 7c22 4441 5445 2220 2020 2020      |"DATE"     
+0001c890: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001c8a0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001c8b0: 2020 7c31 3937 362d 3031 2d31 3020 207c    |1976-01-10  |
+0001c8c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001c8d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001c8e0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0001c8f0: 2222 220a 2020 2020 2320 436f 6e76 6572  """.    # Conver
+0001c900: 7420 7468 6520 696e 7075 7420 746f 2061  t the input to a
+0001c910: 2063 6f6c 756d 6e20 6966 2069 7420 6973   column if it is
+0001c920: 2061 2073 7472 696e 670a 2020 2020 636f   a string.    co
+0001c930: 6c20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  l = _to_col_if_s
+0001c940: 7472 2863 6f6c 2c20 2264 6174 655f 6164  tr(col, "date_ad
+0001c950: 6422 290a 2020 2020 6e75 6d5f 6f66 5f64  d").    num_of_d
+0001c960: 6179 7320 3d20 280a 2020 2020 2020 2020  ays = (.        
+0001c970: 6c69 7428 6e75 6d5f 6f66 5f64 6179 7329  lit(num_of_days)
+0001c980: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001c990: 7374 616e 6365 286e 756d 5f6f 665f 6461  stance(num_of_da
+0001c9a0: 7973 2c20 696e 7429 0a20 2020 2020 2020  ys, int).       
+0001c9b0: 2065 6c73 6520 5f74 6f5f 636f 6c5f 6966   else _to_col_if
+0001c9c0: 5f73 7472 286e 756d 5f6f 665f 6461 7973  _str(num_of_days
+0001c9d0: 2c20 2264 6174 655f 6164 6422 290a 2020  , "date_add").  
+0001c9e0: 2020 290a 2020 2020 2320 5265 7475 726e    ).    # Return
+0001c9f0: 2074 6865 2064 6174 6561 6464 2066 756e   the dateadd fun
+0001ca00: 6374 696f 6e20 7769 7468 2074 6865 2063  ction with the c
+0001ca10: 6f6c 756d 6e20 616e 6420 6e75 6d62 6572  olumn and number
+0001ca20: 206f 6620 6461 7973 0a20 2020 2072 6574   of days.    ret
+0001ca30: 7572 6e20 6461 7465 6164 6428 2264 6179  urn dateadd("day
+0001ca40: 222c 206e 756d 5f6f 665f 6461 7973 2c20  ", num_of_days, 
+0001ca50: 636f 6c29 0a0a 0a64 6566 2064 6174 655f  col)...def date_
+0001ca60: 7375 6228 636f 6c3a 2043 6f6c 756d 6e4f  sub(col: ColumnO
+0001ca70: 724e 616d 652c 206e 756d 5f6f 665f 6461  rName, num_of_da
+0001ca80: 7973 3a20 556e 696f 6e5b 436f 6c75 6d6e  ys: Union[Column
+0001ca90: 4f72 4e61 6d65 2c20 696e 745d 293a 0a20  OrName, int]):. 
+0001caa0: 2020 2022 2222 0a20 2020 2053 7562 7472     """.    Subtr
+0001cab0: 6163 7473 2061 206e 756d 6265 7220 6f66  acts a number of
+0001cac0: 2064 6179 7320 6672 6f6d 2061 2064 6174   days from a dat
+0001cad0: 6520 636f 6c75 6d6e 2e0a 0a20 2020 2041  e column...    A
+0001cae0: 7267 733a 0a20 2020 2020 2020 2063 6f6c  rgs:.        col
+0001caf0: 3a20 5468 6520 636f 6c75 6d6e 2074 6f20  : The column to 
+0001cb00: 7375 6274 7261 6374 2066 726f 6d2e 0a20  subtract from.. 
+0001cb10: 2020 2020 2020 206e 756d 5f6f 665f 6461         num_of_da
+0001cb20: 7973 3a20 5468 6520 6e75 6d62 6572 206f  ys: The number o
+0001cb30: 6620 6461 7973 2074 6f20 7375 6274 7261  f days to subtra
+0001cb40: 6374 2e0a 0a20 2020 2045 7861 6d70 6c65  ct...    Example
+0001cb50: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0001cb60: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0001cb70: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+0001cb80: 7320 696d 706f 7274 2064 6174 655f 7375  s import date_su
+0001cb90: 622c 2074 6f5f 6461 7465 0a20 2020 2020  b, to_date.     
+0001cba0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0001cbb0: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
+0001cbc0: 616d 6528 5b28 2231 3937 362d 3031 2d30  ame([("1976-01-0
+0001cbd0: 3622 295d 2c20 5b22 6461 7465 225d 290a  6")], ["date"]).
+0001cbe0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001cbf0: 2064 662e 7769 7468 436f 6c75 6d6e 2822   df.withColumn("
+0001cc00: 6461 7465 222c 2074 6f5f 6461 7465 2822  date", to_date("
+0001cc10: 6461 7465 2229 290a 2020 2020 2020 2020  date")).        
+0001cc20: 3e3e 3e20 6466 2e77 6974 6843 6f6c 756d  >>> df.withColum
+0001cc30: 6e28 2264 6174 6522 2c20 6461 7465 5f73  n("date", date_s
+0001cc40: 7562 2822 6461 7465 222c 2032 2929 2e73  ub("date", 2)).s
+0001cc50: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0001cc60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001cc70: 2020 2020 207c 2244 4154 4522 2020 2020       |"DATE"    
+0001cc80: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001cc90: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001cca0: 2020 207c 3139 3736 2d30 312d 3034 2020     |1976-01-04  
+0001ccb0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0001ccc0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001ccd0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0001cce0: 2022 2222 0a20 2020 2023 2043 6f6e 7665   """.    # Conve
+0001ccf0: 7274 2074 6865 2069 6e70 7574 2070 6172  rt the input par
+0001cd00: 616d 6574 6572 7320 746f 2074 6865 2061  ameters to the a
+0001cd10: 7070 726f 7072 6961 7465 2074 7970 650a  ppropriate type.
+0001cd20: 2020 2020 636f 6c20 3d20 5f74 6f5f 636f      col = _to_co
+0001cd30: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2264  l_if_str(col, "d
+0001cd40: 6174 655f 7375 6222 290a 2020 2020 6e75  ate_sub").    nu
+0001cd50: 6d5f 6f66 5f64 6179 7320 3d20 280a 2020  m_of_days = (.  
+0001cd60: 2020 2020 2020 6c69 7428 6e75 6d5f 6f66        lit(num_of
+0001cd70: 5f64 6179 7329 0a20 2020 2020 2020 2069  _days).        i
+0001cd80: 6620 6973 696e 7374 616e 6365 286e 756d  f isinstance(num
+0001cd90: 5f6f 665f 6461 7973 2c20 696e 7429 0a20  _of_days, int). 
+0001cda0: 2020 2020 2020 2065 6c73 6520 5f74 6f5f         else _to_
+0001cdb0: 636f 6c5f 6966 5f73 7472 286e 756d 5f6f  col_if_str(num_o
+0001cdc0: 665f 6461 7973 2c20 2264 6174 655f 7375  f_days, "date_su
+0001cdd0: 6222 290a 2020 2020 290a 2020 2020 2320  b").    ).    # 
+0001cde0: 5265 7475 726e 2074 6865 2064 6174 6520  Return the date 
+0001cdf0: 636f 6c75 6d6e 2077 6974 6820 7468 6520  column with the 
+0001ce00: 6e75 6d62 6572 206f 6620 6461 7973 2073  number of days s
+0001ce10: 7562 7472 6163 7465 640a 2020 2020 7265  ubtracted.    re
+0001ce20: 7475 726e 2064 6174 6561 6464 2822 6461  turn dateadd("da
+0001ce30: 7922 2c20 2d31 202a 206e 756d 5f6f 665f  y", -1 * num_of_
+0001ce40: 6461 7973 2c20 636f 6c29 0a0a 0a64 6566  days, col)...def
+0001ce50: 2064 6174 6564 6966 6628 7061 7274 3a20   datediff(part: 
+0001ce60: 7374 722c 2063 6f6c 313a 2043 6f6c 756d  str, col1: Colum
+0001ce70: 6e4f 724e 616d 652c 2063 6f6c 323a 2043  nOrName, col2: C
+0001ce80: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0001ce90: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+0001cea0: 616c 6375 6c61 7465 7320 7468 6520 6469  alculates the di
+0001ceb0: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
+0001cec0: 2074 776f 2064 6174 652c 2074 696d 652c   two date, time,
+0001ced0: 206f 7220 7469 6d65 7374 616d 7020 636f   or timestamp co
+0001cee0: 6c75 6d6e 7320 6261 7365 6420 6f6e 2074  lumns based on t
+0001cef0: 6865 2064 6174 6520 6f72 2074 696d 6520  he date or time 
+0001cf00: 7061 7274 2072 6571 7565 7374 6564 2e0a  part requested..
+0001cf10: 0a20 2020 2060 5375 7070 6f72 7465 6420  .    `Supported 
+0001cf20: 6461 7465 2061 6e64 2074 696d 6520 7061  date and time pa
+0001cf30: 7274 7320 3c68 7474 7073 3a2f 2f64 6f63  rts <https://doc
+0001cf40: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
+0001cf50: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
+0001cf60: 2f66 756e 6374 696f 6e73 2d64 6174 652d  /functions-date-
+0001cf70: 7469 6d65 2e68 746d 6c23 6c61 6265 6c2d  time.html#label-
+0001cf80: 7375 7070 6f72 7465 642d 6461 7465 2d74  supported-date-t
+0001cf90: 696d 652d 7061 7274 733e 605f 0a0a 2020  ime-parts>`_..  
+0001cfa0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0001cfb0: 2020 2020 203e 3e3e 2023 2079 6561 7220       >>> # year 
+0001cfc0: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
+0001cfd0: 656e 2074 776f 2064 6174 6520 636f 6c75  en two date colu
+0001cfe0: 6d6e 730a 2020 2020 2020 2020 3e3e 3e20  mns.        >>> 
+0001cff0: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+0001d000: 2020 2020 2020 2020 3e3e 3e20 6461 7465          >>> date
+0001d010: 5f64 6620 3d20 7365 7373 696f 6e2e 6372  _df = session.cr
+0001d020: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0001d030: 5b64 6174 6574 696d 652e 6461 7465 2832  [datetime.date(2
+0001d040: 3032 302c 2031 2c20 3129 2c20 6461 7465  020, 1, 1), date
+0001d050: 7469 6d65 2e64 6174 6528 3230 3231 2c20  time.date(2021, 
+0001d060: 312c 2031 295d 5d2c 2073 6368 656d 613d  1, 1)]], schema=
+0001d070: 5b22 6461 7465 5f63 6f6c 3122 2c20 2264  ["date_col1", "d
+0001d080: 6174 655f 636f 6c32 225d 290a 2020 2020  ate_col2"]).    
+0001d090: 2020 2020 3e3e 3e20 6461 7465 5f64 662e      >>> date_df.
+0001d0a0: 7365 6c65 6374 2864 6174 6564 6966 6628  select(datediff(
+0001d0b0: 2279 6561 7222 2c20 636f 6c28 2264 6174  "year", col("dat
+0001d0c0: 655f 636f 6c31 2229 2c20 636f 6c28 2264  e_col1"), col("d
+0001d0d0: 6174 655f 636f 6c32 2229 292e 616c 6961  ate_col2")).alia
+0001d0e0: 7328 2279 6561 725f 6469 6666 2229 292e  s("year_diff")).
+0001d0f0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+0001d100: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0001d110: 2020 2020 2020 207c 2259 4541 525f 4449         |"YEAR_DI
+0001d120: 4646 2220 207c 0a20 2020 2020 2020 202d  FF"  |.        -
+0001d130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0001d140: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
+0001d150: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0001d160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0001d170: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0001d180: 453e 0a0a 2020 2020 4172 6773 3a0a 2020  E>..    Args:.  
+0001d190: 2020 2020 2020 7061 7274 3a20 5468 6520        part: The 
+0001d1a0: 7469 6d65 2070 6172 7420 746f 2075 7365  time part to use
+0001d1b0: 2066 6f72 2063 616c 6375 6c61 7469 6e67   for calculating
+0001d1c0: 2074 6865 2064 6966 6665 7265 6e63 650a   the difference.
+0001d1d0: 2020 2020 2020 2020 636f 6c31 3a20 5468          col1: Th
+0001d1e0: 6520 6669 7273 7420 7469 6d65 7374 616d  e first timestam
+0001d1f0: 7020 636f 6c75 6d6e 206f 7220 6d69 6e75  p column or minu
+0001d200: 656e 6420 696e 2074 6865 2064 6174 6564  end in the dated
+0001d210: 6966 660a 2020 2020 2020 2020 636f 6c32  iff.        col2
+0001d220: 3a20 5468 6520 7365 636f 6e64 2074 696d  : The second tim
+0001d230: 6573 7461 6d70 2063 6f6c 756d 6e20 6f72  estamp column or
+0001d240: 2074 6865 2073 7562 7472 6168 656e 6420   the subtrahend 
+0001d250: 696e 2074 6865 2064 6174 6564 6966 660a  in the datediff.
+0001d260: 2020 2020 2222 220a 2020 2020 6966 206e      """.    if n
+0001d270: 6f74 2069 7369 6e73 7461 6e63 6528 7061  ot isinstance(pa
+0001d280: 7274 2c20 7374 7229 3a0a 2020 2020 2020  rt, str):.      
+0001d290: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001d2a0: 6f72 2822 7061 7274 206d 7573 7420 6265  or("part must be
+0001d2b0: 2061 2073 7472 696e 6722 290a 2020 2020   a string").    
+0001d2c0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
+0001d2d0: 7374 7228 636f 6c31 2c20 2264 6174 6564  str(col1, "dated
+0001d2e0: 6966 6622 290a 2020 2020 6332 203d 205f  iff").    c2 = _
+0001d2f0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+0001d300: 6c32 2c20 2264 6174 6564 6966 6622 290a  l2, "datediff").
+0001d310: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001d320: 696e 2822 6461 7465 6469 6666 2229 2870  in("datediff")(p
+0001d330: 6172 742c 2063 312c 2063 3229 0a0a 0a64  art, c1, c2)...d
+0001d340: 6566 2064 6179 6469 6666 2863 6f6c 313a  ef daydiff(col1:
+0001d350: 2043 6f6c 756d 6e4f 724e 616d 652c 2063   ColumnOrName, c
+0001d360: 6f6c 323a 2043 6f6c 756d 6e4f 724e 616d  ol2: ColumnOrNam
+0001d370: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0001d380: 2020 2222 2243 616c 6375 6c61 7465 7320    """Calculates 
+0001d390: 7468 6520 6469 6666 6572 656e 6365 2062  the difference b
+0001d3a0: 6574 7765 656e 2074 776f 2064 6174 6573  etween two dates
+0001d3b0: 2c20 6f72 2074 696d 6573 7461 6d70 2063  , or timestamp c
+0001d3c0: 6f6c 756d 6e73 2062 6173 6564 2069 6e20  olumns based in 
+0001d3d0: 6461 7973 2e0a 2020 2020 5468 6520 7265  days..    The re
+0001d3e0: 7375 6c74 2077 696c 6c20 7265 666c 6563  sult will reflec
+0001d3f0: 7420 7468 6520 6469 6666 6572 656e 6365  t the difference
+0001d400: 2062 6574 7765 656e 2063 6f6c 3220 2d20   between col2 - 
+0001d410: 636f 6c31 0a0a 2020 2020 4578 616d 706c  col1..    Exampl
+0001d420: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0001d430: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0001d440: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+0001d450: 7320 696d 706f 7274 2064 6179 6469 6666  s import daydiff
+0001d460: 2c20 746f 5f64 6174 650a 2020 2020 2020  , to_date.      
+0001d470: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0001d480: 6f6e 2e63 7265 6174 6544 6174 6146 7261  on.createDataFra
+0001d490: 6d65 285b 2822 3230 3135 2d30 342d 3038  me([("2015-04-08
+0001d4a0: 222c 2022 3230 3135 2d30 352d 3130 2229  ", "2015-05-10")
+0001d4b0: 5d2c 205b 2264 3122 2c20 2264 3222 5d29  ], ["d1", "d2"])
+0001d4c0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+0001d4d0: 203d 2064 662e 7365 6c65 6374 2864 6179   = df.select(day
+0001d4e0: 6469 6666 2874 6f5f 6461 7465 2864 662e  diff(to_date(df.
+0001d4f0: 6432 292c 2074 6f5f 6461 7465 2864 662e  d2), to_date(df.
+0001d500: 6431 2929 2e61 6c69 6173 2822 6469 6666  d1)).alias("diff
+0001d510: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0001d520: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0001d530: 2020 2020 2020 7c22 4449 4646 2220 207c        |"DIFF"  |
+0001d540: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001d550: 2d2d 2d0a 2020 2020 2020 2020 7c33 3220  ---.        |32 
+0001d560: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0001d570: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001d580: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+0001d590: 2020 2222 220a 2020 2020 636f 6c31 203d    """.    col1 =
+0001d5a0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001d5b0: 636f 6c31 2c20 2264 6179 6469 6666 2229  col1, "daydiff")
+0001d5c0: 0a20 2020 2063 6f6c 3220 3d20 5f74 6f5f  .    col2 = _to_
+0001d5d0: 636f 6c5f 6966 5f73 7472 2863 6f6c 322c  col_if_str(col2,
+0001d5e0: 2022 6461 7964 6966 6622 290a 2020 2020   "daydiff").    
+0001d5f0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001d600: 6461 7465 6469 6666 2229 286c 6974 2822  datediff")(lit("
+0001d610: 6461 7922 292c 2063 6f6c 322c 2063 6f6c  day"), col2, col
+0001d620: 3129 0a0a 0a64 6566 2074 7275 6e63 2865  1)...def trunc(e
+0001d630: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+0001d640: 7363 616c 653a 2055 6e69 6f6e 5b43 6f6c  scale: Union[Col
+0001d650: 756d 6e4f 724e 616d 652c 2069 6e74 2c20  umnOrName, int, 
+0001d660: 666c 6f61 745d 203d 2030 2920 2d3e 2043  float] = 0) -> C
+0001d670: 6f6c 756d 6e3a 0a20 2020 2022 2222 526f  olumn:.    """Ro
+0001d680: 756e 6473 2074 6865 2069 6e70 7574 2065  unds the input e
+0001d690: 7870 7265 7373 696f 6e20 646f 776e 2074  xpression down t
+0001d6a0: 6f20 7468 6520 6e65 6172 6573 7420 286f  o the nearest (o
+0001d6b0: 7220 6571 7561 6c29 2069 6e74 6567 6572  r equal) integer
+0001d6c0: 2063 6c6f 7365 7220 746f 207a 6572 6f2c   closer to zero,
+0001d6d0: 0a20 2020 206f 7220 746f 2074 6865 206e  .    or to the n
+0001d6e0: 6561 7265 7374 2065 7175 616c 206f 7220  earest equal or 
+0001d6f0: 736d 616c 6c65 7220 7661 6c75 6520 7769  smaller value wi
+0001d700: 7468 2074 6865 2073 7065 6369 6669 6564  th the specified
+0001d710: 206e 756d 6265 7220 6f66 0a20 2020 2070   number of.    p
+0001d720: 6c61 6365 7320 6166 7465 7220 7468 6520  laces after the 
+0001d730: 6465 6369 6d61 6c20 706f 696e 742e 0a0a  decimal point...
+0001d740: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0001d750: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0001d760: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
+0001d770: 7461 4672 616d 6528 5b2d 312e 302c 202d  taFrame([-1.0, -
+0001d780: 302e 392c 202d 2e35 2c20 2d2e 322c 2030  0.9, -.5, -.2, 0
+0001d790: 2e30 2c20 302e 322c 2030 2e35 2c20 302e  .0, 0.2, 0.5, 0.
+0001d7a0: 392c 2031 2e31 2c20 332e 3134 3135 395d  9, 1.1, 3.14159]
+0001d7b0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0001d7c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0001d7d0: 656c 6563 7428 7472 756e 6328 636f 6c28  elect(trunc(col(
+0001d7e0: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
+0001d7f0: 0a20 2020 2020 2020 205b 526f 7728 5452  .        [Row(TR
+0001d800: 554e 4328 2241 222c 2030 293d 2d31 2e30  UNC("A", 0)=-1.0
+0001d810: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
+0001d820: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
+0001d830: 5255 4e43 2822 4122 2c20 3029 3d30 2e30  RUNC("A", 0)=0.0
+0001d840: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
+0001d850: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
+0001d860: 5255 4e43 2822 4122 2c20 3029 3d30 2e30  RUNC("A", 0)=0.0
+0001d870: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
+0001d880: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
+0001d890: 5255 4e43 2822 4122 2c20 3029 3d30 2e30  RUNC("A", 0)=0.0
+0001d8a0: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
+0001d8b0: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
+0001d8c0: 5255 4e43 2822 4122 2c20 3029 3d31 2e30  RUNC("A", 0)=1.0
+0001d8d0: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
+0001d8e0: 2c20 3029 3d33 2e30 295d 0a0a 2020 2020  , 0)=3.0)]..    
+0001d8f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001d900: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+0001d910: 7261 6d65 285b 2d31 2e33 3233 2c20 342e  rame([-1.323, 4.
+0001d920: 3536 372c 2030 2e30 3132 335d 2c20 7363  567, 0.0123], sc
+0001d930: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0001d940: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0001d950: 7428 7472 756e 6328 636f 6c28 2261 2229  t(trunc(col("a")
+0001d960: 2c20 6c69 7428 3029 2929 2e63 6f6c 6c65  , lit(0))).colle
+0001d970: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0001d980: 7728 5452 554e 4328 2241 222c 2030 293d  w(TRUNC("A", 0)=
+0001d990: 2d31 2e30 292c 2052 6f77 2854 5255 4e43  -1.0), Row(TRUNC
+0001d9a0: 2822 4122 2c20 3029 3d34 2e30 292c 2052  ("A", 0)=4.0), R
+0001d9b0: 6f77 2854 5255 4e43 2822 4122 2c20 3029  ow(TRUNC("A", 0)
+0001d9c0: 3d30 2e30 295d 0a20 2020 2020 2020 203e  =0.0)].        >
+0001d9d0: 3e3e 2064 662e 7365 6c65 6374 2874 7275  >> df.select(tru
+0001d9e0: 6e63 2863 6f6c 2822 6122 292c 206c 6974  nc(col("a"), lit
+0001d9f0: 2831 2929 292e 636f 6c6c 6563 7428 290a  (1))).collect().
+0001da00: 2020 2020 2020 2020 5b52 6f77 2854 5255          [Row(TRU
+0001da10: 4e43 2822 4122 2c20 3129 3d2d 312e 3329  NC("A", 1)=-1.3)
+0001da20: 2c20 526f 7728 5452 554e 4328 2241 222c  , Row(TRUNC("A",
+0001da30: 2031 293d 342e 3529 2c20 526f 7728 5452   1)=4.5), Row(TR
+0001da40: 554e 4328 2241 222c 2031 293d 302e 3029  UNC("A", 1)=0.0)
+0001da50: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+0001da60: 2e73 656c 6563 7428 7472 756e 6328 636f  .select(trunc(co
+0001da70: 6c28 2261 2229 2c20 6c69 7428 3229 2929  l("a"), lit(2)))
+0001da80: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001da90: 2020 205b 526f 7728 5452 554e 4328 2241     [Row(TRUNC("A
+0001daa0: 222c 2032 293d 2d31 2e33 3229 2c20 526f  ", 2)=-1.32), Ro
+0001dab0: 7728 5452 554e 4328 2241 222c 2032 293d  w(TRUNC("A", 2)=
+0001dac0: 342e 3536 292c 2052 6f77 2854 5255 4e43  4.56), Row(TRUNC
+0001dad0: 2822 4122 2c20 3229 3d30 2e30 3129 5d0a  ("A", 2)=0.01)].
+0001dae0: 0a20 2020 204e 6f74 6520 7468 6174 2074  .    Note that t
+0001daf0: 6865 2066 756e 6374 696f 6e20 6060 7472  he function ``tr
+0001db00: 756e 6360 6020 6973 206f 7665 726c 6f61  unc`` is overloa
+0001db10: 6465 6420 7769 7468 2060 6064 6174 655f  ded with ``date_
+0001db20: 7472 756e 6360 6020 666f 7220 6461 7465  trunc`` for date
+0001db30: 7469 6d65 2074 7970 6573 2e20 4974 2061  time types. It a
+0001db40: 6c6c 6f77 7320 746f 2072 6f75 6e64 2064  llows to round d
+0001db50: 6174 6574 696d 650a 2020 2020 6f62 6a65  atetime.    obje
+0001db60: 6374 732e 0a0a 2020 2020 4578 616d 706c  cts...    Exampl
+0001db70: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+0001db80: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
+0001db90: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0001dba0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0001dbb0: 4461 7461 4672 616d 6528 5b64 6174 6574  DataFrame([datet
+0001dbc0: 696d 652e 6461 7465 2832 3032 322c 2031  ime.date(2022, 1
+0001dbd0: 322c 2032 3529 2c20 6461 7465 7469 6d65  2, 25), datetime
+0001dbe0: 2e64 6174 6528 3230 3232 2c20 312c 2031  .date(2022, 1, 1
+0001dbf0: 3029 2c20 6461 7465 7469 6d65 2e64 6174  0), datetime.dat
+0001dc00: 6528 3230 3232 2c20 372c 2037 295d 2c20  e(2022, 7, 7)], 
+0001dc10: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+0001dc20: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0001dc30: 6563 7428 7472 756e 6328 636f 6c28 2261  ect(trunc(col("a
+0001dc40: 2229 2c20 6c69 7428 2251 5541 5254 4552  "), lit("QUARTER
+0001dc50: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+0001dc60: 2020 2020 2020 205b 526f 7728 5452 554e         [Row(TRUN
+0001dc70: 4328 2241 222c 2027 5155 4152 5445 5227  C("A", 'QUARTER'
+0001dc80: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
+0001dc90: 3230 3232 2c20 3130 2c20 3129 292c 2052  2022, 10, 1)), R
+0001dca0: 6f77 2854 5255 4e43 2822 4122 2c20 2751  ow(TRUNC("A", 'Q
+0001dcb0: 5541 5254 4552 2729 3d64 6174 6574 696d  UARTER')=datetim
+0001dcc0: 652e 6461 7465 2832 3032 322c 2031 2c20  e.date(2022, 1, 
+0001dcd0: 3129 292c 2052 6f77 2854 5255 4e43 2822  1)), Row(TRUNC("
+0001dce0: 4122 2c20 2751 5541 5254 4552 2729 3d64  A", 'QUARTER')=d
+0001dcf0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+0001dd00: 322c 2037 2c20 3129 295d 0a0a 2020 2020  2, 7, 1))]..    
+0001dd10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001dd20: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+0001dd30: 7261 6d65 285b 6461 7465 7469 6d65 2e64  rame([datetime.d
+0001dd40: 6174 6574 696d 6528 3230 3232 2c20 3132  atetime(2022, 12
+0001dd50: 2c20 3235 2c20 3133 2c20 3539 2c20 3338  , 25, 13, 59, 38
+0001dd60: 2c20 3436 3729 5d2c 2073 6368 656d 613d  , 467)], schema=
+0001dd70: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+0001dd80: 3e3e 2064 662e 636f 6c6c 6563 7428 290a  >> df.collect().
+0001dd90: 2020 2020 2020 2020 5b52 6f77 2841 3d64          [Row(A=d
+0001dda0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001ddb0: 2832 3032 322c 2031 322c 2032 352c 2031  (2022, 12, 25, 1
+0001ddc0: 332c 2035 392c 2033 382c 2034 3637 2929  3, 59, 38, 467))
+0001ddd0: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+0001dde0: 2e73 656c 6563 7428 7472 756e 6328 636f  .select(trunc(co
+0001ddf0: 6c28 2261 2229 2c20 6c69 7428 224d 494e  l("a"), lit("MIN
+0001de00: 5554 4522 2929 292e 636f 6c6c 6563 7428  UTE"))).collect(
+0001de10: 290a 2020 2020 2020 2020 5b52 6f77 2854  ).        [Row(T
+0001de20: 5255 4e43 2822 4122 2c20 274d 494e 5554  RUNC("A", 'MINUT
+0001de30: 4527 293d 6461 7465 7469 6d65 2e64 6174  E')=datetime.dat
+0001de40: 6574 696d 6528 3230 3232 2c20 3132 2c20  etime(2022, 12, 
+0001de50: 3235 2c20 3133 2c20 3539 2929 5d0a 0a20  25, 13, 59))].. 
+0001de60: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0001de70: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+0001de80: 2022 7472 756e 6322 290a 2020 2020 7363   "trunc").    sc
+0001de90: 616c 655f 636f 6c20 3d20 280a 2020 2020  ale_col = (.    
+0001dea0: 2020 2020 6c69 7428 7363 616c 6529 0a20      lit(scale). 
+0001deb0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001dec0: 616e 6365 2873 6361 6c65 2c20 2869 6e74  ance(scale, (int
+0001ded0: 2c20 666c 6f61 7429 290a 2020 2020 2020  , float)).      
+0001dee0: 2020 656c 7365 205f 746f 5f63 6f6c 5f69    else _to_col_i
+0001def0: 665f 7374 7228 7363 616c 652c 2022 7472  f_str(scale, "tr
+0001df00: 756e 6322 290a 2020 2020 290a 2020 2020  unc").    ).    
+0001df10: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001df20: 7472 756e 6322 2928 632c 2073 6361 6c65  trunc")(c, scale
+0001df30: 5f63 6f6c 290a 0a0a 6465 6620 6461 7465  _col)...def date
+0001df40: 6164 6428 7061 7274 3a20 7374 722c 2063  add(part: str, c
+0001df50: 6f6c 313a 2043 6f6c 756d 6e4f 724e 616d  ol1: ColumnOrNam
+0001df60: 652c 2063 6f6c 323a 2043 6f6c 756d 6e4f  e, col2: ColumnO
+0001df70: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0001df80: 3a0a 2020 2020 2222 2241 6464 7320 7468  :.    """Adds th
+0001df90: 6520 7370 6563 6966 6965 6420 7661 6c75  e specified valu
+0001dfa0: 6520 666f 7220 7468 6520 7370 6563 6966  e for the specif
+0001dfb0: 6965 6420 6461 7465 206f 7220 7469 6d65  ied date or time
+0001dfc0: 2070 6172 7420 746f 2064 6174 6520 6f72   part to date or
+0001dfd0: 2074 696d 6520 6578 7072 2e0a 0a20 2020   time expr...   
+0001dfe0: 2060 5375 7070 6f72 7465 6420 6461 7465   `Supported date
+0001dff0: 2061 6e64 2074 696d 6520 7061 7274 7320   and time parts 
+0001e000: 3c68 7474 7073 3a2f 2f64 6f63 732e 736e  <https://docs.sn
+0001e010: 6f77 666c 616b 652e 636f 6d2f 656e 2f73  owflake.com/en/s
+0001e020: 716c 2d72 6566 6572 656e 6365 2f66 756e  ql-reference/fun
+0001e030: 6374 696f 6e73 2d64 6174 652d 7469 6d65  ctions-date-time
+0001e040: 2e68 746d 6c23 6c61 6265 6c2d 7375 7070  .html#label-supp
+0001e050: 6f72 7465 642d 6461 7465 2d74 696d 652d  orted-date-time-
+0001e060: 7061 7274 733e 605f 0a0a 2020 2020 4578  parts>`_..    Ex
+0001e070: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0001e080: 203e 3e3e 2023 2061 6464 206f 6e65 2079   >>> # add one y
+0001e090: 6561 7220 6f6e 2064 6174 6573 0a20 2020  ear on dates.   
+0001e0a0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+0001e0b0: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
+0001e0c0: 203e 3e3e 2064 6174 655f 6466 203d 2073   >>> date_df = s
+0001e0d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0001e0e0: 7461 6672 616d 6528 5b5b 6461 7465 7469  taframe([[dateti
+0001e0f0: 6d65 2e64 6174 6528 3230 3230 2c20 312c  me.date(2020, 1,
+0001e100: 2031 295d 5d2c 2073 6368 656d 613d 5b22   1)]], schema=["
+0001e110: 6461 7465 5f63 6f6c 225d 290a 2020 2020  date_col"]).    
+0001e120: 2020 2020 3e3e 3e20 6461 7465 5f64 662e      >>> date_df.
+0001e130: 7365 6c65 6374 2864 6174 6561 6464 2822  select(dateadd("
+0001e140: 7965 6172 222c 206c 6974 2831 292c 2063  year", lit(1), c
+0001e150: 6f6c 2822 6461 7465 5f63 6f6c 2229 292e  ol("date_col")).
+0001e160: 616c 6961 7328 2279 6561 725f 6164 6465  alias("year_adde
+0001e170: 6422 2929 2e73 686f 7728 290a 2020 2020  d")).show().    
+0001e180: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0001e190: 2d2d 2d2d 0a20 2020 2020 2020 207c 2259  ----.        |"Y
+0001e1a0: 4541 525f 4144 4445 4422 2020 7c0a 2020  EAR_ADDED"  |.  
+0001e1b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001e1c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0001e1d0: 3230 3231 2d30 312d 3031 2020 2020 7c0a  2021-01-01    |.
+0001e1e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001e1f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001e200: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0001e210: 2020 2020 203e 3e3e 2064 6174 655f 6466       >>> date_df
+0001e220: 2e73 656c 6563 7428 6461 7465 6164 6428  .select(dateadd(
+0001e230: 226d 6f6e 7468 222c 206c 6974 2831 292c  "month", lit(1),
+0001e240: 2063 6f6c 2822 6461 7465 5f63 6f6c 2229   col("date_col")
+0001e250: 292e 616c 6961 7328 226d 6f6e 7468 5f61  ).alias("month_a
+0001e260: 6464 6564 2229 292e 7368 6f77 2829 0a20  dded")).show(). 
+0001e270: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001e280: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001e290: 207c 224d 4f4e 5448 5f41 4444 4544 2220   |"MONTH_ADDED" 
+0001e2a0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001e2b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001e2c0: 2020 2020 207c 3230 3230 2d30 322d 3031       |2020-02-01
+0001e2d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0001e2e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001e2f0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0001e300: 494e 453e 0a20 2020 2020 2020 203e 3e3e  INE>.        >>>
+0001e310: 2064 6174 655f 6466 2e73 656c 6563 7428   date_df.select(
+0001e320: 6461 7465 6164 6428 2264 6179 222c 206c  dateadd("day", l
+0001e330: 6974 2831 292c 2063 6f6c 2822 6461 7465  it(1), col("date
+0001e340: 5f63 6f6c 2229 292e 616c 6961 7328 2264  _col")).alias("d
+0001e350: 6179 5f61 6464 6564 2229 292e 7368 6f77  ay_added")).show
+0001e360: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0001e370: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001e380: 2020 207c 2244 4159 5f41 4444 4544 2220     |"DAY_ADDED" 
+0001e390: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001e3a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001e3b0: 2020 207c 3230 3230 2d30 312d 3032 2020     |2020-01-02  
+0001e3c0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001e3d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001e3e0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
+0001e3f0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0001e400: 2020 7061 7274 3a20 5468 6520 7469 6d65    part: The time
+0001e410: 2070 6172 7420 746f 2075 7365 2066 6f72   part to use for
+0001e420: 2074 6865 2061 6464 6974 696f 6e0a 2020   the addition.  
+0001e430: 2020 2020 2020 636f 6c31 3a20 5468 6520        col1: The 
+0001e440: 6669 7273 7420 7469 6d65 7374 616d 7020  first timestamp 
+0001e450: 636f 6c75 6d6e 206f 7220 6164 6465 6e64  column or addend
+0001e460: 2069 6e20 7468 6520 6461 7465 6164 640a   in the dateadd.
+0001e470: 2020 2020 2020 2020 636f 6c32 3a20 5468          col2: Th
+0001e480: 6520 7365 636f 6e64 2074 696d 6573 7461  e second timesta
+0001e490: 6d70 2063 6f6c 756d 6e20 6f72 2074 6865  mp column or the
+0001e4a0: 2061 6464 656e 6420 696e 2074 6865 2064   addend in the d
+0001e4b0: 6174 6561 6464 0a20 2020 2022 2222 0a20  ateadd.    """. 
+0001e4c0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+0001e4d0: 616e 6365 2870 6172 742c 2073 7472 293a  ance(part, str):
+0001e4e0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+0001e4f0: 616c 7565 4572 726f 7228 2270 6172 7420  alueError("part 
+0001e500: 6d75 7374 2062 6520 6120 7374 7269 6e67  must be a string
+0001e510: 2229 0a20 2020 2063 3120 3d20 5f74 6f5f  ").    c1 = _to_
+0001e520: 636f 6c5f 6966 5f73 7472 2863 6f6c 312c  col_if_str(col1,
+0001e530: 2022 6461 7465 6164 6422 290a 2020 2020   "dateadd").    
+0001e540: 6332 203d 205f 746f 5f63 6f6c 5f69 665f  c2 = _to_col_if_
+0001e550: 7374 7228 636f 6c32 2c20 2264 6174 6561  str(col2, "datea
+0001e560: 6464 2229 0a20 2020 2072 6574 7572 6e20  dd").    return 
+0001e570: 6275 696c 7469 6e28 2264 6174 6561 6464  builtin("dateadd
+0001e580: 2229 2870 6172 742c 2063 312c 2063 3229  ")(part, c1, c2)
+0001e590: 0a0a 0a64 6566 2064 6174 655f 7061 7274  ...def date_part
+0001e5a0: 2870 6172 743a 2073 7472 2c20 653a 2043  (part: str, e: C
+0001e5b0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0001e5c0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+0001e5d0: 2020 2020 4578 7472 6163 7473 2074 6865      Extracts the
+0001e5e0: 2073 7065 6369 6669 6564 2064 6174 6520   specified date 
+0001e5f0: 6f72 2074 696d 6520 7061 7274 2066 726f  or time part fro
+0001e600: 6d20 6120 6461 7465 2c20 7469 6d65 2c20  m a date, time, 
+0001e610: 6f72 2074 696d 6573 7461 6d70 2e20 5365  or timestamp. Se
+0001e620: 650a 2020 2020 6044 4154 455f 5041 5254  e.    `DATE_PART
+0001e630: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+0001e640: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+0001e650: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
+0001e660: 6e63 7469 6f6e 732f 6461 7465 5f70 6172  nctions/date_par
+0001e670: 742e 6874 6d6c 3e60 5f20 666f 7220 6465  t.html>`_ for de
+0001e680: 7461 696c 732e 0a0a 2020 2020 4172 6773  tails...    Args
+0001e690: 3a0a 2020 2020 2020 2020 7061 7274 3a20  :.        part: 
+0001e6a0: 5468 6520 7469 6d65 2070 6172 7420 746f  The time part to
+0001e6b0: 2075 7365 2066 6f72 2074 6865 2061 6464   use for the add
+0001e6c0: 6974 696f 6e2e 0a20 2020 2020 2020 2065  ition..        e
+0001e6d0: 3a20 5468 6520 636f 6c75 6d6e 2065 7870  : The column exp
+0001e6e0: 7265 7373 696f 6e20 6f66 2061 2064 6174  ression of a dat
+0001e6f0: 652c 2074 696d 652c 206f 7220 7469 6d65  e, time, or time
+0001e700: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
+0001e710: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+0001e720: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+0001e730: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+0001e740: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0001e750: 7465 5f64 6174 6166 7261 6d65 285b 5b64  te_dataframe([[d
+0001e760: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001e770: 2832 3032 332c 2031 2c20 312c 2031 2c20  (2023, 1, 1, 1, 
+0001e780: 312c 2031 295d 5d2c 2073 6368 656d 613d  1, 1)]], schema=
+0001e790: 5b22 7473 5f63 6f6c 225d 290a 2020 2020  ["ts_col"]).    
+0001e7a0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0001e7b0: 7428 6461 7465 5f70 6172 7428 2279 6561  t(date_part("yea
+0001e7c0: 7222 2c20 636f 6c28 2274 735f 636f 6c22  r", col("ts_col"
+0001e7d0: 2929 2e61 6c69 6173 2822 7965 6172 2229  )).alias("year")
+0001e7e0: 2c20 6461 7465 5f70 6172 7428 2265 706f  , date_part("epo
+0001e7f0: 6368 5f73 6563 6f6e 6422 2c20 636f 6c28  ch_second", col(
+0001e800: 2274 735f 636f 6c22 2929 2e61 6c69 6173  "ts_col")).alias
+0001e810: 2822 6570 6f63 685f 7365 636f 6e64 2229  ("epoch_second")
+0001e820: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0001e830: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0001e840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001e850: 2020 2020 207c 2259 4541 5222 2020 7c22       |"YEAR"  |"
+0001e860: 4550 4f43 485f 5345 434f 4e44 2220 207c  EPOCH_SECOND"  |
+0001e870: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001e880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001e890: 2d2d 2d2d 0a20 2020 2020 2020 207c 3230  ----.        |20
+0001e8a0: 3233 2020 2020 7c31 3637 3235 3334 3836  23    |167253486
+0001e8b0: 3120 2020 2020 207c 0a20 2020 2020 2020  1      |.       
+0001e8c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0001e8d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001e8e0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0001e8f0: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+0001e900: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
+0001e910: 6172 742c 2073 7472 293a 0a20 2020 2020  art, str):.     
+0001e920: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001e930: 726f 7228 2270 6172 7420 6d75 7374 2062  ror("part must b
+0001e940: 6520 6120 7374 7269 6e67 2229 0a20 2020  e a string").   
+0001e950: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+0001e960: 7374 7228 652c 2022 6461 7465 5f70 6172  str(e, "date_par
+0001e970: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
+0001e980: 7569 6c74 696e 2822 6461 7465 5f70 6172  uiltin("date_par
+0001e990: 7422 2928 7061 7274 2c20 6329 0a0a 0a64  t")(part, c)...d
+0001e9a0: 6566 2064 6174 655f 6672 6f6d 5f70 6172  ef date_from_par
+0001e9b0: 7473 280a 2020 2020 793a 2055 6e69 6f6e  ts(.    y: Union
+0001e9c0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+0001e9d0: 6e74 5d2c 0a20 2020 206d 3a20 556e 696f  nt],.    m: Unio
+0001e9e0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+0001e9f0: 696e 745d 2c0a 2020 2020 643a 2055 6e69  int],.    d: Uni
+0001ea00: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+0001ea10: 2069 6e74 5d2c 0a29 202d 3e20 436f 6c75   int],.) -> Colu
+0001ea20: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+0001ea30: 4372 6561 7465 7320 6120 6461 7465 2066  Creates a date f
+0001ea40: 726f 6d20 696e 6469 7669 6475 616c 206e  rom individual n
+0001ea50: 756d 6572 6963 2063 6f6d 706f 6e65 6e74  umeric component
+0001ea60: 7320 7468 6174 2072 6570 7265 7365 6e74  s that represent
+0001ea70: 2074 6865 2079 6561 722c 206d 6f6e 7468   the year, month
+0001ea80: 2c20 616e 6420 6461 7920 6f66 2074 6865  , and day of the
+0001ea90: 206d 6f6e 7468 2e0a 0a20 2020 2045 7861   month...    Exa
+0001eaa0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+0001eab0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0001eac0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0001ead0: 285b 5b32 3032 322c 2034 2c20 315d 5d2c  ([[2022, 4, 1]],
+0001eae0: 2073 6368 656d 613d 5b22 7965 6172 222c   schema=["year",
+0001eaf0: 2022 6d6f 6e74 6822 2c20 2264 6179 225d   "month", "day"]
+0001eb00: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0001eb10: 2e73 656c 6563 7428 6461 7465 5f66 726f  .select(date_fro
+0001eb20: 6d5f 7061 7274 7328 2279 6561 7222 2c20  m_parts("year", 
+0001eb30: 226d 6f6e 7468 222c 2022 6461 7922 2929  "month", "day"))
+0001eb40: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001eb50: 2020 205b 526f 7728 4441 5445 5f46 524f     [Row(DATE_FRO
+0001eb60: 4d5f 5041 5254 5328 2259 4541 5222 2c20  M_PARTS("YEAR", 
+0001eb70: 224d 4f4e 5448 222c 2022 4441 5922 293d  "MONTH", "DAY")=
+0001eb80: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
+0001eb90: 3232 2c20 342c 2031 2929 5d0a 2020 2020  22, 4, 1))].    
+0001eba0: 2020 2020 3e3e 3e20 7365 7373 696f 6e2e      >>> session.
+0001ebb0: 7461 626c 6528 2264 7561 6c22 292e 7365  table("dual").se
+0001ebc0: 6c65 6374 2864 6174 655f 6672 6f6d 5f70  lect(date_from_p
+0001ebd0: 6172 7473 2832 3032 322c 2034 2c20 3129  arts(2022, 4, 1)
+0001ebe0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0001ebf0: 2020 2020 5b52 6f77 2844 4154 455f 4652      [Row(DATE_FR
+0001ec00: 4f4d 5f50 4152 5453 2832 3032 322c 2034  OM_PARTS(2022, 4
+0001ec10: 2c20 3129 3d64 6174 6574 696d 652e 6461  , 1)=datetime.da
+0001ec20: 7465 2832 3032 322c 2034 2c20 3129 295d  te(2022, 4, 1))]
+0001ec30: 0a20 2020 2022 2222 0a20 2020 2079 5f63  .    """.    y_c
+0001ec40: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
+0001ec50: 7374 725f 6f72 5f69 6e74 2879 2c20 2264  str_or_int(y, "d
+0001ec60: 6174 655f 6672 6f6d 5f70 6172 7473 2229  ate_from_parts")
+0001ec70: 0a20 2020 206d 5f63 6f6c 203d 205f 746f  .    m_col = _to
+0001ec80: 5f63 6f6c 5f69 665f 7374 725f 6f72 5f69  _col_if_str_or_i
+0001ec90: 6e74 286d 2c20 2264 6174 655f 6672 6f6d  nt(m, "date_from
+0001eca0: 5f70 6172 7473 2229 0a20 2020 2064 5f63  _parts").    d_c
+0001ecb0: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
+0001ecc0: 7374 725f 6f72 5f69 6e74 2864 2c20 2264  str_or_int(d, "d
+0001ecd0: 6174 655f 6672 6f6d 5f70 6172 7473 2229  ate_from_parts")
+0001ece0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0001ecf0: 7469 6e28 2264 6174 655f 6672 6f6d 5f70  tin("date_from_p
+0001ed00: 6172 7473 2229 2879 5f63 6f6c 2c20 6d5f  arts")(y_col, m_
+0001ed10: 636f 6c2c 2064 5f63 6f6c 290a 0a0a 6465  col, d_col)...de
+0001ed20: 6620 6461 7465 5f74 7275 6e63 2870 6172  f date_trunc(par
+0001ed30: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
+0001ed40: 2065 7870 723a 2043 6f6c 756d 6e4f 724e   expr: ColumnOrN
+0001ed50: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0001ed60: 2020 2020 2222 220a 2020 2020 5472 756e      """.    Trun
+0001ed70: 6361 7465 7320 6120 4441 5445 2c20 5449  cates a DATE, TI
+0001ed80: 4d45 2c20 6f72 2054 494d 4553 5441 4d50  ME, or TIMESTAMP
+0001ed90: 2074 6f20 7468 6520 7370 6563 6966 6965   to the specifie
+0001eda0: 6420 7072 6563 6973 696f 6e2e 0a0a 2020  d precision...  
+0001edb0: 2020 4e6f 7465 2074 6861 7420 7472 756e    Note that trun
+0001edc0: 6361 7469 6f6e 2069 7320 6e6f 7420 7468  cation is not th
+0001edd0: 6520 7361 6d65 2061 7320 6578 7472 6163  e same as extrac
+0001ede0: 7469 6f6e 2e20 466f 7220 6578 616d 706c  tion. For exampl
+0001edf0: 653a 0a20 2020 202d 2054 7275 6e63 6174  e:.    - Truncat
+0001ee00: 696e 6720 6120 7469 6d65 7374 616d 7020  ing a timestamp 
+0001ee10: 646f 776e 2074 6f20 7468 6520 7175 6172  down to the quar
+0001ee20: 7465 7220 7265 7475 726e 7320 7468 6520  ter returns the 
+0001ee30: 7469 6d65 7374 616d 7020 636f 7272 6573  timestamp corres
+0001ee40: 706f 6e64 696e 6720 746f 206d 6964 6e69  ponding to midni
+0001ee50: 6768 7420 6f66 2074 6865 2066 6972 7374  ght of the first
+0001ee60: 2064 6179 206f 6620 7468 650a 2020 2020   day of the.    
+0001ee70: 7175 6172 7465 7220 666f 7220 7468 6520  quarter for the 
+0001ee80: 696e 7075 7420 7469 6d65 7374 616d 702e  input timestamp.
+0001ee90: 0a20 2020 202d 2045 7874 7261 6374 696e  .    - Extractin
+0001eea0: 6720 7468 6520 7175 6172 7465 7220 6461  g the quarter da
+0001eeb0: 7465 2070 6172 7420 6672 6f6d 2061 2074  te part from a t
+0001eec0: 696d 6573 7461 6d70 2072 6574 7572 6e73  imestamp returns
+0001eed0: 2074 6865 2071 7561 7274 6572 206e 756d   the quarter num
+0001eee0: 6265 7220 6f66 2074 6865 2079 6561 7220  ber of the year 
+0001eef0: 696e 2074 6865 2074 696d 6573 7461 6d70  in the timestamp
+0001ef00: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0001ef10: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001ef20: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+0001ef30: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0001ef40: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0001ef50: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+0001ef60: 2e2e 2e20 2020 2020 5b5b 6461 7465 7469  ...     [[dateti
+0001ef70: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
+0001ef80: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
+0001ef90: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
+0001efa0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
+0001efb0: 2553 2e25 6622 295d 5d2c 0a20 2020 2020  %S.%f")]],.     
+0001efc0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
+0001efd0: 613d 5b22 6122 5d2c 0a20 2020 2020 2020  a=["a"],.       
+0001efe0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
+0001eff0: 3e3e 2064 662e 7365 6c65 6374 2864 6174  >> df.select(dat
+0001f000: 655f 7472 756e 6328 2259 4541 5222 2c20  e_trunc("YEAR", 
+0001f010: 2261 2229 2c20 6461 7465 5f74 7275 6e63  "a"), date_trunc
+0001f020: 2822 4d4f 4e54 4822 2c20 2261 2229 2c20  ("MONTH", "a"), 
+0001f030: 6461 7465 5f74 7275 6e63 2822 4441 5922  date_trunc("DAY"
+0001f040: 2c20 2261 2229 292e 636f 6c6c 6563 7428  , "a")).collect(
+0001f050: 290a 2020 2020 2020 2020 5b52 6f77 2844  ).        [Row(D
+0001f060: 4154 455f 5452 554e 4328 2259 4541 5222  ATE_TRUNC("YEAR"
+0001f070: 2c20 2241 2229 3d64 6174 6574 696d 652e  , "A")=datetime.
+0001f080: 6461 7465 7469 6d65 2832 3032 302c 2031  datetime(2020, 1
+0001f090: 2c20 312c 2030 2c20 3029 2c20 4441 5445  , 1, 0, 0), DATE
+0001f0a0: 5f54 5255 4e43 2822 4d4f 4e54 4822 2c20  _TRUNC("MONTH", 
+0001f0b0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+0001f0c0: 7465 7469 6d65 2832 3032 302c 2035 2c20  tetime(2020, 5, 
+0001f0d0: 312c 2030 2c20 3029 2c20 4441 5445 5f54  1, 0, 0), DATE_T
+0001f0e0: 5255 4e43 2822 4441 5922 2c20 2241 2229  RUNC("DAY", "A")
+0001f0f0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
+0001f100: 6d65 2832 3032 302c 2035 2c20 312c 2030  me(2020, 5, 1, 0
+0001f110: 2c20 3029 295d 0a20 2020 2020 2020 203e  , 0))].        >
+0001f120: 3e3e 2064 662e 7365 6c65 6374 2864 6174  >> df.select(dat
+0001f130: 655f 7472 756e 6328 2248 4f55 5222 2c20  e_trunc("HOUR", 
+0001f140: 2261 2229 2c20 6461 7465 5f74 7275 6e63  "a"), date_trunc
+0001f150: 2822 4d49 4e55 5445 222c 2022 6122 292c  ("MINUTE", "a"),
+0001f160: 2064 6174 655f 7472 756e 6328 2253 4543   date_trunc("SEC
+0001f170: 4f4e 4422 2c20 2261 2229 292e 636f 6c6c  OND", "a")).coll
+0001f180: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0001f190: 6f77 2844 4154 455f 5452 554e 4328 2248  ow(DATE_TRUNC("H
+0001f1a0: 4f55 5222 2c20 2241 2229 3d64 6174 6574  OUR", "A")=datet
+0001f1b0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+0001f1c0: 302c 2035 2c20 312c 2031 332c 2030 292c  0, 5, 1, 13, 0),
+0001f1d0: 2044 4154 455f 5452 554e 4328 224d 494e   DATE_TRUNC("MIN
+0001f1e0: 5554 4522 2c20 2241 2229 3d64 6174 6574  UTE", "A")=datet
+0001f1f0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+0001f200: 302c 2035 2c20 312c 2031 332c 2031 3129  0, 5, 1, 13, 11)
+0001f210: 2c20 4441 5445 5f54 5255 4e43 2822 5345  , DATE_TRUNC("SE
+0001f220: 434f 4e44 222c 2022 4122 293d 6461 7465  COND", "A")=date
+0001f230: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+0001f240: 3230 2c20 352c 2031 2c20 3133 2c20 3131  20, 5, 1, 13, 11
+0001f250: 2c20 3230 2929 5d0a 2020 2020 2020 2020  , 20))].        
+0001f260: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
+0001f270: 7465 5f74 7275 6e63 2822 5155 4152 5445  te_trunc("QUARTE
+0001f280: 5222 2c20 2261 2229 292e 636f 6c6c 6563  R", "a")).collec
+0001f290: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001f2a0: 2844 4154 455f 5452 554e 4328 2251 5541  (DATE_TRUNC("QUA
+0001f2b0: 5254 4552 222c 2022 4122 293d 6461 7465  RTER", "A")=date
+0001f2c0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+0001f2d0: 3230 2c20 342c 2031 2c20 302c 2030 2929  20, 4, 1, 0, 0))
+0001f2e0: 5d0a 2020 2020 2222 220a 2020 2020 7061  ].    """.    pa
+0001f2f0: 7274 5f63 6f6c 203d 205f 746f 5f63 6f6c  rt_col = _to_col
+0001f300: 5f69 665f 7374 7228 7061 7274 2c20 2264  _if_str(part, "d
+0001f310: 6174 655f 7472 756e 6322 290a 2020 2020  ate_trunc").    
+0001f320: 6578 7072 5f63 6f6c 203d 205f 746f 5f63  expr_col = _to_c
+0001f330: 6f6c 5f69 665f 7374 7228 6578 7072 2c20  ol_if_str(expr, 
+0001f340: 2264 6174 655f 7472 756e 6322 290a 2020  "date_trunc").  
+0001f350: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001f360: 2822 6461 7465 5f74 7275 6e63 2229 2870  ("date_trunc")(p
+0001f370: 6172 745f 636f 6c2c 2065 7870 725f 636f  art_col, expr_co
+0001f380: 6c29 0a0a 0a64 6566 2064 6179 6e61 6d65  l)...def dayname
+0001f390: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0001f3a0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001f3b0: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
+0001f3c0: 7320 7468 6520 7468 7265 652d 6c65 7474  s the three-lett
+0001f3d0: 6572 2064 6179 2d6f 662d 7765 656b 206e  er day-of-week n
+0001f3e0: 616d 6520 6672 6f6d 2074 6865 2073 7065  ame from the spe
+0001f3f0: 6369 6669 6564 2064 6174 6520 6f72 2074  cified date or t
+0001f400: 696d 6573 7461 6d70 2e0a 0a20 2020 2045  imestamp...    E
+0001f410: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0001f420: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
+0001f430: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
+0001f440: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0001f450: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+0001f460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001f470: 5b5b 6461 7465 7469 6d65 2e64 6174 6574  [[datetime.datet
+0001f480: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
+0001f490: 3230 2d30 352d 3031 2031 333a 3131 3a32  20-05-01 13:11:2
+0001f4a0: 302e 3030 3022 2c20 2225 592d 256d 2d25  0.000", "%Y-%m-%
+0001f4b0: 6420 2548 3a25 4d3a 2553 2e25 6622 295d  d %H:%M:%S.%f")]
+0001f4c0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+0001f4d0: 2020 2073 6368 656d 613d 5b22 6122 5d2c     schema=["a"],
+0001f4e0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+0001f4f0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001f500: 6c65 6374 2864 6179 6e61 6d65 2822 6122  lect(dayname("a"
+0001f510: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0001f520: 2020 2020 205b 526f 7728 4441 594e 414d       [Row(DAYNAM
+0001f530: 4528 2241 2229 3d27 4672 6927 295d 0a20  E("A")='Fri')]. 
+0001f540: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0001f550: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+0001f560: 2022 6461 796e 616d 6522 290a 2020 2020   "dayname").    
+0001f570: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001f580: 6461 796e 616d 6522 2928 6329 0a0a 0a64  dayname")(c)...d
+0001f590: 6566 2064 6179 6f66 6d6f 6e74 6828 653a  ef dayofmonth(e:
+0001f5a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0001f5b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0001f5c0: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
+0001f5d0: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+0001f5e0: 2064 6179 2028 6e75 6d62 6572 2920 6f66   day (number) of
+0001f5f0: 2074 6865 206d 6f6e 7468 2066 726f 6d20   the month from 
+0001f600: 6120 6461 7465 206f 7220 7469 6d65 7374  a date or timest
+0001f610: 616d 702e 0a0a 2020 2020 4578 616d 706c  amp...    Exampl
+0001f620: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0001f630: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+0001f640: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001f650: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0001f660: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+0001f670: 2020 202e 2e2e 2020 2020 205b 5b64 6174     ...     [[dat
+0001f680: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
+0001f690: 7472 7074 696d 6528 2232 3032 302d 3035  trptime("2020-05
+0001f6a0: 2d30 3120 3133 3a31 313a 3230 2e30 3030  -01 13:11:20.000
+0001f6b0: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
+0001f6c0: 254d 3a25 532e 2566 2229 5d5d 2c0a 2020  %M:%S.%f")]],.  
+0001f6d0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+0001f6e0: 6865 6d61 3d5b 2261 225d 2c0a 2020 2020  hema=["a"],.    
+0001f6f0: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
+0001f700: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001f710: 6461 796f 666d 6f6e 7468 2822 6122 2929  dayofmonth("a"))
+0001f720: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001f730: 2020 205b 526f 7728 4441 594f 464d 4f4e     [Row(DAYOFMON
+0001f740: 5448 2822 4122 293d 3129 5d0a 2020 2020  TH("A")=1)].    
+0001f750: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0001f760: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
+0001f770: 6179 6f66 6d6f 6e74 6822 290a 2020 2020  ayofmonth").    
+0001f780: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001f790: 6461 796f 666d 6f6e 7468 2229 2863 290a  dayofmonth")(c).
+0001f7a0: 0a0a 6465 6620 6461 796f 6677 6565 6b28  ..def dayofweek(
+0001f7b0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0001f7c0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0001f7d0: 2222 220a 2020 2020 4578 7472 6163 7473  """.    Extracts
+0001f7e0: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
+0001f7f0: 6e67 2064 6179 2028 6e75 6d62 6572 2920  ng day (number) 
+0001f800: 6f66 2074 6865 2077 6565 6b20 6672 6f6d  of the week from
+0001f810: 2061 2064 6174 6520 6f72 2074 696d 6573   a date or times
+0001f820: 7461 6d70 2e0a 0a20 2020 2045 7861 6d70  tamp...    Examp
+0001f830: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+0001f840: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
+0001f850: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0001f860: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0001f870: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
+0001f880: 2020 2020 2e2e 2e20 2020 2020 5b5b 6461      ...     [[da
+0001f890: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+0001f8a0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+0001f8b0: 352d 3031 2031 333a 3131 3a32 302e 3030  5-01 13:11:20.00
+0001f8c0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+0001f8d0: 3a25 4d3a 2553 2e25 6622 295d 5d2c 0a20  :%M:%S.%f")]],. 
+0001f8e0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+0001f8f0: 6368 656d 613d 5b22 6122 5d2c 0a20 2020  chema=["a"],.   
+0001f900: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+0001f910: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0001f920: 2864 6179 6f66 7765 656b 2822 6122 2929  (dayofweek("a"))
+0001f930: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001f940: 2020 205b 526f 7728 4441 594f 4657 4545     [Row(DAYOFWEE
+0001f950: 4b28 2241 2229 3d35 295d 0a20 2020 2022  K("A")=5)].    "
+0001f960: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001f970: 6f6c 5f69 665f 7374 7228 652c 2022 6461  ol_if_str(e, "da
+0001f980: 796f 6677 6565 6b22 290a 2020 2020 7265  yofweek").    re
+0001f990: 7475 726e 2062 7569 6c74 696e 2822 6461  turn builtin("da
+0001f9a0: 796f 6677 6565 6b22 2928 6329 0a0a 0a64  yofweek")(c)...d
+0001f9b0: 6566 2064 6179 6f66 7965 6172 2865 3a20  ef dayofyear(e: 
+0001f9c0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0001f9d0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0001f9e0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
+0001f9f0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+0001fa00: 6461 7920 286e 756d 6265 7229 206f 6620  day (number) of 
+0001fa10: 7468 6520 7965 6172 2066 726f 6d20 6120  the year from a 
+0001fa20: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
+0001fa30: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
+0001fa40: 3a0a 2020 2020 2020 2020 3e3e 3e20 696d  :.        >>> im
+0001fa50: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
+0001fa60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0001fa70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0001fa80: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+0001fa90: 202e 2e2e 2020 2020 205b 5b64 6174 6574   ...     [[datet
+0001faa0: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
+0001fab0: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
+0001fac0: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
+0001fad0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
+0001fae0: 3a25 532e 2566 2229 5d5d 2c0a 2020 2020  :%S.%f")]],.    
+0001faf0: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+0001fb00: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
+0001fb10: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+0001fb20: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
+0001fb30: 796f 6679 6561 7228 2261 2229 292e 636f  yofyear("a")).co
+0001fb40: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001fb50: 5b52 6f77 2844 4159 4f46 5945 4152 2822  [Row(DAYOFYEAR("
+0001fb60: 4122 293d 3132 3229 5d0a 2020 2020 2222  A")=122)].    ""
+0001fb70: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0001fb80: 6c5f 6966 5f73 7472 2865 2c20 2264 6179  l_if_str(e, "day
+0001fb90: 6f66 7965 6172 2229 0a20 2020 2072 6574  ofyear").    ret
+0001fba0: 7572 6e20 6275 696c 7469 6e28 2264 6179  urn builtin("day
+0001fbb0: 6f66 7965 6172 2229 2863 290a 0a0a 6465  ofyear")(c)...de
+0001fbc0: 6620 6973 5f61 7272 6179 2863 6f6c 3a20  f is_array(col: 
+0001fbd0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0001fbe0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0001fbf0: 0a20 2020 2052 6574 7572 6e73 2074 7275  .    Returns tru
+0001fc00: 6520 6966 2074 6865 2073 7065 6369 6669  e if the specifi
+0001fc10: 6564 2056 4152 4941 4e54 2063 6f6c 756d  ed VARIANT colum
+0001fc20: 6e20 636f 6e74 6169 6e73 2061 6e20 4152  n contains an AR
+0001fc30: 5241 5920 7661 6c75 652e 0a0a 2020 2020  RAY value...    
+0001fc40: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
+0001fc50: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001fc60: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001fc70: 6672 616d 6528 5b5b 5b22 656c 656d 656e  frame([[["elemen
+0001fc80: 7422 5d2c 2054 7275 655d 5d2c 2073 6368  t"], True]], sch
+0001fc90: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+0001fca0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0001fcb0: 656c 6563 7428 6973 5f61 7272 6179 2864  elect(is_array(d
+0001fcc0: 665b 2261 225d 292e 616c 6961 7328 2269  f["a"]).alias("i
+0001fcd0: 735f 6172 7261 795f 6122 292c 2069 735f  s_array_a"), is_
+0001fce0: 6172 7261 7928 6466 5b22 6222 5d29 2e61  array(df["b"]).a
+0001fcf0: 6c69 6173 2822 6973 5f61 7272 6179 5f62  lias("is_array_b
+0001fd00: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+0001fd10: 2020 2020 2020 5b52 6f77 2849 535f 4152        [Row(IS_AR
+0001fd20: 5241 595f 413d 5472 7565 2c20 4953 5f41  RAY_A=True, IS_A
+0001fd30: 5252 4159 5f42 3d46 616c 7365 295d 0a20  RRAY_B=False)]. 
+0001fd40: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0001fd50: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+0001fd60: 6c2c 2022 6973 5f61 7272 6179 2229 0a20  l, "is_array"). 
+0001fd70: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0001fd80: 6e28 2269 735f 6172 7261 7922 2928 6329  n("is_array")(c)
+0001fd90: 0a0a 0a64 6566 2069 735f 626f 6f6c 6561  ...def is_boolea
+0001fda0: 6e28 636f 6c3a 2043 6f6c 756d 6e4f 724e  n(col: ColumnOrN
+0001fdb0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0001fdc0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+0001fdd0: 726e 7320 7472 7565 2069 6620 7468 6520  rns true if the 
+0001fde0: 7370 6563 6966 6965 6420 5641 5249 414e  specified VARIAN
+0001fdf0: 5420 636f 6c75 6d6e 2063 6f6e 7461 696e  T column contain
+0001fe00: 7320 6120 626f 6f6c 6561 6e20 7661 6c75  s a boolean valu
+0001fe10: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
+0001fe20: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0001fe30: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0001fe40: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+0001fe50: 706f 7274 2053 7472 7563 7446 6965 6c64  port StructField
+0001fe60: 2c20 5661 7269 616e 7454 7970 650a 2020  , VariantType.  
+0001fe70: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0001fe80: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0001fe90: 7461 6672 616d 6528 5b5b 5472 7565 2c20  taframe([[True, 
+0001fea0: 2758 275d 5d2c 2073 6368 656d 613d 5b22  'X']], schema=["
+0001feb0: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+0001fec0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001fed0: 6973 5f62 6f6f 6c65 616e 2874 6f5f 7661  is_boolean(to_va
+0001fee0: 7269 616e 7428 6466 5b22 6122 5d29 292e  riant(df["a"])).
+0001fef0: 616c 6961 7328 2262 6f6f 6c65 616e 2229  alias("boolean")
+0001ff00: 2c20 6973 5f62 6f6f 6c65 616e 2874 6f5f  , is_boolean(to_
+0001ff10: 7661 7269 616e 7428 6466 5b22 6222 5d29  variant(df["b"])
+0001ff20: 292e 616c 6961 7328 2276 6172 6368 6172  ).alias("varchar
+0001ff30: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+0001ff40: 2020 2020 2020 5b52 6f77 2842 4f4f 4c45        [Row(BOOLE
+0001ff50: 414e 3d54 7275 652c 2056 4152 4348 4152  AN=True, VARCHAR
+0001ff60: 3d46 616c 7365 295d 0a20 2020 2022 2222  =False)].    """
+0001ff70: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0001ff80: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
+0001ff90: 5f62 6f6f 6c65 616e 2229 0a20 2020 2072  _boolean").    r
+0001ffa0: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
+0001ffb0: 735f 626f 6f6c 6561 6e22 2928 6329 0a0a  s_boolean")(c)..
+0001ffc0: 0a64 6566 2069 735f 6269 6e61 7279 2863  .def is_binary(c
+0001ffd0: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+0001ffe0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001fff0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00020000: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
+00020010: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
+00020020: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
+00020030: 2062 696e 6172 7920 7661 6c75 652e 0a0a   binary value...
+00020040: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
+00020050: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00020060: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00020070: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+00020080: 2053 7472 7563 7446 6965 6c64 2c20 5661   StructField, Va
+00020090: 7269 616e 7454 7970 650a 2020 2020 2020  riantType.      
+000200a0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000200b0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000200c0: 616d 6528 5b5b 6222 736e 6f77 222c 2022  ame([[b"snow", "
+000200d0: 736e 6f77 225d 5d2c 2073 6368 656d 613d  snow"]], schema=
+000200e0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
+000200f0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00020100: 7428 6973 5f62 696e 6172 7928 746f 5f76  t(is_binary(to_v
+00020110: 6172 6961 6e74 2864 665b 2261 225d 2929  ariant(df["a"]))
+00020120: 2e61 6c69 6173 2822 6269 6e61 7279 2229  .alias("binary")
+00020130: 2c20 6973 5f62 696e 6172 7928 746f 5f76  , is_binary(to_v
+00020140: 6172 6961 6e74 2864 665b 2262 225d 2929  ariant(df["b"]))
+00020150: 2e61 6c69 6173 2822 7661 7263 6861 7222  .alias("varchar"
+00020160: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00020170: 2020 2020 205b 526f 7728 4249 4e41 5259       [Row(BINARY
+00020180: 3d54 7275 652c 2056 4152 4348 4152 3d46  =True, VARCHAR=F
+00020190: 616c 7365 295d 0a20 2020 2022 2222 0a20  alse)].    """. 
+000201a0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+000201b0: 665f 7374 7228 636f 6c2c 2022 6973 5f62  f_str(col, "is_b
+000201c0: 696e 6172 7922 290a 2020 2020 7265 7475  inary").    retu
+000201d0: 726e 2062 7569 6c74 696e 2822 6973 5f62  rn builtin("is_b
+000201e0: 696e 6172 7922 2928 6329 0a0a 0a64 6566  inary")(c)...def
+000201f0: 2069 735f 6368 6172 2863 6f6c 3a20 436f   is_char(col: Co
+00020200: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00020210: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00020220: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
+00020230: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
+00020240: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
+00020250: 636f 6e74 6169 6e73 2061 2073 7472 696e  contains a strin
+00020260: 672e 0a0a 2020 2020 4578 616d 706c 6573  g...    Examples
+00020270: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00020280: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00020290: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+000202a0: 706f 7274 2053 7472 7563 7446 6965 6c64  port StructField
+000202b0: 2c20 5661 7269 616e 7454 7970 650a 2020  , VariantType.  
+000202c0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000202d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000202e0: 7461 6672 616d 6528 5b5b 2261 6263 222c  taframe([["abc",
+000202f0: 2031 3233 5d5d 2c20 7363 6865 6d61 3d5b   123]], schema=[
+00020300: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00020310: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00020320: 2869 735f 6368 6172 2874 6f5f 7661 7269  (is_char(to_vari
+00020330: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
+00020340: 6961 7328 2276 6172 6368 6172 2229 2c20  ias("varchar"), 
+00020350: 6973 5f63 6861 7228 746f 5f76 6172 6961  is_char(to_varia
+00020360: 6e74 2864 665b 2262 225d 2929 2e61 6c69  nt(df["b"])).ali
+00020370: 6173 2822 696e 7422 2929 2e63 6f6c 6c65  as("int")).colle
+00020380: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00020390: 7728 5641 5243 4841 523d 5472 7565 2c20  w(VARCHAR=True, 
+000203a0: 494e 543d 4661 6c73 6529 5d0a 2020 2020  INT=False)].    
+000203b0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+000203c0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
+000203d0: 2269 735f 6368 6172 2229 0a20 2020 2072  "is_char").    r
+000203e0: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
+000203f0: 735f 6368 6172 2229 2863 290a 0a0a 6973  s_char")(c)...is
+00020400: 5f76 6172 6368 6172 203d 2069 735f 6368  _varchar = is_ch
+00020410: 6172 0a0a 0a64 6566 2069 735f 6461 7465  ar...def is_date
+00020420: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
+00020430: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00020440: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+00020450: 6e73 2074 7275 6520 6966 2074 6865 2073  ns true if the s
+00020460: 7065 6369 6669 6564 2056 4152 4941 4e54  pecified VARIANT
+00020470: 2063 6f6c 756d 6e20 636f 6e74 6169 6e73   column contains
+00020480: 2061 2064 6174 6520 7661 6c75 652e 0a0a   a date value...
+00020490: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
+000204a0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+000204b0: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
+000204c0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+000204d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000204e0: 7479 7065 7320 696d 706f 7274 2053 7472  types import Str
+000204f0: 7563 7446 6965 6c64 2c20 5661 7269 616e  uctField, Varian
+00020500: 7454 7970 650a 2020 2020 2020 2020 3e3e  tType.        >>
+00020510: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00020520: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00020530: 5b5b 6461 7465 7469 6d65 2e64 6174 6528  [[datetime.date(
+00020540: 3230 3233 2c20 332c 2032 292c 2031 3233  2023, 3, 2), 123
+00020550: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
+00020560: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
+00020570: 3e3e 2064 662e 7365 6c65 6374 2869 735f  >> df.select(is_
+00020580: 6461 7465 2874 6f5f 7661 7269 616e 7428  date(to_variant(
+00020590: 6466 5b22 6122 5d29 292e 616c 6961 7328  df["a"])).alias(
+000205a0: 2264 6174 6522 292c 2069 735f 6461 7465  "date"), is_date
+000205b0: 2874 6f5f 7661 7269 616e 7428 6466 5b22  (to_variant(df["
+000205c0: 6222 5d29 292e 616c 6961 7328 2269 6e74  b"])).alias("int
+000205d0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+000205e0: 2020 2020 2020 5b52 6f77 2844 4154 453d        [Row(DATE=
+000205f0: 5472 7565 2c20 494e 543d 4661 6c73 6529  True, INT=False)
+00020600: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00020610: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00020620: 2863 6f6c 2c20 2269 735f 6461 7465 2229  (col, "is_date")
+00020630: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00020640: 7469 6e28 2269 735f 6461 7465 2229 2863  tin("is_date")(c
+00020650: 290a 0a0a 6973 5f64 6174 655f 7661 6c75  )...is_date_valu
+00020660: 6520 3d20 6973 5f64 6174 650a 0a0a 6465  e = is_date...de
+00020670: 6620 6973 5f64 6563 696d 616c 2863 6f6c  f is_decimal(col
+00020680: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00020690: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000206a0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+000206b0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
+000206c0: 6669 6564 2056 4152 4941 4e54 2063 6f6c  fied VARIANT col
+000206d0: 756d 6e20 636f 6e74 6169 6e73 2061 2066  umn contains a f
+000206e0: 6978 6564 2d70 6f69 6e74 2064 6563 696d  ixed-point decim
+000206f0: 616c 2076 616c 7565 206f 7220 696e 7465  al value or inte
+00020700: 6765 722e 0a0a 2020 2020 4578 616d 706c  ger...    Exampl
+00020710: 6573 3a3a 0a0a 2020 2020 2020 2020 3e3e  es::..        >>
+00020720: 3e20 696d 706f 7274 2064 6563 696d 616c  > import decimal
+00020730: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00020740: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00020750: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00020760: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
+00020770: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
+00020780: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00020790: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000207a0: 7261 6d65 285b 5b64 6563 696d 616c 2e44  rame([[decimal.D
+000207b0: 6563 696d 616c 2831 292c 2022 5822 5d5d  ecimal(1), "X"]]
+000207c0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+000207d0: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
+000207e0: 2064 662e 7365 6c65 6374 2869 735f 6465   df.select(is_de
+000207f0: 6369 6d61 6c28 746f 5f76 6172 6961 6e74  cimal(to_variant
+00020800: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
+00020810: 2822 6465 6369 6d61 6c22 292c 2069 735f  ("decimal"), is_
+00020820: 6465 6369 6d61 6c28 746f 5f76 6172 6961  decimal(to_varia
+00020830: 6e74 2864 665b 2262 225d 2929 2e61 6c69  nt(df["b"])).ali
+00020840: 6173 2822 7661 7263 6861 7222 2929 2e63  as("varchar")).c
+00020850: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00020860: 205b 526f 7728 4445 4349 4d41 4c3d 5472   [Row(DECIMAL=Tr
+00020870: 7565 2c20 5641 5243 4841 523d 4661 6c73  ue, VARCHAR=Fals
+00020880: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+00020890: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+000208a0: 7472 2863 6f6c 2c20 2269 735f 6465 6369  tr(col, "is_deci
+000208b0: 6d61 6c22 290a 2020 2020 7265 7475 726e  mal").    return
+000208c0: 2062 7569 6c74 696e 2822 6973 5f64 6563   builtin("is_dec
+000208d0: 696d 616c 2229 2863 290a 0a0a 6465 6620  imal")(c)...def 
+000208e0: 6973 5f64 6f75 626c 6528 636f 6c3a 2043  is_double(col: C
+000208f0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00020900: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00020910: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
+00020920: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
+00020930: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
+00020940: 2063 6f6e 7461 696e 7320 6120 666c 6f61   contains a floa
+00020950: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
+00020960: 2c20 6669 7865 642d 706f 696e 7420 6465  , fixed-point de
+00020970: 6369 6d61 6c2c 206f 7220 696e 7465 6765  cimal, or intege
+00020980: 722e 0a0a 2020 2020 4578 616d 706c 6573  r...    Examples
+00020990: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+000209a0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+000209b0: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+000209c0: 706f 7274 2053 7472 7563 7446 6965 6c64  port StructField
+000209d0: 2c20 5661 7269 616e 7454 7970 650a 2020  , VariantType.  
+000209e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000209f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00020a00: 7461 6672 616d 6528 5b5b 312e 322c 2022  taframe([[1.2, "
+00020a10: 5822 5d5d 2c20 7363 6865 6d61 3d5b 2261  X"]], schema=["a
+00020a20: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+00020a30: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
+00020a40: 735f 646f 7562 6c65 2874 6f5f 7661 7269  s_double(to_vari
+00020a50: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
+00020a60: 6961 7328 2264 6f75 626c 6522 292c 2069  ias("double"), i
+00020a70: 735f 646f 7562 6c65 2874 6f5f 7661 7269  s_double(to_vari
+00020a80: 616e 7428 6466 5b22 6222 5d29 292e 616c  ant(df["b"])).al
+00020a90: 6961 7328 2276 6172 6368 6172 2229 292e  ias("varchar")).
+00020aa0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00020ab0: 2020 5b52 6f77 2844 4f55 424c 453d 5472    [Row(DOUBLE=Tr
+00020ac0: 7565 2c20 5641 5243 4841 523d 4661 6c73  ue, VARCHAR=Fals
+00020ad0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+00020ae0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00020af0: 7472 2863 6f6c 2c20 2269 735f 646f 7562  tr(col, "is_doub
+00020b00: 6c65 2229 0a20 2020 2072 6574 7572 6e20  le").    return 
+00020b10: 6275 696c 7469 6e28 2269 735f 646f 7562  builtin("is_doub
+00020b20: 6c65 2229 2863 290a 0a0a 6465 6620 6973  le")(c)...def is
+00020b30: 5f72 6561 6c28 636f 6c3a 2043 6f6c 756d  _real(col: Colum
+00020b40: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00020b50: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00020b60: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
+00020b70: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
+00020b80: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
+00020b90: 7461 696e 7320 6120 666c 6f61 7469 6e67  tains a floating
+00020ba0: 2d70 6f69 6e74 2076 616c 7565 2c20 6669  -point value, fi
+00020bb0: 7865 642d 706f 696e 7420 6465 6369 6d61  xed-point decima
+00020bc0: 6c2c 206f 7220 696e 7465 6765 722e 0a0a  l, or integer...
+00020bd0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00020be0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00020bf0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00020c00: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+00020c10: 6f72 7420 746f 5f76 6172 6961 6e74 2c20  ort to_variant, 
+00020c20: 6973 5f72 6561 6c0a 2020 2020 2020 2020  is_real.        
+00020c30: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00020c40: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00020c50: 6528 5b5b 312e 322c 2022 5822 5d5d 2c20  e([[1.2, "X"]], 
+00020c60: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
+00020c70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00020c80: 662e 7365 6c65 6374 2869 735f 7265 616c  f.select(is_real
+00020c90: 2874 6f5f 7661 7269 616e 7428 2261 2229  (to_variant("a")
+00020ca0: 292e 6173 5f28 2261 2229 2c20 6973 5f72  ).as_("a"), is_r
+00020cb0: 6561 6c28 746f 5f76 6172 6961 6e74 2822  eal(to_variant("
+00020cc0: 6222 2929 2e61 735f 2822 6222 2929 2e63  b")).as_("b")).c
+00020cd0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00020ce0: 205b 526f 7728 413d 5472 7565 2c20 423d   [Row(A=True, B=
+00020cf0: 4661 6c73 6529 5d0a 2020 2020 2222 220a  False)].    """.
+00020d00: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00020d10: 6966 5f73 7472 2863 6f6c 2c20 2269 735f  if_str(col, "is_
+00020d20: 7265 616c 2229 0a20 2020 2072 6574 7572  real").    retur
+00020d30: 6e20 6275 696c 7469 6e28 2269 735f 7265  n builtin("is_re
+00020d40: 616c 2229 2863 290a 0a0a 6465 6620 6973  al")(c)...def is
+00020d50: 5f69 6e74 6567 6572 2863 6f6c 3a20 436f  _integer(col: Co
+00020d60: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00020d70: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00020d80: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
+00020d90: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
+00020da0: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
+00020db0: 636f 6e74 6169 6e73 2061 2069 6e74 6567  contains a integ
+00020dc0: 6572 2076 616c 7565 2e0a 0a20 2020 2045  er value...    E
+00020dd0: 7861 6d70 6c65 733a 3a0a 0a20 2020 2020  xamples::..     
+00020de0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00020df0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+00020e00: 7970 6573 2069 6d70 6f72 7420 5374 7275  ypes import Stru
+00020e10: 6374 4669 656c 642c 2056 6172 6961 6e74  ctField, Variant
+00020e20: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+00020e30: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00020e40: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00020e50: 5b31 2c20 2258 225d 5d2c 2073 6368 656d  [1, "X"]], schem
+00020e60: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+00020e70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00020e80: 6563 7428 6973 5f69 6e74 6567 6572 2874  ect(is_integer(t
+00020e90: 6f5f 7661 7269 616e 7428 6466 5b22 6122  o_variant(df["a"
+00020ea0: 5d29 292e 616c 6961 7328 2269 6e74 2229  ])).alias("int")
+00020eb0: 2c20 6973 5f69 6e74 6567 6572 2874 6f5f  , is_integer(to_
+00020ec0: 7661 7269 616e 7428 6466 5b22 6222 5d29  variant(df["b"])
+00020ed0: 292e 616c 6961 7328 2276 6172 6368 6172  ).alias("varchar
+00020ee0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00020ef0: 2020 2020 2020 5b52 6f77 2849 4e54 3d54        [Row(INT=T
+00020f00: 7275 652c 2056 4152 4348 4152 3d46 616c  rue, VARCHAR=Fal
+00020f10: 7365 295d 0a20 2020 2022 2222 0a20 2020  se)].    """.   
+00020f20: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00020f30: 7374 7228 636f 6c2c 2022 6973 5f69 6e74  str(col, "is_int
+00020f40: 6567 6572 2229 0a20 2020 2072 6574 7572  eger").    retur
+00020f50: 6e20 6275 696c 7469 6e28 2269 735f 696e  n builtin("is_in
+00020f60: 7465 6765 7222 2928 6329 0a0a 0a64 6566  teger")(c)...def
+00020f70: 2069 735f 6e75 6c6c 5f76 616c 7565 2863   is_null_value(c
+00020f80: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+00020f90: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00020fa0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00020fb0: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
+00020fc0: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
+00020fd0: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
+00020fe0: 204a 534f 4e20 6e75 6c6c 2076 616c 7565   JSON null value
+00020ff0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00021000: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00021010: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00021020: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+00021030: 696d 706f 7274 2074 6f5f 7661 7269 616e  import to_varian
+00021040: 742c 2069 735f 6e75 6c6c 5f76 616c 7565  t, is_null_value
+00021050: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00021060: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00021070: 5f64 6174 6166 7261 6d65 285b 5b7b 2261  _dataframe([[{"a
+00021080: 223a 2022 666f 6f22 7d5d 2c20 5b7b 2261  ": "foo"}], [{"a
+00021090: 223a 204e 6f6e 657d 5d2c 205b 4e6f 6e65  ": None}], [None
+000210a0: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
+000210b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000210c0: 2e73 656c 6563 7428 6973 5f6e 756c 6c5f  .select(is_null_
+000210d0: 7661 6c75 6528 746f 5f76 6172 6961 6e74  value(to_variant
+000210e0: 2822 6122 295b 2261 225d 292e 6173 5f28  ("a")["a"]).as_(
+000210f0: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
+00021100: 2020 2020 2020 2020 5b52 6f77 2841 3d46          [Row(A=F
+00021110: 616c 7365 292c 2052 6f77 2841 3d54 7275  alse), Row(A=Tru
+00021120: 6529 2c20 526f 7728 413d 4e6f 6e65 295d  e), Row(A=None)]
+00021130: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00021140: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00021150: 636f 6c2c 2022 6973 5f6e 756c 6c5f 7661  col, "is_null_va
+00021160: 6c75 6522 290a 2020 2020 7265 7475 726e  lue").    return
+00021170: 2062 7569 6c74 696e 2822 6973 5f6e 756c   builtin("is_nul
+00021180: 6c5f 7661 6c75 6522 2928 6329 0a0a 0a64  l_value")(c)...d
+00021190: 6566 2069 735f 6f62 6a65 6374 2863 6f6c  ef is_object(col
+000211a0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+000211b0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000211c0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+000211d0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
+000211e0: 6669 6564 2056 4152 4941 4e54 2063 6f6c  fied VARIANT col
+000211f0: 756d 6e20 636f 6e74 6169 6e73 2061 6e20  umn contains an 
+00021200: 4f42 4a45 4354 2076 616c 7565 2e0a 0a20  OBJECT value... 
+00021210: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00021220: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00021230: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00021240: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+00021250: 7274 2074 6f5f 7661 7269 616e 742c 2069  rt to_variant, i
+00021260: 735f 6f62 6a65 6374 0a20 2020 2020 2020  s_object.       
+00021270: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00021280: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00021290: 6d65 285b 5b5b 312c 2032 5d2c 207b 2261  me([[[1, 2], {"a
+000212a0: 223a 2022 736e 6f77 227d 5d5d 2c20 7363  ": "snow"}]], sc
+000212b0: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
+000212c0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000212d0: 7365 6c65 6374 2869 735f 6f62 6a65 6374  select(is_object
+000212e0: 2874 6f5f 7661 7269 616e 7428 2261 2229  (to_variant("a")
+000212f0: 292e 6173 5f28 2261 2229 2c20 6973 5f6f  ).as_("a"), is_o
+00021300: 626a 6563 7428 746f 5f76 6172 6961 6e74  bject(to_variant
+00021310: 2822 6222 2929 2e61 735f 2822 6222 2929  ("b")).as_("b"))
+00021320: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00021330: 2020 205b 526f 7728 413d 4661 6c73 652c     [Row(A=False,
+00021340: 2042 3d54 7275 6529 5d0a 2020 2020 2222   B=True)].    ""
+00021350: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00021360: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2269  l_if_str(col, "i
+00021370: 735f 6f62 6a65 6374 2229 0a20 2020 2072  s_object").    r
+00021380: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
+00021390: 735f 6f62 6a65 6374 2229 2863 290a 0a0a  s_object")(c)...
+000213a0: 6465 6620 6973 5f74 696d 6528 636f 6c3a  def is_time(col:
+000213b0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+000213c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000213d0: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
+000213e0: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
+000213f0: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
+00021400: 6d6e 2063 6f6e 7461 696e 7320 6120 5449  mn contains a TI
+00021410: 4d45 2076 616c 7565 2e0a 0a20 2020 2045  ME value...    E
+00021420: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00021430: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
+00021440: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
+00021450: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+00021460: 2e73 6e6f 7770 6172 6b2e 6675 6e63 7469  .snowpark.functi
+00021470: 6f6e 7320 696d 706f 7274 2074 6f5f 7661  ons import to_va
+00021480: 7269 616e 742c 2069 735f 7469 6d65 0a20  riant, is_time. 
+00021490: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000214a0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000214b0: 6174 6166 7261 6d65 285b 5b64 6174 6574  ataframe([[datet
+000214c0: 696d 652e 7469 6d65 2831 302c 2031 3029  ime.time(10, 10)
+000214d0: 2c20 2258 225d 5d2c 2073 6368 656d 613d  , "X"]], schema=
+000214e0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
+000214f0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00021500: 7428 6973 5f74 696d 6528 746f 5f76 6172  t(is_time(to_var
+00021510: 6961 6e74 2822 6122 2929 2e61 735f 2822  iant("a")).as_("
+00021520: 6122 292c 2069 735f 7469 6d65 2874 6f5f  a"), is_time(to_
+00021530: 7661 7269 616e 7428 2262 2229 292e 6173  variant("b")).as
+00021540: 5f28 2262 2229 292e 636f 6c6c 6563 7428  _("b")).collect(
+00021550: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+00021560: 3d54 7275 652c 2042 3d46 616c 7365 295d  =True, B=False)]
+00021570: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00021580: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00021590: 636f 6c2c 2022 6973 5f74 696d 6522 290a  col, "is_time").
+000215a0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000215b0: 696e 2822 6973 5f74 696d 6522 2928 6329  in("is_time")(c)
+000215c0: 0a0a 0a64 6566 2069 735f 7469 6d65 7374  ...def is_timest
+000215d0: 616d 705f 6c74 7a28 636f 6c3a 2043 6f6c  amp_ltz(col: Col
+000215e0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+000215f0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00021600: 2020 5265 7475 726e 7320 7472 7565 2069    Returns true i
+00021610: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
+00021620: 5641 5249 414e 5420 636f 6c75 6d6e 2063  VARIANT column c
+00021630: 6f6e 7461 696e 7320 6120 5449 4d45 5354  ontains a TIMEST
+00021640: 414d 505f 4c54 5a20 7661 6c75 6520 746f  AMP_LTZ value to
+00021650: 2062 650a 2020 2020 696e 7465 7270 7265   be.    interpre
+00021660: 7465 6420 7573 696e 6720 7468 6520 6c6f  ted using the lo
+00021670: 6361 6c20 7469 6d65 207a 6f6e 652e 0a0a  cal time zone...
+00021680: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00021690: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+000216a0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000216b0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+000216c0: 6f72 7420 746f 5f76 6172 6961 6e74 2c20  ort to_variant, 
+000216d0: 6973 5f74 696d 6573 7461 6d70 5f6c 747a  is_timestamp_ltz
+000216e0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000216f0: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
+00021700: 656c 6563 7420 746f 5f74 696d 6573 7461  elect to_timesta
+00021710: 6d70 5f6e 747a 2827 3230 3137 2d30 322d  mp_ntz('2017-02-
+00021720: 3234 2031 323a 3030 3a30 302e 3435 3627  24 12:00:00.456'
+00021730: 2920 6173 2074 696d 6573 7461 6d70 5f6e  ) as timestamp_n
+00021740: 747a 312c 2022 0a20 2020 2020 2020 202e  tz1, ".        .
+00021750: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00021760: 2020 2020 2274 6f5f 7469 6d65 7374 616d      "to_timestam
+00021770: 705f 6c74 7a28 2732 3031 372d 3032 2d32  p_ltz('2017-02-2
+00021780: 3420 3133 3a30 303a 3030 2e31 3233 202b  4 13:00:00.123 +
+00021790: 3031 3a30 3027 2920 6173 2074 696d 6573  01:00') as times
+000217a0: 7461 6d70 5f6c 747a 312c 2022 0a20 2020  tamp_ltz1, ".   
+000217b0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+000217c0: 2020 2020 2020 2020 2020 2274 6f5f 7469            "to_ti
+000217d0: 6d65 7374 616d 705f 747a 2827 3230 3137  mestamp_tz('2017
+000217e0: 2d30 322d 3234 2031 333a 3030 3a30 302e  -02-24 13:00:00.
+000217f0: 3132 3320 2b30 313a 3030 2729 2061 7320  123 +01:00') as 
+00021800: 7469 6d65 7374 616d 705f 747a 3122 290a  timestamp_tz1").
+00021810: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00021820: 656c 6563 7428 6973 5f74 696d 6573 7461  elect(is_timesta
+00021830: 6d70 5f6c 747a 2874 6f5f 7661 7269 616e  mp_ltz(to_varian
+00021840: 7428 2274 696d 6573 7461 6d70 5f6e 747a  t("timestamp_ntz
+00021850: 3122 2929 2e61 735f 2822 6122 292c 0a20  1")).as_("a"),. 
+00021860: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00021870: 2020 2020 2069 735f 7469 6d65 7374 616d       is_timestam
+00021880: 705f 6c74 7a28 746f 5f76 6172 6961 6e74  p_ltz(to_variant
+00021890: 2822 7469 6d65 7374 616d 705f 6c74 7a31  ("timestamp_ltz1
+000218a0: 2229 292e 6173 5f28 2262 2229 2c0a 2020  ")).as_("b"),.  
+000218b0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000218c0: 2020 2020 6973 5f74 696d 6573 7461 6d70      is_timestamp
+000218d0: 5f6c 747a 2874 6f5f 7661 7269 616e 7428  _ltz(to_variant(
+000218e0: 2274 696d 6573 7461 6d70 5f74 7a31 2229  "timestamp_tz1")
+000218f0: 292e 6173 5f28 2263 2229 292e 636f 6c6c  ).as_("c")).coll
+00021900: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00021910: 6f77 2841 3d46 616c 7365 2c20 423d 5472  ow(A=False, B=Tr
+00021920: 7565 2c20 433d 4661 6c73 6529 5d0a 2020  ue, C=False)].  
+00021930: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00021940: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+00021950: 2c20 2269 735f 7469 6d65 7374 616d 705f  , "is_timestamp_
+00021960: 6c74 7a22 290a 2020 2020 7265 7475 726e  ltz").    return
+00021970: 2062 7569 6c74 696e 2822 6973 5f74 696d   builtin("is_tim
+00021980: 6573 7461 6d70 5f6c 747a 2229 2863 290a  estamp_ltz")(c).
+00021990: 0a0a 6465 6620 6973 5f74 696d 6573 7461  ..def is_timesta
+000219a0: 6d70 5f6e 747a 2863 6f6c 3a20 436f 6c75  mp_ntz(col: Colu
+000219b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+000219c0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+000219d0: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
+000219e0: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
+000219f0: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
+00021a00: 6e74 6169 6e73 2061 2054 494d 4553 5441  ntains a TIMESTA
+00021a10: 4d50 5f4e 545a 2076 616c 7565 2077 6974  MP_NTZ value wit
+00021a20: 6820 6e6f 2074 696d 6520 7a6f 6e65 2e0a  h no time zone..
+00021a30: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00021a40: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00021a50: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00021a60: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
+00021a70: 706f 7274 2074 6f5f 7661 7269 616e 742c  port to_variant,
+00021a80: 2069 735f 7469 6d65 7374 616d 705f 6e74   is_timestamp_nt
+00021a90: 7a0a 2020 2020 2020 2020 3e3e 3e20 6466  z.        >>> df
+00021aa0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+00021ab0: 7365 6c65 6374 2074 6f5f 7469 6d65 7374  select to_timest
+00021ac0: 616d 705f 6e74 7a28 2732 3031 372d 3032  amp_ntz('2017-02
+00021ad0: 2d32 3420 3132 3a30 303a 3030 2e34 3536  -24 12:00:00.456
+00021ae0: 2729 2061 7320 7469 6d65 7374 616d 705f  ') as timestamp_
+00021af0: 6e74 7a31 2c20 220a 2020 2020 2020 2020  ntz1, ".        
+00021b00: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00021b10: 2020 2020 2022 746f 5f74 696d 6573 7461       "to_timesta
+00021b20: 6d70 5f6c 747a 2827 3230 3137 2d30 322d  mp_ltz('2017-02-
+00021b30: 3234 2031 333a 3030 3a30 302e 3132 3320  24 13:00:00.123 
+00021b40: 2b30 313a 3030 2729 2061 7320 7469 6d65  +01:00') as time
+00021b50: 7374 616d 705f 6c74 7a31 2c20 220a 2020  stamp_ltz1, ".  
+00021b60: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00021b70: 2020 2020 2020 2020 2020 2022 746f 5f74             "to_t
+00021b80: 696d 6573 7461 6d70 5f74 7a28 2732 3031  imestamp_tz('201
+00021b90: 372d 3032 2d32 3420 3133 3a30 303a 3030  7-02-24 13:00:00
+00021ba0: 2e31 3233 202b 3031 3a30 3027 2920 6173  .123 +01:00') as
+00021bb0: 2074 696d 6573 7461 6d70 5f74 7a31 2229   timestamp_tz1")
+00021bc0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00021bd0: 7365 6c65 6374 2869 735f 7469 6d65 7374  select(is_timest
+00021be0: 616d 705f 6e74 7a28 746f 5f76 6172 6961  amp_ntz(to_varia
+00021bf0: 6e74 2822 7469 6d65 7374 616d 705f 6e74  nt("timestamp_nt
+00021c00: 7a31 2229 292e 6173 5f28 2261 2229 2c0a  z1")).as_("a"),.
+00021c10: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00021c20: 2020 2020 2020 6973 5f74 696d 6573 7461        is_timesta
+00021c30: 6d70 5f6e 747a 2874 6f5f 7661 7269 616e  mp_ntz(to_varian
+00021c40: 7428 2274 696d 6573 7461 6d70 5f6c 747a  t("timestamp_ltz
+00021c50: 3122 2929 2e61 735f 2822 6222 292c 0a20  1")).as_("b"),. 
+00021c60: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00021c70: 2020 2020 2069 735f 7469 6d65 7374 616d       is_timestam
+00021c80: 705f 6e74 7a28 746f 5f76 6172 6961 6e74  p_ntz(to_variant
+00021c90: 2822 7469 6d65 7374 616d 705f 747a 3122  ("timestamp_tz1"
+00021ca0: 2929 2e61 735f 2822 6322 2929 2e63 6f6c  )).as_("c")).col
+00021cb0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00021cc0: 526f 7728 413d 5472 7565 2c20 423d 4661  Row(A=True, B=Fa
+00021cd0: 6c73 652c 2043 3d46 616c 7365 295d 0a20  lse, C=False)]. 
+00021ce0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00021cf0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+00021d00: 6c2c 2022 6973 5f74 696d 6573 7461 6d70  l, "is_timestamp
+00021d10: 5f6e 747a 2229 0a20 2020 2072 6574 7572  _ntz").    retur
+00021d20: 6e20 6275 696c 7469 6e28 2269 735f 7469  n builtin("is_ti
+00021d30: 6d65 7374 616d 705f 6e74 7a22 2928 6329  mestamp_ntz")(c)
+00021d40: 0a0a 0a64 6566 2069 735f 7469 6d65 7374  ...def is_timest
+00021d50: 616d 705f 747a 2863 6f6c 3a20 436f 6c75  amp_tz(col: Colu
+00021d60: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00021d70: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00021d80: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
+00021d90: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
+00021da0: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
+00021db0: 6e74 6169 6e73 2061 2054 494d 4553 5441  ntains a TIMESTA
+00021dc0: 4d50 5f54 5a20 7661 6c75 6520 7769 7468  MP_TZ value with
+00021dd0: 2061 2074 696d 6520 7a6f 6e65 2e0a 0a20   a time zone... 
+00021de0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00021df0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00021e00: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00021e10: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+00021e20: 7274 2074 6f5f 7661 7269 616e 742c 2069  rt to_variant, i
+00021e30: 735f 7469 6d65 7374 616d 705f 747a 0a20  s_timestamp_tz. 
+00021e40: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00021e50: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
+00021e60: 6563 7420 746f 5f74 696d 6573 7461 6d70  ect to_timestamp
+00021e70: 5f6e 747a 2827 3230 3137 2d30 322d 3234  _ntz('2017-02-24
+00021e80: 2031 323a 3030 3a30 302e 3435 3627 2920   12:00:00.456') 
+00021e90: 6173 2074 696d 6573 7461 6d70 5f6e 747a  as timestamp_ntz
+00021ea0: 312c 2022 0a20 2020 2020 2020 202e 2e2e  1, ".        ...
+00021eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ec0: 2020 2274 6f5f 7469 6d65 7374 616d 705f    "to_timestamp_
+00021ed0: 6c74 7a28 2732 3031 372d 3032 2d32 3420  ltz('2017-02-24 
+00021ee0: 3133 3a30 303a 3030 2e31 3233 202b 3031  13:00:00.123 +01
+00021ef0: 3a30 3027 2920 6173 2074 696d 6573 7461  :00') as timesta
+00021f00: 6d70 5f6c 747a 312c 2022 0a20 2020 2020  mp_ltz1, ".     
+00021f10: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00021f20: 2020 2020 2020 2020 2274 6f5f 7469 6d65          "to_time
+00021f30: 7374 616d 705f 747a 2827 3230 3137 2d30  stamp_tz('2017-0
+00021f40: 322d 3234 2031 333a 3030 3a30 302e 3132  2-24 13:00:00.12
+00021f50: 3320 2b30 313a 3030 2729 2061 7320 7469  3 +01:00') as ti
+00021f60: 6d65 7374 616d 705f 747a 3122 290a 2020  mestamp_tz1").  
+00021f70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00021f80: 6563 7428 6973 5f74 696d 6573 7461 6d70  ect(is_timestamp
+00021f90: 5f74 7a28 746f 5f76 6172 6961 6e74 2822  _tz(to_variant("
+00021fa0: 7469 6d65 7374 616d 705f 6e74 7a31 2229  timestamp_ntz1")
+00021fb0: 292e 6173 5f28 2261 2229 2c0a 2020 2020  ).as_("a"),.    
+00021fc0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00021fd0: 2020 6973 5f74 696d 6573 7461 6d70 5f74    is_timestamp_t
+00021fe0: 7a28 746f 5f76 6172 6961 6e74 2822 7469  z(to_variant("ti
+00021ff0: 6d65 7374 616d 705f 6c74 7a31 2229 292e  mestamp_ltz1")).
+00022000: 6173 5f28 2262 2229 2c0a 2020 2020 2020  as_("b"),.      
+00022010: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00022020: 6973 5f74 696d 6573 7461 6d70 5f74 7a28  is_timestamp_tz(
+00022030: 746f 5f76 6172 6961 6e74 2822 7469 6d65  to_variant("time
+00022040: 7374 616d 705f 747a 3122 2929 2e61 735f  stamp_tz1")).as_
+00022050: 2822 6322 2929 2e63 6f6c 6c65 6374 2829  ("c")).collect()
+00022060: 0a20 2020 2020 2020 205b 526f 7728 413d  .        [Row(A=
+00022070: 4661 6c73 652c 2042 3d46 616c 7365 2c20  False, B=False, 
+00022080: 433d 5472 7565 295d 0a20 2020 2022 2222  C=True)].    """
+00022090: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+000220a0: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
+000220b0: 5f74 696d 6573 7461 6d70 5f74 7a22 290a  _timestamp_tz").
+000220c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000220d0: 696e 2822 6973 5f74 696d 6573 7461 6d70  in("is_timestamp
+000220e0: 5f74 7a22 2928 6329 0a0a 0a64 6566 205f  _tz")(c)...def _
+000220f0: 636f 6c75 6d6e 735f 6672 6f6d 5f74 696d  columns_from_tim
+00022100: 6573 7461 6d70 5f70 6172 7473 280a 2020  estamp_parts(.  
+00022110: 2020 6675 6e63 5f6e 616d 653a 2073 7472    func_name: str
+00022120: 2c20 2a61 7267 733a 2055 6e69 6f6e 5b43  , *args: Union[C
+00022130: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+00022140: 5d0a 2920 2d3e 2054 7570 6c65 5b43 6f6c  ].) -> Tuple[Col
+00022150: 756d 6e2c 202e 2e2e 5d3a 0a20 2020 2069  umn, ...]:.    i
+00022160: 6620 6c65 6e28 6172 6773 2920 3d3d 2033  f len(args) == 3
+00022170: 3a0a 2020 2020 2020 2020 7965 6172 5f20  :.        year_ 
+00022180: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00022190: 5f6f 725f 696e 7428 6172 6773 5b30 5d2c  _or_int(args[0],
+000221a0: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
+000221b0: 2020 2020 6d6f 6e74 6820 3d20 5f74 6f5f      month = _to_
+000221c0: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
+000221d0: 7428 6172 6773 5b31 5d2c 2066 756e 635f  t(args[1], func_
+000221e0: 6e61 6d65 290a 2020 2020 2020 2020 6461  name).        da
+000221f0: 7920 3d20 5f74 6f5f 636f 6c5f 6966 5f73  y = _to_col_if_s
+00022200: 7472 5f6f 725f 696e 7428 6172 6773 5b32  tr_or_int(args[2
+00022210: 5d2c 2066 756e 635f 6e61 6d65 290a 2020  ], func_name).  
+00022220: 2020 2020 2020 7265 7475 726e 2079 6561        return yea
+00022230: 725f 2c20 6d6f 6e74 682c 2064 6179 0a20  r_, month, day. 
+00022240: 2020 2065 6c69 6620 6c65 6e28 6172 6773     elif len(args
+00022250: 2920 3d3d 2036 3a0a 2020 2020 2020 2020  ) == 6:.        
+00022260: 7965 6172 5f20 3d20 5f74 6f5f 636f 6c5f  year_ = _to_col_
+00022270: 6966 5f73 7472 5f6f 725f 696e 7428 6172  if_str_or_int(ar
+00022280: 6773 5b30 5d2c 2066 756e 635f 6e61 6d65  gs[0], func_name
+00022290: 290a 2020 2020 2020 2020 6d6f 6e74 6820  ).        month 
+000222a0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000222b0: 5f6f 725f 696e 7428 6172 6773 5b31 5d2c  _or_int(args[1],
+000222c0: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
+000222d0: 2020 2020 6461 7920 3d20 5f74 6f5f 636f      day = _to_co
+000222e0: 6c5f 6966 5f73 7472 5f6f 725f 696e 7428  l_if_str_or_int(
+000222f0: 6172 6773 5b32 5d2c 2066 756e 635f 6e61  args[2], func_na
+00022300: 6d65 290a 2020 2020 2020 2020 686f 7572  me).        hour
+00022310: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00022320: 725f 6f72 5f69 6e74 2861 7267 735b 335d  r_or_int(args[3]
+00022330: 2c20 6675 6e63 5f6e 616d 6529 0a20 2020  , func_name).   
+00022340: 2020 2020 206d 696e 7574 6520 3d20 5f74       minute = _t
+00022350: 6f5f 636f 6c5f 6966 5f73 7472 5f6f 725f  o_col_if_str_or_
+00022360: 696e 7428 6172 6773 5b34 5d2c 2066 756e  int(args[4], fun
+00022370: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
+00022380: 7365 636f 6e64 203d 205f 746f 5f63 6f6c  second = _to_col
+00022390: 5f69 665f 7374 725f 6f72 5f69 6e74 2861  _if_str_or_int(a
+000223a0: 7267 735b 355d 2c20 6675 6e63 5f6e 616d  rgs[5], func_nam
+000223b0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+000223c0: 6e20 7965 6172 5f2c 206d 6f6e 7468 2c20  n year_, month, 
+000223d0: 6461 792c 2068 6f75 722c 206d 696e 7574  day, hour, minut
+000223e0: 652c 2073 6563 6f6e 640a 2020 2020 656c  e, second.    el
+000223f0: 7365 3a0a 2020 2020 2020 2020 2320 5368  se:.        # Sh
+00022400: 6f75 6c64 206e 6576 6572 2068 6170 7065  ould never happe
+00022410: 6e20 7369 6e63 6520 7765 206f 6e6c 7920  n since we only 
+00022420: 7573 6520 7468 6973 2069 6e74 6572 6e61  use this interna
+00022430: 6c6c 790a 2020 2020 2020 2020 7261 6973  lly.        rais
+00022440: 6520 5661 6c75 6545 7272 6f72 2866 2249  e ValueError(f"I
+00022450: 6e63 6f72 7265 6374 206e 756d 6265 7220  ncorrect number 
+00022460: 6f66 2061 7267 7320 7061 7373 6564 2074  of args passed t
+00022470: 6f20 7b66 756e 635f 6e61 6d65 7d22 290a  o {func_name}").
+00022480: 0a0a 6465 6620 5f74 696d 6573 7461 6d70  ..def _timestamp
+00022490: 5f66 726f 6d5f 7061 7274 735f 696e 7465  _from_parts_inte
+000224a0: 726e 616c 280a 2020 2020 6675 6e63 5f6e  rnal(.    func_n
+000224b0: 616d 653a 2073 7472 2c20 2a61 7267 733a  ame: str, *args:
+000224c0: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
+000224d0: 616d 652c 2069 6e74 5d2c 202a 2a6b 7761  ame, int], **kwa
+000224e0: 7267 733a 2055 6e69 6f6e 5b43 6f6c 756d  rgs: Union[Colum
+000224f0: 6e4f 724e 616d 652c 2069 6e74 5d0a 2920  nOrName, int].) 
+00022500: 2d3e 2054 7570 6c65 5b43 6f6c 756d 6e2c  -> Tuple[Column,
+00022510: 202e 2e2e 5d3a 0a20 2020 206e 756d 5f61   ...]:.    num_a
+00022520: 7267 7320 3d20 6c65 6e28 6172 6773 290a  rgs = len(args).
+00022530: 2020 2020 6966 206e 756d 5f61 7267 7320      if num_args 
+00022540: 3d3d 2032 3a0a 2020 2020 2020 2020 2320  == 2:.        # 
+00022550: 6578 7072 6573 7369 6f6e 206d 6f64 650a  expression mode.
+00022560: 2020 2020 2020 2020 6461 7465 5f65 7870          date_exp
+00022570: 7220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  r = _to_col_if_s
+00022580: 7472 2861 7267 735b 305d 2c20 6675 6e63  tr(args[0], func
+00022590: 5f6e 616d 6529 0a20 2020 2020 2020 2074  _name).        t
+000225a0: 696d 655f 6578 7072 203d 205f 746f 5f63  ime_expr = _to_c
+000225b0: 6f6c 5f69 665f 7374 7228 6172 6773 5b31  ol_if_str(args[1
+000225c0: 5d2c 2066 756e 635f 6e61 6d65 290a 2020  ], func_name).  
+000225d0: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
+000225e0: 655f 6578 7072 2c20 7469 6d65 5f65 7870  e_expr, time_exp
+000225f0: 720a 2020 2020 656c 6966 2036 203c 3d20  r.    elif 6 <= 
+00022600: 6e75 6d5f 6172 6773 203c 3d20 383a 0a20  num_args <= 8:. 
+00022610: 2020 2020 2020 2023 2070 6172 7473 206d         # parts m
+00022620: 6f64 650a 2020 2020 2020 2020 792c 206d  ode.        y, m
+00022630: 2c20 642c 2068 2c20 6d69 6e5f 2c20 7320  , d, h, min_, s 
+00022640: 3d20 5f63 6f6c 756d 6e73 5f66 726f 6d5f  = _columns_from_
+00022650: 7469 6d65 7374 616d 705f 7061 7274 7328  timestamp_parts(
+00022660: 6675 6e63 5f6e 616d 652c 202a 6172 6773  func_name, *args
+00022670: 5b3a 365d 290a 2020 2020 2020 2020 6e73  [:6]).        ns
+00022680: 5f61 7267 203d 2061 7267 735b 365d 2069  _arg = args[6] i
+00022690: 6620 6e75 6d5f 6172 6773 203e 3d20 3720  f num_args >= 7 
+000226a0: 656c 7365 206b 7761 7267 732e 6765 7428  else kwargs.get(
+000226b0: 226e 616e 6f73 6563 6f6e 6473 2229 0a20  "nanoseconds"). 
+000226c0: 2020 2020 2020 2023 2054 696d 657a 6f6e         # Timezon
+000226d0: 6520 6973 206f 6e6c 7920 6163 6365 7074  e is only accept
+000226e0: 6564 2069 6e20 7469 6d65 7374 616d 705f  ed in timestamp_
+000226f0: 6672 6f6d 5f70 6172 7473 2066 756e 6374  from_parts funct
+00022700: 696f 6e0a 2020 2020 2020 2020 747a 5f61  ion.        tz_a
+00022710: 7267 203d 2061 7267 735b 375d 2069 6620  rg = args[7] if 
+00022720: 6e75 6d5f 6172 6773 203d 3d20 3820 656c  num_args == 8 el
+00022730: 7365 206b 7761 7267 732e 6765 7428 2274  se kwargs.get("t
+00022740: 696d 657a 6f6e 6522 290a 2020 2020 2020  imezone").      
+00022750: 2020 6966 2074 7a5f 6172 6720 6973 206e    if tz_arg is n
+00022760: 6f74 204e 6f6e 6520 616e 6420 6675 6e63  ot None and func
+00022770: 5f6e 616d 6520 213d 2022 7469 6d65 7374  _name != "timest
+00022780: 616d 705f 6672 6f6d 5f70 6172 7473 223a  amp_from_parts":
+00022790: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000227a0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+000227b0: 7b66 756e 635f 6e61 6d65 7d20 646f 6573  {func_name} does
+000227c0: 206e 6f74 2061 6363 6570 7420 7469 6d65   not accept time
+000227d0: 7a6f 6e65 2061 7320 616e 2061 7267 756d  zone as an argum
+000227e0: 656e 7422 290a 2020 2020 2020 2020 6e73  ent").        ns
+000227f0: 203d 204e 6f6e 6520 6966 206e 735f 6172   = None if ns_ar
+00022800: 6720 6973 204e 6f6e 6520 656c 7365 205f  g is None else _
+00022810: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
+00022820: 5f69 6e74 286e 735f 6172 672c 2066 756e  _int(ns_arg, fun
+00022830: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
+00022840: 747a 203d 204e 6f6e 6520 6966 2074 7a5f  tz = None if tz_
+00022850: 6172 6720 6973 204e 6f6e 6520 656c 7365  arg is None else
+00022860: 205f 746f 5f63 6f6c 5f69 665f 7371 6c5f   _to_col_if_sql_
+00022870: 6578 7072 2874 7a5f 6172 672c 2066 756e  expr(tz_arg, fun
+00022880: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
+00022890: 6966 206e 7320 6973 206e 6f74 204e 6f6e  if ns is not Non
+000228a0: 6520 616e 6420 747a 2069 7320 6e6f 7420  e and tz is not 
+000228b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000228c0: 2020 7265 7475 726e 2079 2c20 6d2c 2064    return y, m, d
+000228d0: 2c20 682c 206d 696e 5f2c 2073 2c20 6e73  , h, min_, s, ns
+000228e0: 2c20 747a 0a20 2020 2020 2020 2065 6c69  , tz.        eli
+000228f0: 6620 6e73 2069 7320 6e6f 7420 4e6f 6e65  f ns is not None
+00022900: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00022910: 7475 726e 2079 2c20 6d2c 2064 2c20 682c  turn y, m, d, h,
+00022920: 206d 696e 5f2c 2073 2c20 6e73 0a20 2020   min_, s, ns.   
+00022930: 2020 2020 2065 6c69 6620 747a 2069 7320       elif tz is 
+00022940: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00022950: 2020 2020 2020 2320 5765 206e 6565 6420        # We need 
+00022960: 746f 2066 696c 6c20 696e 206e 616e 6f73  to fill in nanos
+00022970: 6563 6f6e 6473 2061 7320 3020 746f 206d  econds as 0 to m
+00022980: 616b 6520 7468 6520 7371 6c20 6675 6e63  ake the sql func
+00022990: 7469 6f6e 2077 6f72 6b0a 2020 2020 2020  tion work.      
+000229a0: 2020 2020 2020 7265 7475 726e 2079 2c20        return y, 
+000229b0: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
+000229c0: 2c20 6c69 7428 3029 2c20 747a 0a20 2020  , lit(0), tz.   
+000229d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000229e0: 2020 2020 2020 2072 6574 7572 6e20 792c         return y,
+000229f0: 206d 2c20 642c 2068 2c20 6d69 6e5f 2c20   m, d, h, min_, 
+00022a00: 730a 2020 2020 656c 7365 3a0a 2020 2020  s.    else:.    
+00022a10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00022a20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00022a30: 2020 6622 7b66 756e 635f 6e61 6d65 7d20    f"{func_name} 
+00022a40: 6578 7065 6374 6564 2032 206f 7220 3620  expected 2 or 6 
+00022a50: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
+00022a60: 7473 2c20 676f 7420 7b6e 756d 5f61 7267  ts, got {num_arg
+00022a70: 737d 220a 2020 2020 2020 2020 290a 0a0a  s}".        )...
+00022a80: 6465 6620 7469 6d65 5f66 726f 6d5f 7061  def time_from_pa
+00022a90: 7274 7328 0a20 2020 2068 6f75 723a 2055  rts(.    hour: U
+00022aa0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00022ab0: 652c 2069 6e74 5d2c 0a20 2020 206d 696e  e, int],.    min
+00022ac0: 7574 653a 2055 6e69 6f6e 5b43 6f6c 756d  ute: Union[Colum
+00022ad0: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
+00022ae0: 2020 2073 6563 6f6e 643a 2055 6e69 6f6e     second: Union
+00022af0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00022b00: 6e74 5d2c 0a20 2020 206e 616e 6f73 6563  nt],.    nanosec
+00022b10: 6f6e 6473 3a20 4f70 7469 6f6e 616c 5b55  onds: Optional[U
+00022b20: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00022b30: 652c 2069 6e74 5d5d 203d 204e 6f6e 652c  e, int]] = None,
+00022b40: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
+00022b50: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
+00022b60: 7320 6120 7469 6d65 2066 726f 6d20 696e  s a time from in
+00022b70: 6469 7669 6475 616c 206e 756d 6572 6963  dividual numeric
+00022b80: 2063 6f6d 706f 6e65 6e74 732e 0a0a 2020   components...  
+00022b90: 2020 5449 4d45 5f46 524f 4d5f 5041 5254    TIME_FROM_PART
+00022ba0: 5320 6973 2074 7970 6963 616c 6c79 2075  S is typically u
+00022bb0: 7365 6420 746f 2068 616e 646c 6520 7661  sed to handle va
+00022bc0: 6c75 6573 2069 6e20 226e 6f72 6d61 6c22  lues in "normal"
+00022bd0: 2072 616e 6765 7320 2865 2e67 2e20 686f   ranges (e.g. ho
+00022be0: 7572 7320 302d 3233 2c20 6d69 6e75 7465  urs 0-23, minute
+00022bf0: 7320 302d 3539 292c 0a20 2020 2062 7574  s 0-59),.    but
+00022c00: 2069 7420 616c 736f 2068 616e 646c 6573   it also handles
+00022c10: 2076 616c 7565 7320 6672 6f6d 206f 7574   values from out
+00022c20: 7369 6465 2074 6865 7365 2072 616e 6765  side these range
+00022c30: 732e 2054 6869 7320 616c 6c6f 7773 2c20  s. This allows, 
+00022c40: 666f 7220 6578 616d 706c 652c 2063 686f  for example, cho
+00022c50: 6f73 696e 6720 7468 6520 4e2d 7468 206d  osing the N-th m
+00022c60: 696e 7574 650a 2020 2020 696e 2061 2064  inute.    in a d
+00022c70: 6179 2c20 7768 6963 6820 6361 6e20 6265  ay, which can be
+00022c80: 2075 7365 6420 746f 2073 696d 706c 6966   used to simplif
+00022c90: 7920 736f 6d65 2063 6f6d 7075 7461 7469  y some computati
+00022ca0: 6f6e 732e 0a0a 2020 2020 4578 616d 706c  ons...    Exampl
+00022cb0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00022cc0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00022cd0: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00022ce0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00022cf0: 5b5b 3131 2c20 3131 2c20 302c 2039 3837  [[11, 11, 0, 987
+00022d00: 3635 3433 3231 5d2c 205b 3130 2c20 3130  654321], [10, 10
+00022d10: 2c20 302c 2039 3837 3635 3433 3231 5d5d  , 0, 987654321]]
+00022d20: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00022d30: 2020 7363 6865 6d61 3d5b 2268 6f75 7222    schema=["hour"
+00022d40: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
+00022d50: 6f6e 6422 2c20 226e 616e 6f73 6563 6f6e  ond", "nanosecon
+00022d60: 6473 225d 2c0a 2020 2020 2020 2020 2e2e  ds"],.        ..
+00022d70: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+00022d80: 6466 2e73 656c 6563 7428 7469 6d65 5f66  df.select(time_f
+00022d90: 726f 6d5f 7061 7274 7328 0a20 2020 2020  rom_parts(.     
+00022da0: 2020 202e 2e2e 2020 2020 2022 686f 7572     ...     "hour
+00022db0: 222c 2022 6d69 6e75 7465 222c 2022 7365  ", "minute", "se
+00022dc0: 636f 6e64 222c 206e 616e 6f73 6563 6f6e  cond", nanosecon
+00022dd0: 6473 3d22 6e61 6e6f 7365 636f 6e64 7322  ds="nanoseconds"
+00022de0: 0a20 2020 2020 2020 202e 2e2e 2029 2e61  .        ... ).a
+00022df0: 6c69 6173 2822 5449 4d45 5f46 524f 4d5f  lias("TIME_FROM_
+00022e00: 5041 5254 5322 2929 2e63 6f6c 6c65 6374  PARTS")).collect
+00022e10: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00022e20: 5449 4d45 5f46 524f 4d5f 5041 5254 533d  TIME_FROM_PARTS=
+00022e30: 6461 7465 7469 6d65 2e74 696d 6528 3131  datetime.time(11
+00022e40: 2c20 3131 2c20 302c 2039 3837 3635 3429  , 11, 0, 987654)
+00022e50: 292c 2052 6f77 2854 494d 455f 4652 4f4d  ), Row(TIME_FROM
+00022e60: 5f50 4152 5453 3d64 6174 6574 696d 652e  _PARTS=datetime.
+00022e70: 7469 6d65 2831 302c 2031 302c 2030 2c20  time(10, 10, 0, 
+00022e80: 3938 3736 3534 2929 5d0a 2020 2020 2222  987654))].    ""
+00022e90: 220a 2020 2020 682c 206d 2c20 7320 3d20  ".    h, m, s = 
+00022ea0: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
+00022eb0: 6d65 7374 616d 705f 7061 7274 7328 2274  mestamp_parts("t
+00022ec0: 696d 655f 6672 6f6d 5f70 6172 7473 222c  ime_from_parts",
+00022ed0: 2068 6f75 722c 206d 696e 7574 652c 2073   hour, minute, s
+00022ee0: 6563 6f6e 6429 0a20 2020 2069 6620 6e61  econd).    if na
+00022ef0: 6e6f 7365 636f 6e64 733a 0a20 2020 2020  noseconds:.     
+00022f00: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00022f10: 6e28 2274 696d 655f 6672 6f6d 5f70 6172  n("time_from_par
+00022f20: 7473 2229 280a 2020 2020 2020 2020 2020  ts")(.          
+00022f30: 2020 682c 206d 2c20 732c 205f 746f 5f63    h, m, s, _to_c
+00022f40: 6f6c 5f69 665f 7374 725f 6f72 5f69 6e74  ol_if_str_or_int
+00022f50: 286e 616e 6f73 6563 6f6e 6473 2c20 2274  (nanoseconds, "t
+00022f60: 696d 655f 6672 6f6d 5f70 6172 7473 2229  ime_from_parts")
+00022f70: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
+00022f80: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+00022f90: 7572 6e20 6275 696c 7469 6e28 2274 696d  urn builtin("tim
+00022fa0: 655f 6672 6f6d 5f70 6172 7473 2229 2868  e_from_parts")(h
+00022fb0: 2c20 6d2c 2073 290a 0a0a 406f 7665 726c  , m, s)...@overl
+00022fc0: 6f61 640a 6465 6620 7469 6d65 7374 616d  oad.def timestam
+00022fd0: 705f 6672 6f6d 5f70 6172 7473 2864 6174  p_from_parts(dat
+00022fe0: 655f 6578 7072 3a20 436f 6c75 6d6e 4f72  e_expr: ColumnOr
+00022ff0: 4e61 6d65 2c20 7469 6d65 5f65 7870 723a  Name, time_expr:
+00023000: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00023010: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2e2e  > Column:.    ..
+00023020: 2e20 2023 2070 7261 676d 613a 206e 6f20  .  # pragma: no 
+00023030: 636f 7665 720a 0a0a 406f 7665 726c 6f61  cover...@overloa
+00023040: 640a 6465 6620 7469 6d65 7374 616d 705f  d.def timestamp_
+00023050: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
+00023060: 7965 6172 3a20 556e 696f 6e5b 436f 6c75  year: Union[Colu
+00023070: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
+00023080: 2020 2020 6d6f 6e74 683a 2055 6e69 6f6e      month: Union
+00023090: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+000230a0: 6e74 5d2c 0a20 2020 2064 6179 3a20 556e  nt],.    day: Un
+000230b0: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+000230c0: 2c20 696e 745d 2c0a 2020 2020 686f 7572  , int],.    hour
+000230d0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+000230e0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
+000230f0: 6d69 6e75 7465 3a20 556e 696f 6e5b 436f  minute: Union[Co
+00023100: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00023110: 2c0a 2020 2020 7365 636f 6e64 3a20 556e  ,.    second: Un
+00023120: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+00023130: 2c20 696e 745d 2c0a 2020 2020 6e61 6e6f  , int],.    nano
+00023140: 7365 636f 6e64 3a20 4f70 7469 6f6e 616c  second: Optional
+00023150: 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f 724e  [Union[ColumnOrN
+00023160: 616d 652c 2069 6e74 5d5d 203d 204e 6f6e  ame, int]] = Non
+00023170: 652c 0a20 2020 2074 696d 657a 6f6e 653a  e,.    timezone:
+00023180: 204f 7074 696f 6e61 6c5b 436f 6c75 6d6e   Optional[Column
+00023190: 4f72 4c69 7465 7261 6c53 7472 5d20 3d20  OrLiteralStr] = 
+000231a0: 4e6f 6e65 2c0a 2920 2d3e 2043 6f6c 756d  None,.) -> Colum
+000231b0: 6e3a 0a20 2020 202e 2e2e 2020 2320 7072  n:.    ...  # pr
+000231c0: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a0a  agma: no cover..
+000231d0: 0a64 6566 2074 696d 6573 7461 6d70 5f66  .def timestamp_f
+000231e0: 726f 6d5f 7061 7274 7328 2a61 7267 732c  rom_parts(*args,
+000231f0: 202a 2a6b 7761 7267 7329 202d 3e20 436f   **kwargs) -> Co
+00023200: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00023210: 2020 4372 6561 7465 7320 6120 7469 6d65    Creates a time
+00023220: 7374 616d 7020 6672 6f6d 2069 6e64 6976  stamp from indiv
+00023230: 6964 7561 6c20 6e75 6d65 7269 6320 636f  idual numeric co
+00023240: 6d70 6f6e 656e 7473 2e20 4966 206e 6f20  mponents. If no 
+00023250: 7469 6d65 207a 6f6e 6520 6973 2069 6e20  time zone is in 
+00023260: 6566 6665 6374 2c0a 2020 2020 7468 6520  effect,.    the 
+00023270: 6675 6e63 7469 6f6e 2063 616e 2062 6520  function can be 
+00023280: 7573 6564 2074 6f20 6372 6561 7465 2061  used to create a
+00023290: 2074 696d 6573 7461 6d70 2066 726f 6d20   timestamp from 
+000232a0: 6120 6461 7465 2065 7870 7265 7373 696f  a date expressio
+000232b0: 6e20 616e 6420 6120 7469 6d65 2065 7870  n and a time exp
+000232c0: 7265 7373 696f 6e2e 0a0a 2020 2020 4578  ression...    Ex
+000232d0: 616d 706c 6520 313a 3a0a 0a20 2020 2020  ample 1::..     
+000232e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000232f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00023300: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00023310: 2e20 2020 2020 5b5b 3230 3232 2c20 342c  .     [[2022, 4,
+00023320: 2031 2c20 3131 2c20 3131 2c20 305d 2c20   1, 11, 11, 0], 
+00023330: 5b32 3032 322c 2033 2c20 3331 2c20 3131  [2022, 3, 31, 11
+00023340: 2c20 3131 2c20 305d 5d2c 0a20 2020 2020  , 11, 0]],.     
+00023350: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
+00023360: 613d 5b22 7965 6172 222c 2022 6d6f 6e74  a=["year", "mont
+00023370: 6822 2c20 2264 6179 222c 2022 686f 7572  h", "day", "hour
+00023380: 222c 2022 6d69 6e75 7465 222c 2022 7365  ", "minute", "se
+00023390: 636f 6e64 225d 2c0a 2020 2020 2020 2020  cond"],.        
+000233a0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+000233b0: 3e20 6466 2e73 656c 6563 7428 7469 6d65  > df.select(time
+000233c0: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
+000233d0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+000233e0: 2020 2279 6561 7222 2c20 226d 6f6e 7468    "year", "month
+000233f0: 222c 2022 6461 7922 2c20 2268 6f75 7222  ", "day", "hour"
+00023400: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
+00023410: 6f6e 6422 0a20 2020 2020 2020 202e 2e2e  ond".        ...
+00023420: 2029 2e61 6c69 6173 2822 5449 4d45 5354   ).alias("TIMEST
+00023430: 414d 505f 4652 4f4d 5f50 4152 5453 2229  AMP_FROM_PARTS")
+00023440: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00023450: 2020 2020 5b52 6f77 2854 494d 4553 5441      [Row(TIMESTA
+00023460: 4d50 5f46 524f 4d5f 5041 5254 533d 6461  MP_FROM_PARTS=da
+00023470: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+00023480: 3230 3232 2c20 342c 2031 2c20 3131 2c20  2022, 4, 1, 11, 
+00023490: 3131 2929 2c20 526f 7728 5449 4d45 5354  11)), Row(TIMEST
+000234a0: 414d 505f 4652 4f4d 5f50 4152 5453 3d64  AMP_FROM_PARTS=d
+000234b0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+000234c0: 2832 3032 322c 2033 2c20 3331 2c20 3131  (2022, 3, 31, 11
+000234d0: 2c20 3131 2929 5d0a 0a20 2020 2045 7861  , 11))]..    Exa
+000234e0: 6d70 6c65 2032 3a3a 0a0a 2020 2020 2020  mple 2::..      
+000234f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00023500: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00023510: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+00023520: 2020 2020 205b 5b27 3230 3232 2d30 342d       [['2022-04-
+00023530: 3031 272c 2027 3131 3a31 313a 3030 275d  01', '11:11:00']
+00023540: 2c20 5b27 3230 3232 2d30 332d 3331 272c  , ['2022-03-31',
+00023550: 2027 3131 3a31 313a 3030 275d 5d2c 0a20   '11:11:00']],. 
+00023560: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+00023570: 6368 656d 613d 5b22 6461 7465 222c 2022  chema=["date", "
+00023580: 7469 6d65 225d 0a20 2020 2020 2020 202e  time"].        .
+00023590: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+000235a0: 2064 662e 7365 6c65 6374 280a 2020 2020   df.select(.    
+000235b0: 2020 2020 2e2e 2e20 2020 2020 7469 6d65      ...     time
+000235c0: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
+000235d0: 2874 6f5f 6461 7465 2822 6461 7465 2229  (to_date("date")
+000235e0: 2c20 746f 5f74 696d 6528 2274 696d 6522  , to_time("time"
+000235f0: 290a 2020 2020 2020 2020 2e2e 2e20 292e  ).        ... ).
+00023600: 616c 6961 7328 2254 494d 4553 5441 4d50  alias("TIMESTAMP
+00023610: 5f46 524f 4d5f 5041 5254 5322 2929 2e63  _FROM_PARTS")).c
+00023620: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00023630: 205b 526f 7728 5449 4d45 5354 414d 505f   [Row(TIMESTAMP_
+00023640: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
+00023650: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+00023660: 322c 2034 2c20 312c 2031 312c 2031 3129  2, 4, 1, 11, 11)
+00023670: 292c 2052 6f77 2854 494d 4553 5441 4d50  ), Row(TIMESTAMP
+00023680: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
+00023690: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+000236a0: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
+000236b0: 3129 295d 0a20 2020 2022 2222 0a20 2020  1))].    """.   
+000236c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+000236d0: 2274 696d 6573 7461 6d70 5f66 726f 6d5f  "timestamp_from_
+000236e0: 7061 7274 7322 2928 0a20 2020 2020 2020  parts")(.       
+000236f0: 202a 5f74 696d 6573 7461 6d70 5f66 726f   *_timestamp_fro
+00023700: 6d5f 7061 7274 735f 696e 7465 726e 616c  m_parts_internal
+00023710: 2822 7469 6d65 7374 616d 705f 6672 6f6d  ("timestamp_from
+00023720: 5f70 6172 7473 222c 202a 6172 6773 2c20  _parts", *args, 
+00023730: 2a2a 6b77 6172 6773 290a 2020 2020 290a  **kwargs).    ).
+00023740: 0a0a 6465 6620 7469 6d65 7374 616d 705f  ..def timestamp_
+00023750: 6c74 7a5f 6672 6f6d 5f70 6172 7473 280a  ltz_from_parts(.
+00023760: 2020 2020 7965 6172 3a20 556e 696f 6e5b      year: Union[
+00023770: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+00023780: 745d 2c0a 2020 2020 6d6f 6e74 683a 2055  t],.    month: U
+00023790: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+000237a0: 652c 2069 6e74 5d2c 0a20 2020 2064 6179  e, int],.    day
+000237b0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+000237c0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
+000237d0: 686f 7572 3a20 556e 696f 6e5b 436f 6c75  hour: Union[Colu
+000237e0: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
+000237f0: 2020 2020 6d69 6e75 7465 3a20 556e 696f      minute: Unio
+00023800: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00023810: 696e 745d 2c0a 2020 2020 7365 636f 6e64  int],.    second
+00023820: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+00023830: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
+00023840: 6e61 6e6f 7365 636f 6e64 733a 204f 7074  nanoseconds: Opt
+00023850: 696f 6e61 6c5b 556e 696f 6e5b 436f 6c75  ional[Union[Colu
+00023860: 6d6e 4f72 4e61 6d65 2c20 696e 745d 5d20  mnOrName, int]] 
+00023870: 3d20 4e6f 6e65 2c0a 2920 2d3e 2043 6f6c  = None,.) -> Col
+00023880: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00023890: 2043 7265 6174 6573 2061 2074 696d 6573   Creates a times
+000238a0: 7461 6d70 2066 726f 6d20 696e 6469 7669  tamp from indivi
+000238b0: 6475 616c 206e 756d 6572 6963 2063 6f6d  dual numeric com
+000238c0: 706f 6e65 6e74 732e 0a0a 2020 2020 4578  ponents...    Ex
+000238d0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+000238e0: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
+000238f0: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
+00023900: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00023910: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00023920: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00023930: 5b5b 3230 3232 2c20 342c 2031 2c20 3131  [[2022, 4, 1, 11
+00023940: 2c20 3131 2c20 305d 2c20 5b32 3032 322c  , 11, 0], [2022,
+00023950: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
+00023960: 305d 5d2c 0a20 2020 2020 2020 202e 2e2e  0]],.        ...
+00023970: 2020 2020 2073 6368 656d 613d 5b22 7965       schema=["ye
+00023980: 6172 222c 2022 6d6f 6e74 6822 2c20 2264  ar", "month", "d
+00023990: 6179 222c 2022 686f 7572 222c 2022 6d69  ay", "hour", "mi
+000239a0: 6e75 7465 222c 2022 7365 636f 6e64 225d  nute", "second"]
+000239b0: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
+000239c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+000239d0: 656c 6563 7428 7469 6d65 7374 616d 705f  elect(timestamp_
+000239e0: 6c74 7a5f 6672 6f6d 5f70 6172 7473 280a  ltz_from_parts(.
+000239f0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00023a00: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
+00023a10: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
+00023a20: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
+00023a30: 6422 0a20 2020 2020 2020 202e 2e2e 2029  d".        ... )
+00023a40: 2e61 6c69 6173 2822 5449 4d45 5354 414d  .alias("TIMESTAM
+00023a50: 505f 4c54 5a5f 4652 4f4d 5f50 4152 5453  P_LTZ_FROM_PARTS
+00023a60: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00023a70: 2020 2020 2020 5b52 6f77 2854 494d 4553        [Row(TIMES
+00023a80: 5441 4d50 5f4c 545a 5f46 524f 4d5f 5041  TAMP_LTZ_FROM_PA
+00023a90: 5254 533d 6461 7465 7469 6d65 2e64 6174  RTS=datetime.dat
+00023aa0: 6574 696d 6528 3230 3232 2c20 342c 2031  etime(2022, 4, 1
+00023ab0: 2c20 3131 2c20 3131 2c20 747a 696e 666f  , 11, 11, tzinfo
+00023ac0: 3d3c 4473 7454 7a49 6e66 6f20 2741 6d65  =<DstTzInfo 'Ame
+00023ad0: 7269 6361 2f4c 6f73 5f41 6e67 656c 6573  rica/Los_Angeles
+00023ae0: 2720 5044 542d 3120 6461 792c 2031 373a  ' PDT-1 day, 17:
+00023af0: 3030 3a30 3020 4453 543e 2929 2c20 526f  00:00 DST>)), Ro
+00023b00: 7728 5449 4d45 5354 414d 505f 4c54 5a5f  w(TIMESTAMP_LTZ_
+00023b10: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
+00023b20: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+00023b30: 322c 2033 2c20 3331 2c20 3131 2c20 3131  2, 3, 31, 11, 11
+00023b40: 2c20 747a 696e 666f 3d3c 4473 7454 7a49  , tzinfo=<DstTzI
+00023b50: 6e66 6f20 2741 6d65 7269 6361 2f4c 6f73  nfo 'America/Los
+00023b60: 5f41 6e67 656c 6573 2720 5044 542d 3120  _Angeles' PDT-1 
+00023b70: 6461 792c 2031 373a 3030 3a30 3020 4453  day, 17:00:00 DS
+00023b80: 543e 2929 5d0a 2020 2020 2222 220a 2020  T>))].    """.  
+00023b90: 2020 6675 6e63 5f6e 616d 6520 3d20 2274    func_name = "t
+00023ba0: 696d 6573 7461 6d70 5f6c 747a 5f66 726f  imestamp_ltz_fro
+00023bb0: 6d5f 7061 7274 7322 0a20 2020 2079 2c20  m_parts".    y, 
+00023bc0: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
+00023bd0: 203d 205f 636f 6c75 6d6e 735f 6672 6f6d   = _columns_from
+00023be0: 5f74 696d 6573 7461 6d70 5f70 6172 7473  _timestamp_parts
+00023bf0: 280a 2020 2020 2020 2020 6675 6e63 5f6e  (.        func_n
+00023c00: 616d 652c 2079 6561 722c 206d 6f6e 7468  ame, year, month
+00023c10: 2c20 6461 792c 2068 6f75 722c 206d 696e  , day, hour, min
+00023c20: 7574 652c 2073 6563 6f6e 640a 2020 2020  ute, second.    
+00023c30: 290a 2020 2020 6e73 203d 204e 6f6e 6520  ).    ns = None 
+00023c40: 6966 206e 616e 6f73 6563 6f6e 6473 2069  if nanoseconds i
+00023c50: 7320 4e6f 6e65 2065 6c73 6520 5f74 6f5f  s None else _to_
+00023c60: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
+00023c70: 7428 6e61 6e6f 7365 636f 6e64 732c 2066  t(nanoseconds, f
+00023c80: 756e 635f 6e61 6d65 290a 2020 2020 7265  unc_name).    re
+00023c90: 7475 726e 2028 0a20 2020 2020 2020 2062  turn (.        b
+00023ca0: 7569 6c74 696e 2866 756e 635f 6e61 6d65  uiltin(func_name
+00023cb0: 2928 792c 206d 2c20 642c 2068 2c20 6d69  )(y, m, d, h, mi
+00023cc0: 6e5f 2c20 7329 0a20 2020 2020 2020 2069  n_, s).        i
+00023cd0: 6620 6e73 2069 7320 4e6f 6e65 0a20 2020  f ns is None.   
+00023ce0: 2020 2020 2065 6c73 6520 6275 696c 7469       else builti
+00023cf0: 6e28 6675 6e63 5f6e 616d 6529 2879 2c20  n(func_name)(y, 
+00023d00: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
+00023d10: 2c20 6e73 290a 2020 2020 290a 0a0a 406f  , ns).    )...@o
+00023d20: 7665 726c 6f61 640a 6465 6620 7469 6d65  verload.def time
+00023d30: 7374 616d 705f 6e74 7a5f 6672 6f6d 5f70  stamp_ntz_from_p
+00023d40: 6172 7473 280a 2020 2020 6461 7465 5f65  arts(.    date_e
+00023d50: 7870 723a 2043 6f6c 756d 6e4f 724e 616d  xpr: ColumnOrNam
+00023d60: 652c 2074 696d 655f 6578 7072 3a20 436f  e, time_expr: Co
+00023d70: 6c75 6d6e 4f72 4e61 6d65 0a29 202d 3e20  lumnOrName.) -> 
+00023d80: 436f 6c75 6d6e 3a0a 2020 2020 2e2e 2e20  Column:.    ... 
+00023d90: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
+00023da0: 7665 720a 0a0a 406f 7665 726c 6f61 640a  ver...@overload.
+00023db0: 6465 6620 7469 6d65 7374 616d 705f 6e74  def timestamp_nt
+00023dc0: 7a5f 6672 6f6d 5f70 6172 7473 280a 2020  z_from_parts(.  
+00023dd0: 2020 7965 6172 3a20 556e 696f 6e5b 436f    year: Union[Co
+00023de0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00023df0: 2c0a 2020 2020 6d6f 6e74 683a 2055 6e69  ,.    month: Uni
+00023e00: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00023e10: 2069 6e74 5d2c 0a20 2020 2064 6179 3a20   int],.    day: 
+00023e20: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00023e30: 6d65 2c20 696e 745d 2c0a 2020 2020 686f  me, int],.    ho
+00023e40: 7572 3a20 556e 696f 6e5b 436f 6c75 6d6e  ur: Union[Column
+00023e50: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
+00023e60: 2020 6d69 6e75 7465 3a20 556e 696f 6e5b    minute: Union[
+00023e70: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+00023e80: 745d 2c0a 2020 2020 7365 636f 6e64 3a20  t],.    second: 
+00023e90: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00023ea0: 6d65 2c20 696e 745d 2c0a 2020 2020 6e61  me, int],.    na
+00023eb0: 6e6f 7365 636f 6e64 3a20 4f70 7469 6f6e  nosecond: Option
+00023ec0: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f  al[Union[ColumnO
+00023ed0: 724e 616d 652c 2069 6e74 5d5d 203d 204e  rName, int]] = N
+00023ee0: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
+00023ef0: 3a0a 2020 2020 2e2e 2e20 2023 2070 7261  :.    ...  # pra
+00023f00: 676d 613a 206e 6f20 636f 7665 720a 0a0a  gma: no cover...
+00023f10: 6465 6620 7469 6d65 7374 616d 705f 6e74  def timestamp_nt
+00023f20: 7a5f 6672 6f6d 5f70 6172 7473 282a 6172  z_from_parts(*ar
+00023f30: 6773 2c20 2a2a 6b77 6172 6773 2920 2d3e  gs, **kwargs) ->
+00023f40: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00023f50: 0a20 2020 2043 7265 6174 6573 2061 2074  .    Creates a t
+00023f60: 696d 6573 7461 6d70 2066 726f 6d20 696e  imestamp from in
+00023f70: 6469 7669 6475 616c 206e 756d 6572 6963  dividual numeric
+00023f80: 2063 6f6d 706f 6e65 6e74 732e 2054 6865   components. The
+00023f90: 2066 756e 6374 696f 6e20 6361 6e20 6265   function can be
+00023fa0: 2075 7365 6420 746f 0a20 2020 2063 7265   used to.    cre
+00023fb0: 6174 6520 6120 7469 6d65 7374 616d 7020  ate a timestamp 
+00023fc0: 6672 6f6d 2061 2064 6174 6520 6578 7072  from a date expr
+00023fd0: 6573 7369 6f6e 2061 6e64 2061 2074 696d  ession and a tim
+00023fe0: 6520 6578 7072 6573 7369 6f6e 2e0a 0a20  e expression... 
+00023ff0: 2020 2045 7861 6d70 6c65 2031 3a3a 0a0a     Example 1::..
+00024000: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00024010: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00024020: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+00024030: 2020 202e 2e2e 2020 2020 205b 5b32 3032     ...     [[202
+00024040: 322c 2034 2c20 312c 2031 312c 2031 312c  2, 4, 1, 11, 11,
+00024050: 2030 5d2c 205b 3230 3232 2c20 332c 2033   0], [2022, 3, 3
+00024060: 312c 2031 312c 2031 312c 2030 5d5d 2c0a  1, 11, 11, 0]],.
+00024070: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00024080: 7363 6865 6d61 3d5b 2279 6561 7222 2c20  schema=["year", 
+00024090: 226d 6f6e 7468 222c 2022 6461 7922 2c20  "month", "day", 
+000240a0: 2268 6f75 7222 2c20 226d 696e 7574 6522  "hour", "minute"
+000240b0: 2c20 2273 6563 6f6e 6422 5d2c 0a20 2020  , "second"],.   
+000240c0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+000240d0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000240e0: 2874 696d 6573 7461 6d70 5f6e 747a 5f66  (timestamp_ntz_f
+000240f0: 726f 6d5f 7061 7274 7328 0a20 2020 2020  rom_parts(.     
+00024100: 2020 202e 2e2e 2020 2020 2022 7965 6172     ...     "year
+00024110: 222c 2022 6d6f 6e74 6822 2c20 2264 6179  ", "month", "day
+00024120: 222c 2022 686f 7572 222c 2022 6d69 6e75  ", "hour", "minu
+00024130: 7465 222c 2022 7365 636f 6e64 220a 2020  te", "second".  
+00024140: 2020 2020 2020 2e2e 2e20 292e 616c 6961        ... ).alia
+00024150: 7328 2254 494d 4553 5441 4d50 5f4e 545a  s("TIMESTAMP_NTZ
+00024160: 5f46 524f 4d5f 5041 5254 5322 2929 2e63  _FROM_PARTS")).c
+00024170: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00024180: 205b 526f 7728 5449 4d45 5354 414d 505f   [Row(TIMESTAMP_
+00024190: 4e54 5a5f 4652 4f4d 5f50 4152 5453 3d64  NTZ_FROM_PARTS=d
+000241a0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+000241b0: 2832 3032 322c 2034 2c20 312c 2031 312c  (2022, 4, 1, 11,
+000241c0: 2031 3129 292c 2052 6f77 2854 494d 4553   11)), Row(TIMES
+000241d0: 5441 4d50 5f4e 545a 5f46 524f 4d5f 5041  TAMP_NTZ_FROM_PA
+000241e0: 5254 533d 6461 7465 7469 6d65 2e64 6174  RTS=datetime.dat
+000241f0: 6574 696d 6528 3230 3232 2c20 332c 2033  etime(2022, 3, 3
+00024200: 312c 2031 312c 2031 3129 295d 0a0a 2020  1, 11, 11))]..  
+00024210: 2020 4578 616d 706c 6520 323a 3a0a 0a20    Example 2::.. 
+00024220: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00024230: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00024240: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
+00024250: 2020 2e2e 2e20 2020 2020 5b5b 2732 3032    ...     [['202
+00024260: 322d 3034 2d30 3127 2c20 2731 313a 3131  2-04-01', '11:11
+00024270: 3a30 3027 5d2c 205b 2732 3032 322d 3033  :00'], ['2022-03
+00024280: 2d33 3127 2c20 2731 313a 3131 3a30 3027  -31', '11:11:00'
+00024290: 5d5d 2c0a 2020 2020 2020 2020 2e2e 2e20  ]],.        ... 
+000242a0: 2020 2020 7363 6865 6d61 3d5b 2264 6174      schema=["dat
+000242b0: 6522 2c20 2274 696d 6522 5d0a 2020 2020  e", "time"].    
+000242c0: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
+000242d0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000242e0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+000242f0: 2074 696d 6573 7461 6d70 5f6e 747a 5f66   timestamp_ntz_f
+00024300: 726f 6d5f 7061 7274 7328 746f 5f64 6174  rom_parts(to_dat
+00024310: 6528 2264 6174 6522 292c 2074 6f5f 7469  e("date"), to_ti
+00024320: 6d65 2822 7469 6d65 2229 0a20 2020 2020  me("time").     
+00024330: 2020 202e 2e2e 2029 2e61 6c69 6173 2822     ... ).alias("
+00024340: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
+00024350: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
+00024360: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00024370: 6f77 2854 494d 4553 5441 4d50 5f4e 545a  ow(TIMESTAMP_NTZ
+00024380: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
+00024390: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+000243a0: 3232 2c20 342c 2031 2c20 3131 2c20 3131  22, 4, 1, 11, 11
+000243b0: 2929 2c20 526f 7728 5449 4d45 5354 414d  )), Row(TIMESTAM
+000243c0: 505f 4e54 5a5f 4652 4f4d 5f50 4152 5453  P_NTZ_FROM_PARTS
+000243d0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
+000243e0: 6d65 2832 3032 322c 2033 2c20 3331 2c20  me(2022, 3, 31, 
+000243f0: 3131 2c20 3131 2929 5d0a 2020 2020 2222  11, 11))].    ""
+00024400: 220a 2020 2020 7265 7475 726e 2062 7569  ".    return bui
+00024410: 6c74 696e 2822 7469 6d65 7374 616d 705f  ltin("timestamp_
+00024420: 6e74 7a5f 6672 6f6d 5f70 6172 7473 2229  ntz_from_parts")
+00024430: 280a 2020 2020 2020 2020 2a5f 7469 6d65  (.        *_time
+00024440: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
+00024450: 5f69 6e74 6572 6e61 6c28 2274 696d 6573  _internal("times
+00024460: 7461 6d70 5f6e 747a 5f66 726f 6d5f 7061  tamp_ntz_from_pa
+00024470: 7274 7322 2c20 2a61 7267 732c 202a 2a6b  rts", *args, **k
+00024480: 7761 7267 7329 0a20 2020 2029 0a0a 0a64  wargs).    )...d
+00024490: 6566 2074 696d 6573 7461 6d70 5f74 7a5f  ef timestamp_tz_
+000244a0: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
+000244b0: 7965 6172 3a20 556e 696f 6e5b 436f 6c75  year: Union[Colu
+000244c0: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
+000244d0: 2020 2020 6d6f 6e74 683a 2055 6e69 6f6e      month: Union
+000244e0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+000244f0: 6e74 5d2c 0a20 2020 2064 6179 3a20 556e  nt],.    day: Un
+00024500: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+00024510: 2c20 696e 745d 2c0a 2020 2020 686f 7572  , int],.    hour
+00024520: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+00024530: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
+00024540: 6d69 6e75 7465 3a20 556e 696f 6e5b 436f  minute: Union[Co
+00024550: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00024560: 2c0a 2020 2020 7365 636f 6e64 3a20 556e  ,.    second: Un
+00024570: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+00024580: 2c20 696e 745d 2c0a 2020 2020 6e61 6e6f  , int],.    nano
+00024590: 7365 636f 6e64 733a 204f 7074 696f 6e61  seconds: Optiona
+000245a0: 6c5b 556e 696f 6e5b 436f 6c75 6d6e 4f72  l[Union[ColumnOr
+000245b0: 4e61 6d65 2c20 696e 745d 5d20 3d20 4e6f  Name, int]] = No
+000245c0: 6e65 2c0a 2020 2020 7469 6d65 7a6f 6e65  ne,.    timezone
+000245d0: 3a20 4f70 7469 6f6e 616c 5b43 6f6c 756d  : Optional[Colum
+000245e0: 6e4f 724c 6974 6572 616c 5374 725d 203d  nOrLiteralStr] =
+000245f0: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
+00024600: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00024610: 4372 6561 7465 7320 6120 7469 6d65 7374  Creates a timest
+00024620: 616d 7020 6672 6f6d 2069 6e64 6976 6964  amp from individ
+00024630: 7561 6c20 6e75 6d65 7269 6320 636f 6d70  ual numeric comp
+00024640: 6f6e 656e 7473 2061 6e64 2061 2073 7472  onents and a str
+00024650: 696e 6720 7469 6d65 7a6f 6e65 2e0a 0a20  ing timezone... 
+00024660: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00024670: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00024680: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00024690: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+000246a0: 202e 2e2e 2020 2020 205b 5b32 3032 322c   ...     [[2022,
+000246b0: 2034 2c20 312c 2031 312c 2031 312c 2030   4, 1, 11, 11, 0
+000246c0: 2c20 2741 6d65 7269 6361 2f4c 6f73 5f41  , 'America/Los_A
+000246d0: 6e67 656c 6573 275d 2c20 5b32 3032 322c  ngeles'], [2022,
+000246e0: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
+000246f0: 302c 2027 416d 6572 6963 612f 4c6f 735f  0, 'America/Los_
+00024700: 416e 6765 6c65 7327 5d5d 2c0a 2020 2020  Angeles']],.    
+00024710: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+00024720: 6d61 3d5b 2279 6561 7222 2c20 226d 6f6e  ma=["year", "mon
+00024730: 7468 222c 2022 6461 7922 2c20 2268 6f75  th", "day", "hou
+00024740: 7222 2c20 226d 696e 7574 6522 2c20 2273  r", "minute", "s
+00024750: 6563 6f6e 6422 2c20 2274 696d 657a 6f6e  econd", "timezon
+00024760: 6522 5d2c 0a20 2020 2020 2020 202e 2e2e  e"],.        ...
+00024770: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+00024780: 662e 7365 6c65 6374 2874 696d 6573 7461  f.select(timesta
+00024790: 6d70 5f74 7a5f 6672 6f6d 5f70 6172 7473  mp_tz_from_parts
+000247a0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+000247b0: 2020 2279 6561 7222 2c20 226d 6f6e 7468    "year", "month
+000247c0: 222c 2022 6461 7922 2c20 2268 6f75 7222  ", "day", "hour"
+000247d0: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
+000247e0: 6f6e 6422 2c20 7469 6d65 7a6f 6e65 3d22  ond", timezone="
+000247f0: 7469 6d65 7a6f 6e65 220a 2020 2020 2020  timezone".      
+00024800: 2020 2e2e 2e20 292e 616c 6961 7328 2254    ... ).alias("T
+00024810: 494d 4553 5441 4d50 5f54 5a5f 4652 4f4d  IMESTAMP_TZ_FROM
+00024820: 5f50 4152 5453 2229 292e 636f 6c6c 6563  _PARTS")).collec
+00024830: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00024840: 2854 494d 4553 5441 4d50 5f54 5a5f 4652  (TIMESTAMP_TZ_FR
+00024850: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
+00024860: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
+00024870: 2034 2c20 312c 2031 312c 2031 312c 2074   4, 1, 11, 11, t
+00024880: 7a69 6e66 6f3d 7079 747a 2e46 6978 6564  zinfo=pytz.Fixed
+00024890: 4f66 6673 6574 282d 3432 3029 2929 2c20  Offset(-420))), 
+000248a0: 526f 7728 5449 4d45 5354 414d 505f 545a  Row(TIMESTAMP_TZ
+000248b0: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
+000248c0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+000248d0: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
+000248e0: 312c 2074 7a69 6e66 6f3d 7079 747a 2e46  1, tzinfo=pytz.F
+000248f0: 6978 6564 4f66 6673 6574 282d 3432 3029  ixedOffset(-420)
+00024900: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+00024910: 6675 6e63 5f6e 616d 6520 3d20 2274 696d  func_name = "tim
+00024920: 6573 7461 6d70 5f74 7a5f 6672 6f6d 5f70  estamp_tz_from_p
+00024930: 6172 7473 220a 2020 2020 792c 206d 2c20  arts".    y, m, 
+00024940: 642c 2068 2c20 6d69 6e5f 2c20 7320 3d20  d, h, min_, s = 
+00024950: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
+00024960: 6d65 7374 616d 705f 7061 7274 7328 0a20  mestamp_parts(. 
+00024970: 2020 2020 2020 2066 756e 635f 6e61 6d65         func_name
+00024980: 2c20 7965 6172 2c20 6d6f 6e74 682c 2064  , year, month, d
+00024990: 6179 2c20 686f 7572 2c20 6d69 6e75 7465  ay, hour, minute
+000249a0: 2c20 7365 636f 6e64 0a20 2020 2029 0a20  , second.    ). 
+000249b0: 2020 206e 7320 3d20 4e6f 6e65 2069 6620     ns = None if 
+000249c0: 6e61 6e6f 7365 636f 6e64 7320 6973 204e  nanoseconds is N
+000249d0: 6f6e 6520 656c 7365 205f 746f 5f63 6f6c  one else _to_col
+000249e0: 5f69 665f 7374 725f 6f72 5f69 6e74 286e  _if_str_or_int(n
+000249f0: 616e 6f73 6563 6f6e 6473 2c20 6675 6e63  anoseconds, func
+00024a00: 5f6e 616d 6529 0a20 2020 2074 7a20 3d20  _name).    tz = 
+00024a10: 4e6f 6e65 2069 6620 7469 6d65 7a6f 6e65  None if timezone
+00024a20: 2069 7320 4e6f 6e65 2065 6c73 6520 5f74   is None else _t
+00024a30: 6f5f 636f 6c5f 6966 5f73 716c 5f65 7870  o_col_if_sql_exp
+00024a40: 7228 7469 6d65 7a6f 6e65 2c20 6675 6e63  r(timezone, func
+00024a50: 5f6e 616d 6529 0a20 2020 2069 6620 6e61  _name).    if na
+00024a60: 6e6f 7365 636f 6e64 7320 6973 206e 6f74  noseconds is not
+00024a70: 204e 6f6e 6520 616e 6420 7469 6d65 7a6f   None and timezo
+00024a80: 6e65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ne is not None:.
+00024a90: 2020 2020 2020 2020 7265 7475 726e 2062          return b
+00024aa0: 7569 6c74 696e 2866 756e 635f 6e61 6d65  uiltin(func_name
+00024ab0: 2928 792c 206d 2c20 642c 2068 2c20 6d69  )(y, m, d, h, mi
+00024ac0: 6e5f 2c20 732c 206e 732c 2074 7a29 0a20  n_, s, ns, tz). 
+00024ad0: 2020 2065 6c69 6620 6e61 6e6f 7365 636f     elif nanoseco
+00024ae0: 6e64 7320 6973 206e 6f74 204e 6f6e 653a  nds is not None:
+00024af0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024b00: 6275 696c 7469 6e28 6675 6e63 5f6e 616d  builtin(func_nam
+00024b10: 6529 2879 2c20 6d2c 2064 2c20 682c 206d  e)(y, m, d, h, m
+00024b20: 696e 5f2c 2073 2c20 6e73 290a 2020 2020  in_, s, ns).    
+00024b30: 656c 6966 2074 696d 657a 6f6e 6520 6973  elif timezone is
+00024b40: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00024b50: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00024b60: 6e28 6675 6e63 5f6e 616d 6529 2879 2c20  n(func_name)(y, 
+00024b70: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
+00024b80: 2c20 6c69 7428 3029 2c20 747a 290a 2020  , lit(0), tz).  
+00024b90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00024ba0: 7265 7475 726e 2062 7569 6c74 696e 2866  return builtin(f
+00024bb0: 756e 635f 6e61 6d65 2928 792c 206d 2c20  unc_name)(y, m, 
+00024bc0: 642c 2068 2c20 6d69 6e5f 2c20 7329 0a0a  d, h, min_, s)..
+00024bd0: 0a64 6566 2077 6565 6b6f 6679 6561 7228  .def weekofyear(
+00024be0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+00024bf0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00024c00: 2222 220a 2020 2020 4578 7472 6163 7473  """.    Extracts
+00024c10: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
+00024c20: 6e67 2077 6565 6b20 286e 756d 6265 7229  ng week (number)
+00024c30: 206f 6620 7468 6520 7965 6172 2066 726f   of the year fro
+00024c40: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
+00024c50: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
+00024c60: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00024c70: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00024c80: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+00024c90: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00024ca0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+00024cb0: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
+00024cc0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00024cd0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+00024ce0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+00024cf0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+00024d00: 2548 3a25 4d3a 2553 2e25 6622 295d 5d2c  %H:%M:%S.%f")]],
+00024d10: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00024d20: 2073 6368 656d 613d 5b22 6122 5d2c 0a20   schema=["a"],. 
+00024d30: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00024d40: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00024d50: 6374 2877 6565 6b6f 6679 6561 7228 2261  ct(weekofyear("a
+00024d60: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00024d70: 2020 2020 2020 5b52 6f77 2857 4545 4b4f        [Row(WEEKO
+00024d80: 4659 4541 5228 2241 2229 3d31 3829 5d0a  FYEAR("A")=18)].
+00024d90: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00024da0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+00024db0: 2c20 2277 6565 6b6f 6679 6561 7222 290a  , "weekofyear").
+00024dc0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00024dd0: 696e 2822 7765 656b 6f66 7965 6172 2229  in("weekofyear")
+00024de0: 2863 290a 0a0a 6465 6620 7479 7065 6f66  (c)...def typeof
+00024df0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
+00024e00: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00024e10: 2020 2022 2222 5265 706f 7274 7320 7468     """Reports th
+00024e20: 6520 7479 7065 206f 6620 6120 7661 6c75  e type of a valu
+00024e30: 6520 7374 6f72 6564 2069 6e20 6120 5641  e stored in a VA
+00024e40: 5249 414e 5420 636f 6c75 6d6e 2e20 5468  RIANT column. Th
+00024e50: 6520 7479 7065 2069 7320 7265 7475 726e  e type is return
+00024e60: 6564 2061 7320 6120 7374 7269 6e67 2e0a  ed as a string..
+00024e70: 0a20 2020 2046 6f72 2063 6f6c 756d 6e73  .    For columns
+00024e80: 2077 6865 7265 2061 6c6c 2072 6f77 7320   where all rows 
+00024e90: 7368 6172 6520 7468 6520 7361 6d65 2074  share the same t
+00024ea0: 7970 652c 2074 6865 2072 6573 756c 7420  ype, the result 
+00024eb0: 6f66 2060 7479 7065 6f66 6020 6973 2074  of `typeof` is t
+00024ec0: 6865 2075 6e64 6572 6c79 696e 6720 536e  he underlying Sn
+00024ed0: 6f77 666c 616b 6520 636f 6c75 6d6e 2074  owflake column t
+00024ee0: 7970 652e 0a0a 2020 2020 4578 616d 706c  ype...    Exampl
+00024ef0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00024f00: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00024f10: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00024f20: 312c 2032 2c20 335d 2c20 7363 6865 6d61  1, 2, 3], schema
+00024f30: 3d5b 2241 225d 290a 2020 2020 2020 2020  =["A"]).        
+00024f40: 3e3e 3e20 6466 2e73 656c 6563 7428 7479  >>> df.select(ty
+00024f50: 7065 6f66 2863 6f6c 2822 4122 2929 2e61  peof(col("A")).a
+00024f60: 735f 2822 616e 7322 2929 2e63 6f6c 6c65  s_("ans")).colle
+00024f70: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00024f80: 7728 414e 533d 2749 4e54 4547 4552 2729  w(ANS='INTEGER')
+00024f90: 2c20 526f 7728 414e 533d 2749 4e54 4547  , Row(ANS='INTEG
+00024fa0: 4552 2729 2c20 526f 7728 414e 533d 2749  ER'), Row(ANS='I
+00024fb0: 4e54 4547 4552 2729 5d0a 0a20 2020 2046  NTEGER')]..    F
+00024fc0: 6f72 2063 6f6c 756d 6e73 206f 6620 5641  or columns of VA
+00024fd0: 5249 414e 5420 7479 7065 2c20 7468 6520  RIANT type, the 
+00024fe0: 756e 6465 726c 7969 6e67 2073 746f 7265  underlying store
+00024ff0: 6420 7479 7065 2069 7320 7265 7475 726e  d type is return
+00025000: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
+00025010: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00025020: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00025030: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+00025040: 706f 7274 2056 6172 6961 6e74 5479 7065  port VariantType
+00025050: 2c20 5374 7275 6374 5479 7065 2c20 5374  , StructType, St
+00025060: 7275 6374 4669 656c 640a 2020 2020 2020  ructField.      
+00025070: 2020 3e3e 3e20 7363 6865 6d61 203d 2053    >>> schema = S
+00025080: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
+00025090: 7446 6965 6c64 2822 4122 2c20 5661 7269  tField("A", Vari
+000250a0: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
+000250b0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000250c0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000250d0: 6166 7261 6d65 285b 312c 2033 2e31 2c20  aframe([1, 3.1, 
+000250e0: 2774 6573 7427 5d2c 2073 6368 656d 613d  'test'], schema=
+000250f0: 7363 6865 6d61 290a 2020 2020 2020 2020  schema).        
+00025100: 3e3e 3e20 6466 2e73 656c 6563 7428 7479  >>> df.select(ty
+00025110: 7065 6f66 2863 6f6c 2822 4122 2929 2e61  peof(col("A")).a
+00025120: 735f 2822 616e 7322 2929 2e63 6f6c 6c65  s_("ans")).colle
+00025130: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00025140: 7728 414e 533d 2749 4e54 4547 4552 2729  w(ANS='INTEGER')
+00025150: 2c20 526f 7728 414e 533d 2744 4543 494d  , Row(ANS='DECIM
+00025160: 414c 2729 2c20 526f 7728 414e 533d 2756  AL'), Row(ANS='V
+00025170: 4152 4348 4152 2729 5d0a 0a20 2020 2022  ARCHAR')]..    "
+00025180: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00025190: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+000251a0: 7479 7065 6f66 2229 0a20 2020 2072 6574  typeof").    ret
+000251b0: 7572 6e20 6275 696c 7469 6e28 2274 7970  urn builtin("typ
+000251c0: 656f 6622 2928 6329 0a0a 0a64 6566 2063  eof")(c)...def c
+000251d0: 6865 636b 5f6a 736f 6e28 636f 6c3a 2043  heck_json(col: C
+000251e0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+000251f0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+00025200: 6865 636b 7320 7468 6520 7661 6c69 6469  hecks the validi
+00025210: 7479 206f 6620 6120 4a53 4f4e 2064 6f63  ty of a JSON doc
+00025220: 756d 656e 742e 0a20 2020 2049 6620 7468  ument..    If th
+00025230: 6520 696e 7075 7420 7374 7269 6e67 2069  e input string i
+00025240: 7320 6120 7661 6c69 6420 4a53 4f4e 2064  s a valid JSON d
+00025250: 6f63 756d 656e 7420 6f72 2061 204e 554c  ocument or a NUL
+00025260: 4c20 2869 2e65 2e20 6e6f 2065 7272 6f72  L (i.e. no error
+00025270: 2077 6f75 6c64 206f 6363 7572 2077 6865   would occur whe
+00025280: 6e0a 2020 2020 7061 7273 696e 6720 7468  n.    parsing th
+00025290: 6520 696e 7075 7420 7374 7269 6e67 292c  e input string),
+000252a0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
+000252b0: 7475 726e 7320 4e55 4c4c 2e0a 2020 2020  turns NULL..    
+000252c0: 496e 2063 6173 6520 6f66 2061 204a 534f  In case of a JSO
+000252d0: 4e20 7061 7273 696e 6720 6572 726f 722c  N parsing error,
+000252e0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
+000252f0: 7475 726e 7320 6120 7374 7269 6e67 2074  turns a string t
+00025300: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
+00025310: 2065 7272 6f72 0a20 2020 206d 6573 7361   error.    messa
+00025320: 6765 2e0a 0a20 2020 2045 7861 6d70 6c65  ge...    Example
+00025330: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00025340: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00025350: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
+00025360: 7b27 5661 6c69 644b 6579 3127 3a20 2756  {'ValidKey1': 'V
+00025370: 616c 6964 5661 6c75 6531 277d 222c 2022  alidValue1'}", "
+00025380: 7b27 4d61 6c66 6f72 6d65 6420 2d2d 206d  {'Malformed -- m
+00025390: 6973 7369 6e67 2076 616c 273a 7d22 2c20  issing val':}", 
+000253a0: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b27  None], schema=['
+000253b0: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
+000253c0: 2064 662e 7365 6c65 6374 2863 6865 636b   df.select(check
+000253d0: 5f6a 736f 6e28 6466 2e61 2929 2e73 686f  _json(df.a)).sho
+000253e0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+000253f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00025400: 2d2d 2d0a 2020 2020 2020 2020 7c22 4348  ---.        |"CH
+00025410: 4543 4b5f 4a53 4f4e 2822 2241 2222 2922  ECK_JSON(""A"")"
+00025420: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00025430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00025440: 2d2d 2d0a 2020 2020 2020 2020 7c4e 554c  ---.        |NUL
+00025450: 4c20 2020 2020 2020 2020 2020 2020 2020  L               
+00025460: 2020 7c0a 2020 2020 2020 2020 7c6d 6973    |.        |mis
+00025470: 706c 6163 6564 207d 2c20 706f 7320 3239  placed }, pos 29
+00025480: 2020 7c0a 2020 2020 2020 2020 7c4e 554c    |.        |NUL
+00025490: 4c20 2020 2020 2020 2020 2020 2020 2020  L               
+000254a0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000254b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000254c0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+000254d0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+000254e0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+000254f0: 6966 5f73 7472 2863 6f6c 2c20 2263 6865  if_str(col, "che
+00025500: 636b 5f6a 736f 6e22 290a 2020 2020 7265  ck_json").    re
+00025510: 7475 726e 2062 7569 6c74 696e 2822 6368  turn builtin("ch
+00025520: 6563 6b5f 6a73 6f6e 2229 2863 290a 0a0a  eck_json")(c)...
+00025530: 6465 6620 6368 6563 6b5f 786d 6c28 636f  def check_xml(co
+00025540: 6c3a 2043 6f6c 756d 6e4f 724e 616d 6529  l: ColumnOrName)
+00025550: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00025560: 2222 2243 6865 636b 7320 7468 6520 7661  """Checks the va
+00025570: 6c69 6469 7479 206f 6620 616e 2058 4d4c  lidity of an XML
+00025580: 2064 6f63 756d 656e 742e 0a20 2020 2049   document..    I
+00025590: 6620 7468 6520 696e 7075 7420 7374 7269  f the input stri
+000255a0: 6e67 2069 7320 6120 7661 6c69 6420 584d  ng is a valid XM
+000255b0: 4c20 646f 6375 6d65 6e74 206f 7220 6120  L document or a 
+000255c0: 4e55 4c4c 2028 692e 652e 206e 6f20 6572  NULL (i.e. no er
+000255d0: 726f 7220 776f 756c 6420 6f63 6375 7220  ror would occur 
+000255e0: 7768 656e 2070 6172 7369 6e67 0a20 2020  when parsing.   
+000255f0: 2074 6865 2069 6e70 7574 2073 7472 696e   the input strin
+00025600: 6729 2c20 7468 6520 6675 6e63 7469 6f6e  g), the function
+00025610: 2072 6574 7572 6e73 204e 554c 4c2e 0a20   returns NULL.. 
+00025620: 2020 2049 6e20 6361 7365 206f 6620 616e     In case of an
+00025630: 2058 4d4c 2070 6172 7369 6e67 2065 7272   XML parsing err
+00025640: 6f72 2c20 7468 6520 6f75 7470 7574 2073  or, the output s
+00025650: 7472 696e 6720 636f 6e74 6169 6e73 2074  tring contains t
+00025660: 6865 2065 7272 6f72 206d 6573 7361 6765  he error message
+00025670: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00025680: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00025690: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+000256a0: 655f 6461 7461 6672 616d 6528 5b22 3c6e  e_dataframe(["<n
+000256b0: 616d 653e 2056 616c 6964 203c 2f6e 616d  ame> Valid </nam
+000256c0: 653e 222c 2022 3c6e 616d 653e 2049 6e76  e>", "<name> Inv
+000256d0: 616c 6964 203c 2f57 524f 4e47 5f43 4c4f  alid </WRONG_CLO
+000256e0: 5349 4e47 5f54 4147 3e22 2c20 4e6f 6e65  SING_TAG>", None
+000256f0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+00025700: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00025710: 7365 6c65 6374 2863 6865 636b 5f78 6d6c  select(check_xml
+00025720: 2864 662e 6129 292e 7368 6f77 2829 0a20  (df.a)).show(). 
+00025730: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00025740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00025750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00025760: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00025770: 2020 207c 2243 4845 434b 5f58 4d4c 2822     |"CHECK_XML("
+00025780: 2241 2222 2922 2020 2020 2020 2020 2020  "A"")"          
+00025790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257a0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+000257b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000257c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000257d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000257e0: 2d2d 0a20 2020 2020 2020 207c 4e55 4c4c  --.        |NULL
+000257f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025810: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+00025820: 2020 2020 2020 207c 6e6f 206f 7065 6e69         |no openi
+00025830: 6e67 2074 6167 2066 6f72 203c 2f57 524f  ng tag for </WRO
+00025840: 4e47 5f43 4c4f 5349 4e47 5f54 4147 3e2c  NG_CLOSING_TAG>,
+00025850: 2070 6f73 2033 3520 207c 0a20 2020 2020   pos 35  |.     
+00025860: 2020 207c 4e55 4c4c 2020 2020 2020 2020     |NULL        
+00025870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025890: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+000258a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000258b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000258c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000258d0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+000258e0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+000258f0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00025900: 665f 7374 7228 636f 6c2c 2022 6368 6563  f_str(col, "chec
+00025910: 6b5f 786d 6c22 290a 2020 2020 7265 7475  k_xml").    retu
+00025920: 726e 2062 7569 6c74 696e 2822 6368 6563  rn builtin("chec
+00025930: 6b5f 786d 6c22 2928 6329 0a0a 0a64 6566  k_xml")(c)...def
+00025940: 206a 736f 6e5f 6578 7472 6163 745f 7061   json_extract_pa
+00025950: 7468 5f74 6578 7428 636f 6c3a 2043 6f6c  th_text(col: Col
+00025960: 756d 6e4f 724e 616d 652c 2070 6174 683a  umnOrName, path:
+00025970: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00025980: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00025990: 220a 2020 2020 5061 7273 6573 2061 204a  ".    Parses a J
+000259a0: 534f 4e20 7374 7269 6e67 2061 6e64 2072  SON string and r
+000259b0: 6574 7572 6e73 2074 6865 2076 616c 7565  eturns the value
+000259c0: 206f 6620 616e 2065 6c65 6d65 6e74 2061   of an element a
+000259d0: 7420 6120 7370 6563 6966 6965 6420 7061  t a specified pa
+000259e0: 7468 2069 6e20 7468 6520 7265 7375 6c74  th in the result
+000259f0: 696e 670a 2020 2020 4a53 4f4e 2064 6f63  ing.    JSON doc
+00025a00: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
+00025a10: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00025a20: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+00025a30: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
+00025a40: 696f 6e73 2069 6d70 6f72 7420 6a73 6f6e  ions import json
+00025a50: 5f65 7874 7261 6374 5f70 6174 685f 7465  _extract_path_te
+00025a60: 7874 2c20 746f 5f76 6172 6961 6e74 0a20  xt, to_variant. 
+00025a70: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00025a80: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00025a90: 6174 6166 7261 6d65 285b 5b7b 2261 223a  ataframe([[{"a":
+00025aa0: 2022 666f 6f22 7d2c 2022 6122 5d2c 205b   "foo"}, "a"], [
+00025ab0: 7b22 6122 3a20 4e6f 6e65 7d2c 2022 6122  {"a": None}, "a"
+00025ac0: 5d2c 205b 7b22 6122 3a20 2266 6f6f 227d  ], [{"a": "foo"}
+00025ad0: 2c20 2262 225d 2c20 5b4e 6f6e 652c 2022  , "b"], [None, "
+00025ae0: 6122 5d5d 2c20 7363 6865 6d61 3d5b 226b  a"]], schema=["k
+00025af0: 222c 2022 7622 5d29 0a20 2020 2020 2020  ", "v"]).       
+00025b00: 203e 3e3e 2064 662e 7365 6c65 6374 286a   >>> df.select(j
+00025b10: 736f 6e5f 6578 7472 6163 745f 7061 7468  son_extract_path
+00025b20: 5f74 6578 7428 746f 5f76 6172 6961 6e74  _text(to_variant
+00025b30: 2822 6b22 292c 2022 7622 292e 6173 5f28  ("k"), "v").as_(
+00025b40: 2272 6573 2229 292e 636f 6c6c 6563 7428  "res")).collect(
+00025b50: 290a 2020 2020 2020 2020 5b52 6f77 2852  ).        [Row(R
+00025b60: 4553 3d27 666f 6f27 292c 2052 6f77 2852  ES='foo'), Row(R
+00025b70: 4553 3d4e 6f6e 6529 2c20 526f 7728 5245  ES=None), Row(RE
+00025b80: 533d 4e6f 6e65 292c 2052 6f77 2852 4553  S=None), Row(RES
+00025b90: 3d4e 6f6e 6529 5d0a 2020 2020 2222 220a  =None)].    """.
+00025ba0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00025bb0: 6966 5f73 7472 2863 6f6c 2c20 226a 736f  if_str(col, "jso
+00025bc0: 6e5f 6578 7472 6163 745f 7061 7468 5f74  n_extract_path_t
+00025bd0: 6578 7422 290a 2020 2020 7020 3d20 5f74  ext").    p = _t
+00025be0: 6f5f 636f 6c5f 6966 5f73 7472 2870 6174  o_col_if_str(pat
+00025bf0: 682c 2022 6a73 6f6e 5f65 7874 7261 6374  h, "json_extract
+00025c00: 5f70 6174 685f 7465 7874 2229 0a20 2020  _path_text").   
+00025c10: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00025c20: 226a 736f 6e5f 6578 7472 6163 745f 7061  "json_extract_pa
+00025c30: 7468 5f74 6578 7422 2928 632c 2070 290a  th_text")(c, p).
+00025c40: 0a0a 6465 6620 7061 7273 655f 6a73 6f6e  ..def parse_json
+00025c50: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00025c60: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00025c70: 2022 2222 5061 7273 6520 7468 6520 7661   """Parse the va
+00025c80: 6c75 6520 6f66 2074 6865 2073 7065 6369  lue of the speci
+00025c90: 6669 6564 2063 6f6c 756d 6e20 6173 2061  fied column as a
+00025ca0: 204a 534f 4e20 7374 7269 6e67 2061 6e64   JSON string and
+00025cb0: 2072 6574 7572 6e73 2074 6865 0a20 2020   returns the.   
+00025cc0: 2072 6573 756c 7469 6e67 204a 534f 4e20   resulting JSON 
+00025cd0: 646f 6375 6d65 6e74 2e0a 0a20 2020 2045  document...    E
+00025ce0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00025cf0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00025d00: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00025d10: 616d 6528 5b5b 277b 226b 6579 223a 2022  ame([['{"key": "
+00025d20: 3122 7d27 5d5d 2c20 7363 6865 6d61 3d5b  1"}']], schema=[
+00025d30: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00025d40: 3e20 6466 2e73 656c 6563 7428 7061 7273  > df.select(pars
+00025d50: 655f 6a73 6f6e 2864 665b 2261 225d 292e  e_json(df["a"]).
+00025d60: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00025d70: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00025d80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00025d90: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+00025da0: 5422 2020 2020 2020 7c0a 2020 2020 2020  T"      |.      
+00025db0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00025dc0: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
+00025dd0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00025de0: 2020 2020 7c20 2022 6b65 7922 3a20 2231      |  "key": "1
+00025df0: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
+00025e00: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00025e10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00025e20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00025e30: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00025e40: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00025e50: 6f6c 5f69 665f 7374 7228 652c 2022 7061  ol_if_str(e, "pa
+00025e60: 7273 655f 6a73 6f6e 2229 0a20 2020 2072  rse_json").    r
+00025e70: 6574 7572 6e20 6275 696c 7469 6e28 2270  eturn builtin("p
+00025e80: 6172 7365 5f6a 736f 6e22 2928 6329 0a0a  arse_json")(c)..
+00025e90: 0a64 6566 2070 6172 7365 5f78 6d6c 2865  .def parse_xml(e
+00025ea0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00025eb0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00025ec0: 2222 5061 7273 6520 7468 6520 7661 6c75  ""Parse the valu
+00025ed0: 6520 6f66 2074 6865 2073 7065 6369 6669  e of the specifi
+00025ee0: 6564 2063 6f6c 756d 6e20 6173 2061 204a  ed column as a J
+00025ef0: 534f 4e20 7374 7269 6e67 2061 6e64 2072  SON string and r
+00025f00: 6574 7572 6e73 2074 6865 0a20 2020 2072  eturns the.    r
+00025f10: 6573 756c 7469 6e67 2058 4d4c 2064 6f63  esulting XML doc
+00025f20: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
+00025f30: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00025f40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00025f50: 7371 6c28 0a20 2020 2020 2020 202e 2e2e  sql(.        ...
+00025f60: 2020 2020 2022 7365 6c65 6374 2028 636f       "select (co
+00025f70: 6c75 6d6e 3129 2061 7320 7620 6672 6f6d  lumn1) as v from
+00025f80: 2076 616c 7565 7320 2827 3c74 313e 666f   values ('<t1>fo
+00025f90: 6f3c 7432 3e62 6172 3c2f 7432 3e3c 7433  o<t2>bar</t2><t3
+00025fa0: 3e3c 2f74 333e 3c2f 7431 3e27 292c 2022  ></t3></t1>'), "
+00025fb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00025fc0: 2022 2827 3c74 313e 3c2f 7431 3e27 2922   "('<t1></t1>')"
+00025fd0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+00025fe0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00025ff0: 6c65 6374 2870 6172 7365 5f78 6d6c 2822  lect(parse_xml("
+00026000: 7622 292e 616c 6961 7328 2272 6573 756c  v").alias("resul
+00026010: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+00026020: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00026030: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00026040: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
+00026050: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00026060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00026070: 2020 2020 207c 3c74 313e 2020 2020 2020       |<t1>      
+00026080: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00026090: 7c20 2066 6f6f 2020 2020 2020 2020 2020  |  foo          
+000260a0: 207c 0a20 2020 2020 2020 207c 2020 3c74   |.        |  <t
+000260b0: 323e 6261 723c 2f74 323e 2020 7c0a 2020  2>bar</t2>  |.  
+000260c0: 2020 2020 2020 7c20 203c 7433 3e3c 2f74        |  <t3></t
+000260d0: 333e 2020 2020 207c 0a20 2020 2020 2020  3>     |.       
+000260e0: 207c 3c2f 7431 3e20 2020 2020 2020 2020   |</t1>         
+000260f0: 2020 7c0a 2020 2020 2020 2020 7c3c 7431    |.        |<t1
+00026100: 3e3c 2f74 313e 2020 2020 2020 207c 0a20  ></t1>       |. 
+00026110: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00026120: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00026130: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00026140: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00026150: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00026160: 2270 6172 7365 5f78 6d6c 2229 0a20 2020  "parse_xml").   
+00026170: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00026180: 2270 6172 7365 5f78 6d6c 2229 2863 290a  "parse_xml")(c).
+00026190: 0a0a 6465 6620 7374 7269 705f 6e75 6c6c  ..def strip_null
+000261a0: 5f76 616c 7565 2863 6f6c 3a20 436f 6c75  _value(col: Colu
+000261b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+000261c0: 756d 6e3a 0a20 2020 2022 2222 436f 6e76  umn:.    """Conv
+000261d0: 6572 7473 2061 204a 534f 4e20 226e 756c  erts a JSON "nul
+000261e0: 6c22 2076 616c 7565 2069 6e20 7468 6520  l" value in the 
+000261f0: 7370 6563 6966 6965 6420 636f 6c75 6d6e  specified column
+00026200: 2074 6f20 6120 5351 4c20 4e55 4c4c 2076   to a SQL NULL v
+00026210: 616c 7565 2e0a 2020 2020 416c 6c20 6f74  alue..    All ot
+00026220: 6865 7220 5641 5249 414e 5420 7661 6c75  her VARIANT valu
+00026230: 6573 2069 6e20 7468 6520 636f 6c75 6d6e  es in the column
+00026240: 2061 7265 2072 6574 7572 6e65 6420 756e   are returned un
+00026250: 6368 616e 6765 642e 0a0a 2020 2020 4578  changed...    Ex
+00026260: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00026270: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00026280: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00026290: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+000262a0: 2020 205b 226e 756c 6c22 2c20 2231 225d     ["null", "1"]
+000262b0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+000262c0: 2020 7363 6865 6d61 3d5b 2253 225d 2c0a    schema=["S"],.
+000262d0: 2020 2020 2020 2020 2e2e 2e20 292e 7365          ... ).se
+000262e0: 6c65 6374 2873 7472 6970 5f6e 756c 6c5f  lect(strip_null_
+000262f0: 7661 6c75 6528 7061 7273 655f 6a73 6f6e  value(parse_json
+00026300: 2863 6f6c 2822 5322 2929 292e 6173 5f28  (col("S"))).as_(
+00026310: 2242 2229 292e 7768 6572 6528 0a20 2020  "B")).where(.   
+00026320: 2020 2020 202e 2e2e 2020 2020 2073 716c       ...     sql
+00026330: 5f65 7870 7228 2242 2069 7320 6e75 6c6c  _expr("B is null
+00026340: 2229 0a20 2020 2020 2020 202e 2e2e 2029  ").        ... )
+00026350: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00026360: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00026370: 2020 5b52 6f77 2842 3d4e 6f6e 6529 5d0a    [Row(B=None)].
+00026380: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00026390: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+000263a0: 6f6c 2c20 2273 7472 6970 5f6e 756c 6c5f  ol, "strip_null_
+000263b0: 7661 6c75 6522 290a 2020 2020 7265 7475  value").    retu
+000263c0: 726e 2062 7569 6c74 696e 2822 7374 7269  rn builtin("stri
+000263d0: 705f 6e75 6c6c 5f76 616c 7565 2229 2863  p_null_value")(c
+000263e0: 290a 0a0a 6465 6620 6172 7261 795f 6167  )...def array_ag
+000263f0: 6728 636f 6c3a 2043 6f6c 756d 6e4f 724e  g(col: ColumnOrN
+00026400: 616d 652c 2069 735f 6469 7374 696e 6374  ame, is_distinct
+00026410: 3a20 626f 6f6c 203d 2046 616c 7365 2920  : bool = False) 
+00026420: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00026430: 2222 5265 7475 726e 7320 7468 6520 696e  ""Returns the in
+00026440: 7075 7420 7661 6c75 6573 2c20 7069 766f  put values, pivo
+00026450: 7465 6420 696e 746f 2061 6e20 4152 5241  ted into an ARRA
+00026460: 592e 2049 6620 7468 6520 696e 7075 7420  Y. If the input 
+00026470: 6973 2065 6d70 7479 2c20 616e 2065 6d70  is empty, an emp
+00026480: 7479 0a20 2020 2041 5252 4159 2069 7320  ty.    ARRAY is 
+00026490: 7265 7475 726e 6564 2e0a 0a20 2020 2045  returned...    E
+000264a0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+000264b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000264c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000264d0: 6d65 285b 5b31 5d2c 205b 325d 2c20 5b33  me([[1], [2], [3
+000264e0: 5d2c 205b 315d 5d2c 2073 6368 656d 613d  ], [1]], schema=
+000264f0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+00026500: 3e3e 2064 662e 7365 6c65 6374 2861 7272  >> df.select(arr
+00026510: 6179 5f61 6767 2822 6122 2c20 5472 7565  ay_agg("a", True
+00026520: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00026530: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00026540: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00026550: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00026560: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00026570: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00026580: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
+00026590: 2020 2020 2020 7c20 2031 2c20 2020 2020        |  1,     
+000265a0: 207c 0a20 2020 2020 2020 207c 2020 322c   |.        |  2,
+000265b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+000265c0: 7c20 2033 2020 2020 2020 207c 0a20 2020  |  3       |.   
+000265d0: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
+000265e0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000265f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00026600: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00026610: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00026620: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+00026630: 6172 7261 795f 6167 6722 290a 2020 2020  array_agg").    
+00026640: 7265 7475 726e 205f 6361 6c6c 5f66 756e  return _call_fun
+00026650: 6374 696f 6e28 2261 7272 6179 5f61 6767  ction("array_agg
+00026660: 222c 2069 735f 6469 7374 696e 6374 2c20  ", is_distinct, 
+00026670: 6329 0a0a 0a64 6566 2061 7272 6179 5f61  c)...def array_a
+00026680: 7070 656e 6428 6172 7261 793a 2043 6f6c  ppend(array: Col
+00026690: 756d 6e4f 724e 616d 652c 2065 6c65 6d65  umnOrName, eleme
+000266a0: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
+000266b0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000266c0: 2022 2222 5265 7475 726e 7320 616e 2041   """Returns an A
+000266d0: 5252 4159 2063 6f6e 7461 696e 696e 6720  RRAY containing 
+000266e0: 616c 6c20 656c 656d 656e 7473 2066 726f  all elements fro
+000266f0: 6d20 7468 6520 736f 7572 6365 2041 5252  m the source ARR
+00026700: 4159 2061 7320 7765 6c6c 2061 7320 7468  AY as well as th
+00026710: 6520 6e65 7720 656c 656d 656e 742e 0a20  e new element.. 
+00026720: 2020 2054 6865 206e 6577 2065 6c65 6d65     The new eleme
+00026730: 6e74 2069 7320 6c6f 6361 7465 6420 6174  nt is located at
+00026740: 2065 6e64 206f 6620 7468 6520 4152 5241   end of the ARRA
+00026750: 592e 0a0a 2020 2020 4172 6773 3a0a 2020  Y...    Args:.  
+00026760: 2020 2020 2020 6172 7261 793a 2054 6865        array: The
+00026770: 2063 6f6c 756d 6e20 636f 6e74 6169 6e69   column containi
+00026780: 6e67 2074 6865 2073 6f75 7263 6520 4152  ng the source AR
+00026790: 5241 592e 0a20 2020 2020 2020 2065 6c65  RAY..        ele
+000267a0: 6d65 6e74 3a20 5468 6520 636f 6c75 6d6e  ment: The column
+000267b0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+000267c0: 656c 656d 656e 7420 746f 2062 6520 6170  element to be ap
+000267d0: 7065 6e64 6564 2e20 5468 6520 656c 656d  pended. The elem
+000267e0: 656e 7420 6d61 7920 6265 206f 6620 616c  ent may be of al
+000267f0: 6d6f 7374 0a20 2020 2020 2020 2020 2020  most.           
+00026800: 2061 6e79 2064 6174 6120 7479 7065 2e20   any data type. 
+00026810: 5468 6520 6461 7461 2074 7970 6520 646f  The data type do
+00026820: 6573 206e 6f74 206e 6565 6420 746f 206d  es not need to m
+00026830: 6174 6368 2074 6865 2064 6174 6120 7479  atch the data ty
+00026840: 7065 2873 2920 6f66 2074 6865 0a20 2020  pe(s) of the.   
+00026850: 2020 2020 2020 2020 2065 7869 7374 696e           existin
+00026860: 6720 656c 656d 656e 7473 2069 6e20 7468  g elements in th
+00026870: 6520 4152 5241 592e 0a0a 2020 2020 4578  e ARRAY...    Ex
+00026880: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00026890: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+000268a0: 6b65 2e73 6e6f 7770 6172 6b20 696d 706f  ke.snowpark impo
+000268b0: 7274 2052 6f77 0a20 2020 2020 2020 203e  rt Row.        >
+000268c0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000268d0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000268e0: 285b 526f 7728 613d 5b31 2c20 322c 2033  ([Row(a=[1, 2, 3
+000268f0: 5d29 5d29 0a20 2020 2020 2020 203e 3e3e  ])]).        >>>
+00026900: 2064 662e 7365 6c65 6374 2861 7272 6179   df.select(array
+00026910: 5f61 7070 656e 6428 2261 222c 206c 6974  _append("a", lit
+00026920: 2834 2929 2e61 6c69 6173 2822 7265 7375  (4)).alias("resu
+00026930: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00026940: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00026950: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+00026960: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+00026970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00026980: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
+00026990: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
+000269a0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+000269b0: 2032 2c20 2020 2020 207c 0a20 2020 2020   2,      |.     
+000269c0: 2020 207c 2020 332c 2020 2020 2020 7c0a     |  3,      |.
+000269d0: 2020 2020 2020 2020 7c20 2034 2020 2020          |  4    
+000269e0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
+000269f0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00026a00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00026a10: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00026a20: 453e 0a20 2020 2022 2222 0a20 2020 2061  E>.    """.    a
+00026a30: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00026a40: 7228 6172 7261 792c 2022 6172 7261 795f  r(array, "array_
+00026a50: 6170 7065 6e64 2229 0a20 2020 2065 203d  append").    e =
+00026a60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00026a70: 656c 656d 656e 742c 2022 6172 7261 795f  element, "array_
+00026a80: 6170 7065 6e64 2229 0a20 2020 2072 6574  append").    ret
+00026a90: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
+00026aa0: 6179 5f61 7070 656e 6422 2928 612c 2065  ay_append")(a, e
+00026ab0: 290a 0a0a 6465 6620 6172 7261 795f 6361  )...def array_ca
+00026ac0: 7428 6172 7261 7931 3a20 436f 6c75 6d6e  t(array1: Column
+00026ad0: 4f72 4e61 6d65 2c20 6172 7261 7932 3a20  OrName, array2: 
+00026ae0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00026af0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00026b00: 5265 7475 726e 7320 7468 6520 636f 6e63  Returns the conc
+00026b10: 6174 656e 6174 696f 6e20 6f66 2074 776f  atenation of two
+00026b20: 2041 5252 4159 732e 0a0a 2020 2020 4172   ARRAYs...    Ar
+00026b30: 6773 3a0a 2020 2020 2020 2020 6172 7261  gs:.        arra
+00026b40: 7931 3a20 436f 6c75 6d6e 2063 6f6e 7461  y1: Column conta
+00026b50: 696e 696e 6720 7468 6520 736f 7572 6365  ining the source
+00026b60: 2041 5252 4159 2e0a 2020 2020 2020 2020   ARRAY..        
+00026b70: 6172 7261 7932 3a20 436f 6c75 6d6e 2063  array2: Column c
+00026b80: 6f6e 7461 696e 696e 6720 7468 6520 4152  ontaining the AR
+00026b90: 5241 5920 746f 2062 6520 6170 7065 6e64  RAY to be append
+00026ba0: 6564 2074 6f20 6172 7261 7931 2e0a 0a20  ed to array1... 
+00026bb0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00026bc0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00026bd0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00026be0: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
+00026bf0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00026c00: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00026c10: 6672 616d 6528 5b52 6f77 2861 3d5b 312c  frame([Row(a=[1,
+00026c20: 2032 2c20 335d 2c20 623d 5b34 2c20 355d   2, 3], b=[4, 5]
+00026c30: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
+00026c40: 6466 2e73 656c 6563 7428 6172 7261 795f  df.select(array_
+00026c50: 6361 7428 2261 222c 2022 6222 292e 616c  cat("a", "b").al
+00026c60: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+00026c70: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00026c80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00026c90: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+00026ca0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00026cb0: 2d2d 2d2d 0a20 2020 2020 2020 207c 5b20  ----.        |[ 
+00026cc0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00026cd0: 2020 7c20 2031 2c20 2020 2020 207c 0a20    |  1,      |. 
+00026ce0: 2020 2020 2020 207c 2020 322c 2020 2020         |  2,    
+00026cf0: 2020 7c0a 2020 2020 2020 2020 7c20 2033    |.        |  3
+00026d00: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+00026d10: 207c 2020 342c 2020 2020 2020 7c0a 2020   |  4,      |.  
+00026d20: 2020 2020 2020 7c20 2035 2020 2020 2020        |  5      
+00026d30: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+00026d40: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00026d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00026d60: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00026d70: 0a20 2020 2022 2222 0a20 2020 2061 3120  .    """.    a1 
+00026d80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00026d90: 2861 7272 6179 312c 2022 6172 7261 795f  (array1, "array_
+00026da0: 6361 7422 290a 2020 2020 6132 203d 205f  cat").    a2 = _
+00026db0: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
+00026dc0: 7261 7932 2c20 2261 7272 6179 5f63 6174  ray2, "array_cat
+00026dd0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00026de0: 696c 7469 6e28 2261 7272 6179 5f63 6174  iltin("array_cat
+00026df0: 2229 2861 312c 2061 3229 0a0a 0a64 6566  ")(a1, a2)...def
+00026e00: 2061 7272 6179 5f63 6f6d 7061 6374 2861   array_compact(a
+00026e10: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
+00026e20: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00026e30: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
+00026e40: 636f 6d70 6163 7465 6420 4152 5241 5920  compacted ARRAY 
+00026e50: 7769 7468 206d 6973 7369 6e67 2061 6e64  with missing and
+00026e60: 206e 756c 6c20 7661 6c75 6573 2072 656d   null values rem
+00026e70: 6f76 6564 2c0a 2020 2020 6566 6665 6374  oved,.    effect
+00026e80: 6976 656c 7920 636f 6e76 6572 7469 6e67  ively converting
+00026e90: 2073 7061 7273 6520 6172 7261 7973 2069   sparse arrays i
+00026ea0: 6e74 6f20 6465 6e73 6520 6172 7261 7973  nto dense arrays
+00026eb0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+00026ec0: 2020 2020 2061 7272 6179 3a20 436f 6c75       array: Colu
+00026ed0: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
+00026ee0: 6520 736f 7572 6365 2041 5252 4159 2074  e source ARRAY t
+00026ef0: 6f20 6265 2063 6f6d 7061 6374 6564 0a0a  o be compacted..
+00026f00: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+00026f10: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00026f20: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00026f30: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+00026f40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00026f50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00026f60: 6166 7261 6d65 285b 526f 7728 613d 5b31  aframe([Row(a=[1
+00026f70: 2c20 4e6f 6e65 2c20 335d 295d 290a 2020  , None, 3])]).  
+00026f80: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00026f90: 6563 7428 2261 222c 2061 7272 6179 5f63  ect("a", array_c
+00026fa0: 6f6d 7061 6374 2822 6122 292e 616c 6961  ompact("a").alia
+00026fb0: 7328 2263 6f6d 7061 6374 6564 2229 292e  s("compacted")).
+00026fc0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00026fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00026ff0: 207c 2241 2220 2020 2020 207c 2243 4f4d   |"A"      |"COM
+00027000: 5041 4354 4544 2220 207c 0a20 2020 2020  PACTED"  |.     
+00027010: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00027020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00027030: 2020 2020 207c 5b20 2020 2020 2020 207c       |[        |
+00027040: 5b20 2020 2020 2020 2020 2020 207c 0a20  [            |. 
+00027050: 2020 2020 2020 207c 2020 312c 2020 2020         |  1,    
+00027060: 207c 2020 312c 2020 2020 2020 2020 207c   |  1,         |
+00027070: 0a20 2020 2020 2020 207c 2020 6e75 6c6c  .        |  null
+00027080: 2c20 207c 2020 3320 2020 2020 2020 2020  ,  |  3         
+00027090: 207c 0a20 2020 2020 2020 207c 2020 3320   |.        |  3 
+000270a0: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
+000270b0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
+000270c0: 2020 2020 2020 207c 2020 2020 2020 2020         |        
+000270d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+000270e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000270f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00027100: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00027110: 2022 2222 0a20 2020 2061 203d 205f 746f   """.    a = _to
+00027120: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
+00027130: 792c 2022 6172 7261 795f 636f 6d70 6163  y, "array_compac
+00027140: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
+00027150: 7569 6c74 696e 2822 6172 7261 795f 636f  uiltin("array_co
+00027160: 6d70 6163 7422 2928 6129 0a0a 0a64 6566  mpact")(a)...def
+00027170: 2061 7272 6179 5f63 6f6e 7374 7275 6374   array_construct
+00027180: 282a 636f 6c73 3a20 436f 6c75 6d6e 4f72  (*cols: ColumnOr
+00027190: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+000271a0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+000271b0: 616e 2041 5252 4159 2063 6f6e 7374 7275  an ARRAY constru
+000271c0: 6374 6564 2066 726f 6d20 7a65 726f 2c20  cted from zero, 
+000271d0: 6f6e 652c 206f 7220 6d6f 7265 2069 6e70  one, or more inp
+000271e0: 7574 732e 0a0a 2020 2020 4172 6773 3a0a  uts...    Args:.
+000271f0: 2020 2020 2020 2020 636f 6c73 3a20 436f          cols: Co
+00027200: 6c75 6d6e 7320 636f 6e74 6169 6e69 6e67  lumns containing
+00027210: 2074 6865 2076 616c 7565 7320 286f 7220   the values (or 
+00027220: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
+00027230: 2065 7661 6c75 6174 6520 746f 2076 616c   evaluate to val
+00027240: 7565 7329 2e20 5468 650a 2020 2020 2020  ues). The.      
+00027250: 2020 2020 2020 7661 6c75 6573 2064 6f20        values do 
+00027260: 6e6f 7420 616c 6c20 6e65 6564 2074 6f20  not all need to 
+00027270: 6265 206f 6620 7468 6520 7361 6d65 2064  be of the same d
+00027280: 6174 6120 7479 7065 2e0a 0a20 2020 2045  ata type...    E
+00027290: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+000272a0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000272b0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000272c0: 6d65 285b 5b31 2c20 325d 2c20 5b33 2c20  me([[1, 2], [3, 
+000272d0: 345d 5d2c 2073 6368 656d 613d 5b22 6122  4]], schema=["a"
+000272e0: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+000272f0: 3e3e 3e20 6466 2e73 656c 6563 7428 6172  >>> df.select(ar
+00027300: 7261 795f 636f 6e73 7472 7563 7428 2261  ray_construct("a
+00027310: 222c 2022 6222 292e 616c 6961 7328 2272  ", "b").alias("r
+00027320: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00027330: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00027340: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+00027350: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+00027360: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00027370: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+00027380: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+00027390: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+000273a0: 207c 2020 3220 2020 2020 2020 7c0a 2020   |  2       |.  
+000273b0: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
+000273c0: 207c 0a20 2020 2020 2020 207c 5b20 2020   |.        |[   
+000273d0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+000273e0: 7c20 2033 2c20 2020 2020 207c 0a20 2020  |  3,      |.   
+000273f0: 2020 2020 207c 2020 3420 2020 2020 2020       |  4       
+00027400: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00027410: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00027420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00027430: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00027440: 2020 2020 2222 220a 2020 2020 6373 203d      """.    cs =
+00027450: 205b 5f74 6f5f 636f 6c5f 6966 5f73 7472   [_to_col_if_str
+00027460: 2863 2c20 2261 7272 6179 5f63 6f6e 7374  (c, "array_const
+00027470: 7275 6374 2229 2066 6f72 2063 2069 6e20  ruct") for c in 
+00027480: 636f 6c73 5d0a 2020 2020 7265 7475 726e  cols].    return
+00027490: 2062 7569 6c74 696e 2822 6172 7261 795f   builtin("array_
+000274a0: 636f 6e73 7472 7563 7422 2928 2a63 7329  construct")(*cs)
+000274b0: 0a0a 0a64 6566 2061 7272 6179 5f63 6f6e  ...def array_con
+000274c0: 7374 7275 6374 5f63 6f6d 7061 6374 282a  struct_compact(*
+000274d0: 636f 6c73 3a20 436f 6c75 6d6e 4f72 4e61  cols: ColumnOrNa
+000274e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+000274f0: 2020 2022 2222 5265 7475 726e 7320 616e     """Returns an
+00027500: 2041 5252 4159 2063 6f6e 7374 7275 6374   ARRAY construct
+00027510: 6564 2066 726f 6d20 7a65 726f 2c20 6f6e  ed from zero, on
+00027520: 652c 206f 7220 6d6f 7265 2069 6e70 7574  e, or more input
+00027530: 732e 0a20 2020 2054 6865 2063 6f6e 7374  s..    The const
+00027540: 7275 6374 6564 2041 5252 4159 206f 6d69  ructed ARRAY omi
+00027550: 7473 2061 6e79 204e 554c 4c20 696e 7075  ts any NULL inpu
+00027560: 7420 7661 6c75 6573 2e0a 0a20 2020 2041  t values...    A
+00027570: 7267 733a 0a20 2020 2020 2020 2063 6f6c  rgs:.        col
+00027580: 733a 2043 6f6c 756d 6e73 2063 6f6e 7461  s: Columns conta
+00027590: 696e 696e 6720 7468 6520 7661 6c75 6573  ining the values
+000275a0: 2028 6f72 2065 7870 7265 7373 696f 6e73   (or expressions
+000275b0: 2074 6861 7420 6576 616c 7561 7465 2074   that evaluate t
+000275c0: 6f20 7661 6c75 6573 292e 2054 6865 0a20  o values). The. 
+000275d0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000275e0: 7320 646f 206e 6f74 2061 6c6c 206e 6565  s do not all nee
+000275f0: 6420 746f 2062 6520 6f66 2074 6865 2073  d to be of the s
+00027600: 616d 6520 6461 7461 2074 7970 652e 0a0a  ame data type...
+00027610: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+00027620: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00027630: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00027640: 7461 6672 616d 6528 5b5b 312c 204e 6f6e  taframe([[1, Non
+00027650: 652c 2032 5d2c 205b 332c 204e 6f6e 652c  e, 2], [3, None,
+00027660: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2261   4]], schema=["a
+00027670: 222c 2022 6222 2c20 2263 225d 290a 2020  ", "b", "c"]).  
+00027680: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00027690: 6563 7428 6172 7261 795f 636f 6e73 7472  ect(array_constr
+000276a0: 7563 745f 636f 6d70 6163 7428 2261 222c  uct_compact("a",
+000276b0: 2022 6222 2c20 2263 2229 2e61 6c69 6173   "b", "c").alias
+000276c0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+000276d0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+000276e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000276f0: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
+00027700: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00027710: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
+00027720: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00027730: 2020 312c 2020 2020 2020 7c0a 2020 2020    1,      |.    
+00027740: 2020 2020 7c20 2032 2020 2020 2020 207c      |  2       |
+00027750: 0a20 2020 2020 2020 207c 5d20 2020 2020  .        |]     
+00027760: 2020 2020 7c0a 2020 2020 2020 2020 7c5b      |.        |[
+00027770: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00027780: 2020 207c 2020 332c 2020 2020 2020 7c0a     |  3,      |.
+00027790: 2020 2020 2020 2020 7c20 2034 2020 2020          |  4    
+000277a0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
+000277b0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000277c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+000277d0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+000277e0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+000277f0: 7320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  s = [_to_col_if_
+00027800: 7374 7228 632c 2022 6172 7261 795f 636f  str(c, "array_co
+00027810: 6e73 7472 7563 745f 636f 6d70 6163 7422  nstruct_compact"
+00027820: 2920 666f 7220 6320 696e 2063 6f6c 735d  ) for c in cols]
+00027830: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00027840: 7469 6e28 2261 7272 6179 5f63 6f6e 7374  tin("array_const
+00027850: 7275 6374 5f63 6f6d 7061 6374 2229 282a  ruct_compact")(*
+00027860: 6373 290a 0a0a 6465 6620 6172 7261 795f  cs)...def array_
+00027870: 636f 6e74 6169 6e73 2876 6172 6961 6e74  contains(variant
+00027880: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+00027890: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
+000278a0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+000278b0: 2020 2020 2222 2252 6574 7572 6e73 2054      """Returns T
+000278c0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
+000278d0: 6669 6564 2056 4152 4941 4e54 2069 7320  fied VARIANT is 
+000278e0: 666f 756e 6420 696e 2074 6865 2073 7065  found in the spe
+000278f0: 6369 6669 6564 2041 5252 4159 2e0a 0a20  cified ARRAY... 
+00027900: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00027910: 2076 6172 6961 6e74 3a20 436f 6c75 6d6e   variant: Column
+00027920: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00027930: 5641 5249 414e 5420 746f 2066 696e 642e  VARIANT to find.
+00027940: 0a20 2020 2020 2020 2061 7272 6179 3a20  .        array: 
+00027950: 436f 6c75 6d6e 2063 6f6e 7461 696e 696e  Column containin
+00027960: 6720 7468 6520 4152 5241 5920 746f 2073  g the ARRAY to s
+00027970: 6561 7263 682e 0a0a 2020 2020 4578 616d  earch...    Exam
+00027980: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00027990: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+000279a0: 2e73 6e6f 7770 6172 6b20 696d 706f 7274  .snowpark import
+000279b0: 2052 6f77 0a20 2020 2020 2020 203e 3e3e   Row.        >>>
+000279c0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000279d0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+000279e0: 526f 7728 5b31 2c20 325d 292c 2052 6f77  Row([1, 2]), Row
+000279f0: 285b 312c 2033 5d29 5d2c 2073 6368 656d  ([1, 3])], schem
+00027a00: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00027a10: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+00027a20: 7272 6179 5f63 6f6e 7461 696e 7328 6c69  rray_contains(li
+00027a30: 7428 3229 2c20 2261 2229 2e61 6c69 6173  t(2), "a").alias
+00027a40: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+00027a50: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00027a60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00027a70: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
+00027a80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00027a90: 2d0a 2020 2020 2020 2020 7c54 7275 6520  -.        |True 
+00027aa0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00027ab0: 4661 6c73 6520 2020 2020 7c0a 2020 2020  False     |.    
+00027ac0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00027ad0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00027ae0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00027af0: 2076 203d 205f 746f 5f63 6f6c 5f69 665f   v = _to_col_if_
+00027b00: 7374 7228 7661 7269 616e 742c 2022 6172  str(variant, "ar
+00027b10: 7261 795f 636f 6e74 6169 6e73 2229 0a20  ray_contains"). 
+00027b20: 2020 2061 203d 205f 746f 5f63 6f6c 5f69     a = _to_col_i
+00027b30: 665f 7374 7228 6172 7261 792c 2022 6172  f_str(array, "ar
+00027b40: 7261 795f 636f 6e74 6169 6e73 2229 0a20  ray_contains"). 
+00027b50: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00027b60: 6e28 2261 7272 6179 5f63 6f6e 7461 696e  n("array_contain
+00027b70: 7322 2928 762c 2061 290a 0a0a 6465 6620  s")(v, a)...def 
+00027b80: 6172 7261 795f 696e 7365 7274 280a 2020  array_insert(.  
+00027b90: 2020 6172 7261 793a 2043 6f6c 756d 6e4f    array: ColumnO
+00027ba0: 724e 616d 652c 2070 6f73 3a20 436f 6c75  rName, pos: Colu
+00027bb0: 6d6e 4f72 4e61 6d65 2c20 656c 656d 656e  mnOrName, elemen
+00027bc0: 743a 2043 6f6c 756d 6e4f 724e 616d 650a  t: ColumnOrName.
+00027bd0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00027be0: 2022 2222 5265 7475 726e 7320 616e 2041   """Returns an A
+00027bf0: 5252 4159 2063 6f6e 7461 696e 696e 6720  RRAY containing 
+00027c00: 616c 6c20 656c 656d 656e 7473 2066 726f  all elements fro
+00027c10: 6d20 7468 6520 736f 7572 6365 2041 5252  m the source ARR
+00027c20: 4159 2061 7320 7765 6c6c 2061 7320 7468  AY as well as th
+00027c30: 6520 6e65 7720 656c 656d 656e 742e 0a0a  e new element...
+00027c40: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00027c50: 2020 6172 7261 793a 2043 6f6c 756d 6e20    array: Column 
+00027c60: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
+00027c70: 6f75 7263 6520 4152 5241 592e 0a20 2020  ource ARRAY..   
+00027c80: 2020 2020 2070 6f73 3a20 436f 6c75 6d6e       pos: Column
+00027c90: 2063 6f6e 7461 696e 696e 6720 6120 287a   containing a (z
+00027ca0: 6572 6f2d 6261 7365 6429 2070 6f73 6974  ero-based) posit
+00027cb0: 696f 6e20 696e 2074 6865 2073 6f75 7263  ion in the sourc
+00027cc0: 6520 4152 5241 592e 0a20 2020 2020 2020  e ARRAY..       
+00027cd0: 2020 2020 2054 6865 206e 6577 2065 6c65       The new ele
+00027ce0: 6d65 6e74 2069 7320 696e 7365 7274 6564  ment is inserted
+00027cf0: 2061 7420 7468 6973 2070 6f73 6974 696f   at this positio
+00027d00: 6e2e 2054 6865 206f 7269 6769 6e61 6c20  n. The original 
+00027d10: 656c 656d 656e 7420 6672 6f6d 2074 6869  element from thi
+00027d20: 730a 2020 2020 2020 2020 2020 2020 706f  s.            po
+00027d30: 7369 7469 6f6e 2028 6966 2061 6e79 2920  sition (if any) 
+00027d40: 616e 6420 616c 6c20 7375 6273 6571 7565  and all subseque
+00027d50: 6e74 2065 6c65 6d65 6e74 7320 2869 6620  nt elements (if 
+00027d60: 616e 7929 2061 7265 2073 6869 6674 6564  any) are shifted
+00027d70: 2062 7920 6f6e 6520 706f 7369 7469 6f6e   by one position
+00027d80: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+00027d90: 7468 6520 7269 6768 7420 696e 2074 6865  the right in the
+00027da0: 2072 6573 756c 7469 6e67 2061 7272 6179   resulting array
+00027db0: 2028 692e 652e 2069 6e73 6572 7469 6e67   (i.e. inserting
+00027dc0: 2061 7420 706f 7369 7469 6f6e 2030 2068   at position 0 h
+00027dd0: 6173 2074 6865 2073 616d 650a 2020 2020  as the same.    
+00027de0: 2020 2020 2020 2020 6566 6665 6374 2061          effect a
+00027df0: 7320 7573 696e 6720 6172 7261 795f 7072  s using array_pr
+00027e00: 6570 656e 6429 2e0a 2020 2020 2020 2020  epend)..        
+00027e10: 2020 2020 4120 6e65 6761 7469 7665 2070      A negative p
+00027e20: 6f73 6974 696f 6e20 6973 2069 6e74 6572  osition is inter
+00027e30: 7072 6574 6564 2061 7320 616e 2069 6e64  preted as an ind
+00027e40: 6578 2066 726f 6d20 7468 6520 6261 636b  ex from the back
+00027e50: 206f 6620 7468 6520 6172 7261 7920 2865   of the array (e
+00027e60: 2e67 2e0a 2020 2020 2020 2020 2020 2020  .g..            
+00027e70: 2d31 2072 6573 756c 7473 2069 6e20 696e  -1 results in in
+00027e80: 7365 7274 696f 6e20 6265 666f 7265 2074  sertion before t
+00027e90: 6865 206c 6173 7420 656c 656d 656e 7420  he last element 
+00027ea0: 696e 2074 6865 2061 7272 6179 292e 0a20  in the array).. 
+00027eb0: 2020 2020 2020 2065 6c65 6d65 6e74 3a20         element: 
+00027ec0: 436f 6c75 6d6e 2063 6f6e 7461 696e 696e  Column containin
+00027ed0: 6720 7468 6520 656c 656d 656e 7420 746f  g the element to
+00027ee0: 2062 6520 696e 7365 7274 6564 2e20 5468   be inserted. Th
+00027ef0: 6520 6e65 7720 656c 656d 656e 7420 6973  e new element is
+00027f00: 206c 6f63 6174 6564 2061 740a 2020 2020   located at.    
+00027f10: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00027f20: 2070 6f73 2e20 5468 6520 7265 6c61 7469   pos. The relati
+00027f30: 7665 206f 7264 6572 206f 6620 7468 6520  ve order of the 
+00027f40: 6f74 6865 7220 656c 656d 656e 7473 2066  other elements f
+00027f50: 726f 6d20 7468 6520 736f 7572 6365 0a20  rom the source. 
+00027f60: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00027f70: 2069 7320 7072 6573 6572 7665 642e 0a0a   is preserved...
+00027f80: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+00027f90: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00027fa0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00027fb0: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+00027fc0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00027fd0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00027fe0: 6166 7261 6d65 285b 526f 7728 5b31 2c20  aframe([Row([1, 
+00027ff0: 325d 292c 2052 6f77 285b 312c 2033 5d29  2]), Row([1, 3])
+00028000: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00028010: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00028020: 7365 6c65 6374 2861 7272 6179 5f69 6e73  select(array_ins
+00028030: 6572 7428 2261 222c 206c 6974 2830 292c  ert("a", lit(0),
+00028040: 206c 6974 2831 3029 292e 616c 6961 7328   lit(10)).alias(
+00028050: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00028060: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00028070: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00028080: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+00028090: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000280a0: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
+000280b0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+000280c0: 2031 302c 2020 2020 207c 0a20 2020 2020   10,     |.     
+000280d0: 2020 207c 2020 312c 2020 2020 2020 7c0a     |  1,      |.
+000280e0: 2020 2020 2020 2020 7c20 2032 2020 2020          |  2    
+000280f0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
+00028100: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00028110: 2020 7c5b 2020 2020 2020 2020 207c 0a20    |[         |. 
+00028120: 2020 2020 2020 207c 2020 3130 2c20 2020         |  10,   
+00028130: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+00028140: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+00028150: 207c 2020 3320 2020 2020 2020 7c0a 2020   |  3       |.  
+00028160: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
+00028170: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00028180: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00028190: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+000281a0: 2222 220a 2020 2020 6120 3d20 5f74 6f5f  """.    a = _to_
+000281b0: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
+000281c0: 2c20 2261 7272 6179 5f69 6e73 6572 7422  , "array_insert"
+000281d0: 290a 2020 2020 7020 3d20 5f74 6f5f 636f  ).    p = _to_co
+000281e0: 6c5f 6966 5f73 7472 2870 6f73 2c20 2261  l_if_str(pos, "a
+000281f0: 7272 6179 5f69 6e73 6572 7422 290a 2020  rray_insert").  
+00028200: 2020 6520 3d20 5f74 6f5f 636f 6c5f 6966    e = _to_col_if
+00028210: 5f73 7472 2865 6c65 6d65 6e74 2c20 2261  _str(element, "a
+00028220: 7272 6179 5f69 6e73 6572 7422 290a 2020  rray_insert").  
+00028230: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00028240: 2822 6172 7261 795f 696e 7365 7274 2229  ("array_insert")
+00028250: 2861 2c20 702c 2065 290a 0a0a 6465 6620  (a, p, e)...def 
+00028260: 6172 7261 795f 706f 7369 7469 6f6e 2876  array_position(v
+00028270: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+00028280: 4e61 6d65 2c20 6172 7261 793a 2043 6f6c  Name, array: Col
+00028290: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+000282a0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+000282b0: 7572 6e73 2074 6865 2069 6e64 6578 206f  urns the index o
+000282c0: 6620 7468 6520 6669 7273 7420 6f63 6375  f the first occu
+000282d0: 7272 656e 6365 206f 6620 616e 2065 6c65  rrence of an ele
+000282e0: 6d65 6e74 2069 6e20 616e 2041 5252 4159  ment in an ARRAY
+000282f0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+00028300: 2020 2020 2076 6172 6961 6e74 3a20 436f       variant: Co
+00028310: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
+00028320: 7468 6520 5641 5249 414e 5420 7661 6c75  the VARIANT valu
+00028330: 6520 7468 6174 2079 6f75 2077 616e 7420  e that you want 
+00028340: 746f 2066 696e 642e 2054 6865 2066 756e  to find. The fun
+00028350: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
+00028360: 2020 7365 6172 6368 6573 2066 6f72 2074    searches for t
+00028370: 6865 2066 6972 7374 206f 6363 7572 7265  he first occurre
+00028380: 6e63 6520 6f66 2074 6869 7320 7661 6c75  nce of this valu
+00028390: 6520 696e 2074 6865 2061 7272 6179 2e0a  e in the array..
+000283a0: 2020 2020 2020 2020 6172 7261 793a 2043          array: C
+000283b0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
+000283c0: 2074 6865 2041 5252 4159 2074 6f20 6265   the ARRAY to be
+000283d0: 2073 6561 7263 6865 642e 0a0a 2020 2020   searched...    
+000283e0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+000283f0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00028400: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
+00028410: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
+00028420: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00028430: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00028440: 6d65 285b 526f 7728 5b32 2c20 315d 292c  me([Row([2, 1]),
+00028450: 2052 6f77 285b 312c 2033 5d29 5d2c 2073   Row([1, 3])], s
+00028460: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00028470: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00028480: 6374 2861 7272 6179 5f70 6f73 6974 696f  ct(array_positio
+00028490: 6e28 6c69 7428 3129 2c20 2261 2229 2e61  n(lit(1), "a").a
+000284a0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+000284b0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+000284c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000284d0: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+000284e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000284f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+00028500: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00028510: 2020 207c 3020 2020 2020 2020 2020 7c0a     |0         |.
+00028520: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00028530: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00028540: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00028550: 0a20 2020 2076 203d 205f 746f 5f63 6f6c  .    v = _to_col
+00028560: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
+00028570: 2022 6172 7261 795f 706f 7369 7469 6f6e   "array_position
+00028580: 2229 0a20 2020 2061 203d 205f 746f 5f63  ").    a = _to_c
+00028590: 6f6c 5f69 665f 7374 7228 6172 7261 792c  ol_if_str(array,
+000285a0: 2022 6172 7261 795f 706f 7369 7469 6f6e   "array_position
+000285b0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+000285c0: 696c 7469 6e28 2261 7272 6179 5f70 6f73  iltin("array_pos
+000285d0: 6974 696f 6e22 2928 762c 2061 290a 0a0a  ition")(v, a)...
+000285e0: 6465 6620 6172 7261 795f 7072 6570 656e  def array_prepen
+000285f0: 6428 6172 7261 793a 2043 6f6c 756d 6e4f  d(array: ColumnO
+00028600: 724e 616d 652c 2065 6c65 6d65 6e74 3a20  rName, element: 
+00028610: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00028620: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00028630: 5265 7475 726e 7320 616e 2041 5252 4159  Returns an ARRAY
+00028640: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00028650: 6e65 7720 656c 656d 656e 7420 6173 2077  new element as w
+00028660: 656c 6c20 6173 2061 6c6c 2065 6c65 6d65  ell as all eleme
+00028670: 6e74 7320 6672 6f6d 2074 6865 2073 6f75  nts from the sou
+00028680: 7263 6520 4152 5241 592e 0a20 2020 2054  rce ARRAY..    T
+00028690: 6865 206e 6577 2065 6c65 6d65 6e74 2069  he new element i
+000286a0: 7320 706f 7369 7469 6f6e 6564 2061 7420  s positioned at 
+000286b0: 7468 6520 6265 6769 6e6e 696e 6720 6f66  the beginning of
+000286c0: 2074 6865 2041 5252 4159 2e0a 0a20 2020   the ARRAY...   
+000286d0: 2041 7267 733a 0a20 2020 2020 2020 2061   Args:.        a
+000286e0: 7272 6179 2043 6f6c 756d 6e20 636f 6e74  rray Column cont
+000286f0: 6169 6e69 6e67 2074 6865 2073 6f75 7263  aining the sourc
+00028700: 6520 4152 5241 592e 0a20 2020 2020 2020  e ARRAY..       
+00028710: 2065 6c65 6d65 6e74 2043 6f6c 756d 6e20   element Column 
+00028720: 636f 6e74 6169 6e69 6e67 2074 6865 2065  containing the e
+00028730: 6c65 6d65 6e74 2074 6f20 6265 2070 7265  lement to be pre
+00028740: 7065 6e64 6564 2e0a 0a20 2020 2045 7861  pended...    Exa
+00028750: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+00028760: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+00028770: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
+00028780: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
+00028790: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+000287a0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+000287b0: 5b52 6f77 2861 3d5b 312c 2032 2c20 335d  [Row(a=[1, 2, 3]
+000287c0: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
+000287d0: 6466 2e73 656c 6563 7428 6172 7261 795f  df.select(array_
+000287e0: 7072 6570 656e 6428 2261 222c 206c 6974  prepend("a", lit
+000287f0: 2834 2929 2e61 6c69 6173 2822 7265 7375  (4)).alias("resu
+00028800: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00028810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00028820: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+00028830: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+00028840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00028850: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
+00028860: 0a20 2020 2020 2020 207c 2020 342c 2020  .        |  4,  
+00028870: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00028880: 2031 2c20 2020 2020 207c 0a20 2020 2020   1,      |.     
+00028890: 2020 207c 2020 322c 2020 2020 2020 7c0a     |  2,      |.
+000288a0: 2020 2020 2020 2020 7c20 2033 2020 2020          |  3    
+000288b0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
+000288c0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000288d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+000288e0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+000288f0: 453e 0a20 2020 2022 2222 0a20 2020 2061  E>.    """.    a
+00028900: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00028910: 7228 6172 7261 792c 2022 6172 7261 795f  r(array, "array_
+00028920: 7072 6570 656e 6422 290a 2020 2020 6520  prepend").    e 
+00028930: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00028940: 2865 6c65 6d65 6e74 2c20 2261 7272 6179  (element, "array
+00028950: 5f70 7265 7065 6e64 2229 0a20 2020 2072  _prepend").    r
+00028960: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+00028970: 7272 6179 5f70 7265 7065 6e64 2229 2861  rray_prepend")(a
+00028980: 2c20 6529 0a0a 0a64 6566 2061 7272 6179  , e)...def array
+00028990: 5f73 697a 6528 6172 7261 793a 2043 6f6c  _size(array: Col
+000289a0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+000289b0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+000289c0: 7572 6e73 2074 6865 2073 697a 6520 6f66  urns the size of
+000289d0: 2074 6865 2069 6e70 7574 2041 5252 4159   the input ARRAY
+000289e0: 2e0a 0a20 2020 2049 6620 7468 6520 7370  ...    If the sp
+000289f0: 6563 6966 6965 6420 636f 6c75 6d6e 2063  ecified column c
+00028a00: 6f6e 7461 696e 7320 6120 5641 5249 414e  ontains a VARIAN
+00028a10: 5420 7661 6c75 6520 7468 6174 2063 6f6e  T value that con
+00028a20: 7461 696e 7320 616e 2041 5252 4159 2c20  tains an ARRAY, 
+00028a30: 7468 6520 7369 7a65 206f 6620 7468 6520  the size of the 
+00028a40: 4152 5241 590a 2020 2020 6973 2072 6574  ARRAY.    is ret
+00028a50: 7572 6e65 643b 206f 7468 6572 7769 7365  urned; otherwise
+00028a60: 2c20 4e55 4c4c 2069 7320 7265 7475 726e  , NULL is return
+00028a70: 6564 2069 6620 7468 6520 7661 6c75 6520  ed if the value 
+00028a80: 6973 206e 6f74 2061 6e20 4152 5241 592e  is not an ARRAY.
+00028a90: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00028aa0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00028ab0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00028ac0: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
+00028ad0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00028ae0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00028af0: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
+00028b00: 5b31 2c20 322c 2033 5d29 5d29 0a20 2020  [1, 2, 3])]).   
+00028b10: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00028b20: 6374 2861 7272 6179 5f73 697a 6528 2261  ct(array_size("a
+00028b30: 2229 2e61 6c69 6173 2822 7265 7375 6c74  ").alias("result
+00028b40: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+00028b50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00028b60: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00028b70: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00028b80: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00028b90: 2020 7c33 2020 2020 2020 2020 207c 0a20    |3         |. 
+00028ba0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00028bb0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00028bc0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00028bd0: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
+00028be0: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
+00028bf0: 7272 6179 5f73 697a 6522 290a 2020 2020  rray_size").    
+00028c00: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00028c10: 6172 7261 795f 7369 7a65 2229 2861 290a  array_size")(a).
+00028c20: 0a0a 6465 6620 6172 7261 795f 736c 6963  ..def array_slic
+00028c30: 6528 6172 7261 793a 2043 6f6c 756d 6e4f  e(array: ColumnO
+00028c40: 724e 616d 652c 2066 726f 6d5f 3a20 436f  rName, from_: Co
+00028c50: 6c75 6d6e 4f72 4e61 6d65 2c20 746f 3a20  lumnOrName, to: 
+00028c60: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00028c70: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00028c80: 5265 7475 726e 7320 616e 2041 5252 4159  Returns an ARRAY
+00028c90: 2063 6f6e 7374 7275 6374 6564 2066 726f   constructed fro
+00028ca0: 6d20 6120 7370 6563 6966 6965 6420 7375  m a specified su
+00028cb0: 6273 6574 206f 6620 656c 656d 656e 7473  bset of elements
+00028cc0: 206f 6620 7468 6520 696e 7075 7420 4152   of the input AR
+00028cd0: 5241 592e 0a0a 2020 2020 4172 6773 3a0a  RAY...    Args:.
+00028ce0: 2020 2020 2020 2020 6172 7261 793a 2043          array: C
+00028cf0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
+00028d00: 2074 6865 2073 6f75 7263 6520 4152 5241   the source ARRA
+00028d10: 592e 0a20 2020 2020 2020 2066 726f 6d5f  Y..        from_
+00028d20: 3a20 436f 6c75 6d6e 2063 6f6e 7461 696e  : Column contain
+00028d30: 696e 6720 6120 706f 7369 7469 6f6e 2069  ing a position i
+00028d40: 6e20 7468 6520 736f 7572 6365 2041 5252  n the source ARR
+00028d50: 4159 2e20 5468 6520 706f 7369 7469 6f6e  AY. The position
+00028d60: 206f 6620 7468 6520 6669 7273 740a 2020   of the first.  
+00028d70: 2020 2020 2020 2020 2020 656c 656d 656e            elemen
+00028d80: 7420 6973 2030 2e20 456c 656d 656e 7473  t is 0. Elements
+00028d90: 2066 726f 6d20 706f 7369 7469 6f6e 7320   from positions 
+00028da0: 6c65 7373 2074 6861 6e20 7468 6973 2070  less than this p
+00028db0: 6172 616d 6574 6572 2061 7265 0a20 2020  arameter are.   
+00028dc0: 2020 2020 2020 2020 206e 6f74 2069 6e63           not inc
+00028dd0: 6c75 6465 6420 696e 2074 6865 2072 6573  luded in the res
+00028de0: 756c 7469 6e67 2041 5252 4159 2e0a 2020  ulting ARRAY..  
+00028df0: 2020 2020 2020 746f 3a20 436f 6c75 6d6e        to: Column
+00028e00: 2063 6f6e 7461 696e 696e 6720 6120 706f   containing a po
+00028e10: 7369 7469 6f6e 2069 6e20 7468 6520 736f  sition in the so
+00028e20: 7572 6365 2041 5252 4159 2e20 456c 656d  urce ARRAY. Elem
+00028e30: 656e 7473 2066 726f 6d20 706f 7369 7469  ents from positi
+00028e40: 6f6e 7320 6571 7561 6c20 746f 0a20 2020  ons equal to.   
+00028e50: 2020 2020 2020 2020 206f 7220 6772 6561           or grea
+00028e60: 7465 7220 7468 616e 2074 6869 7320 7061  ter than this pa
+00028e70: 7261 6d65 7465 7220 6172 6520 6e6f 7420  rameter are not 
+00028e80: 696e 636c 7564 6564 2069 6e20 7468 6520  included in the 
+00028e90: 7265 7375 6c74 696e 6720 6172 7261 792e  resulting array.
+00028ea0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00028eb0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00028ec0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00028ed0: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
+00028ee0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00028ef0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00028f00: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
+00028f10: 5b31 2c20 322c 2033 2c20 342c 2035 5d29  [1, 2, 3, 4, 5])
+00028f20: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00028f30: 662e 7365 6c65 6374 2861 7272 6179 5f73  f.select(array_s
+00028f40: 6c69 6365 2822 6122 2c20 6c69 7428 3129  lice("a", lit(1)
+00028f50: 2c20 6c69 7428 3329 292e 616c 6961 7328  , lit(3)).alias(
+00028f60: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00028f70: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00028f80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00028f90: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+00028fa0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00028fb0: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
+00028fc0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00028fd0: 2032 2c20 2020 2020 207c 0a20 2020 2020   2,      |.     
+00028fe0: 2020 207c 2020 3320 2020 2020 2020 7c0a     |  3       |.
+00028ff0: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
+00029000: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00029010: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00029020: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00029030: 2020 2222 220a 2020 2020 6120 3d20 5f74    """.    a = _t
+00029040: 6f5f 636f 6c5f 6966 5f73 7472 2861 7272  o_col_if_str(arr
+00029050: 6179 2c20 2261 7272 6179 5f73 6c69 6365  ay, "array_slice
+00029060: 2229 0a20 2020 2066 203d 205f 746f 5f63  ").    f = _to_c
+00029070: 6f6c 5f69 665f 7374 7228 6672 6f6d 5f2c  ol_if_str(from_,
+00029080: 2022 6172 7261 795f 736c 6963 6522 290a   "array_slice").
+00029090: 2020 2020 7420 3d20 5f74 6f5f 636f 6c5f      t = _to_col_
+000290a0: 6966 5f73 7472 2874 6f2c 2022 6172 7261  if_str(to, "arra
+000290b0: 795f 736c 6963 6522 290a 2020 2020 7265  y_slice").    re
+000290c0: 7475 726e 2062 7569 6c74 696e 2822 6172  turn builtin("ar
+000290d0: 7261 795f 736c 6963 6522 2928 612c 2066  ray_slice")(a, f
+000290e0: 2c20 7429 0a0a 0a64 6566 2061 7272 6179  , t)...def array
+000290f0: 5f74 6f5f 7374 7269 6e67 2861 7272 6179  _to_string(array
+00029100: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+00029110: 7365 7061 7261 746f 723a 2043 6f6c 756d  separator: Colum
+00029120: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00029130: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00029140: 6e73 2061 6e20 696e 7075 7420 4152 5241  ns an input ARRA
+00029150: 5920 636f 6e76 6572 7465 6420 746f 2061  Y converted to a
+00029160: 2073 7472 696e 6720 6279 2063 6173 7469   string by casti
+00029170: 6e67 2061 6c6c 2076 616c 7565 7320 746f  ng all values to
+00029180: 2073 7472 696e 6773 2028 7573 696e 670a   strings (using.
+00029190: 2020 2020 544f 5f56 4152 4348 4152 2920      TO_VARCHAR) 
+000291a0: 616e 6420 636f 6e63 6174 656e 6174 696e  and concatenatin
+000291b0: 6720 7468 656d 2028 7573 696e 6720 7468  g them (using th
+000291c0: 6520 7374 7269 6e67 2066 726f 6d20 7468  e string from th
+000291d0: 6520 7365 636f 6e64 2061 7267 756d 656e  e second argumen
+000291e0: 7420 746f 2073 6570 6172 6174 650a 2020  t to separate.  
+000291f0: 2020 7468 6520 656c 656d 656e 7473 292e    the elements).
+00029200: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+00029210: 2020 2020 6172 7261 793a 2043 6f6c 756d      array: Colum
+00029220: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
+00029230: 2041 5252 4159 206f 6620 656c 656d 656e   ARRAY of elemen
+00029240: 7473 2074 6f20 636f 6e76 6572 7420 746f  ts to convert to
+00029250: 2061 2073 7472 696e 672e 0a20 2020 2020   a string..     
+00029260: 2020 2073 6570 6172 6174 6f72 3a20 436f     separator: Co
+00029270: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
+00029280: 7468 6520 7374 7269 6e67 2074 6f20 7075  the string to pu
+00029290: 7420 6265 7477 6565 6e20 6561 6368 2065  t between each e
+000292a0: 6c65 6d65 6e74 2028 652e 672e 2061 2073  lement (e.g. a s
+000292b0: 7061 6365 2c0a 2020 2020 2020 2020 2020  pace,.          
+000292c0: 2020 636f 6d6d 612c 206f 7220 6f74 6865    comma, or othe
+000292d0: 7220 6875 6d61 6e2d 7265 6164 6162 6c65  r human-readable
+000292e0: 2073 6570 6172 6174 6f72 292e 0a0a 2020   separator)...  
+000292f0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00029300: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00029310: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b20  wflake.snowpark 
+00029320: 696d 706f 7274 2052 6f77 0a20 2020 2020  import Row.     
+00029330: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00029340: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00029350: 7261 6d65 285b 526f 7728 613d 5b31 2c20  rame([Row(a=[1, 
+00029360: 5472 7565 2c20 2273 225d 295d 290a 2020  True, "s"])]).  
+00029370: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00029380: 6563 7428 6172 7261 795f 746f 5f73 7472  ect(array_to_str
+00029390: 696e 6728 2261 222c 206c 6974 2822 2c22  ing("a", lit(","
+000293a0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+000293b0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+000293c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000293d0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+000293e0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+000293f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00029400: 2020 7c31 2c74 7275 652c 7320 207c 0a20    |1,true,s  |. 
+00029410: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00029420: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00029430: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00029440: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
+00029450: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
+00029460: 7272 6179 5f74 6f5f 7374 7269 6e67 2229  rray_to_string")
+00029470: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
+00029480: 5f69 665f 7374 7228 7365 7061 7261 746f  _if_str(separato
+00029490: 722c 2022 6172 7261 795f 746f 5f73 7472  r, "array_to_str
+000294a0: 696e 6722 290a 2020 2020 7265 7475 726e  ing").    return
+000294b0: 2062 7569 6c74 696e 2822 6172 7261 795f   builtin("array_
+000294c0: 746f 5f73 7472 696e 6722 2928 612c 2073  to_string")(a, s
+000294d0: 290a 0a0a 6465 6620 6f62 6a65 6374 5f61  )...def object_a
+000294e0: 6767 286b 6579 3a20 436f 6c75 6d6e 4f72  gg(key: ColumnOr
+000294f0: 4e61 6d65 2c20 7661 6c75 653a 2043 6f6c  Name, value: Col
+00029500: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00029510: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00029520: 7572 6e73 206f 6e65 204f 424a 4543 5420  urns one OBJECT 
+00029530: 7065 7220 6772 6f75 702e 2046 6f72 2065  per group. For e
+00029540: 6163 6820 6b65 792d 7661 6c75 6520 696e  ach key-value in
+00029550: 7075 7420 7061 6972 2c20 7768 6572 6520  put pair, where 
+00029560: 6b65 7920 6d75 7374 2062 6520 6120 5641  key must be a VA
+00029570: 5243 4841 520a 2020 2020 616e 6420 7661  RCHAR.    and va
+00029580: 6c75 6520 6d75 7374 2062 6520 6120 5641  lue must be a VA
+00029590: 5249 414e 542c 2074 6865 2072 6573 756c  RIANT, the resul
+000295a0: 7469 6e67 204f 424a 4543 5420 636f 6e74  ting OBJECT cont
+000295b0: 6169 6e73 2061 206b 6579 2d76 616c 7565  ains a key-value
+000295c0: 2066 6965 6c64 2e0a 0a20 2020 2045 7861   field...    Exa
+000295d0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+000295e0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+000295f0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+00029600: 7320 696d 706f 7274 2053 7472 7563 7454  s import StructT
+00029610: 7970 652c 2053 7472 7563 7446 6965 6c64  ype, StructField
+00029620: 2c20 5661 7269 616e 7454 7970 652c 2053  , VariantType, S
+00029630: 7472 696e 6754 7970 650a 2020 2020 2020  tringType.      
+00029640: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00029650: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00029660: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+00029670: 2020 2020 205b 5b22 6e61 6d65 222c 2022       [["name", "
+00029680: 4a6f 6522 5d2c 205b 227a 6970 222c 2022  Joe"], ["zip", "
+00029690: 3938 3030 3422 5d5d 2c0a 2020 2020 2020  98004"]],.      
+000296a0: 2020 2e2e 2e20 2020 2020 7363 6865 6d61    ...     schema
+000296b0: 3d53 7472 7563 7454 7970 6528 5b53 7472  =StructType([Str
+000296c0: 7563 7446 6965 6c64 2822 6b22 2c20 5374  uctField("k", St
+000296d0: 7269 6e67 5479 7065 2829 292c 2053 7472  ringType()), Str
+000296e0: 7563 7446 6965 6c64 2822 7622 2c20 5661  uctField("v", Va
+000296f0: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
+00029700: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00029710: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00029720: 6374 286f 626a 6563 745f 6167 6728 636f  ct(object_agg(co
+00029730: 6c28 226b 2229 2c20 636f 6c28 2276 2229  l("k"), col("v")
+00029740: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00029750: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00029760: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00029770: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00029780: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
+00029790: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000297a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000297b0: 0a20 2020 2020 2020 207c 7b20 2020 2020  .        |{     
+000297c0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+000297d0: 2020 2020 2020 7c20 2022 6e61 6d65 223a        |  "name":
+000297e0: 2022 4a6f 6522 2c20 207c 0a20 2020 2020   "Joe",  |.     
+000297f0: 2020 207c 2020 227a 6970 223a 2022 3938     |  "zip": "98
+00029800: 3030 3422 2020 7c0a 2020 2020 2020 2020  004"  |.        
+00029810: 7c7d 2020 2020 2020 2020 2020 2020 2020  |}              
+00029820: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00029830: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00029840: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00029850: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00029860: 2020 6b20 3d20 5f74 6f5f 636f 6c5f 6966    k = _to_col_if
+00029870: 5f73 7472 286b 6579 2c20 226f 626a 6563  _str(key, "objec
+00029880: 745f 6167 6722 290a 2020 2020 7620 3d20  t_agg").    v = 
+00029890: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2876  _to_col_if_str(v
+000298a0: 616c 7565 2c20 226f 626a 6563 745f 6167  alue, "object_ag
+000298b0: 6722 290a 2020 2020 7265 7475 726e 2062  g").    return b
+000298c0: 7569 6c74 696e 2822 6f62 6a65 6374 5f61  uiltin("object_a
+000298d0: 6767 2229 286b 2c20 7629 0a0a 0a64 6566  gg")(k, v)...def
+000298e0: 206f 626a 6563 745f 636f 6e73 7472 7563   object_construc
+000298f0: 7428 2a6b 6579 5f76 616c 7565 733a 2043  t(*key_values: C
+00029900: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00029910: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00029920: 6574 7572 6e73 2061 6e20 4f42 4a45 4354  eturns an OBJECT
+00029930: 2063 6f6e 7374 7275 6374 6564 2066 726f   constructed fro
+00029940: 6d20 7468 6520 6172 6775 6d65 6e74 732e  m the arguments.
+00029950: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00029960: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00029970: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00029980: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00029990: 7420 5374 7275 6374 5479 7065 2c20 5374  t StructType, St
+000299a0: 7275 6374 4669 656c 642c 2056 6172 6961  ructField, Varia
+000299b0: 6e74 5479 7065 2c20 5374 7269 6e67 5479  ntType, StringTy
+000299c0: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+000299d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000299e0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+000299f0: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
+00029a00: 226e 616d 6522 2c20 224a 6f65 225d 2c20  "name", "Joe"], 
+00029a10: 5b22 7a69 7022 2c20 2239 3830 3034 225d  ["zip", "98004"]
+00029a20: 2c5b 2261 6765 222c 204e 6f6e 655d 2c20  ,["age", None], 
+00029a30: 5b4e 6f6e 652c 2022 7661 6c75 6522 5d5d  [None, "value"]]
+00029a40: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00029a50: 2020 7363 6865 6d61 3d53 7472 7563 7454    schema=StructT
+00029a60: 7970 6528 5b53 7472 7563 7446 6965 6c64  ype([StructField
+00029a70: 2822 6b22 2c20 5374 7269 6e67 5479 7065  ("k", StringType
+00029a80: 2829 292c 2053 7472 7563 7446 6965 6c64  ()), StructField
+00029a90: 2822 7622 2c20 5661 7269 616e 7454 7970  ("v", VariantTyp
+00029aa0: 6528 2929 5d29 0a20 2020 2020 2020 202e  e())]).        .
+00029ab0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+00029ac0: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
+00029ad0: 745f 636f 6e73 7472 7563 7428 636f 6c28  t_construct(col(
+00029ae0: 226b 2229 2c20 636f 6c28 2276 2229 292e  "k"), col("v")).
+00029af0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00029b00: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00029b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00029b20: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+00029b30: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
+00029b40: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00029b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00029b60: 2020 2020 2020 207c 7b20 2020 2020 2020         |{       
+00029b70: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00029b80: 2020 2020 7c20 2022 6e61 6d65 223a 2022      |  "name": "
+00029b90: 4a6f 6522 2020 207c 0a20 2020 2020 2020  Joe"   |.       
+00029ba0: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
+00029bb0: 2020 2020 7c0a 2020 2020 2020 2020 7c7b      |.        |{
+00029bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029bd0: 207c 0a20 2020 2020 2020 207c 2020 227a   |.        |  "z
+00029be0: 6970 223a 2022 3938 3030 3422 2020 7c0a  ip": "98004"  |.
+00029bf0: 2020 2020 2020 2020 7c7d 2020 2020 2020          |}      
+00029c00: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+00029c10: 2020 2020 207c 7b7d 2020 2020 2020 2020       |{}        
+00029c20: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00029c30: 2020 7c7b 7d20 2020 2020 2020 2020 2020    |{}           
+00029c40: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00029c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00029c60: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00029c70: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00029c80: 2020 2020 6b76 7320 3d20 5b5f 746f 5f63      kvs = [_to_c
+00029c90: 6f6c 5f69 665f 7374 7228 6b76 2c20 226f  ol_if_str(kv, "o
+00029ca0: 626a 6563 745f 636f 6e73 7472 7563 7422  bject_construct"
+00029cb0: 2920 666f 7220 6b76 2069 6e20 6b65 795f  ) for kv in key_
+00029cc0: 7661 6c75 6573 5d0a 2020 2020 7265 7475  values].    retu
+00029cd0: 726e 2062 7569 6c74 696e 2822 6f62 6a65  rn builtin("obje
+00029ce0: 6374 5f63 6f6e 7374 7275 6374 2229 282a  ct_construct")(*
+00029cf0: 6b76 7329 0a0a 0a64 6566 206f 626a 6563  kvs)...def objec
+00029d00: 745f 636f 6e73 7472 7563 745f 6b65 6570  t_construct_keep
+00029d10: 5f6e 756c 6c28 2a6b 6579 5f76 616c 7565  _null(*key_value
+00029d20: 733a 2043 6f6c 756d 6e4f 724e 616d 6529  s: ColumnOrName)
+00029d30: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00029d40: 2222 2252 6574 7572 6e73 2061 6e20 6f62  """Returns an ob
+00029d50: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
+00029d60: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
+00029d70: 7468 6520 696e 7075 7420 2869 2e65 2e20  the input (i.e. 
+00029d80: 736f 7572 6365 2920 6f62 6a65 6374 2077  source) object w
+00029d90: 6974 6820 6f6e 6520 6f72 206d 6f72 650a  ith one or more.
+00029da0: 2020 2020 6b65 7973 2072 656d 6f76 6564      keys removed
+00029db0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00029dc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00029dd0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00029de0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00029df0: 7274 2053 7472 7563 7454 7970 652c 2053  rt StructType, S
+00029e00: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
+00029e10: 616e 7454 7970 652c 2053 7472 696e 6754  antType, StringT
+00029e20: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
+00029e30: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00029e40: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
+00029e50: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
+00029e60: 5b22 6b65 795f 3122 2c20 226f 6e65 225d  ["key_1", "one"]
+00029e70: 2c20 5b22 6b65 795f 3222 2c20 4e6f 6e65  , ["key_2", None
+00029e80: 5d5d 2c0a 2020 2020 2020 2020 2e2e 2e20  ]],.        ... 
+00029e90: 2020 2020 7363 6865 6d61 3d53 7472 7563      schema=Struc
+00029ea0: 7454 7970 6528 5b53 7472 7563 7446 6965  tType([StructFie
+00029eb0: 6c64 2822 6b22 2c20 5374 7269 6e67 5479  ld("k", StringTy
+00029ec0: 7065 2829 292c 2053 7472 7563 7446 6965  pe()), StructFie
+00029ed0: 6c64 2822 7622 2c20 5661 7269 616e 7454  ld("v", VariantT
+00029ee0: 7970 6528 2929 5d29 0a20 2020 2020 2020  ype())]).       
+00029ef0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
+00029f00: 3e3e 2064 662e 7365 6c65 6374 286f 626a  >> df.select(obj
+00029f10: 6563 745f 636f 6e73 7472 7563 745f 6b65  ect_construct_ke
+00029f20: 6570 5f6e 756c 6c28 636f 6c28 226b 2229  ep_null(col("k")
+00029f30: 2c20 636f 6c28 2276 2229 292e 616c 6961  , col("v")).alia
+00029f40: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00029f50: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00029f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00029f70: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+00029f80: 5422 2020 2020 2020 2020 2020 7c0a 2020  T"          |.  
+00029f90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00029fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00029fb0: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
+00029fc0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00029fd0: 7c20 2022 6b65 795f 3122 3a20 226f 6e65  |  "key_1": "one
+00029fe0: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
+00029ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a000: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
+0002a010: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+0002a020: 2020 2020 2020 207c 2020 226b 6579 5f32         |  "key_2
+0002a030: 223a 206e 756c 6c20 2020 7c0a 2020 2020  ": null   |.    
+0002a040: 2020 2020 7c7d 2020 2020 2020 2020 2020      |}          
+0002a050: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0002a060: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0002a070: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0002a080: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0002a090: 220a 2020 2020 6b76 7320 3d20 5b5f 746f  ".    kvs = [_to
+0002a0a0: 5f63 6f6c 5f69 665f 7374 7228 6b76 2c20  _col_if_str(kv, 
+0002a0b0: 226f 626a 6563 745f 636f 6e73 7472 7563  "object_construc
+0002a0c0: 745f 6b65 6570 5f6e 756c 6c22 2920 666f  t_keep_null") fo
+0002a0d0: 7220 6b76 2069 6e20 6b65 795f 7661 6c75  r kv in key_valu
+0002a0e0: 6573 5d0a 2020 2020 7265 7475 726e 2062  es].    return b
+0002a0f0: 7569 6c74 696e 2822 6f62 6a65 6374 5f63  uiltin("object_c
+0002a100: 6f6e 7374 7275 6374 5f6b 6565 705f 6e75  onstruct_keep_nu
+0002a110: 6c6c 2229 282a 6b76 7329 0a0a 0a64 6566  ll")(*kvs)...def
+0002a120: 206f 626a 6563 745f 6465 6c65 7465 286f   object_delete(o
+0002a130: 626a 3a20 436f 6c75 6d6e 4f72 4e61 6d65  bj: ColumnOrName
+0002a140: 2c20 6b65 7931 3a20 436f 6c75 6d6e 4f72  , key1: ColumnOr
+0002a150: 4e61 6d65 2c20 2a6b 6579 733a 2043 6f6c  Name, *keys: Col
+0002a160: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+0002a170: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+0002a180: 7572 6e73 2061 6e20 6f62 6a65 6374 2063  urns an object c
+0002a190: 6f6e 7369 7374 696e 6720 6f66 2074 6865  onsisting of the
+0002a1a0: 2069 6e70 7574 206f 626a 6563 7420 7769   input object wi
+0002a1b0: 7468 206f 6e65 206f 7220 6d6f 7265 206b  th one or more k
+0002a1c0: 6579 7320 7265 6d6f 7665 642e 0a20 2020  eys removed..   
+0002a1d0: 2054 6865 2069 6e70 7574 206b 6579 206d   The input key m
+0002a1e0: 7573 7420 6e6f 7420 6578 6973 7420 696e  ust not exist in
+0002a1f0: 2074 6865 206f 626a 6563 742e 0a0a 2020   the object...  
+0002a200: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0002a210: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0002a220: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0002a230: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+0002a240: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
+0002a250: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+0002a260: 716c 280a 2020 2020 2020 2020 2e2e 2e20  ql(.        ... 
+0002a270: 2020 2020 2273 656c 6563 7420 6f62 6a65      "select obje
+0002a280: 6374 5f63 6f6e 7374 7275 6374 2861 2c62  ct_construct(a,b
+0002a290: 2c63 2c64 2c65 2c66 2920 6173 206f 626a  ,c,d,e,f) as obj
+0002a2a0: 2066 726f 6d20 220a 2020 2020 2020 2020   from ".        
+0002a2b0: 2e2e 2e20 2020 2020 2276 616c 7565 7328  ...     "values(
+0002a2c0: 2761 6765 272c 2032 312c 2027 7a69 7027  'age', 21, 'zip'
+0002a2d0: 2c20 3231 3032 312c 2027 6e61 6d65 272c  , 21021, 'name',
+0002a2e0: 2027 4a6f 6527 292c 220a 2020 2020 2020   'Joe'),".      
+0002a2f0: 2020 2e2e 2e20 2020 2020 2228 2761 6765    ...     "('age
+0002a300: 272c 2032 362c 2027 7a69 7027 2c20 3934  ', 26, 'zip', 94
+0002a310: 3032 312c 2027 6e61 6d65 272c 2027 4a61  021, 'name', 'Ja
+0002a320: 7927 2920 6173 2054 2861 2c62 2c63 2c64  y') as T(a,b,c,d
+0002a330: 2c65 2c66 2922 0a20 2020 2020 2020 202e  ,e,f)".        .
+0002a340: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+0002a350: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
+0002a360: 745f 6465 6c65 7465 2863 6f6c 2822 6f62  t_delete(col("ob
+0002a370: 6a22 292c 206c 6974 2822 6167 6522 2929  j"), lit("age"))
+0002a380: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0002a390: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0002a3a0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0002a3b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0002a3c0: 5245 5355 4c54 2220 2020 2020 2020 2020  RESULT"         
+0002a3d0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002a3e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002a3f0: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
+0002a400: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002a410: 2020 2020 207c 2020 226e 616d 6522 3a20       |  "name": 
+0002a420: 224a 6f65 222c 2020 7c0a 2020 2020 2020  "Joe",  |.      
+0002a430: 2020 7c20 2022 7a69 7022 3a20 3231 3032    |  "zip": 2102
+0002a440: 3120 2020 207c 0a20 2020 2020 2020 207c  1    |.        |
+0002a450: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
+0002a460: 2020 7c0a 2020 2020 2020 2020 7c7b 2020    |.        |{  
+0002a470: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+0002a480: 0a20 2020 2020 2020 207c 2020 226e 616d  .        |  "nam
+0002a490: 6522 3a20 224a 6179 222c 2020 7c0a 2020  e": "Jay",  |.  
+0002a4a0: 2020 2020 2020 7c20 2022 7a69 7022 3a20        |  "zip": 
+0002a4b0: 3934 3032 3120 2020 207c 0a20 2020 2020  94021    |.     
+0002a4c0: 2020 207c 7d20 2020 2020 2020 2020 2020     |}           
+0002a4d0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002a4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a4f0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0002a500: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0002a510: 0a20 2020 206f 203d 205f 746f 5f63 6f6c  .    o = _to_col
+0002a520: 5f69 665f 7374 7228 6f62 6a2c 2022 6f62  _if_str(obj, "ob
+0002a530: 6a65 6374 5f64 656c 6574 6522 290a 2020  ject_delete").  
+0002a540: 2020 6b31 203d 205f 746f 5f63 6f6c 5f69    k1 = _to_col_i
+0002a550: 665f 7374 7228 6b65 7931 2c20 226f 626a  f_str(key1, "obj
+0002a560: 6563 745f 6465 6c65 7465 2229 0a20 2020  ect_delete").   
+0002a570: 206b 7320 3d20 5b5f 746f 5f63 6f6c 5f69   ks = [_to_col_i
+0002a580: 665f 7374 7228 6b2c 2022 6f62 6a65 6374  f_str(k, "object
+0002a590: 5f64 656c 6574 6522 2920 666f 7220 6b20  _delete") for k 
+0002a5a0: 696e 206b 6579 735d 0a20 2020 2072 6574  in keys].    ret
+0002a5b0: 7572 6e20 6275 696c 7469 6e28 226f 626a  urn builtin("obj
+0002a5c0: 6563 745f 6465 6c65 7465 2229 286f 2c20  ect_delete")(o, 
+0002a5d0: 6b31 2c20 2a6b 7329 0a0a 0a64 6566 206f  k1, *ks)...def o
+0002a5e0: 626a 6563 745f 696e 7365 7274 280a 2020  bject_insert(.  
+0002a5f0: 2020 6f62 6a3a 2043 6f6c 756d 6e4f 724e    obj: ColumnOrN
+0002a600: 616d 652c 0a20 2020 206b 6579 3a20 436f  ame,.    key: Co
+0002a610: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
+0002a620: 7661 6c75 653a 2043 6f6c 756d 6e4f 724e  value: ColumnOrN
+0002a630: 616d 652c 0a20 2020 2075 7064 6174 655f  ame,.    update_
+0002a640: 666c 6167 3a20 4f70 7469 6f6e 616c 5b43  flag: Optional[C
+0002a650: 6f6c 756d 6e4f 724e 616d 655d 203d 204e  olumnOrName] = N
+0002a660: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
+0002a670: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+0002a680: 2061 6e20 6f62 6a65 6374 2063 6f6e 7369   an object consi
+0002a690: 7374 696e 6720 6f66 2074 6865 2069 6e70  sting of the inp
+0002a6a0: 7574 206f 626a 6563 7420 7769 7468 2061  ut object with a
+0002a6b0: 206e 6577 206b 6579 2d76 616c 7565 2070   new key-value p
+0002a6c0: 6169 7220 696e 7365 7274 6564 2028 6f72  air inserted (or
+0002a6d0: 2061 6e0a 2020 2020 6578 6973 7469 6e67   an.    existing
+0002a6e0: 206b 6579 2075 7064 6174 6564 2077 6974   key updated wit
+0002a6f0: 6820 6120 6e65 7720 7661 6c75 6529 2e0a  h a new value)..
+0002a700: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0002a710: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0002a720: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0002a730: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+0002a740: 6f72 7420 6c69 740a 2020 2020 2020 2020  ort lit.        
+0002a750: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002a760: 2e73 716c 280a 2020 2020 2020 2020 2e2e  .sql(.        ..
+0002a770: 2e20 2020 2020 2273 656c 6563 7420 6f62  .     "select ob
+0002a780: 6a65 6374 5f63 6f6e 7374 7275 6374 2861  ject_construct(a
+0002a790: 2c62 2c63 2c64 2c65 2c66 2920 6173 206f  ,b,c,d,e,f) as o
+0002a7a0: 626a 2c20 6b2c 2076 2066 726f 6d20 220a  bj, k, v from ".
+0002a7b0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0002a7c0: 2276 616c 7565 7328 2761 6765 272c 2032  "values('age', 2
+0002a7d0: 312c 2027 7a69 7027 2c20 3231 3032 312c  1, 'zip', 21021,
+0002a7e0: 2027 6e61 6d65 272c 2027 4a6f 6527 2c20   'name', 'Joe', 
+0002a7f0: 2761 6765 272c 2030 292c 220a 2020 2020  'age', 0),".    
+0002a800: 2020 2020 2e2e 2e20 2020 2020 2228 2761      ...     "('a
+0002a810: 6765 272c 2032 362c 2027 7a69 7027 2c20  ge', 26, 'zip', 
+0002a820: 3934 3032 312c 2027 6e61 6d65 272c 2027  94021, 'name', '
+0002a830: 4a61 7927 2c20 2761 6765 272c 2030 2920  Jay', 'age', 0) 
+0002a840: 6173 2054 2861 2c62 2c63 2c64 2c65 2c66  as T(a,b,c,d,e,f
+0002a850: 2c6b 2c76 2922 0a20 2020 2020 2020 202e  ,k,v)".        .
+0002a860: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+0002a870: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
+0002a880: 745f 696e 7365 7274 2863 6f6c 2822 6f62  t_insert(col("ob
+0002a890: 6a22 292c 206c 6974 2822 6b65 7922 292c  j"), lit("key"),
+0002a8a0: 206c 6974 2822 7622 2929 2e61 6c69 6173   lit("v")).alias
+0002a8b0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+0002a8c0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0002a8d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002a8e0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0002a8f0: 2220 2020 2020 2020 2020 207c 0a20 2020  "          |.   
+0002a900: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002a910: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002a920: 2020 7c7b 2020 2020 2020 2020 2020 2020    |{            
+0002a930: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0002a940: 2020 2261 6765 223a 2032 312c 2020 2020    "age": 21,    
+0002a950: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
+0002a960: 6b65 7922 3a20 2276 222c 2020 2020 207c  key": "v",     |
+0002a970: 0a20 2020 2020 2020 207c 2020 226e 616d  .        |  "nam
+0002a980: 6522 3a20 224a 6f65 222c 2020 7c0a 2020  e": "Joe",  |.  
+0002a990: 2020 2020 2020 7c20 2022 7a69 7022 3a20        |  "zip": 
+0002a9a0: 3231 3032 3120 2020 207c 0a20 2020 2020  21021    |.     
+0002a9b0: 2020 207c 7d20 2020 2020 2020 2020 2020     |}           
+0002a9c0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002a9d0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
+0002a9e0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0002a9f0: 2261 6765 223a 2032 362c 2020 2020 2020  "age": 26,      
+0002aa00: 7c0a 2020 2020 2020 2020 7c20 2022 6b65  |.        |  "ke
+0002aa10: 7922 3a20 2276 222c 2020 2020 207c 0a20  y": "v",     |. 
+0002aa20: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
+0002aa30: 3a20 224a 6179 222c 2020 7c0a 2020 2020  : "Jay",  |.    
+0002aa40: 2020 2020 7c20 2022 7a69 7022 3a20 3934      |  "zip": 94
+0002aa50: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
+0002aa60: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
+0002aa70: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002aa80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002aa90: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0002aaa0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0002aab0: 2020 206f 203d 205f 746f 5f63 6f6c 5f69     o = _to_col_i
+0002aac0: 665f 7374 7228 6f62 6a2c 2022 6f62 6a65  f_str(obj, "obje
+0002aad0: 6374 5f69 6e73 6572 7422 290a 2020 2020  ct_insert").    
+0002aae0: 6b20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  k = _to_col_if_s
+0002aaf0: 7472 286b 6579 2c20 226f 626a 6563 745f  tr(key, "object_
+0002ab00: 696e 7365 7274 2229 0a20 2020 2076 203d  insert").    v =
+0002ab10: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002ab20: 7661 6c75 652c 2022 6f62 6a65 6374 5f69  value, "object_i
+0002ab30: 6e73 6572 7422 290a 2020 2020 7566 203d  nsert").    uf =
+0002ab40: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002ab50: 7570 6461 7465 5f66 6c61 672c 2022 7570  update_flag, "up
+0002ab60: 6461 7465 5f66 6c61 6722 2920 6966 2075  date_flag") if u
+0002ab70: 7064 6174 655f 666c 6167 2069 7320 6e6f  pdate_flag is no
+0002ab80: 7420 4e6f 6e65 2065 6c73 6520 4e6f 6e65  t None else None
+0002ab90: 0a20 2020 2069 6620 7566 2069 7320 6e6f  .    if uf is no
+0002aba0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0002abb0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002abc0: 6f62 6a65 6374 5f69 6e73 6572 7422 2928  object_insert")(
+0002abd0: 6f2c 206b 2c20 762c 2075 6629 0a20 2020  o, k, v, uf).   
+0002abe0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+0002abf0: 6574 7572 6e20 6275 696c 7469 6e28 226f  eturn builtin("o
+0002ac00: 626a 6563 745f 696e 7365 7274 2229 286f  bject_insert")(o
+0002ac10: 2c20 6b2c 2076 290a 0a0a 6465 6620 6f62  , k, v)...def ob
+0002ac20: 6a65 6374 5f70 6963 6b28 6f62 6a3a 2043  ject_pick(obj: C
+0002ac30: 6f6c 756d 6e4f 724e 616d 652c 206b 6579  olumnOrName, key
+0002ac40: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
+0002ac50: 202a 6b65 7973 3a20 436f 6c75 6d6e 4f72   *keys: ColumnOr
+0002ac60: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002ac70: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+0002ac80: 6120 6e65 7720 4f42 4a45 4354 2063 6f6e  a new OBJECT con
+0002ac90: 7461 696e 696e 6720 736f 6d65 206f 6620  taining some of 
+0002aca0: 7468 6520 6b65 792d 7661 6c75 6520 7061  the key-value pa
+0002acb0: 6972 7320 6672 6f6d 2061 6e20 6578 6973  irs from an exis
+0002acc0: 7469 6e67 206f 626a 6563 742e 0a0a 2020  ting object...  
+0002acd0: 2020 546f 2069 6465 6e74 6966 7920 7468    To identify th
+0002ace0: 6520 6b65 792d 7661 6c75 6520 7061 6972  e key-value pair
+0002acf0: 7320 746f 2069 6e63 6c75 6465 2069 6e20  s to include in 
+0002ad00: 7468 6520 6e65 7720 6f62 6a65 6374 2c20  the new object, 
+0002ad10: 7061 7373 2069 6e20 7468 6520 6b65 7973  pass in the keys
+0002ad20: 2061 7320 6172 6775 6d65 6e74 732c 0a20   as arguments,. 
+0002ad30: 2020 206f 7220 7061 7373 2069 6e20 616e     or pass in an
+0002ad40: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
+0002ad50: 6720 7468 6520 6b65 7973 2e0a 0a20 2020  g the keys...   
+0002ad60: 2049 6620 6120 7370 6563 6966 6965 6420   If a specified 
+0002ad70: 6b65 7920 6973 206e 6f74 2070 7265 7365  key is not prese
+0002ad80: 6e74 2069 6e20 7468 6520 696e 7075 7420  nt in the input 
+0002ad90: 6f62 6a65 6374 2c20 7468 6520 6b65 7920  object, the key 
+0002ada0: 6973 2069 676e 6f72 6564 2e0a 0a20 2020  is ignored...   
+0002adb0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0002adc0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0002add0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0002ade0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0002adf0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
+0002ae00: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
+0002ae10: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+0002ae20: 2020 2273 656c 6563 7420 6f62 6a65 6374    "select object
+0002ae30: 5f63 6f6e 7374 7275 6374 2861 2c62 2c63  _construct(a,b,c
+0002ae40: 2c64 2c65 2c66 2920 6173 206f 626a 2c20  ,d,e,f) as obj, 
+0002ae50: 6b2c 2076 2066 726f 6d20 220a 2020 2020  k, v from ".    
+0002ae60: 2020 2020 2e2e 2e20 2020 2020 2276 616c      ...     "val
+0002ae70: 7565 7328 2761 6765 272c 2032 312c 2027  ues('age', 21, '
+0002ae80: 7a69 7027 2c20 3231 3032 312c 2027 6e61  zip', 21021, 'na
+0002ae90: 6d65 272c 2027 4a6f 6527 2c20 2761 6765  me', 'Joe', 'age
+0002aea0: 272c 2030 292c 220a 2020 2020 2020 2020  ', 0),".        
+0002aeb0: 2e2e 2e20 2020 2020 2228 2761 6765 272c  ...     "('age',
+0002aec0: 2032 362c 2027 7a69 7027 2c20 3934 3032   26, 'zip', 9402
+0002aed0: 312c 2027 6e61 6d65 272c 2027 4a61 7927  1, 'name', 'Jay'
+0002aee0: 2c20 2761 6765 272c 2030 2920 6173 2054  , 'age', 0) as T
+0002aef0: 2861 2c62 2c63 2c64 2c65 2c66 2c6b 2c76  (a,b,c,d,e,f,k,v
+0002af00: 2922 0a20 2020 2020 2020 202e 2e2e 2029  )".        ... )
+0002af10: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002af20: 7365 6c65 6374 286f 626a 6563 745f 7069  select(object_pi
+0002af30: 636b 2863 6f6c 2822 6f62 6a22 292c 2063  ck(col("obj"), c
+0002af40: 6f6c 2822 6b22 292c 206c 6974 2822 6e61  ol("k"), lit("na
+0002af50: 6d65 2229 292e 616c 6961 7328 2272 6573  me")).alias("res
+0002af60: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0002af70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0002af80: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002af90: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
+0002afa0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002afb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002afc0: 2d0a 2020 2020 2020 2020 7c7b 2020 2020  -.        |{    
+0002afd0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+0002afe0: 2020 2020 2020 7c20 2022 6167 6522 3a20        |  "age": 
+0002aff0: 3231 2c20 2020 2020 7c0a 2020 2020 2020  21,     |.      
+0002b000: 2020 7c20 2022 6e61 6d65 223a 2022 4a6f    |  "name": "Jo
+0002b010: 6522 2020 7c0a 2020 2020 2020 2020 7c7d  e"  |.        |}
+0002b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b030: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
+0002b040: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+0002b050: 2020 2020 2020 7c20 2022 6167 6522 3a20        |  "age": 
+0002b060: 3236 2c20 2020 2020 7c0a 2020 2020 2020  26,     |.      
+0002b070: 2020 7c20 2022 6e61 6d65 223a 2022 4a61    |  "name": "Ja
+0002b080: 7922 2020 7c0a 2020 2020 2020 2020 7c7d  y"  |.        |}
+0002b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0a0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002b0b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0002b0c0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+0002b0d0: 3e0a 2020 2020 2222 220a 2020 2020 6f20  >.    """.    o 
+0002b0e0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0002b0f0: 286f 626a 2c20 226f 626a 6563 745f 7069  (obj, "object_pi
+0002b100: 636b 2229 0a20 2020 206b 3120 3d20 5f74  ck").    k1 = _t
+0002b110: 6f5f 636f 6c5f 6966 5f73 7472 286b 6579  o_col_if_str(key
+0002b120: 312c 2022 6f62 6a65 6374 5f70 6963 6b22  1, "object_pick"
+0002b130: 290a 2020 2020 6b73 203d 205b 5f74 6f5f  ).    ks = [_to_
+0002b140: 636f 6c5f 6966 5f73 7472 286b 2c20 226f  col_if_str(k, "o
+0002b150: 626a 6563 745f 7069 636b 2229 2066 6f72  bject_pick") for
+0002b160: 206b 2069 6e20 6b65 7973 5d0a 2020 2020   k in keys].    
+0002b170: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002b180: 6f62 6a65 6374 5f70 6963 6b22 2928 6f2c  object_pick")(o,
+0002b190: 206b 312c 202a 6b73 290a 0a0a 6465 6620   k1, *ks)...def 
+0002b1a0: 6173 6328 633a 2043 6f6c 756d 6e4f 724e  asc(c: ColumnOrN
+0002b1b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0002b1c0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+0002b1d0: 2043 6f6c 756d 6e20 6578 7072 6573 7369   Column expressi
+0002b1e0: 6f6e 2077 6974 6820 7661 6c75 6573 2073  on with values s
+0002b1f0: 6f72 7465 6420 696e 2061 7363 656e 6469  orted in ascendi
+0002b200: 6e67 206f 7264 6572 2e0a 0a20 2020 2045  ng order...    E
+0002b210: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0002b220: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0002b230: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0002b240: 616d 6528 5b4e 6f6e 652c 2033 2c20 322c  ame([None, 3, 2,
+0002b250: 2031 2c20 4e6f 6e65 5d2c 2073 6368 656d   1, None], schem
+0002b260: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+0002b270: 203e 3e3e 2064 662e 736f 7274 2861 7363   >>> df.sort(asc
+0002b280: 2864 665b 2261 225d 2929 2e63 6f6c 6c65  (df["a"])).colle
+0002b290: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0002b2a0: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
+0002b2b0: 3d4e 6f6e 6529 2c20 526f 7728 413d 3129  =None), Row(A=1)
+0002b2c0: 2c20 526f 7728 413d 3229 2c20 526f 7728  , Row(A=2), Row(
+0002b2d0: 413d 3329 5d0a 2020 2020 2222 220a 2020  A=3)].    """.  
+0002b2e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0002b2f0: 5f73 7472 2863 2c20 2261 7363 2229 0a20  _str(c, "asc"). 
+0002b300: 2020 2072 6574 7572 6e20 632e 6173 6328     return c.asc(
+0002b310: 290a 0a0a 6465 6620 6173 635f 6e75 6c6c  )...def asc_null
+0002b320: 735f 6669 7273 7428 633a 2043 6f6c 756d  s_first(c: Colum
+0002b330: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002b340: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0002b350: 6e73 2061 2043 6f6c 756d 6e20 6578 7072  ns a Column expr
+0002b360: 6573 7369 6f6e 2077 6974 6820 7661 6c75  ession with valu
+0002b370: 6573 2073 6f72 7465 6420 696e 2061 7363  es sorted in asc
+0002b380: 656e 6469 6e67 206f 7264 6572 0a20 2020  ending order.   
+0002b390: 2028 6e75 6c6c 2076 616c 7565 7320 736f   (null values so
+0002b3a0: 7274 6564 2062 6566 6f72 6520 6e6f 6e2d  rted before non-
+0002b3b0: 6e75 6c6c 2076 616c 7565 7329 2e0a 0a20  null values)... 
+0002b3c0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0002b3d0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0002b3e0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0002b3f0: 7461 6672 616d 6528 5b4e 6f6e 652c 2033  taframe([None, 3
+0002b400: 2c20 322c 2031 2c20 4e6f 6e65 5d2c 2073  , 2, 1, None], s
+0002b410: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0002b420: 2020 2020 203e 3e3e 2064 662e 736f 7274       >>> df.sort
+0002b430: 2861 7363 5f6e 756c 6c73 5f66 6972 7374  (asc_nulls_first
+0002b440: 2864 665b 2261 225d 2929 2e63 6f6c 6c65  (df["a"])).colle
+0002b450: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0002b460: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
+0002b470: 3d4e 6f6e 6529 2c20 526f 7728 413d 3129  =None), Row(A=1)
+0002b480: 2c20 526f 7728 413d 3229 2c20 526f 7728  , Row(A=2), Row(
+0002b490: 413d 3329 5d0a 2020 2020 2222 220a 2020  A=3)].    """.  
+0002b4a0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0002b4b0: 5f73 7472 2863 2c20 2261 7363 5f6e 756c  _str(c, "asc_nul
+0002b4c0: 6c73 5f66 6972 7374 2229 0a20 2020 2072  ls_first").    r
+0002b4d0: 6574 7572 6e20 632e 6173 635f 6e75 6c6c  eturn c.asc_null
+0002b4e0: 735f 6669 7273 7428 290a 0a0a 6465 6620  s_first()...def 
+0002b4f0: 6173 635f 6e75 6c6c 735f 6c61 7374 2863  asc_nulls_last(c
+0002b500: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0002b510: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0002b520: 2222 5265 7475 726e 7320 6120 436f 6c75  ""Returns a Colu
+0002b530: 6d6e 2065 7870 7265 7373 696f 6e20 7769  mn expression wi
+0002b540: 7468 2076 616c 7565 7320 736f 7274 6564  th values sorted
+0002b550: 2069 6e20 6173 6365 6e64 696e 6720 6f72   in ascending or
+0002b560: 6465 720a 2020 2020 286e 756c 6c20 7661  der.    (null va
+0002b570: 6c75 6573 2073 6f72 7465 6420 6166 7465  lues sorted afte
+0002b580: 7220 6e6f 6e2d 6e75 6c6c 2076 616c 7565  r non-null value
+0002b590: 7329 2e0a 0a20 2020 2045 7861 6d70 6c65  s)...    Example
+0002b5a0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0002b5b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0002b5c0: 6174 655f 6461 7461 6672 616d 6528 5b4e  ate_dataframe([N
+0002b5d0: 6f6e 652c 2033 2c20 322c 2031 2c20 4e6f  one, 3, 2, 1, No
+0002b5e0: 6e65 5d2c 2073 6368 656d 613d 5b22 6122  ne], schema=["a"
+0002b5f0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0002b600: 662e 736f 7274 2861 7363 5f6e 756c 6c73  f.sort(asc_nulls
+0002b610: 5f6c 6173 7428 6466 5b22 6122 5d29 292e  _last(df["a"])).
+0002b620: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0002b630: 2020 5b52 6f77 2841 3d31 292c 2052 6f77    [Row(A=1), Row
+0002b640: 2841 3d32 292c 2052 6f77 2841 3d33 292c  (A=2), Row(A=3),
+0002b650: 2052 6f77 2841 3d4e 6f6e 6529 2c20 526f   Row(A=None), Ro
+0002b660: 7728 413d 4e6f 6e65 295d 0a20 2020 2022  w(A=None)].    "
+0002b670: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0002b680: 6f6c 5f69 665f 7374 7228 632c 2022 6173  ol_if_str(c, "as
+0002b690: 635f 6e75 6c6c 735f 6c61 7374 2229 0a20  c_nulls_last"). 
+0002b6a0: 2020 2072 6574 7572 6e20 632e 6173 635f     return c.asc_
+0002b6b0: 6e75 6c6c 735f 6c61 7374 2829 0a0a 0a64  nulls_last()...d
+0002b6c0: 6566 2064 6573 6328 633a 2043 6f6c 756d  ef desc(c: Colum
+0002b6d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002b6e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+0002b6f0: 5265 7475 726e 7320 6120 436f 6c75 6d6e  Returns a Column
+0002b700: 2065 7870 7265 7373 696f 6e20 7769 7468   expression with
+0002b710: 2076 616c 7565 7320 736f 7274 6564 2069   values sorted i
+0002b720: 6e20 6465 7363 656e 6469 6e67 206f 7264  n descending ord
+0002b730: 6572 2e0a 0a20 2020 2045 7861 6d70 6c65  er...    Example
+0002b740: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0002b750: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0002b760: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+0002b770: 2c20 322c 2033 2c20 4e6f 6e65 2c20 4e6f  , 2, 3, None, No
+0002b780: 6e65 5d2c 2073 6368 656d 613d 5b22 6122  ne], schema=["a"
+0002b790: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0002b7a0: 662e 736f 7274 2864 6573 6328 6466 5b22  f.sort(desc(df["
+0002b7b0: 6122 5d29 292e 636f 6c6c 6563 7428 290a  a"])).collect().
+0002b7c0: 2020 2020 2020 2020 5b52 6f77 2841 3d33          [Row(A=3
+0002b7d0: 292c 2052 6f77 2841 3d32 292c 2052 6f77  ), Row(A=2), Row
+0002b7e0: 2841 3d31 292c 2052 6f77 2841 3d4e 6f6e  (A=1), Row(A=Non
+0002b7f0: 6529 2c20 526f 7728 413d 4e6f 6e65 295d  e), Row(A=None)]
+0002b800: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0002b810: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002b820: 632c 2022 6465 7363 2229 0a20 2020 2072  c, "desc").    r
+0002b830: 6574 7572 6e20 632e 6465 7363 2829 0a0a  eturn c.desc()..
+0002b840: 0a64 6566 2064 6573 635f 6e75 6c6c 735f  .def desc_nulls_
+0002b850: 6669 7273 7428 633a 2043 6f6c 756d 6e4f  first(c: ColumnO
+0002b860: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002b870: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0002b880: 7475 726e 7320 6120 436f 6c75 6d6e 2065  turns a Column e
+0002b890: 7870 7265 7373 696f 6e20 7769 7468 2076  xpression with v
+0002b8a0: 616c 7565 7320 736f 7274 6564 2069 6e20  alues sorted in 
+0002b8b0: 6465 7363 656e 6469 6e67 206f 7264 6572  descending order
+0002b8c0: 0a20 2020 2028 6e75 6c6c 2076 616c 7565  .    (null value
+0002b8d0: 7320 736f 7274 6564 2062 6566 6f72 6520  s sorted before 
+0002b8e0: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
+0002b8f0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0002b900: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+0002b910: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0002b920: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+0002b930: 322c 2033 2c20 4e6f 6e65 2c20 4e6f 6e65  2, 3, None, None
+0002b940: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+0002b950: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002b960: 736f 7274 2864 6573 635f 6e75 6c6c 735f  sort(desc_nulls_
+0002b970: 6669 7273 7428 6466 5b22 6122 5d29 292e  first(df["a"])).
+0002b980: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0002b990: 2020 5b52 6f77 2841 3d4e 6f6e 6529 2c20    [Row(A=None), 
+0002b9a0: 526f 7728 413d 4e6f 6e65 292c 2052 6f77  Row(A=None), Row
+0002b9b0: 2841 3d33 292c 2052 6f77 2841 3d32 292c  (A=3), Row(A=2),
+0002b9c0: 2052 6f77 2841 3d31 295d 0a20 2020 2022   Row(A=1)].    "
+0002b9d0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0002b9e0: 6f6c 5f69 665f 7374 7228 632c 2022 6465  ol_if_str(c, "de
+0002b9f0: 7363 5f6e 756c 6c73 5f66 6972 7374 2229  sc_nulls_first")
+0002ba00: 0a20 2020 2072 6574 7572 6e20 632e 6465  .    return c.de
+0002ba10: 7363 5f6e 756c 6c73 5f66 6972 7374 2829  sc_nulls_first()
+0002ba20: 0a0a 0a64 6566 2064 6573 635f 6e75 6c6c  ...def desc_null
+0002ba30: 735f 6c61 7374 2863 3a20 436f 6c75 6d6e  s_last(c: Column
+0002ba40: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0002ba50: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+0002ba60: 6574 7572 6e73 2061 2043 6f6c 756d 6e20  eturns a Column 
+0002ba70: 6578 7072 6573 7369 6f6e 2077 6974 6820  expression with 
+0002ba80: 7661 6c75 6573 2073 6f72 7465 6420 696e  values sorted in
+0002ba90: 2064 6573 6365 6e64 696e 6720 6f72 6465   descending orde
+0002baa0: 720a 2020 2020 286e 756c 6c20 7661 6c75  r.    (null valu
+0002bab0: 6573 2073 6f72 7465 6420 6166 7465 7220  es sorted after 
+0002bac0: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
+0002bad0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
 0002bae0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
 0002baf0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002bb00: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
-0002bb10: 3130 5d2c 205b 312c 2031 315d 2c20 5b32  10], [1, 11], [2
-0002bb20: 2c20 3230 5d2c 205b 322c 2032 315d 5d2c  , 20], [2, 21]],
-0002bb30: 2073 6368 656d 613d 5b22 636f 6c75 6d6e   schema=["column
-0002bb40: 3122 2c20 2263 6f6c 756d 6e32 225d 290a  1", "column2"]).
-0002bb50: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002bb60: 656c 6563 7428 6466 5b22 636f 6c75 6d6e  elect(df["column
-0002bb70: 3122 5d2c 2064 665b 2263 6f6c 756d 6e32  1"], df["column2
-0002bb80: 225d 2c20 6c61 7374 5f76 616c 7565 2864  "], last_value(d
-0002bb90: 665b 2263 6f6c 756d 6e32 225d 292e 6f76  f["column2"]).ov
-0002bba0: 6572 2877 696e 646f 7729 2e61 735f 2822  er(window).as_("
-0002bbb0: 636f 6c75 6d6e 325f 6c61 7374 2229 292e  column2_last")).
-0002bbc0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0002bbd0: 2020 5b52 6f77 2843 4f4c 554d 4e31 3d31    [Row(COLUMN1=1
-0002bbe0: 2c20 434f 4c55 4d4e 323d 3130 2c20 434f  , COLUMN2=10, CO
-0002bbf0: 4c55 4d4e 325f 4c41 5354 3d31 3129 2c20  LUMN2_LAST=11), 
-0002bc00: 526f 7728 434f 4c55 4d4e 313d 312c 2043  Row(COLUMN1=1, C
-0002bc10: 4f4c 554d 4e32 3d31 312c 2043 4f4c 554d  OLUMN2=11, COLUM
-0002bc20: 4e32 5f4c 4153 543d 3131 292c 2052 6f77  N2_LAST=11), Row
-0002bc30: 2843 4f4c 554d 4e31 3d32 2c20 434f 4c55  (COLUMN1=2, COLU
-0002bc40: 4d4e 323d 3230 2c20 434f 4c55 4d4e 325f  MN2=20, COLUMN2_
-0002bc50: 4c41 5354 3d32 3129 2c20 526f 7728 434f  LAST=21), Row(CO
-0002bc60: 4c55 4d4e 313d 322c 2043 4f4c 554d 4e32  LUMN1=2, COLUMN2
-0002bc70: 3d32 312c 2043 4f4c 554d 4e32 5f4c 4153  =21, COLUMN2_LAS
-0002bc80: 543d 3231 295d 0a20 2020 2022 2222 0a20  T=21)].    """. 
-0002bc90: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0002bca0: 665f 7374 7228 652c 2022 6c61 7374 5f76  f_str(e, "last_v
-0002bcb0: 616c 7565 2229 0a20 2020 2072 6574 7572  alue").    retur
-0002bcc0: 6e20 436f 6c75 6d6e 284c 6173 7456 616c  n Column(LastVal
-0002bcd0: 7565 2863 2e5f 6578 7072 6573 7369 6f6e  ue(c._expression
-0002bce0: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 6967  , None, None, ig
-0002bcf0: 6e6f 7265 5f6e 756c 6c73 2929 0a0a 0a64  nore_nulls))...d
-0002bd00: 6566 2066 6972 7374 5f76 616c 7565 280a  ef first_value(.
-0002bd10: 2020 2020 653a 2043 6f6c 756d 6e4f 724e      e: ColumnOrN
-0002bd20: 616d 652c 0a20 2020 2069 676e 6f72 655f  ame,.    ignore_
-0002bd30: 6e75 6c6c 733a 2062 6f6f 6c20 3d20 4661  nulls: bool = Fa
-0002bd40: 6c73 652c 0a29 202d 3e20 436f 6c75 6d6e  lse,.) -> Column
-0002bd50: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0002bd60: 7475 726e 7320 7468 6520 6669 7273 7420  turns the first 
-0002bd70: 7661 6c75 6520 7769 7468 696e 2061 6e20  value within an 
-0002bd80: 6f72 6465 7265 6420 6772 6f75 7020 6f66  ordered group of
-0002bd90: 2076 616c 7565 732e 0a0a 2020 2020 4578   values...    Ex
-0002bda0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0002bdb0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0002bdc0: 616b 652e 736e 6f77 7061 726b 2e77 696e  ake.snowpark.win
-0002bdd0: 646f 7720 696d 706f 7274 2057 696e 646f  dow import Windo
-0002bde0: 770a 2020 2020 2020 2020 3e3e 3e20 7769  w.        >>> wi
-0002bdf0: 6e64 6f77 203d 2057 696e 646f 772e 7061  ndow = Window.pa
-0002be00: 7274 6974 696f 6e5f 6279 2822 636f 6c75  rtition_by("colu
-0002be10: 6d6e 3122 292e 6f72 6465 725f 6279 2822  mn1").order_by("
-0002be20: 636f 6c75 6d6e 3222 290a 2020 2020 2020  column2").      
-0002be30: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0002be40: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0002be50: 616d 6528 5b5b 312c 2031 305d 2c20 5b31  ame([[1, 10], [1
-0002be60: 2c20 3131 5d2c 205b 322c 2032 305d 2c20  , 11], [2, 20], 
-0002be70: 5b32 2c20 3231 5d5d 2c20 7363 6865 6d61  [2, 21]], schema
-0002be80: 3d5b 2263 6f6c 756d 6e31 222c 2022 636f  =["column1", "co
-0002be90: 6c75 6d6e 3222 5d29 0a20 2020 2020 2020  lumn2"]).       
-0002bea0: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
-0002beb0: 665b 2263 6f6c 756d 6e31 225d 2c20 6466  f["column1"], df
-0002bec0: 5b22 636f 6c75 6d6e 3222 5d2c 2066 6972  ["column2"], fir
-0002bed0: 7374 5f76 616c 7565 2864 665b 2263 6f6c  st_value(df["col
-0002bee0: 756d 6e32 225d 292e 6f76 6572 2877 696e  umn2"]).over(win
-0002bef0: 646f 7729 2e61 735f 2822 636f 6c75 6d6e  dow).as_("column
-0002bf00: 325f 6669 7273 7422 2929 2e63 6f6c 6c65  2_first")).colle
-0002bf10: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0002bf20: 7728 434f 4c55 4d4e 313d 312c 2043 4f4c  w(COLUMN1=1, COL
-0002bf30: 554d 4e32 3d31 302c 2043 4f4c 554d 4e32  UMN2=10, COLUMN2
-0002bf40: 5f46 4952 5354 3d31 3029 2c20 526f 7728  _FIRST=10), Row(
-0002bf50: 434f 4c55 4d4e 313d 312c 2043 4f4c 554d  COLUMN1=1, COLUM
-0002bf60: 4e32 3d31 312c 2043 4f4c 554d 4e32 5f46  N2=11, COLUMN2_F
-0002bf70: 4952 5354 3d31 3029 2c20 526f 7728 434f  IRST=10), Row(CO
-0002bf80: 4c55 4d4e 313d 322c 2043 4f4c 554d 4e32  LUMN1=2, COLUMN2
-0002bf90: 3d32 302c 2043 4f4c 554d 4e32 5f46 4952  =20, COLUMN2_FIR
-0002bfa0: 5354 3d32 3029 2c20 526f 7728 434f 4c55  ST=20), Row(COLU
-0002bfb0: 4d4e 313d 322c 2043 4f4c 554d 4e32 3d32  MN1=2, COLUMN2=2
-0002bfc0: 312c 2043 4f4c 554d 4e32 5f46 4952 5354  1, COLUMN2_FIRST
-0002bfd0: 3d32 3029 5d0a 2020 2020 2222 220a 2020  =20)].    """.  
-0002bfe0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0002bff0: 5f73 7472 2865 2c20 226c 6173 745f 7661  _str(e, "last_va
-0002c000: 6c75 6522 290a 2020 2020 7265 7475 726e  lue").    return
-0002c010: 2043 6f6c 756d 6e28 4669 7273 7456 616c   Column(FirstVal
-0002c020: 7565 2863 2e5f 6578 7072 6573 7369 6f6e  ue(c._expression
-0002c030: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 6967  , None, None, ig
-0002c040: 6e6f 7265 5f6e 756c 6c73 2929 0a0a 0a64  nore_nulls))...d
-0002c050: 6566 206e 7469 6c65 2865 3a20 556e 696f  ef ntile(e: Unio
-0002c060: 6e5b 696e 742c 2043 6f6c 756d 6e4f 724e  n[int, ColumnOrN
-0002c070: 616d 655d 2920 2d3e 2043 6f6c 756d 6e3a  ame]) -> Column:
-0002c080: 0a20 2020 2022 2222 0a20 2020 2044 6976  .    """.    Div
-0002c090: 6964 6573 2061 6e20 6f72 6465 7265 6420  ides an ordered 
-0002c0a0: 6461 7461 2073 6574 2065 7175 616c 6c79  data set equally
-0002c0b0: 2069 6e74 6f20 7468 6520 6e75 6d62 6572   into the number
-0002c0c0: 206f 6620 6275 636b 6574 7320 7370 6563   of buckets spec
-0002c0d0: 6966 6965 6420 6279 206e 2e0a 2020 2020  ified by n..    
-0002c0e0: 4275 636b 6574 7320 6172 6520 7365 7175  Buckets are sequ
-0002c0f0: 656e 7469 616c 6c79 206e 756d 6265 7265  entially numbere
-0002c100: 6420 3120 7468 726f 7567 6820 6e2e 0a0a  d 1 through n...
-0002c110: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0002c120: 2020 653a 2054 6865 2064 6573 6972 6564    e: The desired
-0002c130: 206e 756d 6265 7220 6f66 2062 7563 6b65   number of bucke
-0002c140: 7473 3b20 6d75 7374 2062 6520 6120 706f  ts; must be a po
-0002c150: 7369 7469 7665 2069 6e74 6567 6572 2076  sitive integer v
-0002c160: 616c 7565 2e0a 0a20 2020 2045 7861 6d70  alue...    Examp
-0002c170: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0002c180: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0002c190: 2e73 6e6f 7770 6172 6b2e 7769 6e64 6f77  .snowpark.window
-0002c1a0: 2069 6d70 6f72 7420 5769 6e64 6f77 0a20   import Window. 
-0002c1b0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002c1c0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0002c1d0: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-0002c1e0: 2020 2e2e 2e20 2020 2020 5b5b 2243 222c    ...     [["C",
-0002c1f0: 2022 5350 5922 2c20 335d 2c20 5b22 4322   "SPY", 3], ["C"
-0002c200: 2c20 2241 4150 4c22 2c20 3130 5d2c 205b  , "AAPL", 10], [
-0002c210: 224e 222c 2022 5350 5922 2c20 355d 2c20  "N", "SPY", 5], 
-0002c220: 5b22 4e22 2c20 2241 4150 4c22 2c20 375d  ["N", "AAPL", 7]
-0002c230: 2c20 5b22 5122 2c20 224d 5346 5422 2c20  , ["Q", "MSFT", 
-0002c240: 335d 5d2c 0a20 2020 2020 2020 202e 2e2e  3]],.        ...
-0002c250: 2020 2020 2073 6368 656d 613d 5b22 6578       schema=["ex
-0002c260: 6368 616e 6765 222c 2022 7379 6d62 6f6c  change", "symbol
-0002c270: 222c 2022 7368 6172 6573 225d 0a20 2020  ", "shares"].   
-0002c280: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-0002c290: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0002c2a0: 2863 6f6c 2822 6578 6368 616e 6765 2229  (col("exchange")
-0002c2b0: 2c20 636f 6c28 2273 796d 626f 6c22 292c  , col("symbol"),
-0002c2c0: 206e 7469 6c65 2833 292e 6f76 6572 2857   ntile(3).over(W
-0002c2d0: 696e 646f 772e 7061 7274 6974 696f 6e5f  indow.partition_
-0002c2e0: 6279 2822 6578 6368 616e 6765 2229 2e6f  by("exchange").o
-0002c2f0: 7264 6572 5f62 7928 2273 6861 7265 7322  rder_by("shares"
-0002c300: 2929 2e61 6c69 6173 2822 6e74 696c 655f  )).alias("ntile_
-0002c310: 3322 2929 2e73 686f 7728 290a 2020 2020  3")).show().    
-0002c320: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002c330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c340: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002c350: 2020 7c22 4558 4348 414e 4745 2220 207c    |"EXCHANGE"  |
-0002c360: 2253 594d 424f 4c22 2020 7c22 4e54 494c  "SYMBOL"  |"NTIL
-0002c370: 455f 3322 2020 7c0a 2020 2020 2020 2020  E_3"  |.        
-0002c380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c3a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c51  -----.        |Q
-0002c3b0: 2020 2020 2020 2020 2020 207c 4d53 4654             |MSFT
-0002c3c0: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
-0002c3d0: 2020 7c0a 2020 2020 2020 2020 7c4e 2020    |.        |N  
-0002c3e0: 2020 2020 2020 2020 207c 5350 5920 2020           |SPY   
-0002c3f0: 2020 2020 7c31 2020 2020 2020 2020 2020      |1          
-0002c400: 7c0a 2020 2020 2020 2020 7c4e 2020 2020  |.        |N    
-0002c410: 2020 2020 2020 207c 4141 504c 2020 2020         |AAPL    
-0002c420: 2020 7c32 2020 2020 2020 2020 2020 7c0a    |2          |.
-0002c430: 2020 2020 2020 2020 7c43 2020 2020 2020          |C      
-0002c440: 2020 2020 207c 5350 5920 2020 2020 2020       |SPY       
-0002c450: 7c31 2020 2020 2020 2020 2020 7c0a 2020  |1          |.  
-0002c460: 2020 2020 2020 7c43 2020 2020 2020 2020        |C        
-0002c470: 2020 207c 4141 504c 2020 2020 2020 7c32     |AAPL      |2
-0002c480: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0002c490: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002c4a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c4b0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002c4c0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-0002c4d0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0002c4e0: 6f5f 636f 6c5f 6966 5f73 7472 5f6f 725f  o_col_if_str_or_
-0002c4f0: 696e 7428 652c 2022 6e74 696c 6522 290a  int(e, "ntile").
-0002c500: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0002c510: 696e 2822 6e74 696c 6522 2928 6329 0a0a  in("ntile")(c)..
-0002c520: 0a64 6566 2070 6572 6365 6e74 696c 655f  .def percentile_
-0002c530: 636f 6e74 2870 6572 6365 6e74 696c 653a  cont(percentile:
-0002c540: 2066 6c6f 6174 2920 2d3e 2043 6f6c 756d   float) -> Colum
-0002c550: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-0002c560: 6574 7572 6e20 6120 7065 7263 656e 7469  eturn a percenti
-0002c570: 6c65 2076 616c 7565 2062 6173 6564 206f  le value based o
-0002c580: 6e20 6120 636f 6e74 696e 756f 7573 2064  n a continuous d
-0002c590: 6973 7472 6962 7574 696f 6e20 6f66 2074  istribution of t
-0002c5a0: 6865 0a20 2020 2069 6e70 7574 2063 6f6c  he.    input col
-0002c5b0: 756d 6e2e 2049 6620 6e6f 2069 6e70 7574  umn. If no input
-0002c5c0: 2072 6f77 206c 6965 7320 6578 6163 746c   row lies exactl
-0002c5d0: 7920 6174 2074 6865 2064 6573 6972 6564  y at the desired
-0002c5e0: 2070 6572 6365 6e74 696c 652c 0a20 2020   percentile,.   
-0002c5f0: 2074 6865 2072 6573 756c 7420 6973 2063   the result is c
-0002c600: 616c 6375 6c61 7465 6420 7573 696e 6720  alculated using 
-0002c610: 6c69 6e65 6172 2069 6e74 6572 706f 6c61  linear interpola
-0002c620: 7469 6f6e 206f 6620 7468 6520 7477 6f20  tion of the two 
-0002c630: 6e65 6172 6573 740a 2020 2020 696e 7075  nearest.    inpu
-0002c640: 7420 7661 6c75 6573 2e20 4e55 4c4c 2076  t values. NULL v
-0002c650: 616c 7565 7320 6172 6520 6967 6e6f 7265  alues are ignore
-0002c660: 6420 696e 2074 6865 2063 616c 6375 6c61  d in the calcula
-0002c670: 7469 6f6e 2e0a 0a20 2020 2041 7267 733a  tion...    Args:
-0002c680: 0a20 2020 2020 2020 2070 6572 6365 6e74  .        percent
-0002c690: 696c 653a 2074 6865 2070 6572 6365 6e74  ile: the percent
-0002c6a0: 696c 6520 6f66 2074 6865 2076 616c 7565  ile of the value
-0002c6b0: 2074 6861 7420 796f 7520 7761 6e74 2074   that you want t
-0002c6c0: 6f20 6669 6e64 2e0a 2020 2020 2020 2020  o find..        
-0002c6d0: 2020 2020 5468 6520 7065 7263 656e 7469      The percenti
-0002c6e0: 6c65 206d 7573 7420 6265 2061 2063 6f6e  le must be a con
-0002c6f0: 7374 616e 7420 6265 7477 6565 6e20 302e  stant between 0.
-0002c700: 3020 616e 6420 312e 302e 2046 6f72 2065  0 and 1.0. For e
-0002c710: 7861 6d70 6c65 2c0a 2020 2020 2020 2020  xample,.        
-0002c720: 2020 2020 6966 2079 6f75 2077 616e 7420      if you want 
-0002c730: 746f 2066 696e 6420 7468 6520 7661 6c75  to find the valu
-0002c740: 6520 6174 2074 6865 2039 3074 6820 7065  e at the 90th pe
-0002c750: 7263 656e 7469 6c65 2c20 7370 6563 6966  rcentile, specif
-0002c760: 7920 302e 392e 0a0a 2020 2020 4578 616d  y 0.9...    Exam
-0002c770: 706c 653a 0a0a 2020 2020 2020 2020 3e3e  ple:..        >>
-0002c780: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0002c790: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0002c7a0: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
-0002c7b0: 2020 2830 2c20 3029 2c20 2830 2c20 3130    (0, 0), (0, 10
-0002c7c0: 292c 2028 302c 2032 3029 2c20 2830 2c20  ), (0, 20), (0, 
-0002c7d0: 3330 292c 2028 302c 2034 3029 2c0a 2020  30), (0, 40),.  
-0002c7e0: 2020 2020 2020 2e2e 2e20 2020 2020 2831        ...     (1
-0002c7f0: 2c20 3130 292c 2028 312c 2032 3029 2c20  , 10), (1, 20), 
-0002c800: 2832 2c20 3130 292c 2028 322c 2032 3029  (2, 10), (2, 20)
-0002c810: 2c20 2832 2c20 3235 292c 0a20 2020 2020  , (2, 25),.     
-0002c820: 2020 202e 2e2e 2020 2020 2028 322c 2033     ...     (2, 3
-0002c830: 3029 2c20 2833 2c20 3630 292c 2028 342c  0), (3, 60), (4,
-0002c840: 204e 6f6e 6529 0a20 2020 2020 2020 202e   None).        .
-0002c850: 2e2e 205d 2c20 7363 6865 6d61 3d5b 226b  .. ], schema=["k
-0002c860: 222c 2022 7622 5d29 0a20 2020 2020 2020  ", "v"]).       
-0002c870: 203e 3e3e 2064 662e 6772 6f75 705f 6279   >>> df.group_by
-0002c880: 2822 6b22 292e 6167 6728 7065 7263 656e  ("k").agg(percen
-0002c890: 7469 6c65 5f63 6f6e 7428 302e 3235 292e  tile_cont(0.25).
-0002c8a0: 7769 7468 696e 5f67 726f 7570 2822 7622  within_group("v"
-0002c8b0: 292e 6173 5f28 2270 6572 6365 6e74 696c  ).as_("percentil
-0002c8c0: 6522 2929 2e73 6f72 7428 226b 2229 2e63  e")).sort("k").c
-0002c8d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0002c8e0: 205b 526f 7728 4b3d 302c 2050 4552 4345   [Row(K=0, PERCE
-0002c8f0: 4e54 494c 453d 4465 6369 6d61 6c28 2731  NTILE=Decimal('1
-0002c900: 302e 3030 3027 2929 2c20 5c0a 526f 7728  0.000')), \.Row(
-0002c910: 4b3d 312c 2050 4552 4345 4e54 494c 453d  K=1, PERCENTILE=
-0002c920: 4465 6369 6d61 6c28 2731 322e 3530 3027  Decimal('12.500'
-0002c930: 2929 2c20 5c0a 526f 7728 4b3d 322c 2050  )), \.Row(K=2, P
-0002c940: 4552 4345 4e54 494c 453d 4465 6369 6d61  ERCENTILE=Decima
-0002c950: 6c28 2731 372e 3530 3027 2929 2c20 5c0a  l('17.500')), \.
-0002c960: 526f 7728 4b3d 332c 2050 4552 4345 4e54  Row(K=3, PERCENT
-0002c970: 494c 453d 4465 6369 6d61 6c28 2736 302e  ILE=Decimal('60.
-0002c980: 3030 3027 2929 2c20 5c0a 526f 7728 4b3d  000')), \.Row(K=
-0002c990: 342c 2050 4552 4345 4e54 494c 453d 4e6f  4, PERCENTILE=No
-0002c9a0: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
-0002c9b0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0002c9c0: 2270 6572 6365 6e74 696c 655f 636f 6e74  "percentile_cont
-0002c9d0: 2229 2870 6572 6365 6e74 696c 6529 0a0a  ")(percentile)..
-0002c9e0: 0a64 6566 2067 7265 6174 6573 7428 2a63  .def greatest(*c
-0002c9f0: 6f6c 756d 6e73 3a20 436f 6c75 6d6e 4f72  olumns: ColumnOr
-0002ca00: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002ca10: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-0002ca20: 7572 6e73 2074 6865 206c 6172 6765 7374  urns the largest
-0002ca30: 2076 616c 7565 2066 726f 6d20 6120 6c69   value from a li
-0002ca40: 7374 206f 6620 6578 7072 6573 7369 6f6e  st of expression
-0002ca50: 732e 0a20 2020 2049 6620 616e 7920 6f66  s..    If any of
-0002ca60: 2074 6865 2061 7267 756d 656e 7420 7661   the argument va
-0002ca70: 6c75 6573 2069 7320 4e55 4c4c 2c20 7468  lues is NULL, th
-0002ca80: 6520 7265 7375 6c74 2069 7320 4e55 4c4c  e result is NULL
-0002ca90: 2e0a 2020 2020 4752 4541 5445 5354 2073  ..    GREATEST s
-0002caa0: 7570 706f 7274 7320 616c 6c20 6461 7461  upports all data
-0002cab0: 2074 7970 6573 2c20 696e 636c 7564 696e   types, includin
-0002cac0: 6720 5641 5249 414e 542e 0a0a 2020 2020  g VARIANT...    
-0002cad0: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
-0002cae0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002caf0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0002cb00: 6672 616d 6528 5b5b 312c 2032 2c20 335d  frame([[1, 2, 3]
-0002cb10: 2c20 5b32 2c20 342c 202d 315d 2c20 5b33  , [2, 4, -1], [3
-0002cb20: 2c20 362c 204e 6f6e 655d 5d2c 2073 6368  , 6, None]], sch
-0002cb30: 656d 613d 5b22 6122 2c20 2262 222c 2022  ema=["a", "b", "
-0002cb40: 6322 5d29 0a20 2020 2020 2020 203e 3e3e  c"]).        >>>
-0002cb50: 2064 662e 7365 6c65 6374 2867 7265 6174   df.select(great
-0002cb60: 6573 7428 6466 5b22 6122 5d2c 2064 665b  est(df["a"], df[
-0002cb70: 2262 225d 2c20 6466 5b22 6322 5d29 2e61  "b"], df["c"]).a
-0002cb80: 6c69 6173 2822 6772 6561 7465 7374 2229  lias("greatest")
-0002cb90: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0002cba0: 2020 2020 5b52 6f77 2847 5245 4154 4553      [Row(GREATES
-0002cbb0: 543d 3329 2c20 526f 7728 4752 4541 5445  T=3), Row(GREATE
-0002cbc0: 5354 3d34 292c 2052 6f77 2847 5245 4154  ST=4), Row(GREAT
-0002cbd0: 4553 543d 4e6f 6e65 295d 0a20 2020 2022  EST=None)].    "
-0002cbe0: 2222 0a20 2020 2063 203d 205b 5f74 6f5f  "".    c = [_to_
-0002cbf0: 636f 6c5f 6966 5f73 7472 2865 782c 2022  col_if_str(ex, "
-0002cc00: 6772 6561 7465 7374 2229 2066 6f72 2065  greatest") for e
-0002cc10: 7820 696e 2063 6f6c 756d 6e73 5d0a 2020  x in columns].  
-0002cc20: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0002cc30: 2822 6772 6561 7465 7374 2229 282a 6329  ("greatest")(*c)
-0002cc40: 0a0a 0a64 6566 206c 6561 7374 282a 636f  ...def least(*co
-0002cc50: 6c75 6d6e 733a 2043 6f6c 756d 6e4f 724e  lumns: ColumnOrN
-0002cc60: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0002cc70: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-0002cc80: 726e 7320 7468 6520 736d 616c 6c65 7374  rns the smallest
-0002cc90: 2076 616c 7565 2066 726f 6d20 6120 6c69   value from a li
-0002cca0: 7374 206f 6620 6578 7072 6573 7369 6f6e  st of expression
-0002ccb0: 732e 0a20 2020 2049 6620 616e 7920 6f66  s..    If any of
-0002ccc0: 2074 6865 2061 7267 756d 656e 7420 7661   the argument va
-0002ccd0: 6c75 6573 2069 7320 4e55 4c4c 2c20 7468  lues is NULL, th
-0002cce0: 6520 7265 7375 6c74 2069 7320 4e55 4c4c  e result is NULL
-0002ccf0: 2e0a 2020 2020 4c45 4153 5420 7375 7070  ..    LEAST supp
-0002cd00: 6f72 7473 2061 6c6c 2064 6174 6120 7479  orts all data ty
-0002cd10: 7065 732c 2069 6e63 6c75 6469 6e67 2056  pes, including V
-0002cd20: 4152 4941 4e54 2e0a 0a20 2020 2045 7861  ARIANT...    Exa
-0002cd30: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0002cd40: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002cd50: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0002cd60: 6528 5b5b 312c 2032 2c20 335d 2c20 5b32  e([[1, 2, 3], [2
-0002cd70: 2c20 342c 202d 315d 2c20 5b33 2c20 362c  , 4, -1], [3, 6,
-0002cd80: 204e 6f6e 655d 5d2c 2073 6368 656d 613d   None]], schema=
-0002cd90: 5b22 6122 2c20 2262 222c 2022 6322 5d29  ["a", "b", "c"])
-0002cda0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002cdb0: 7365 6c65 6374 286c 6561 7374 2864 665b  select(least(df[
-0002cdc0: 2261 225d 2c20 6466 5b22 6222 5d2c 2064  "a"], df["b"], d
-0002cdd0: 665b 2263 225d 292e 616c 6961 7328 226c  f["c"]).alias("l
-0002cde0: 6561 7374 2229 292e 636f 6c6c 6563 7428  east")).collect(
-0002cdf0: 290a 2020 2020 2020 2020 5b52 6f77 284c  ).        [Row(L
-0002ce00: 4541 5354 3d31 292c 2052 6f77 284c 4541  EAST=1), Row(LEA
-0002ce10: 5354 3d2d 3129 2c20 526f 7728 4c45 4153  ST=-1), Row(LEAS
-0002ce20: 543d 4e6f 6e65 295d 0a20 2020 2022 2222  T=None)].    """
-0002ce30: 0a20 2020 2063 203d 205b 5f74 6f5f 636f  .    c = [_to_co
-0002ce40: 6c5f 6966 5f73 7472 2865 782c 2022 6c65  l_if_str(ex, "le
-0002ce50: 6173 7422 2920 666f 7220 6578 2069 6e20  ast") for ex in 
-0002ce60: 636f 6c75 6d6e 735d 0a20 2020 2072 6574  columns].    ret
-0002ce70: 7572 6e20 6275 696c 7469 6e28 226c 6561  urn builtin("lea
-0002ce80: 7374 2229 282a 6329 0a0a 0a64 6566 206c  st")(*c)...def l
-0002ce90: 6973 7461 6767 2865 3a20 436f 6c75 6d6e  istagg(e: Column
-0002cea0: 4f72 4e61 6d65 2c20 6465 6c69 6d69 7465  OrName, delimite
-0002ceb0: 723a 2073 7472 203d 2022 222c 2069 735f  r: str = "", is_
-0002cec0: 6469 7374 696e 6374 3a20 626f 6f6c 203d  distinct: bool =
-0002ced0: 2046 616c 7365 2920 2d3e 2043 6f6c 756d   False) -> Colum
-0002cee0: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-0002cef0: 6574 7572 6e73 2074 6865 2063 6f6e 6361  eturns the conca
-0002cf00: 7465 6e61 7465 6420 696e 7075 7420 7661  tenated input va
-0002cf10: 6c75 6573 2c20 7365 7061 7261 7465 6420  lues, separated 
-0002cf20: 6279 2060 6465 6c69 6d69 7465 7260 2073  by `delimiter` s
-0002cf30: 7472 696e 672e 0a20 2020 2053 6565 2060  tring..    See `
-0002cf40: 4c49 5354 4147 4720 3c68 7474 7073 3a2f  LISTAGG <https:/
-0002cf50: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-0002cf60: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-0002cf70: 656e 6365 2f66 756e 6374 696f 6e73 2f6c  ence/functions/l
-0002cf80: 6973 7461 6767 2e68 746d 6c3e 605f 2066  istagg.html>`_ f
-0002cf90: 6f72 2064 6574 6169 6c73 2e0a 0a20 2020  or details...   
-0002cfa0: 2041 7267 733a 0a20 2020 2020 2020 2065   Args:.        e
-0002cfb0: 3a20 4120 3a63 6c61 7373 3a60 436f 6c75  : A :class:`Colu
-0002cfc0: 6d6e 6020 6f62 6a65 6374 206f 7220 636f  mn` object or co
-0002cfd0: 6c75 6d6e 206e 616d 6520 7468 6174 2064  lumn name that d
-0002cfe0: 6574 6572 6d69 6e65 7320 7468 6520 7661  etermines the va
-0002cff0: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
-0002d000: 2074 6f20 6265 2070 7574 2069 6e74 6f20   to be put into 
-0002d010: 7468 6520 6c69 7374 2e0a 2020 2020 2020  the list..      
-0002d020: 2020 6465 6c69 6d69 7465 723a 2041 2073    delimiter: A s
-0002d030: 7472 696e 6720 6465 6c69 6d69 7465 722e  tring delimiter.
-0002d040: 0a20 2020 2020 2020 2069 735f 6469 7374  .        is_dist
-0002d050: 696e 6374 3a20 5768 6574 6865 7220 7468  inct: Whether th
-0002d060: 6520 696e 7075 7420 6578 7072 6573 7369  e input expressi
-0002d070: 6f6e 2069 7320 6469 7374 696e 6374 2e0a  on is distinct..
-0002d080: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-0002d090: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002d0a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002d0b0: 5f64 6174 6166 7261 6d65 285b 312c 2032  _dataframe([1, 2
-0002d0c0: 2c20 332c 2032 2c20 342c 2035 5d2c 2073  , 3, 2, 4, 5], s
-0002d0d0: 6368 656d 613d 5b22 636f 6c22 5d29 0a20  chema=["col"]). 
-0002d0e0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002d0f0: 6c65 6374 286c 6973 7461 6767 2822 636f  lect(listagg("co
-0002d100: 6c22 2c20 222c 2229 2e77 6974 6869 6e5f  l", ",").within_
-0002d110: 6772 6f75 7028 6466 5b22 636f 6c22 5d2e  group(df["col"].
-0002d120: 6173 6328 2929 2e61 735f 2822 7265 7375  asc()).as_("resu
-0002d130: 6c74 2229 292e 636f 6c6c 6563 7428 290a  lt")).collect().
-0002d140: 2020 2020 2020 2020 5b52 6f77 2852 4553          [Row(RES
-0002d150: 554c 543d 2731 2c32 2c32 2c33 2c34 2c35  ULT='1,2,2,3,4,5
-0002d160: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-0002d170: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0002d180: 7472 2865 2c20 226c 6973 7461 6767 2229  tr(e, "listagg")
-0002d190: 0a20 2020 2072 6574 7572 6e20 436f 6c75  .    return Colu
-0002d1a0: 6d6e 284c 6973 7441 6767 2863 2e5f 6578  mn(ListAgg(c._ex
-0002d1b0: 7072 6573 7369 6f6e 2c20 6465 6c69 6d69  pression, delimi
-0002d1c0: 7465 722c 2069 735f 6469 7374 696e 6374  ter, is_distinct
-0002d1d0: 2929 0a0a 0a64 6566 2077 6865 6e5f 6d61  ))...def when_ma
-0002d1e0: 7463 6865 6428 0a20 2020 2063 6f6e 6469  tched(.    condi
-0002d1f0: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b43  tion: Optional[C
-0002d200: 6f6c 756d 6e5d 203d 204e 6f6e 652c 0a29  olumn] = None,.)
-0002d210: 202d 3e20 2273 6e6f 7766 6c61 6b65 2e73   -> "snowflake.s
-0002d220: 6e6f 7770 6172 6b2e 7461 626c 652e 5768  nowpark.table.Wh
-0002d230: 656e 4d61 7463 6865 6443 6c61 7573 6522  enMatchedClause"
-0002d240: 3a0a 2020 2020 2222 220a 2020 2020 5370  :.    """.    Sp
-0002d250: 6563 6966 6965 7320 6120 6d61 7463 6865  ecifies a matche
-0002d260: 6420 636c 6175 7365 2066 6f72 2074 6865  d clause for the
-0002d270: 203a 6d65 7468 3a60 5461 626c 652e 6d65   :meth:`Table.me
-0002d280: 7267 6520 3c73 6e6f 7766 6c61 6b65 2e73  rge <snowflake.s
-0002d290: 6e6f 7770 6172 6b2e 5461 626c 652e 6d65  nowpark.Table.me
-0002d2a0: 7267 653e 6020 6163 7469 6f6e 2e0a 2020  rge>` action..  
-0002d2b0: 2020 5365 6520 3a63 6c61 7373 3a60 7e73    See :class:`~s
-0002d2c0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002d2d0: 6b2e 7461 626c 652e 5768 656e 4d61 7463  k.table.WhenMatc
-0002d2e0: 6865 6443 6c61 7573 6560 2066 6f72 2064  hedClause` for d
-0002d2f0: 6574 6169 6c73 2e0a 0a20 2020 2043 6f6e  etails...    Con
-0002d300: 7665 6e69 656e 6365 2066 756e 6374 696f  venience functio
-0002d310: 6e20 746f 2063 7265 6174 6520 6120 6e65  n to create a ne
-0002d320: 7720 5768 656e 4d61 7463 6865 6443 6c61  w WhenMatchedCla
-0002d330: 7573 6520 696e 7374 616e 6365 2077 6869  use instance whi
-0002d340: 6368 2069 7320 7265 7175 6972 6564 2074  ch is required t
-0002d350: 6f67 6574 6865 7220 7769 7468 2061 6e20  ogether with an 
-0002d360: 6163 7469 6f6e 2077 6865 6e20 6d65 7267  action when merg
-0002d370: 696e 670a 2020 2020 6120 536e 6f77 7061  ing.    a Snowpa
-0002d380: 726b 2074 6162 6c65 2077 6974 6820 6120  rk table with a 
-0002d390: 536e 6f77 7061 726b 2044 6174 6146 7261  Snowpark DataFra
-0002d3a0: 6d65 2028 7365 6520 736e 6f77 666c 616b  me (see snowflak
-0002d3b0: 652e 736e 6f77 7061 726b 2e54 6162 6c65  e.snowpark.Table
-0002d3c0: 2e6d 6572 6765 2066 6f72 206d 6f72 6520  .merge for more 
-0002d3d0: 6465 7461 696c 7329 2e0a 0a20 2020 2045  details)...    E
-0002d3e0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0002d3f0: 2020 3e3e 3e20 7461 7267 6574 5f64 6620    >>> target_df 
-0002d400: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002d410: 5f64 6174 6166 7261 6d65 285b 2831 302c  _dataframe([(10,
-0002d420: 2022 6f6c 6422 292c 2028 3130 2c20 2274   "old"), (10, "t
-0002d430: 6f6f 5f6f 6c64 2229 2c20 2831 312c 2022  oo_old"), (11, "
-0002d440: 6f6c 6422 295d 2c20 7363 6865 6d61 3d5b  old")], schema=[
-0002d450: 226b 6579 222c 2022 7661 6c75 6522 5d29  "key", "value"])
-0002d460: 0a20 2020 2020 2020 203e 3e3e 2074 6172  .        >>> tar
-0002d470: 6765 745f 6466 2e77 7269 7465 2e73 6176  get_df.write.sav
-0002d480: 655f 6173 5f74 6162 6c65 2822 6d79 5f74  e_as_table("my_t
-0002d490: 6162 6c65 222c 206d 6f64 653d 226f 7665  able", mode="ove
-0002d4a0: 7277 7269 7465 222c 2074 6162 6c65 5f74  rwrite", table_t
-0002d4b0: 7970 653d 2274 656d 706f 7261 7279 2229  ype="temporary")
-0002d4c0: 0a20 2020 2020 2020 203e 3e3e 2074 6172  .        >>> tar
-0002d4d0: 6765 7420 3d20 7365 7373 696f 6e2e 7461  get = session.ta
-0002d4e0: 626c 6528 226d 795f 7461 626c 6522 290a  ble("my_table").
-0002d4f0: 2020 2020 2020 2020 3e3e 3e20 736f 7572          >>> sour
-0002d500: 6365 203d 2073 6573 7369 6f6e 2e63 7265  ce = session.cre
-0002d510: 6174 655f 6461 7461 6672 616d 6528 5b28  ate_dataframe([(
-0002d520: 3130 2c20 226e 6577 2229 2c20 2831 322c  10, "new"), (12,
-0002d530: 2022 6e65 7722 292c 2028 3133 2c20 226f   "new"), (13, "o
-0002d540: 6c64 2229 5d2c 2073 6368 656d 613d 5b22  ld")], schema=["
-0002d550: 6b65 7922 2c20 2276 616c 7565 225d 290a  key", "value"]).
-0002d560: 2020 2020 2020 2020 3e3e 3e20 7461 7267          >>> targ
-0002d570: 6574 2e6d 6572 6765 2873 6f75 7263 652c  et.merge(source,
-0002d580: 2028 7461 7267 6574 5b22 6b65 7922 5d20   (target["key"] 
-0002d590: 3d3d 2073 6f75 7263 655b 226b 6579 225d  == source["key"]
-0002d5a0: 2920 2620 2874 6172 6765 745b 2276 616c  ) & (target["val
-0002d5b0: 7565 225d 203d 3d20 2274 6f6f 5f6f 6c64  ue"] == "too_old
-0002d5c0: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
-0002d5d0: 2020 2020 2020 2020 2020 2020 205b 7768               [wh
-0002d5e0: 656e 5f6d 6174 6368 6564 2829 2e75 7064  en_matched().upd
-0002d5f0: 6174 6528 7b22 7661 6c75 6522 3a20 736f  ate({"value": so
-0002d600: 7572 6365 5b22 7661 6c75 6522 5d7d 295d  urce["value"]})]
-0002d610: 290a 2020 2020 2020 2020 4d65 7267 6552  ).        MergeR
-0002d620: 6573 756c 7428 726f 7773 5f69 6e73 6572  esult(rows_inser
-0002d630: 7465 643d 302c 2072 6f77 735f 7570 6461  ted=0, rows_upda
-0002d640: 7465 643d 312c 2072 6f77 735f 6465 6c65  ted=1, rows_dele
-0002d650: 7465 643d 3029 0a20 2020 2020 2020 203e  ted=0).        >
-0002d660: 3e3e 2074 6172 6765 742e 636f 6c6c 6563  >> target.collec
-0002d670: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0002d680: 284b 4559 3d31 302c 2056 414c 5545 3d27  (KEY=10, VALUE='
-0002d690: 6f6c 6427 292c 2052 6f77 284b 4559 3d31  old'), Row(KEY=1
-0002d6a0: 302c 2056 414c 5545 3d27 6e65 7727 292c  0, VALUE='new'),
-0002d6b0: 2052 6f77 284b 4559 3d31 312c 2056 414c   Row(KEY=11, VAL
-0002d6c0: 5545 3d27 6f6c 6427 295d 0a0a 2020 2020  UE='old')]..    
-0002d6d0: 2222 220a 2020 2020 7265 7475 726e 2073  """.    return s
-0002d6e0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002d6f0: 6b2e 7461 626c 652e 5768 656e 4d61 7463  k.table.WhenMatc
-0002d700: 6865 6443 6c61 7573 6528 636f 6e64 6974  hedClause(condit
-0002d710: 696f 6e29 0a0a 0a64 6566 2077 6865 6e5f  ion)...def when_
-0002d720: 6e6f 745f 6d61 7463 6865 6428 0a20 2020  not_matched(.   
-0002d730: 2063 6f6e 6469 7469 6f6e 3a20 4f70 7469   condition: Opti
-0002d740: 6f6e 616c 5b43 6f6c 756d 6e5d 203d 204e  onal[Column] = N
-0002d750: 6f6e 652c 0a29 202d 3e20 2273 6e6f 7766  one,.) -> "snowf
-0002d760: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7461  lake.snowpark.ta
-0002d770: 626c 652e 5768 656e 4e6f 744d 6174 6368  ble.WhenNotMatch
-0002d780: 6564 436c 6175 7365 223a 0a20 2020 2022  edClause":.    "
-0002d790: 2222 0a20 2020 2053 7065 6369 6669 6573  "".    Specifies
-0002d7a0: 2061 206e 6f74 2d6d 6174 6368 6564 2063   a not-matched c
-0002d7b0: 6c61 7573 6520 666f 7220 7468 6520 3a6d  lause for the :m
-0002d7c0: 6574 683a 6054 6162 6c65 2e6d 6572 6765  eth:`Table.merge
-0002d7d0: 203c 736e 6f77 666c 616b 652e 736e 6f77   <snowflake.snow
-0002d7e0: 7061 726b 2e54 6162 6c65 2e6d 6572 6765  park.Table.merge
-0002d7f0: 3e60 2061 6374 696f 6e2e 0a20 2020 2053  >` action..    S
-0002d800: 6565 203a 636c 6173 733a 607e 736e 6f77  ee :class:`~snow
-0002d810: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0002d820: 6162 6c65 2e57 6865 6e4e 6f74 4d61 7463  able.WhenNotMatc
-0002d830: 6865 6443 6c61 7573 6560 2066 6f72 2064  hedClause` for d
-0002d840: 6574 6169 6c73 2e0a 0a20 2020 2043 6f6e  etails...    Con
-0002d850: 7665 6e69 656e 6365 2066 756e 6374 696f  venience functio
-0002d860: 6e20 746f 2063 7265 6174 6520 6120 6e65  n to create a ne
-0002d870: 7720 5768 656e 4e6f 744d 6174 6368 6564  w WhenNotMatched
-0002d880: 436c 6175 7365 2069 6e73 7461 6e63 6520  Clause instance 
-0002d890: 7768 6963 6820 6973 2072 6571 7569 7265  which is require
-0002d8a0: 6420 746f 6765 7468 6572 2077 6974 6820  d together with 
-0002d8b0: 616e 2061 6374 696f 6e20 7768 656e 206d  an action when m
-0002d8c0: 6572 6769 6e67 0a20 2020 2061 2053 6e6f  erging.    a Sno
-0002d8d0: 7770 6172 6b20 7461 626c 6520 7769 7468  wpark table with
-0002d8e0: 2061 2053 6e6f 7770 6172 6b20 4461 7461   a Snowpark Data
-0002d8f0: 4672 616d 6520 2873 6565 2073 6e6f 7766  Frame (see snowf
-0002d900: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5461  lake.snowpark.Ta
-0002d910: 626c 652e 6d65 7267 6520 666f 7220 6d6f  ble.merge for mo
-0002d920: 7265 2064 6574 6169 6c73 292e 0a0a 2020  re details)...  
-0002d930: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0002d940: 2020 2020 203e 3e3e 2074 6172 6765 745f       >>> target_
-0002d950: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002d960: 6174 655f 6461 7461 6672 616d 6528 5b28  ate_dataframe([(
-0002d970: 3130 2c20 226f 6c64 2229 2c20 2831 302c  10, "old"), (10,
-0002d980: 2022 746f 6f5f 6f6c 6422 292c 2028 3131   "too_old"), (11
-0002d990: 2c20 226f 6c64 2229 5d2c 2073 6368 656d  , "old")], schem
-0002d9a0: 613d 5b22 6b65 7922 2c20 2276 616c 7565  a=["key", "value
-0002d9b0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-0002d9c0: 7461 7267 6574 5f64 662e 7772 6974 652e  target_df.write.
-0002d9d0: 7361 7665 5f61 735f 7461 626c 6528 226d  save_as_table("m
-0002d9e0: 795f 7461 626c 6522 2c20 6d6f 6465 3d22  y_table", mode="
-0002d9f0: 6f76 6572 7772 6974 6522 2c20 7461 626c  overwrite", tabl
-0002da00: 655f 7479 7065 3d22 7465 6d70 6f72 6172  e_type="temporar
-0002da10: 7922 290a 2020 2020 2020 2020 3e3e 3e20  y").        >>> 
-0002da20: 7461 7267 6574 203d 2073 6573 7369 6f6e  target = session
-0002da30: 2e74 6162 6c65 2822 6d79 5f74 6162 6c65  .table("my_table
-0002da40: 2229 0a20 2020 2020 2020 203e 3e3e 2073  ").        >>> s
-0002da50: 6f75 7263 6520 3d20 7365 7373 696f 6e2e  ource = session.
-0002da60: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0002da70: 285b 2831 302c 2022 6e65 7722 292c 2028  ([(10, "new"), (
-0002da80: 3132 2c20 226e 6577 2229 2c20 2831 332c  12, "new"), (13,
-0002da90: 2022 6f6c 6422 295d 2c20 7363 6865 6d61   "old")], schema
-0002daa0: 3d5b 226b 6579 222c 2022 7661 6c75 6522  =["key", "value"
-0002dab0: 5d29 0a20 2020 2020 2020 203e 3e3e 2074  ]).        >>> t
-0002dac0: 6172 6765 742e 6d65 7267 6528 736f 7572  arget.merge(sour
-0002dad0: 6365 2c20 2874 6172 6765 745b 226b 6579  ce, (target["key
-0002dae0: 225d 203d 3d20 736f 7572 6365 5b22 6b65  "] == source["ke
-0002daf0: 7922 5d29 2026 2028 7461 7267 6574 5b22  y"]) & (target["
-0002db00: 7661 6c75 6522 5d20 3d3d 2022 746f 6f5f  value"] == "too_
-0002db10: 6f6c 6422 292c 0a20 2020 2020 2020 202e  old"),.        .
-0002db20: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-0002db30: 5b77 6865 6e5f 6e6f 745f 6d61 7463 6865  [when_not_matche
-0002db40: 6428 292e 696e 7365 7274 287b 226b 6579  d().insert({"key
-0002db50: 223a 2073 6f75 7263 655b 226b 6579 225d  ": source["key"]
-0002db60: 7d29 5d29 0a20 2020 2020 2020 204d 6572  })]).        Mer
-0002db70: 6765 5265 7375 6c74 2872 6f77 735f 696e  geResult(rows_in
-0002db80: 7365 7274 6564 3d32 2c20 726f 7773 5f75  serted=2, rows_u
-0002db90: 7064 6174 6564 3d30 2c20 726f 7773 5f64  pdated=0, rows_d
-0002dba0: 656c 6574 6564 3d30 290a 2020 2020 2020  eleted=0).      
-0002dbb0: 2020 3e3e 3e20 7461 7267 6574 2e73 6f72    >>> target.sor
-0002dbc0: 7428 636f 6c28 226b 6579 2229 2c20 636f  t(col("key"), co
-0002dbd0: 6c28 2276 616c 7565 2229 292e 636f 6c6c  l("value")).coll
-0002dbe0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0002dbf0: 6f77 284b 4559 3d31 302c 2056 414c 5545  ow(KEY=10, VALUE
-0002dc00: 3d27 6f6c 6427 292c 2052 6f77 284b 4559  ='old'), Row(KEY
-0002dc10: 3d31 302c 2056 414c 5545 3d27 746f 6f5f  =10, VALUE='too_
-0002dc20: 6f6c 6427 292c 2052 6f77 284b 4559 3d31  old'), Row(KEY=1
-0002dc30: 312c 2056 414c 5545 3d27 6f6c 6427 292c  1, VALUE='old'),
-0002dc40: 2052 6f77 284b 4559 3d31 322c 2056 414c   Row(KEY=12, VAL
-0002dc50: 5545 3d4e 6f6e 6529 2c20 526f 7728 4b45  UE=None), Row(KE
-0002dc60: 593d 3133 2c20 5641 4c55 453d 4e6f 6e65  Y=13, VALUE=None
-0002dc70: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
-0002dc80: 6574 7572 6e20 736e 6f77 666c 616b 652e  eturn snowflake.
-0002dc90: 736e 6f77 7061 726b 2e74 6162 6c65 2e57  snowpark.table.W
-0002dca0: 6865 6e4e 6f74 4d61 7463 6865 6443 6c61  henNotMatchedCla
-0002dcb0: 7573 6528 636f 6e64 6974 696f 6e29 0a0a  use(condition)..
-0002dcc0: 0a64 6566 2075 6466 280a 2020 2020 6675  .def udf(.    fu
-0002dcd0: 6e63 3a20 4f70 7469 6f6e 616c 5b43 616c  nc: Optional[Cal
-0002dce0: 6c61 626c 655d 203d 204e 6f6e 652c 0a20  lable] = None,. 
-0002dcf0: 2020 202a 2c0a 2020 2020 7265 7475 726e     *,.    return
-0002dd00: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
-0002dd10: 4461 7461 5479 7065 5d20 3d20 4e6f 6e65  DataType] = None
-0002dd20: 2c0a 2020 2020 696e 7075 745f 7479 7065  ,.    input_type
-0002dd30: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-0002dd40: 5b44 6174 6154 7970 655d 5d20 3d20 4e6f  [DataType]] = No
-0002dd50: 6e65 2c0a 2020 2020 6e61 6d65 3a20 4f70  ne,.    name: Op
-0002dd60: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
-0002dd70: 2c20 4974 6572 6162 6c65 5b73 7472 5d5d  , Iterable[str]]
-0002dd80: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6973  ] = None,.    is
-0002dd90: 5f70 6572 6d61 6e65 6e74 3a20 626f 6f6c  _permanent: bool
-0002dda0: 203d 2046 616c 7365 2c0a 2020 2020 7374   = False,.    st
-0002ddb0: 6167 655f 6c6f 6361 7469 6f6e 3a20 4f70  age_location: Op
-0002ddc0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0002ddd0: 6e65 2c0a 2020 2020 696d 706f 7274 733a  ne,.    imports:
-0002dde0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b55   Optional[List[U
-0002ddf0: 6e69 6f6e 5b73 7472 2c20 5475 706c 655b  nion[str, Tuple[
-0002de00: 7374 722c 2073 7472 5d5d 5d5d 203d 204e  str, str]]]] = N
-0002de10: 6f6e 652c 0a20 2020 2070 6163 6b61 6765  one,.    package
-0002de20: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-0002de30: 5b55 6e69 6f6e 5b73 7472 2c20 4d6f 6475  [Union[str, Modu
-0002de40: 6c65 5479 7065 5d5d 5d20 3d20 4e6f 6e65  leType]]] = None
-0002de50: 2c0a 2020 2020 7265 706c 6163 653a 2062  ,.    replace: b
-0002de60: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0002de70: 2069 665f 6e6f 745f 6578 6973 7473 3a20   if_not_exists: 
-0002de80: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0002de90: 2020 7365 7373 696f 6e3a 204f 7074 696f    session: Optio
-0002dea0: 6e61 6c5b 2273 6e6f 7766 6c61 6b65 2e73  nal["snowflake.s
-0002deb0: 6e6f 7770 6172 6b2e 7365 7373 696f 6e2e  nowpark.session.
-0002dec0: 5365 7373 696f 6e22 5d20 3d20 4e6f 6e65  Session"] = None
-0002ded0: 2c0a 2020 2020 7061 7261 6c6c 656c 3a20  ,.    parallel: 
-0002dee0: 696e 7420 3d20 342c 0a20 2020 206d 6178  int = 4,.    max
-0002def0: 5f62 6174 6368 5f73 697a 653a 204f 7074  _batch_size: Opt
-0002df00: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
-0002df10: 652c 0a20 2020 2073 7461 7465 6d65 6e74  e,.    statement
-0002df20: 5f70 6172 616d 733a 204f 7074 696f 6e61  _params: Optiona
-0002df30: 6c5b 4469 6374 5b73 7472 2c20 7374 725d  l[Dict[str, str]
-0002df40: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 736f  ] = None,.    so
-0002df50: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-0002df60: 793a 2062 6f6f 6c20 3d20 5472 7565 2c0a  y: bool = True,.
-0002df70: 2020 2020 7374 7269 6374 3a20 626f 6f6c      strict: bool
-0002df80: 203d 2046 616c 7365 2c0a 2020 2020 7365   = False,.    se
-0002df90: 6375 7265 3a20 626f 6f6c 203d 2046 616c  cure: bool = Fal
-0002dfa0: 7365 2c0a 2920 2d3e 2055 6e69 6f6e 5b55  se,.) -> Union[U
-0002dfb0: 7365 7244 6566 696e 6564 4675 6e63 7469  serDefinedFuncti
-0002dfc0: 6f6e 2c20 6675 6e63 746f 6f6c 732e 7061  on, functools.pa
-0002dfd0: 7274 6961 6c5d 3a0a 2020 2020 2222 2252  rtial]:.    """R
-0002dfe0: 6567 6973 7465 7273 2061 2050 7974 686f  egisters a Pytho
-0002dff0: 6e20 6675 6e63 7469 6f6e 2061 7320 6120  n function as a 
-0002e000: 536e 6f77 666c 616b 6520 5079 7468 6f6e  Snowflake Python
-0002e010: 2055 4446 2061 6e64 2072 6574 7572 6e73   UDF and returns
-0002e020: 2074 6865 2055 4446 2e0a 0a20 2020 2049   the UDF...    I
-0002e030: 7420 6361 6e20 6265 2075 7365 6420 6173  t can be used as
-0002e040: 2065 6974 6865 7220 6120 6675 6e63 7469   either a functi
-0002e050: 6f6e 2063 616c 6c20 6f72 2061 2064 6563  on call or a dec
-0002e060: 6f72 6174 6f72 2e20 496e 206d 6f73 7420  orator. In most 
-0002e070: 6361 7365 7320 796f 7520 776f 726b 2077  cases you work w
-0002e080: 6974 6820 6120 7369 6e67 6c65 2073 6573  ith a single ses
-0002e090: 7369 6f6e 2e0a 2020 2020 5468 6973 2066  sion..    This f
-0002e0a0: 756e 6374 696f 6e20 7573 6573 2074 6861  unction uses tha
-0002e0b0: 7420 7365 7373 696f 6e20 746f 2072 6567  t session to reg
-0002e0c0: 6973 7465 7220 7468 6520 5544 462e 2049  ister the UDF. I
-0002e0d0: 6620 796f 7520 6861 7665 206d 756c 7469  f you have multi
-0002e0e0: 706c 6520 7365 7373 696f 6e73 2c20 796f  ple sessions, yo
-0002e0f0: 7520 6e65 6564 2074 6f0a 2020 2020 6578  u need to.    ex
-0002e100: 706c 6963 6974 6c79 2073 7065 6369 6679  plicitly specify
-0002e110: 2074 6865 2060 6073 6573 7369 6f6e 6060   the ``session``
-0002e120: 2070 6172 616d 6574 6572 206f 6620 7468   parameter of th
-0002e130: 6973 2066 756e 6374 696f 6e2e 2049 6620  is function. If 
-0002e140: 796f 7520 6861 7665 2061 2066 756e 6374  you have a funct
-0002e150: 696f 6e20 616e 6420 776f 756c 640a 2020  ion and would.  
-0002e160: 2020 6c69 6b65 2074 6f20 7265 6769 7374    like to regist
-0002e170: 6572 2069 7420 746f 206d 756c 7469 706c  er it to multipl
-0002e180: 6520 6461 7461 6261 7365 732c 2075 7365  e databases, use
-0002e190: 2060 6073 6573 7369 6f6e 2e75 6466 2e72   ``session.udf.r
-0002e1a0: 6567 6973 7465 7260 6020 696e 7374 6561  egister`` instea
-0002e1b0: 642e 2053 6565 2065 7861 6d70 6c65 730a  d. See examples.
-0002e1c0: 2020 2020 696e 203a 636c 6173 733a 607e      in :class:`~
-0002e1d0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002e1e0: 726b 2e75 6466 2e55 4446 5265 6769 7374  rk.udf.UDFRegist
-0002e1f0: 7261 7469 6f6e 602e 0a0a 2020 2020 4172  ration`...    Ar
-0002e200: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
-0002e210: 3a20 4120 5079 7468 6f6e 2066 756e 6374  : A Python funct
-0002e220: 696f 6e20 7573 6564 2066 6f72 2063 7265  ion used for cre
-0002e230: 6174 696e 6720 7468 6520 5544 462e 0a20  ating the UDF.. 
-0002e240: 2020 2020 2020 2072 6574 7572 6e5f 7479         return_ty
-0002e250: 7065 3a20 4120 3a63 6c61 7373 3a60 7e73  pe: A :class:`~s
-0002e260: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002e270: 6b2e 7479 7065 732e 4461 7461 5479 7065  k.types.DataType
-0002e280: 6020 7265 7072 6573 656e 7469 6e67 2074  ` representing t
-0002e290: 6865 2072 6574 7572 6e20 6461 7461 0a20  he return data. 
-0002e2a0: 2020 2020 2020 2020 2020 2074 7970 6520             type 
-0002e2b0: 6f66 2074 6865 2055 4446 2e20 4f70 7469  of the UDF. Opti
-0002e2c0: 6f6e 616c 2069 6620 7479 7065 2068 696e  onal if type hin
-0002e2d0: 7473 2061 7265 2070 726f 7669 6465 642e  ts are provided.
-0002e2e0: 0a20 2020 2020 2020 2069 6e70 7574 5f74  .        input_t
-0002e2f0: 7970 6573 3a20 4120 6c69 7374 206f 6620  ypes: A list of 
-0002e300: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
-0002e310: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-0002e320: 732e 4461 7461 5479 7065 600a 2020 2020  s.DataType`.    
-0002e330: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-0002e340: 7469 6e67 2074 6865 2069 6e70 7574 2064  ting the input d
-0002e350: 6174 6120 7479 7065 7320 6f66 2074 6865  ata types of the
-0002e360: 2055 4446 2e20 4f70 7469 6f6e 616c 2069   UDF. Optional i
-0002e370: 660a 2020 2020 2020 2020 2020 2020 7479  f.            ty
-0002e380: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
-0002e390: 7669 6465 642e 0a20 2020 2020 2020 206e  vided..        n
-0002e3a0: 616d 653a 2041 2073 7472 696e 6720 6f72  ame: A string or
-0002e3b0: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
-0002e3c0: 2074 6861 7420 7370 6563 6966 7920 7468   that specify th
-0002e3d0: 6520 6e61 6d65 206f 7220 6675 6c6c 792d  e name or fully-
-0002e3e0: 7175 616c 6966 6965 640a 2020 2020 2020  qualified.      
-0002e3f0: 2020 2020 2020 6f62 6a65 6374 2069 6465        object ide
-0002e400: 6e74 6966 6965 7220 2864 6174 6162 6173  ntifier (databas
-0002e410: 6520 6e61 6d65 2c20 7363 6865 6d61 206e  e name, schema n
-0002e420: 616d 652c 2061 6e64 2066 756e 6374 696f  ame, and functio
-0002e430: 6e20 6e61 6d65 2920 666f 720a 2020 2020  n name) for.    
-0002e440: 2020 2020 2020 2020 7468 6520 5544 4620          the UDF 
-0002e450: 696e 2053 6e6f 7766 6c61 6b65 2c20 7768  in Snowflake, wh
-0002e460: 6963 6820 616c 6c6f 7773 2079 6f75 2074  ich allows you t
-0002e470: 6f20 6361 6c6c 2074 6869 7320 5544 4620  o call this UDF 
-0002e480: 696e 2061 2053 514c 0a20 2020 2020 2020  in a SQL.       
-0002e490: 2020 2020 2063 6f6d 6d61 6e64 206f 7220       command or 
-0002e4a0: 7669 6120 3a66 756e 633a 6063 616c 6c5f  via :func:`call_
-0002e4b0: 7564 6628 2960 2e20 4966 2069 7420 6973  udf()`. If it is
-0002e4c0: 206e 6f74 2070 726f 7669 6465 642c 2061   not provided, a
-0002e4d0: 206e 616d 6520 7769 6c6c 0a20 2020 2020   name will.     
-0002e4e0: 2020 2020 2020 2062 6520 6175 746f 6d61         be automa
-0002e4f0: 7469 6361 6c6c 7920 6765 6e65 7261 7465  tically generate
-0002e500: 6420 666f 7220 7468 6520 5544 462e 2041  d for the UDF. A
-0002e510: 206e 616d 6520 6d75 7374 2062 6520 7370   name must be sp
-0002e520: 6563 6966 6965 6420 7768 656e 0a20 2020  ecified when.   
-0002e530: 2020 2020 2020 2020 2060 6069 735f 7065           ``is_pe
-0002e540: 726d 616e 656e 7460 6020 6973 2060 6054  rmanent`` is ``T
-0002e550: 7275 6560 602e 0a20 2020 2020 2020 2069  rue``..        i
-0002e560: 735f 7065 726d 616e 656e 743a 2057 6865  s_permanent: Whe
-0002e570: 7468 6572 2074 6f20 6372 6561 7465 2061  ther to create a
-0002e580: 2070 6572 6d61 6e65 6e74 2055 4446 2e20   permanent UDF. 
-0002e590: 5468 6520 6465 6661 756c 7420 6973 2060  The default is `
-0002e5a0: 6046 616c 7365 6060 2e0a 2020 2020 2020  `False``..      
-0002e5b0: 2020 2020 2020 4966 2069 7420 6973 2060        If it is `
-0002e5c0: 6054 7275 6560 602c 2061 2076 616c 6964  `True``, a valid
-0002e5d0: 2060 6073 7461 6765 5f6c 6f63 6174 696f   ``stage_locatio
-0002e5e0: 6e60 6020 6d75 7374 2062 6520 7072 6f76  n`` must be prov
-0002e5f0: 6964 6564 2e0a 2020 2020 2020 2020 7374  ided..        st
-0002e600: 6167 655f 6c6f 6361 7469 6f6e 3a20 5468  age_location: Th
-0002e610: 6520 7374 6167 6520 6c6f 6361 7469 6f6e  e stage location
-0002e620: 2077 6865 7265 2074 6865 2050 7974 686f   where the Pytho
-0002e630: 6e20 6669 6c65 2066 6f72 2074 6865 2055  n file for the U
-0002e640: 4446 0a20 2020 2020 2020 2020 2020 2061  DF.            a
-0002e650: 6e64 2069 7473 2064 6570 656e 6465 6e63  nd its dependenc
-0002e660: 6965 7320 7368 6f75 6c64 2062 6520 7570  ies should be up
-0002e670: 6c6f 6164 6564 2e20 5468 6520 7374 6167  loaded. The stag
-0002e680: 6520 6c6f 6361 7469 6f6e 206d 7573 7420  e location must 
-0002e690: 6265 2073 7065 6369 6669 6564 0a20 2020  be specified.   
-0002e6a0: 2020 2020 2020 2020 2077 6865 6e20 6060           when ``
-0002e6b0: 6973 5f70 6572 6d61 6e65 6e74 6060 2069  is_permanent`` i
-0002e6c0: 7320 6060 5472 7565 6060 2c20 616e 6420  s ``True``, and 
-0002e6d0: 6974 2077 696c 6c20 6265 2069 676e 6f72  it will be ignor
-0002e6e0: 6564 2077 6865 6e0a 2020 2020 2020 2020  ed when.        
-0002e6f0: 2020 2020 6060 6973 5f70 6572 6d61 6e65      ``is_permane
-0002e700: 6e74 6060 2069 7320 6060 4661 6c73 6560  nt`` is ``False`
-0002e710: 602e 2049 7420 6361 6e20 6265 2061 6e79  `. It can be any
-0002e720: 2073 7461 6765 206f 7468 6572 2074 6861   stage other tha
-0002e730: 6e20 7465 6d70 6f72 6172 790a 2020 2020  n temporary.    
-0002e740: 2020 2020 2020 2020 7374 6167 6573 2061          stages a
-0002e750: 6e64 2065 7874 6572 6e61 6c20 7374 6167  nd external stag
-0002e760: 6573 2e0a 2020 2020 2020 2020 696d 706f  es..        impo
-0002e770: 7274 733a 2041 206c 6973 7420 6f66 2069  rts: A list of i
-0002e780: 6d70 6f72 7473 2074 6861 7420 6f6e 6c79  mports that only
-0002e790: 2061 7070 6c79 2074 6f20 7468 6973 2055   apply to this U
-0002e7a0: 4446 2e20 596f 7520 6361 6e20 7573 6520  DF. You can use 
-0002e7b0: 6120 7374 7269 6e67 2074 6f0a 2020 2020  a string to.    
-0002e7c0: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-0002e7d0: 7420 6120 6669 6c65 2070 6174 6820 2873  t a file path (s
-0002e7e0: 696d 696c 6172 2074 6f20 7468 6520 6060  imilar to the ``
-0002e7f0: 7061 7468 6060 2061 7267 756d 656e 7420  path`` argument 
-0002e800: 696e 0a20 2020 2020 2020 2020 2020 203a  in.            :
-0002e810: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
-0002e820: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
-0002e830: 6e2e 6164 645f 696d 706f 7274 6029 2069  n.add_import`) i
-0002e840: 6e20 7468 6973 206c 6973 742c 206f 7220  n this list, or 
-0002e850: 6120 7475 706c 6520 6f66 2074 776f 0a20  a tuple of two. 
-0002e860: 2020 2020 2020 2020 2020 2073 7472 696e             strin
-0002e870: 6773 2074 6f20 7265 7072 6573 656e 7420  gs to represent 
-0002e880: 6120 6669 6c65 2070 6174 6820 616e 6420  a file path and 
-0002e890: 616e 2069 6d70 6f72 7420 7061 7468 2028  an import path (
-0002e8a0: 7369 6d69 6c61 7220 746f 2074 6865 2060  similar to the `
-0002e8b0: 6069 6d70 6f72 745f 7061 7468 6060 0a20  `import_path``. 
-0002e8c0: 2020 2020 2020 2020 2020 2061 7267 756d             argum
-0002e8d0: 656e 7420 696e 203a 6d65 7468 3a60 7e73  ent in :meth:`~s
-0002e8e0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002e8f0: 6b2e 5365 7373 696f 6e2e 6164 645f 696d  k.Session.add_im
-0002e900: 706f 7274 6029 2e20 5468 6573 6520 5544  port`). These UD
-0002e910: 462d 6c65 7665 6c20 696d 706f 7274 730a  F-level imports.
-0002e920: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
-0002e930: 206f 7665 7272 6964 6520 7468 6520 7365   override the se
-0002e940: 7373 696f 6e2d 6c65 7665 6c20 696d 706f  ssion-level impo
-0002e950: 7274 7320 6164 6465 6420 6279 0a20 2020  rts added by.   
-0002e960: 2020 2020 2020 2020 203a 6d65 7468 3a60           :meth:`
-0002e970: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-0002e980: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
-0002e990: 696d 706f 7274 602e 204e 6f74 6520 7468  import`. Note th
-0002e9a0: 6174 2061 6e20 656d 7074 7920 6c69 7374  at an empty list
-0002e9b0: 206d 6561 6e73 0a20 2020 2020 2020 2020   means.         
-0002e9c0: 2020 206e 6f20 696d 706f 7274 2066 6f72     no import for
-0002e9d0: 2074 6869 7320 5544 462c 2061 6e64 2060   this UDF, and `
-0002e9e0: 604e 6f6e 6560 6020 6f72 206e 6f74 2073  `None`` or not s
-0002e9f0: 7065 6369 6679 696e 6720 7468 6973 2070  pecifying this p
-0002ea00: 6172 616d 6574 6572 206d 6561 6e73 2075  arameter means u
-0002ea10: 7369 6e67 0a20 2020 2020 2020 2020 2020  sing.           
-0002ea20: 2073 6573 7369 6f6e 2d6c 6576 656c 2069   session-level i
-0002ea30: 6d70 6f72 7473 2e0a 2020 2020 2020 2020  mports..        
-0002ea40: 7061 636b 6167 6573 3a20 4120 6c69 7374  packages: A list
-0002ea50: 206f 6620 7061 636b 6167 6573 2074 6861   of packages tha
-0002ea60: 7420 6f6e 6c79 2061 7070 6c79 2074 6f20  t only apply to 
-0002ea70: 7468 6973 2055 4446 2e20 5468 6573 6520  this UDF. These 
-0002ea80: 5544 462d 6c65 7665 6c20 7061 636b 6167  UDF-level packag
-0002ea90: 6573 0a20 2020 2020 2020 2020 2020 2077  es.            w
-0002eaa0: 696c 6c20 6f76 6572 7269 6465 2074 6865  ill override the
-0002eab0: 2073 6573 7369 6f6e 2d6c 6576 656c 2070   session-level p
-0002eac0: 6163 6b61 6765 7320 6164 6465 6420 6279  ackages added by
-0002ead0: 0a20 2020 2020 2020 2020 2020 203a 6d65  .            :me
-0002eae0: 7468 3a60 7e73 6e6f 7766 6c61 6b65 2e73  th:`~snowflake.s
-0002eaf0: 6e6f 7770 6172 6b2e 5365 7373 696f 6e2e  nowpark.Session.
-0002eb00: 6164 645f 7061 636b 6167 6573 6020 616e  add_packages` an
-0002eb10: 640a 2020 2020 2020 2020 2020 2020 3a6d  d.            :m
-0002eb20: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
-0002eb30: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
-0002eb40: 2e61 6464 5f72 6571 7569 7265 6d65 6e74  .add_requirement
-0002eb50: 7360 2e20 4e6f 7465 2074 6861 7420 616e  s`. Note that an
-0002eb60: 2065 6d70 7479 206c 6973 7420 6d65 616e   empty list mean
-0002eb70: 730a 2020 2020 2020 2020 2020 2020 6e6f  s.            no
-0002eb80: 2070 6163 6b61 6765 2066 6f72 2074 6869   package for thi
-0002eb90: 7320 5544 462c 2061 6e64 2060 604e 6f6e  s UDF, and ``Non
-0002eba0: 6560 6020 6f72 206e 6f74 2073 7065 6369  e`` or not speci
-0002ebb0: 6679 696e 6720 7468 6973 2070 6172 616d  fying this param
-0002ebc0: 6574 6572 206d 6561 6e73 2075 7369 6e67  eter means using
-0002ebd0: 0a20 2020 2020 2020 2020 2020 2073 6573  .            ses
-0002ebe0: 7369 6f6e 2d6c 6576 656c 2070 6163 6b61  sion-level packa
-0002ebf0: 6765 732e 0a20 2020 2020 2020 2072 6570  ges..        rep
-0002ec00: 6c61 6365 3a20 5768 6574 6865 7220 746f  lace: Whether to
-0002ec10: 2072 6570 6c61 6365 2061 2055 4446 2074   replace a UDF t
-0002ec20: 6861 7420 616c 7265 6164 7920 7761 7320  hat already was 
-0002ec30: 7265 6769 7374 6572 6564 2e20 5468 6520  registered. The 
-0002ec40: 6465 6661 756c 7420 6973 2060 6046 616c  default is ``Fal
-0002ec50: 7365 6060 2e0a 2020 2020 2020 2020 2020  se``..          
-0002ec60: 2020 4966 2069 7420 6973 2060 6046 616c    If it is ``Fal
-0002ec70: 7365 6060 2c20 6174 7465 6d70 7469 6e67  se``, attempting
-0002ec80: 2074 6f20 7265 6769 7374 6572 2061 2055   to register a U
-0002ec90: 4446 2077 6974 6820 6120 6e61 6d65 2074  DF with a name t
-0002eca0: 6861 7420 616c 7265 6164 7920 6578 6973  hat already exis
-0002ecb0: 7473 0a20 2020 2020 2020 2020 2020 2072  ts.            r
-0002ecc0: 6573 756c 7473 2069 6e20 6120 6060 536e  esults in a ``Sn
-0002ecd0: 6f77 7061 726b 5351 4c45 7863 6570 7469  owparkSQLExcepti
-0002ece0: 6f6e 6060 2065 7863 6570 7469 6f6e 2062  on`` exception b
-0002ecf0: 6569 6e67 2074 6872 6f77 6e2e 2049 6620  eing thrown. If 
-0002ed00: 6974 2069 7320 6060 5472 7565 6060 2c0a  it is ``True``,.
-0002ed10: 2020 2020 2020 2020 2020 2020 616e 2065              an e
-0002ed20: 7869 7374 696e 6720 5544 4620 7769 7468  xisting UDF with
-0002ed30: 2074 6865 2073 616d 6520 6e61 6d65 2069   the same name i
-0002ed40: 7320 6f76 6572 7772 6974 7465 6e2e 0a20  s overwritten.. 
-0002ed50: 2020 2020 2020 2069 665f 6e6f 745f 6578         if_not_ex
-0002ed60: 6973 7473 3a20 5768 6574 6865 7220 746f  ists: Whether to
-0002ed70: 2073 6b69 7020 6372 6561 7469 6f6e 206f   skip creation o
-0002ed80: 6620 6120 5544 4620 7768 656e 206f 6e65  f a UDF when one
-0002ed90: 2077 6974 6820 7468 6520 7361 6d65 2073   with the same s
-0002eda0: 6967 6e61 7475 7265 2061 6c72 6561 6479  ignature already
-0002edb0: 2065 7869 7374 732e 0a20 2020 2020 2020   exists..       
-0002edc0: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
-0002edd0: 2069 7320 6060 4661 6c73 6560 602e 2060   is ``False``. `
-0002ede0: 6069 665f 6e6f 745f 6578 6973 7473 6060  `if_not_exists``
-0002edf0: 2061 6e64 2060 6072 6570 6c61 6365 6060   and ``replace``
-0002ee00: 2061 7265 206d 7574 7561 6c6c 7920 6578   are mutually ex
-0002ee10: 636c 7573 6976 650a 2020 2020 2020 2020  clusive.        
-0002ee20: 2020 2020 616e 6420 6120 6060 5661 6c75      and a ``Valu
-0002ee30: 6545 7272 6f72 6060 2069 7320 7261 6973  eError`` is rais
-0002ee40: 6564 2077 6865 6e20 626f 7468 2061 7265  ed when both are
-0002ee50: 2073 6574 2e20 4966 2069 7420 6973 2060   set. If it is `
-0002ee60: 6054 7275 6560 6020 616e 6420 6120 5544  `True`` and a UD
-0002ee70: 4620 7769 7468 0a20 2020 2020 2020 2020  F with.         
-0002ee80: 2020 2074 6865 2073 616d 6520 7369 676e     the same sign
-0002ee90: 6174 7572 6520 6578 6973 7473 2c20 7468  ature exists, th
-0002eea0: 6520 5544 4620 6372 6561 7469 6f6e 2069  e UDF creation i
-0002eeb0: 7320 736b 6970 7065 642e 0a20 2020 2020  s skipped..     
-0002eec0: 2020 2073 6573 7369 6f6e 3a20 5573 6520     session: Use 
-0002eed0: 7468 6973 2073 6573 7369 6f6e 2074 6f20  this session to 
-0002eee0: 7265 6769 7374 6572 2074 6865 2055 4446  register the UDF
-0002eef0: 2e20 4966 2069 7427 7320 6e6f 7420 7370  . If it's not sp
-0002ef00: 6563 6966 6965 642c 2074 6865 2073 6573  ecified, the ses
-0002ef10: 7369 6f6e 2074 6861 7420 796f 7520 6372  sion that you cr
-0002ef20: 6561 7465 6420 6265 666f 7265 2063 616c  eated before cal
-0002ef30: 6c69 6e67 2074 6869 7320 6675 6e63 7469  ling this functi
-0002ef40: 6f6e 2077 696c 6c20 6265 2075 7365 642e  on will be used.
-0002ef50: 0a20 2020 2020 2020 2020 2020 2059 6f75  .            You
-0002ef60: 206e 6565 6420 746f 2073 7065 6369 6679   need to specify
-0002ef70: 2074 6869 7320 7061 7261 6d65 7465 7220   this parameter 
-0002ef80: 6966 2079 6f75 2068 6176 6520 6372 6561  if you have crea
-0002ef90: 7465 6420 6d75 6c74 6970 6c65 2073 6573  ted multiple ses
-0002efa0: 7369 6f6e 7320 6265 666f 7265 2063 616c  sions before cal
-0002efb0: 6c69 6e67 2074 6869 7320 6d65 7468 6f64  ling this method
-0002efc0: 2e0a 2020 2020 2020 2020 7061 7261 6c6c  ..        parall
-0002efd0: 656c 3a20 5468 6520 6e75 6d62 6572 206f  el: The number o
-0002efe0: 6620 7468 7265 6164 7320 746f 2075 7365  f threads to use
-0002eff0: 2066 6f72 2075 706c 6f61 6469 6e67 2055   for uploading U
-0002f000: 4446 2066 696c 6573 2077 6974 6820 7468  DF files with th
-0002f010: 650a 2020 2020 2020 2020 2020 2020 6050  e.            `P
-0002f020: 5554 203c 6874 7470 733a 2f2f 646f 6373  UT <https://docs
-0002f030: 2e73 6e6f 7766 6c61 6b65 2e63 6f6d 2f65  .snowflake.com/e
-0002f040: 6e2f 7371 6c2d 7265 6665 7265 6e63 652f  n/sql-reference/
-0002f050: 7371 6c2f 7075 742e 6874 6d6c 2370 7574  sql/put.html#put
-0002f060: 3e60 5f0a 2020 2020 2020 2020 2020 2020  >`_.            
-0002f070: 636f 6d6d 616e 642e 2054 6865 2064 6566  command. The def
-0002f080: 6175 6c74 2076 616c 7565 2069 7320 3420  ault value is 4 
-0002f090: 616e 6420 7375 7070 6f72 7465 6420 7661  and supported va
-0002f0a0: 6c75 6573 2061 7265 2066 726f 6d20 3120  lues are from 1 
-0002f0b0: 746f 2039 392e 0a20 2020 2020 2020 2020  to 99..         
-0002f0c0: 2020 2049 6e63 7265 6173 696e 6720 7468     Increasing th
-0002f0d0: 6520 6e75 6d62 6572 206f 6620 7468 7265  e number of thre
-0002f0e0: 6164 7320 6361 6e20 696d 7072 6f76 6520  ads can improve 
-0002f0f0: 7065 7266 6f72 6d61 6e63 6520 7768 656e  performance when
-0002f100: 2075 706c 6f61 6469 6e67 0a20 2020 2020   uploading.     
-0002f110: 2020 2020 2020 206c 6172 6765 2055 4446         large UDF
-0002f120: 2066 696c 6573 2e0a 2020 2020 2020 2020   files..        
-0002f130: 6d61 785f 6261 7463 685f 7369 7a65 3a20  max_batch_size: 
-0002f140: 5468 6520 6d61 7869 6d75 6d20 6e75 6d62  The maximum numb
-0002f150: 6572 206f 6620 726f 7773 2070 6572 2069  er of rows per i
-0002f160: 6e70 7574 2050 616e 6461 7320 4461 7461  nput Pandas Data
-0002f170: 4672 616d 6520 6f72 2050 616e 6461 7320  Frame or Pandas 
-0002f180: 5365 7269 6573 0a20 2020 2020 2020 2020  Series.         
-0002f190: 2020 2069 6e73 6964 6520 6120 7665 6374     inside a vect
-0002f1a0: 6f72 697a 6564 2055 4446 2e20 4265 6361  orized UDF. Beca
-0002f1b0: 7573 6520 6120 7665 6374 6f72 697a 6564  use a vectorized
-0002f1c0: 2055 4446 2077 696c 6c20 6265 2065 7865   UDF will be exe
-0002f1d0: 6375 7465 6420 7769 7468 696e 2061 2074  cuted within a t
-0002f1e0: 696d 6520 6c69 6d69 742c 0a20 2020 2020  ime limit,.     
-0002f1f0: 2020 2020 2020 2077 6869 6368 2069 7320         which is 
-0002f200: 6036 3060 2073 6563 6f6e 6473 2c20 7468  `60` seconds, th
-0002f210: 6973 206f 7074 696f 6e61 6c20 6172 6775  is optional argu
-0002f220: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
-0002f230: 2074 6f20 7265 6475 6365 2074 6865 2072   to reduce the r
-0002f240: 756e 6e69 6e67 2074 696d 6520 6f66 0a20  unning time of. 
-0002f250: 2020 2020 2020 2020 2020 2065 7665 7279             every
-0002f260: 2062 6174 6368 2062 7920 7365 7474 696e   batch by settin
-0002f270: 6720 6120 736d 616c 6c65 7220 6261 7463  g a smaller batc
-0002f280: 6820 7369 7a65 2e20 4e6f 7465 2074 6861  h size. Note tha
-0002f290: 7420 7365 7474 696e 6720 6120 6c61 7267  t setting a larg
-0002f2a0: 6572 2076 616c 7565 2064 6f65 7320 6e6f  er value does no
-0002f2b0: 740a 2020 2020 2020 2020 2020 2020 6775  t.            gu
-0002f2c0: 6172 616e 7465 6520 7468 6174 2053 6e6f  arantee that Sno
-0002f2d0: 7766 6c61 6b65 2077 696c 6c20 656e 636f  wflake will enco
-0002f2e0: 6465 2062 6174 6368 6573 2077 6974 6820  de batches with 
-0002f2f0: 7468 6520 7370 6563 6966 6965 6420 6e75  the specified nu
-0002f300: 6d62 6572 206f 6620 726f 7773 2e20 4974  mber of rows. It
-0002f310: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
-0002f320: 2020 6265 2069 676e 6f72 6564 2077 6865    be ignored whe
-0002f330: 6e20 7265 6769 7374 6572 696e 6720 6120  n registering a 
-0002f340: 6e6f 6e2d 7665 6374 6f72 697a 6564 2055  non-vectorized U
-0002f350: 4446 2e0a 2020 2020 2020 2020 7374 6174  DF..        stat
-0002f360: 656d 656e 745f 7061 7261 6d73 3a20 4469  ement_params: Di
-0002f370: 6374 696f 6e61 7279 206f 6620 7374 6174  ctionary of stat
-0002f380: 656d 656e 7420 6c65 7665 6c20 7061 7261  ement level para
-0002f390: 6d65 7465 7273 2074 6f20 6265 2073 6574  meters to be set
-0002f3a0: 2077 6869 6c65 2065 7865 6375 7469 6e67   while executing
-0002f3b0: 2074 6869 7320 6163 7469 6f6e 2e0a 2020   this action..  
-0002f3c0: 2020 2020 2020 736f 7572 6365 5f63 6f64        source_cod
-0002f3d0: 655f 6469 7370 6c61 793a 2044 6973 706c  e_display: Displ
-0002f3e0: 6179 2074 6865 2073 6f75 7263 6520 636f  ay the source co
-0002f3f0: 6465 206f 6620 7468 6520 5544 4620 6066  de of the UDF `f
-0002f400: 756e 6360 2061 7320 636f 6d6d 656e 7473  unc` as comments
-0002f410: 2069 6e20 7468 6520 6765 6e65 7261 7465   in the generate
-0002f420: 6420 7363 7269 7074 2e0a 2020 2020 2020  d script..      
-0002f430: 2020 2020 2020 5468 6520 736f 7572 6365        The source
-0002f440: 2063 6f64 6520 6973 2064 796e 616d 6963   code is dynamic
-0002f450: 616c 6c79 2067 656e 6572 6174 6564 2074  ally generated t
-0002f460: 6865 7265 666f 7265 2069 7420 6d61 7920  herefore it may 
-0002f470: 6e6f 7420 6265 2069 6465 6e74 6963 616c  not be identical
-0002f480: 2074 6f20 686f 7720 7468 650a 2020 2020   to how the.    
-0002f490: 2020 2020 2020 2020 6066 756e 6360 2069          `func` i
-0002f4a0: 7320 6f72 6967 696e 616c 6c79 2064 6566  s originally def
-0002f4b0: 696e 6564 2e20 5468 6520 6465 6661 756c  ined. The defaul
-0002f4c0: 7420 6973 2060 6054 7275 6560 602e 0a20  t is ``True``.. 
-0002f4d0: 2020 2020 2020 2020 2020 2049 6620 6974             If it
-0002f4e0: 2069 7320 6060 4661 6c73 6560 602c 2073   is ``False``, s
-0002f4f0: 6f75 7263 6520 636f 6465 2077 696c 6c20  ource code will 
-0002f500: 6e6f 7420 6265 2067 656e 6572 6174 6564  not be generated
-0002f510: 206f 7220 6469 7370 6c61 7965 642e 0a20   or displayed.. 
-0002f520: 2020 2020 2020 2073 7472 6963 743a 2057         strict: W
-0002f530: 6865 7468 6572 2074 6865 2063 7265 6174  hether the creat
-0002f540: 6564 2055 4446 2069 7320 7374 7269 6374  ed UDF is strict
-0002f550: 2e20 4120 7374 7269 6374 2055 4446 2077  . A strict UDF w
-0002f560: 696c 6c20 6e6f 7420 696e 766f 6b65 2074  ill not invoke t
-0002f570: 6865 2055 4446 2069 6620 616e 7920 696e  he UDF if any in
-0002f580: 7075 7420 6973 0a20 2020 2020 2020 2020  put is.         
-0002f590: 2020 206e 756c 6c2e 2049 6e73 7465 6164     null. Instead
-0002f5a0: 2c20 6120 6e75 6c6c 2076 616c 7565 2077  , a null value w
-0002f5b0: 696c 6c20 616c 7761 7973 2062 6520 7265  ill always be re
-0002f5c0: 7475 726e 6564 2066 6f72 2074 6861 7420  turned for that 
-0002f5d0: 726f 772e 204e 6f74 6520 7468 6174 2074  row. Note that t
-0002f5e0: 6865 2055 4446 206d 6967 6874 0a20 2020  he UDF might.   
-0002f5f0: 2020 2020 2020 2020 2073 7469 6c6c 2072           still r
-0002f600: 6574 7572 6e20 6e75 6c6c 2066 6f72 206e  eturn null for n
-0002f610: 6f6e 2d6e 756c 6c20 696e 7075 7473 2e0a  on-null inputs..
-0002f620: 2020 2020 2020 2020 7365 6375 7265 3a20          secure: 
-0002f630: 5768 6574 6865 7220 7468 6520 6372 6561  Whether the crea
-0002f640: 7465 6420 5544 4620 6973 2073 6563 7572  ted UDF is secur
-0002f650: 652e 2046 6f72 206d 6f72 6520 696e 666f  e. For more info
-0002f660: 726d 6174 696f 6e20 6162 6f75 7420 7365  rmation about se
-0002f670: 6375 7265 2066 756e 6374 696f 6e73 2c0a  cure functions,.
-0002f680: 2020 2020 2020 2020 2020 2020 7365 6520              see 
-0002f690: 6053 6563 7572 6520 5544 4673 203c 6874  `Secure UDFs <ht
-0002f6a0: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
-0002f6b0: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
-0002f6c0: 7265 6665 7265 6e63 652f 7564 662d 7365  reference/udf-se
-0002f6d0: 6375 7265 2e68 746d 6c3e 605f 2e0a 0a20  cure.html>`_... 
-0002f6e0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-0002f6f0: 2020 2020 4120 5544 4620 6675 6e63 7469      A UDF functi
-0002f700: 6f6e 2074 6861 7420 6361 6e20 6265 2063  on that can be c
-0002f710: 616c 6c65 6420 7769 7468 203a 636c 6173  alled with :clas
-0002f720: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
-0002f730: 6f77 7061 726b 2e43 6f6c 756d 6e60 2065  owpark.Column` e
-0002f740: 7870 7265 7373 696f 6e73 2e0a 0a20 2020  xpressions...   
-0002f750: 204e 6f74 653a 0a20 2020 2020 2020 2031   Note:.        1
-0002f760: 2e20 5768 656e 2074 7970 6520 6869 6e74  . When type hint
-0002f770: 7320 6172 6520 7072 6f76 6964 6564 2061  s are provided a
-0002f780: 6e64 2061 7265 2063 6f6d 706c 6574 6520  nd are complete 
-0002f790: 666f 7220 6120 6675 6e63 7469 6f6e 2c0a  for a function,.
-0002f7a0: 2020 2020 2020 2020 6060 7265 7475 726e          ``return
-0002f7b0: 5f74 7970 6560 6020 616e 6420 6060 696e  _type`` and ``in
-0002f7c0: 7075 745f 7479 7065 7360 6020 6172 6520  put_types`` are 
-0002f7d0: 6f70 7469 6f6e 616c 2061 6e64 2077 696c  optional and wil
-0002f7e0: 6c20 6265 2069 676e 6f72 6564 2e0a 2020  l be ignored..  
-0002f7f0: 2020 2020 2020 5365 6520 6465 7461 696c        See detail
-0002f800: 7320 6f66 2073 7570 706f 7274 6564 2064  s of supported d
-0002f810: 6174 6120 7479 7065 7320 666f 7220 5544  ata types for UD
-0002f820: 4673 2069 6e0a 2020 2020 2020 2020 3a63  Fs in.        :c
-0002f830: 6c61 7373 3a60 7e73 6e6f 7766 6c61 6b65  lass:`~snowflake
-0002f840: 2e73 6e6f 7770 6172 6b2e 7564 662e 5544  .snowpark.udf.UD
-0002f850: 4652 6567 6973 7472 6174 696f 6e60 2e0a  FRegistration`..
-0002f860: 0a20 2020 2020 2020 2020 2020 202d 2059  .            - Y
-0002f870: 6f75 2063 616e 2075 7365 2075 7365 203a  ou can use use :
-0002f880: 6174 7472 3a60 7e73 6e6f 7766 6c61 6b65  attr:`~snowflake
-0002f890: 2e73 6e6f 7770 6172 6b2e 7479 7065 732e  .snowpark.types.
-0002f8a0: 5661 7269 616e 7460 2074 6f0a 2020 2020  Variant` to.    
-0002f8b0: 2020 2020 2020 2020 2020 616e 6e6f 7461            annota
-0002f8c0: 7465 2061 2076 6172 6961 6e74 2c20 616e  te a variant, an
-0002f8d0: 6420 7573 6520 3a61 7474 723a 607e 736e  d use :attr:`~sn
-0002f8e0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0002f8f0: 2e74 7970 6573 2e47 656f 6772 6170 6879  .types.Geography
-0002f900: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-0002f910: 746f 2061 6e6e 6f74 6174 6520 6120 6765  to annotate a ge
-0002f920: 6f67 7261 7068 7920 7768 656e 2064 6566  ography when def
-0002f930: 696e 696e 6720 6120 5544 462e 0a0a 2020  ining a UDF...  
-0002f940: 2020 2020 2020 2020 2020 2d20 596f 7520            - You 
-0002f950: 6361 6e20 7573 6520 7573 6520 3a61 7474  can use use :att
-0002f960: 723a 607e 736e 6f77 666c 616b 652e 736e  r:`~snowflake.sn
-0002f970: 6f77 7061 726b 2e74 7970 6573 2e50 616e  owpark.types.Pan
-0002f980: 6461 7353 6572 6965 7360 2074 6f20 616e  dasSeries` to an
-0002f990: 6e6f 7461 7465 0a20 2020 2020 2020 2020  notate.         
-0002f9a0: 2020 2020 2061 2050 616e 6461 7320 5365       a Pandas Se
-0002f9b0: 7269 6573 2c20 616e 6420 7573 6520 3a61  ries, and use :a
-0002f9c0: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
-0002f9d0: 736e 6f77 7061 726b 2e74 7970 6573 2e50  snowpark.types.P
-0002f9e0: 616e 6461 7344 6174 6146 7261 6d65 600a  andasDataFrame`.
-0002f9f0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0002fa00: 2061 6e6e 6f74 6174 6520 6120 5061 6e64   annotate a Pand
-0002fa10: 6173 2044 6174 6146 7261 6d65 2077 6865  as DataFrame whe
-0002fa20: 6e20 6465 6669 6e69 6e67 2061 2076 6563  n defining a vec
-0002fa30: 746f 7269 7a65 6420 5544 462e 0a20 2020  torized UDF..   
-0002fa40: 2020 2020 2020 2020 2020 204e 6f74 6520             Note 
-0002fa50: 7468 6174 2074 6865 7920 6172 6520 6765  that they are ge
-0002fa60: 6e65 7269 6320 7479 7065 7320 736f 2079  neric types so y
-0002fa70: 6f75 2063 616e 2073 7065 6369 6679 2074  ou can specify t
-0002fa80: 6865 2065 6c65 6d65 6e74 2074 7970 6520  he element type 
-0002fa90: 696e 2061 0a20 2020 2020 2020 2020 2020  in a.           
-0002faa0: 2020 2050 616e 6461 7320 5365 7269 6573     Pandas Series
-0002fab0: 2061 6e64 2044 6174 6146 7261 6d65 2e0a   and DataFrame..
-0002fac0: 0a20 2020 2020 2020 2020 2020 202d 203a  .            - :
-0002fad0: 636c 6173 733a 6074 7970 696e 672e 556e  class:`typing.Un
-0002fae0: 696f 6e60 2069 7320 6e6f 7420 6120 7661  ion` is not a va
-0002faf0: 6c69 6420 7479 7065 2061 6e6e 6f74 6174  lid type annotat
-0002fb00: 696f 6e20 666f 7220 5544 4673 2c0a 2020  ion for UDFs,.  
-0002fb10: 2020 2020 2020 2020 2020 2020 6275 7420              but 
-0002fb20: 3a63 6c61 7373 3a60 7479 7069 6e67 2e4f  :class:`typing.O
-0002fb30: 7074 696f 6e61 6c60 2063 616e 2062 6520  ptional` can be 
-0002fb40: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
-0002fb50: 2074 6865 206f 7074 696f 6e61 6c20 7479   the optional ty
-0002fb60: 7065 2e0a 0a20 2020 2020 2020 2020 2020  pe...           
-0002fb70: 202d 2054 7970 6520 6869 6e74 7320 6172   - Type hints ar
-0002fb80: 6520 6e6f 7420 7375 7070 6f72 7465 6420  e not supported 
-0002fb90: 6f6e 2066 756e 6374 696f 6e73 2064 6563  on functions dec
-0002fba0: 6f72 6174 6564 2077 6974 6820 6465 636f  orated with deco
-0002fbb0: 7261 746f 7273 2e0a 0a20 2020 2020 2020  rators...       
-0002fbc0: 2032 2e20 4120 7465 6d70 6f72 6172 7920   2. A temporary 
-0002fbd0: 5544 4620 2877 6865 6e20 6060 6973 5f70  UDF (when ``is_p
-0002fbe0: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
-0002fbf0: 4661 6c73 6560 6029 2069 7320 7363 6f70  False``) is scop
-0002fc00: 6564 2074 6f20 7468 6973 2060 6073 6573  ed to this ``ses
-0002fc10: 7369 6f6e 6060 0a20 2020 2020 2020 2061  sion``.        a
-0002fc20: 6e64 2061 6c6c 2055 4446 2072 656c 6174  nd all UDF relat
-0002fc30: 6564 2066 696c 6573 2077 696c 6c20 6265  ed files will be
-0002fc40: 2075 706c 6f61 6465 6420 746f 2061 2074   uploaded to a t
-0002fc50: 656d 706f 7261 7279 2073 6573 7369 6f6e  emporary session
-0002fc60: 2073 7461 6765 0a20 2020 2020 2020 2028   stage.        (
-0002fc70: 3a66 756e 633a 6073 6573 7369 6f6e 2e67  :func:`session.g
-0002fc80: 6574 5f73 6573 7369 6f6e 5f73 7461 6765  et_session_stage
-0002fc90: 2829 203c 736e 6f77 666c 616b 652e 736e  () <snowflake.sn
-0002fca0: 6f77 7061 726b 2e53 6573 7369 6f6e 2e67  owpark.Session.g
-0002fcb0: 6574 5f73 6573 7369 6f6e 5f73 7461 6765  et_session_stage
-0002fcc0: 3e60 292e 0a20 2020 2020 2020 2046 6f72  >`)..        For
-0002fcd0: 2061 2070 6572 6d61 6e65 6e74 2055 4446   a permanent UDF
-0002fce0: 2c20 7468 6573 6520 6669 6c65 7320 7769  , these files wi
-0002fcf0: 6c6c 2062 6520 7570 6c6f 6164 6564 2074  ll be uploaded t
-0002fd00: 6f20 7468 6520 7374 6167 6520 7468 6174  o the stage that
-0002fd10: 2079 6f75 2070 726f 7669 6465 2e0a 0a20   you provide... 
-0002fd20: 2020 2020 2020 2033 2e20 4279 2064 6566         3. By def
-0002fd30: 6175 6c74 2c20 5544 4620 7265 6769 7374  ault, UDF regist
-0002fd40: 7261 7469 6f6e 2066 6169 6c73 2069 6620  ration fails if 
-0002fd50: 6120 6675 6e63 7469 6f6e 2077 6974 6820  a function with 
-0002fd60: 7468 6520 7361 6d65 206e 616d 6520 6973  the same name is
-0002fd70: 2061 6c72 6561 6479 0a20 2020 2020 2020   already.       
-0002fd80: 2072 6567 6973 7465 7265 642e 2049 6e76   registered. Inv
-0002fd90: 6f6b 696e 6720 3a66 756e 633a 6075 6466  oking :func:`udf
-0002fda0: 6020 7769 7468 2060 6072 6570 6c61 6365  ` with ``replace
-0002fdb0: 6060 2073 6574 2074 6f20 6060 5472 7565  `` set to ``True
-0002fdc0: 6060 2077 696c 6c20 6f76 6572 7772 6974  `` will overwrit
-0002fdd0: 6520 7468 650a 2020 2020 2020 2020 7072  e the.        pr
-0002fde0: 6576 696f 7573 6c79 2072 6567 6973 7465  eviously registe
-0002fdf0: 7265 6420 6675 6e63 7469 6f6e 2e0a 0a20  red function... 
-0002fe00: 2020 2020 2020 2034 2e20 5768 656e 2072         4. When r
-0002fe10: 6567 6973 7465 7269 6e67 2061 2076 6563  egistering a vec
-0002fe20: 746f 7269 7a65 6420 5544 462c 2060 6070  torized UDF, ``p
-0002fe30: 616e 6461 7360 6020 6c69 6272 6172 7920  andas`` library 
-0002fe40: 7769 6c6c 2062 6520 6164 6465 6420 6173  will be added as
-0002fe50: 2061 2070 6163 6b61 6765 0a20 2020 2020   a package.     
-0002fe60: 2020 2061 7574 6f6d 6174 6963 616c 6c79     automatically
-0002fe70: 2c20 7769 7468 2074 6865 206c 6174 6573  , with the lates
-0002fe80: 7420 7665 7273 696f 6e20 6f6e 2074 6865  t version on the
-0002fe90: 2053 6e6f 7766 6c61 6b65 2073 6572 7665   Snowflake serve
-0002fea0: 722e 2049 6620 796f 7520 646f 6e27 7420  r. If you don't 
-0002feb0: 7761 6e74 2074 6f0a 2020 2020 2020 2020  want to.        
-0002fec0: 7573 6520 7468 6973 2076 6572 7369 6f6e  use this version
-0002fed0: 2c20 796f 7520 6361 6e20 6f76 6572 7772  , you can overwr
-0002fee0: 6974 6520 6974 2062 7920 6164 6469 6e67  ite it by adding
-0002fef0: 2060 7061 6e64 6173 6020 7769 7468 2073   `pandas` with s
-0002ff00: 7065 6369 6669 6320 7665 7273 696f 6e0a  pecific version.
-0002ff10: 2020 2020 2020 2020 7265 7175 6972 656d          requirem
-0002ff20: 656e 7420 7573 696e 6720 6060 7061 636b  ent using ``pack
-0002ff30: 6167 6560 6020 6172 6775 6d65 6e74 206f  age`` argument o
-0002ff40: 7220 3a6d 6574 683a 607e 736e 6f77 666c  r :meth:`~snowfl
-0002ff50: 616b 652e 736e 6f77 7061 726b 2e53 6573  ake.snowpark.Ses
-0002ff60: 7369 6f6e 2e61 6464 5f70 6163 6b61 6765  sion.add_package
-0002ff70: 7360 2e0a 0a20 2020 2053 6565 2041 6c73  s`...    See Als
-0002ff80: 6f3a 0a20 2020 2020 2020 203a 636c 6173  o:.        :clas
-0002ff90: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
-0002ffa0: 6f77 7061 726b 2e75 6466 2e55 4446 5265  owpark.udf.UDFRe
-0002ffb0: 6769 7374 7261 7469 6f6e 600a 0a20 2020  gistration`..   
-0002ffc0: 2055 4446 7320 6361 6e20 6265 2063 7265   UDFs can be cre
-0002ffd0: 6174 6564 2061 7320 616e 6f6e 796d 6f75  ated as anonymou
-0002ffe0: 7320 5544 4673 0a0a 2020 2020 4578 616d  s UDFs..    Exam
-0002fff0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00030000: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00030010: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00030020: 2069 6d70 6f72 7420 496e 7465 6765 7254   import IntegerT
-00030030: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
-00030040: 6164 645f 6f6e 6520 3d20 7564 6628 6c61  add_one = udf(la
-00030050: 6d62 6461 2078 3a20 782b 312c 2072 6574  mbda x: x+1, ret
-00030060: 7572 6e5f 7479 7065 3d49 6e74 6567 6572  urn_type=Integer
-00030070: 5479 7065 2829 2c20 696e 7075 745f 7479  Type(), input_ty
-00030080: 7065 733d 5b49 6e74 6567 6572 5479 7065  pes=[IntegerType
-00030090: 2829 5d29 0a20 2020 2020 2020 203e 3e3e  ()]).        >>>
-000300a0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000300b0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-000300c0: 312c 2032 2c20 335d 2c20 7363 6865 6d61  1, 2, 3], schema
-000300d0: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-000300e0: 3e3e 3e20 6466 2e73 656c 6563 7428 6164  >>> df.select(ad
-000300f0: 645f 6f6e 6528 636f 6c28 2261 2229 292e  d_one(col("a")).
-00030100: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
-00030110: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00030120: 6f77 2841 4e53 3d32 292c 2052 6f77 2841  ow(ANS=2), Row(A
-00030130: 4e53 3d33 292c 2052 6f77 2841 4e53 3d34  NS=3), Row(ANS=4
-00030140: 295d 0a0a 2020 2020 6f72 2061 7320 6e61  )]..    or as na
-00030150: 6d65 6420 5544 4673 2074 6861 7420 6172  med UDFs that ar
-00030160: 6520 6163 6365 7373 6962 6c65 2069 6e20  e accessible in 
-00030170: 7468 6520 7361 6d65 2073 6573 7369 6f6e  the same session
-00030180: 2e20 496e 7374 6561 6420 6f66 2063 616c  . Instead of cal
-00030190: 6c69 6e67 2060 7564 6660 2061 7320 6675  ling `udf` as fu
-000301a0: 6e63 7469 6f6e 2c20 6974 2063 616e 2062  nction, it can b
-000301b0: 6520 616c 736f 2075 7365 640a 2020 2020  e also used.    
-000301c0: 6173 2061 2064 6563 6f72 6174 6f72 3a0a  as a decorator:.
-000301d0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-000301e0: 2020 2020 2020 2020 3e3e 3e20 4075 6466          >>> @udf
-000301f0: 286e 616d 653d 226d 696e 7573 5f6f 6e65  (name="minus_one
-00030200: 222c 2072 6570 6c61 6365 3d54 7275 6529  ", replace=True)
-00030210: 0a20 2020 2020 2020 202e 2e2e 2064 6566  .        ... def
-00030220: 206d 696e 7573 5f6f 6e65 2878 3a20 696e   minus_one(x: in
-00030230: 7429 202d 3e20 696e 743a 0a20 2020 2020  t) -> int:.     
-00030240: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
-00030250: 6e20 7820 2d20 310a 2020 2020 2020 2020  n x - 1.        
-00030260: 3e3e 3e20 6466 2e73 656c 6563 7428 6d69  >>> df.select(mi
-00030270: 6e75 735f 6f6e 6528 636f 6c28 2261 2229  nus_one(col("a")
-00030280: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
-00030290: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000302a0: 5b52 6f77 2841 4e53 3d30 292c 2052 6f77  [Row(ANS=0), Row
-000302b0: 2841 4e53 3d31 292c 2052 6f77 2841 4e53  (ANS=1), Row(ANS
-000302c0: 3d32 295d 0a20 2020 2020 2020 203e 3e3e  =2)].        >>>
-000302d0: 2073 6573 7369 6f6e 2e73 716c 2822 5345   session.sql("SE
-000302e0: 4c45 4354 206d 696e 7573 5f6f 6e65 2831  LECT minus_one(1
-000302f0: 3029 2229 2e63 6f6c 6c65 6374 2829 0a20  0)").collect(). 
-00030300: 2020 2020 2020 205b 526f 7728 4d49 4e55         [Row(MINU
-00030310: 535f 4f4e 4528 3130 293d 3929 5d0a 0a20  S_ONE(10)=9)].. 
-00030320: 2020 2022 2222 0a20 2020 2073 6573 7369     """.    sessi
-00030330: 6f6e 203d 2073 6573 7369 6f6e 206f 7220  on = session or 
-00030340: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00030350: 726b 2e73 6573 7369 6f6e 2e5f 6765 745f  rk.session._get_
-00030360: 6163 7469 7665 5f73 6573 7369 6f6e 2829  active_session()
-00030370: 0a20 2020 2069 6620 6675 6e63 2069 7320  .    if func is 
-00030380: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-00030390: 7475 726e 2066 756e 6374 6f6f 6c73 2e70  turn functools.p
-000303a0: 6172 7469 616c 280a 2020 2020 2020 2020  artial(.        
-000303b0: 2020 2020 7365 7373 696f 6e2e 7564 662e      session.udf.
-000303c0: 7265 6769 7374 6572 2c0a 2020 2020 2020  register,.      
-000303d0: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
-000303e0: 653d 7265 7475 726e 5f74 7970 652c 0a20  e=return_type,. 
-000303f0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00030400: 5f74 7970 6573 3d69 6e70 7574 5f74 7970  _types=input_typ
-00030410: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00030420: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
-00030430: 2020 2020 2020 2069 735f 7065 726d 616e         is_perman
-00030440: 656e 743d 6973 5f70 6572 6d61 6e65 6e74  ent=is_permanent
-00030450: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-00030460: 6167 655f 6c6f 6361 7469 6f6e 3d73 7461  age_location=sta
-00030470: 6765 5f6c 6f63 6174 696f 6e2c 0a20 2020  ge_location,.   
-00030480: 2020 2020 2020 2020 2069 6d70 6f72 7473           imports
-00030490: 3d69 6d70 6f72 7473 2c0a 2020 2020 2020  =imports,.      
-000304a0: 2020 2020 2020 7061 636b 6167 6573 3d70        packages=p
-000304b0: 6163 6b61 6765 732c 0a20 2020 2020 2020  ackages,.       
-000304c0: 2020 2020 2072 6570 6c61 6365 3d72 6570       replace=rep
-000304d0: 6c61 6365 2c0a 2020 2020 2020 2020 2020  lace,.          
-000304e0: 2020 6966 5f6e 6f74 5f65 7869 7374 733d    if_not_exists=
-000304f0: 6966 5f6e 6f74 5f65 7869 7374 732c 0a20  if_not_exists,. 
-00030500: 2020 2020 2020 2020 2020 2070 6172 616c             paral
-00030510: 6c65 6c3d 7061 7261 6c6c 656c 2c0a 2020  lel=parallel,.  
-00030520: 2020 2020 2020 2020 2020 6d61 785f 6261            max_ba
-00030530: 7463 685f 7369 7a65 3d6d 6178 5f62 6174  tch_size=max_bat
-00030540: 6368 5f73 697a 652c 0a20 2020 2020 2020  ch_size,.       
-00030550: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
-00030560: 6172 616d 733d 7374 6174 656d 656e 745f  arams=statement_
-00030570: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00030580: 2020 2020 736f 7572 6365 5f63 6f64 655f      source_code_
-00030590: 6469 7370 6c61 793d 736f 7572 6365 5f63  display=source_c
-000305a0: 6f64 655f 6469 7370 6c61 792c 0a20 2020  ode_display,.   
-000305b0: 2020 2020 2020 2020 2073 7472 6963 743d           strict=
-000305c0: 7374 7269 6374 2c0a 2020 2020 2020 2020  strict,.        
-000305d0: 2020 2020 7365 6375 7265 3d73 6563 7572      secure=secur
-000305e0: 652c 0a20 2020 2020 2020 2029 0a20 2020  e,.        ).   
-000305f0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-00030600: 6574 7572 6e20 7365 7373 696f 6e2e 7564  eturn session.ud
-00030610: 662e 7265 6769 7374 6572 280a 2020 2020  f.register(.    
-00030620: 2020 2020 2020 2020 6675 6e63 2c0a 2020          func,.  
-00030630: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00030640: 5f74 7970 653d 7265 7475 726e 5f74 7970  _type=return_typ
-00030650: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-00030660: 6e70 7574 5f74 7970 6573 3d69 6e70 7574  nput_types=input
-00030670: 5f74 7970 6573 2c0a 2020 2020 2020 2020  _types,.        
-00030680: 2020 2020 6e61 6d65 3d6e 616d 652c 0a20      name=name,. 
-00030690: 2020 2020 2020 2020 2020 2069 735f 7065             is_pe
-000306a0: 726d 616e 656e 743d 6973 5f70 6572 6d61  rmanent=is_perma
-000306b0: 6e65 6e74 2c0a 2020 2020 2020 2020 2020  nent,.          
-000306c0: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
-000306d0: 3d73 7461 6765 5f6c 6f63 6174 696f 6e2c  =stage_location,
-000306e0: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-000306f0: 6f72 7473 3d69 6d70 6f72 7473 2c0a 2020  orts=imports,.  
-00030700: 2020 2020 2020 2020 2020 7061 636b 6167            packag
-00030710: 6573 3d70 6163 6b61 6765 732c 0a20 2020  es=packages,.   
-00030720: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
-00030730: 3d72 6570 6c61 6365 2c0a 2020 2020 2020  =replace,.      
-00030740: 2020 2020 2020 6966 5f6e 6f74 5f65 7869        if_not_exi
-00030750: 7374 733d 6966 5f6e 6f74 5f65 7869 7374  sts=if_not_exist
-00030760: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
-00030770: 6172 616c 6c65 6c3d 7061 7261 6c6c 656c  arallel=parallel
-00030780: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-00030790: 785f 6261 7463 685f 7369 7a65 3d6d 6178  x_batch_size=max
-000307a0: 5f62 6174 6368 5f73 697a 652c 0a20 2020  _batch_size,.   
-000307b0: 2020 2020 2020 2020 2073 7461 7465 6d65           stateme
-000307c0: 6e74 5f70 6172 616d 733d 7374 6174 656d  nt_params=statem
-000307d0: 656e 745f 7061 7261 6d73 2c0a 2020 2020  ent_params,.    
-000307e0: 2020 2020 2020 2020 736f 7572 6365 5f63          source_c
-000307f0: 6f64 655f 6469 7370 6c61 793d 736f 7572  ode_display=sour
-00030800: 6365 5f63 6f64 655f 6469 7370 6c61 792c  ce_code_display,
-00030810: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00030820: 6963 743d 7374 7269 6374 2c0a 2020 2020  ict=strict,.    
-00030830: 2020 2020 2020 2020 7365 6375 7265 3d73          secure=s
-00030840: 6563 7572 652c 0a20 2020 2020 2020 2029  ecure,.        )
-00030850: 0a0a 0a64 6566 2075 6474 6628 0a20 2020  ...def udtf(.   
-00030860: 2068 616e 646c 6572 3a20 4f70 7469 6f6e   handler: Option
-00030870: 616c 5b43 616c 6c61 626c 655d 203d 204e  al[Callable] = N
-00030880: 6f6e 652c 0a20 2020 202a 2c0a 2020 2020  one,.    *,.    
-00030890: 6f75 7470 7574 5f73 6368 656d 613a 2055  output_schema: U
-000308a0: 6e69 6f6e 5b53 7472 7563 7454 7970 652c  nion[StructType,
-000308b0: 204c 6973 745b 7374 725d 5d2c 0a20 2020   List[str]],.   
-000308c0: 2069 6e70 7574 5f74 7970 6573 3a20 4f70   input_types: Op
-000308d0: 7469 6f6e 616c 5b4c 6973 745b 4461 7461  tional[List[Data
-000308e0: 5479 7065 5d5d 203d 204e 6f6e 652c 0a20  Type]] = None,. 
-000308f0: 2020 206e 616d 653a 204f 7074 696f 6e61     name: Optiona
-00030900: 6c5b 556e 696f 6e5b 7374 722c 2049 7465  l[Union[str, Ite
-00030910: 7261 626c 655b 7374 725d 5d5d 203d 204e  rable[str]]] = N
-00030920: 6f6e 652c 0a20 2020 2069 735f 7065 726d  one,.    is_perm
-00030930: 616e 656e 743a 2062 6f6f 6c20 3d20 4661  anent: bool = Fa
-00030940: 6c73 652c 0a20 2020 2073 7461 6765 5f6c  lse,.    stage_l
-00030950: 6f63 6174 696f 6e3a 204f 7074 696f 6e61  ocation: Optiona
-00030960: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-00030970: 2020 2069 6d70 6f72 7473 3a20 4f70 7469     imports: Opti
-00030980: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
-00030990: 7374 722c 2054 7570 6c65 5b73 7472 2c20  str, Tuple[str, 
-000309a0: 7374 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a  str]]]] = None,.
-000309b0: 2020 2020 7061 636b 6167 6573 3a20 4f70      packages: Op
-000309c0: 7469 6f6e 616c 5b4c 6973 745b 556e 696f  tional[List[Unio
-000309d0: 6e5b 7374 722c 204d 6f64 756c 6554 7970  n[str, ModuleTyp
-000309e0: 655d 5d5d 203d 204e 6f6e 652c 0a20 2020  e]]] = None,.   
-000309f0: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
-00030a00: 2046 616c 7365 2c0a 2020 2020 6966 5f6e   False,.    if_n
-00030a10: 6f74 5f65 7869 7374 733a 2062 6f6f 6c20  ot_exists: bool 
-00030a20: 3d20 4661 6c73 652c 0a20 2020 2073 6573  = False,.    ses
-00030a30: 7369 6f6e 3a20 4f70 7469 6f6e 616c 5b22  sion: Optional["
-00030a40: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00030a50: 726b 2e73 6573 7369 6f6e 2e53 6573 7369  rk.session.Sessi
-00030a60: 6f6e 225d 203d 204e 6f6e 652c 0a20 2020  on"] = None,.   
-00030a70: 2070 6172 616c 6c65 6c3a 2069 6e74 203d   parallel: int =
-00030a80: 2034 2c0a 2020 2020 7374 6174 656d 656e   4,.    statemen
-00030a90: 745f 7061 7261 6d73 3a20 4f70 7469 6f6e  t_params: Option
-00030aa0: 616c 5b44 6963 745b 7374 722c 2073 7472  al[Dict[str, str
-00030ab0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2073  ]] = None,.    s
-00030ac0: 7472 6963 743a 2062 6f6f 6c20 3d20 4661  trict: bool = Fa
-00030ad0: 6c73 652c 0a20 2020 2073 6563 7572 653a  lse,.    secure:
-00030ae0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a29   bool = False,.)
-00030af0: 202d 3e20 556e 696f 6e5b 5573 6572 4465   -> Union[UserDe
-00030b00: 6669 6e65 6454 6162 6c65 4675 6e63 7469  finedTableFuncti
-00030b10: 6f6e 2c20 6675 6e63 746f 6f6c 732e 7061  on, functools.pa
-00030b20: 7274 6961 6c5d 3a0a 2020 2020 2222 2252  rtial]:.    """R
-00030b30: 6567 6973 7465 7273 2061 2050 7974 686f  egisters a Pytho
-00030b40: 6e20 636c 6173 7320 6173 2061 2053 6e6f  n class as a Sno
-00030b50: 7766 6c61 6b65 2050 7974 686f 6e20 5544  wflake Python UD
-00030b60: 5446 2061 6e64 2072 6574 7572 6e73 2074  TF and returns t
-00030b70: 6865 2055 4454 462e 0a0a 2020 2020 4974  he UDTF...    It
-00030b80: 2063 616e 2062 6520 7573 6564 2061 7320   can be used as 
-00030b90: 6569 7468 6572 2061 2066 756e 6374 696f  either a functio
-00030ba0: 6e20 6361 6c6c 206f 7220 6120 6465 636f  n call or a deco
-00030bb0: 7261 746f 722e 2049 6e20 6d6f 7374 2063  rator. In most c
-00030bc0: 6173 6573 2079 6f75 2077 6f72 6b20 7769  ases you work wi
-00030bd0: 7468 2061 2073 696e 676c 6520 7365 7373  th a single sess
-00030be0: 696f 6e2e 0a20 2020 2054 6869 7320 6675  ion..    This fu
-00030bf0: 6e63 7469 6f6e 2075 7365 7320 7468 6174  nction uses that
-00030c00: 2073 6573 7369 6f6e 2074 6f20 7265 6769   session to regi
-00030c10: 7374 6572 2074 6865 2055 4454 462e 2049  ster the UDTF. I
-00030c20: 6620 796f 7520 6861 7665 206d 756c 7469  f you have multi
-00030c30: 706c 6520 7365 7373 696f 6e73 2c20 796f  ple sessions, yo
-00030c40: 7520 6e65 6564 2074 6f0a 2020 2020 6578  u need to.    ex
-00030c50: 706c 6963 6974 6c79 2073 7065 6369 6679  plicitly specify
-00030c60: 2074 6865 2060 6073 6573 7369 6f6e 6060   the ``session``
-00030c70: 2070 6172 616d 6574 6572 206f 6620 7468   parameter of th
-00030c80: 6973 2066 756e 6374 696f 6e2e 2049 6620  is function. If 
-00030c90: 796f 7520 6861 7665 2061 2066 756e 6374  you have a funct
-00030ca0: 696f 6e20 616e 6420 776f 756c 640a 2020  ion and would.  
-00030cb0: 2020 6c69 6b65 2074 6f20 7265 6769 7374    like to regist
-00030cc0: 6572 2069 7420 746f 206d 756c 7469 706c  er it to multipl
-00030cd0: 6520 6461 7461 6261 7365 732c 2075 7365  e databases, use
-00030ce0: 2060 6073 6573 7369 6f6e 2e75 6474 662e   ``session.udtf.
-00030cf0: 7265 6769 7374 6572 6060 2069 6e73 7465  register`` inste
-00030d00: 6164 2e20 5365 6520 6578 616d 706c 6573  ad. See examples
-00030d10: 0a20 2020 2069 6e20 3a63 6c61 7373 3a60  .    in :class:`
-00030d20: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00030d30: 6172 6b2e 7564 7466 2e55 4454 4652 6567  ark.udtf.UDTFReg
-00030d40: 6973 7472 6174 696f 6e60 2e0a 0a20 2020  istration`...   
-00030d50: 2041 7267 733a 0a20 2020 2020 2020 2068   Args:.        h
-00030d60: 616e 646c 6572 3a20 4120 5079 7468 6f6e  andler: A Python
-00030d70: 2063 6c61 7373 2075 7365 6420 666f 7220   class used for 
-00030d80: 6372 6561 7469 6e67 2074 6865 2055 4454  creating the UDT
-00030d90: 462e 0a20 2020 2020 2020 206f 7574 7075  F..        outpu
-00030da0: 745f 7363 6865 6d61 3a20 4120 6c69 7374  t_schema: A list
-00030db0: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
-00030dc0: 2c20 6f72 2061 203a 636c 6173 733a 607e  , or a :class:`~
-00030dd0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00030de0: 726b 2e74 7970 6573 2e53 7472 7563 7454  rk.types.StructT
-00030df0: 7970 6560 2069 6e73 7461 6e63 6520 7468  ype` instance th
-00030e00: 6174 2072 6570 7265 7365 6e74 7320 7468  at represents th
-00030e10: 6520 7461 626c 6520 6675 6e63 7469 6f6e  e table function
-00030e20: 2773 2063 6f6c 756d 6e73 2e0a 2020 2020  's columns..    
-00030e30: 2020 2020 2049 6620 6120 6c69 7374 206f       If a list o
-00030e40: 6620 636f 6c75 6d6e 206e 616d 6573 2069  f column names i
-00030e50: 7320 7072 6f76 6964 6564 2c20 7468 6520  s provided, the 
-00030e60: 6060 7072 6f63 6573 7360 6020 6d65 7468  ``process`` meth
-00030e70: 6f64 206f 6620 7468 6520 6861 6e64 6c65  od of the handle
-00030e80: 7220 636c 6173 7320 6d75 7374 2068 6176  r class must hav
-00030e90: 6520 7265 7475 726e 2074 7970 6520 6869  e return type hi
-00030ea0: 6e74 7320 746f 2069 6e64 6963 6174 6520  nts to indicate 
-00030eb0: 7468 6520 6f75 7470 7574 2073 6368 656d  the output schem
-00030ec0: 6120 6461 7461 2074 7970 6573 2e0a 2020  a data types..  
-00030ed0: 2020 2020 2020 696e 7075 745f 7479 7065        input_type
-00030ee0: 733a 2041 206c 6973 7420 6f66 203a 636c  s: A list of :cl
-00030ef0: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
-00030f00: 736e 6f77 7061 726b 2e74 7970 6573 2e44  snowpark.types.D
-00030f10: 6174 6154 7970 6560 0a20 2020 2020 2020  ataType`.       
-00030f20: 2020 2020 2072 6570 7265 7365 6e74 696e       representin
-00030f30: 6720 7468 6520 696e 7075 7420 6461 7461  g the input data
-00030f40: 2074 7970 6573 206f 6620 7468 6520 5544   types of the UD
-00030f50: 5446 2e20 4f70 7469 6f6e 616c 2069 660a  TF. Optional if.
-00030f60: 2020 2020 2020 2020 2020 2020 7479 7065              type
-00030f70: 2068 696e 7473 2061 7265 2070 726f 7669   hints are provi
-00030f80: 6465 642e 0a20 2020 2020 2020 206e 616d  ded..        nam
-00030f90: 653a 2041 2073 7472 696e 6720 6f72 206c  e: A string or l
-00030fa0: 6973 7420 6f66 2073 7472 696e 6773 2074  ist of strings t
-00030fb0: 6861 7420 7370 6563 6966 7920 7468 6520  hat specify the 
-00030fc0: 6e61 6d65 206f 7220 6675 6c6c 792d 7175  name or fully-qu
-00030fd0: 616c 6966 6965 640a 2020 2020 2020 2020  alified.        
-00030fe0: 2020 2020 6f62 6a65 6374 2069 6465 6e74      object ident
-00030ff0: 6966 6965 7220 2864 6174 6162 6173 6520  ifier (database 
-00031000: 6e61 6d65 2c20 7363 6865 6d61 206e 616d  name, schema nam
-00031010: 652c 2061 6e64 2066 756e 6374 696f 6e20  e, and function 
-00031020: 6e61 6d65 2920 666f 720a 2020 2020 2020  name) for.      
-00031030: 2020 2020 2020 7468 6520 5544 5446 2069        the UDTF i
-00031040: 6e20 536e 6f77 666c 616b 652c 2077 6869  n Snowflake, whi
-00031050: 6368 2061 6c6c 6f77 7320 796f 7520 746f  ch allows you to
-00031060: 2063 616c 6c20 7468 6973 2055 4454 4620   call this UDTF 
-00031070: 696e 2061 2053 514c 0a20 2020 2020 2020  in a SQL.       
-00031080: 2020 2020 2063 6f6d 6d61 6e64 206f 7220       command or 
-00031090: 7669 6120 3a66 756e 633a 6063 616c 6c5f  via :func:`call_
-000310a0: 7564 7466 2829 602e 2049 6620 6974 2069  udtf()`. If it i
-000310b0: 7320 6e6f 7420 7072 6f76 6964 6564 2c20  s not provided, 
-000310c0: 6120 6e61 6d65 2077 696c 6c0a 2020 2020  a name will.    
-000310d0: 2020 2020 2020 2020 6265 2061 7574 6f6d          be autom
-000310e0: 6174 6963 616c 6c79 2067 656e 6572 6174  atically generat
-000310f0: 6564 2066 6f72 2074 6865 2055 4454 462e  ed for the UDTF.
-00031100: 2041 206e 616d 6520 6d75 7374 2062 6520   A name must be 
-00031110: 7370 6563 6966 6965 6420 7768 656e 0a20  specified when. 
-00031120: 2020 2020 2020 2020 2020 2060 6069 735f             ``is_
-00031130: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
-00031140: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
-00031150: 2069 735f 7065 726d 616e 656e 743a 2057   is_permanent: W
-00031160: 6865 7468 6572 2074 6f20 6372 6561 7465  hether to create
-00031170: 2061 2070 6572 6d61 6e65 6e74 2055 4454   a permanent UDT
-00031180: 462e 2054 6865 2064 6566 6175 6c74 2069  F. The default i
-00031190: 7320 6060 4661 6c73 6560 602e 0a20 2020  s ``False``..   
-000311a0: 2020 2020 2020 2020 2049 6620 6974 2069           If it i
-000311b0: 7320 6060 5472 7565 6060 2c20 6120 7661  s ``True``, a va
-000311c0: 6c69 6420 6060 7374 6167 655f 6c6f 6361  lid ``stage_loca
-000311d0: 7469 6f6e 6060 206d 7573 7420 6265 2070  tion`` must be p
-000311e0: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
-000311f0: 2073 7461 6765 5f6c 6f63 6174 696f 6e3a   stage_location:
-00031200: 2054 6865 2073 7461 6765 206c 6f63 6174   The stage locat
-00031210: 696f 6e20 7768 6572 6520 7468 6520 5079  ion where the Py
-00031220: 7468 6f6e 2066 696c 6520 666f 7220 7468  thon file for th
-00031230: 6520 5544 5446 0a20 2020 2020 2020 2020  e UDTF.         
-00031240: 2020 2061 6e64 2069 7473 2064 6570 656e     and its depen
-00031250: 6465 6e63 6965 7320 7368 6f75 6c64 2062  dencies should b
-00031260: 6520 7570 6c6f 6164 6564 2e20 5468 6520  e uploaded. The 
-00031270: 7374 6167 6520 6c6f 6361 7469 6f6e 206d  stage location m
-00031280: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
-00031290: 0a20 2020 2020 2020 2020 2020 2077 6865  .            whe
-000312a0: 6e20 6060 6973 5f70 6572 6d61 6e65 6e74  n ``is_permanent
-000312b0: 6060 2069 7320 6060 5472 7565 6060 2c20  `` is ``True``, 
-000312c0: 616e 6420 6974 2077 696c 6c20 6265 2069  and it will be i
-000312d0: 676e 6f72 6564 2077 6865 6e0a 2020 2020  gnored when.    
-000312e0: 2020 2020 2020 2020 6060 6973 5f70 6572          ``is_per
-000312f0: 6d61 6e65 6e74 6060 2069 7320 6060 4661  manent`` is ``Fa
-00031300: 6c73 6560 602e 2049 7420 6361 6e20 6265  lse``. It can be
-00031310: 2061 6e79 2073 7461 6765 206f 7468 6572   any stage other
-00031320: 2074 6861 6e20 7465 6d70 6f72 6172 790a   than temporary.
-00031330: 2020 2020 2020 2020 2020 2020 7374 6167              stag
-00031340: 6573 2061 6e64 2065 7874 6572 6e61 6c20  es and external 
-00031350: 7374 6167 6573 2e0a 2020 2020 2020 2020  stages..        
-00031360: 696d 706f 7274 733a 2041 206c 6973 7420  imports: A list 
-00031370: 6f66 2069 6d70 6f72 7473 2074 6861 7420  of imports that 
-00031380: 6f6e 6c79 2061 7070 6c79 2074 6f20 7468  only apply to th
-00031390: 6973 2055 4454 462e 2059 6f75 2063 616e  is UDTF. You can
-000313a0: 2075 7365 2061 2073 7472 696e 6720 746f   use a string to
-000313b0: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
-000313c0: 7265 7365 6e74 2061 2066 696c 6520 7061  resent a file pa
-000313d0: 7468 2028 7369 6d69 6c61 7220 746f 2074  th (similar to t
-000313e0: 6865 2060 6070 6174 6860 6020 6172 6775  he ``path`` argu
-000313f0: 6d65 6e74 2069 6e0a 2020 2020 2020 2020  ment in.        
-00031400: 2020 2020 3a6d 6574 683a 607e 736e 6f77      :meth:`~snow
-00031410: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
-00031420: 6573 7369 6f6e 2e61 6464 5f69 6d70 6f72  ession.add_impor
-00031430: 7460 2920 696e 2074 6869 7320 6c69 7374  t`) in this list
-00031440: 2c20 6f72 2061 2074 7570 6c65 206f 6620  , or a tuple of 
-00031450: 7477 6f0a 2020 2020 2020 2020 2020 2020  two.            
-00031460: 7374 7269 6e67 7320 746f 2072 6570 7265  strings to repre
-00031470: 7365 6e74 2061 2066 696c 6520 7061 7468  sent a file path
-00031480: 2061 6e64 2061 6e20 696d 706f 7274 2070   and an import p
-00031490: 6174 6820 2873 696d 696c 6172 2074 6f20  ath (similar to 
-000314a0: 7468 6520 6060 696d 706f 7274 5f70 6174  the ``import_pat
-000314b0: 6860 600a 2020 2020 2020 2020 2020 2020  h``.            
-000314c0: 6172 6775 6d65 6e74 2069 6e20 3a6d 6574  argument in :met
-000314d0: 683a 607e 736e 6f77 666c 616b 652e 736e  h:`~snowflake.sn
-000314e0: 6f77 7061 726b 2e53 6573 7369 6f6e 2e61  owpark.Session.a
-000314f0: 6464 5f69 6d70 6f72 7460 292e 2054 6865  dd_import`). The
-00031500: 7365 2055 4454 462d 6c65 7665 6c20 696d  se UDTF-level im
-00031510: 706f 7274 730a 2020 2020 2020 2020 2020  ports.          
-00031520: 2020 7769 6c6c 206f 7665 7272 6964 6520    will override 
-00031530: 7468 6520 7365 7373 696f 6e2d 6c65 7665  the session-leve
-00031540: 6c20 696d 706f 7274 7320 6164 6465 6420  l imports added 
-00031550: 6279 0a20 2020 2020 2020 2020 2020 203a  by.            :
-00031560: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
-00031570: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
-00031580: 6e2e 6164 645f 696d 706f 7274 602e 0a20  n.add_import`.. 
-00031590: 2020 2020 2020 2070 6163 6b61 6765 733a         packages:
-000315a0: 2041 206c 6973 7420 6f66 2070 6163 6b61   A list of packa
-000315b0: 6765 7320 7468 6174 206f 6e6c 7920 6170  ges that only ap
-000315c0: 706c 7920 746f 2074 6869 7320 5544 5446  ply to this UDTF
-000315d0: 2e20 5468 6573 6520 5544 5446 2d6c 6576  . These UDTF-lev
-000315e0: 656c 2070 6163 6b61 6765 730a 2020 2020  el packages.    
-000315f0: 2020 2020 2020 2020 7769 6c6c 206f 7665          will ove
-00031600: 7272 6964 6520 7468 6520 7365 7373 696f  rride the sessio
-00031610: 6e2d 6c65 7665 6c20 7061 636b 6167 6573  n-level packages
-00031620: 2061 6464 6564 2062 790a 2020 2020 2020   added by.      
-00031630: 2020 2020 2020 3a6d 6574 683a 607e 736e        :meth:`~sn
-00031640: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00031650: 2e53 6573 7369 6f6e 2e61 6464 5f70 6163  .Session.add_pac
-00031660: 6b61 6765 7360 2061 6e64 0a20 2020 2020  kages` and.     
-00031670: 2020 2020 2020 203a 6d65 7468 3a60 7e73         :meth:`~s
-00031680: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00031690: 6b2e 5365 7373 696f 6e2e 6164 645f 7265  k.Session.add_re
-000316a0: 7175 6972 656d 656e 7473 602e 0a20 2020  quirements`..   
-000316b0: 2020 2020 2072 6570 6c61 6365 3a20 5768       replace: Wh
-000316c0: 6574 6865 7220 746f 2072 6570 6c61 6365  ether to replace
-000316d0: 2061 2055 4454 4620 7468 6174 2061 6c72   a UDTF that alr
-000316e0: 6561 6479 2077 6173 2072 6567 6973 7465  eady was registe
-000316f0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
-00031700: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
-00031710: 2020 2020 2020 2020 2020 2049 6620 6974             If it
-00031720: 2069 7320 6060 4661 6c73 6560 602c 2061   is ``False``, a
-00031730: 7474 656d 7074 696e 6720 746f 2072 6567  ttempting to reg
-00031740: 6973 7465 7220 6120 5544 5446 2077 6974  ister a UDTF wit
-00031750: 6820 6120 6e61 6d65 2074 6861 7420 616c  h a name that al
-00031760: 7265 6164 7920 6578 6973 7473 0a20 2020  ready exists.   
-00031770: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00031780: 2069 6e20 6120 6060 536e 6f77 7061 726b   in a ``Snowpark
-00031790: 5351 4c45 7863 6570 7469 6f6e 6060 2065  SQLException`` e
-000317a0: 7863 6570 7469 6f6e 2062 6569 6e67 2074  xception being t
-000317b0: 6872 6f77 6e2e 2049 6620 6974 2069 7320  hrown. If it is 
-000317c0: 6060 5472 7565 6060 2c0a 2020 2020 2020  ``True``,.      
-000317d0: 2020 2020 2020 616e 2065 7869 7374 696e        an existin
-000317e0: 6720 5544 5446 2077 6974 6820 7468 6520  g UDTF with the 
-000317f0: 7361 6d65 206e 616d 6520 6973 206f 7665  same name is ove
-00031800: 7277 7269 7474 656e 2e0a 2020 2020 2020  rwritten..      
-00031810: 2020 6966 5f6e 6f74 5f65 7869 7374 733a    if_not_exists:
-00031820: 2057 6865 7468 6572 2074 6f20 736b 6970   Whether to skip
-00031830: 2063 7265 6174 696f 6e20 6f66 2061 2055   creation of a U
-00031840: 4454 4620 7768 656e 206f 6e65 2077 6974  DTF when one wit
-00031850: 6820 7468 6520 7361 6d65 2073 6967 6e61  h the same signa
-00031860: 7475 7265 2061 6c72 6561 6479 2065 7869  ture already exi
-00031870: 7374 732e 0a20 2020 2020 2020 2020 2020  sts..           
-00031880: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-00031890: 6060 4661 6c73 6560 602e 2060 6069 665f  ``False``. ``if_
-000318a0: 6e6f 745f 6578 6973 7473 6060 2061 6e64  not_exists`` and
-000318b0: 2060 6072 6570 6c61 6365 6060 2061 7265   ``replace`` are
-000318c0: 206d 7574 7561 6c6c 7920 6578 636c 7573   mutually exclus
-000318d0: 6976 650a 2020 2020 2020 2020 2020 2020  ive.            
-000318e0: 616e 6420 6120 6060 5661 6c75 6545 7272  and a ``ValueErr
-000318f0: 6f72 6060 2069 7320 7261 6973 6564 2077  or`` is raised w
-00031900: 6865 6e20 626f 7468 2061 7265 2073 6574  hen both are set
-00031910: 2e20 4966 2069 7420 6973 2060 6054 7275  . If it is ``Tru
-00031920: 6560 6020 616e 6420 6120 5544 5446 2077  e`` and a UDTF w
-00031930: 6974 680a 2020 2020 2020 2020 2020 2020  ith.            
-00031940: 7468 6520 7361 6d65 2073 6967 6e61 7475  the same signatu
-00031950: 7265 2065 7869 7374 732c 2074 6865 2055  re exists, the U
-00031960: 4454 4620 6372 6561 7469 6f6e 2069 7320  DTF creation is 
-00031970: 736b 6970 7065 642e 0a20 2020 2020 2020  skipped..       
-00031980: 2073 6573 7369 6f6e 3a20 5573 6520 7468   session: Use th
-00031990: 6973 2073 6573 7369 6f6e 2074 6f20 7265  is session to re
-000319a0: 6769 7374 6572 2074 6865 2055 4454 462e  gister the UDTF.
-000319b0: 2049 6620 6974 2773 206e 6f74 2073 7065   If it's not spe
-000319c0: 6369 6669 6564 2c20 7468 6520 7365 7373  cified, the sess
-000319d0: 696f 6e20 7468 6174 2079 6f75 2063 7265  ion that you cre
-000319e0: 6174 6564 2062 6566 6f72 6520 6361 6c6c  ated before call
-000319f0: 696e 6720 7468 6973 2066 756e 6374 696f  ing this functio
-00031a00: 6e20 7769 6c6c 2062 6520 7573 6564 2e0a  n will be used..
-00031a10: 2020 2020 2020 2020 2020 2020 596f 7520              You 
-00031a20: 6e65 6564 2074 6f20 7370 6563 6966 7920  need to specify 
-00031a30: 7468 6973 2070 6172 616d 6574 6572 2069  this parameter i
-00031a40: 6620 796f 7520 6861 7665 2063 7265 6174  f you have creat
-00031a50: 6564 206d 756c 7469 706c 6520 7365 7373  ed multiple sess
-00031a60: 696f 6e73 2062 6566 6f72 6520 6361 6c6c  ions before call
-00031a70: 696e 6720 7468 6973 206d 6574 686f 642e  ing this method.
-00031a80: 0a20 2020 2020 2020 2070 6172 616c 6c65  .        paralle
-00031a90: 6c3a 2054 6865 206e 756d 6265 7220 6f66  l: The number of
-00031aa0: 2074 6872 6561 6473 2074 6f20 7573 6520   threads to use 
-00031ab0: 666f 7220 7570 6c6f 6164 696e 6720 5544  for uploading UD
-00031ac0: 5446 2066 696c 6573 2077 6974 6820 7468  TF files with th
-00031ad0: 650a 2020 2020 2020 2020 2020 2020 6050  e.            `P
-00031ae0: 5554 203c 6874 7470 733a 2f2f 646f 6373  UT <https://docs
-00031af0: 2e73 6e6f 7766 6c61 6b65 2e63 6f6d 2f65  .snowflake.com/e
-00031b00: 6e2f 7371 6c2d 7265 6665 7265 6e63 652f  n/sql-reference/
-00031b10: 7371 6c2f 7075 742e 6874 6d6c 2370 7574  sql/put.html#put
-00031b20: 3e60 5f0a 2020 2020 2020 2020 2020 2020  >`_.            
-00031b30: 636f 6d6d 616e 642e 2054 6865 2064 6566  command. The def
-00031b40: 6175 6c74 2076 616c 7565 2069 7320 3420  ault value is 4 
-00031b50: 616e 6420 7375 7070 6f72 7465 6420 7661  and supported va
-00031b60: 6c75 6573 2061 7265 2066 726f 6d20 3120  lues are from 1 
-00031b70: 746f 2039 392e 0a20 2020 2020 2020 2020  to 99..         
-00031b80: 2020 2049 6e63 7265 6173 696e 6720 7468     Increasing th
-00031b90: 6520 6e75 6d62 6572 206f 6620 7468 7265  e number of thre
-00031ba0: 6164 7320 6361 6e20 696d 7072 6f76 6520  ads can improve 
-00031bb0: 7065 7266 6f72 6d61 6e63 6520 7768 656e  performance when
-00031bc0: 2075 706c 6f61 6469 6e67 0a20 2020 2020   uploading.     
-00031bd0: 2020 2020 2020 206c 6172 6765 2055 4454         large UDT
-00031be0: 4620 6669 6c65 732e 0a20 2020 2020 2020  F files..       
-00031bf0: 2073 7461 7465 6d65 6e74 5f70 6172 616d   statement_param
-00031c00: 733a 2044 6963 7469 6f6e 6172 7920 6f66  s: Dictionary of
-00031c10: 2073 7461 7465 6d65 6e74 206c 6576 656c   statement level
-00031c20: 2070 6172 616d 6574 6572 7320 746f 2062   parameters to b
-00031c30: 6520 7365 7420 7768 696c 6520 6578 6563  e set while exec
-00031c40: 7574 696e 6720 7468 6973 2061 6374 696f  uting this actio
-00031c50: 6e2e 0a20 2020 2020 2020 2073 7472 6963  n..        stric
-00031c60: 743a 2057 6865 7468 6572 2074 6865 2063  t: Whether the c
-00031c70: 7265 6174 6564 2055 4454 4620 6973 2073  reated UDTF is s
-00031c80: 7472 6963 742e 2041 2073 7472 6963 7420  trict. A strict 
-00031c90: 5544 5446 2077 696c 6c20 6e6f 7420 696e  UDTF will not in
-00031ca0: 766f 6b65 2074 6865 2055 4454 4620 6966  voke the UDTF if
-00031cb0: 2061 6e79 2069 6e70 7574 2069 730a 2020   any input is.  
-00031cc0: 2020 2020 2020 2020 2020 6e75 6c6c 2e20            null. 
-00031cd0: 496e 7374 6561 642c 2061 206e 756c 6c20  Instead, a null 
-00031ce0: 7661 6c75 6520 7769 6c6c 2061 6c77 6179  value will alway
-00031cf0: 7320 6265 2072 6574 7572 6e65 6420 666f  s be returned fo
-00031d00: 7220 7468 6174 2072 6f77 2e20 4e6f 7465  r that row. Note
-00031d10: 2074 6861 7420 7468 6520 5544 5446 206d   that the UDTF m
-00031d20: 6967 6874 0a20 2020 2020 2020 2020 2020  ight.           
-00031d30: 2073 7469 6c6c 2072 6574 7572 6e20 6e75   still return nu
-00031d40: 6c6c 2066 6f72 206e 6f6e 2d6e 756c 6c20  ll for non-null 
-00031d50: 696e 7075 7473 2e0a 2020 2020 2020 2020  inputs..        
-00031d60: 7365 6375 7265 3a20 5768 6574 6865 7220  secure: Whether 
-00031d70: 7468 6520 6372 6561 7465 6420 5544 5446  the created UDTF
-00031d80: 2069 7320 7365 6375 7265 2e20 466f 7220   is secure. For 
-00031d90: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-00031da0: 2061 626f 7574 2073 6563 7572 6520 6675   about secure fu
-00031db0: 6e63 7469 6f6e 732c 0a20 2020 2020 2020  nctions,.       
-00031dc0: 2020 2020 2073 6565 2060 5365 6375 7265       see `Secure
-00031dd0: 2055 4446 7320 3c68 7474 7073 3a2f 2f64   UDFs <https://d
-00031de0: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
-00031df0: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
-00031e00: 6365 2f75 6466 2d73 6563 7572 652e 6874  ce/udf-secure.ht
-00031e10: 6d6c 3e60 5f2e 0a0a 2020 2020 5265 7475  ml>`_...    Retu
-00031e20: 726e 733a 0a20 2020 2020 2020 2041 2055  rns:.        A U
-00031e30: 4454 4620 6675 6e63 7469 6f6e 2074 6861  DTF function tha
-00031e40: 7420 6361 6e20 6265 2063 616c 6c65 6420  t can be called 
-00031e50: 7769 7468 203a 636c 6173 733a 607e 736e  with :class:`~sn
-00031e60: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00031e70: 2e43 6f6c 756d 6e60 2065 7870 7265 7373  .Column` express
-00031e80: 696f 6e73 2e0a 0a20 2020 204e 6f74 653a  ions...    Note:
-00031e90: 0a20 2020 2020 2020 2031 2e20 5768 656e  .        1. When
-00031ea0: 2074 7970 6520 6869 6e74 7320 6172 6520   type hints are 
-00031eb0: 7072 6f76 6964 6564 2061 6e64 2061 7265  provided and are
-00031ec0: 2063 6f6d 706c 6574 6520 666f 7220 6120   complete for a 
-00031ed0: 6675 6e63 7469 6f6e 2c0a 2020 2020 2020  function,.      
-00031ee0: 2020 6060 7265 7475 726e 5f74 7970 6560    ``return_type`
-00031ef0: 6020 616e 6420 6060 696e 7075 745f 7479  ` and ``input_ty
-00031f00: 7065 7360 6020 6172 6520 6f70 7469 6f6e  pes`` are option
-00031f10: 616c 2061 6e64 2077 696c 6c20 6265 2069  al and will be i
-00031f20: 676e 6f72 6564 2e0a 2020 2020 2020 2020  gnored..        
-00031f30: 5365 6520 6465 7461 696c 7320 6f66 2073  See details of s
-00031f40: 7570 706f 7274 6564 2064 6174 6120 7479  upported data ty
-00031f50: 7065 7320 666f 7220 5544 5446 7320 696e  pes for UDTFs in
-00031f60: 0a20 2020 2020 2020 203a 636c 6173 733a  .        :class:
-00031f70: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-00031f80: 7061 726b 2e75 6474 662e 5544 5446 5265  park.udtf.UDTFRe
-00031f90: 6769 7374 7261 7469 6f6e 602e 0a0a 2020  gistration`...  
-00031fa0: 2020 2020 2020 2020 2020 2d20 596f 7520            - You 
-00031fb0: 6361 6e20 7573 6520 7573 6520 3a61 7474  can use use :att
-00031fc0: 723a 607e 736e 6f77 666c 616b 652e 736e  r:`~snowflake.sn
-00031fd0: 6f77 7061 726b 2e74 7970 6573 2e56 6172  owpark.types.Var
-00031fe0: 6961 6e74 6020 746f 0a20 2020 2020 2020  iant` to.       
-00031ff0: 2020 2020 2020 2061 6e6e 6f74 6174 6520         annotate 
-00032000: 6120 7661 7269 616e 742c 2061 6e64 2075  a variant, and u
-00032010: 7365 203a 6174 7472 3a60 7e73 6e6f 7766  se :attr:`~snowf
-00032020: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-00032030: 7065 732e 4765 6f67 7261 7068 7960 0a20  pes.Geography`. 
-00032040: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
-00032050: 616e 6e6f 7461 7465 2061 2067 656f 6772  annotate a geogr
-00032060: 6170 6879 2077 6865 6e20 6465 6669 6e69  aphy when defini
-00032070: 6e67 2061 2055 4454 462e 0a0a 2020 2020  ng a UDTF...    
-00032080: 2020 2020 2020 2020 2d20 3a63 6c61 7373          - :class
-00032090: 3a60 7479 7069 6e67 2e55 6e69 6f6e 6020  :`typing.Union` 
-000320a0: 6973 206e 6f74 2061 2076 616c 6964 2074  is not a valid t
-000320b0: 7970 6520 616e 6e6f 7461 7469 6f6e 2066  ype annotation f
-000320c0: 6f72 2055 4454 4673 2c0a 2020 2020 2020  or UDTFs,.      
-000320d0: 2020 2020 2020 2020 6275 7420 3a63 6c61          but :cla
-000320e0: 7373 3a60 7479 7069 6e67 2e4f 7074 696f  ss:`typing.Optio
-000320f0: 6e61 6c60 2063 616e 2062 6520 7573 6564  nal` can be used
-00032100: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00032110: 206f 7074 696f 6e61 6c20 7479 7065 2e0a   optional type..
-00032120: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
-00032130: 7970 6520 6869 6e74 7320 6172 6520 6e6f  ype hints are no
-00032140: 7420 7375 7070 6f72 7465 6420 6f6e 2066  t supported on f
-00032150: 756e 6374 696f 6e73 2064 6563 6f72 6174  unctions decorat
-00032160: 6564 2077 6974 6820 6465 636f 7261 746f  ed with decorato
-00032170: 7273 2e0a 0a20 2020 2020 2020 2032 2e20  rs...        2. 
-00032180: 4120 7465 6d70 6f72 6172 7920 5544 5446  A temporary UDTF
-00032190: 2028 7768 656e 2060 6069 735f 7065 726d   (when ``is_perm
-000321a0: 616e 656e 7460 6020 6973 2060 6046 616c  anent`` is ``Fal
-000321b0: 7365 6060 2920 6973 2073 636f 7065 6420  se``) is scoped 
-000321c0: 746f 2074 6869 7320 6060 7365 7373 696f  to this ``sessio
-000321d0: 6e60 600a 2020 2020 2020 2020 616e 6420  n``.        and 
-000321e0: 616c 6c20 5544 5446 2072 656c 6174 6564  all UDTF related
-000321f0: 2066 696c 6573 2077 696c 6c20 6265 2075   files will be u
-00032200: 706c 6f61 6465 6420 746f 2061 2074 656d  ploaded to a tem
-00032210: 706f 7261 7279 2073 6573 7369 6f6e 2073  porary session s
-00032220: 7461 6765 0a20 2020 2020 2020 2028 3a66  tage.        (:f
-00032230: 756e 633a 6073 6573 7369 6f6e 2e67 6574  unc:`session.get
-00032240: 5f73 6573 7369 6f6e 5f73 7461 6765 2829  _session_stage()
-00032250: 203c 736e 6f77 666c 616b 652e 736e 6f77   <snowflake.snow
-00032260: 7061 726b 2e53 6573 7369 6f6e 2e67 6574  park.Session.get
-00032270: 5f73 6573 7369 6f6e 5f73 7461 6765 3e60  _session_stage>`
-00032280: 292e 0a20 2020 2020 2020 2046 6f72 2061  )..        For a
-00032290: 2070 6572 6d61 6e65 6e74 2055 4454 462c   permanent UDTF,
-000322a0: 2074 6865 7365 2066 696c 6573 2077 696c   these files wil
-000322b0: 6c20 6265 2075 706c 6f61 6465 6420 746f  l be uploaded to
-000322c0: 2074 6865 2073 7461 6765 2074 6861 7420   the stage that 
-000322d0: 796f 7520 7370 6563 6966 792e 0a0a 2020  you specify...  
-000322e0: 2020 2020 2020 332e 2042 7920 6465 6661        3. By defa
-000322f0: 756c 742c 2055 4454 4620 7265 6769 7374  ult, UDTF regist
-00032300: 7261 7469 6f6e 2066 6169 6c73 2069 6620  ration fails if 
-00032310: 6120 6675 6e63 7469 6f6e 2077 6974 6820  a function with 
-00032320: 7468 6520 7361 6d65 206e 616d 6520 6973  the same name is
-00032330: 2061 6c72 6561 6479 0a20 2020 2020 2020   already.       
-00032340: 2072 6567 6973 7465 7265 642e 2049 6e76   registered. Inv
-00032350: 6f6b 696e 6720 3a66 756e 633a 6075 6474  oking :func:`udt
-00032360: 6660 2077 6974 6820 6060 7265 706c 6163  f` with ``replac
-00032370: 6560 6020 7365 7420 746f 2060 6054 7275  e`` set to ``Tru
-00032380: 6560 6020 7769 6c6c 206f 7665 7277 7269  e`` will overwri
-00032390: 7465 2074 6865 0a20 2020 2020 2020 2070  te the.        p
-000323a0: 7265 7669 6f75 736c 7920 7265 6769 7374  reviously regist
-000323b0: 6572 6564 2066 756e 6374 696f 6e2e 0a0a  ered function...
-000323c0: 2020 2020 5365 6520 416c 736f 3a0a 2020      See Also:.  
-000323d0: 2020 2020 2020 3a63 6c61 7373 3a60 7e73        :class:`~s
-000323e0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-000323f0: 6b2e 7564 7466 2e55 4454 4652 6567 6973  k.udtf.UDTFRegis
-00032400: 7472 6174 696f 6e60 0a0a 0a20 2020 2045  tration`...    E
-00032410: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00032420: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00032430: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-00032440: 7065 7320 696d 706f 7274 2049 6e74 6567  pes import Integ
-00032450: 6572 5479 7065 2c20 5374 7275 6374 4669  erType, StructFi
-00032460: 656c 642c 2053 7472 7563 7454 7970 650a  eld, StructType.
-00032470: 2020 2020 2020 2020 3e3e 3e20 636c 6173          >>> clas
-00032480: 7320 5072 696d 6553 6965 7665 3a0a 2020  s PrimeSieve:.  
-00032490: 2020 2020 2020 2e2e 2e20 2020 2020 6465        ...     de
-000324a0: 6620 7072 6f63 6573 7328 7365 6c66 2c20  f process(self, 
-000324b0: 6e29 3a0a 2020 2020 2020 2020 2e2e 2e20  n):.        ... 
-000324c0: 2020 2020 2020 2020 6973 5f70 7269 6d65          is_prime
-000324d0: 203d 205b 5472 7565 5d20 2a20 286e 202b   = [True] * (n +
-000324e0: 2031 290a 2020 2020 2020 2020 2e2e 2e20   1).        ... 
-000324f0: 2020 2020 2020 2020 6973 5f70 7269 6d65          is_prime
-00032500: 5b30 5d20 3d20 4661 6c73 650a 2020 2020  [0] = False.    
-00032510: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00032520: 6973 5f70 7269 6d65 5b31 5d20 3d20 4661  is_prime[1] = Fa
-00032530: 6c73 650a 2020 2020 2020 2020 2e2e 2e20  lse.        ... 
-00032540: 2020 2020 2020 2020 7020 3d20 320a 2020          p = 2.  
-00032550: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00032560: 2020 7768 696c 6520 7020 2a20 7020 3c3d    while p * p <=
-00032570: 206e 3a0a 2020 2020 2020 2020 2e2e 2e20   n:.        ... 
-00032580: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00032590: 735f 7072 696d 655b 705d 3a0a 2020 2020  s_prime[p]:.    
-000325a0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-000325b0: 2020 2020 2020 2020 2320 7365 7420 616c          # set al
-000325c0: 6c20 6d75 6c74 6970 6c65 7320 6f66 2070  l multiples of p
-000325d0: 2074 6f20 4661 6c73 650a 2020 2020 2020   to False.      
-000325e0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-000325f0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00032600: 616e 6765 2870 202a 2070 2c20 6e20 2b20  ange(p * p, n + 
-00032610: 312c 2070 293a 0a20 2020 2020 2020 202e  1, p):.        .
-00032620: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-00032630: 2020 2020 2020 2069 735f 7072 696d 655b         is_prime[
-00032640: 695d 203d 2046 616c 7365 0a20 2020 2020  i] = False.     
-00032650: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00032660: 2020 2070 202b 3d20 310a 2020 2020 2020     p += 1.      
-00032670: 2020 2e2e 2e20 2020 2020 2020 2020 2320    ...         # 
-00032680: 7969 656c 6420 616c 6c20 7072 696d 6520  yield all prime 
-00032690: 6e75 6d62 6572 730a 2020 2020 2020 2020  numbers.        
-000326a0: 2e2e 2e20 2020 2020 2020 2020 666f 7220  ...         for 
-000326b0: 7020 696e 2072 616e 6765 2832 2c20 6e20  p in range(2, n 
-000326c0: 2b20 3129 3a0a 2020 2020 2020 2020 2e2e  + 1):.        ..
-000326d0: 2e20 2020 2020 2020 2020 2020 2020 6966  .             if
-000326e0: 2069 735f 7072 696d 655b 705d 3a0a 2020   is_prime[p]:.  
-000326f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00032700: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00032710: 2870 2c29 0a20 2020 2020 2020 203e 3e3e  (p,).        >>>
-00032720: 2070 7269 6d65 5f75 6474 6620 3d20 7564   prime_udtf = ud
-00032730: 7466 2850 7269 6d65 5369 6576 652c 206f  tf(PrimeSieve, o
-00032740: 7574 7075 745f 7363 6865 6d61 3d53 7472  utput_schema=Str
-00032750: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
-00032760: 6965 6c64 2822 6e75 6d62 6572 222c 2049  ield("number", I
-00032770: 6e74 6567 6572 5479 7065 2829 295d 292c  ntegerType())]),
-00032780: 2069 6e70 7574 5f74 7970 6573 3d5b 496e   input_types=[In
-00032790: 7465 6765 7254 7970 6528 295d 290a 2020  tegerType()]).  
-000327a0: 2020 2020 2020 3e3e 3e20 7365 7373 696f        >>> sessio
-000327b0: 6e2e 7461 626c 655f 6675 6e63 7469 6f6e  n.table_function
-000327c0: 2870 7269 6d65 5f75 6474 6628 6c69 7428  (prime_udtf(lit(
-000327d0: 3230 2929 292e 636f 6c6c 6563 7428 290a  20))).collect().
-000327e0: 2020 2020 2020 2020 5b52 6f77 284e 554d          [Row(NUM
-000327f0: 4245 523d 3229 2c20 526f 7728 4e55 4d42  BER=2), Row(NUMB
-00032800: 4552 3d33 292c 2052 6f77 284e 554d 4245  ER=3), Row(NUMBE
-00032810: 523d 3529 2c20 526f 7728 4e55 4d42 4552  R=5), Row(NUMBER
-00032820: 3d37 292c 2052 6f77 284e 554d 4245 523d  =7), Row(NUMBER=
-00032830: 3131 292c 2052 6f77 284e 554d 4245 523d  11), Row(NUMBER=
-00032840: 3133 292c 2052 6f77 284e 554d 4245 523d  13), Row(NUMBER=
-00032850: 3137 292c 2052 6f77 284e 554d 4245 523d  17), Row(NUMBER=
-00032860: 3139 295d 0a0a 2020 2020 2020 2020 496e  19)]..        In
-00032870: 7374 6561 6420 6f66 2063 616c 6c69 6e67  stead of calling
-00032880: 2060 7564 7466 6020 6974 2069 7320 616c   `udtf` it is al
-00032890: 736f 2070 6f73 7369 626c 6520 746f 2075  so possible to u
-000328a0: 7365 2075 6474 6620 6173 2061 2064 6563  se udtf as a dec
-000328b0: 6f72 6174 6f72 2e0a 0a20 2020 2045 7861  orator...    Exa
-000328c0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-000328d0: 3e3e 3e20 4075 6474 6628 6e61 6d65 3d22  >>> @udtf(name="
-000328e0: 616c 745f 696e 7422 2c72 6570 6c61 6365  alt_int",replace
-000328f0: 3d54 7275 652c 206f 7574 7075 745f 7363  =True, output_sc
-00032900: 6865 6d61 3d53 7472 7563 7454 7970 6528  hema=StructType(
-00032910: 5b53 7472 7563 7446 6965 6c64 2822 6e75  [StructField("nu
-00032920: 6d62 6572 222c 2049 6e74 6567 6572 5479  mber", IntegerTy
-00032930: 7065 2829 295d 292c 2069 6e70 7574 5f74  pe())]), input_t
-00032940: 7970 6573 3d5b 496e 7465 6765 7254 7970  ypes=[IntegerTyp
-00032950: 6528 295d 290a 2020 2020 2020 2020 2e2e  e()]).        ..
-00032960: 2e20 636c 6173 7320 416c 7465 726e 6174  . class Alternat
-00032970: 6f72 3a0a 2020 2020 2020 2020 2e2e 2e20  or:.        ... 
-00032980: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00032990: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000329a0: 2e2e 2e20 2020 2020 2020 2020 7365 6c66  ...         self
-000329b0: 2e5f 706f 7369 7469 7665 203d 2054 7275  ._positive = Tru
-000329c0: 650a 2020 2020 2020 2020 2e2e 2e0a 2020  e.        ....  
-000329d0: 2020 2020 2020 2e2e 2e20 2020 2020 6465        ...     de
-000329e0: 6620 7072 6f63 6573 7328 7365 6c66 2c20  f process(self, 
-000329f0: 6e29 3a0a 2020 2020 2020 2020 2e2e 2e20  n):.        ... 
-00032a00: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00032a10: 2072 616e 6765 286e 293a 0a20 2020 2020   range(n):.     
-00032a20: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00032a30: 2020 2069 6620 7365 6c66 2e5f 706f 7369     if self._posi
-00032a40: 7469 7665 3a0a 2020 2020 2020 2020 2e2e  tive:.        ..
-00032a50: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-00032a60: 2020 7969 656c 6420 2831 2c29 0a20 2020    yield (1,).   
-00032a70: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00032a80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00032a90: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00032aa0: 2020 2020 2020 2079 6965 6c64 2028 2d31         yield (-1
-00032ab0: 2c29 0a20 2020 2020 2020 202e 2e2e 2020  ,).        ...  
-00032ac0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00032ad0: 5f70 6f73 6974 6976 6520 3d20 6e6f 7420  _positive = not 
-00032ae0: 7365 6c66 2e5f 706f 7369 7469 7665 0a20  self._positive. 
-00032af0: 2020 2020 2020 203e 3e3e 2073 6573 7369         >>> sessi
-00032b00: 6f6e 2e74 6162 6c65 5f66 756e 6374 696f  on.table_functio
-00032b10: 6e28 2261 6c74 5f69 6e74 222c 206c 6974  n("alt_int", lit
-00032b20: 2833 2929 2e63 6f6c 6c65 6374 2829 0a20  (3)).collect(). 
-00032b30: 2020 2020 2020 205b 526f 7728 4e55 4d42         [Row(NUMB
-00032b40: 4552 3d31 292c 2052 6f77 284e 554d 4245  ER=1), Row(NUMBE
-00032b50: 523d 2d31 292c 2052 6f77 284e 554d 4245  R=-1), Row(NUMBE
-00032b60: 523d 3129 5d0a 2020 2020 2020 2020 3e3e  R=1)].        >>
-00032b70: 3e20 7365 7373 696f 6e2e 7461 626c 655f  > session.table_
-00032b80: 6675 6e63 7469 6f6e 2822 616c 745f 696e  function("alt_in
-00032b90: 7422 2c20 6c69 7428 3229 292e 636f 6c6c  t", lit(2)).coll
-00032ba0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00032bb0: 6f77 284e 554d 4245 523d 3129 2c20 526f  ow(NUMBER=1), Ro
-00032bc0: 7728 4e55 4d42 4552 3d2d 3129 5d0a 2020  w(NUMBER=-1)].  
-00032bd0: 2020 2020 2020 3e3e 3e20 7365 7373 696f        >>> sessio
-00032be0: 6e2e 7461 626c 655f 6675 6e63 7469 6f6e  n.table_function
-00032bf0: 2822 616c 745f 696e 7422 2c20 6c69 7428  ("alt_int", lit(
-00032c00: 3129 292e 636f 6c6c 6563 7428 290a 2020  1)).collect().  
-00032c10: 2020 2020 2020 5b52 6f77 284e 554d 4245        [Row(NUMBE
-00032c20: 523d 3129 5d0a 2020 2020 2222 220a 2020  R=1)].    """.  
-00032c30: 2020 7365 7373 696f 6e20 3d20 7365 7373    session = sess
-00032c40: 696f 6e20 6f72 2073 6e6f 7766 6c61 6b65  ion or snowflake
-00032c50: 2e73 6e6f 7770 6172 6b2e 7365 7373 696f  .snowpark.sessio
-00032c60: 6e2e 5f67 6574 5f61 6374 6976 655f 7365  n._get_active_se
-00032c70: 7373 696f 6e28 290a 2020 2020 6966 2068  ssion().    if h
-00032c80: 616e 646c 6572 2069 7320 4e6f 6e65 3a0a  andler is None:.
-00032c90: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-00032ca0: 756e 6374 6f6f 6c73 2e70 6172 7469 616c  unctools.partial
-00032cb0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00032cc0: 7373 696f 6e2e 7564 7466 2e72 6567 6973  ssion.udtf.regis
-00032cd0: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
-00032ce0: 206f 7574 7075 745f 7363 6865 6d61 3d6f   output_schema=o
-00032cf0: 7574 7075 745f 7363 6865 6d61 2c0a 2020  utput_schema,.  
-00032d00: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-00032d10: 7479 7065 733d 696e 7075 745f 7479 7065  types=input_type
-00032d20: 732c 0a20 2020 2020 2020 2020 2020 206e  s,.            n
-00032d30: 616d 653d 6e61 6d65 2c0a 2020 2020 2020  ame=name,.      
-00032d40: 2020 2020 2020 6973 5f70 6572 6d61 6e65        is_permane
-00032d50: 6e74 3d69 735f 7065 726d 616e 656e 742c  nt=is_permanent,
-00032d60: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-00032d70: 6765 5f6c 6f63 6174 696f 6e3d 7374 6167  ge_location=stag
-00032d80: 655f 6c6f 6361 7469 6f6e 2c0a 2020 2020  e_location,.    
-00032d90: 2020 2020 2020 2020 696d 706f 7274 733d          imports=
-00032da0: 696d 706f 7274 732c 0a20 2020 2020 2020  imports,.       
-00032db0: 2020 2020 2070 6163 6b61 6765 733d 7061       packages=pa
-00032dc0: 636b 6167 6573 2c0a 2020 2020 2020 2020  ckages,.        
-00032dd0: 2020 2020 7265 706c 6163 653d 7265 706c      replace=repl
-00032de0: 6163 652c 0a20 2020 2020 2020 2020 2020  ace,.           
-00032df0: 2069 665f 6e6f 745f 6578 6973 7473 3d69   if_not_exists=i
-00032e00: 665f 6e6f 745f 6578 6973 7473 2c0a 2020  f_not_exists,.  
-00032e10: 2020 2020 2020 2020 2020 7061 7261 6c6c            parall
-00032e20: 656c 3d70 6172 616c 6c65 6c2c 0a20 2020  el=parallel,.   
-00032e30: 2020 2020 2020 2020 2073 7461 7465 6d65           stateme
-00032e40: 6e74 5f70 6172 616d 733d 7374 6174 656d  nt_params=statem
-00032e50: 656e 745f 7061 7261 6d73 2c0a 2020 2020  ent_params,.    
-00032e60: 2020 2020 2020 2020 7374 7269 6374 3d73          strict=s
-00032e70: 7472 6963 742c 0a20 2020 2020 2020 2020  trict,.         
-00032e80: 2020 2073 6563 7572 653d 7365 6375 7265     secure=secure
-00032e90: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00032ea0: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
-00032eb0: 7475 726e 2073 6573 7369 6f6e 2e75 6474  turn session.udt
-00032ec0: 662e 7265 6769 7374 6572 280a 2020 2020  f.register(.    
-00032ed0: 2020 2020 2020 2020 6861 6e64 6c65 722c          handler,
-00032ee0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00032ef0: 7075 745f 7363 6865 6d61 3d6f 7574 7075  put_schema=outpu
-00032f00: 745f 7363 6865 6d61 2c0a 2020 2020 2020  t_schema,.      
-00032f10: 2020 2020 2020 696e 7075 745f 7479 7065        input_type
-00032f20: 733d 696e 7075 745f 7479 7065 732c 0a20  s=input_types,. 
-00032f30: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00032f40: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00032f50: 2020 6973 5f70 6572 6d61 6e65 6e74 3d69    is_permanent=i
-00032f60: 735f 7065 726d 616e 656e 742c 0a20 2020  s_permanent,.   
-00032f70: 2020 2020 2020 2020 2073 7461 6765 5f6c           stage_l
-00032f80: 6f63 6174 696f 6e3d 7374 6167 655f 6c6f  ocation=stage_lo
-00032f90: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
-00032fa0: 2020 2020 696d 706f 7274 733d 696d 706f      imports=impo
-00032fb0: 7274 732c 0a20 2020 2020 2020 2020 2020  rts,.           
-00032fc0: 2070 6163 6b61 6765 733d 7061 636b 6167   packages=packag
-00032fd0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00032fe0: 7265 706c 6163 653d 7265 706c 6163 652c  replace=replace,
-00032ff0: 0a20 2020 2020 2020 2020 2020 2069 665f  .            if_
-00033000: 6e6f 745f 6578 6973 7473 3d69 665f 6e6f  not_exists=if_no
-00033010: 745f 6578 6973 7473 2c0a 2020 2020 2020  t_exists,.      
-00033020: 2020 2020 2020 7061 7261 6c6c 656c 3d70        parallel=p
-00033030: 6172 616c 6c65 6c2c 0a20 2020 2020 2020  arallel,.       
-00033040: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
-00033050: 6172 616d 733d 7374 6174 656d 656e 745f  arams=statement_
-00033060: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00033070: 2020 2020 7374 7269 6374 3d73 7472 6963      strict=stric
-00033080: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
-00033090: 6563 7572 653d 7365 6375 7265 2c0a 2020  ecure=secure,.  
-000330a0: 2020 2020 2020 290a 0a0a 6465 6620 7061        )...def pa
-000330b0: 6e64 6173 5f75 6466 280a 2020 2020 6675  ndas_udf(.    fu
-000330c0: 6e63 3a20 4f70 7469 6f6e 616c 5b43 616c  nc: Optional[Cal
-000330d0: 6c61 626c 655d 203d 204e 6f6e 652c 0a20  lable] = None,. 
-000330e0: 2020 202a 2c0a 2020 2020 7265 7475 726e     *,.    return
-000330f0: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
-00033100: 4461 7461 5479 7065 5d20 3d20 4e6f 6e65  DataType] = None
-00033110: 2c0a 2020 2020 696e 7075 745f 7479 7065  ,.    input_type
-00033120: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-00033130: 5b44 6174 6154 7970 655d 5d20 3d20 4e6f  [DataType]] = No
-00033140: 6e65 2c0a 2020 2020 6e61 6d65 3a20 4f70  ne,.    name: Op
-00033150: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
-00033160: 2c20 4974 6572 6162 6c65 5b73 7472 5d5d  , Iterable[str]]
-00033170: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6973  ] = None,.    is
-00033180: 5f70 6572 6d61 6e65 6e74 3a20 626f 6f6c  _permanent: bool
-00033190: 203d 2046 616c 7365 2c0a 2020 2020 7374   = False,.    st
-000331a0: 6167 655f 6c6f 6361 7469 6f6e 3a20 4f70  age_location: Op
-000331b0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-000331c0: 6e65 2c0a 2020 2020 696d 706f 7274 733a  ne,.    imports:
-000331d0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b55   Optional[List[U
-000331e0: 6e69 6f6e 5b73 7472 2c20 5475 706c 655b  nion[str, Tuple[
-000331f0: 7374 722c 2073 7472 5d5d 5d5d 203d 204e  str, str]]]] = N
-00033200: 6f6e 652c 0a20 2020 2070 6163 6b61 6765  one,.    package
-00033210: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-00033220: 5b55 6e69 6f6e 5b73 7472 2c20 4d6f 6475  [Union[str, Modu
-00033230: 6c65 5479 7065 5d5d 5d20 3d20 4e6f 6e65  leType]]] = None
-00033240: 2c0a 2020 2020 7265 706c 6163 653a 2062  ,.    replace: b
-00033250: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00033260: 2069 665f 6e6f 745f 6578 6973 7473 3a20   if_not_exists: 
-00033270: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-00033280: 2020 7365 7373 696f 6e3a 204f 7074 696f    session: Optio
-00033290: 6e61 6c5b 2273 6e6f 7766 6c61 6b65 2e73  nal["snowflake.s
-000332a0: 6e6f 7770 6172 6b2e 7365 7373 696f 6e2e  nowpark.session.
-000332b0: 5365 7373 696f 6e22 5d20 3d20 4e6f 6e65  Session"] = None
-000332c0: 2c0a 2020 2020 7061 7261 6c6c 656c 3a20  ,.    parallel: 
-000332d0: 696e 7420 3d20 342c 0a20 2020 206d 6178  int = 4,.    max
-000332e0: 5f62 6174 6368 5f73 697a 653a 204f 7074  _batch_size: Opt
-000332f0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
-00033300: 652c 0a20 2020 2073 7461 7465 6d65 6e74  e,.    statement
-00033310: 5f70 6172 616d 733a 204f 7074 696f 6e61  _params: Optiona
-00033320: 6c5b 4469 6374 5b73 7472 2c20 7374 725d  l[Dict[str, str]
-00033330: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 736f  ] = None,.    so
-00033340: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-00033350: 793a 2062 6f6f 6c20 3d20 5472 7565 2c0a  y: bool = True,.
-00033360: 2920 2d3e 2055 6e69 6f6e 5b55 7365 7244  ) -> Union[UserD
-00033370: 6566 696e 6564 4675 6e63 7469 6f6e 2c20  efinedFunction, 
-00033380: 6675 6e63 746f 6f6c 732e 7061 7274 6961  functools.partia
-00033390: 6c5d 3a0a 2020 2020 2222 220a 2020 2020  l]:.    """.    
-000333a0: 5265 6769 7374 6572 7320 6120 5079 7468  Registers a Pyth
-000333b0: 6f6e 2066 756e 6374 696f 6e20 6173 2061  on function as a
-000333c0: 2076 6563 746f 7269 7a65 6420 5544 4620   vectorized UDF 
-000333d0: 616e 6420 7265 7475 726e 7320 7468 6520  and returns the 
-000333e0: 5544 462e 0a20 2020 2054 6865 2061 7267  UDF..    The arg
-000333f0: 756d 656e 7473 2c20 7265 7475 726e 2076  uments, return v
-00033400: 616c 7565 2061 6e64 2075 7361 6765 206f  alue and usage o
-00033410: 6620 7468 6973 2066 756e 6374 696f 6e20  f this function 
-00033420: 6172 6520 6578 6163 746c 7920 7468 6520  are exactly the 
-00033430: 7361 6d65 2061 730a 2020 2020 3a66 756e  same as.    :fun
-00033440: 633a 6075 6466 602c 2062 7574 2074 6869  c:`udf`, but thi
-00033450: 7320 6675 6e63 7469 6f6e 2063 616e 206f  s function can o
-00033460: 6e6c 7920 6265 2075 7365 6420 666f 7220  nly be used for 
-00033470: 7265 6769 7374 6572 696e 6720 7665 6374  registering vect
-00033480: 6f72 697a 6564 2055 4446 732e 0a20 2020  orized UDFs..   
-00033490: 2053 6565 2065 7861 6d70 6c65 7320 696e   See examples in
-000334a0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
-000334b0: 616b 652e 736e 6f77 7061 726b 2e75 6466  ake.snowpark.udf
-000334c0: 2e55 4446 5265 6769 7374 7261 7469 6f6e  .UDFRegistration
-000334d0: 602e 0a0a 2020 2020 5365 6520 416c 736f  `...    See Also
-000334e0: 3a0a 2020 2020 2020 2020 2d20 3a66 756e  :.        - :fun
-000334f0: 633a 6075 6466 600a 2020 2020 2020 2020  c:`udf`.        
-00033500: 2d20 3a6d 6574 683a 6055 4446 5265 6769  - :meth:`UDFRegi
-00033510: 7374 7261 7469 6f6e 2e72 6567 6973 7465  stration.registe
-00033520: 7228 2920 3c73 6e6f 7766 6c61 6b65 2e73  r() <snowflake.s
-00033530: 6e6f 7770 6172 6b2e 7564 662e 5544 4652  nowpark.udf.UDFR
-00033540: 6567 6973 7472 6174 696f 6e2e 7265 6769  egistration.regi
-00033550: 7374 6572 3e60 0a0a 2020 2020 4578 616d  ster>`..    Exam
-00033560: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00033570: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00033580: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00033590: 2069 6d70 6f72 7420 5061 6e64 6173 5365   import PandasSe
-000335a0: 7269 6573 5479 7065 2c20 5061 6e64 6173  riesType, Pandas
-000335b0: 4461 7461 4672 616d 6554 7970 652c 2049  DataFrameType, I
-000335c0: 6e74 6567 6572 5479 7065 0a20 2020 2020  ntegerType.     
-000335d0: 2020 203e 3e3e 2061 6464 5f6f 6e65 5f64     >>> add_one_d
-000335e0: 665f 7061 6e64 6173 5f75 6466 203d 2070  f_pandas_udf = p
-000335f0: 616e 6461 735f 7564 6628 0a20 2020 2020  andas_udf(.     
-00033600: 2020 202e 2e2e 2020 2020 206c 616d 6264     ...     lambd
-00033610: 6120 6466 3a20 6466 5b30 5d20 2b20 6466  a df: df[0] + df
-00033620: 5b31 5d20 2b20 312c 0a20 2020 2020 2020  [1] + 1,.       
-00033630: 202e 2e2e 2020 2020 2072 6574 7572 6e5f   ...     return_
-00033640: 7479 7065 3d50 616e 6461 7353 6572 6965  type=PandasSerie
-00033650: 7354 7970 6528 496e 7465 6765 7254 7970  sType(IntegerTyp
-00033660: 6528 2929 2c0a 2020 2020 2020 2020 2e2e  e()),.        ..
-00033670: 2e20 2020 2020 696e 7075 745f 7479 7065  .     input_type
-00033680: 733d 5b50 616e 6461 7344 6174 6146 7261  s=[PandasDataFra
-00033690: 6d65 5479 7065 285b 496e 7465 6765 7254  meType([IntegerT
-000336a0: 7970 6528 292c 2049 6e74 6567 6572 5479  ype(), IntegerTy
-000336b0: 7065 2829 5d29 5d0a 2020 2020 2020 2020  pe()])].        
-000336c0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-000336d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000336e0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000336f0: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
-00033700: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-00033710: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
-00033720: 2064 662e 7365 6c65 6374 2861 6464 5f6f   df.select(add_o
-00033730: 6e65 5f64 665f 7061 6e64 6173 5f75 6466  ne_df_pandas_udf
-00033740: 2822 6122 2c20 2262 2229 2e61 6c69 6173  ("a", "b").alias
-00033750: 2822 7265 7375 6c74 2229 292e 6f72 6465  ("result")).orde
-00033760: 725f 6279 2822 7265 7375 6c74 2229 2e73  r_by("result").s
-00033770: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00033780: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00033790: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-000337a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000337b0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3420  ----.        |4 
-000337c0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000337d0: 2020 7c38 2020 2020 2020 2020 207c 0a20    |8         |. 
-000337e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000337f0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00033800: 4e4b 4c49 4e45 3e0a 0a20 2020 206f 7220  NKLINE>..    or 
-00033810: 6173 206e 616d 6564 2050 616e 6461 7320  as named Pandas 
-00033820: 5544 4673 2074 6861 7420 6172 6520 6163  UDFs that are ac
-00033830: 6365 7369 626c 6520 696e 2074 6865 2073  cesible in the s
-00033840: 616d 6520 7365 7373 696f 6e2e 2049 6e73  ame session. Ins
-00033850: 7465 6164 206f 6620 6361 6c6c 696e 6720  tead of calling 
-00033860: 6070 616e 6461 735f 7564 6660 2061 7320  `pandas_udf` as 
-00033870: 6675 6e63 7469 6f6e 2c0a 2020 2020 6974  function,.    it
-00033880: 2063 616e 2062 6520 616c 736f 2075 7365   can be also use
-00033890: 6420 6173 2061 2064 6563 6f72 6174 6f72  d as a decorator
-000338a0: 3a0a 0a20 2020 2045 7861 6d70 6c65 3a3a  :..    Example::
-000338b0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-000338c0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-000338d0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-000338e0: 7274 2050 616e 6461 7353 6572 6965 7354  rt PandasSeriesT
-000338f0: 7970 652c 2050 616e 6461 7344 6174 6146  ype, PandasDataF
-00033900: 7261 6d65 5479 7065 2c20 496e 7465 6765  rameType, Intege
-00033910: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
-00033920: 3e20 4070 616e 6461 735f 7564 6628 0a20  > @pandas_udf(. 
-00033930: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
-00033940: 6574 7572 6e5f 7479 7065 3d50 616e 6461  eturn_type=Panda
-00033950: 7353 6572 6965 7354 7970 6528 496e 7465  sSeriesType(Inte
-00033960: 6765 7254 7970 6528 2929 2c0a 2020 2020  gerType()),.    
-00033970: 2020 2020 2e2e 2e20 2020 2020 696e 7075      ...     inpu
-00033980: 745f 7479 7065 733d 5b50 616e 6461 7344  t_types=[PandasD
-00033990: 6174 6146 7261 6d65 5479 7065 285b 496e  ataFrameType([In
-000339a0: 7465 6765 7254 7970 6528 292c 2049 6e74  tegerType(), Int
-000339b0: 6567 6572 5479 7065 2829 5d29 5d2c 0a20  egerType()])],. 
-000339c0: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-000339d0: 2020 2020 202e 2e2e 2064 6566 2061 6464       ... def add
-000339e0: 5f6f 6e65 5f64 665f 7061 6e64 6173 5f75  _one_df_pandas_u
-000339f0: 6466 2864 6629 3a0a 2020 2020 2020 2020  df(df):.        
-00033a00: 2e2e 2e20 2020 2020 7265 7475 726e 2064  ...     return d
-00033a10: 665b 305d 202b 2064 665b 315d 202b 2031  f[0] + df[1] + 1
-00033a20: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00033a30: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00033a40: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
-00033a50: 325d 2c20 5b33 2c20 345d 5d2c 2073 6368  2], [3, 4]], sch
-00033a60: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-00033a70: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00033a80: 656c 6563 7428 6164 645f 6f6e 655f 6466  elect(add_one_df
-00033a90: 5f70 616e 6461 735f 7564 6628 2261 222c  _pandas_udf("a",
-00033aa0: 2022 6222 292e 616c 6961 7328 2272 6573   "b").alias("res
-00033ab0: 756c 7422 2929 2e6f 7264 6572 5f62 7928  ult")).order_by(
-00033ac0: 2272 6573 756c 7422 292e 7368 6f77 2829  "result").show()
-00033ad0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00033ae0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00033af0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-00033b00: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00033b10: 2020 2020 2020 2020 7c34 2020 2020 2020          |4      
-00033b20: 2020 207c 0a20 2020 2020 2020 207c 3820     |.        |8 
-00033b30: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00033b40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00033b50: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-00033b60: 453e 0a20 2020 2022 2222 0a20 2020 2073  E>.    """.    s
-00033b70: 6573 7369 6f6e 203d 2073 6573 7369 6f6e  ession = session
-00033b80: 206f 7220 736e 6f77 666c 616b 652e 736e   or snowflake.sn
-00033b90: 6f77 7061 726b 2e73 6573 7369 6f6e 2e5f  owpark.session._
-00033ba0: 6765 745f 6163 7469 7665 5f73 6573 7369  get_active_sessi
-00033bb0: 6f6e 2829 0a20 2020 2069 6620 6675 6e63  on().    if func
-00033bc0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00033bd0: 2020 7265 7475 726e 2066 756e 6374 6f6f    return functoo
-00033be0: 6c73 2e70 6172 7469 616c 280a 2020 2020  ls.partial(.    
-00033bf0: 2020 2020 2020 2020 7365 7373 696f 6e2e          session.
-00033c00: 7564 662e 7265 6769 7374 6572 2c0a 2020  udf.register,.  
-00033c10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00033c20: 5f74 7970 653d 7265 7475 726e 5f74 7970  _type=return_typ
-00033c30: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-00033c40: 6e70 7574 5f74 7970 6573 3d69 6e70 7574  nput_types=input
-00033c50: 5f74 7970 6573 2c0a 2020 2020 2020 2020  _types,.        
-00033c60: 2020 2020 6e61 6d65 3d6e 616d 652c 0a20      name=name,. 
-00033c70: 2020 2020 2020 2020 2020 2069 735f 7065             is_pe
-00033c80: 726d 616e 656e 743d 6973 5f70 6572 6d61  rmanent=is_perma
-00033c90: 6e65 6e74 2c0a 2020 2020 2020 2020 2020  nent,.          
-00033ca0: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
-00033cb0: 3d73 7461 6765 5f6c 6f63 6174 696f 6e2c  =stage_location,
-00033cc0: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-00033cd0: 6f72 7473 3d69 6d70 6f72 7473 2c0a 2020  orts=imports,.  
-00033ce0: 2020 2020 2020 2020 2020 7061 636b 6167            packag
-00033cf0: 6573 3d70 6163 6b61 6765 732c 0a20 2020  es=packages,.   
-00033d00: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
-00033d10: 3d72 6570 6c61 6365 2c0a 2020 2020 2020  =replace,.      
-00033d20: 2020 2020 2020 6966 5f6e 6f74 5f65 7869        if_not_exi
-00033d30: 7374 733d 6966 5f6e 6f74 5f65 7869 7374  sts=if_not_exist
-00033d40: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
-00033d50: 6172 616c 6c65 6c3d 7061 7261 6c6c 656c  arallel=parallel
-00033d60: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-00033d70: 785f 6261 7463 685f 7369 7a65 3d6d 6178  x_batch_size=max
-00033d80: 5f62 6174 6368 5f73 697a 652c 0a20 2020  _batch_size,.   
-00033d90: 2020 2020 2020 2020 205f 6672 6f6d 5f70           _from_p
-00033da0: 616e 6461 735f 7564 665f 6675 6e63 7469  andas_udf_functi
-00033db0: 6f6e 3d54 7275 652c 0a20 2020 2020 2020  on=True,.       
-00033dc0: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
-00033dd0: 6172 616d 733d 7374 6174 656d 656e 745f  arams=statement_
-00033de0: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00033df0: 2020 2020 736f 7572 6365 5f63 6f64 655f      source_code_
-00033e00: 6469 7370 6c61 793d 736f 7572 6365 5f63  display=source_c
-00033e10: 6f64 655f 6469 7370 6c61 792c 0a20 2020  ode_display,.   
-00033e20: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
-00033e30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00033e40: 7365 7373 696f 6e2e 7564 662e 7265 6769  session.udf.regi
-00033e50: 7374 6572 280a 2020 2020 2020 2020 2020  ster(.          
-00033e60: 2020 6675 6e63 2c0a 2020 2020 2020 2020    func,.        
-00033e70: 2020 2020 7265 7475 726e 5f74 7970 653d      return_type=
-00033e80: 7265 7475 726e 5f74 7970 652c 0a20 2020  return_type,.   
-00033e90: 2020 2020 2020 2020 2069 6e70 7574 5f74           input_t
-00033ea0: 7970 6573 3d69 6e70 7574 5f74 7970 6573  ypes=input_types
-00033eb0: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
-00033ec0: 6d65 3d6e 616d 652c 0a20 2020 2020 2020  me=name,.       
-00033ed0: 2020 2020 2069 735f 7065 726d 616e 656e       is_permanen
-00033ee0: 743d 6973 5f70 6572 6d61 6e65 6e74 2c0a  t=is_permanent,.
-00033ef0: 2020 2020 2020 2020 2020 2020 7374 6167              stag
-00033f00: 655f 6c6f 6361 7469 6f6e 3d73 7461 6765  e_location=stage
-00033f10: 5f6c 6f63 6174 696f 6e2c 0a20 2020 2020  _location,.     
-00033f20: 2020 2020 2020 2069 6d70 6f72 7473 3d69         imports=i
-00033f30: 6d70 6f72 7473 2c0a 2020 2020 2020 2020  mports,.        
-00033f40: 2020 2020 7061 636b 6167 6573 3d70 6163      packages=pac
-00033f50: 6b61 6765 732c 0a20 2020 2020 2020 2020  kages,.         
-00033f60: 2020 2072 6570 6c61 6365 3d72 6570 6c61     replace=repla
-00033f70: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-00033f80: 6966 5f6e 6f74 5f65 7869 7374 733d 6966  if_not_exists=if
-00033f90: 5f6e 6f74 5f65 7869 7374 732c 0a20 2020  _not_exists,.   
-00033fa0: 2020 2020 2020 2020 2070 6172 616c 6c65           paralle
-00033fb0: 6c3d 7061 7261 6c6c 656c 2c0a 2020 2020  l=parallel,.    
-00033fc0: 2020 2020 2020 2020 6d61 785f 6261 7463          max_batc
-00033fd0: 685f 7369 7a65 3d6d 6178 5f62 6174 6368  h_size=max_batch
-00033fe0: 5f73 697a 652c 0a20 2020 2020 2020 2020  _size,.         
-00033ff0: 2020 205f 6672 6f6d 5f70 616e 6461 735f     _from_pandas_
-00034000: 7564 665f 6675 6e63 7469 6f6e 3d54 7275  udf_function=Tru
-00034010: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
-00034020: 7461 7465 6d65 6e74 5f70 6172 616d 733d  tatement_params=
-00034030: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
-00034040: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-00034050: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-00034060: 793d 736f 7572 6365 5f63 6f64 655f 6469  y=source_code_di
-00034070: 7370 6c61 792c 0a20 2020 2020 2020 2029  splay,.        )
-00034080: 0a0a 0a64 6566 2063 616c 6c5f 7564 6628  ...def call_udf(
-00034090: 0a20 2020 2075 6466 5f6e 616d 653a 2073  .    udf_name: s
-000340a0: 7472 2c0a 2020 2020 2a61 7267 733a 2043  tr,.    *args: C
-000340b0: 6f6c 756d 6e4f 724c 6974 6572 616c 2c0a  olumnOrLiteral,.
-000340c0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000340d0: 2022 2222 4361 6c6c 7320 6120 7573 6572   """Calls a user
-000340e0: 2d64 6566 696e 6564 2066 756e 6374 696f  -defined functio
-000340f0: 6e20 2855 4446 2920 6279 206e 616d 652e  n (UDF) by name.
-00034100: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-00034110: 2020 2020 7564 665f 6e61 6d65 3a20 5468      udf_name: Th
-00034120: 6520 6e61 6d65 206f 6620 5544 4620 696e  e name of UDF in
-00034130: 2053 6e6f 7766 6c61 6b65 2e0a 2020 2020   Snowflake..    
-00034140: 2020 2020 6172 6773 3a20 4172 6775 6d65      args: Argume
-00034150: 6e74 7320 6361 6e20 6265 2069 6e20 7477  nts can be in tw
-00034160: 6f20 7479 7065 733a 0a0a 2020 2020 2020  o types:..      
-00034170: 2020 2020 2020 2d20 3a63 6c61 7373 3a60        - :class:`
-00034180: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00034190: 6172 6b2e 436f 6c75 6d6e 602c 206f 720a  ark.Column`, or.
-000341a0: 2020 2020 2020 2020 2020 2020 2d20 4261              - Ba
-000341b0: 7369 6320 5079 7468 6f6e 2074 7970 6573  sic Python types
-000341c0: 2c20 7768 6963 6820 6172 6520 636f 6e76  , which are conv
-000341d0: 6572 7465 6420 746f 2053 6e6f 7770 6172  erted to Snowpar
-000341e0: 6b20 6c69 7465 7261 6c73 2e0a 0a20 2020  k literals...   
-000341f0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-00034200: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00034210: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-00034220: 7970 6573 2069 6d70 6f72 7420 496e 7465  ypes import Inte
-00034230: 6765 7254 7970 650a 2020 2020 2020 2020  gerType.        
-00034240: 3e3e 3e20 7564 665f 6465 6620 3d20 7365  >>> udf_def = se
-00034250: 7373 696f 6e2e 7564 662e 7265 6769 7374  ssion.udf.regist
-00034260: 6572 286c 616d 6264 6120 782c 2079 3a20  er(lambda x, y: 
-00034270: 7820 2b20 792c 206e 616d 653d 2261 6464  x + y, name="add
-00034280: 5f63 6f6c 756d 6e73 222c 2069 6e70 7574  _columns", input
-00034290: 5f74 7970 6573 3d5b 496e 7465 6765 7254  _types=[IntegerT
-000342a0: 7970 6528 292c 2049 6e74 6567 6572 5479  ype(), IntegerTy
-000342b0: 7065 2829 5d2c 2072 6574 7572 6e5f 7479  pe()], return_ty
-000342c0: 7065 3d49 6e74 6567 6572 5479 7065 2829  pe=IntegerType()
-000342d0: 2c20 7265 706c 6163 653d 5472 7565 290a  , replace=True).
-000342e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-000342f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00034300: 6461 7461 6672 616d 6528 5b5b 312c 2032  dataframe([[1, 2
-00034310: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
-00034320: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
-00034330: 3e3e 2064 662e 7365 6c65 6374 2863 616c  >> df.select(cal
-00034340: 6c5f 7564 6628 2261 6464 5f63 6f6c 756d  l_udf("add_colum
-00034350: 6e73 222c 2063 6f6c 2822 6122 292c 2063  ns", col("a"), c
-00034360: 6f6c 2822 6222 2929 292e 7368 6f77 2829  ol("b"))).show()
-00034370: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00034380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00034390: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000343a0: 207c 2241 4444 5f43 4f4c 554d 4e53 2822   |"ADD_COLUMNS("
-000343b0: 2241 2222 2c20 2222 4222 2229 2220 207c  "A"", ""B"")"  |
-000343c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000343d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000343e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000343f0: 207c 3320 2020 2020 2020 2020 2020 2020   |3             
-00034400: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00034410: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00034420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00034430: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00034440: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00034450: 2022 2222 0a0a 2020 2020 7661 6c69 6461   """..    valida
-00034460: 7465 5f6f 626a 6563 745f 6e61 6d65 2875  te_object_name(u
-00034470: 6466 5f6e 616d 6529 0a20 2020 2072 6574  df_name).    ret
-00034480: 7572 6e20 5f63 616c 6c5f 6675 6e63 7469  urn _call_functi
-00034490: 6f6e 2875 6466 5f6e 616d 652c 2046 616c  on(udf_name, Fal
-000344a0: 7365 2c20 2a61 7267 732c 2061 7069 5f63  se, *args, api_c
-000344b0: 616c 6c5f 736f 7572 6365 3d22 6675 6e63  all_source="func
-000344c0: 7469 6f6e 732e 6361 6c6c 5f75 6466 2229  tions.call_udf")
-000344d0: 0a0a 0a64 6566 2063 616c 6c5f 7461 626c  ...def call_tabl
-000344e0: 655f 6675 6e63 7469 6f6e 280a 2020 2020  e_function(.    
-000344f0: 6675 6e63 7469 6f6e 5f6e 616d 653a 2073  function_name: s
-00034500: 7472 2c20 2a61 7267 733a 2043 6f6c 756d  tr, *args: Colum
-00034510: 6e4f 724c 6974 6572 616c 2c20 2a2a 6b77  nOrLiteral, **kw
-00034520: 6172 6773 3a20 436f 6c75 6d6e 4f72 4c69  args: ColumnOrLi
-00034530: 7465 7261 6c0a 2920 2d3e 2022 736e 6f77  teral.) -> "snow
-00034540: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-00034550: 6162 6c65 5f66 756e 6374 696f 6e2e 5461  able_function.Ta
-00034560: 626c 6546 756e 6374 696f 6e43 616c 6c22  bleFunctionCall"
-00034570: 3a0a 2020 2020 2222 2249 6e76 6f6b 6573  :.    """Invokes
-00034580: 2061 2053 6e6f 7766 6c61 6b65 2074 6162   a Snowflake tab
-00034590: 6c65 2066 756e 6374 696f 6e2c 2069 6e63  le function, inc
-000345a0: 6c75 6469 6e67 2073 7973 7465 6d2d 6465  luding system-de
-000345b0: 6669 6e65 6420 7461 626c 6520 6675 6e63  fined table func
-000345c0: 7469 6f6e 7320 616e 6420 7573 6572 2d64  tions and user-d
-000345d0: 6566 696e 6564 2074 6162 6c65 2066 756e  efined table fun
-000345e0: 6374 696f 6e73 2e0a 0a20 2020 2049 7420  ctions...    It 
-000345f0: 7265 7475 726e 7320 6120 3a6d 6574 683a  returns a :meth:
-00034600: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-00034610: 7061 726b 2e74 6162 6c65 5f66 756e 6374  park.table_funct
-00034620: 696f 6e2e 5461 626c 6546 756e 6374 696f  ion.TableFunctio
-00034630: 6e43 616c 6c60 2073 6f20 796f 7520 6361  nCall` so you ca
-00034640: 6e20 7370 6563 6966 7920 7468 6520 7061  n specify the pa
-00034650: 7274 6974 696f 6e20 636c 6175 7365 2e0a  rtition clause..
-00034660: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00034670: 2020 2066 756e 6374 696f 6e5f 6e61 6d65     function_name
-00034680: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-00034690: 6520 7461 626c 6520 6675 6e63 7469 6f6e  e table function
-000346a0: 2e0a 2020 2020 2020 2020 6172 6773 3a20  ..        args: 
-000346b0: 5468 6520 706f 7369 7469 6f6e 616c 2061  The positional a
-000346c0: 7267 756d 656e 7473 206f 6620 7468 6520  rguments of the 
-000346d0: 7461 626c 6520 6675 6e63 7469 6f6e 2e0a  table function..
-000346e0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-000346f0: 3a20 5468 6520 6e61 6d65 6420 6172 6775  : The named argu
-00034700: 6d65 6e74 7320 6f66 2074 6865 2074 6162  ments of the tab
-00034710: 6c65 2066 756e 6374 696f 6e2e 2053 6f6d  le function. Som
-00034720: 6520 7461 626c 6520 6675 6e63 7469 6f6e  e table function
-00034730: 7320 2865 2e67 2e2c 2060 6066 6c61 7474  s (e.g., ``flatt
-00034740: 656e 6060 2920 6861 7665 206e 616d 6564  en``) have named
-00034750: 2061 7267 756d 656e 7473 2069 6e73 7465   arguments inste
-00034760: 6164 206f 6620 706f 7369 7469 6f6e 616c  ad of positional
-00034770: 206f 6e65 732e 0a0a 2020 2020 4578 616d   ones...    Exam
-00034780: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00034790: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-000347a0: 2e73 6e6f 7770 6172 6b2e 6675 6e63 7469  .snowpark.functi
-000347b0: 6f6e 7320 696d 706f 7274 206c 6974 0a20  ons import lit. 
-000347c0: 2020 2020 2020 203e 3e3e 2073 6573 7369         >>> sessi
-000347d0: 6f6e 2e74 6162 6c65 5f66 756e 6374 696f  on.table_functio
-000347e0: 6e28 6361 6c6c 5f74 6162 6c65 5f66 756e  n(call_table_fun
-000347f0: 6374 696f 6e28 2273 706c 6974 5f74 6f5f  ction("split_to_
-00034800: 7461 626c 6522 2c20 6c69 7428 2273 706c  table", lit("spl
-00034810: 6974 2077 6f72 6473 2074 6f20 7461 626c  it words to tabl
-00034820: 6522 292c 206c 6974 2822 2022 2929 2e6f  e"), lit(" ")).o
-00034830: 7665 7228 2929 2e63 6f6c 6c65 6374 2829  ver()).collect()
-00034840: 0a20 2020 2020 2020 205b 526f 7728 5345  .        [Row(SE
-00034850: 513d 312c 2049 4e44 4558 3d31 2c20 5641  Q=1, INDEX=1, VA
-00034860: 4c55 453d 2773 706c 6974 2729 2c20 526f  LUE='split'), Ro
-00034870: 7728 5345 513d 312c 2049 4e44 4558 3d32  w(SEQ=1, INDEX=2
-00034880: 2c20 5641 4c55 453d 2777 6f72 6473 2729  , VALUE='words')
-00034890: 2c20 526f 7728 5345 513d 312c 2049 4e44  , Row(SEQ=1, IND
-000348a0: 4558 3d33 2c20 5641 4c55 453d 2774 6f27  EX=3, VALUE='to'
-000348b0: 292c 2052 6f77 2853 4551 3d31 2c20 494e  ), Row(SEQ=1, IN
-000348c0: 4445 583d 342c 2056 414c 5545 3d27 7461  DEX=4, VALUE='ta
-000348d0: 626c 6527 295d 0a20 2020 2022 2222 0a20  ble')].    """. 
-000348e0: 2020 2072 6574 7572 6e20 736e 6f77 666c     return snowfl
-000348f0: 616b 652e 736e 6f77 7061 726b 2e74 6162  ake.snowpark.tab
-00034900: 6c65 5f66 756e 6374 696f 6e2e 5461 626c  le_function.Tabl
-00034910: 6546 756e 6374 696f 6e43 616c 6c28 0a20  eFunctionCall(. 
-00034920: 2020 2020 2020 2066 756e 6374 696f 6e5f         function_
-00034930: 6e61 6d65 2c20 2a61 7267 732c 202a 2a6b  name, *args, **k
-00034940: 7761 7267 730a 2020 2020 290a 0a0a 6465  wargs.    )...de
-00034950: 6620 7461 626c 655f 6675 6e63 7469 6f6e  f table_function
-00034960: 2866 756e 6374 696f 6e5f 6e61 6d65 3a20  (function_name: 
-00034970: 7374 7229 202d 3e20 4361 6c6c 6162 6c65  str) -> Callable
-00034980: 3a0a 2020 2020 2222 2243 7265 6174 6520  :.    """Create 
-00034990: 6120 6675 6e63 7469 6f6e 206f 626a 6563  a function objec
-000349a0: 7420 746f 2069 6e76 6f6b 6520 6120 536e  t to invoke a Sn
-000349b0: 6f77 666c 616b 6520 7461 626c 6520 6675  owflake table fu
-000349c0: 6e63 7469 6f6e 2e0a 0a20 2020 2041 7267  nction...    Arg
-000349d0: 733a 0a20 2020 2020 2020 2066 756e 6374  s:.        funct
-000349e0: 696f 6e5f 6e61 6d65 3a20 5468 6520 6e61  ion_name: The na
-000349f0: 6d65 206f 6620 7468 6520 7461 626c 6520  me of the table 
-00034a00: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2045  function...    E
-00034a10: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00034a20: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-00034a30: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-00034a40: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
-00034a50: 740a 2020 2020 2020 2020 3e3e 3e20 7370  t.        >>> sp
-00034a60: 6c69 745f 746f 5f74 6162 6c65 203d 2074  lit_to_table = t
-00034a70: 6162 6c65 5f66 756e 6374 696f 6e28 2273  able_function("s
-00034a80: 706c 6974 5f74 6f5f 7461 626c 6522 290a  plit_to_table").
-00034a90: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
-00034aa0: 696f 6e2e 7461 626c 655f 6675 6e63 7469  ion.table_functi
-00034ab0: 6f6e 2873 706c 6974 5f74 6f5f 7461 626c  on(split_to_tabl
-00034ac0: 6528 6c69 7428 2273 706c 6974 2077 6f72  e(lit("split wor
-00034ad0: 6473 2074 6f20 7461 626c 6522 292c 206c  ds to table"), l
-00034ae0: 6974 2822 2022 2929 2e6f 7665 7228 2929  it(" ")).over())
-00034af0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00034b00: 2020 205b 526f 7728 5345 513d 312c 2049     [Row(SEQ=1, I
-00034b10: 4e44 4558 3d31 2c20 5641 4c55 453d 2773  NDEX=1, VALUE='s
-00034b20: 706c 6974 2729 2c20 526f 7728 5345 513d  plit'), Row(SEQ=
-00034b30: 312c 2049 4e44 4558 3d32 2c20 5641 4c55  1, INDEX=2, VALU
-00034b40: 453d 2777 6f72 6473 2729 2c20 526f 7728  E='words'), Row(
-00034b50: 5345 513d 312c 2049 4e44 4558 3d33 2c20  SEQ=1, INDEX=3, 
-00034b60: 5641 4c55 453d 2774 6f27 292c 2052 6f77  VALUE='to'), Row
-00034b70: 2853 4551 3d31 2c20 494e 4445 583d 342c  (SEQ=1, INDEX=4,
-00034b80: 2056 414c 5545 3d27 7461 626c 6527 295d   VALUE='table')]
-00034b90: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
-00034ba0: 7572 6e20 6c61 6d62 6461 202a 6172 6773  urn lambda *args
-00034bb0: 2c20 2a2a 6b77 6172 6773 3a20 6361 6c6c  , **kwargs: call
-00034bc0: 5f74 6162 6c65 5f66 756e 6374 696f 6e28  _table_function(
-00034bd0: 6675 6e63 7469 6f6e 5f6e 616d 652c 202a  function_name, *
-00034be0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
-00034bf0: 0a0a 6465 6620 6361 6c6c 5f66 756e 6374  ..def call_funct
-00034c00: 696f 6e28 6675 6e63 7469 6f6e 5f6e 616d  ion(function_nam
-00034c10: 653a 2073 7472 2c20 2a61 7267 733a 2043  e: str, *args: C
-00034c20: 6f6c 756d 6e4f 724c 6974 6572 616c 2920  olumnOrLiteral) 
-00034c30: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00034c40: 2222 496e 766f 6b65 7320 6120 536e 6f77  ""Invokes a Snow
-00034c50: 666c 616b 6520 6073 7973 7465 6d2d 6465  flake `system-de
-00034c60: 6669 6e65 6420 6675 6e63 7469 6f6e 203c  fined function <
-00034c70: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
-00034c80: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
-00034c90: 6c2d 7265 6665 7265 6e63 652d 6675 6e63  l-reference-func
-00034ca0: 7469 6f6e 732e 6874 6d6c 3e60 5f20 2862  tions.html>`_ (b
-00034cb0: 7569 6c74 2d69 6e20 6675 6e63 7469 6f6e  uilt-in function
-00034cc0: 2920 7769 7468 2074 6865 2073 7065 6369  ) with the speci
-00034cd0: 6669 6564 206e 616d 650a 2020 2020 616e  fied name.    an
-00034ce0: 6420 6172 6775 6d65 6e74 732e 0a0a 2020  d arguments...  
-00034cf0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00034d00: 6675 6e63 7469 6f6e 5f6e 616d 653a 2054  function_name: T
-00034d10: 6865 206e 616d 6520 6f66 2062 7569 6c74  he name of built
-00034d20: 2d69 6e20 6675 6e63 7469 6f6e 2069 6e20  -in function in 
-00034d30: 536e 6f77 666c 616b 650a 2020 2020 2020  Snowflake.      
-00034d40: 2020 6172 6773 3a20 4172 6775 6d65 6e74    args: Argument
-00034d50: 7320 6361 6e20 6265 2069 6e20 7477 6f20  s can be in two 
-00034d60: 7479 7065 733a 0a0a 2020 2020 2020 2020  types:..        
-00034d70: 2020 2020 2d20 3a63 6c61 7373 3a60 7e73      - :class:`~s
-00034d80: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00034d90: 6b2e 436f 6c75 6d6e 602c 206f 720a 2020  k.Column`, or.  
-00034da0: 2020 2020 2020 2020 2020 2d20 4261 7369            - Basi
-00034db0: 6320 5079 7468 6f6e 2074 7970 6573 2c20  c Python types, 
-00034dc0: 7768 6963 6820 6172 6520 636f 6e76 6572  which are conver
-00034dd0: 7465 6420 746f 2053 6e6f 7770 6172 6b20  ted to Snowpark 
-00034de0: 6c69 7465 7261 6c73 2e0a 0a20 2020 2045  literals...    E
-00034df0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00034e00: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00034e10: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00034e20: 6d65 285b 312c 2032 2c20 332c 2034 5d2c  me([1, 2, 3, 4],
-00034e30: 2073 6368 656d 613d 5b22 6122 5d29 2020   schema=["a"])  
-00034e40: 2320 6120 7369 6e67 6c65 2063 6f6c 756d  # a single colum
-00034e50: 6e20 7769 7468 2034 2072 6f77 730a 2020  n with 4 rows.  
-00034e60: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00034e70: 6563 7428 6361 6c6c 5f66 756e 6374 696f  ect(call_functio
-00034e80: 6e28 2261 7667 222c 2063 6f6c 2822 6122  n("avg", col("a"
-00034e90: 2929 292e 7368 6f77 2829 0a20 2020 2020  ))).show().     
-00034ea0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00034eb0: 2d2d 2d0a 2020 2020 2020 2020 7c22 4156  ---.        |"AV
-00034ec0: 4728 2222 4122 2229 2220 207c 0a20 2020  G(""A"")"  |.   
-00034ed0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00034ee0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c32  -----.        |2
-00034ef0: 2e35 3030 3030 3020 2020 2020 207c 0a20  .500000      |. 
-00034f00: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00034f10: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00034f20: 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20 2020  <BLANKLINE>..   
-00034f30: 2022 2222 0a0a 2020 2020 7265 7475 726e   """..    return
-00034f40: 205f 6361 6c6c 5f66 756e 6374 696f 6e28   _call_function(
-00034f50: 6675 6e63 7469 6f6e 5f6e 616d 652c 2046  function_name, F
-00034f60: 616c 7365 2c20 2a61 7267 7329 0a0a 0a64  alse, *args)...d
-00034f70: 6566 2066 756e 6374 696f 6e28 6675 6e63  ef function(func
-00034f80: 7469 6f6e 5f6e 616d 653a 2073 7472 2920  tion_name: str) 
-00034f90: 2d3e 2043 616c 6c61 626c 653a 0a20 2020  -> Callable:.   
-00034fa0: 2022 2222 0a20 2020 2046 756e 6374 696f   """.    Functio
-00034fb0: 6e20 6f62 6a65 6374 2074 6f20 696e 766f  n object to invo
-00034fc0: 6b65 2061 2053 6e6f 7766 6c61 6b65 2060  ke a Snowflake `
-00034fd0: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
-00034fe0: 756e 6374 696f 6e20 3c68 7474 7073 3a2f  unction <https:/
-00034ff0: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-00035000: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-00035010: 656e 6365 2d66 756e 6374 696f 6e73 2e68  ence-functions.h
-00035020: 746d 6c3e 605f 2028 6275 696c 742d 696e  tml>`_ (built-in
-00035030: 2066 756e 6374 696f 6e29 2e20 5573 6520   function). Use 
-00035040: 7468 6973 2074 6f20 696e 766f 6b65 0a20  this to invoke. 
-00035050: 2020 2061 6e79 2062 7569 6c74 2d69 6e20     any built-in 
-00035060: 6675 6e63 7469 6f6e 7320 6e6f 7420 6578  functions not ex
-00035070: 706c 6963 6974 6c79 206c 6973 7465 6420  plicitly listed 
-00035080: 696e 2074 6869 7320 6f62 6a65 6374 2e0a  in this object..
-00035090: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-000350a0: 2020 2066 756e 6374 696f 6e5f 6e61 6d65     function_name
-000350b0: 3a20 5468 6520 6e61 6d65 206f 6620 6275  : The name of bu
-000350c0: 696c 742d 696e 2066 756e 6374 696f 6e20  ilt-in function 
-000350d0: 696e 2053 6e6f 7766 6c61 6b65 2e0a 0a20  in Snowflake... 
-000350e0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-000350f0: 2020 2020 4120 3a63 6c61 7373 3a60 4361      A :class:`Ca
-00035100: 6c6c 6162 6c65 6020 6f62 6a65 6374 2066  llable` object f
-00035110: 6f72 2063 616c 6c69 6e67 2061 2053 6e6f  or calling a Sno
-00035120: 7766 6c61 6b65 2073 7973 7465 6d2d 6465  wflake system-de
-00035130: 6669 6e65 6420 6675 6e63 7469 6f6e 2e0a  fined function..
-00035140: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00035150: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00035160: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00035170: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
-00035180: 332c 2034 5d2c 2073 6368 656d 613d 5b22  3, 4], schema=["
-00035190: 6122 5d29 2020 2320 6120 7369 6e67 6c65  a"])  # a single
-000351a0: 2063 6f6c 756d 6e20 7769 7468 2034 2072   column with 4 r
-000351b0: 6f77 730a 2020 2020 2020 2020 3e3e 3e20  ows.        >>> 
-000351c0: 6466 2e73 656c 6563 7428 6361 6c6c 5f66  df.select(call_f
-000351d0: 756e 6374 696f 6e28 2261 7667 222c 2063  unction("avg", c
-000351e0: 6f6c 2822 6122 2929 292e 7368 6f77 2829  ol("a"))).show()
-000351f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00035200: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00035210: 2020 7c22 4156 4728 2222 4122 2229 2220    |"AVG(""A"")" 
-00035220: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00035230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00035240: 2020 2020 7c32 2e35 3030 3030 3020 2020      |2.500000   
-00035250: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00035260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00035270: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00035280: 3e0a 2020 2020 2020 2020 3e3e 3e20 6d79  >.        >>> my
-00035290: 5f61 7667 203d 2066 756e 6374 696f 6e28  _avg = function(
-000352a0: 2761 7667 2729 0a20 2020 2020 2020 203e  'avg').        >
-000352b0: 3e3e 2064 662e 7365 6c65 6374 286d 795f  >> df.select(my_
-000352c0: 6176 6728 636f 6c28 2261 2229 2929 2e73  avg(col("a"))).s
-000352d0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-000352e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-000352f0: 2020 2020 2020 207c 2241 5647 2822 2241         |"AVG(""A
-00035300: 2222 2922 2020 7c0a 2020 2020 2020 2020  "")"  |.        
-00035310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00035320: 0a20 2020 2020 2020 207c 322e 3530 3030  .        |2.5000
-00035330: 3030 2020 2020 2020 7c0a 2020 2020 2020  00      |.      
-00035340: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00035350: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00035360: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00035370: 2020 2072 6574 7572 6e20 6c61 6d62 6461     return lambda
-00035380: 202a 6172 6773 3a20 6361 6c6c 5f66 756e   *args: call_fun
-00035390: 6374 696f 6e28 6675 6e63 7469 6f6e 5f6e  ction(function_n
-000353a0: 616d 652c 202a 6172 6773 290a 0a0a 6465  ame, *args)...de
-000353b0: 6620 5f63 616c 6c5f 6675 6e63 7469 6f6e  f _call_function
-000353c0: 280a 2020 2020 6e61 6d65 3a20 7374 722c  (.    name: str,
-000353d0: 0a20 2020 2069 735f 6469 7374 696e 6374  .    is_distinct
-000353e0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-000353f0: 2020 2020 2a61 7267 733a 2043 6f6c 756d      *args: Colum
-00035400: 6e4f 724c 6974 6572 616c 2c0a 2020 2020  nOrLiteral,.    
-00035410: 6170 695f 6361 6c6c 5f73 6f75 7263 653a  api_call_source:
-00035420: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00035430: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
-00035440: 6d6e 3a0a 2020 2020 6578 7072 6573 7369  mn:.    expressi
-00035450: 6f6e 7320 3d20 5b43 6f6c 756d 6e2e 5f74  ons = [Column._t
-00035460: 6f5f 6578 7072 2861 7267 2920 666f 7220  o_expr(arg) for 
-00035470: 6172 6720 696e 2070 6172 7365 5f70 6f73  arg in parse_pos
-00035480: 6974 696f 6e61 6c5f 6172 6773 5f74 6f5f  itional_args_to_
-00035490: 6c69 7374 282a 6172 6773 295d 0a20 2020  list(*args)].   
-000354a0: 2072 6574 7572 6e20 436f 6c75 6d6e 280a   return Column(.
-000354b0: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-000354c0: 4578 7072 6573 7369 6f6e 280a 2020 2020  Expression(.    
-000354d0: 2020 2020 2020 2020 6e61 6d65 2c20 6578          name, ex
-000354e0: 7072 6573 7369 6f6e 732c 2069 735f 6469  pressions, is_di
-000354f0: 7374 696e 6374 3d69 735f 6469 7374 696e  stinct=is_distin
-00035500: 6374 2c20 6170 695f 6361 6c6c 5f73 6f75  ct, api_call_sou
-00035510: 7263 653d 6170 695f 6361 6c6c 5f73 6f75  rce=api_call_sou
-00035520: 7263 650a 2020 2020 2020 2020 290a 2020  rce.        ).  
-00035530: 2020 290a 0a0a 6465 6620 7370 726f 6328    )...def sproc(
-00035540: 0a20 2020 2066 756e 633a 204f 7074 696f  .    func: Optio
-00035550: 6e61 6c5b 4361 6c6c 6162 6c65 5d20 3d20  nal[Callable] = 
-00035560: 4e6f 6e65 2c0a 2020 2020 2a2c 0a20 2020  None,.    *,.   
-00035570: 2072 6574 7572 6e5f 7479 7065 3a20 4f70   return_type: Op
-00035580: 7469 6f6e 616c 5b44 6174 6154 7970 655d  tional[DataType]
-00035590: 203d 204e 6f6e 652c 0a20 2020 2069 6e70   = None,.    inp
-000355a0: 7574 5f74 7970 6573 3a20 4f70 7469 6f6e  ut_types: Option
-000355b0: 616c 5b4c 6973 745b 4461 7461 5479 7065  al[List[DataType
-000355c0: 5d5d 203d 204e 6f6e 652c 0a20 2020 206e  ]] = None,.    n
-000355d0: 616d 653a 204f 7074 696f 6e61 6c5b 556e  ame: Optional[Un
-000355e0: 696f 6e5b 7374 722c 2049 7465 7261 626c  ion[str, Iterabl
-000355f0: 655b 7374 725d 5d5d 203d 204e 6f6e 652c  e[str]]] = None,
-00035600: 0a20 2020 2069 735f 7065 726d 616e 656e  .    is_permanen
-00035610: 743a 2062 6f6f 6c20 3d20 4661 6c73 652c  t: bool = False,
-00035620: 0a20 2020 2073 7461 6765 5f6c 6f63 6174  .    stage_locat
-00035630: 696f 6e3a 204f 7074 696f 6e61 6c5b 7374  ion: Optional[st
-00035640: 725d 203d 204e 6f6e 652c 0a20 2020 2069  r] = None,.    i
-00035650: 6d70 6f72 7473 3a20 4f70 7469 6f6e 616c  mports: Optional
-00035660: 5b4c 6973 745b 556e 696f 6e5b 7374 722c  [List[Union[str,
-00035670: 2054 7570 6c65 5b73 7472 2c20 7374 725d   Tuple[str, str]
-00035680: 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ]]] = None,.    
-00035690: 7061 636b 6167 6573 3a20 4f70 7469 6f6e  packages: Option
-000356a0: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
-000356b0: 722c 204d 6f64 756c 6554 7970 655d 5d5d  r, ModuleType]]]
-000356c0: 203d 204e 6f6e 652c 0a20 2020 2072 6570   = None,.    rep
-000356d0: 6c61 6365 3a20 626f 6f6c 203d 2046 616c  lace: bool = Fal
-000356e0: 7365 2c0a 2020 2020 6966 5f6e 6f74 5f65  se,.    if_not_e
-000356f0: 7869 7374 733a 2062 6f6f 6c20 3d20 4661  xists: bool = Fa
-00035700: 6c73 652c 0a20 2020 2073 6573 7369 6f6e  lse,.    session
-00035710: 3a20 4f70 7469 6f6e 616c 5b22 736e 6f77  : Optional["snow
-00035720: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
-00035730: 6573 7369 6f6e 225d 203d 204e 6f6e 652c  ession"] = None,
-00035740: 0a20 2020 2070 6172 616c 6c65 6c3a 2069  .    parallel: i
-00035750: 6e74 203d 2034 2c0a 2020 2020 7374 6174  nt = 4,.    stat
-00035760: 656d 656e 745f 7061 7261 6d73 3a20 4f70  ement_params: Op
-00035770: 7469 6f6e 616c 5b44 6963 745b 7374 722c  tional[Dict[str,
-00035780: 2073 7472 5d5d 203d 204e 6f6e 652c 0a20   str]] = None,. 
-00035790: 2020 2065 7865 6375 7465 5f61 733a 2074     execute_as: t
-000357a0: 7970 696e 672e 4c69 7465 7261 6c5b 2263  yping.Literal["c
-000357b0: 616c 6c65 7222 2c20 226f 776e 6572 225d  aller", "owner"]
-000357c0: 203d 2022 6f77 6e65 7222 2c0a 2020 2020   = "owner",.    
-000357d0: 7374 7269 6374 3a20 626f 6f6c 203d 2046  strict: bool = F
-000357e0: 616c 7365 2c0a 2020 2020 736f 7572 6365  alse,.    source
-000357f0: 5f63 6f64 655f 6469 7370 6c61 793a 2062  _code_display: b
-00035800: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00035810: 2a2a 6b77 6172 6773 2c0a 2920 2d3e 2055  **kwargs,.) -> U
-00035820: 6e69 6f6e 5b53 746f 7265 6450 726f 6365  nion[StoredProce
-00035830: 6475 7265 2c20 6675 6e63 746f 6f6c 732e  dure, functools.
-00035840: 7061 7274 6961 6c5d 3a0a 2020 2020 2222  partial]:.    ""
-00035850: 2252 6567 6973 7465 7273 2061 2050 7974  "Registers a Pyt
-00035860: 686f 6e20 6675 6e63 7469 6f6e 2061 7320  hon function as 
-00035870: 6120 536e 6f77 666c 616b 6520 5079 7468  a Snowflake Pyth
-00035880: 6f6e 2073 746f 7265 6420 7072 6f63 6564  on stored proced
-00035890: 7572 6520 616e 6420 7265 7475 726e 7320  ure and returns 
-000358a0: 7468 6520 7374 6f72 6564 2070 726f 6365  the stored proce
-000358b0: 6475 7265 2e0a 0a20 2020 2049 7420 6361  dure...    It ca
-000358c0: 6e20 6265 2075 7365 6420 6173 2065 6974  n be used as eit
-000358d0: 6865 7220 6120 6675 6e63 7469 6f6e 2063  her a function c
-000358e0: 616c 6c20 6f72 2061 2064 6563 6f72 6174  all or a decorat
-000358f0: 6f72 2e20 496e 206d 6f73 7420 6361 7365  or. In most case
-00035900: 7320 796f 7520 776f 726b 2077 6974 6820  s you work with 
-00035910: 6120 7369 6e67 6c65 2073 6573 7369 6f6e  a single session
-00035920: 2e0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
-00035930: 696f 6e20 7573 6573 2074 6861 7420 7365  ion uses that se
-00035940: 7373 696f 6e20 746f 2072 6567 6973 7465  ssion to registe
-00035950: 7220 7468 6520 7374 6f72 6564 2070 726f  r the stored pro
-00035960: 6365 6475 7265 2e20 4966 2079 6f75 2068  cedure. If you h
-00035970: 6176 6520 6d75 6c74 6970 6c65 2073 6573  ave multiple ses
-00035980: 7369 6f6e 732c 2079 6f75 206e 6565 6420  sions, you need 
-00035990: 746f 0a20 2020 2065 7870 6c69 6369 746c  to.    explicitl
-000359a0: 7920 7370 6563 6966 7920 7468 6520 6060  y specify the ``
-000359b0: 7365 7373 696f 6e60 6020 7061 7261 6d65  session`` parame
-000359c0: 7465 7220 6f66 2074 6869 7320 6675 6e63  ter of this func
-000359d0: 7469 6f6e 2e20 4966 2079 6f75 2068 6176  tion. If you hav
-000359e0: 6520 6120 6675 6e63 7469 6f6e 2061 6e64  e a function and
-000359f0: 2077 6f75 6c64 0a20 2020 206c 696b 6520   would.    like 
-00035a00: 746f 2072 6567 6973 7465 7220 6974 2074  to register it t
-00035a10: 6f20 6d75 6c74 6970 6c65 2064 6174 6162  o multiple datab
-00035a20: 6173 6573 2c20 7573 6520 6060 7365 7373  ases, use ``sess
-00035a30: 696f 6e2e 7370 726f 632e 7265 6769 7374  ion.sproc.regist
-00035a40: 6572 6060 2069 6e73 7465 6164 2e20 5365  er`` instead. Se
-00035a50: 6520 6578 616d 706c 6573 0a20 2020 2069  e examples.    i
-00035a60: 6e20 3a63 6c61 7373 3a60 7e73 6e6f 7766  n :class:`~snowf
-00035a70: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7374  lake.snowpark.st
-00035a80: 6f72 6564 5f70 726f 6365 6475 7265 2e53  ored_procedure.S
-00035a90: 746f 7265 6450 726f 6365 6475 7265 5265  toredProcedureRe
-00035aa0: 6769 7374 7261 7469 6f6e 602e 0a0a 2020  gistration`...  
-00035ab0: 2020 4e6f 7465 2074 6861 7420 7468 6520    Note that the 
-00035ac0: 6669 7273 7420 7061 7261 6d65 7465 7220  first parameter 
-00035ad0: 6f66 2079 6f75 7220 6675 6e63 7469 6f6e  of your function
-00035ae0: 2073 686f 756c 6420 6265 2061 2073 6e6f   should be a sno
-00035af0: 7770 6172 6b20 5365 7373 696f 6e2e 2041  wpark Session. A
-00035b00: 6c73 6f2c 2079 6f75 206e 6565 6420 746f  lso, you need to
-00035b10: 2061 6464 0a20 2020 2060 736e 6f77 666c   add.    `snowfl
-00035b20: 616b 652d 736e 6f77 7061 726b 2d70 7974  ake-snowpark-pyt
-00035b30: 686f 6e60 2070 6163 6b61 6765 2028 7665  hon` package (ve
-00035b40: 7273 696f 6e20 3e3d 2030 2e34 2e30 2920  rsion >= 0.4.0) 
-00035b50: 746f 2079 6f75 7220 7365 7373 696f 6e20  to your session 
-00035b60: 6265 666f 7265 2074 7279 696e 6720 746f  before trying to
-00035b70: 2063 7265 6174 6520 610a 2020 2020 7374   create a.    st
-00035b80: 6f72 6564 2070 726f 6365 6475 7265 2e0a  ored procedure..
-00035b90: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00035ba0: 2020 2066 756e 633a 2041 2050 7974 686f     func: A Pytho
-00035bb0: 6e20 6675 6e63 7469 6f6e 2075 7365 6420  n function used 
-00035bc0: 666f 7220 6372 6561 7469 6e67 2074 6865  for creating the
-00035bd0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-00035be0: 652e 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-00035bf0: 6e5f 7479 7065 3a20 4120 3a63 6c61 7373  n_type: A :class
-00035c00: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-00035c10: 7770 6172 6b2e 7479 7065 732e 4461 7461  wpark.types.Data
-00035c20: 5479 7065 6020 7265 7072 6573 656e 7469  Type` representi
-00035c30: 6e67 2074 6865 2072 6574 7572 6e20 6461  ng the return da
-00035c40: 7461 0a20 2020 2020 2020 2020 2020 2074  ta.            t
-00035c50: 7970 6520 6f66 2074 6865 2073 746f 7265  ype of the store
-00035c60: 6420 7072 6f63 6564 7572 652e 204f 7074  d procedure. Opt
-00035c70: 696f 6e61 6c20 6966 2074 7970 6520 6869  ional if type hi
-00035c80: 6e74 7320 6172 6520 7072 6f76 6964 6564  nts are provided
-00035c90: 2e0a 2020 2020 2020 2020 696e 7075 745f  ..        input_
-00035ca0: 7479 7065 733a 2041 206c 6973 7420 6f66  types: A list of
-00035cb0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
-00035cc0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
-00035cd0: 6573 2e44 6174 6154 7970 6560 0a20 2020  es.DataType`.   
-00035ce0: 2020 2020 2020 2020 2072 6570 7265 7365           represe
-00035cf0: 6e74 696e 6720 7468 6520 696e 7075 7420  nting the input 
-00035d00: 6461 7461 2074 7970 6573 206f 6620 7468  data types of th
-00035d10: 6520 7374 6f72 6564 2070 726f 6365 6475  e stored procedu
-00035d20: 7265 2e20 4f70 7469 6f6e 616c 2069 660a  re. Optional if.
-00035d30: 2020 2020 2020 2020 2020 2020 7479 7065              type
-00035d40: 2068 696e 7473 2061 7265 2070 726f 7669   hints are provi
-00035d50: 6465 642e 0a20 2020 2020 2020 206e 616d  ded..        nam
-00035d60: 653a 2041 2073 7472 696e 6720 6f72 206c  e: A string or l
-00035d70: 6973 7420 6f66 2073 7472 696e 6773 2074  ist of strings t
-00035d80: 6861 7420 7370 6563 6966 7920 7468 6520  hat specify the 
-00035d90: 6e61 6d65 206f 7220 6675 6c6c 792d 7175  name or fully-qu
-00035da0: 616c 6966 6965 640a 2020 2020 2020 2020  alified.        
-00035db0: 2020 2020 6f62 6a65 6374 2069 6465 6e74      object ident
-00035dc0: 6966 6965 7220 2864 6174 6162 6173 6520  ifier (database 
-00035dd0: 6e61 6d65 2c20 7363 6865 6d61 206e 616d  name, schema nam
-00035de0: 652c 2061 6e64 2066 756e 6374 696f 6e20  e, and function 
-00035df0: 6e61 6d65 2920 666f 720a 2020 2020 2020  name) for.      
-00035e00: 2020 2020 2020 7468 6520 7374 6f72 6564        the stored
-00035e10: 2070 726f 6365 6475 7265 2069 6e20 536e   procedure in Sn
-00035e20: 6f77 666c 616b 652c 2077 6869 6368 2061  owflake, which a
-00035e30: 6c6c 6f77 7320 796f 7520 746f 2063 616c  llows you to cal
-00035e40: 6c20 7468 6973 2073 746f 7265 6420 7072  l this stored pr
-00035e50: 6f63 6564 7572 6520 696e 2061 2053 514c  ocedure in a SQL
-00035e60: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-00035e70: 6d61 6e64 206f 7220 7669 6120 3a66 756e  mand or via :fun
-00035e80: 633a 6073 6573 7369 6f6e 2e63 616c 6c28  c:`session.call(
-00035e90: 2960 2e20 4966 2069 7420 6973 206e 6f74  )`. If it is not
-00035ea0: 2070 726f 7669 6465 642c 2061 206e 616d   provided, a nam
-00035eb0: 6520 7769 6c6c 0a20 2020 2020 2020 2020  e will.         
-00035ec0: 2020 2062 6520 6175 746f 6d61 7469 6361     be automatica
-00035ed0: 6c6c 7920 6765 6e65 7261 7465 6420 666f  lly generated fo
-00035ee0: 7220 7468 6520 7374 6f72 6564 2070 726f  r the stored pro
-00035ef0: 6365 6475 7265 2e20 4120 6e61 6d65 206d  cedure. A name m
-00035f00: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
-00035f10: 2077 6865 6e0a 2020 2020 2020 2020 2020   when.          
-00035f20: 2020 6060 6973 5f70 6572 6d61 6e65 6e74    ``is_permanent
-00035f30: 6060 2069 7320 6060 5472 7565 6060 2e0a  `` is ``True``..
-00035f40: 2020 2020 2020 2020 6973 5f70 6572 6d61          is_perma
-00035f50: 6e65 6e74 3a20 5768 6574 6865 7220 746f  nent: Whether to
-00035f60: 2063 7265 6174 6520 6120 7065 726d 616e   create a perman
-00035f70: 656e 7420 7374 6f72 6564 2070 726f 6365  ent stored proce
-00035f80: 6475 7265 2e20 5468 6520 6465 6661 756c  dure. The defaul
-00035f90: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
-00035fa0: 2020 2020 2020 2020 2020 2020 4966 2069              If i
-00035fb0: 7420 6973 2060 6054 7275 6560 602c 2061  t is ``True``, a
-00035fc0: 2076 616c 6964 2060 6073 7461 6765 5f6c   valid ``stage_l
-00035fd0: 6f63 6174 696f 6e60 6020 6d75 7374 2062  ocation`` must b
-00035fe0: 6520 7072 6f76 6964 6564 2e0a 2020 2020  e provided..    
-00035ff0: 2020 2020 7374 6167 655f 6c6f 6361 7469      stage_locati
-00036000: 6f6e 3a20 5468 6520 7374 6167 6520 6c6f  on: The stage lo
-00036010: 6361 7469 6f6e 2077 6865 7265 2074 6865  cation where the
-00036020: 2050 7974 686f 6e20 6669 6c65 2066 6f72   Python file for
-00036030: 2074 6865 2073 746f 7265 6420 7072 6f63   the stored proc
-00036040: 6564 7572 650a 2020 2020 2020 2020 2020  edure.          
-00036050: 2020 616e 6420 6974 7320 6465 7065 6e64    and its depend
-00036060: 656e 6369 6573 2073 686f 756c 6420 6265  encies should be
-00036070: 2075 706c 6f61 6465 642e 2054 6865 2073   uploaded. The s
-00036080: 7461 6765 206c 6f63 6174 696f 6e20 6d75  tage location mu
-00036090: 7374 2062 6520 7370 6563 6966 6965 640a  st be specified.
-000360a0: 2020 2020 2020 2020 2020 2020 7768 656e              when
-000360b0: 2060 6069 735f 7065 726d 616e 656e 7460   ``is_permanent`
-000360c0: 6020 6973 2060 6054 7275 6560 602c 2061  ` is ``True``, a
-000360d0: 6e64 2069 7420 7769 6c6c 2062 6520 6967  nd it will be ig
-000360e0: 6e6f 7265 6420 7768 656e 0a20 2020 2020  nored when.     
-000360f0: 2020 2020 2020 2060 6069 735f 7065 726d         ``is_perm
-00036100: 616e 656e 7460 6020 6973 2060 6046 616c  anent`` is ``Fal
-00036110: 7365 6060 2e20 4974 2063 616e 2062 6520  se``. It can be 
-00036120: 616e 7920 7374 6167 6520 6f74 6865 7220  any stage other 
-00036130: 7468 616e 2074 656d 706f 7261 7279 0a20  than temporary. 
-00036140: 2020 2020 2020 2020 2020 2073 7461 6765             stage
-00036150: 7320 616e 6420 6578 7465 726e 616c 2073  s and external s
-00036160: 7461 6765 732e 0a20 2020 2020 2020 2069  tages..        i
-00036170: 6d70 6f72 7473 3a20 4120 6c69 7374 206f  mports: A list o
-00036180: 6620 696d 706f 7274 7320 7468 6174 206f  f imports that o
-00036190: 6e6c 7920 6170 706c 7920 746f 2074 6869  nly apply to thi
-000361a0: 7320 7374 6f72 6564 2070 726f 6365 6475  s stored procedu
-000361b0: 7265 2e20 596f 7520 6361 6e20 7573 6520  re. You can use 
-000361c0: 6120 7374 7269 6e67 2074 6f0a 2020 2020  a string to.    
-000361d0: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-000361e0: 7420 6120 6669 6c65 2070 6174 6820 2873  t a file path (s
-000361f0: 696d 696c 6172 2074 6f20 7468 6520 6060  imilar to the ``
-00036200: 7061 7468 6060 2061 7267 756d 656e 7420  path`` argument 
-00036210: 696e 0a20 2020 2020 2020 2020 2020 203a  in.            :
-00036220: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
-00036230: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
-00036240: 6e2e 6164 645f 696d 706f 7274 6029 2069  n.add_import`) i
-00036250: 6e20 7468 6973 206c 6973 742c 206f 7220  n this list, or 
-00036260: 6120 7475 706c 6520 6f66 2074 776f 0a20  a tuple of two. 
-00036270: 2020 2020 2020 2020 2020 2073 7472 696e             strin
-00036280: 6773 2074 6f20 7265 7072 6573 656e 7420  gs to represent 
-00036290: 6120 6669 6c65 2070 6174 6820 616e 6420  a file path and 
-000362a0: 616e 2069 6d70 6f72 7420 7061 7468 2028  an import path (
-000362b0: 7369 6d69 6c61 7220 746f 2074 6865 2060  similar to the `
-000362c0: 6069 6d70 6f72 745f 7061 7468 6060 0a20  `import_path``. 
-000362d0: 2020 2020 2020 2020 2020 2061 7267 756d             argum
-000362e0: 656e 7420 696e 203a 6d65 7468 3a60 7e73  ent in :meth:`~s
-000362f0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00036300: 6b2e 5365 7373 696f 6e2e 6164 645f 696d  k.Session.add_im
-00036310: 706f 7274 6029 2e20 5468 6573 6520 7374  port`). These st
-00036320: 6f72 6564 2d70 726f 632d 6c65 7665 6c20  ored-proc-level 
-00036330: 696d 706f 7274 730a 2020 2020 2020 2020  imports.        
-00036340: 2020 2020 7769 6c6c 206f 7665 7272 6964      will overrid
-00036350: 6520 7468 6520 7365 7373 696f 6e2d 6c65  e the session-le
-00036360: 7665 6c20 696d 706f 7274 7320 6164 6465  vel imports adde
-00036370: 6420 6279 0a20 2020 2020 2020 2020 2020  d by.           
-00036380: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
-00036390: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
-000363a0: 696f 6e2e 6164 645f 696d 706f 7274 602e  ion.add_import`.
-000363b0: 0a20 2020 2020 2020 2070 6163 6b61 6765  .        package
-000363c0: 733a 2041 206c 6973 7420 6f66 2070 6163  s: A list of pac
-000363d0: 6b61 6765 7320 7468 6174 206f 6e6c 7920  kages that only 
-000363e0: 6170 706c 7920 746f 2074 6869 7320 7374  apply to this st
-000363f0: 6f72 6564 2070 726f 6365 6475 7265 2e20  ored procedure. 
-00036400: 5468 6573 6520 7374 6f72 6564 2d70 726f  These stored-pro
-00036410: 632d 6c65 7665 6c20 7061 636b 6167 6573  c-level packages
-00036420: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-00036430: 6c20 6f76 6572 7269 6465 2074 6865 2073  l override the s
-00036440: 6573 7369 6f6e 2d6c 6576 656c 2070 6163  ession-level pac
-00036450: 6b61 6765 7320 6164 6465 6420 6279 0a20  kages added by. 
-00036460: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
-00036470: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-00036480: 7770 6172 6b2e 5365 7373 696f 6e2e 6164  wpark.Session.ad
-00036490: 645f 7061 636b 6167 6573 6020 616e 640a  d_packages` and.
-000364a0: 2020 2020 2020 2020 2020 2020 3a6d 6574              :met
-000364b0: 683a 607e 736e 6f77 666c 616b 652e 736e  h:`~snowflake.sn
-000364c0: 6f77 7061 726b 2e53 6573 7369 6f6e 2e61  owpark.Session.a
-000364d0: 6464 5f72 6571 7569 7265 6d65 6e74 7360  dd_requirements`
-000364e0: 2e0a 2020 2020 2020 2020 7265 706c 6163  ..        replac
-000364f0: 653a 2057 6865 7468 6572 2074 6f20 7265  e: Whether to re
-00036500: 706c 6163 6520 6120 7374 6f72 6564 2070  place a stored p
-00036510: 726f 6365 6475 7265 2074 6861 7420 616c  rocedure that al
-00036520: 7265 6164 7920 7761 7320 7265 6769 7374  ready was regist
-00036530: 6572 6564 2e20 5468 6520 6465 6661 756c  ered. The defaul
-00036540: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
-00036550: 2020 2020 2020 2020 2020 2020 4966 2069              If i
-00036560: 7420 6973 2060 6046 616c 7365 6060 2c20  t is ``False``, 
-00036570: 6174 7465 6d70 7469 6e67 2074 6f20 7265  attempting to re
-00036580: 6769 7374 6572 2061 2073 746f 7265 6420  gister a stored 
-00036590: 7072 6f63 6564 7572 6520 7769 7468 2061  procedure with a
-000365a0: 206e 616d 6520 7468 6174 2061 6c72 6561   name that alrea
-000365b0: 6479 2065 7869 7374 730a 2020 2020 2020  dy exists.      
-000365c0: 2020 2020 2020 7265 7375 6c74 7320 696e        results in
-000365d0: 2061 2060 6053 6e6f 7770 6172 6b53 514c   a ``SnowparkSQL
-000365e0: 4578 6365 7074 696f 6e60 6020 6578 6365  Exception`` exce
-000365f0: 7074 696f 6e20 6265 696e 6720 7468 726f  ption being thro
-00036600: 776e 2e20 4966 2069 7420 6973 2060 6054  wn. If it is ``T
-00036610: 7275 6560 602c 0a20 2020 2020 2020 2020  rue``,.         
-00036620: 2020 2061 6e20 6578 6973 7469 6e67 2073     an existing s
-00036630: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
-00036640: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
-00036650: 6d65 2069 7320 6f76 6572 7772 6974 7465  me is overwritte
-00036660: 6e2e 0a20 2020 2020 2020 2069 665f 6e6f  n..        if_no
-00036670: 745f 6578 6973 7473 3a20 5768 6574 6865  t_exists: Whethe
-00036680: 7220 746f 2073 6b69 7020 6372 6561 7469  r to skip creati
-00036690: 6f6e 206f 6620 6120 7374 6f72 6564 2070  on of a stored p
-000366a0: 726f 6365 6475 7265 2074 6865 2073 616d  rocedure the sam
-000366b0: 6520 7072 6f63 6564 7572 6520 6973 2061  e procedure is a
-000366c0: 6c72 6561 6479 2072 6567 6973 7465 7265  lready registere
-000366d0: 642e 0a20 2020 2020 2020 2020 2020 2054  d..            T
-000366e0: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
-000366f0: 4661 6c73 6560 602e 2060 6069 665f 6e6f  False``. ``if_no
-00036700: 745f 6578 6973 7473 6060 2061 6e64 2060  t_exists`` and `
-00036710: 6072 6570 6c61 6365 6060 2061 7265 206d  `replace`` are m
-00036720: 7574 7561 6c6c 7920 6578 636c 7573 6976  utually exclusiv
-00036730: 6520 616e 6420 6120 6060 5661 6c75 6545  e and a ``ValueE
-00036740: 7272 6f72 6060 0a20 2020 2020 2020 2020  rror``.         
-00036750: 2020 2069 7320 7261 6973 6564 2077 6865     is raised whe
-00036760: 6e20 626f 7468 2061 7265 2073 6574 2e20  n both are set. 
-00036770: 4966 2069 7420 6973 2060 6054 7275 6560  If it is ``True`
-00036780: 6020 616e 6420 6120 7374 6f72 6564 2070  ` and a stored p
-00036790: 726f 6365 6475 7265 2069 7320 616c 7265  rocedure is alre
-000367a0: 6164 7920 7265 6769 7374 6572 6564 2c20  ady registered, 
-000367b0: 7468 6520 7265 6769 7374 7261 7469 6f6e  the registration
-000367c0: 2069 7320 736b 6970 7065 642e 0a20 2020   is skipped..   
-000367d0: 2020 2020 2073 6573 7369 6f6e 3a20 5573       session: Us
-000367e0: 6520 7468 6973 2073 6573 7369 6f6e 2074  e this session t
-000367f0: 6f20 7265 6769 7374 6572 2074 6865 2073  o register the s
-00036800: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
-00036810: 2049 6620 6974 2773 206e 6f74 2073 7065   If it's not spe
-00036820: 6369 6669 6564 2c20 7468 6520 7365 7373  cified, the sess
-00036830: 696f 6e20 7468 6174 2079 6f75 2063 7265  ion that you cre
-00036840: 6174 6564 2062 6566 6f72 6520 6361 6c6c  ated before call
-00036850: 696e 6720 7468 6973 2066 756e 6374 696f  ing this functio
-00036860: 6e20 7769 6c6c 2062 6520 7573 6564 2e0a  n will be used..
-00036870: 2020 2020 2020 2020 2020 2020 596f 7520              You 
-00036880: 6e65 6564 2074 6f20 7370 6563 6966 7920  need to specify 
-00036890: 7468 6973 2070 6172 616d 6574 6572 2069  this parameter i
-000368a0: 6620 796f 7520 6861 7665 2063 7265 6174  f you have creat
-000368b0: 6564 206d 756c 7469 706c 6520 7365 7373  ed multiple sess
-000368c0: 696f 6e73 2062 6566 6f72 6520 6361 6c6c  ions before call
-000368d0: 696e 6720 7468 6973 206d 6574 686f 642e  ing this method.
-000368e0: 0a20 2020 2020 2020 2070 6172 616c 6c65  .        paralle
-000368f0: 6c3a 2054 6865 206e 756d 6265 7220 6f66  l: The number of
-00036900: 2074 6872 6561 6473 2074 6f20 7573 6520   threads to use 
-00036910: 666f 7220 7570 6c6f 6164 696e 6720 7374  for uploading st
-00036920: 6f72 6564 2070 726f 6365 6475 7265 2066  ored procedure f
-00036930: 696c 6573 2077 6974 6820 7468 650a 2020  iles with the.  
-00036940: 2020 2020 2020 2020 2020 6050 5554 203c            `PUT <
-00036950: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
-00036960: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
-00036970: 6c2d 7265 6665 7265 6e63 652f 7371 6c2f  l-reference/sql/
-00036980: 7075 742e 6874 6d6c 2370 7574 3e60 5f0a  put.html#put>`_.
-00036990: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
-000369a0: 616e 642e 2054 6865 2064 6566 6175 6c74  and. The default
-000369b0: 2076 616c 7565 2069 7320 3420 616e 6420   value is 4 and 
-000369c0: 7375 7070 6f72 7465 6420 7661 6c75 6573  supported values
-000369d0: 2061 7265 2066 726f 6d20 3120 746f 2039   are from 1 to 9
-000369e0: 392e 0a20 2020 2020 2020 2020 2020 2049  9..            I
-000369f0: 6e63 7265 6173 696e 6720 7468 6520 6e75  ncreasing the nu
-00036a00: 6d62 6572 206f 6620 7468 7265 6164 7320  mber of threads 
-00036a10: 6361 6e20 696d 7072 6f76 6520 7065 7266  can improve perf
-00036a20: 6f72 6d61 6e63 6520 7768 656e 2075 706c  ormance when upl
-00036a30: 6f61 6469 6e67 0a20 2020 2020 2020 2020  oading.         
-00036a40: 2020 206c 6172 6765 2073 746f 7265 6420     large stored 
-00036a50: 7072 6f63 6564 7572 6520 6669 6c65 732e  procedure files.
-00036a60: 0a20 2020 2020 2020 2065 7865 6375 7465  .        execute
-00036a70: 5f61 733a 2057 6861 7420 7065 726d 6973  _as: What permis
-00036a80: 7369 6f6e 7320 7368 6f75 6c64 2074 6865  sions should the
-00036a90: 2070 726f 6365 6475 7265 2068 6176 6520   procedure have 
-00036aa0: 7768 696c 6520 6578 6563 7574 696e 672e  while executing.
-00036ab0: 2054 6869 730a 2020 2020 2020 2020 2020   This.          
-00036ac0: 2020 7375 7070 6f72 7473 2063 616c 6c65    supports calle
-00036ad0: 722c 206f 7220 6f77 6e65 7220 666f 7220  r, or owner for 
-00036ae0: 6e6f 772e 2053 6565 2060 6f77 6e65 7220  now. See `owner 
-00036af0: 616e 6420 6361 6c6c 6572 2072 6967 6874  and caller right
-00036b00: 7320 3c68 7474 7073 3a2f 2f64 6f63 732e  s <https://docs.
-00036b10: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
-00036b20: 2f73 716c 2d72 6566 6572 656e 6365 2f73  /sql-reference/s
-00036b30: 746f 7265 642d 7072 6f63 6564 7572 6573  tored-procedures
-00036b40: 2d72 6967 6874 732e 6874 6d6c 3e60 5f0a  -rights.html>`_.
-00036b50: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00036b60: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-00036b70: 2e0a 2020 2020 2020 2020 7374 6174 656d  ..        statem
-00036b80: 656e 745f 7061 7261 6d73 3a20 4469 6374  ent_params: Dict
-00036b90: 696f 6e61 7279 206f 6620 7374 6174 656d  ionary of statem
-00036ba0: 656e 7420 6c65 7665 6c20 7061 7261 6d65  ent level parame
-00036bb0: 7465 7273 2074 6f20 6265 2073 6574 2077  ters to be set w
-00036bc0: 6869 6c65 2065 7865 6375 7469 6e67 2074  hile executing t
-00036bd0: 6869 7320 6163 7469 6f6e 2e0a 2020 2020  his action..    
-00036be0: 2020 2020 7374 7269 6374 3a20 5768 6574      strict: Whet
-00036bf0: 6865 7220 7468 6520 6372 6561 7465 6420  her the created 
-00036c00: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-00036c10: 2069 7320 7374 7269 6374 2e20 4120 7374   is strict. A st
-00036c20: 7269 6374 2073 746f 7265 6420 7072 6f63  rict stored proc
-00036c30: 6564 7572 6520 7769 6c6c 206e 6f74 2069  edure will not i
-00036c40: 6e76 6f6b 650a 2020 2020 2020 2020 2020  nvoke.          
-00036c50: 2020 7468 6520 7374 6f72 6564 2070 726f    the stored pro
-00036c60: 6365 6475 7265 2069 6620 616e 7920 696e  cedure if any in
-00036c70: 7075 7420 6973 206e 756c 6c2e 2049 6e73  put is null. Ins
-00036c80: 7465 6164 2c20 6120 6e75 6c6c 2076 616c  tead, a null val
-00036c90: 7565 2077 696c 6c20 616c 7761 7973 2062  ue will always b
-00036ca0: 6520 7265 7475 726e 6564 2e20 4e6f 7465  e returned. Note
-00036cb0: 0a20 2020 2020 2020 2020 2020 2074 6861  .            tha
-00036cc0: 7420 7468 6520 7374 6f72 6564 2070 726f  t the stored pro
-00036cd0: 6365 6475 7265 206d 6967 6874 2073 7469  cedure might sti
-00036ce0: 6c6c 2072 6574 7572 6e20 6e75 6c6c 2066  ll return null f
-00036cf0: 6f72 206e 6f6e 2d6e 756c 6c20 696e 7075  or non-null inpu
-00036d00: 7473 2e0a 2020 2020 2020 2020 736f 7572  ts..        sour
-00036d10: 6365 5f63 6f64 655f 6469 7370 6c61 793a  ce_code_display:
-00036d20: 2044 6973 706c 6179 2074 6865 2073 6f75   Display the sou
-00036d30: 7263 6520 636f 6465 206f 6620 7468 6520  rce code of the 
-00036d40: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-00036d50: 2060 6675 6e63 6020 6173 2063 6f6d 6d65   `func` as comme
-00036d60: 6e74 7320 696e 2074 6865 2067 656e 6572  nts in the gener
-00036d70: 6174 6564 2073 6372 6970 742e 0a20 2020  ated script..   
-00036d80: 2020 2020 2020 2020 2054 6865 2073 6f75           The sou
-00036d90: 7263 6520 636f 6465 2069 7320 6479 6e61  rce code is dyna
-00036da0: 6d69 6361 6c6c 7920 6765 6e65 7261 7465  mically generate
-00036db0: 6420 7468 6572 6566 6f72 6520 6974 206d  d therefore it m
-00036dc0: 6179 206e 6f74 2062 6520 6964 656e 7469  ay not be identi
-00036dd0: 6361 6c20 746f 2068 6f77 2074 6865 0a20  cal to how the. 
-00036de0: 2020 2020 2020 2020 2020 2060 6675 6e63             `func
-00036df0: 6020 6973 206f 7269 6769 6e61 6c6c 7920  ` is originally 
-00036e00: 6465 6669 6e65 642e 2054 6865 2064 6566  defined. The def
-00036e10: 6175 6c74 2069 7320 6060 5472 7565 6060  ault is ``True``
-00036e20: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00036e30: 2069 7420 6973 2060 6046 616c 7365 6060   it is ``False``
-00036e40: 2c20 736f 7572 6365 2063 6f64 6520 7769  , source code wi
-00036e50: 6c6c 206e 6f74 2062 6520 6765 6e65 7261  ll not be genera
-00036e60: 7465 6420 6f72 2064 6973 706c 6179 6564  ted or displayed
-00036e70: 2e0a 0a20 2020 2052 6574 7572 6e73 3a0a  ...    Returns:.
-00036e80: 2020 2020 2020 2020 4120 7374 6f72 6564          A stored
-00036e90: 2070 726f 6365 6475 7265 2066 756e 6374   procedure funct
-00036ea0: 696f 6e20 7468 6174 2063 616e 2062 6520  ion that can be 
-00036eb0: 6361 6c6c 6564 2077 6974 6820 7079 7468  called with pyth
-00036ec0: 6f6e 2076 616c 7565 2e0a 0a20 2020 204e  on value...    N
-00036ed0: 6f74 653a 0a20 2020 2020 2020 2031 2e20  ote:.        1. 
-00036ee0: 5768 656e 2074 7970 6520 6869 6e74 7320  When type hints 
-00036ef0: 6172 6520 7072 6f76 6964 6564 2061 6e64  are provided and
-00036f00: 2061 7265 2063 6f6d 706c 6574 6520 666f   are complete fo
-00036f10: 7220 6120 6675 6e63 7469 6f6e 2c0a 2020  r a function,.  
-00036f20: 2020 2020 2020 6060 7265 7475 726e 5f74        ``return_t
-00036f30: 7970 6560 6020 616e 6420 6060 696e 7075  ype`` and ``inpu
-00036f40: 745f 7479 7065 7360 6020 6172 6520 6f70  t_types`` are op
-00036f50: 7469 6f6e 616c 2061 6e64 2077 696c 6c20  tional and will 
-00036f60: 6265 2069 676e 6f72 6564 2e0a 2020 2020  be ignored..    
-00036f70: 2020 2020 5365 6520 6465 7461 696c 7320      See details 
-00036f80: 6f66 2073 7570 706f 7274 6564 2064 6174  of supported dat
-00036f90: 6120 7479 7065 7320 666f 7220 7374 6f72  a types for stor
-00036fa0: 6564 2070 726f 6365 6475 7265 2069 6e0a  ed procedure in.
-00036fb0: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
-00036fc0: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00036fd0: 6172 6b2e 7374 6f72 6564 5f70 726f 6365  ark.stored_proce
-00036fe0: 6475 7265 2e53 746f 7265 6450 726f 6365  dure.StoredProce
-00036ff0: 6475 7265 5265 6769 7374 7261 7469 6f6e  dureRegistration
-00037000: 602e 0a0a 2020 2020 2020 2020 2020 2020  `...            
-00037010: 2d20 596f 7520 6361 6e20 7573 6520 3a61  - You can use :a
-00037020: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
-00037030: 736e 6f77 7061 726b 2e74 7970 6573 2e56  snowpark.types.V
-00037040: 6172 6961 6e74 6020 746f 0a20 2020 2020  ariant` to.     
-00037050: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-00037060: 6520 6120 7661 7269 616e 742c 2061 6e64  e a variant, and
-00037070: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
-00037080: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00037090: 7479 7065 732e 4765 6f67 7261 7068 7960  types.Geography`
-000370a0: 0a20 2020 2020 2020 2020 2020 2020 2074  .              t
-000370b0: 6f20 616e 6e6f 7461 7465 2061 2067 656f  o annotate a geo
-000370c0: 6772 6170 6879 2077 6865 6e20 6465 6669  graphy when defi
-000370d0: 6e69 6e67 2061 2073 746f 7265 6420 7072  ning a stored pr
-000370e0: 6f63 6564 7572 652e 0a0a 2020 2020 2020  ocedure...      
-000370f0: 2020 2020 2020 2d20 3a63 6c61 7373 3a60        - :class:`
-00037100: 7479 7069 6e67 2e55 6e69 6f6e 6020 6973  typing.Union` is
-00037110: 206e 6f74 2061 2076 616c 6964 2074 7970   not a valid typ
-00037120: 6520 616e 6e6f 7461 7469 6f6e 2066 6f72  e annotation for
-00037130: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-00037140: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00037150: 2020 6275 7420 3a63 6c61 7373 3a60 7479    but :class:`ty
-00037160: 7069 6e67 2e4f 7074 696f 6e61 6c60 2063  ping.Optional` c
-00037170: 616e 2062 6520 7573 6564 2074 6f20 696e  an be used to in
-00037180: 6469 6361 7465 2074 6865 206f 7074 696f  dicate the optio
-00037190: 6e61 6c20 7479 7065 2e0a 0a20 2020 2020  nal type...     
-000371a0: 2020 2032 2e20 4120 7465 6d70 6f72 6172     2. A temporar
-000371b0: 7920 7374 6f72 6564 2070 726f 6365 6475  y stored procedu
-000371c0: 7265 2028 7768 656e 2060 6069 735f 7065  re (when ``is_pe
-000371d0: 726d 616e 656e 7460 6020 6973 2060 6046  rmanent`` is ``F
-000371e0: 616c 7365 6060 2920 6973 2073 636f 7065  alse``) is scope
-000371f0: 6420 746f 2074 6869 7320 6060 7365 7373  d to this ``sess
-00037200: 696f 6e60 600a 2020 2020 2020 2020 616e  ion``.        an
-00037210: 6420 616c 6c20 7374 6f72 6564 2070 726f  d all stored pro
-00037220: 6365 6475 7265 2072 656c 6174 6564 2066  cedure related f
-00037230: 696c 6573 2077 696c 6c20 6265 2075 706c  iles will be upl
-00037240: 6f61 6465 6420 746f 2061 2074 656d 706f  oaded to a tempo
-00037250: 7261 7279 2073 6573 7369 6f6e 2073 7461  rary session sta
-00037260: 6765 0a20 2020 2020 2020 2028 3a66 756e  ge.        (:fun
-00037270: 633a 6073 6573 7369 6f6e 2e67 6574 5f73  c:`session.get_s
-00037280: 6573 7369 6f6e 5f73 7461 6765 2829 203c  ession_stage() <
-00037290: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-000372a0: 726b 2e53 6573 7369 6f6e 2e67 6574 5f73  rk.Session.get_s
-000372b0: 6573 7369 6f6e 5f73 7461 6765 3e60 292e  ession_stage>`).
-000372c0: 0a20 2020 2020 2020 2046 6f72 2061 2070  .        For a p
-000372d0: 6572 6d61 6e65 6e74 2073 746f 7265 6420  ermanent stored 
-000372e0: 7072 6f63 6564 7572 652c 2074 6865 7365  procedure, these
-000372f0: 2066 696c 6573 2077 696c 6c20 6265 2075   files will be u
-00037300: 706c 6f61 6465 6420 746f 2074 6865 2073  ploaded to the s
-00037310: 7461 6765 2074 6861 7420 796f 7520 7072  tage that you pr
-00037320: 6f76 6964 652e 0a0a 2020 2020 2020 2020  ovide...        
-00037330: 332e 2042 7920 6465 6661 756c 742c 2073  3. By default, s
-00037340: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
-00037350: 7265 6769 7374 7261 7469 6f6e 2066 6169  registration fai
-00037360: 6c73 2069 6620 6120 6675 6e63 7469 6f6e  ls if a function
-00037370: 2077 6974 6820 7468 6520 7361 6d65 206e   with the same n
-00037380: 616d 6520 6973 2061 6c72 6561 6479 0a20  ame is already. 
-00037390: 2020 2020 2020 2072 6567 6973 7465 7265         registere
-000373a0: 642e 2049 6e76 6f6b 696e 6720 3a66 756e  d. Invoking :fun
-000373b0: 633a 6073 7072 6f63 6020 7769 7468 2060  c:`sproc` with `
-000373c0: 6072 6570 6c61 6365 6060 2073 6574 2074  `replace`` set t
-000373d0: 6f20 6060 5472 7565 6060 2077 696c 6c20  o ``True`` will 
-000373e0: 6f76 6572 7772 6974 6520 7468 650a 2020  overwrite the.  
-000373f0: 2020 2020 2020 7072 6576 696f 7573 6c79        previously
-00037400: 2072 6567 6973 7465 7265 6420 6675 6e63   registered func
-00037410: 7469 6f6e 2e0a 0a20 2020 2053 6565 2041  tion...    See A
-00037420: 6c73 6f3a 0a20 2020 2020 2020 203a 636c  lso:.        :cl
-00037430: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
-00037440: 736e 6f77 7061 726b 2e73 746f 7265 645f  snowpark.stored_
-00037450: 7072 6f63 6564 7572 652e 5374 6f72 6564  procedure.Stored
-00037460: 5072 6f63 6564 7572 6552 6567 6973 7472  ProcedureRegistr
-00037470: 6174 696f 6e60 0a20 2020 2022 2222 0a20  ation`.    """. 
-00037480: 2020 2073 6573 7369 6f6e 203d 2073 6573     session = ses
-00037490: 7369 6f6e 206f 7220 736e 6f77 666c 616b  sion or snowflak
-000374a0: 652e 736e 6f77 7061 726b 2e73 6573 7369  e.snowpark.sessi
-000374b0: 6f6e 2e5f 6765 745f 6163 7469 7665 5f73  on._get_active_s
-000374c0: 6573 7369 6f6e 2829 0a20 2020 2069 6620  ession().    if 
-000374d0: 6675 6e63 2069 7320 4e6f 6e65 3a0a 2020  func is None:.  
-000374e0: 2020 2020 2020 7265 7475 726e 2066 756e        return fun
-000374f0: 6374 6f6f 6c73 2e70 6172 7469 616c 280a  ctools.partial(.
-00037500: 2020 2020 2020 2020 2020 2020 7365 7373              sess
-00037510: 696f 6e2e 7370 726f 632e 7265 6769 7374  ion.sproc.regist
-00037520: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-00037530: 7265 7475 726e 5f74 7970 653d 7265 7475  return_type=retu
-00037540: 726e 5f74 7970 652c 0a20 2020 2020 2020  rn_type,.       
-00037550: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
-00037560: 3d69 6e70 7574 5f74 7970 6573 2c0a 2020  =input_types,.  
-00037570: 2020 2020 2020 2020 2020 6e61 6d65 3d6e            name=n
-00037580: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00037590: 2069 735f 7065 726d 616e 656e 743d 6973   is_permanent=is
-000375a0: 5f70 6572 6d61 6e65 6e74 2c0a 2020 2020  _permanent,.    
-000375b0: 2020 2020 2020 2020 7374 6167 655f 6c6f          stage_lo
-000375c0: 6361 7469 6f6e 3d73 7461 6765 5f6c 6f63  cation=stage_loc
-000375d0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-000375e0: 2020 2069 6d70 6f72 7473 3d69 6d70 6f72     imports=impor
-000375f0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-00037600: 7061 636b 6167 6573 3d70 6163 6b61 6765  packages=package
-00037610: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
-00037620: 6570 6c61 6365 3d72 6570 6c61 6365 2c0a  eplace=replace,.
-00037630: 2020 2020 2020 2020 2020 2020 6966 5f6e              if_n
-00037640: 6f74 5f65 7869 7374 733d 6966 5f6e 6f74  ot_exists=if_not
-00037650: 5f65 7869 7374 732c 0a20 2020 2020 2020  _exists,.       
-00037660: 2020 2020 2070 6172 616c 6c65 6c3d 7061       parallel=pa
-00037670: 7261 6c6c 656c 2c0a 2020 2020 2020 2020  rallel,.        
-00037680: 2020 2020 7374 6174 656d 656e 745f 7061      statement_pa
-00037690: 7261 6d73 3d73 7461 7465 6d65 6e74 5f70  rams=statement_p
-000376a0: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
-000376b0: 2020 2065 7865 6375 7465 5f61 733d 6578     execute_as=ex
-000376c0: 6563 7574 655f 6173 2c0a 2020 2020 2020  ecute_as,.      
-000376d0: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
-000376e0: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
-000376f0: 2073 6f75 7263 655f 636f 6465 5f64 6973   source_code_dis
-00037700: 706c 6179 3d73 6f75 7263 655f 636f 6465  play=source_code
-00037710: 5f64 6973 706c 6179 2c0a 2020 2020 2020  _display,.      
-00037720: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
-00037730: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
-00037740: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
-00037750: 726e 2073 6573 7369 6f6e 2e73 7072 6f63  rn session.sproc
-00037760: 2e72 6567 6973 7465 7228 0a20 2020 2020  .register(.     
-00037770: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-00037780: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-00037790: 7479 7065 3d72 6574 7572 6e5f 7479 7065  type=return_type
-000377a0: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-000377b0: 7075 745f 7479 7065 733d 696e 7075 745f  put_types=input_
-000377c0: 7479 7065 732c 0a20 2020 2020 2020 2020  types,.         
-000377d0: 2020 206e 616d 653d 6e61 6d65 2c0a 2020     name=name,.  
-000377e0: 2020 2020 2020 2020 2020 6973 5f70 6572            is_per
-000377f0: 6d61 6e65 6e74 3d69 735f 7065 726d 616e  manent=is_perman
-00037800: 656e 742c 0a20 2020 2020 2020 2020 2020  ent,.           
-00037810: 2073 7461 6765 5f6c 6f63 6174 696f 6e3d   stage_location=
-00037820: 7374 6167 655f 6c6f 6361 7469 6f6e 2c0a  stage_location,.
-00037830: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00037840: 7274 733d 696d 706f 7274 732c 0a20 2020  rts=imports,.   
-00037850: 2020 2020 2020 2020 2070 6163 6b61 6765           package
-00037860: 733d 7061 636b 6167 6573 2c0a 2020 2020  s=packages,.    
-00037870: 2020 2020 2020 2020 7265 706c 6163 653d          replace=
-00037880: 7265 706c 6163 652c 0a20 2020 2020 2020  replace,.       
-00037890: 2020 2020 2069 665f 6e6f 745f 6578 6973       if_not_exis
-000378a0: 7473 3d69 665f 6e6f 745f 6578 6973 7473  ts=if_not_exists
-000378b0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-000378c0: 7261 6c6c 656c 3d70 6172 616c 6c65 6c2c  rallel=parallel,
-000378d0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-000378e0: 7465 6d65 6e74 5f70 6172 616d 733d 7374  tement_params=st
-000378f0: 6174 656d 656e 745f 7061 7261 6d73 2c0a  atement_params,.
-00037900: 2020 2020 2020 2020 2020 2020 6578 6563              exec
-00037910: 7574 655f 6173 3d65 7865 6375 7465 5f61  ute_as=execute_a
-00037920: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-00037930: 7472 6963 743d 7374 7269 6374 2c0a 2020  trict=strict,.  
-00037940: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00037950: 5f63 6f64 655f 6469 7370 6c61 793d 736f  _code_display=so
-00037960: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-00037970: 792c 0a20 2020 2020 2020 2020 2020 202a  y,.            *
-00037980: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-00037990: 2029 0a0a 0a23 2041 6464 2074 6865 7365   )...# Add these
-000379a0: 2061 6c69 6173 2066 6f72 2075 7365 7220   alias for user 
-000379b0: 636f 6465 206d 6967 7261 7469 6f6e 0a63  code migration.c
-000379c0: 616c 6c5f 6275 696c 7469 6e20 3d20 6361  all_builtin = ca
-000379d0: 6c6c 5f66 756e 6374 696f 6e0a 6275 696c  ll_function.buil
-000379e0: 7469 6e20 3d20 6675 6e63 7469 6f6e 0a63  tin = function.c
-000379f0: 6f75 6e74 4469 7374 696e 6374 203d 2063  ountDistinct = c
-00037a00: 6f75 6e74 5f64 6973 7469 6e63 740a 7375  ount_distinct.su
-00037a10: 6273 7472 203d 2073 7562 7374 7269 6e67  bstr = substring
-00037a20: 0a74 6f5f 7661 7263 6861 7220 3d20 746f  .to_varchar = to
-00037a30: 5f63 6861 720a 6578 7072 203d 2073 716c  _char.expr = sql
-00037a40: 5f65 7870 720a 6461 7465 5f66 6f72 6d61  _expr.date_forma
-00037a50: 7420 3d20 746f 5f64 6174 650a 6d6f 6e6f  t = to_date.mono
-00037a60: 746f 6e69 6361 6c6c 795f 696e 6372 6561  tonically_increa
-00037a70: 7369 6e67 5f69 6420 3d20 7365 7138 0a66  sing_id = seq8.f
-00037a80: 726f 6d5f 756e 6978 7469 6d65 203d 2074  rom_unixtime = t
-00037a90: 6f5f 7469 6d65 7374 616d 700a 0a0a 6465  o_timestamp...de
-00037aa0: 6620 756e 6978 5f74 696d 6573 7461 6d70  f unix_timestamp
-00037ab0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00037ac0: 2c20 666d 743a 204f 7074 696f 6e61 6c5b  , fmt: Optional[
-00037ad0: 2243 6f6c 756d 6e22 5d20 3d20 4e6f 6e65  "Column"] = None
-00037ae0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00037af0: 2022 2222 0a20 2020 2043 6f6e 7665 7274   """.    Convert
-00037b00: 7320 6120 7469 6d65 7374 616d 7020 6f72  s a timestamp or
-00037b10: 2061 2074 696d 6573 7461 6d70 2073 7472   a timestamp str
-00037b20: 696e 6720 746f 2055 6e69 7820 7469 6d65  ing to Unix time
-00037b30: 2073 7461 6d70 2028 696e 2073 6563 6f6e   stamp (in secon
-00037b40: 6473 292e 0a0a 2020 2020 4578 616d 706c  ds)...    Exampl
-00037b50: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-00037b60: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-00037b70: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00037b80: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00037b90: 5f64 6174 6166 7261 6d65 285b 5b22 3230  _dataframe([["20
-00037ba0: 3133 2d30 352d 3038 5432 333a 3339 3a32  13-05-08T23:39:2
-00037bb0: 302e 3132 332d 3037 3a30 3022 5d5d 2c20  0.123-07:00"]], 
-00037bc0: 7363 6865 6d61 3d5b 2274 735f 636f 6c22  schema=["ts_col"
-00037bd0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00037be0: 662e 7365 6c65 6374 2875 6e69 785f 7469  f.select(unix_ti
-00037bf0: 6d65 7374 616d 7028 636f 6c28 2274 735f  mestamp(col("ts_
-00037c00: 636f 6c22 2929 2e61 6c69 6173 2822 756e  col")).alias("un
-00037c10: 6978 5f74 696d 6522 2929 2e73 686f 7728  ix_time")).show(
-00037c20: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00037c30: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00037c40: 2020 7c22 554e 4958 5f54 494d 4522 2020    |"UNIX_TIME"  
-00037c50: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00037c60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00037c70: 2020 7c31 3336 3830 3536 3336 3020 2020    |1368056360   
-00037c80: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00037c90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00037ca0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00037cb0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00037cc0: 2064 6174 655f 7061 7274 2822 6570 6f63   date_part("epoc
-00037cd0: 685f 7365 636f 6e64 222c 2074 6f5f 7469  h_second", to_ti
-00037ce0: 6d65 7374 616d 7028 652c 2066 6d74 2929  mestamp(e, fmt))
-00037cf0: 0a                                       .
+0002bb00: 5f64 6174 6166 7261 6d65 285b 312c 2032  _dataframe([1, 2
+0002bb10: 2c20 332c 204e 6f6e 652c 204e 6f6e 655d  , 3, None, None]
+0002bb20: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0002bb30: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002bb40: 6f72 7428 6465 7363 5f6e 756c 6c73 5f6c  ort(desc_nulls_l
+0002bb50: 6173 7428 6466 5b22 6122 5d29 292e 636f  ast(df["a"])).co
+0002bb60: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0002bb70: 5b52 6f77 2841 3d33 292c 2052 6f77 2841  [Row(A=3), Row(A
+0002bb80: 3d32 292c 2052 6f77 2841 3d31 292c 2052  =2), Row(A=1), R
+0002bb90: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
+0002bba0: 413d 4e6f 6e65 295d 0a20 2020 2022 2222  A=None)].    """
+0002bbb0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002bbc0: 5f69 665f 7374 7228 632c 2022 6465 7363  _if_str(c, "desc
+0002bbd0: 5f6e 756c 6c73 5f6c 6173 7422 290a 2020  _nulls_last").  
+0002bbe0: 2020 7265 7475 726e 2063 2e64 6573 635f    return c.desc_
+0002bbf0: 6e75 6c6c 735f 6c61 7374 2829 0a0a 0a64  nulls_last()...d
+0002bc00: 6566 2061 735f 6172 7261 7928 7661 7269  ef as_array(vari
+0002bc10: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
+0002bc20: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0002bc30: 2020 2222 2243 6173 7473 2061 2056 4152    """Casts a VAR
+0002bc40: 4941 4e54 2076 616c 7565 2074 6f20 616e  IANT value to an
+0002bc50: 2061 7272 6179 2e0a 0a20 2020 2045 7861   array...    Exa
+0002bc60: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+0002bc70: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002bc80: 7371 6c28 2273 656c 6563 7420 6172 7261  sql("select arra
+0002bc90: 795f 636f 6e73 7472 7563 7428 312c 2032  y_construct(1, 2
+0002bca0: 293a 3a76 6172 6961 6e74 2061 7320 6122  )::variant as a"
+0002bcb0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002bcc0: 2e73 656c 6563 7428 6173 5f61 7272 6179  .select(as_array
+0002bcd0: 2822 6122 292e 616c 6961 7328 2272 6573  ("a").alias("res
+0002bce0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0002bcf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0002bd00: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0002bd10: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+0002bd20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002bd30: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
+0002bd40: 7c0a 2020 2020 2020 2020 7c20 2031 2c20  |.        |  1, 
+0002bd50: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0002bd60: 2020 3220 2020 2020 2020 7c0a 2020 2020    2       |.    
+0002bd70: 2020 2020 7c5d 2020 2020 2020 2020 207c      |]         |
+0002bd80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002bd90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0002bda0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0002bdb0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0002bdc0: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
+0002bdd0: 2c20 2261 735f 6172 7261 7922 290a 2020  , "as_array").  
+0002bde0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0002bdf0: 2822 6173 5f61 7272 6179 2229 2863 290a  ("as_array")(c).
+0002be00: 0a0a 6465 6620 6173 5f62 696e 6172 7928  ..def as_binary(
+0002be10: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
+0002be20: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002be30: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
+0002be40: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
+0002be50: 6f20 6120 6269 6e61 7279 2073 7472 696e  o a binary strin
+0002be60: 672e 0a0a 2020 2020 4578 616d 706c 653a  g...    Example:
+0002be70: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0002be80: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+0002be90: 7365 6c65 6374 2074 6f5f 6269 6e61 7279  select to_binary
+0002bea0: 2827 4630 4135 2729 3a3a 7661 7269 616e  ('F0A5')::varian
+0002beb0: 7420 6173 2061 2229 0a20 2020 2020 2020  t as a").       
+0002bec0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+0002bed0: 735f 6269 6e61 7279 2822 6122 292e 616c  s_binary("a").al
+0002bee0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+0002bef0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0002bf00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002bf10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002bf20: 207c 2252 4553 554c 5422 2020 2020 2020   |"RESULT"      
+0002bf30: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002bf40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002bf50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002bf60: 2020 2020 2020 207c 6279 7465 6172 7261         |bytearra
+0002bf70: 7928 6227 5c78 6630 5c78 6135 2729 2020  y(b'\xf0\xa5')  
+0002bf80: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002bf90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002bfa0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0002bfb0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0002bfc0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002bfd0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
+0002bfe0: 2022 6173 5f62 696e 6172 7922 290a 2020   "as_binary").  
+0002bff0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0002c000: 2822 6173 5f62 696e 6172 7922 2928 6329  ("as_binary")(c)
+0002c010: 0a0a 0a64 6566 2061 735f 6368 6172 2876  ...def as_char(v
+0002c020: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002c030: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002c040: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
+0002c050: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002c060: 2061 2073 7472 696e 672e 0a0a 2020 2020   a string...    
+0002c070: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0002c080: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0002c090: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0002c0a0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0002c0b0: 6173 5f63 6861 722c 2074 6f5f 7661 7269  as_char, to_vari
+0002c0c0: 616e 740a 2020 2020 2020 2020 3e3e 3e20  ant.        >>> 
+0002c0d0: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
+0002c0e0: 2822 7365 6c65 6374 2027 736f 6d65 2073  ("select 'some s
+0002c0f0: 7472 696e 6727 2061 7320 6368 6172 2229  tring' as char")
+0002c100: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002c110: 6368 6172 5f76 203d 2074 6f5f 7661 7269  char_v = to_vari
+0002c120: 616e 7428 6466 2e63 6861 7229 0a20 2020  ant(df.char).   
+0002c130: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002c140: 6374 2864 662e 6368 6172 5f76 2e61 735f  ct(df.char_v.as_
+0002c150: 2822 6368 6172 2229 292e 636f 6c6c 6563  ("char")).collec
+0002c160: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
+0002c170: 2864 662e 6368 6172 292e 636f 6c6c 6563  (df.char).collec
+0002c180: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
+0002c190: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0002c1a0: 2e73 656c 6563 7428 6173 5f63 6861 7228  .select(as_char(
+0002c1b0: 6466 2e63 6861 725f 7629 2e61 735f 2822  df.char_v).as_("
+0002c1c0: 6368 6172 2229 292e 636f 6c6c 6563 7428  char")).collect(
+0002c1d0: 2920 3d3d 2064 662e 7365 6c65 6374 2864  ) == df.select(d
+0002c1e0: 662e 6368 6172 292e 636f 6c6c 6563 7428  f.char).collect(
+0002c1f0: 290a 2020 2020 2020 2020 5472 7565 0a20  ).        True. 
+0002c200: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0002c210: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
+0002c220: 7269 616e 742c 2022 6173 5f63 6861 7222  riant, "as_char"
+0002c230: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0002c240: 6c74 696e 2822 6173 5f63 6861 7222 2928  ltin("as_char")(
+0002c250: 6329 0a0a 0a64 6566 2061 735f 7661 7263  c)...def as_varc
+0002c260: 6861 7228 7661 7269 616e 743a 2043 6f6c  har(variant: Col
+0002c270: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+0002c280: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
+0002c290: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
+0002c2a0: 7565 2074 6f20 6120 7374 7269 6e67 2e0a  ue to a string..
+0002c2b0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0002c2c0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0002c2d0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0002c2e0: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
+0002c2f0: 706f 7274 2061 735f 7661 7263 6861 722c  port as_varchar,
+0002c300: 2074 6f5f 7661 7269 616e 740a 2020 2020   to_variant.    
+0002c310: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0002c320: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
+0002c330: 2027 736f 6d65 2073 7472 696e 6727 2061   'some string' a
+0002c340: 7320 6368 6172 2229 0a20 2020 2020 2020  s char").       
+0002c350: 203e 3e3e 2064 662e 6368 6172 5f76 203d   >>> df.char_v =
+0002c360: 2074 6f5f 7661 7269 616e 7428 6466 2e63   to_variant(df.c
+0002c370: 6861 7229 0a20 2020 2020 2020 203e 3e3e  har).        >>>
+0002c380: 2064 662e 7365 6c65 6374 2864 662e 6368   df.select(df.ch
+0002c390: 6172 5f76 2e61 735f 2822 6368 6172 2229  ar_v.as_("char")
+0002c3a0: 292e 636f 6c6c 6563 7428 2920 3d3d 2064  ).collect() == d
+0002c3b0: 662e 7365 6c65 6374 2864 662e 6368 6172  f.select(df.char
+0002c3c0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0002c3d0: 2020 2020 4661 6c73 650a 2020 2020 2020      False.      
+0002c3e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002c3f0: 6173 5f76 6172 6368 6172 2864 662e 6368  as_varchar(df.ch
+0002c400: 6172 5f76 292e 6173 5f28 2263 6861 7222  ar_v).as_("char"
+0002c410: 2929 2e63 6f6c 6c65 6374 2829 203d 3d20  )).collect() == 
+0002c420: 6466 2e73 656c 6563 7428 6466 2e63 6861  df.select(df.cha
+0002c430: 7229 2e63 6f6c 6c65 6374 2829 0a20 2020  r).collect().   
+0002c440: 2020 2020 2054 7275 650a 2020 2020 2222       True.    ""
+0002c450: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0002c460: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
+0002c470: 2c20 2261 735f 7661 7263 6861 7222 290a  , "as_varchar").
+0002c480: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0002c490: 696e 2822 6173 5f76 6172 6368 6172 2229  in("as_varchar")
+0002c4a0: 2863 290a 0a0a 6465 6620 6173 5f64 6174  (c)...def as_dat
+0002c4b0: 6528 7661 7269 616e 743a 2043 6f6c 756d  e(variant: Colum
+0002c4c0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002c4d0: 6d6e 3a0a 2020 2020 2222 2243 6173 7473  mn:.    """Casts
+0002c4e0: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
+0002c4f0: 2074 6f20 6120 6461 7465 2e0a 0a20 2020   to a date...   
+0002c500: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0002c510: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0002c520: 696f 6e2e 7371 6c28 2273 656c 6563 7420  ion.sql("select 
+0002c530: 6461 7465 2732 3032 302d 312d 3127 3a3a  date'2020-1-1'::
+0002c540: 7661 7269 616e 7420 6173 2061 2229 0a20  variant as a"). 
+0002c550: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002c560: 6c65 6374 2861 735f 6461 7465 2822 6122  lect(as_date("a"
+0002c570: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+0002c580: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0002c590: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0002c5a0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+0002c5b0: 5422 2020 2020 7c0a 2020 2020 2020 2020  T"    |.        
+0002c5c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002c5d0: 2020 2020 2020 207c 3230 3230 2d30 312d         |2020-01-
+0002c5e0: 3031 2020 7c0a 2020 2020 2020 2020 2d2d  01  |.        --
+0002c5f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002c600: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0002c610: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0002c620: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002c630: 7661 7269 616e 742c 2022 6173 5f64 6174  variant, "as_dat
+0002c640: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
+0002c650: 7569 6c74 696e 2822 6173 5f64 6174 6522  uiltin("as_date"
+0002c660: 2928 6329 0a0a 0a64 6566 2063 6173 7428  )(c)...def cast(
+0002c670: 636f 6c75 6d6e 3a20 436f 6c75 6d6e 4f72  column: ColumnOr
+0002c680: 4e61 6d65 2c20 746f 3a20 556e 696f 6e5b  Name, to: Union[
+0002c690: 7374 722c 2044 6174 6154 7970 655d 2920  str, DataType]) 
+0002c6a0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0002c6b0: 2222 436f 6e76 6572 7473 2061 2076 616c  ""Converts a val
+0002c6c0: 7565 206f 6620 6f6e 6520 6461 7461 2074  ue of one data t
+0002c6d0: 7970 6520 696e 746f 2061 6e6f 7468 6572  ype into another
+0002c6e0: 2064 6174 6120 7479 7065 2e0a 2020 2020   data type..    
+0002c6f0: 5468 6520 7365 6d61 6e74 6963 7320 6f66  The semantics of
+0002c700: 2043 4153 5420 6172 6520 7468 6520 7361   CAST are the sa
+0002c710: 6d65 2061 7320 7468 6520 7365 6d61 6e74  me as the semant
+0002c720: 6963 7320 6f66 2074 6865 2063 6f72 7265  ics of the corre
+0002c730: 7370 6f6e 6469 6e67 2074 6f20 6461 7461  sponding to data
+0002c740: 7479 7065 2063 6f6e 7665 7273 696f 6e20  type conversion 
+0002c750: 6675 6e63 7469 6f6e 732e 0a20 2020 2049  functions..    I
+0002c760: 6620 7468 6520 6361 7374 2069 7320 6e6f  f the cast is no
+0002c770: 7420 706f 7373 6962 6c65 2c20 6120 6060  t possible, a ``
+0002c780: 536e 6f77 7061 726b 5351 4c45 7863 6570  SnowparkSQLExcep
+0002c790: 7469 6f6e 6060 2065 7863 6570 7469 6f6e  tion`` exception
+0002c7a0: 2069 7320 7468 726f 776e 2e0a 0a20 2020   is thrown...   
+0002c7b0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0002c7c0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0002c7d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0002c7e0: 7479 7065 7320 696d 706f 7274 2044 6563  types import Dec
+0002c7f0: 696d 616c 5479 7065 2c20 496e 7465 6765  imalType, Intege
+0002c800: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
+0002c810: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0002c820: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0002c830: 5b5b 312e 3534 3332 5d5d 2c20 7363 6865  [[1.5432]], sche
+0002c840: 6d61 3d5b 2264 225d 290a 2020 2020 2020  ma=["d"]).      
+0002c850: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002c860: 6361 7374 2864 662e 642c 2044 6563 696d  cast(df.d, Decim
+0002c870: 616c 5479 7065 2831 352c 2032 2929 2e61  alType(15, 2)).a
+0002c880: 735f 2822 4445 4349 4d41 4c22 292c 2063  s_("DECIMAL"), c
+0002c890: 6173 7428 6466 2e64 2c20 496e 7465 6765  ast(df.d, Intege
+0002c8a0: 7254 7970 6528 2929 2e61 735f 2822 494e  rType()).as_("IN
+0002c8b0: 5422 2929 2e73 686f 7728 290a 2020 2020  T")).show().    
+0002c8c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002c8d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002c8e0: 2020 7c22 4445 4349 4d41 4c22 2020 7c22    |"DECIMAL"  |"
+0002c8f0: 494e 5422 2020 7c0a 2020 2020 2020 2020  INT"  |.        
+0002c900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c910: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+0002c920: 2e35 3420 2020 2020 2020 7c32 2020 2020  .54       |2    
+0002c930: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002c940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c950: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0002c960: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0002c970: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0002c980: 5f73 7472 2863 6f6c 756d 6e2c 2022 6361  _str(column, "ca
+0002c990: 7374 2229 0a20 2020 2072 6574 7572 6e20  st").    return 
+0002c9a0: 632e 6361 7374 2874 6f29 0a0a 0a64 6566  c.cast(to)...def
+0002c9b0: 2074 7279 5f63 6173 7428 636f 6c75 6d6e   try_cast(column
+0002c9c0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+0002c9d0: 746f 3a20 556e 696f 6e5b 7374 722c 2044  to: Union[str, D
+0002c9e0: 6174 6154 7970 655d 2920 2d3e 2043 6f6c  ataType]) -> Col
+0002c9f0: 756d 6e3a 0a20 2020 2022 2222 4120 7370  umn:.    """A sp
+0002ca00: 6563 6961 6c20 7665 7273 696f 6e20 6f66  ecial version of
+0002ca10: 2043 4153 5420 666f 7220 6120 7375 6273   CAST for a subs
+0002ca20: 6574 206f 6620 6461 7461 2074 7970 6520  et of data type 
+0002ca30: 636f 6e76 6572 7369 6f6e 732e 0a20 2020  conversions..   
+0002ca40: 2049 7420 7065 7266 6f72 6d73 2074 6865   It performs the
+0002ca50: 2073 616d 6520 6f70 6572 6174 696f 6e20   same operation 
+0002ca60: 2869 2e65 2e20 636f 6e76 6572 7473 2061  (i.e. converts a
+0002ca70: 2076 616c 7565 206f 6620 6f6e 6520 6461   value of one da
+0002ca80: 7461 2074 7970 6520 696e 746f 2061 6e6f  ta type into ano
+0002ca90: 7468 6572 2064 6174 6120 7479 7065 292c  ther data type),
+0002caa0: 0a20 2020 2062 7574 2072 6574 7572 6e73  .    but returns
+0002cab0: 2061 204e 554c 4c20 7661 6c75 6520 696e   a NULL value in
+0002cac0: 7374 6561 6420 6f66 2072 6169 7369 6e67  stead of raising
+0002cad0: 2061 6e20 6572 726f 7220 7768 656e 2074   an error when t
+0002cae0: 6865 2063 6f6e 7665 7273 696f 6e20 6361  he conversion ca
+0002caf0: 6e20 6e6f 7420 6265 2070 6572 666f 726d  n not be perform
+0002cb00: 6564 2e0a 0a20 2020 2054 6865 2060 6063  ed...    The ``c
+0002cb10: 6f6c 756d 6e60 6020 6172 6775 6d65 6e74  olumn`` argument
+0002cb20: 206d 7573 7420 6265 2061 2073 7472 696e   must be a strin
+0002cb30: 6720 636f 6c75 6d6e 2069 6e20 536e 6f77  g column in Snow
+0002cb40: 666c 616b 652e 0a0a 2020 2020 4578 616d  flake...    Exam
+0002cb50: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+0002cb60: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0002cb70: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0002cb80: 2069 6d70 6f72 7420 496e 7465 6765 7254   import IntegerT
+0002cb90: 7970 652c 2046 6c6f 6174 5479 7065 0a20  ype, FloatType. 
+0002cba0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0002cbb0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0002cbc0: 6174 6166 7261 6d65 285b 2730 272c 2027  ataframe(['0', '
+0002cbd0: 2d31 3227 2c20 2732 3227 2c20 2731 3030  -12', '22', '100
+0002cbe0: 3127 5d2c 2073 6368 656d 613d 5b22 6122  1'], schema=["a"
+0002cbf0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0002cc00: 662e 7365 6c65 6374 2874 7279 5f63 6173  f.select(try_cas
+0002cc10: 7428 636f 6c28 2261 2229 2c20 496e 7465  t(col("a"), Inte
+0002cc20: 6765 7254 7970 6528 2929 2e61 735f 2827  gerType()).as_('
+0002cc30: 616e 7327 2929 2e63 6f6c 6c65 6374 2829  ans')).collect()
+0002cc40: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
+0002cc50: 533d 3029 2c20 526f 7728 414e 533d 2d31  S=0), Row(ANS=-1
+0002cc60: 3229 2c20 526f 7728 414e 533d 3232 292c  2), Row(ANS=22),
+0002cc70: 2052 6f77 2841 4e53 3d31 3030 3129 5d0a   Row(ANS=1001)].
+0002cc80: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0002cc90: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0002cca0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0002ccb0: 6461 7461 6672 616d 6528 5b27 302e 3132  dataframe(['0.12
+0002ccc0: 272c 2027 5553 4420 3237 2e39 3027 2c20  ', 'USD 27.90', 
+0002ccd0: 2731 332e 3937 2055 5344 272c 2027 e282  '13.97 USD', '..
+0002cce0: ac39 372e 3027 2c20 2731 372c 2d27 5d2c  .97.0', '17,-'],
+0002ccf0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0002cd00: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002cd10: 6c65 6374 2874 7279 5f63 6173 7428 636f  lect(try_cast(co
+0002cd20: 6c28 2261 2229 2c20 466c 6f61 7454 7970  l("a"), FloatTyp
+0002cd30: 6528 2929 2e61 735f 2827 616e 7327 2929  e()).as_('ans'))
+0002cd40: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0002cd50: 2020 205b 526f 7728 414e 533d 302e 3132     [Row(ANS=0.12
+0002cd60: 292c 2052 6f77 2841 4e53 3d4e 6f6e 6529  ), Row(ANS=None)
+0002cd70: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
+0002cd80: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+0002cd90: 526f 7728 414e 533d 4e6f 6e65 295d 0a0a  Row(ANS=None)]..
+0002cda0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0002cdb0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+0002cdc0: 6f6c 756d 6e2c 2022 7472 795f 6361 7374  olumn, "try_cast
+0002cdd0: 2229 0a20 2020 2072 6574 7572 6e20 632e  ").    return c.
+0002cde0: 7472 795f 6361 7374 2874 6f29 0a0a 0a64  try_cast(to)...d
+0002cdf0: 6566 205f 6173 5f64 6563 696d 616c 5f6f  ef _as_decimal_o
+0002ce00: 725f 6e75 6d62 6572 280a 2020 2020 6361  r_number(.    ca
+0002ce10: 7374 5f74 7970 653a 2073 7472 2c0a 2020  st_type: str,.  
+0002ce20: 2020 7661 7269 616e 743a 2043 6f6c 756d    variant: Colum
+0002ce30: 6e4f 724e 616d 652c 0a20 2020 2070 7265  nOrName,.    pre
+0002ce40: 6369 7369 6f6e 3a20 4f70 7469 6f6e 616c  cision: Optional
+0002ce50: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+0002ce60: 2020 7363 616c 653a 204f 7074 696f 6e61    scale: Optiona
+0002ce70: 6c5b 696e 745d 203d 204e 6f6e 652c 0a29  l[int] = None,.)
+0002ce80: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0002ce90: 2222 2248 656c 7065 7220 6675 6e63 7469  """Helper functi
+0002cea0: 6f6e 2074 6861 7420 6361 7374 7320 6120  on that casts a 
+0002ceb0: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002cec0: 2061 2064 6563 696d 616c 206f 7220 6e75   a decimal or nu
+0002ced0: 6d62 6572 2e22 2222 0a20 2020 2063 203d  mber.""".    c =
+0002cee0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002cef0: 7661 7269 616e 742c 2063 6173 745f 7479  variant, cast_ty
+0002cf00: 7065 290a 2020 2020 6966 2073 6361 6c65  pe).    if scale
+0002cf10: 2061 6e64 206e 6f74 2070 7265 6369 7369   and not precisi
+0002cf20: 6f6e 3a0a 2020 2020 2020 2020 7261 6973  on:.        rais
+0002cf30: 6520 5661 6c75 6545 7272 6f72 2822 4361  e ValueError("Ca
+0002cf40: 6e6e 6f74 2064 6566 696e 6520 7363 616c  nnot define scal
+0002cf50: 6520 7769 7468 6f75 7420 7072 6563 6973  e without precis
+0002cf60: 696f 6e22 290a 2020 2020 6966 2070 7265  ion").    if pre
+0002cf70: 6369 7369 6f6e 2061 6e64 2073 6361 6c65  cision and scale
+0002cf80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0002cf90: 2062 7569 6c74 696e 2863 6173 745f 7479   builtin(cast_ty
+0002cfa0: 7065 2928 632c 206c 6974 2870 7265 6369  pe)(c, lit(preci
+0002cfb0: 7369 6f6e 292c 206c 6974 2873 6361 6c65  sion), lit(scale
+0002cfc0: 2929 0a20 2020 2065 6c69 6620 7072 6563  )).    elif prec
+0002cfd0: 6973 696f 6e3a 0a20 2020 2020 2020 2072  ision:.        r
+0002cfe0: 6574 7572 6e20 6275 696c 7469 6e28 6361  eturn builtin(ca
+0002cff0: 7374 5f74 7970 6529 2863 2c20 6c69 7428  st_type)(c, lit(
+0002d000: 7072 6563 6973 696f 6e29 290a 2020 2020  precision)).    
+0002d010: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+0002d020: 7475 726e 2062 7569 6c74 696e 2863 6173  turn builtin(cas
+0002d030: 745f 7479 7065 2928 6329 0a0a 0a64 6566  t_type)(c)...def
+0002d040: 2061 735f 6465 6369 6d61 6c28 0a20 2020   as_decimal(.   
+0002d050: 2076 6172 6961 6e74 3a20 436f 6c75 6d6e   variant: Column
+0002d060: 4f72 4e61 6d65 2c0a 2020 2020 7072 6563  OrName,.    prec
+0002d070: 6973 696f 6e3a 204f 7074 696f 6e61 6c5b  ision: Optional[
+0002d080: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+0002d090: 2073 6361 6c65 3a20 4f70 7469 6f6e 616c   scale: Optional
+0002d0a0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2920  [int] = None,.) 
+0002d0b0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0002d0c0: 2222 4361 7374 7320 6120 5641 5249 414e  ""Casts a VARIAN
+0002d0d0: 5420 7661 6c75 6520 746f 2061 2066 6978  T value to a fix
+0002d0e0: 6564 2d70 6f69 6e74 2064 6563 696d 616c  ed-point decimal
+0002d0f0: 2028 646f 6573 206e 6f74 206d 6174 6368   (does not match
+0002d100: 2066 6c6f 6174 696e 672d 706f 696e 7420   floating-point 
+0002d110: 7661 6c75 6573 292e 0a0a 2020 2020 4578  values)...    Ex
+0002d120: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0002d130: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002d140: 2e73 716c 2822 7365 6c65 6374 2031 2e32  .sql("select 1.2
+0002d150: 3334 353a 3a76 6172 6961 6e74 2061 7320  345::variant as 
+0002d160: 6122 290a 2020 2020 2020 2020 3e3e 3e20  a").        >>> 
+0002d170: 6466 2e73 656c 6563 7428 6173 5f64 6563  df.select(as_dec
+0002d180: 696d 616c 2822 6122 2c20 342c 2031 292e  imal("a", 4, 1).
+0002d190: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+0002d1a0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0002d1b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002d1c0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+0002d1d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002d1e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0002d1f0: 312e 3220 2020 2020 2020 7c0a 2020 2020  1.2       |.    
+0002d200: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002d210: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0002d220: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0002d230: 2072 6574 7572 6e20 5f61 735f 6465 6369   return _as_deci
+0002d240: 6d61 6c5f 6f72 5f6e 756d 6265 7228 2261  mal_or_number("a
+0002d250: 735f 6465 6369 6d61 6c22 2c20 7661 7269  s_decimal", vari
+0002d260: 616e 742c 2070 7265 6369 7369 6f6e 2c20  ant, precision, 
+0002d270: 7363 616c 6529 0a0a 0a64 6566 2061 735f  scale)...def as_
+0002d280: 6e75 6d62 6572 280a 2020 2020 7661 7269  number(.    vari
+0002d290: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
+0002d2a0: 652c 0a20 2020 2070 7265 6369 7369 6f6e  e,.    precision
+0002d2b0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+0002d2c0: 3d20 4e6f 6e65 2c0a 2020 2020 7363 616c  = None,.    scal
+0002d2d0: 653a 204f 7074 696f 6e61 6c5b 696e 745d  e: Optional[int]
+0002d2e0: 203d 204e 6f6e 652c 0a29 202d 3e20 436f   = None,.) -> Co
+0002d2f0: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
+0002d300: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
+0002d310: 7565 2074 6f20 6120 6669 7865 642d 706f  ue to a fixed-po
+0002d320: 696e 7420 6465 6369 6d61 6c20 2864 6f65  int decimal (doe
+0002d330: 7320 6e6f 7420 6d61 7463 6820 666c 6f61  s not match floa
+0002d340: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
+0002d350: 7329 2e0a 0a20 2020 2045 7861 6d70 6c65  s)...    Example
+0002d360: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+0002d370: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
+0002d380: 2273 656c 6563 7420 312e 3233 3435 3a3a  "select 1.2345::
+0002d390: 7661 7269 616e 7420 6173 2061 2229 0a20  variant as a"). 
+0002d3a0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002d3b0: 6c65 6374 2861 735f 6e75 6d62 6572 2822  lect(as_number("
+0002d3c0: 6122 2c20 342c 2031 292e 616c 6961 7328  a", 4, 1).alias(
+0002d3d0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+0002d3e0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0002d3f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0002d400: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+0002d410: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002d420: 0a20 2020 2020 2020 207c 312e 3220 2020  .        |1.2   
+0002d430: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002d440: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0002d450: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+0002d460: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+0002d470: 6e20 5f61 735f 6465 6369 6d61 6c5f 6f72  n _as_decimal_or
+0002d480: 5f6e 756d 6265 7228 2261 735f 6e75 6d62  _number("as_numb
+0002d490: 6572 222c 2076 6172 6961 6e74 2c20 7072  er", variant, pr
+0002d4a0: 6563 6973 696f 6e2c 2073 6361 6c65 290a  ecision, scale).
+0002d4b0: 0a0a 6465 6620 6173 5f64 6f75 626c 6528  ..def as_double(
+0002d4c0: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
+0002d4d0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002d4e0: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
+0002d4f0: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
+0002d500: 6f20 6120 666c 6f61 7469 6e67 2d70 6f69  o a floating-poi
+0002d510: 6e74 2076 616c 7565 2e0a 0a20 2020 2045  nt value...    E
+0002d520: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0002d530: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0002d540: 6e2e 7371 6c28 2273 656c 6563 7420 312e  n.sql("select 1.
+0002d550: 3233 3435 3a3a 7661 7269 616e 7420 6173  2345::variant as
+0002d560: 2061 2229 0a20 2020 2020 2020 203e 3e3e   a").        >>>
+0002d570: 2064 662e 7365 6c65 6374 2861 735f 646f   df.select(as_do
+0002d580: 7562 6c65 2822 6122 292e 616c 6961 7328  uble("a").alias(
+0002d590: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+0002d5a0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0002d5b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0002d5c0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+0002d5d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002d5e0: 0a20 2020 2020 2020 207c 312e 3233 3435  .        |1.2345
+0002d5f0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002d600: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0002d610: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+0002d620: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0002d630: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
+0002d640: 7269 616e 742c 2022 6173 5f64 6f75 626c  riant, "as_doubl
+0002d650: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
+0002d660: 7569 6c74 696e 2822 6173 5f64 6f75 626c  uiltin("as_doubl
+0002d670: 6522 2928 6329 0a0a 0a64 6566 2061 735f  e")(c)...def as_
+0002d680: 7265 616c 2876 6172 6961 6e74 3a20 436f  real(variant: Co
+0002d690: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0002d6a0: 6f6c 756d 6e3a 0a20 2020 2022 2222 4361  olumn:.    """Ca
+0002d6b0: 7374 7320 6120 5641 5249 414e 5420 7661  sts a VARIANT va
+0002d6c0: 6c75 6520 746f 2061 2066 6c6f 6174 696e  lue to a floatin
+0002d6d0: 672d 706f 696e 7420 7661 6c75 652e 0a0a  g-point value...
+0002d6e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0002d6f0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0002d700: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0002d710: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+0002d720: 5661 7269 616e 7454 7970 652c 2053 7472  VariantType, Str
+0002d730: 7563 7454 7970 652c 2053 7472 7563 7446  uctType, StructF
+0002d740: 6965 6c64 2c20 446f 7562 6c65 5479 7065  ield, DoubleType
+0002d750: 0a20 2020 2020 2020 203e 3e3e 2073 6368  .        >>> sch
+0002d760: 656d 613d 5374 7275 6374 5479 7065 285b  ema=StructType([
+0002d770: 5374 7275 6374 4669 656c 6428 2272 6164  StructField("rad
+0002d780: 6975 7322 2c20 446f 7562 6c65 5479 7065  ius", DoubleType
+0002d790: 2829 292c 2020 5374 7275 6374 4669 656c  ()),  StructFiel
+0002d7a0: 6428 2272 6164 6975 735f 7622 2c20 5661  d("radius_v", Va
+0002d7b0: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
+0002d7c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0002d7d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0002d7e0: 6174 6166 7261 6d65 2864 6174 613d 5b5b  ataframe(data=[[
+0002d7f0: 322e 302c 204e 6f6e 655d 5d2c 2073 6368  2.0, None]], sch
+0002d800: 656d 613d 7363 6865 6d61 290a 2020 2020  ema=schema).    
+0002d810: 2020 2020 3e3e 3e20 6466 2e72 6164 6975      >>> df.radiu
+0002d820: 735f 7620 3d20 746f 5f76 6172 6961 6e74  s_v = to_variant
+0002d830: 2864 662e 7261 6469 7573 290a 2020 2020  (df.radius).    
+0002d840: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002d850: 7428 6466 2e72 6164 6975 735f 762e 6173  t(df.radius_v.as
+0002d860: 5f28 2272 6164 6975 735f 7622 292c 2064  _("radius_v"), d
+0002d870: 662e 7261 6469 7573 292e 636f 6c6c 6563  f.radius).collec
+0002d880: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0002d890: 2852 4144 4955 535f 563d 2732 2e30 3030  (RADIUS_V='2.000
+0002d8a0: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
+0002d8b0: 272c 2052 4144 4955 533d 322e 3029 5d0a  ', RADIUS=2.0)].
+0002d8c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002d8d0: 656c 6563 7428 6173 5f72 6561 6c28 6466  elect(as_real(df
+0002d8e0: 2e72 6164 6975 735f 7629 2e61 735f 2822  .radius_v).as_("
+0002d8f0: 7265 616c 5f72 6164 6975 735f 7622 292c  real_radius_v"),
+0002d900: 2064 662e 7261 6469 7573 292e 636f 6c6c   df.radius).coll
+0002d910: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0002d920: 6f77 2852 4541 4c5f 5241 4449 5553 5f56  ow(REAL_RADIUS_V
+0002d930: 3d32 2e30 2c20 5241 4449 5553 3d32 2e30  =2.0, RADIUS=2.0
+0002d940: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0002d950: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0002d960: 7228 7661 7269 616e 742c 2022 6173 5f72  r(variant, "as_r
+0002d970: 6561 6c22 290a 2020 2020 7265 7475 726e  eal").    return
+0002d980: 2062 7569 6c74 696e 2822 6173 5f72 6561   builtin("as_rea
+0002d990: 6c22 2928 6329 0a0a 0a64 6566 2061 735f  l")(c)...def as_
+0002d9a0: 696e 7465 6765 7228 7661 7269 616e 743a  integer(variant:
+0002d9b0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0002d9c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002d9d0: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
+0002d9e0: 2076 616c 7565 2074 6f20 616e 2069 6e74   value to an int
+0002d9f0: 6567 6572 2e0a 0a20 2020 2045 7861 6d70  eger...    Examp
+0002da00: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+0002da10: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+0002da20: 6c28 2273 656c 6563 7420 312e 3233 3435  l("select 1.2345
+0002da30: 3a3a 7661 7269 616e 7420 6173 2061 2229  ::variant as a")
+0002da40: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002da50: 7365 6c65 6374 2861 735f 696e 7465 6765  select(as_intege
+0002da60: 7228 2261 2229 2e61 6c69 6173 2822 7265  r("a").alias("re
+0002da70: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+0002da80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002da90: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0002daa0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+0002dab0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0002dac0: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
+0002dad0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002dae0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002daf0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0002db00: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0002db10: 636f 6c5f 6966 5f73 7472 2876 6172 6961  col_if_str(varia
+0002db20: 6e74 2c20 2261 735f 696e 7465 6765 7222  nt, "as_integer"
+0002db30: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0002db40: 6c74 696e 2822 6173 5f69 6e74 6567 6572  ltin("as_integer
+0002db50: 2229 2863 290a 0a0a 6465 6620 6173 5f6f  ")(c)...def as_o
+0002db60: 626a 6563 7428 7661 7269 616e 743a 2043  bject(variant: C
+0002db70: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0002db80: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+0002db90: 6173 7473 2061 2056 4152 4941 4e54 2076  asts a VARIANT v
+0002dba0: 616c 7565 2074 6f20 616e 206f 626a 6563  alue to an objec
+0002dbb0: 742e 0a0a 2020 2020 4578 616d 706c 653a  t...    Example:
+0002dbc0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0002dbd0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+0002dbe0: 7365 6c65 6374 206f 626a 6563 745f 636f  select object_co
+0002dbf0: 6e73 7472 7563 7428 2741 272c 312c 2742  nstruct('A',1,'B
+0002dc00: 272c 2742 4242 4227 293a 3a76 6172 6961  ','BBBB')::varia
+0002dc10: 6e74 2061 7320 6122 290a 2020 2020 2020  nt as a").      
+0002dc20: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002dc30: 6173 5f6f 626a 6563 7428 2261 2229 2e61  as_object("a").a
+0002dc40: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+0002dc50: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+0002dc60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002dc70: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+0002dc80: 5422 2020 2020 2020 207c 0a20 2020 2020  T"       |.     
+0002dc90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0002dca0: 2d2d 2d2d 0a20 2020 2020 2020 207c 7b20  ----.        |{ 
+0002dcb0: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+0002dcc0: 2020 2020 2020 207c 2020 2241 223a 2031         |  "A": 1
+0002dcd0: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+0002dce0: 207c 2020 2242 223a 2022 4242 4242 2220   |  "B": "BBBB" 
+0002dcf0: 207c 0a20 2020 2020 2020 207c 7d20 2020   |.        |}   
+0002dd00: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002dd10: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002dd20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0002dd30: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0002dd40: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0002dd50: 6f6c 5f69 665f 7374 7228 7661 7269 616e  ol_if_str(varian
+0002dd60: 742c 2022 6173 5f6f 626a 6563 7422 290a  t, "as_object").
+0002dd70: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0002dd80: 696e 2822 6173 5f6f 626a 6563 7422 2928  in("as_object")(
+0002dd90: 6329 0a0a 0a64 6566 2061 735f 7469 6d65  c)...def as_time
+0002dda0: 2876 6172 6961 6e74 3a20 436f 6c75 6d6e  (variant: Column
+0002ddb0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0002ddc0: 6e3a 0a20 2020 2022 2222 4361 7374 7320  n:.    """Casts 
+0002ddd0: 6120 5641 5249 414e 5420 7661 6c75 6520  a VARIANT value 
+0002dde0: 746f 2061 2074 696d 6520 7661 6c75 652e  to a time value.
+0002ddf0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002de00: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0002de10: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0002de20: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
+0002de30: 6d70 6f72 7420 6173 5f74 696d 652c 2074  mport as_time, t
+0002de40: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
+0002de50: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0002de60: 6f6e 2e73 716c 2822 7365 6c65 6374 2054  on.sql("select T
+0002de70: 4f5f 5449 4d45 2827 3132 3a33 343a 3536  O_TIME('12:34:56
+0002de80: 2729 2061 7320 616c 6172 6d22 290a 2020  ') as alarm").  
+0002de90: 2020 2020 2020 3e3e 3e20 6466 2e61 6c61        >>> df.ala
+0002dea0: 726d 5f76 203d 2074 6f5f 7661 7269 616e  rm_v = to_varian
+0002deb0: 7428 6466 2e61 6c61 726d 290a 2020 2020  t(df.alarm).    
+0002dec0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002ded0: 7428 6466 2e61 6c61 726d 5f76 2e61 735f  t(df.alarm_v.as_
+0002dee0: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
+0002def0: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
+0002df00: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
+0002df10: 6563 7428 290a 2020 2020 2020 2020 4661  ect().        Fa
+0002df20: 6c73 650a 2020 2020 2020 2020 3e3e 3e20  lse.        >>> 
+0002df30: 6466 2e73 656c 6563 7428 6173 5f74 696d  df.select(as_tim
+0002df40: 6528 6466 2e61 6c61 726d 5f76 292e 6173  e(df.alarm_v).as
+0002df50: 5f28 2261 6c61 726d 2229 292e 636f 6c6c  _("alarm")).coll
+0002df60: 6563 7428 2920 3d3d 2064 662e 7365 6c65  ect() == df.sele
+0002df70: 6374 2864 662e 616c 6172 6d29 2e63 6f6c  ct(df.alarm).col
+0002df80: 6c65 6374 2829 0a20 2020 2020 2020 2054  lect().        T
+0002df90: 7275 650a 2020 2020 2222 220a 2020 2020  rue.    """.    
+0002dfa0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0002dfb0: 7472 2876 6172 6961 6e74 2c20 2261 735f  tr(variant, "as_
+0002dfc0: 7469 6d65 2229 0a20 2020 2072 6574 7572  time").    retur
+0002dfd0: 6e20 6275 696c 7469 6e28 2261 735f 7469  n builtin("as_ti
+0002dfe0: 6d65 2229 2863 290a 0a0a 6465 6620 6173  me")(c)...def as
+0002dff0: 5f74 696d 6573 7461 6d70 5f6c 747a 2876  _timestamp_ltz(v
+0002e000: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002e010: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002e020: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
+0002e030: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002e040: 2061 2054 494d 4553 5441 4d50 2077 6974   a TIMESTAMP wit
+0002e050: 6820 6120 6c6f 6361 6c20 7469 6d65 7a6f  h a local timezo
+0002e060: 6e65 2e0a 0a20 2020 2045 7861 6d70 6c65  ne...    Example
+0002e070: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0002e080: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0002e090: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+0002e0a0: 7320 696d 706f 7274 2061 735f 7469 6d65  s import as_time
+0002e0b0: 7374 616d 705f 6c74 7a2c 2074 6f5f 7661  stamp_ltz, to_va
+0002e0c0: 7269 616e 740a 2020 2020 2020 2020 3e3e  riant.        >>
+0002e0d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+0002e0e0: 716c 2822 7365 6c65 6374 2054 4f5f 5449  ql("select TO_TI
+0002e0f0: 4d45 5354 414d 505f 4c54 5a28 2732 3031  MESTAMP_LTZ('201
+0002e100: 382d 3130 2d31 3020 3132 3a33 343a 3536  8-10-10 12:34:56
+0002e110: 2729 2061 7320 616c 6172 6d22 290a 2020  ') as alarm").  
+0002e120: 2020 2020 2020 3e3e 3e20 6466 2e61 6c61        >>> df.ala
+0002e130: 726d 5f76 203d 2074 6f5f 7661 7269 616e  rm_v = to_varian
+0002e140: 7428 6466 2e61 6c61 726d 290a 2020 2020  t(df.alarm).    
+0002e150: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002e160: 7428 6466 2e61 6c61 726d 5f76 2e61 735f  t(df.alarm_v.as_
+0002e170: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
+0002e180: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
+0002e190: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
+0002e1a0: 6563 7428 290a 2020 2020 2020 2020 4661  ect().        Fa
+0002e1b0: 6c73 650a 2020 2020 2020 2020 3e3e 3e20  lse.        >>> 
+0002e1c0: 6466 2e73 656c 6563 7428 6173 5f74 696d  df.select(as_tim
+0002e1d0: 6573 7461 6d70 5f6c 747a 2864 662e 616c  estamp_ltz(df.al
+0002e1e0: 6172 6d5f 7629 2e61 735f 2822 616c 6172  arm_v).as_("alar
+0002e1f0: 6d22 2929 2e63 6f6c 6c65 6374 2829 203d  m")).collect() =
+0002e200: 3d20 6466 2e73 656c 6563 7428 6466 2e61  = df.select(df.a
+0002e210: 6c61 726d 292e 636f 6c6c 6563 7428 290a  larm).collect().
+0002e220: 2020 2020 2020 2020 5472 7565 0a20 2020          True.   
+0002e230: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0002e240: 5f63 6f6c 5f69 665f 7374 7228 7661 7269  _col_if_str(vari
+0002e250: 616e 742c 2022 6173 5f74 696d 6573 7461  ant, "as_timesta
+0002e260: 6d70 5f6c 747a 2229 0a20 2020 2072 6574  mp_ltz").    ret
+0002e270: 7572 6e20 6275 696c 7469 6e28 2261 735f  urn builtin("as_
+0002e280: 7469 6d65 7374 616d 705f 6c74 7a22 2928  timestamp_ltz")(
+0002e290: 6329 0a0a 0a64 6566 2061 735f 7469 6d65  c)...def as_time
+0002e2a0: 7374 616d 705f 6e74 7a28 7661 7269 616e  stamp_ntz(varian
+0002e2b0: 743a 2043 6f6c 756d 6e4f 724e 616d 6529  t: ColumnOrName)
+0002e2c0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0002e2d0: 2222 2243 6173 7473 2061 2056 4152 4941  """Casts a VARIA
+0002e2e0: 4e54 2076 616c 7565 2074 6f20 6120 5449  NT value to a TI
+0002e2f0: 4d45 5354 414d 5020 7769 7468 206e 6f20  MESTAMP with no 
+0002e300: 7469 6d65 7a6f 6e65 2e0a 0a20 2020 2045  timezone...    E
+0002e310: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0002e320: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0002e330: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+0002e340: 6e63 7469 6f6e 7320 696d 706f 7274 2061  nctions import a
+0002e350: 735f 7469 6d65 7374 616d 705f 6e74 7a2c  s_timestamp_ntz,
+0002e360: 2074 6f5f 7661 7269 616e 740a 2020 2020   to_variant.    
+0002e370: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0002e380: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
+0002e390: 2054 4f5f 5449 4d45 5354 414d 505f 4e54   TO_TIMESTAMP_NT
+0002e3a0: 5a28 2732 3031 382d 3130 2d31 3020 3132  Z('2018-10-10 12
+0002e3b0: 3a33 343a 3536 2729 2061 7320 616c 6172  :34:56') as alar
+0002e3c0: 6d22 290a 2020 2020 2020 2020 3e3e 3e20  m").        >>> 
+0002e3d0: 6466 2e61 6c61 726d 5f76 203d 2074 6f5f  df.alarm_v = to_
+0002e3e0: 7661 7269 616e 7428 6466 2e61 6c61 726d  variant(df.alarm
+0002e3f0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002e400: 2e73 656c 6563 7428 6466 2e61 6c61 726d  .select(df.alarm
+0002e410: 5f76 2e61 735f 2822 616c 6172 6d22 2929  _v.as_("alarm"))
+0002e420: 2e63 6f6c 6c65 6374 2829 203d 3d20 6466  .collect() == df
+0002e430: 2e73 656c 6563 7428 6466 2e61 6c61 726d  .select(df.alarm
+0002e440: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0002e450: 2020 2020 4661 6c73 650a 2020 2020 2020      False.      
+0002e460: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002e470: 6173 5f74 696d 6573 7461 6d70 5f6e 747a  as_timestamp_ntz
+0002e480: 2864 662e 616c 6172 6d5f 7629 2e61 735f  (df.alarm_v).as_
+0002e490: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
+0002e4a0: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
+0002e4b0: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
+0002e4c0: 6563 7428 290a 2020 2020 2020 2020 5472  ect().        Tr
+0002e4d0: 7565 0a20 2020 2022 2222 0a20 2020 2063  ue.    """.    c
+0002e4e0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0002e4f0: 7228 7661 7269 616e 742c 2022 6173 5f74  r(variant, "as_t
+0002e500: 696d 6573 7461 6d70 5f6e 747a 2229 0a20  imestamp_ntz"). 
+0002e510: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0002e520: 6e28 2261 735f 7469 6d65 7374 616d 705f  n("as_timestamp_
+0002e530: 6e74 7a22 2928 6329 0a0a 0a64 6566 2061  ntz")(c)...def a
+0002e540: 735f 7469 6d65 7374 616d 705f 747a 2876  s_timestamp_tz(v
+0002e550: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002e560: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002e570: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
+0002e580: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002e590: 2061 2054 494d 4553 5441 4d50 2077 6974   a TIMESTAMP wit
+0002e5a0: 6820 6120 7469 6d65 7a6f 6e65 2e0a 0a20  h a timezone... 
+0002e5b0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0002e5c0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0002e5d0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0002e5e0: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+0002e5f0: 7274 2061 735f 7469 6d65 7374 616d 705f  rt as_timestamp_
+0002e600: 747a 2c20 746f 5f76 6172 6961 6e74 0a20  tz, to_variant. 
+0002e610: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0002e620: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
+0002e630: 6563 7420 544f 5f54 494d 4553 5441 4d50  ect TO_TIMESTAMP
+0002e640: 5f54 5a28 2732 3031 382d 3130 2d31 3020  _TZ('2018-10-10 
+0002e650: 3132 3a33 343a 3536 202b 3030 3030 2729  12:34:56 +0000')
+0002e660: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
+0002e670: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
+0002e680: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
+0002e690: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
+0002e6a0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002e6b0: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
+0002e6c0: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
+0002e6d0: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
+0002e6e0: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
+0002e6f0: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
+0002e700: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0002e710: 2e73 656c 6563 7428 6173 5f74 696d 6573  .select(as_times
+0002e720: 7461 6d70 5f74 7a28 6466 2e61 6c61 726d  tamp_tz(df.alarm
+0002e730: 5f76 292e 6173 5f28 2261 6c61 726d 2229  _v).as_("alarm")
+0002e740: 292e 636f 6c6c 6563 7428 2920 3d3d 2064  ).collect() == d
+0002e750: 662e 7365 6c65 6374 2864 662e 616c 6172  f.select(df.alar
+0002e760: 6d29 2e63 6f6c 6c65 6374 2829 0a20 2020  m).collect().   
+0002e770: 2020 2020 2054 7275 650a 2020 2020 2222       True.    ""
+0002e780: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0002e790: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
+0002e7a0: 2c20 2261 735f 7469 6d65 7374 616d 705f  , "as_timestamp_
+0002e7b0: 747a 2229 0a20 2020 2072 6574 7572 6e20  tz").    return 
+0002e7c0: 6275 696c 7469 6e28 2261 735f 7469 6d65  builtin("as_time
+0002e7d0: 7374 616d 705f 747a 2229 2863 290a 0a0a  stamp_tz")(c)...
+0002e7e0: 6465 6620 746f 5f62 696e 6172 7928 653a  def to_binary(e:
+0002e7f0: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
+0002e800: 6d74 3a20 4f70 7469 6f6e 616c 5b73 7472  mt: Optional[str
+0002e810: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
+0002e820: 756d 6e3a 0a20 2020 2022 2222 436f 6e76  umn:.    """Conv
+0002e830: 6572 7473 2074 6865 2069 6e70 7574 2065  erts the input e
+0002e840: 7870 7265 7373 696f 6e20 746f 2061 2062  xpression to a b
+0002e850: 696e 6172 7920 7661 6c75 652e 2046 6f72  inary value. For
+0002e860: 204e 554c 4c20 696e 7075 742c 2074 6865   NULL input, the
+0002e870: 206f 7574 7075 7420 6973 204e 554c 4c2e   output is NULL.
+0002e880: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002e890: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0002e8a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0002e8b0: 5f64 6174 6166 7261 6d65 285b 2730 3027  _dataframe(['00'
+0002e8c0: 2c20 2736 3727 2c20 2730 3331 3227 5d2c  , '67', '0312'],
+0002e8d0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
+0002e8e0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002e8f0: 6c65 6374 2874 6f5f 6269 6e61 7279 2863  lect(to_binary(c
+0002e900: 6f6c 2827 6127 2929 2e61 735f 2827 616e  ol('a')).as_('an
+0002e910: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
+0002e920: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+0002e930: 6279 7465 6172 7261 7928 6227 5c5c 7830  bytearray(b'\\x0
+0002e940: 3027 2929 2c20 526f 7728 414e 533d 6279  0')), Row(ANS=by
+0002e950: 7465 6172 7261 7928 6227 6727 2929 2c20  tearray(b'g')), 
+0002e960: 526f 7728 414e 533d 6279 7465 6172 7261  Row(ANS=bytearra
+0002e970: 7928 6227 5c5c 7830 335c 5c78 3132 2729  y(b'\\x03\\x12')
+0002e980: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
+0002e990: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0002e9a0: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
+0002e9b0: 6147 5673 6247 383d 272c 2027 6432 3979  aGVsbG8=', 'd29y
+0002e9c0: 6247 513d 272c 2027 4951 3d3d 275d 2c20  bGQ=', 'IQ=='], 
+0002e9d0: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
+0002e9e0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0002e9f0: 6563 7428 746f 5f62 696e 6172 7928 636f  ect(to_binary(co
+0002ea00: 6c28 2761 2729 2c20 2742 4153 4536 3427  l('a'), 'BASE64'
+0002ea10: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
+0002ea20: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0002ea30: 5b52 6f77 2841 4e53 3d62 7974 6561 7272  [Row(ANS=bytearr
+0002ea40: 6179 2862 2768 656c 6c6f 2729 292c 2052  ay(b'hello')), R
+0002ea50: 6f77 2841 4e53 3d62 7974 6561 7272 6179  ow(ANS=bytearray
+0002ea60: 2862 2777 6f72 6c64 2729 292c 2052 6f77  (b'world')), Row
+0002ea70: 2841 4e53 3d62 7974 6561 7272 6179 2862  (ANS=bytearray(b
+0002ea80: 2721 2729 295d 0a0a 2020 2020 2020 2020  '!'))]..        
+0002ea90: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
+0002eaa0: 5f62 696e 6172 7928 636f 6c28 2761 2729  _binary(col('a')
+0002eab0: 2c20 2755 5446 2d38 2729 2e61 735f 2827  , 'UTF-8').as_('
+0002eac0: 616e 7327 2929 2e63 6f6c 6c65 6374 2829  ans')).collect()
+0002ead0: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
+0002eae0: 533d 6279 7465 6172 7261 7928 6227 6147  S=bytearray(b'aG
+0002eaf0: 5673 6247 383d 2729 292c 2052 6f77 2841  VsbG8=')), Row(A
+0002eb00: 4e53 3d62 7974 6561 7272 6179 2862 2764  NS=bytearray(b'd
+0002eb10: 3239 7962 4751 3d27 2929 2c20 526f 7728  29ybGQ=')), Row(
+0002eb20: 414e 533d 6279 7465 6172 7261 7928 6227  ANS=bytearray(b'
+0002eb30: 4951 3d3d 2729 295d 0a20 2020 2022 2222  IQ=='))].    """
+0002eb40: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002eb50: 5f69 665f 7374 7228 652c 2022 746f 5f62  _if_str(e, "to_b
+0002eb60: 696e 6172 7922 290a 2020 2020 7265 7475  inary").    retu
+0002eb70: 726e 2062 7569 6c74 696e 2822 746f 5f62  rn builtin("to_b
+0002eb80: 696e 6172 7922 2928 632c 2066 6d74 2920  inary")(c, fmt) 
+0002eb90: 6966 2066 6d74 2065 6c73 6520 6275 696c  if fmt else buil
+0002eba0: 7469 6e28 2274 6f5f 6269 6e61 7279 2229  tin("to_binary")
+0002ebb0: 2863 290a 0a0a 6465 6620 746f 5f61 7272  (c)...def to_arr
+0002ebc0: 6179 2865 3a20 436f 6c75 6d6e 4f72 4e61  ay(e: ColumnOrNa
+0002ebd0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0002ebe0: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
+0002ebf0: 6e79 2076 616c 7565 2074 6f20 616e 2041  ny value to an A
+0002ec00: 5252 4159 2076 616c 7565 206f 7220 4e55  RRAY value or NU
+0002ec10: 4c4c 2028 6966 2069 6e70 7574 2069 7320  LL (if input is 
+0002ec20: 4e55 4c4c 292e 0a0a 2020 2020 4578 616d  NULL)...    Exam
+0002ec30: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+0002ec40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002ec50: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0002ec60: 285b 312c 2032 2c20 332c 2034 5d2c 2073  ([1, 2, 3, 4], s
+0002ec70: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
+0002ec80: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002ec90: 6374 2874 6f5f 6172 7261 7928 636f 6c28  ct(to_array(col(
+0002eca0: 2761 2729 292e 6173 5f28 2761 6e73 2729  'a')).as_('ans')
+0002ecb0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0002ecc0: 2020 2020 5b52 6f77 2841 4e53 3d27 5b5c      [Row(ANS='[\
+0002ecd0: 5c6e 2020 315c 5c6e 5d27 292c 2052 6f77  \n  1\\n]'), Row
+0002ece0: 2841 4e53 3d27 5b5c 5c6e 2020 325c 5c6e  (ANS='[\\n  2\\n
+0002ecf0: 5d27 292c 2052 6f77 2841 4e53 3d27 5b5c  ]'), Row(ANS='[\
+0002ed00: 5c6e 2020 335c 5c6e 5d27 292c 2052 6f77  \n  3\\n]'), Row
+0002ed10: 2841 4e53 3d27 5b5c 5c6e 2020 345c 5c6e  (ANS='[\\n  4\\n
+0002ed20: 5d27 295d 0a0a 0a20 2020 2020 2020 203e  ]')]...        >
+0002ed30: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0002ed40: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
+0002ed50: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
+0002ed60: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+0002ed70: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+0002ed80: 5b52 6f77 2861 3d5b 312c 2032 2c20 335d  [Row(a=[1, 2, 3]
+0002ed90: 292c 2052 6f77 2861 3d4e 6f6e 6529 5d29  ), Row(a=None)])
+0002eda0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002edb0: 7365 6c65 6374 2874 6f5f 6172 7261 7928  select(to_array(
+0002edc0: 636f 6c28 2761 2729 292e 6173 5f28 2761  col('a')).as_('a
+0002edd0: 6e73 2729 292e 636f 6c6c 6563 7428 290a  ns')).collect().
+0002ede0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+0002edf0: 3d27 5b5c 5c6e 2020 312c 5c5c 6e20 2032  ='[\\n  1,\\n  2
+0002ee00: 2c5c 5c6e 2020 335c 5c6e 5d27 292c 2052  ,\\n  3\\n]'), R
+0002ee10: 6f77 2841 4e53 3d4e 6f6e 6529 5d0a 2020  ow(ANS=None)].  
+0002ee20: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0002ee30: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0002ee40: 2274 6f5f 6172 7261 7922 290a 2020 2020  "to_array").    
+0002ee50: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002ee60: 746f 5f61 7272 6179 2229 2863 290a 0a0a  to_array")(c)...
+0002ee70: 6465 6620 746f 5f6a 736f 6e28 653a 2043  def to_json(e: C
+0002ee80: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0002ee90: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+0002eea0: 6f6e 7665 7274 7320 616e 7920 5641 5249  onverts any VARI
+0002eeb0: 414e 5420 7661 6c75 6520 746f 2061 2073  ANT value to a s
+0002eec0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
+0002eed0: 2074 6865 204a 534f 4e20 7265 7072 6573   the JSON repres
+0002eee0: 656e 7461 7469 6f6e 206f 6620 7468 650a  entation of the.
+0002eef0: 2020 2020 7661 6c75 652e 2049 6620 7468      value. If th
+0002ef00: 6520 696e 7075 7420 6973 204e 554c 4c2c  e input is NULL,
+0002ef10: 2074 6865 2072 6573 756c 7420 6973 2061   the result is a
+0002ef20: 6c73 6f20 4e55 4c4c 2e0a 0a20 2020 2045  lso NULL...    E
+0002ef30: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0002ef40: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0002ef50: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0002ef60: 6573 2069 6d70 6f72 7420 5661 7269 616e  es import Varian
+0002ef70: 7454 7970 652c 2053 7472 7563 7446 6965  tType, StructFie
+0002ef80: 6c64 2c20 5374 7275 6374 5479 7065 0a20  ld, StructType. 
+0002ef90: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0002efa0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0002efb0: 726b 2069 6d70 6f72 7420 526f 770a 2020  rk import Row.  
+0002efc0: 2020 2020 2020 3e3e 3e20 7363 6865 6d61        >>> schema
+0002efd0: 203d 2053 7472 7563 7454 7970 6528 5b53   = StructType([S
+0002efe0: 7472 7563 7446 6965 6c64 2822 6122 2c20  tructField("a", 
+0002eff0: 5661 7269 616e 7454 7970 6528 2929 5d29  VariantType())])
+0002f000: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0002f010: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0002f020: 5f64 6174 6166 7261 6d65 285b 526f 7728  _dataframe([Row(
+0002f030: 613d 4e6f 6e65 292c 526f 7728 613d 3132  a=None),Row(a=12
+0002f040: 292c 526f 7728 613d 332e 3134 3129 2c52  ),Row(a=3.141),R
+0002f050: 6f77 2861 3d7b 2761 273a 3130 2c27 6227  ow(a={'a':10,'b'
+0002f060: 3a32 307d 292c 526f 7728 613d 5b31 2c32  :20}),Row(a=[1,2
+0002f070: 332c 3435 365d 295d 2c20 7363 6865 6d61  3,456])], schema
+0002f080: 3d73 6368 656d 6129 0a20 2020 2020 2020  =schema).       
+0002f090: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
+0002f0a0: 6f5f 6a73 6f6e 2863 6f6c 2822 6122 2929  o_json(col("a"))
+0002f0b0: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
+0002f0c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0002f0d0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
+0002f0e0: 6f77 2841 4e53 3d27 3132 2729 2c20 526f  ow(ANS='12'), Ro
+0002f0f0: 7728 414e 533d 2733 2e31 3431 2729 2c20  w(ANS='3.141'), 
+0002f100: 526f 7728 414e 533d 277b 2261 223a 3130  Row(ANS='{"a":10
+0002f110: 2c22 6222 3a32 307d 2729 2c20 526f 7728  ,"b":20}'), Row(
+0002f120: 414e 533d 275b 312c 3233 2c34 3536 5d27  ANS='[1,23,456]'
+0002f130: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0002f140: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0002f150: 7228 652c 2022 746f 5f6a 736f 6e22 290a  r(e, "to_json").
+0002f160: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0002f170: 696e 2822 746f 5f6a 736f 6e22 2928 6329  in("to_json")(c)
+0002f180: 0a0a 0a64 6566 2074 6f5f 6f62 6a65 6374  ...def to_object
+0002f190: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0002f1a0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0002f1b0: 2022 2222 436f 6e76 6572 7473 2061 6e79   """Converts any
+0002f1c0: 2076 616c 7565 2074 6f20 6120 4f42 4a45   value to a OBJE
+0002f1d0: 4354 2076 616c 7565 206f 7220 4e55 4c4c  CT value or NULL
+0002f1e0: 2028 6966 2069 6e70 7574 2069 7320 4e55   (if input is NU
+0002f1f0: 4c4c 292e 0a0a 2020 2020 4578 616d 706c  LL)...    Exampl
+0002f200: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0002f210: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0002f220: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+0002f230: 706f 7274 2056 6172 6961 6e74 5479 7065  port VariantType
+0002f240: 2c20 5374 7275 6374 4669 656c 642c 2053  , StructField, S
+0002f250: 7472 7563 7454 7970 650a 2020 2020 2020  tructType.      
+0002f260: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0002f270: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
+0002f280: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
+0002f290: 203e 3e3e 2073 6368 656d 6120 3d20 5374   >>> schema = St
+0002f2a0: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
+0002f2b0: 4669 656c 6428 2261 222c 2056 6172 6961  Field("a", Varia
+0002f2c0: 6e74 5479 7065 2829 295d 290a 2020 2020  ntType())]).    
+0002f2d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0002f2e0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0002f2f0: 6672 616d 6528 5b22 7b27 6127 3a31 302c  frame(["{'a':10,
+0002f300: 2762 273a 3230 7d22 2c20 4e6f 6e65 5d2c  'b':20}", None],
+0002f310: 2073 6368 656d 613d 7363 6865 6d61 290a   schema=schema).
+0002f320: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002f330: 656c 6563 7428 746f 5f6f 626a 6563 7428  elect(to_object(
+0002f340: 636f 6c28 2261 2229 292e 6173 5f28 2761  col("a")).as_('a
+0002f350: 6e73 2729 292e 636f 6c6c 6563 7428 290a  ns')).collect().
+0002f360: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+0002f370: 3d27 7b5c 5c6e 2020 2261 223a 2031 302c  ='{\\n  "a": 10,
+0002f380: 5c5c 6e20 2022 6222 3a20 3230 5c5c 6e7d  \\n  "b": 20\\n}
+0002f390: 2729 2c20 526f 7728 414e 533d 4e6f 6e65  '), Row(ANS=None
+0002f3a0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0002f3b0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0002f3c0: 7228 652c 2022 746f 5f6f 626a 6563 7422  r(e, "to_object"
+0002f3d0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0002f3e0: 6c74 696e 2822 746f 5f6f 626a 6563 7422  ltin("to_object"
+0002f3f0: 2928 6329 0a0a 0a64 6566 2074 6f5f 7661  )(c)...def to_va
+0002f400: 7269 616e 7428 653a 2043 6f6c 756d 6e4f  riant(e: ColumnO
+0002f410: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002f420: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
+0002f430: 7320 616e 7920 7661 6c75 6520 746f 2061  s any value to a
+0002f440: 2056 4152 4941 4e54 2076 616c 7565 206f   VARIANT value o
+0002f450: 7220 4e55 4c4c 2028 6966 2069 6e70 7574  r NULL (if input
+0002f460: 2069 7320 4e55 4c4c 292e 0a0a 2020 2020   is NULL)...    
+0002f470: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0002f480: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0002f490: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0002f4a0: 7261 6d65 285b 312c 2032 2c20 332c 2034  rame([1, 2, 3, 4
+0002f4b0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+0002f4c0: 0a20 2020 2020 2020 203e 3e3e 2064 665f  .        >>> df_
+0002f4d0: 636f 6e76 203d 2064 662e 7365 6c65 6374  conv = df.select
+0002f4e0: 2874 6f5f 7661 7269 616e 7428 636f 6c28  (to_variant(col(
+0002f4f0: 2261 2229 292e 6173 5f28 2261 6e73 2229  "a")).as_("ans")
+0002f500: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002f510: 5f63 6f6e 762e 636f 6c6c 6563 7428 290a  _conv.collect().
+0002f520: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+0002f530: 3d27 3127 292c 2052 6f77 2841 4e53 3d27  ='1'), Row(ANS='
+0002f540: 3227 292c 2052 6f77 2841 4e53 3d27 3327  2'), Row(ANS='3'
+0002f550: 292c 2052 6f77 2841 4e53 3d27 3427 295d  ), Row(ANS='4')]
+0002f560: 0a0a 2020 2020 2020 2020 4166 7465 7220  ..        After 
+0002f570: 636f 6e76 6572 7369 6f6e 2076 6961 2074  conversion via t
+0002f580: 6f5f 7661 7269 616e 742c 2061 6e6f 7468  o_variant, anoth
+0002f590: 6572 2076 6172 6961 6e74 2064 6174 6166  er variant dataf
+0002f5a0: 7261 6d65 2063 616e 2062 6520 6d65 7267  rame can be merg
+0002f5b0: 6564 2e0a 0a20 2020 2020 2020 203e 3e3e  ed...        >>>
+0002f5c0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+0002f5d0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+0002f5e0: 6d70 6f72 7420 5661 7269 616e 7454 7970  mport VariantTyp
+0002f5f0: 652c 2053 7472 7563 7446 6965 6c64 2c20  e, StructField, 
+0002f600: 5374 7275 6374 5479 7065 0a20 2020 2020  StructType.     
+0002f610: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0002f620: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
+0002f630: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
+0002f640: 2020 3e3e 3e20 7363 6865 6d61 203d 2053    >>> schema = S
+0002f650: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
+0002f660: 7446 6965 6c64 2822 6122 2c20 5661 7269  tField("a", Vari
+0002f670: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
+0002f680: 2020 2020 203e 3e3e 2064 665f 6f74 6865       >>> df_othe
+0002f690: 7220 3d20 7365 7373 696f 6e2e 6372 6561  r = session.crea
+0002f6a0: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
+0002f6b0: 7728 613d 3130 292c 2052 6f77 2861 3d27  w(a=10), Row(a='
+0002f6c0: 7465 7374 2729 2c20 526f 7728 613d 7b27  test'), Row(a={'
+0002f6d0: 6127 3a20 3130 2c20 2762 273a 2032 307d  a': 10, 'b': 20}
+0002f6e0: 292c 2052 6f77 2861 3d5b 312c 2032 2c20  ), Row(a=[1, 2, 
+0002f6f0: 335d 295d 2c20 7363 6865 6d61 3d73 6368  3])], schema=sch
+0002f700: 656d 6129 0a20 2020 2020 2020 203e 3e3e  ema).        >>>
+0002f710: 2064 665f 636f 6e76 2e75 6e69 6f6e 2864   df_conv.union(d
+0002f720: 665f 6f74 6865 7229 2e73 656c 6563 7428  f_other).select(
+0002f730: 7479 7065 6f66 2863 6f6c 2822 616e 7322  typeof(col("ans"
+0002f740: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
+0002f750: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0002f760: 205b 526f 7728 414e 533d 2749 4e54 4547   [Row(ANS='INTEG
+0002f770: 4552 2729 2c20 526f 7728 414e 533d 2749  ER'), Row(ANS='I
+0002f780: 4e54 4547 4552 2729 2c20 526f 7728 414e  NTEGER'), Row(AN
+0002f790: 533d 2749 4e54 4547 4552 2729 2c20 526f  S='INTEGER'), Ro
+0002f7a0: 7728 414e 533d 2749 4e54 4547 4552 2729  w(ANS='INTEGER')
+0002f7b0: 2c20 526f 7728 414e 533d 2749 4e54 4547  , Row(ANS='INTEG
+0002f7c0: 4552 2729 2c20 526f 7728 414e 533d 2756  ER'), Row(ANS='V
+0002f7d0: 4152 4348 4152 2729 2c20 526f 7728 414e  ARCHAR'), Row(AN
+0002f7e0: 533d 274f 424a 4543 5427 292c 2052 6f77  S='OBJECT'), Row
+0002f7f0: 2841 4e53 3d27 4152 5241 5927 295d 0a20  (ANS='ARRAY')]. 
+0002f800: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0002f810: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+0002f820: 2022 746f 5f76 6172 6961 6e74 2229 0a20   "to_variant"). 
+0002f830: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0002f840: 6e28 2274 6f5f 7661 7269 616e 7422 2928  n("to_variant")(
+0002f850: 6329 0a0a 0a64 6566 2074 6f5f 786d 6c28  c)...def to_xml(
+0002f860: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0002f870: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0002f880: 2222 2243 6f6e 7665 7274 7320 616e 7920  """Converts any 
+0002f890: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002f8a0: 2061 2073 7472 696e 6720 636f 6e74 6169   a string contai
+0002f8b0: 6e69 6e67 2074 6865 2058 4d4c 2072 6570  ning the XML rep
+0002f8c0: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
+0002f8d0: 6865 0a20 2020 2076 616c 7565 2e20 4966  he.    value. If
+0002f8e0: 2074 6865 2069 6e70 7574 2069 7320 4e55   the input is NU
+0002f8f0: 4c4c 2c20 7468 6520 7265 7375 6c74 2069  LL, the result i
+0002f900: 7320 616c 736f 204e 554c 4c2e 0a0a 2020  s also NULL...  
+0002f910: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0002f920: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0002f930: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0002f940: 7479 7065 7320 696d 706f 7274 2056 6172  types import Var
+0002f950: 6961 6e74 5479 7065 2c20 5374 7275 6374  iantType, Struct
+0002f960: 4669 656c 642c 2053 7472 7563 7454 7970  Field, StructTyp
+0002f970: 650a 2020 2020 2020 2020 3e3e 3e20 6672  e.        >>> fr
+0002f980: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0002f990: 7770 6172 6b20 696d 706f 7274 2052 6f77  wpark import Row
+0002f9a0: 0a20 2020 2020 2020 203e 3e3e 2073 6368  .        >>> sch
+0002f9b0: 656d 6120 3d20 5374 7275 6374 5479 7065  ema = StructType
+0002f9c0: 285b 5374 7275 6374 4669 656c 6428 2261  ([StructField("a
+0002f9d0: 222c 2056 6172 6961 6e74 5479 7065 2829  ", VariantType()
+0002f9e0: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
+0002f9f0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0002fa00: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
+0002fa10: 6f77 2861 3d31 3029 2c20 526f 7728 613d  ow(a=10), Row(a=
+0002fa20: 2774 6573 7427 292c 2052 6f77 2861 3d7b  'test'), Row(a={
+0002fa30: 2761 273a 2031 302c 2027 6227 3a20 3230  'a': 10, 'b': 20
+0002fa40: 7d29 2c20 526f 7728 613d 5b31 2c20 322c  }), Row(a=[1, 2,
+0002fa50: 2033 5d29 5d2c 2073 6368 656d 613d 7363   3])], schema=sc
+0002fa60: 6865 6d61 290a 2020 2020 2020 2020 3e3e  hema).        >>
+0002fa70: 3e20 6466 2e73 656c 6563 7428 746f 5f78  > df.select(to_x
+0002fa80: 6d6c 2863 6f6c 2822 4122 2929 2e61 735f  ml(col("A")).as_
+0002fa90: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
+0002faa0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0002fab0: 414e 533d 273c 536e 6f77 666c 616b 6544  ANS='<SnowflakeD
+0002fac0: 6174 6120 7479 7065 3d22 494e 5445 4745  ata type="INTEGE
+0002fad0: 5222 3e31 303c 2f53 6e6f 7766 6c61 6b65  R">10</Snowflake
+0002fae0: 4461 7461 3e27 292c 2052 6f77 2841 4e53  Data>'), Row(ANS
+0002faf0: 3d27 3c53 6e6f 7766 6c61 6b65 4461 7461  ='<SnowflakeData
+0002fb00: 2074 7970 653d 2256 4152 4348 4152 223e   type="VARCHAR">
+0002fb10: 7465 7374 3c2f 536e 6f77 666c 616b 6544  test</SnowflakeD
+0002fb20: 6174 613e 2729 2c20 526f 7728 414e 533d  ata>'), Row(ANS=
+0002fb30: 273c 536e 6f77 666c 616b 6544 6174 6120  '<SnowflakeData 
+0002fb40: 7479 7065 3d22 4f42 4a45 4354 223e 3c61  type="OBJECT"><a
+0002fb50: 2074 7970 653d 2249 4e54 4547 4552 223e   type="INTEGER">
+0002fb60: 3130 3c2f 613e 3c62 2074 7970 653d 2249  10</a><b type="I
+0002fb70: 4e54 4547 4552 223e 3230 3c2f 623e 3c2f  NTEGER">20</b></
+0002fb80: 536e 6f77 666c 616b 6544 6174 613e 2729  SnowflakeData>')
+0002fb90: 2c20 526f 7728 414e 533d 273c 536e 6f77  , Row(ANS='<Snow
+0002fba0: 666c 616b 6544 6174 6120 7479 7065 3d22  flakeData type="
+0002fbb0: 4152 5241 5922 3e3c 6520 7479 7065 3d22  ARRAY"><e type="
+0002fbc0: 494e 5445 4745 5222 3e31 3c2f 653e 3c65  INTEGER">1</e><e
+0002fbd0: 2074 7970 653d 2249 4e54 4547 4552 223e   type="INTEGER">
+0002fbe0: 323c 2f65 3e3c 6520 7479 7065 3d22 494e  2</e><e type="IN
+0002fbf0: 5445 4745 5222 3e33 3c2f 653e 3c2f 536e  TEGER">3</e></Sn
+0002fc00: 6f77 666c 616b 6544 6174 613e 2729 5d0a  owflakeData>')].
+0002fc10: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0002fc20: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+0002fc30: 2c20 2274 6f5f 786d 6c22 290a 2020 2020  , "to_xml").    
+0002fc40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002fc50: 746f 5f78 6d6c 2229 2863 290a 0a0a 6465  to_xml")(c)...de
+0002fc60: 6620 6765 745f 6967 6e6f 7265 5f63 6173  f get_ignore_cas
+0002fc70: 6528 6f62 6a3a 2043 6f6c 756d 6e4f 724e  e(obj: ColumnOrN
+0002fc80: 616d 652c 2066 6965 6c64 3a20 436f 6c75  ame, field: Colu
+0002fc90: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002fca0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0002fcb0: 2045 7874 7261 6374 7320 6120 6669 656c   Extracts a fiel
+0002fcc0: 6420 7661 6c75 6520 6672 6f6d 2061 6e20  d value from an 
+0002fcd0: 6f62 6a65 6374 2e20 5265 7475 726e 7320  object. Returns 
+0002fce0: 4e55 4c4c 2069 6620 6569 7468 6572 206f  NULL if either o
+0002fcf0: 6620 7468 6520 6172 6775 6d65 6e74 7320  f the arguments 
+0002fd00: 6973 204e 554c 4c2e 0a20 2020 2054 6869  is NULL..    Thi
+0002fd10: 7320 6675 6e63 7469 6f6e 2069 7320 7369  s function is si
+0002fd20: 6d69 6c61 7220 746f 203a 6d65 7468 3a60  milar to :meth:`
+0002fd30: 6765 7460 2062 7574 2061 7070 6c69 6573  get` but applies
+0002fd40: 2063 6173 652d 696e 7365 6e73 6974 6976   case-insensitiv
+0002fd50: 6520 6d61 7463 6869 6e67 2074 6f20 6669  e matching to fi
+0002fd60: 656c 6420 6e61 6d65 732e 0a0a 2020 2020  eld names...    
+0002fd70: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
+0002fd80: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0002fd90: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0002fda0: 6672 616d 6528 5b7b 2261 223a 207b 2261  frame([{"a": {"a
+0002fdb0: 6122 3a20 312c 2022 6262 223a 2032 2c20  a": 1, "bb": 2, 
+0002fdc0: 2263 6322 3a20 337d 7d5d 290a 2020 2020  "cc": 3}}]).    
+0002fdd0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002fde0: 7428 6765 745f 6967 6e6f 7265 5f63 6173  t(get_ignore_cas
+0002fdf0: 6528 6466 5b22 6122 5d2c 206c 6974 2822  e(df["a"], lit("
+0002fe00: 4141 2229 292e 616c 6961 7328 2267 6574  AA")).alias("get
+0002fe10: 5f69 676e 6f72 655f 6361 7365 2229 292e  _ignore_case")).
+0002fe20: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0002fe30: 2020 5b52 6f77 2847 4554 5f49 474e 4f52    [Row(GET_IGNOR
+0002fe40: 455f 4341 5345 3d27 3127 295d 0a20 2020  E_CASE='1')].   
+0002fe50: 2022 2222 0a20 2020 2063 3120 3d20 5f74   """.    c1 = _t
+0002fe60: 6f5f 636f 6c5f 6966 5f73 7472 286f 626a  o_col_if_str(obj
+0002fe70: 2c20 2267 6574 5f69 676e 6f72 655f 6361  , "get_ignore_ca
+0002fe80: 7365 2229 0a20 2020 2063 3220 3d20 5f74  se").    c2 = _t
+0002fe90: 6f5f 636f 6c5f 6966 5f73 7472 2866 6965  o_col_if_str(fie
+0002fea0: 6c64 2c20 2267 6574 5f69 676e 6f72 655f  ld, "get_ignore_
+0002feb0: 6361 7365 2229 0a20 2020 2072 6574 7572  case").    retur
+0002fec0: 6e20 6275 696c 7469 6e28 2267 6574 5f69  n builtin("get_i
+0002fed0: 676e 6f72 655f 6361 7365 2229 2863 312c  gnore_case")(c1,
+0002fee0: 2063 3229 0a0a 0a64 6566 206f 626a 6563   c2)...def objec
+0002fef0: 745f 6b65 7973 286f 626a 3a20 436f 6c75  t_keys(obj: Colu
+0002ff00: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002ff10: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0002ff20: 726e 7320 616e 2061 7272 6179 2063 6f6e  rns an array con
+0002ff30: 7461 696e 696e 6720 7468 6520 6c69 7374  taining the list
+0002ff40: 206f 6620 6b65 7973 2069 6e20 7468 6520   of keys in the 
+0002ff50: 696e 7075 7420 6f62 6a65 6374 2e0a 0a0a  input object....
+0002ff60: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0002ff70: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0002ff80: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0002ff90: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+0002ffa0: 7274 206c 6974 0a20 2020 2020 2020 203e  rt lit.        >
+0002ffb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002ffc0: 7371 6c28 0a20 2020 2020 2020 202e 2e2e  sql(.        ...
+0002ffd0: 2020 2020 2022 7365 6c65 6374 206f 626a       "select obj
+0002ffe0: 6563 745f 636f 6e73 7472 7563 7428 612c  ect_construct(a,
+0002fff0: 622c 632c 642c 652c 6629 2061 7320 6f62  b,c,d,e,f) as ob
+00030000: 6a2c 206b 2c20 7620 6672 6f6d 2022 0a20  j, k, v from ". 
+00030010: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
+00030020: 7661 6c75 6573 2827 6167 6527 2c20 3231  values('age', 21
+00030030: 2c20 277a 6970 272c 2032 3130 3231 2c20  , 'zip', 21021, 
+00030040: 276e 616d 6527 2c20 274a 6f65 272c 2027  'name', 'Joe', '
+00030050: 6167 6527 2c20 3029 2c22 0a20 2020 2020  age', 0),".     
+00030060: 2020 202e 2e2e 2020 2020 2022 2827 6167     ...     "('ag
+00030070: 6527 2c20 3236 2c20 277a 6970 272c 2039  e', 26, 'zip', 9
+00030080: 3430 3231 2c20 276e 616d 6527 2c20 274a  4021, 'name', 'J
+00030090: 6179 272c 2027 6167 6527 2c20 3029 2061  ay', 'age', 0) a
+000300a0: 7320 5428 612c 622c 632c 642c 652c 662c  s T(a,b,c,d,e,f,
+000300b0: 6b2c 7629 220a 2020 2020 2020 2020 2e2e  k,v)".        ..
+000300c0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+000300d0: 6466 2e73 656c 6563 7428 6f62 6a65 6374  df.select(object
+000300e0: 5f6b 6579 7328 636f 6c28 226f 626a 2229  _keys(col("obj")
+000300f0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00030100: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00030110: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a    -------------.
+00030120: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00030130: 2220 2020 7c0a 2020 2020 2020 2020 2d2d  "   |.        --
+00030140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00030150: 2020 2020 7c5b 2020 2020 2020 2020 2020      |[          
+00030160: 7c0a 2020 2020 2020 2020 7c20 2022 6167  |.        |  "ag
+00030170: 6522 2c20 2020 7c0a 2020 2020 2020 2020  e",   |.        
+00030180: 7c20 2022 6e61 6d65 222c 2020 7c0a 2020  |  "name",  |.  
+00030190: 2020 2020 2020 7c20 2022 7a69 7022 2020        |  "zip"  
+000301a0: 2020 7c0a 2020 2020 2020 2020 7c5d 2020    |.        |]  
+000301b0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000301c0: 2020 7c5b 2020 2020 2020 2020 2020 7c0a    |[          |.
+000301d0: 2020 2020 2020 2020 7c20 2022 6167 6522          |  "age"
+000301e0: 2c20 2020 7c0a 2020 2020 2020 2020 7c20  ,   |.        | 
+000301f0: 2022 6e61 6d65 222c 2020 7c0a 2020 2020   "name",  |.    
+00030200: 2020 2020 7c20 2022 7a69 7022 2020 2020      |  "zip"    
+00030210: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00030220: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00030230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00030240: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00030250: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
+00030260: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00030270: 286f 626a 2c20 226f 626a 6563 745f 6b65  (obj, "object_ke
+00030280: 7973 2229 0a20 2020 2072 6574 7572 6e20  ys").    return 
+00030290: 6275 696c 7469 6e28 226f 626a 6563 745f  builtin("object_
+000302a0: 6b65 7973 2229 2863 290a 0a0a 6465 6620  keys")(c)...def 
+000302b0: 786d 6c67 6574 280a 2020 2020 786d 6c3a  xmlget(.    xml:
+000302c0: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
+000302d0: 2020 2074 6167 3a20 436f 6c75 6d6e 4f72     tag: ColumnOr
+000302e0: 4e61 6d65 2c0a 2020 2020 696e 7374 616e  Name,.    instan
+000302f0: 6365 5f6e 756d 3a20 556e 696f 6e5b 436f  ce_num: Union[Co
+00030300: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00030310: 203d 2030 2c0a 2920 2d3e 2043 6f6c 756d   = 0,.) -> Colum
+00030320: 6e3a 0a20 2020 2022 2222 4578 7472 6163  n:.    """Extrac
+00030330: 7473 2061 6e20 584d 4c20 656c 656d 656e  ts an XML elemen
+00030340: 7420 6f62 6a65 6374 2028 6f66 7465 6e20  t object (often 
+00030350: 7265 6665 7272 6564 2074 6f20 6173 2073  referred to as s
+00030360: 696d 706c 7920 6120 7461 6729 2066 726f  imply a tag) fro
+00030370: 6d20 6120 636f 6e74 656e 7420 6f66 206f  m a content of o
+00030380: 7574 6572 0a20 2020 2058 4d4c 2065 6c65  uter.    XML ele
+00030390: 6d65 6e74 206f 626a 6563 7420 6279 2074  ment object by t
+000303a0: 6865 206e 616d 6520 6f66 2074 6865 2074  he name of the t
+000303b0: 6167 2061 6e64 2069 7473 2069 6e73 7461  ag and its insta
+000303c0: 6e63 6520 6e75 6d62 6572 2028 636f 756e  nce number (coun
+000303d0: 7469 6e67 2066 726f 6d20 3029 2e0a 0a20  ting from 0)... 
+000303e0: 2020 2054 6865 2066 6f6c 6c6f 7769 6e67     The following
+000303f0: 2065 7861 6d70 6c65 2072 6574 7572 6e73   example returns
+00030400: 2074 6865 2066 6972 7374 2069 6e6e 6572   the first inner
+00030410: 206c 6576 656c 2028 6c65 7665 6c32 2920   level (level2) 
+00030420: 6672 6f6d 2074 6865 2058 4d4c 206f 626a  from the XML obj
+00030430: 6563 7420 6372 6561 7465 6420 7669 6120  ect created via 
+00030440: 6070 6172 7365 5f78 6d6c 602e 0a0a 2020  `parse_xml`...  
+00030450: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00030460: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00030470: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00030480: 6166 7261 6d65 285b 273c 6c65 7665 6c31  aframe(['<level1
+00030490: 2061 7474 7231 3d22 6122 3e31 3c6c 6576   attr1="a">1<lev
+000304a0: 656c 3220 6174 7472 323d 2262 223e 323c  el2 attr2="b">2<
+000304b0: 6c65 7665 6c33 3e33 613c 2f6c 6576 656c  level3>3a</level
+000304c0: 333e 3c6c 6576 656c 333e 3362 3c2f 6c65  3><level3>3b</le
+000304d0: 7665 6c33 3e3c 2f6c 6576 656c 323e 3c2f  vel3></level2></
+000304e0: 6c65 7665 6c31 3e27 5d2c 2073 6368 656d  level1>'], schem
+000304f0: 613d 5b22 7374 7222 5d29 2e73 656c 6563  a=["str"]).selec
+00030500: 7428 7061 7273 655f 786d 6c28 2273 7472  t(parse_xml("str
+00030510: 2229 2e61 735f 2822 6f62 6a22 2929 0a20  ").as_("obj")). 
+00030520: 2020 2020 2020 203e 3e3e 2064 662e 636f         >>> df.co
+00030530: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00030540: 5b52 6f77 284f 424a 3d27 3c6c 6576 656c  [Row(OBJ='<level
+00030550: 3120 6174 7472 313d 2261 223e 5c5c 6e20  1 attr1="a">\\n 
+00030560: 2031 5c5c 6e20 203c 6c65 7665 6c32 2061   1\\n  <level2 a
+00030570: 7474 7232 3d22 6222 3e5c 5c6e 2020 2020  ttr2="b">\\n    
+00030580: 325c 5c6e 2020 2020 3c6c 6576 656c 333e  2\\n    <level3>
+00030590: 3361 3c2f 6c65 7665 6c33 3e5c 5c6e 2020  3a</level3>\\n  
+000305a0: 2020 3c6c 6576 656c 333e 3362 3c2f 6c65    <level3>3b</le
+000305b0: 7665 6c33 3e5c 5c6e 2020 3c2f 6c65 7665  vel3>\\n  </leve
+000305c0: 6c32 3e5c 5c6e 3c2f 6c65 7665 6c31 3e27  l2>\\n</level1>'
+000305d0: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
+000305e0: 662e 7365 6c65 6374 2878 6d6c 6765 7428  f.select(xmlget(
+000305f0: 226f 626a 222c 206c 6974 2822 6c65 7665  "obj", lit("leve
+00030600: 6c32 2229 292e 6173 5f28 2261 6e73 2229  l2")).as_("ans")
+00030610: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00030620: 2020 2020 5b52 6f77 2841 4e53 3d27 3c6c      [Row(ANS='<l
+00030630: 6576 656c 3220 6174 7472 323d 2262 223e  evel2 attr2="b">
+00030640: 5c5c 6e20 2032 5c5c 6e20 203c 6c65 7665  \\n  2\\n  <leve
+00030650: 6c33 3e33 613c 2f6c 6576 656c 333e 5c5c  l3>3a</level3>\\
+00030660: 6e20 203c 6c65 7665 6c33 3e33 623c 2f6c  n  <level3>3b</l
+00030670: 6576 656c 333e 5c5c 6e3c 2f6c 6576 656c  evel3>\\n</level
+00030680: 323e 2729 5d0a 0a20 2020 2057 6865 6e20  2>')]..    When 
+00030690: 6d75 6c74 6970 6c65 2074 6167 7320 6578  multiple tags ex
+000306a0: 6973 7420 6174 2061 206c 6576 656c 2c20  ist at a level, 
+000306b0: 696e 7374 616e 6365 5f6e 756d 2063 616e  instance_num can
+000306c0: 2062 6520 7573 6564 2074 6f20 6469 7374   be used to dist
+000306d0: 696e 6775 6973 6820 7768 6963 6820 656c  inguish which el
+000306e0: 656d 656e 7420 746f 2072 6574 7572 6e2e  ement to return.
+000306f0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00030700: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00030710: 7365 6c65 6374 2878 6d6c 6765 7428 786d  select(xmlget(xm
+00030720: 6c67 6574 2822 6f62 6a22 2c20 6c69 7428  lget("obj", lit(
+00030730: 226c 6576 656c 3222 2929 2c20 6c69 7428  "level2")), lit(
+00030740: 226c 6576 656c 3322 292c 206c 6974 2830  "level3"), lit(0
+00030750: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
+00030760: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00030770: 205b 526f 7728 414e 533d 273c 6c65 7665   [Row(ANS='<leve
+00030780: 6c33 3e33 613c 2f6c 6576 656c 333e 2729  l3>3a</level3>')
+00030790: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+000307a0: 2e73 656c 6563 7428 786d 6c67 6574 2878  .select(xmlget(x
+000307b0: 6d6c 6765 7428 226f 626a 222c 206c 6974  mlget("obj", lit
+000307c0: 2822 6c65 7665 6c32 2229 292c 206c 6974  ("level2")), lit
+000307d0: 2822 6c65 7665 6c33 2229 2c20 6c69 7428  ("level3"), lit(
+000307e0: 3129 292e 6173 5f28 2261 6e73 2229 292e  1)).as_("ans")).
+000307f0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00030800: 2020 5b52 6f77 2841 4e53 3d27 3c6c 6576    [Row(ANS='<lev
+00030810: 656c 333e 3362 3c2f 6c65 7665 6c33 3e27  el3>3b</level3>'
+00030820: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
+00030830: 662e 7365 6c65 6374 2878 6d6c 6765 7428  f.select(xmlget(
+00030840: 226f 626a 222c 206c 6974 2822 6c65 7665  "obj", lit("leve
+00030850: 6c32 2229 2c20 6c69 7428 3529 292e 6173  l2"), lit(5)).as
+00030860: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
+00030870: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00030880: 2841 4e53 3d4e 6f6e 6529 5d0a 0a20 2020  (ANS=None)]..   
+00030890: 2049 6e20 6f72 6465 7220 746f 2067 6574   In order to get
+000308a0: 2074 6865 2074 6167 6e61 6d65 2c20 7468   the tagname, th
+000308b0: 6520 7661 6c75 6520 6f66 2061 6e20 6174  e value of an at
+000308c0: 7472 6962 7574 6520 6f72 2074 6865 2063  tribute or the c
+000308d0: 6f6e 7465 6e74 2077 6974 6869 6e20 6120  ontent within a 
+000308e0: 7461 6720 7468 6520 6067 6574 6020 6675  tag the `get` fu
+000308f0: 6e63 7469 6f6e 2063 616e 2062 6520 7573  nction can be us
+00030900: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
+00030910: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00030920: 6466 2e73 656c 6563 7428 6765 7428 786d  df.select(get(xm
+00030930: 6c67 6574 2822 6f62 6a22 2c20 6c69 7428  lget("obj", lit(
+00030940: 226c 6576 656c 3222 2929 2c20 6c69 7428  "level2")), lit(
+00030950: 2240 2229 292e 6173 5f28 2261 6e73 2229  "@")).as_("ans")
+00030960: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00030970: 2020 2020 5b52 6f77 2841 4e53 3d27 226c      [Row(ANS='"l
+00030980: 6576 656c 3222 2729 5d0a 2020 2020 2020  evel2"')].      
+00030990: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000309a0: 6765 7428 786d 6c67 6574 2822 6f62 6a22  get(xmlget("obj"
+000309b0: 2c20 6c69 7428 226c 6576 656c 3222 2929  , lit("level2"))
+000309c0: 2c20 6c69 7428 2224 2229 292e 6173 5f28  , lit("$")).as_(
+000309d0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
+000309e0: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+000309f0: 4e53 3d27 5b5c 5c6e 2020 322c 5c5c 6e20  NS='[\\n  2,\\n 
+00030a00: 207b 5c5c 6e20 2020 2022 2422 3a20 2233   {\\n    "$": "3
+00030a10: 6122 2c5c 5c6e 2020 2020 2240 223a 2022  a",\\n    "@": "
+00030a20: 6c65 7665 6c33 225c 5c6e 2020 7d2c 5c5c  level3"\\n  },\\
+00030a30: 6e20 207b 5c5c 6e20 2020 2022 2422 3a20  n  {\\n    "$": 
+00030a40: 2233 6222 2c5c 5c6e 2020 2020 2240 223a  "3b",\\n    "@":
+00030a50: 2022 6c65 7665 6c33 225c 5c6e 2020 7d5c   "level3"\\n  }\
+00030a60: 5c6e 5d27 295d 0a20 2020 2020 2020 203e  \n]')].        >
+00030a70: 3e3e 2064 662e 7365 6c65 6374 2867 6574  >> df.select(get
+00030a80: 2878 6d6c 6765 7428 786d 6c67 6574 2822  (xmlget(xmlget("
+00030a90: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
+00030aa0: 3222 2929 2c20 6c69 7428 226c 6576 656c  2")), lit("level
+00030ab0: 3322 2929 2c20 6c69 7428 2224 2229 292e  3")), lit("$")).
+00030ac0: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
+00030ad0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00030ae0: 6f77 2841 4e53 3d27 2233 6122 2729 5d0a  ow(ANS='"3a"')].
+00030af0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00030b00: 656c 6563 7428 6765 7428 786d 6c67 6574  elect(get(xmlget
+00030b10: 2822 6f62 6a22 2c20 6c69 7428 226c 6576  ("obj", lit("lev
+00030b20: 656c 3222 2929 2c20 6c69 7428 2240 6174  el2")), lit("@at
+00030b30: 7472 3222 2929 2e61 735f 2822 616e 7322  tr2")).as_("ans"
+00030b40: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00030b50: 2020 2020 205b 526f 7728 414e 533d 2722       [Row(ANS='"
+00030b60: 6222 2729 5d0a 2020 2020 2222 220a 2020  b"')].    """.  
+00030b70: 2020 6331 203d 205f 746f 5f63 6f6c 5f69    c1 = _to_col_i
+00030b80: 665f 7374 7228 786d 6c2c 2022 786d 6c67  f_str(xml, "xmlg
+00030b90: 6574 2229 0a20 2020 2063 3220 3d20 5f74  et").    c2 = _t
+00030ba0: 6f5f 636f 6c5f 6966 5f73 7472 2874 6167  o_col_if_str(tag
+00030bb0: 2c20 2278 6d6c 6765 7422 290a 2020 2020  , "xmlget").    
+00030bc0: 6333 203d 2028 0a20 2020 2020 2020 2069  c3 = (.        i
+00030bd0: 6e73 7461 6e63 655f 6e75 6d0a 2020 2020  nstance_num.    
+00030be0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00030bf0: 6528 696e 7374 616e 6365 5f6e 756d 2c20  e(instance_num, 
+00030c00: 696e 7429 0a20 2020 2020 2020 2065 6c73  int).        els
+00030c10: 6520 5f74 6f5f 636f 6c5f 6966 5f73 7472  e _to_col_if_str
+00030c20: 2869 6e73 7461 6e63 655f 6e75 6d2c 2022  (instance_num, "
+00030c30: 786d 6c67 6574 2229 0a20 2020 2029 0a20  xmlget").    ). 
+00030c40: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00030c50: 6e28 2278 6d6c 6765 7422 2928 6331 2c20  n("xmlget")(c1, 
+00030c60: 6332 2c20 6333 290a 0a0a 6465 6620 6765  c2, c3)...def ge
+00030c70: 745f 7061 7468 2863 6f6c 3a20 436f 6c75  t_path(col: Colu
+00030c80: 6d6e 4f72 4e61 6d65 2c20 7061 7468 3a20  mnOrName, path: 
+00030c90: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00030ca0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00030cb0: 0a20 2020 2045 7874 7261 6374 7320 6120  .    Extracts a 
+00030cc0: 7661 6c75 6520 6672 6f6d 2073 656d 692d  value from semi-
+00030cd0: 7374 7275 6374 7572 6564 2064 6174 6120  structured data 
+00030ce0: 7573 696e 6720 6120 7061 7468 206e 616d  using a path nam
+00030cf0: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
+00030d00: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00030d10: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00030d20: 6174 655f 6461 7461 6672 616d 6528 5b7b  ate_dataframe([{
+00030d30: 2261 223a 207b 2261 6122 3a20 7b22 6464  "a": {"aa": {"dd
+00030d40: 223a 2034 7d2c 2022 6262 223a 2032 2c20  ": 4}, "bb": 2, 
+00030d50: 2263 6322 3a20 337d 7d5d 290a 2020 2020  "cc": 3}}]).    
+00030d60: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00030d70: 7428 6765 745f 7061 7468 2864 665b 2261  t(get_path(df["a
+00030d80: 225d 2c20 6c69 7428 2261 612e 6464 2229  "], lit("aa.dd")
+00030d90: 292e 616c 6961 7328 2267 6574 5f70 6174  ).alias("get_pat
+00030da0: 6822 2929 2e63 6f6c 6c65 6374 2829 0a20  h")).collect(). 
+00030db0: 2020 2020 2020 205b 526f 7728 4745 545f         [Row(GET_
+00030dc0: 5041 5448 3d27 3427 295d 0a20 2020 2022  PATH='4')].    "
+00030dd0: 2222 0a20 2020 2063 3120 3d20 5f74 6f5f  "".    c1 = _to_
+00030de0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
+00030df0: 2267 6574 5f70 6174 6822 290a 2020 2020  "get_path").    
+00030e00: 6332 203d 205f 746f 5f63 6f6c 5f69 665f  c2 = _to_col_if_
+00030e10: 7374 7228 7061 7468 2c20 2267 6574 5f70  str(path, "get_p
+00030e20: 6174 6822 290a 2020 2020 7265 7475 726e  ath").    return
+00030e30: 2062 7569 6c74 696e 2822 6765 745f 7061   builtin("get_pa
+00030e40: 7468 2229 2863 312c 2063 3229 0a0a 0a64  th")(c1, c2)...d
+00030e50: 6566 2067 6574 2863 6f6c 313a 2055 6e69  ef get(col1: Uni
+00030e60: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00030e70: 2069 6e74 5d2c 2063 6f6c 323a 2055 6e69   int], col2: Uni
+00030e80: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00030e90: 2069 6e74 5d29 202d 3e20 436f 6c75 6d6e   int]) -> Column
+00030ea0: 3a0a 2020 2020 2222 2245 7874 7261 6374  :.    """Extract
+00030eb0: 7320 6120 7661 6c75 6520 6672 6f6d 2061  s a value from a
+00030ec0: 6e20 6f62 6a65 6374 206f 7220 6172 7261  n object or arra
+00030ed0: 793b 2072 6574 7572 6e73 204e 554c 4c20  y; returns NULL 
+00030ee0: 6966 2065 6974 6865 7220 6f66 2074 6865  if either of the
+00030ef0: 2061 7267 756d 656e 7473 2069 7320 4e55   arguments is NU
+00030f00: 4c4c 2e0a 0a20 2020 2045 7861 6d70 6c65  LL...    Example
+00030f10: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00030f20: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00030f30: 6174 6544 6174 6146 7261 6d65 285b 285b  ateDataFrame([([
+00030f40: 312c 2032 2c20 335d 2c29 2c20 285b 5d2c  1, 2, 3],), ([],
+00030f50: 295d 2c20 5b22 6461 7461 225d 290a 2020  )], ["data"]).  
+00030f60: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00030f70: 6563 7428 6765 7428 6466 2e64 6174 612c  ect(get(df.data,
+00030f80: 2031 292e 6173 5f28 2269 6478 3122 2929   1).as_("idx1"))
+00030f90: 2e73 6f72 7428 636f 6c28 2269 6478 3122  .sort(col("idx1"
+00030fa0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00030fb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00030fc0: 2020 2020 207c 2249 4458 3122 2020 7c0a       |"IDX1"  |.
+00030fd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00030fe0: 2d2d 0a20 2020 2020 2020 207c 4e55 4c4c  --.        |NULL
+00030ff0: 2020 2020 7c0a 2020 2020 2020 2020 7c32      |.        |2
+00031000: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00031010: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00031020: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00031030: 2020 2020 2222 220a 2020 2020 6331 203d      """.    c1 =
+00031040: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
+00031050: 6f72 5f69 6e74 2863 6f6c 312c 2022 6765  or_int(col1, "ge
+00031060: 7422 290a 2020 2020 6332 203d 205f 746f  t").    c2 = _to
+00031070: 5f63 6f6c 5f69 665f 7374 725f 6f72 5f69  _col_if_str_or_i
+00031080: 6e74 2863 6f6c 322c 2022 6765 7422 290a  nt(col2, "get").
+00031090: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000310a0: 696e 2822 6765 7422 2928 6331 2c20 6332  in("get")(c1, c2
+000310b0: 290a 0a0a 6465 6620 7768 656e 2863 6f6e  )...def when(con
+000310c0: 6469 7469 6f6e 3a20 436f 6c75 6d6e 4f72  dition: ColumnOr
+000310d0: 5371 6c45 7870 722c 2076 616c 7565 3a20  SqlExpr, value: 
+000310e0: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c29  ColumnOrLiteral)
+000310f0: 202d 3e20 4361 7365 4578 7072 3a0a 2020   -> CaseExpr:.  
+00031100: 2020 2222 2257 6f72 6b73 206c 696b 6520    """Works like 
+00031110: 6120 6361 7363 6164 696e 6720 6966 2d74  a cascading if-t
+00031120: 6865 6e2d 656c 7365 2073 7461 7465 6d65  hen-else stateme
+00031130: 6e74 2e0a 2020 2020 4120 7365 7269 6573  nt..    A series
+00031140: 206f 6620 636f 6e64 6974 696f 6e73 2061   of conditions a
+00031150: 7265 2065 7661 6c75 6174 6564 2069 6e20  re evaluated in 
+00031160: 7365 7175 656e 6365 2e0a 2020 2020 5768  sequence..    Wh
+00031170: 656e 2061 2063 6f6e 6469 7469 6f6e 2065  en a condition e
+00031180: 7661 6c75 6174 6573 2074 6f20 5452 5545  valuates to TRUE
+00031190: 2c20 7468 6520 6576 616c 7561 7469 6f6e  , the evaluation
+000311a0: 2073 746f 7073 2061 6e64 2074 6865 2061   stops and the a
+000311b0: 7373 6f63 6961 7465 640a 2020 2020 7265  ssociated.    re
+000311c0: 7375 6c74 2028 6166 7465 7220 5448 454e  sult (after THEN
+000311d0: 2920 6973 2072 6574 7572 6e65 642e 2049  ) is returned. I
+000311e0: 6620 6e6f 6e65 206f 6620 7468 6520 636f  f none of the co
+000311f0: 6e64 6974 696f 6e73 2065 7661 6c75 6174  nditions evaluat
+00031200: 6520 746f 2054 5255 452c 0a20 2020 2074  e to TRUE,.    t
+00031210: 6865 6e20 7468 6520 7265 7375 6c74 2061  hen the result a
+00031220: 6674 6572 2074 6865 206f 7074 696f 6e61  fter the optiona
+00031230: 6c20 4f54 4845 5257 4953 4520 6973 2072  l OTHERWISE is r
+00031240: 6574 7572 6e65 642c 2069 6620 7072 6573  eturned, if pres
+00031250: 656e 743b 0a20 2020 206f 7468 6572 7769  ent;.    otherwi
+00031260: 7365 204e 554c 4c20 6973 2072 6574 7572  se NULL is retur
+00031270: 6e65 642e 0a0a 2020 2020 4172 6773 3a0a  ned...    Args:.
+00031280: 2020 2020 2020 2020 636f 6e64 6974 696f          conditio
+00031290: 6e3a 2041 203a 636c 6173 733a 6043 6f6c  n: A :class:`Col
+000312a0: 756d 6e60 2065 7870 7265 7373 696f 6e20  umn` expression 
+000312b0: 6f72 2053 514c 2074 6578 7420 7265 7072  or SQL text repr
+000312c0: 6573 656e 7469 6e67 2074 6865 2073 7065  esenting the spe
+000312d0: 6369 6669 6564 2063 6f6e 6469 7469 6f6e  cified condition
+000312e0: 2e0a 2020 2020 2020 2020 7661 6c75 653a  ..        value:
+000312f0: 2041 203a 636c 6173 733a 6043 6f6c 756d   A :class:`Colum
+00031300: 6e60 2065 7870 7265 7373 696f 6e20 6f72  n` expression or
+00031310: 2061 206c 6974 6572 616c 2076 616c 7565   a literal value
+00031320: 2c20 7768 6963 6820 7769 6c6c 2062 6520  , which will be 
+00031330: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+00031340: 2020 2020 2069 6620 6060 636f 6e64 6974       if ``condit
+00031350: 696f 6e60 6020 6973 2074 7275 652e 0a0a  ion`` is true...
+00031360: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00031370: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00031380: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00031390: 6174 6166 7261 6d65 285b 312c 204e 6f6e  ataframe([1, Non
+000313a0: 652c 2032 2c20 332c 204e 6f6e 652c 2035  e, 2, 3, None, 5
+000313b0: 2c20 365d 2c20 7363 6865 6d61 3d5b 2261  , 6], schema=["a
+000313c0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000313d0: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+000313e0: 2020 2020 205b 526f 7728 413d 3129 2c20       [Row(A=1), 
+000313f0: 526f 7728 413d 4e6f 6e65 292c 2052 6f77  Row(A=None), Row
+00031400: 2841 3d32 292c 2052 6f77 2841 3d33 292c  (A=2), Row(A=3),
+00031410: 2052 6f77 2841 3d4e 6f6e 6529 2c20 526f   Row(A=None), Ro
+00031420: 7728 413d 3529 2c20 526f 7728 413d 3629  w(A=5), Row(A=6)
+00031430: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+00031440: 2e73 656c 6563 7428 7768 656e 2863 6f6c  .select(when(col
+00031450: 2822 6122 2920 2520 3220 3d3d 2030 2c20  ("a") % 2 == 0, 
+00031460: 6c69 7428 2265 7665 6e22 2929 2e61 735f  lit("even")).as_
+00031470: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
+00031480: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00031490: 414e 533d 4e6f 6e65 292c 2052 6f77 2841  ANS=None), Row(A
+000314a0: 4e53 3d4e 6f6e 6529 2c20 526f 7728 414e  NS=None), Row(AN
+000314b0: 533d 2765 7665 6e27 292c 2052 6f77 2841  S='even'), Row(A
+000314c0: 4e53 3d4e 6f6e 6529 2c20 526f 7728 414e  NS=None), Row(AN
+000314d0: 533d 4e6f 6e65 292c 2052 6f77 2841 4e53  S=None), Row(ANS
+000314e0: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
+000314f0: 2765 7665 6e27 295d 0a0a 2020 2020 4d75  'even')]..    Mu
+00031500: 6c74 6970 6c65 2077 6865 6e20 7374 6174  ltiple when stat
+00031510: 656d 656e 7473 2063 616e 2062 6520 6368  ements can be ch
+00031520: 616e 6765 6420 616e 6420 606f 7468 6572  anged and `other
+00031530: 7769 7365 602f 6065 6c73 655f 6020 7573  wise`/`else_` us
+00031540: 6564 2074 6f20 6372 6561 7465 2065 7870  ed to create exp
+00031550: 7265 7373 696f 6e73 2073 696d 696c 6172  ressions similar
+00031560: 2074 6f20 6060 4341 5345 2057 4845 4e20   to ``CASE WHEN 
+00031570: 2e2e 2e20 454c 5345 202e 2e2e 2045 4e44  ... ELSE ... END
+00031580: 6060 2069 6e20 5351 4c2e 0a0a 2020 2020  `` in SQL...    
+00031590: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000315a0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000315b0: 2877 6865 6e28 636f 6c28 2261 2229 2025  (when(col("a") %
+000315c0: 2032 203d 3d20 302c 206c 6974 2822 6576   2 == 0, lit("ev
+000315d0: 656e 2229 292e 7768 656e 2863 6f6c 2822  en")).when(col("
+000315e0: 6122 2920 2520 3220 3d3d 2031 2c20 6c69  a") % 2 == 1, li
+000315f0: 7428 226f 6464 2229 292e 6173 5f28 2261  t("odd")).as_("a
+00031600: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
+00031610: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+00031620: 3d27 6f64 6427 292c 2052 6f77 2841 4e53  ='odd'), Row(ANS
+00031630: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
+00031640: 2765 7665 6e27 292c 2052 6f77 2841 4e53  'even'), Row(ANS
+00031650: 3d27 6f64 6427 292c 2052 6f77 2841 4e53  ='odd'), Row(ANS
+00031660: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
+00031670: 276f 6464 2729 2c20 526f 7728 414e 533d  'odd'), Row(ANS=
+00031680: 2765 7665 6e27 295d 0a20 2020 2020 2020  'even')].       
+00031690: 203e 3e3e 2064 662e 7365 6c65 6374 2877   >>> df.select(w
+000316a0: 6865 6e28 636f 6c28 2261 2229 2025 2032  hen(col("a") % 2
+000316b0: 203d 3d20 302c 206c 6974 2822 6576 656e   == 0, lit("even
+000316c0: 2229 292e 7768 656e 2863 6f6c 2822 6122  ")).when(col("a"
+000316d0: 2920 2520 3220 3d3d 2031 2c20 6c69 7428  ) % 2 == 1, lit(
+000316e0: 226f 6464 2229 292e 6f74 6865 7277 6973  "odd")).otherwis
+000316f0: 6528 6c69 7428 2275 6e6b 6e6f 776e 2229  e(lit("unknown")
+00031700: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
+00031710: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00031720: 5b52 6f77 2841 4e53 3d27 6f64 6427 292c  [Row(ANS='odd'),
+00031730: 2052 6f77 2841 4e53 3d27 756e 6b6e 6f77   Row(ANS='unknow
+00031740: 6e27 292c 2052 6f77 2841 4e53 3d27 6576  n'), Row(ANS='ev
+00031750: 656e 2729 2c20 526f 7728 414e 533d 276f  en'), Row(ANS='o
+00031760: 6464 2729 2c20 526f 7728 414e 533d 2775  dd'), Row(ANS='u
+00031770: 6e6b 6e6f 776e 2729 2c20 526f 7728 414e  nknown'), Row(AN
+00031780: 533d 276f 6464 2729 2c20 526f 7728 414e  S='odd'), Row(AN
+00031790: 533d 2765 7665 6e27 295d 0a20 2020 2022  S='even')].    "
+000317a0: 2222 0a20 2020 2072 6574 7572 6e20 4361  "".    return Ca
+000317b0: 7365 4578 7072 280a 2020 2020 2020 2020  seExpr(.        
+000317c0: 4361 7365 5768 656e 280a 2020 2020 2020  CaseWhen(.      
+000317d0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000317e0: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
+000317f0: 2020 2020 2020 2020 2020 2020 2020 5f74                _t
+00031800: 6f5f 636f 6c5f 6966 5f73 716c 5f65 7870  o_col_if_sql_exp
+00031810: 7228 636f 6e64 6974 696f 6e2c 2022 7768  r(condition, "wh
+00031820: 656e 2229 2e5f 6578 7072 6573 7369 6f6e  en")._expression
+00031830: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031840: 2020 2020 2020 436f 6c75 6d6e 2e5f 746f        Column._to
+00031850: 5f65 7870 7228 7661 6c75 6529 2c0a 2020  _expr(value),.  
+00031860: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00031870: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00031880: 2020 2020 2020 290a 2020 2020 290a 0a0a        ).    )...
+00031890: 6465 6620 6966 6628 0a20 2020 2063 6f6e  def iff(.    con
+000318a0: 6469 7469 6f6e 3a20 436f 6c75 6d6e 4f72  dition: ColumnOr
+000318b0: 5371 6c45 7870 722c 0a20 2020 2065 7870  SqlExpr,.    exp
+000318c0: 7231 3a20 436f 6c75 6d6e 4f72 4c69 7465  r1: ColumnOrLite
+000318d0: 7261 6c2c 0a20 2020 2065 7870 7232 3a20  ral,.    expr2: 
+000318e0: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c2c  ColumnOrLiteral,
+000318f0: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
+00031900: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+00031910: 7320 6f6e 6520 6f66 2074 776f 2073 7065  s one of two spe
+00031920: 6369 6669 6564 2065 7870 7265 7373 696f  cified expressio
+00031930: 6e73 2c20 6465 7065 6e64 696e 6720 6f6e  ns, depending on
+00031940: 2061 2063 6f6e 6469 7469 6f6e 2e0a 2020   a condition..  
+00031950: 2020 5468 6973 2069 7320 6571 7569 7661    This is equiva
+00031960: 6c65 6e74 2074 6f20 616e 2060 6069 662d  lent to an ``if-
+00031970: 7468 656e 2d65 6c73 6560 6020 6578 7072  then-else`` expr
+00031980: 6573 7369 6f6e 2e0a 0a20 2020 2041 7267  ession...    Arg
+00031990: 733a 0a20 2020 2020 2020 2063 6f6e 6469  s:.        condi
+000319a0: 7469 6f6e 3a20 4120 3a63 6c61 7373 3a60  tion: A :class:`
+000319b0: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
+000319c0: 6f6e 206f 7220 5351 4c20 7465 7874 2072  on or SQL text r
+000319d0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+000319e0: 7370 6563 6966 6965 6420 636f 6e64 6974  specified condit
+000319f0: 696f 6e2e 0a20 2020 2020 2020 2065 7870  ion..        exp
+00031a00: 7231 3a20 4120 3a63 6c61 7373 3a60 436f  r1: A :class:`Co
+00031a10: 6c75 6d6e 6020 6578 7072 6573 7369 6f6e  lumn` expression
+00031a20: 206f 7220 6120 6c69 7465 7261 6c20 7661   or a literal va
+00031a30: 6c75 652c 2077 6869 6368 2077 696c 6c20  lue, which will 
+00031a40: 6265 2072 6574 7572 6e65 640a 2020 2020  be returned.    
+00031a50: 2020 2020 2020 2020 6966 2060 6063 6f6e          if ``con
+00031a60: 6469 7469 6f6e 6060 2069 7320 7472 7565  dition`` is true
+00031a70: 2e0a 2020 2020 2020 2020 6578 7072 323a  ..        expr2:
+00031a80: 2041 203a 636c 6173 733a 6043 6f6c 756d   A :class:`Colum
+00031a90: 6e60 2065 7870 7265 7373 696f 6e20 6f72  n` expression or
+00031aa0: 2061 206c 6974 6572 616c 2076 616c 7565   a literal value
+00031ab0: 2c20 7768 6963 6820 7769 6c6c 2062 6520  , which will be 
+00031ac0: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+00031ad0: 2020 2020 2069 6620 6060 636f 6e64 6974       if ``condit
+00031ae0: 696f 6e60 6020 6973 2066 616c 7365 2e0a  ion`` is false..
+00031af0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+00031b00: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00031b10: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00031b20: 5f64 6174 6166 7261 6d65 285b 5472 7565  _dataframe([True
+00031b30: 2c20 4661 6c73 652c 204e 6f6e 655d 2c20  , False, None], 
+00031b40: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00031b50: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00031b60: 6563 7428 6966 6628 6466 5b22 6122 5d2c  ect(iff(df["a"],
+00031b70: 206c 6974 2822 7472 7565 2229 2c20 6c69   lit("true"), li
+00031b80: 7428 2266 616c 7365 2229 292e 616c 6961  t("false")).alia
+00031b90: 7328 2269 6666 2229 292e 636f 6c6c 6563  s("iff")).collec
+00031ba0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00031bb0: 2849 4646 3d27 7472 7565 2729 2c20 526f  (IFF='true'), Ro
+00031bc0: 7728 4946 463d 2766 616c 7365 2729 2c20  w(IFF='false'), 
+00031bd0: 526f 7728 4946 463d 2766 616c 7365 2729  Row(IFF='false')
+00031be0: 5d0a 2020 2020 2222 220a 2020 2020 7265  ].    """.    re
+00031bf0: 7475 726e 2062 7569 6c74 696e 2822 6966  turn builtin("if
+00031c00: 6622 2928 5f74 6f5f 636f 6c5f 6966 5f73  f")(_to_col_if_s
+00031c10: 716c 5f65 7870 7228 636f 6e64 6974 696f  ql_expr(conditio
+00031c20: 6e2c 2022 6966 6622 292c 2065 7870 7231  n, "iff"), expr1
+00031c30: 2c20 6578 7072 3229 0a0a 0a64 6566 2069  , expr2)...def i
+00031c40: 6e5f 280a 2020 2020 636f 6c73 3a20 4c69  n_(.    cols: Li
+00031c50: 7374 5b43 6f6c 756d 6e4f 724e 616d 655d  st[ColumnOrName]
+00031c60: 2c0a 2020 2020 2a76 616c 733a 2055 6e69  ,.    *vals: Uni
+00031c70: 6f6e 5b22 736e 6f77 666c 616b 652e 736e  on["snowflake.sn
+00031c80: 6f77 7061 726b 2e44 6174 6146 7261 6d65  owpark.DataFrame
+00031c90: 222c 204c 6974 6572 616c 5479 7065 2c20  ", LiteralType, 
+00031ca0: 4974 6572 6162 6c65 5b4c 6974 6572 616c  Iterable[Literal
+00031cb0: 5479 7065 5d5d 2c0a 2920 2d3e 2043 6f6c  Type]],.) -> Col
+00031cc0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00031cd0: 726e 7320 6120 636f 6e64 6974 696f 6e61  rns a conditiona
+00031ce0: 6c20 6578 7072 6573 7369 6f6e 2074 6861  l expression tha
+00031cf0: 7420 796f 7520 6361 6e20 7061 7373 2074  t you can pass t
+00031d00: 6f20 7468 6520 6669 6c74 6572 206f 7220  o the filter or 
+00031d10: 7768 6572 6520 6d65 7468 6f64 7320 746f  where methods to
+00031d20: 0a20 2020 2070 6572 666f 726d 2074 6865  .    perform the
+00031d30: 2065 7175 6976 616c 656e 7420 6f66 2061   equivalent of a
+00031d40: 2057 4845 5245 202e 2e2e 2049 4e20 7175   WHERE ... IN qu
+00031d50: 6572 7920 7468 6174 206d 6174 6368 6573  ery that matches
+00031d60: 2072 6f77 7320 636f 6e74 6169 6e69 6e67   rows containing
+00031d70: 2061 2073 6571 7565 6e63 6520 6f66 0a20   a sequence of. 
+00031d80: 2020 2076 616c 7565 732e 0a0a 2020 2020     values...    
+00031d90: 5468 6520 6578 7072 6573 7369 6f6e 2065  The expression e
+00031da0: 7661 6c75 6174 6573 2074 6f20 7472 7565  valuates to true
+00031db0: 2069 6620 7468 6520 7661 6c75 6573 2069   if the values i
+00031dc0: 6e20 6120 726f 7720 6d61 7463 6865 7320  n a row matches 
+00031dd0: 7468 6520 7661 6c75 6573 2069 6e20 6f6e  the values in on
+00031de0: 6520 6f66 0a20 2020 2074 6865 2073 7065  e of.    the spe
+00031df0: 6369 6669 6564 2073 6571 7565 6e63 6573  cified sequences
+00031e00: 2e0a 0a20 2020 2054 6865 2066 6f6c 6c6f  ...    The follo
+00031e10: 7769 6e67 2063 6f64 6520 7265 7475 726e  wing code return
+00031e20: 7320 6120 4461 7461 4672 616d 6520 7468  s a DataFrame th
+00031e30: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
+00031e40: 726f 7773 2069 6e20 7768 6963 680a 2020  rows in which.  
+00031e50: 2020 7468 6520 636f 6c75 6d6e 7320 6063    the columns `c
+00031e60: 3160 2061 6e64 2060 6332 6020 636f 6e74  1` and `c2` cont
+00031e70: 6169 6e20 7468 6520 7661 6c75 6573 3a0a  ain the values:.
+00031e80: 2020 2020 2d20 6031 6020 616e 6420 6022      - `1` and `"
+00031e90: 6122 602c 206f 720a 2020 2020 2d20 6032  a"`, or.    - `2
+00031ea0: 6020 616e 6420 6022 6222 600a 2020 2020  ` and `"b"`.    
+00031eb0: 5468 6973 2069 7320 6571 7569 7661 6c65  This is equivale
+00031ec0: 6e74 2074 6f20 6060 5345 4c45 4354 202a  nt to ``SELECT *
+00031ed0: 2046 524f 4d20 7461 626c 6520 5748 4552   FROM table WHER
+00031ee0: 4520 2863 312c 2063 3229 2049 4e20 2828  E (c1, c2) IN ((
+00031ef0: 312c 2027 6127 292c 2028 322c 2027 6227  1, 'a'), (2, 'b'
+00031f00: 2929 6060 2e0a 0a20 2020 2045 7861 6d70  ))``...    Examp
+00031f10: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+00031f20: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00031f30: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00031f40: 5b5b 312c 2022 6122 5d2c 205b 322c 2022  [[1, "a"], [2, "
+00031f50: 6222 5d2c 205b 332c 2022 6322 5d5d 2c20  b"], [3, "c"]], 
+00031f60: 7363 6865 6d61 3d5b 2263 6f6c 3122 2c20  schema=["col1", 
+00031f70: 2263 6f6c 3222 5d29 0a20 2020 2020 2020  "col2"]).       
+00031f80: 203e 3e3e 2064 662e 6669 6c74 6572 2869   >>> df.filter(i
+00031f90: 6e5f 285b 636f 6c28 2263 6f6c 3122 292c  n_([col("col1"),
+00031fa0: 2063 6f6c 2822 636f 6c32 2229 5d2c 205b   col("col2")], [
+00031fb0: 5b31 2c20 2261 225d 2c20 5b32 2c20 2262  [1, "a"], [2, "b
+00031fc0: 225d 5d29 292e 7368 6f77 2829 0a20 2020  "]])).show().   
+00031fd0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00031fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00031ff0: 207c 2243 4f4c 3122 2020 7c22 434f 4c32   |"COL1"  |"COL2
+00032000: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00032010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00032020: 0a20 2020 2020 2020 207c 3120 2020 2020  .        |1     
+00032030: 2020 7c61 2020 2020 2020 207c 0a20 2020    |a       |.   
+00032040: 2020 2020 207c 3220 2020 2020 2020 7c62       |2       |b
+00032050: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00032060: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00032070: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00032080: 414e 4b4c 494e 453e 0a0a 2020 2020 5468  ANKLINE>..    Th
+00032090: 6520 666f 6c6c 6f77 696e 6720 636f 6465  e following code
+000320a0: 2072 6574 7572 6e73 2061 2044 6174 6146   returns a DataF
+000320b0: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
+000320c0: 6e73 2074 6865 2072 6f77 7320 7768 6572  ns the rows wher
+000320d0: 650a 2020 2020 7468 6520 7661 6c75 6573  e.    the values
+000320e0: 206f 6620 7468 6520 636f 6c75 6d6e 7320   of the columns 
+000320f0: 6063 3160 2061 6e64 2060 6332 6020 696e  `c1` and `c2` in
+00032100: 2060 6466 3260 206d 6174 6368 2074 6865   `df2` match the
+00032110: 2076 616c 7565 7320 6f66 2074 6865 2063   values of the c
+00032120: 6f6c 756d 6e73 0a20 2020 2060 6160 2061  olumns.    `a` a
+00032130: 6e64 2060 6260 2069 6e20 6064 6631 602e  nd `b` in `df1`.
+00032140: 2054 6869 7320 6973 2065 7175 6976 616c   This is equival
+00032150: 656e 7420 746f 0a20 2020 2060 6053 454c  ent to.    ``SEL
+00032160: 4543 5420 2a20 4652 4f4d 2074 6162 6c65  ECT * FROM table
+00032170: 3220 5748 4552 4520 2863 312c 2063 3229  2 WHERE (c1, c2)
+00032180: 2049 4e20 2853 454c 4543 5420 612c 2062   IN (SELECT a, b
+00032190: 2046 524f 4d20 7461 626c 6531 2960 602e   FROM table1)``.
+000321a0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+000321b0: 0a20 2020 2020 2020 203e 3e3e 2064 6631  .        >>> df1
+000321c0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+000321d0: 7365 6c65 6374 2031 2c20 2761 2722 290a  select 1, 'a'").
+000321e0: 2020 2020 2020 2020 3e3e 3e20 6466 2e66          >>> df.f
+000321f0: 696c 7465 7228 696e 5f28 5b63 6f6c 2822  ilter(in_([col("
+00032200: 636f 6c31 2229 2c20 636f 6c28 2263 6f6c  col1"), col("col
+00032210: 3222 295d 2c20 6466 3129 292e 7368 6f77  2")], df1)).show
+00032220: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00032230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00032240: 2020 2020 2020 207c 2243 4f4c 3122 2020         |"COL1"  
+00032250: 7c22 434f 4c32 2220 207c 0a20 2020 2020  |"COL2"  |.     
+00032260: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00032270: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00032280: 3120 2020 2020 2020 7c61 2020 2020 2020  1       |a      
+00032290: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000322a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+000322b0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+000322c0: 453e 0a0a 2020 2020 4172 6773 3a3a 0a20  E>..    Args::. 
+000322d0: 2020 2020 2020 2063 6f6c 733a 2041 206c         cols: A l
+000322e0: 6973 7420 6f66 2074 6865 2063 6f6c 756d  ist of the colum
+000322f0: 6e73 2074 6f20 636f 6d70 6172 6520 666f  ns to compare fo
+00032300: 7220 7468 6520 494e 206f 7065 7261 7469  r the IN operati
+00032310: 6f6e 2e0a 2020 2020 2020 2020 7661 6c73  on..        vals
+00032320: 3a20 4120 6c69 7374 2063 6f6e 7461 696e  : A list contain
+00032330: 696e 6720 7468 6520 7661 6c75 6573 2074  ing the values t
+00032340: 6f20 636f 6d70 6172 6520 666f 7220 7468  o compare for th
+00032350: 6520 494e 206f 7065 7261 7469 6f6e 2e0a  e IN operation..
+00032360: 2020 2020 2222 220a 2020 2020 7661 6c73      """.    vals
+00032370: 203d 2070 6172 7365 5f70 6f73 6974 696f   = parse_positio
+00032380: 6e61 6c5f 6172 6773 5f74 6f5f 6c69 7374  nal_args_to_list
+00032390: 282a 7661 6c73 290a 2020 2020 636f 6c75  (*vals).    colu
+000323a0: 6d6e 7320 3d20 5b5f 746f 5f63 6f6c 5f69  mns = [_to_col_i
+000323b0: 665f 7374 7228 632c 2022 696e 5f22 2920  f_str(c, "in_") 
+000323c0: 666f 7220 6320 696e 2063 6f6c 735d 0a20  for c in cols]. 
+000323d0: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
+000323e0: 284d 756c 7469 706c 6545 7870 7265 7373  (MultipleExpress
+000323f0: 696f 6e28 5b63 2e5f 6578 7072 6573 7369  ion([c._expressi
+00032400: 6f6e 2066 6f72 2063 2069 6e20 636f 6c75  on for c in colu
+00032410: 6d6e 735d 2929 2e69 6e5f 2876 616c 7329  mns])).in_(vals)
+00032420: 0a0a 0a64 6566 2063 756d 655f 6469 7374  ...def cume_dist
+00032430: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+00032440: 2020 2222 220a 2020 2020 4669 6e64 7320    """.    Finds 
+00032450: 7468 6520 6375 6d75 6c61 7469 7665 2064  the cumulative d
+00032460: 6973 7472 6962 7574 696f 6e20 6f66 2061  istribution of a
+00032470: 2076 616c 7565 2077 6974 6820 7265 6761   value with rega
+00032480: 7264 2074 6f20 6f74 6865 7220 7661 6c75  rd to other valu
+00032490: 6573 0a20 2020 2077 6974 6869 6e20 7468  es.    within th
+000324a0: 6520 7361 6d65 2077 696e 646f 7720 7061  e same window pa
+000324b0: 7274 6974 696f 6e2e 0a0a 2020 2020 4578  rtition...    Ex
+000324c0: 616d 706c 653a 0a0a 2020 2020 2020 2020  ample:..        
+000324d0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+000324e0: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
+000324f0: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
+00032500: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00032510: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00032520: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00032530: 7420 4465 6369 6d61 6c54 7970 650a 2020  t DecimalType.  
+00032540: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00032550: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00032560: 7461 6672 616d 6528 5b5b 312c 2032 5d2c  taframe([[1, 2],
+00032570: 205b 312c 2032 5d2c 205b 312c 335d 2c20   [1, 2], [1,3], 
+00032580: 5b34 2c20 355d 2c20 5b32 2c20 335d 2c20  [4, 5], [2, 3], 
+00032590: 5b33 2c20 345d 2c20 5b34 2c20 375d 2c20  [3, 4], [4, 7], 
+000325a0: 5b33 2c37 5d2c 205b 342c 355d 5d2c 2073  [3,7], [4,5]], s
+000325b0: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
+000325c0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000325d0: 2e73 656c 6563 7428 6375 6d65 5f64 6973  .select(cume_dis
+000325e0: 7428 292e 6f76 6572 2857 696e 646f 772e  t().over(Window.
+000325f0: 6f72 6465 725f 6279 2822 6122 2929 2e63  order_by("a")).c
+00032600: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
+00032610: 7363 616c 653d 3329 292e 616c 6961 7328  scale=3)).alias(
+00032620: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00032630: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00032640: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00032650: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+00032660: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00032670: 0a20 2020 2020 2020 207c 302e 3333 3320  .        |0.333 
+00032680: 2020 2020 7c0a 2020 2020 2020 2020 7c30      |.        |0
+00032690: 2e33 3333 2020 2020 207c 0a20 2020 2020  .333     |.     
+000326a0: 2020 207c 302e 3333 3320 2020 2020 7c0a     |0.333     |.
+000326b0: 2020 2020 2020 2020 7c30 2e34 3434 2020          |0.444  
+000326c0: 2020 207c 0a20 2020 2020 2020 207c 302e     |.        |0.
+000326d0: 3636 3720 2020 2020 7c0a 2020 2020 2020  667     |.      
+000326e0: 2020 7c30 2e36 3637 2020 2020 207c 0a20    |0.667     |. 
+000326f0: 2020 2020 2020 207c 312e 3030 3020 2020         |1.000   
+00032700: 2020 7c0a 2020 2020 2020 2020 7c31 2e30    |.        |1.0
+00032710: 3030 2020 2020 207c 0a20 2020 2020 2020  00     |.       
+00032720: 207c 312e 3030 3020 2020 2020 7c0a 2020   |1.000     |.  
+00032730: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00032740: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00032750: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00032760: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00032770: 6e28 2263 756d 655f 6469 7374 2229 2829  n("cume_dist")()
+00032780: 0a0a 0a64 6566 2072 616e 6b28 2920 2d3e  ...def rank() ->
+00032790: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000327a0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
+000327b0: 2072 616e 6b20 6f66 2061 2076 616c 7565   rank of a value
+000327c0: 2077 6974 6869 6e20 616e 206f 7264 6572   within an order
+000327d0: 6564 2067 726f 7570 206f 6620 7661 6c75  ed group of valu
+000327e0: 6573 2e0a 2020 2020 5468 6520 7261 6e6b  es..    The rank
+000327f0: 2076 616c 7565 2073 7461 7274 7320 6174   value starts at
+00032800: 2031 2061 6e64 2063 6f6e 7469 6e75 6573   1 and continues
+00032810: 2075 702e 0a0a 2020 2020 4578 616d 706c   up...    Exampl
+00032820: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00032830: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00032840: 6e6f 7770 6172 6b2e 7769 6e64 6f77 2069  nowpark.window i
+00032850: 6d70 6f72 7420 5769 6e64 6f77 0a20 2020  mport Window.   
+00032860: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00032870: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00032880: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+00032890: 2e2e 2e20 2020 2020 5b0a 2020 2020 2020  ...     [.      
+000328a0: 2020 2e2e 2e20 2020 2020 2020 2020 5b31    ...         [1
+000328b0: 2c20 322c 2031 5d2c 0a20 2020 2020 2020  , 2, 1],.       
+000328c0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
+000328d0: 2032 2c20 335d 2c0a 2020 2020 2020 2020   2, 3],.        
+000328e0: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+000328f0: 312c 2031 305d 2c0a 2020 2020 2020 2020  1, 10],.        
+00032900: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+00032910: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
+00032920: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
+00032930: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
+00032940: 2e20 2020 2020 5d2c 0a20 2020 2020 2020  .     ],.       
+00032950: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00032960: 5b22 7822 2c20 2279 222c 2022 7a22 5d0a  ["x", "y", "z"].
+00032970: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+00032980: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00032990: 6563 7428 7261 6e6b 2829 2e6f 7665 7228  ect(rank().over(
+000329a0: 5769 6e64 6f77 2e70 6172 7469 7469 6f6e  Window.partition
+000329b0: 5f62 7928 636f 6c28 2258 2229 292e 6f72  _by(col("X")).or
+000329c0: 6465 725f 6279 2863 6f6c 2822 5922 2929  der_by(col("Y"))
+000329d0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+000329e0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000329f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00032a00: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00032a10: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00032a20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00032a30: 207c 3120 2020 2020 2020 2020 7c0a 2020   |1         |.  
+00032a40: 2020 2020 2020 7c32 2020 2020 2020 2020        |2        
+00032a50: 207c 0a20 2020 2020 2020 207c 3220 2020   |.        |2   
+00032a60: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00032a70: 7c31 2020 2020 2020 2020 207c 0a20 2020  |1         |.   
+00032a80: 2020 2020 207c 3120 2020 2020 2020 2020       |1         
+00032a90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00032aa0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00032ab0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00032ac0: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+00032ad0: 696c 7469 6e28 2272 616e 6b22 2928 290a  iltin("rank")().
+00032ae0: 0a0a 6465 6620 7065 7263 656e 745f 7261  ..def percent_ra
+00032af0: 6e6b 2829 202d 3e20 436f 6c75 6d6e 3a0a  nk() -> Column:.
+00032b00: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+00032b10: 726e 7320 7468 6520 7265 6c61 7469 7665  rns the relative
+00032b20: 2072 616e 6b20 6f66 2061 2076 616c 7565   rank of a value
+00032b30: 2077 6974 6869 6e20 6120 6772 6f75 7020   within a group 
+00032b40: 6f66 2076 616c 7565 732c 2073 7065 6369  of values, speci
+00032b50: 6669 6564 2061 7320 6120 7065 7263 656e  fied as a percen
+00032b60: 7461 6765 0a20 2020 2072 616e 6769 6e67  tage.    ranging
+00032b70: 2066 726f 6d20 302e 3020 746f 2031 2e30   from 0.0 to 1.0
+00032b80: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00032b90: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00032ba0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00032bb0: 7061 726b 2e77 696e 646f 7720 696d 706f  park.window impo
+00032bc0: 7274 2057 696e 646f 770a 2020 2020 2020  rt Window.      
+00032bd0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00032be0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00032bf0: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+00032c00: 2020 2020 205b 0a20 2020 2020 2020 202e       [.        .
+00032c10: 2e2e 2020 2020 2020 2020 205b 312c 2032  ..         [1, 2
+00032c20: 2c20 315d 2c0a 2020 2020 2020 2020 2e2e  , 1],.        ..
+00032c30: 2e20 2020 2020 2020 2020 5b31 2c20 322c  .         [1, 2,
+00032c40: 2033 5d2c 0a20 2020 2020 2020 202e 2e2e   3],.        ...
+00032c50: 2020 2020 2020 2020 205b 322c 2031 2c20           [2, 1, 
+00032c60: 3130 5d2c 0a20 2020 2020 2020 202e 2e2e  10],.        ...
+00032c70: 2020 2020 2020 2020 205b 322c 2032 2c20           [2, 2, 
+00032c80: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
+00032c90: 2020 2020 2020 2020 5b32 2c20 322c 2033          [2, 2, 3
+00032ca0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00032cb0: 2020 205d 2c0a 2020 2020 2020 2020 2e2e     ],.        ..
+00032cc0: 2e20 2020 2020 7363 6865 6d61 3d5b 2278  .     schema=["x
+00032cd0: 222c 2022 7922 2c20 227a 225d 0a20 2020  ", "y", "z"].   
+00032ce0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+00032cf0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00032d00: 2870 6572 6365 6e74 5f72 616e 6b28 292e  (percent_rank().
+00032d10: 6f76 6572 2857 696e 646f 772e 7061 7274  over(Window.part
+00032d20: 6974 696f 6e5f 6279 2822 7822 292e 6f72  ition_by("x").or
+00032d30: 6465 725f 6279 2863 6f6c 2822 7922 2929  der_by(col("y"))
+00032d40: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00032d50: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00032d60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00032d70: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00032d80: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00032d90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00032da0: 207c 302e 3020 2020 2020 2020 7c0a 2020   |0.0       |.  
+00032db0: 2020 2020 2020 7c30 2e35 2020 2020 2020        |0.5      
+00032dc0: 207c 0a20 2020 2020 2020 207c 302e 3520   |.        |0.5 
+00032dd0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00032de0: 7c30 2e30 2020 2020 2020 207c 0a20 2020  |0.0       |.   
+00032df0: 2020 2020 207c 302e 3020 2020 2020 2020       |0.0       
+00032e00: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00032e10: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00032e20: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00032e30: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+00032e40: 696c 7469 6e28 2270 6572 6365 6e74 5f72  iltin("percent_r
+00032e50: 616e 6b22 2928 290a 0a0a 6465 6620 6465  ank")()...def de
+00032e60: 6e73 655f 7261 6e6b 2829 202d 3e20 436f  nse_rank() -> Co
+00032e70: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00032e80: 2020 5265 7475 726e 7320 7468 6520 7261    Returns the ra
+00032e90: 6e6b 206f 6620 6120 7661 6c75 6520 7769  nk of a value wi
+00032ea0: 7468 696e 2061 2067 726f 7570 206f 6620  thin a group of 
+00032eb0: 7661 6c75 6573 2c20 7769 7468 6f75 7420  values, without 
+00032ec0: 6761 7073 2069 6e20 7468 6520 7261 6e6b  gaps in the rank
+00032ed0: 732e 0a20 2020 2054 6865 2072 616e 6b20  s..    The rank 
+00032ee0: 7661 6c75 6520 7374 6172 7473 2061 7420  value starts at 
+00032ef0: 3120 616e 6420 636f 6e74 696e 7565 7320  1 and continues 
+00032f00: 7570 2073 6571 7565 6e74 6961 6c6c 792e  up sequentially.
+00032f10: 0a20 2020 2049 6620 7477 6f20 7661 6c75  .    If two valu
+00032f20: 6573 2061 7265 2074 6865 2073 616d 652c  es are the same,
+00032f30: 2074 6865 7920 7769 6c6c 2068 6176 6520   they will have 
+00032f40: 7468 6520 7361 6d65 2072 616e 6b2e 0a0a  the same rank...
+00032f50: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00032f60: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00032f70: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00032f80: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
+00032f90: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
+00032fa0: 3e3e 3e20 7769 6e64 6f77 203d 2057 696e  >>> window = Win
+00032fb0: 646f 772e 6f72 6465 725f 6279 2822 6b65  dow.order_by("ke
+00032fc0: 7922 290a 2020 2020 2020 2020 3e3e 3e20  y").        >>> 
+00032fd0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00032fe0: 6174 655f 6461 7461 6672 616d 6528 5b28  ate_dataframe([(
+00032ff0: 312c 2022 3122 292c 2028 322c 2022 3222  1, "1"), (2, "2"
+00033000: 292c 2028 312c 2022 3322 292c 2028 322c  ), (1, "3"), (2,
+00033010: 2022 3422 295d 2c20 7363 6865 6d61 3d5b   "4")], schema=[
+00033020: 226b 6579 222c 2022 7661 6c75 6522 5d29  "key", "value"])
+00033030: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00033040: 7365 6c65 6374 2864 656e 7365 5f72 616e  select(dense_ran
+00033050: 6b28 292e 6f76 6572 2877 696e 646f 7729  k().over(window)
+00033060: 2e61 735f 2822 6465 6e73 655f 7261 6e6b  .as_("dense_rank
+00033070: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00033080: 2020 2020 2020 5b52 6f77 2844 454e 5345        [Row(DENSE
+00033090: 5f52 414e 4b3d 3129 2c20 526f 7728 4445  _RANK=1), Row(DE
+000330a0: 4e53 455f 5241 4e4b 3d31 292c 2052 6f77  NSE_RANK=1), Row
+000330b0: 2844 454e 5345 5f52 414e 4b3d 3229 2c20  (DENSE_RANK=2), 
+000330c0: 526f 7728 4445 4e53 455f 5241 4e4b 3d32  Row(DENSE_RANK=2
+000330d0: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+000330e0: 6574 7572 6e20 6275 696c 7469 6e28 2264  eturn builtin("d
+000330f0: 656e 7365 5f72 616e 6b22 2928 290a 0a0a  ense_rank")()...
+00033100: 6465 6620 726f 775f 6e75 6d62 6572 2829  def row_number()
+00033110: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00033120: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
+00033130: 6120 756e 6971 7565 2072 6f77 206e 756d  a unique row num
+00033140: 6265 7220 666f 7220 6561 6368 2072 6f77  ber for each row
+00033150: 2077 6974 6869 6e20 6120 7769 6e64 6f77   within a window
+00033160: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
+00033170: 5468 6520 726f 7720 6e75 6d62 6572 2073  The row number s
+00033180: 7461 7274 7320 6174 2031 2061 6e64 2063  tarts at 1 and c
+00033190: 6f6e 7469 6e75 6573 2075 7020 7365 7175  ontinues up sequ
+000331a0: 656e 7469 616c 6c79 2e0a 0a20 2020 2045  entially...    E
+000331b0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+000331c0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+000331d0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7769  lake.snowpark.wi
+000331e0: 6e64 6f77 2069 6d70 6f72 7420 5769 6e64  ndow import Wind
+000331f0: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
+00033200: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00033210: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+00033220: 2020 2020 2020 2e2e 2e20 2020 2020 5b0a        ...     [.
+00033230: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00033240: 2020 2020 5b31 2c20 322c 2031 5d2c 0a20      [1, 2, 1],. 
+00033250: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00033260: 2020 205b 312c 2032 2c20 335d 2c0a 2020     [1, 2, 3],.  
+00033270: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00033280: 2020 5b32 2c20 312c 2031 305d 2c0a 2020    [2, 1, 10],.  
+00033290: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000332a0: 2020 5b32 2c20 322c 2031 5d2c 0a20 2020    [2, 2, 1],.   
+000332b0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+000332c0: 205b 322c 2032 2c20 335d 2c0a 2020 2020   [2, 2, 3],.    
+000332d0: 2020 2020 2e2e 2e20 2020 2020 5d2c 0a20      ...     ],. 
+000332e0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+000332f0: 6368 656d 613d 5b22 7822 2c20 2279 222c  chema=["x", "y",
+00033300: 2022 7a22 5d0a 2020 2020 2020 2020 2e2e   "z"].        ..
+00033310: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+00033320: 6466 2e73 656c 6563 7428 726f 775f 6e75  df.select(row_nu
+00033330: 6d62 6572 2829 2e6f 7665 7228 5769 6e64  mber().over(Wind
+00033340: 6f77 2e70 6172 7469 7469 6f6e 5f62 7928  ow.partition_by(
+00033350: 636f 6c28 2258 2229 292e 6f72 6465 725f  col("X")).order_
+00033360: 6279 2863 6f6c 2822 5922 2929 292e 616c  by(col("Y"))).al
+00033370: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+00033380: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00033390: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000333a0: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+000333b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000333c0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
+000333d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000333e0: 2020 7c32 2020 2020 2020 2020 207c 0a20    |2         |. 
+000333f0: 2020 2020 2020 207c 3320 2020 2020 2020         |3       
+00033400: 2020 7c0a 2020 2020 2020 2020 7c31 2020    |.        |1  
+00033410: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00033420: 207c 3220 2020 2020 2020 2020 7c0a 2020   |2         |.  
+00033430: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00033440: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00033450: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00033460: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00033470: 6e28 2272 6f77 5f6e 756d 6265 7222 2928  n("row_number")(
+00033480: 290a 0a0a 6465 6620 6c61 6728 0a20 2020  )...def lag(.   
+00033490: 2065 3a20 436f 6c75 6d6e 4f72 4e61 6d65   e: ColumnOrName
+000334a0: 2c0a 2020 2020 6f66 6673 6574 3a20 696e  ,.    offset: in
+000334b0: 7420 3d20 312c 0a20 2020 2064 6566 6175  t = 1,.    defau
+000334c0: 6c74 5f76 616c 7565 3a20 4f70 7469 6f6e  lt_value: Option
+000334d0: 616c 5b43 6f6c 756d 6e4f 724c 6974 6572  al[ColumnOrLiter
+000334e0: 616c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  al] = None,.    
+000334f0: 6967 6e6f 7265 5f6e 756c 6c73 3a20 626f  ignore_nulls: bo
+00033500: 6f6c 203d 2046 616c 7365 2c0a 2920 2d3e  ol = False,.) ->
+00033510: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00033520: 0a20 2020 2041 6363 6573 7365 7320 6461  .    Accesses da
+00033530: 7461 2069 6e20 6120 7072 6576 696f 7573  ta in a previous
+00033540: 2072 6f77 2069 6e20 7468 6520 7361 6d65   row in the same
+00033550: 2072 6573 756c 7420 7365 7420 7769 7468   result set with
+00033560: 6f75 7420 6861 7669 6e67 2074 6f0a 2020  out having to.  
+00033570: 2020 6a6f 696e 2074 6865 2074 6162 6c65    join the table
+00033580: 2074 6f20 6974 7365 6c66 2e0a 0a20 2020   to itself...   
+00033590: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+000335a0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+000335b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000335c0: 7769 6e64 6f77 2069 6d70 6f72 7420 5769  window import Wi
+000335d0: 6e64 6f77 0a20 2020 2020 2020 203e 3e3e  ndow.        >>>
+000335e0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000335f0: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00033600: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00033610: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
+00033620: 2020 2020 2020 5b31 2c20 322c 2031 5d2c        [1, 2, 1],
+00033630: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00033640: 2020 2020 205b 312c 2032 2c20 335d 2c0a       [1, 2, 3],.
+00033650: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00033660: 2020 2020 5b32 2c20 312c 2031 305d 2c0a      [2, 1, 10],.
+00033670: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00033680: 2020 2020 5b32 2c20 322c 2031 5d2c 0a20      [2, 2, 1],. 
+00033690: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+000336a0: 2020 205b 322c 2032 2c20 335d 2c0a 2020     [2, 2, 3],.  
+000336b0: 2020 2020 2020 2e2e 2e20 2020 2020 5d2c        ...     ],
+000336c0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+000336d0: 2073 6368 656d 613d 5b22 7822 2c20 2279   schema=["x", "y
+000336e0: 222c 2022 7a22 5d0a 2020 2020 2020 2020  ", "z"].        
+000336f0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+00033700: 3e20 6466 2e73 656c 6563 7428 6c61 6728  > df.select(lag(
+00033710: 225a 2229 2e6f 7665 7228 5769 6e64 6f77  "Z").over(Window
+00033720: 2e70 6172 7469 7469 6f6e 5f62 7928 636f  .partition_by(co
+00033730: 6c28 2258 2229 292e 6f72 6465 725f 6279  l("X")).order_by
+00033740: 2863 6f6c 2822 5922 2929 292e 616c 6961  (col("Y"))).alia
+00033750: 7328 2272 6573 756c 7422 2929 2e63 6f6c  s("result")).col
+00033760: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00033770: 526f 7728 5245 5355 4c54 3d4e 6f6e 6529  Row(RESULT=None)
+00033780: 2c20 526f 7728 5245 5355 4c54 3d31 3029  , Row(RESULT=10)
+00033790: 2c20 526f 7728 5245 5355 4c54 3d31 292c  , Row(RESULT=1),
+000337a0: 2052 6f77 2852 4553 554c 543d 4e6f 6e65   Row(RESULT=None
+000337b0: 292c 2052 6f77 2852 4553 554c 543d 3129  ), Row(RESULT=1)
+000337c0: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+000337d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000337e0: 2865 2c20 226c 6167 2229 0a20 2020 2072  (e, "lag").    r
+000337f0: 6574 7572 6e20 436f 6c75 6d6e 280a 2020  eturn Column(.  
+00033800: 2020 2020 2020 4c61 6728 632e 5f65 7870        Lag(c._exp
+00033810: 7265 7373 696f 6e2c 206f 6666 7365 742c  ression, offset,
+00033820: 2043 6f6c 756d 6e2e 5f74 6f5f 6578 7072   Column._to_expr
+00033830: 2864 6566 6175 6c74 5f76 616c 7565 292c  (default_value),
+00033840: 2069 676e 6f72 655f 6e75 6c6c 7329 0a20   ignore_nulls). 
+00033850: 2020 2029 0a0a 0a64 6566 206c 6561 6428     )...def lead(
+00033860: 0a20 2020 2065 3a20 436f 6c75 6d6e 4f72  .    e: ColumnOr
+00033870: 4e61 6d65 2c0a 2020 2020 6f66 6673 6574  Name,.    offset
+00033880: 3a20 696e 7420 3d20 312c 0a20 2020 2064  : int = 1,.    d
+00033890: 6566 6175 6c74 5f76 616c 7565 3a20 4f70  efault_value: Op
+000338a0: 7469 6f6e 616c 5b55 6e69 6f6e 5b43 6f6c  tional[Union[Col
+000338b0: 756d 6e2c 204c 6974 6572 616c 5479 7065  umn, LiteralType
+000338c0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2069  ]] = None,.    i
+000338d0: 676e 6f72 655f 6e75 6c6c 733a 2062 6f6f  gnore_nulls: boo
+000338e0: 6c20 3d20 4661 6c73 652c 0a29 202d 3e20  l = False,.) -> 
+000338f0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00033900: 2020 2020 4163 6365 7373 6573 2064 6174      Accesses dat
+00033910: 6120 696e 2061 2073 7562 7365 7175 656e  a in a subsequen
+00033920: 7420 726f 7720 696e 2074 6865 2073 616d  t row in the sam
+00033930: 6520 7265 7375 6c74 2073 6574 2077 6974  e result set wit
+00033940: 686f 7574 2068 6176 696e 6720 746f 0a20  hout having to. 
+00033950: 2020 206a 6f69 6e20 7468 6520 7461 626c     join the tabl
+00033960: 6520 746f 2069 7473 656c 662e 0a0a 2020  e to itself...  
+00033970: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00033980: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00033990: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+000339a0: 2e77 696e 646f 7720 696d 706f 7274 2057  .window import W
+000339b0: 696e 646f 770a 2020 2020 2020 2020 3e3e  indow.        >>
+000339c0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+000339d0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+000339e0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+000339f0: 205b 0a20 2020 2020 2020 202e 2e2e 2020   [.        ...  
+00033a00: 2020 2020 2020 205b 312c 2032 2c20 315d         [1, 2, 1]
+00033a10: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00033a20: 2020 2020 2020 5b31 2c20 322c 2033 5d2c        [1, 2, 3],
+00033a30: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00033a40: 2020 2020 205b 322c 2031 2c20 3130 5d2c       [2, 1, 10],
+00033a50: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00033a60: 2020 2020 205b 322c 2032 2c20 315d 2c0a       [2, 2, 1],.
+00033a70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00033a80: 2020 2020 5b32 2c20 322c 2033 5d2c 0a20      [2, 2, 3],. 
+00033a90: 2020 2020 2020 202e 2e2e 2020 2020 205d         ...     ]
+00033aa0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00033ab0: 2020 7363 6865 6d61 3d5b 2278 222c 2022    schema=["x", "
+00033ac0: 7922 2c20 227a 225d 0a20 2020 2020 2020  y", "z"].       
+00033ad0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
+00033ae0: 3e3e 2064 662e 7365 6c65 6374 286c 6561  >> df.select(lea
+00033af0: 6428 225a 2229 2e6f 7665 7228 5769 6e64  d("Z").over(Wind
+00033b00: 6f77 2e70 6172 7469 7469 6f6e 5f62 7928  ow.partition_by(
+00033b10: 636f 6c28 2258 2229 292e 6f72 6465 725f  col("X")).order_
+00033b20: 6279 2863 6f6c 2822 5922 2929 292e 616c  by(col("Y"))).al
+00033b30: 6961 7328 2272 6573 756c 7422 2929 2e63  ias("result")).c
+00033b40: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00033b50: 205b 526f 7728 5245 5355 4c54 3d31 292c   [Row(RESULT=1),
+00033b60: 2052 6f77 2852 4553 554c 543d 3329 2c20   Row(RESULT=3), 
+00033b70: 526f 7728 5245 5355 4c54 3d4e 6f6e 6529  Row(RESULT=None)
+00033b80: 2c20 526f 7728 5245 5355 4c54 3d33 292c  , Row(RESULT=3),
+00033b90: 2052 6f77 2852 4553 554c 543d 4e6f 6e65   Row(RESULT=None
+00033ba0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+00033bb0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00033bc0: 7228 652c 2022 6c65 6164 2229 0a20 2020  r(e, "lead").   
+00033bd0: 2072 6574 7572 6e20 436f 6c75 6d6e 280a   return Column(.
+00033be0: 2020 2020 2020 2020 4c65 6164 2863 2e5f          Lead(c._
+00033bf0: 6578 7072 6573 7369 6f6e 2c20 6f66 6673  expression, offs
+00033c00: 6574 2c20 436f 6c75 6d6e 2e5f 746f 5f65  et, Column._to_e
+00033c10: 7870 7228 6465 6661 756c 745f 7661 6c75  xpr(default_valu
+00033c20: 6529 2c20 6967 6e6f 7265 5f6e 756c 6c73  e), ignore_nulls
+00033c30: 290a 2020 2020 290a 0a0a 6465 6620 6c61  ).    )...def la
+00033c40: 7374 5f76 616c 7565 280a 2020 2020 653a  st_value(.    e:
+00033c50: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
+00033c60: 2020 2069 676e 6f72 655f 6e75 6c6c 733a     ignore_nulls:
+00033c70: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a29   bool = False,.)
+00033c80: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00033c90: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
+00033ca0: 7468 6520 6c61 7374 2076 616c 7565 2077  the last value w
+00033cb0: 6974 6869 6e20 616e 206f 7264 6572 6564  ithin an ordered
+00033cc0: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
+00033cd0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00033ce0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00033cf0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00033d00: 7770 6172 6b2e 7769 6e64 6f77 2069 6d70  wpark.window imp
+00033d10: 6f72 7420 5769 6e64 6f77 0a20 2020 2020  ort Window.     
+00033d20: 2020 203e 3e3e 2077 696e 646f 7720 3d20     >>> window = 
+00033d30: 5769 6e64 6f77 2e70 6172 7469 7469 6f6e  Window.partition
+00033d40: 5f62 7928 2263 6f6c 756d 6e31 2229 2e6f  _by("column1").o
+00033d50: 7264 6572 5f62 7928 2263 6f6c 756d 6e32  rder_by("column2
+00033d60: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
+00033d70: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00033d80: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+00033d90: 2c20 3130 5d2c 205b 312c 2031 315d 2c20  , 10], [1, 11], 
+00033da0: 5b32 2c20 3230 5d2c 205b 322c 2032 315d  [2, 20], [2, 21]
+00033db0: 5d2c 2073 6368 656d 613d 5b22 636f 6c75  ], schema=["colu
+00033dc0: 6d6e 3122 2c20 2263 6f6c 756d 6e32 225d  mn1", "column2"]
+00033dd0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00033de0: 2e73 656c 6563 7428 6466 5b22 636f 6c75  .select(df["colu
+00033df0: 6d6e 3122 5d2c 2064 665b 2263 6f6c 756d  mn1"], df["colum
+00033e00: 6e32 225d 2c20 6c61 7374 5f76 616c 7565  n2"], last_value
+00033e10: 2864 665b 2263 6f6c 756d 6e32 225d 292e  (df["column2"]).
+00033e20: 6f76 6572 2877 696e 646f 7729 2e61 735f  over(window).as_
+00033e30: 2822 636f 6c75 6d6e 325f 6c61 7374 2229  ("column2_last")
+00033e40: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00033e50: 2020 2020 5b52 6f77 2843 4f4c 554d 4e31      [Row(COLUMN1
+00033e60: 3d31 2c20 434f 4c55 4d4e 323d 3130 2c20  =1, COLUMN2=10, 
+00033e70: 434f 4c55 4d4e 325f 4c41 5354 3d31 3129  COLUMN2_LAST=11)
+00033e80: 2c20 526f 7728 434f 4c55 4d4e 313d 312c  , Row(COLUMN1=1,
+00033e90: 2043 4f4c 554d 4e32 3d31 312c 2043 4f4c   COLUMN2=11, COL
+00033ea0: 554d 4e32 5f4c 4153 543d 3131 292c 2052  UMN2_LAST=11), R
+00033eb0: 6f77 2843 4f4c 554d 4e31 3d32 2c20 434f  ow(COLUMN1=2, CO
+00033ec0: 4c55 4d4e 323d 3230 2c20 434f 4c55 4d4e  LUMN2=20, COLUMN
+00033ed0: 325f 4c41 5354 3d32 3129 2c20 526f 7728  2_LAST=21), Row(
+00033ee0: 434f 4c55 4d4e 313d 322c 2043 4f4c 554d  COLUMN1=2, COLUM
+00033ef0: 4e32 3d32 312c 2043 4f4c 554d 4e32 5f4c  N2=21, COLUMN2_L
+00033f00: 4153 543d 3231 295d 0a20 2020 2022 2222  AST=21)].    """
+00033f10: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00033f20: 5f69 665f 7374 7228 652c 2022 6c61 7374  _if_str(e, "last
+00033f30: 5f76 616c 7565 2229 0a20 2020 2072 6574  _value").    ret
+00033f40: 7572 6e20 436f 6c75 6d6e 284c 6173 7456  urn Column(LastV
+00033f50: 616c 7565 2863 2e5f 6578 7072 6573 7369  alue(c._expressi
+00033f60: 6f6e 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20  on, None, None, 
+00033f70: 6967 6e6f 7265 5f6e 756c 6c73 2929 0a0a  ignore_nulls))..
+00033f80: 0a64 6566 2066 6972 7374 5f76 616c 7565  .def first_value
+00033f90: 280a 2020 2020 653a 2043 6f6c 756d 6e4f  (.    e: ColumnO
+00033fa0: 724e 616d 652c 0a20 2020 2069 676e 6f72  rName,.    ignor
+00033fb0: 655f 6e75 6c6c 733a 2062 6f6f 6c20 3d20  e_nulls: bool = 
+00033fc0: 4661 6c73 652c 0a29 202d 3e20 436f 6c75  False,.) -> Colu
+00033fd0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00033fe0: 5265 7475 726e 7320 7468 6520 6669 7273  Returns the firs
+00033ff0: 7420 7661 6c75 6520 7769 7468 696e 2061  t value within a
+00034000: 6e20 6f72 6465 7265 6420 6772 6f75 7020  n ordered group 
+00034010: 6f66 2076 616c 7565 732e 0a0a 2020 2020  of values...    
+00034020: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00034030: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00034040: 666c 616b 652e 736e 6f77 7061 726b 2e77  flake.snowpark.w
+00034050: 696e 646f 7720 696d 706f 7274 2057 696e  indow import Win
+00034060: 646f 770a 2020 2020 2020 2020 3e3e 3e20  dow.        >>> 
+00034070: 7769 6e64 6f77 203d 2057 696e 646f 772e  window = Window.
+00034080: 7061 7274 6974 696f 6e5f 6279 2822 636f  partition_by("co
+00034090: 6c75 6d6e 3122 292e 6f72 6465 725f 6279  lumn1").order_by
+000340a0: 2822 636f 6c75 6d6e 3222 290a 2020 2020  ("column2").    
+000340b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000340c0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000340d0: 6672 616d 6528 5b5b 312c 2031 305d 2c20  frame([[1, 10], 
+000340e0: 5b31 2c20 3131 5d2c 205b 322c 2032 305d  [1, 11], [2, 20]
+000340f0: 2c20 5b32 2c20 3231 5d5d 2c20 7363 6865  , [2, 21]], sche
+00034100: 6d61 3d5b 2263 6f6c 756d 6e31 222c 2022  ma=["column1", "
+00034110: 636f 6c75 6d6e 3222 5d29 0a20 2020 2020  column2"]).     
+00034120: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00034130: 2864 665b 2263 6f6c 756d 6e31 225d 2c20  (df["column1"], 
+00034140: 6466 5b22 636f 6c75 6d6e 3222 5d2c 2066  df["column2"], f
+00034150: 6972 7374 5f76 616c 7565 2864 665b 2263  irst_value(df["c
+00034160: 6f6c 756d 6e32 225d 292e 6f76 6572 2877  olumn2"]).over(w
+00034170: 696e 646f 7729 2e61 735f 2822 636f 6c75  indow).as_("colu
+00034180: 6d6e 325f 6669 7273 7422 2929 2e63 6f6c  mn2_first")).col
+00034190: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000341a0: 526f 7728 434f 4c55 4d4e 313d 312c 2043  Row(COLUMN1=1, C
+000341b0: 4f4c 554d 4e32 3d31 302c 2043 4f4c 554d  OLUMN2=10, COLUM
+000341c0: 4e32 5f46 4952 5354 3d31 3029 2c20 526f  N2_FIRST=10), Ro
+000341d0: 7728 434f 4c55 4d4e 313d 312c 2043 4f4c  w(COLUMN1=1, COL
+000341e0: 554d 4e32 3d31 312c 2043 4f4c 554d 4e32  UMN2=11, COLUMN2
+000341f0: 5f46 4952 5354 3d31 3029 2c20 526f 7728  _FIRST=10), Row(
+00034200: 434f 4c55 4d4e 313d 322c 2043 4f4c 554d  COLUMN1=2, COLUM
+00034210: 4e32 3d32 302c 2043 4f4c 554d 4e32 5f46  N2=20, COLUMN2_F
+00034220: 4952 5354 3d32 3029 2c20 526f 7728 434f  IRST=20), Row(CO
+00034230: 4c55 4d4e 313d 322c 2043 4f4c 554d 4e32  LUMN1=2, COLUMN2
+00034240: 3d32 312c 2043 4f4c 554d 4e32 5f46 4952  =21, COLUMN2_FIR
+00034250: 5354 3d32 3029 5d0a 2020 2020 2222 220a  ST=20)].    """.
+00034260: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00034270: 6966 5f73 7472 2865 2c20 226c 6173 745f  if_str(e, "last_
+00034280: 7661 6c75 6522 290a 2020 2020 7265 7475  value").    retu
+00034290: 726e 2043 6f6c 756d 6e28 4669 7273 7456  rn Column(FirstV
+000342a0: 616c 7565 2863 2e5f 6578 7072 6573 7369  alue(c._expressi
+000342b0: 6f6e 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20  on, None, None, 
+000342c0: 6967 6e6f 7265 5f6e 756c 6c73 2929 0a0a  ignore_nulls))..
+000342d0: 0a64 6566 206e 7469 6c65 2865 3a20 556e  .def ntile(e: Un
+000342e0: 696f 6e5b 696e 742c 2043 6f6c 756d 6e4f  ion[int, ColumnO
+000342f0: 724e 616d 655d 2920 2d3e 2043 6f6c 756d  rName]) -> Colum
+00034300: 6e3a 0a20 2020 2022 2222 0a20 2020 2044  n:.    """.    D
+00034310: 6976 6964 6573 2061 6e20 6f72 6465 7265  ivides an ordere
+00034320: 6420 6461 7461 2073 6574 2065 7175 616c  d data set equal
+00034330: 6c79 2069 6e74 6f20 7468 6520 6e75 6d62  ly into the numb
+00034340: 6572 206f 6620 6275 636b 6574 7320 7370  er of buckets sp
+00034350: 6563 6966 6965 6420 6279 206e 2e0a 2020  ecified by n..  
+00034360: 2020 4275 636b 6574 7320 6172 6520 7365    Buckets are se
+00034370: 7175 656e 7469 616c 6c79 206e 756d 6265  quentially numbe
+00034380: 7265 6420 3120 7468 726f 7567 6820 6e2e  red 1 through n.
+00034390: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+000343a0: 2020 2020 653a 2054 6865 2064 6573 6972      e: The desir
+000343b0: 6564 206e 756d 6265 7220 6f66 2062 7563  ed number of buc
+000343c0: 6b65 7473 3b20 6d75 7374 2062 6520 6120  kets; must be a 
+000343d0: 706f 7369 7469 7665 2069 6e74 6567 6572  positive integer
+000343e0: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
+000343f0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00034400: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00034410: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
+00034420: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
+00034430: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00034440: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00034450: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
+00034460: 2020 2020 2e2e 2e20 2020 2020 5b5b 2243      ...     [["C
+00034470: 222c 2022 5350 5922 2c20 335d 2c20 5b22  ", "SPY", 3], ["
+00034480: 4322 2c20 2241 4150 4c22 2c20 3130 5d2c  C", "AAPL", 10],
+00034490: 205b 224e 222c 2022 5350 5922 2c20 355d   ["N", "SPY", 5]
+000344a0: 2c20 5b22 4e22 2c20 2241 4150 4c22 2c20  , ["N", "AAPL", 
+000344b0: 375d 2c20 5b22 5122 2c20 224d 5346 5422  7], ["Q", "MSFT"
+000344c0: 2c20 335d 5d2c 0a20 2020 2020 2020 202e  , 3]],.        .
+000344d0: 2e2e 2020 2020 2073 6368 656d 613d 5b22  ..     schema=["
+000344e0: 6578 6368 616e 6765 222c 2022 7379 6d62  exchange", "symb
+000344f0: 6f6c 222c 2022 7368 6172 6573 225d 0a20  ol", "shares"]. 
+00034500: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00034510: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00034520: 6374 2863 6f6c 2822 6578 6368 616e 6765  ct(col("exchange
+00034530: 2229 2c20 636f 6c28 2273 796d 626f 6c22  "), col("symbol"
+00034540: 292c 206e 7469 6c65 2833 292e 6f76 6572  ), ntile(3).over
+00034550: 2857 696e 646f 772e 7061 7274 6974 696f  (Window.partitio
+00034560: 6e5f 6279 2822 6578 6368 616e 6765 2229  n_by("exchange")
+00034570: 2e6f 7264 6572 5f62 7928 2273 6861 7265  .order_by("share
+00034580: 7322 2929 2e61 6c69 6173 2822 6e74 696c  s")).alias("ntil
+00034590: 655f 3322 2929 2e73 686f 7728 290a 2020  e_3")).show().  
+000345a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000345b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000345c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000345d0: 2020 2020 7c22 4558 4348 414e 4745 2220      |"EXCHANGE" 
+000345e0: 207c 2253 594d 424f 4c22 2020 7c22 4e54   |"SYMBOL"  |"NT
+000345f0: 494c 455f 3322 2020 7c0a 2020 2020 2020  ILE_3"  |.      
+00034600: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00034610: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00034620: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00034630: 7c51 2020 2020 2020 2020 2020 207c 4d53  |Q           |MS
+00034640: 4654 2020 2020 2020 7c31 2020 2020 2020  FT      |1      
+00034650: 2020 2020 7c0a 2020 2020 2020 2020 7c4e      |.        |N
+00034660: 2020 2020 2020 2020 2020 207c 5350 5920             |SPY 
+00034670: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
+00034680: 2020 7c0a 2020 2020 2020 2020 7c4e 2020    |.        |N  
+00034690: 2020 2020 2020 2020 207c 4141 504c 2020           |AAPL  
+000346a0: 2020 2020 7c32 2020 2020 2020 2020 2020      |2          
+000346b0: 7c0a 2020 2020 2020 2020 7c43 2020 2020  |.        |C    
+000346c0: 2020 2020 2020 207c 5350 5920 2020 2020         |SPY     
+000346d0: 2020 7c31 2020 2020 2020 2020 2020 7c0a    |1          |.
+000346e0: 2020 2020 2020 2020 7c43 2020 2020 2020          |C      
+000346f0: 2020 2020 207c 4141 504c 2020 2020 2020       |AAPL      
+00034700: 7c32 2020 2020 2020 2020 2020 7c0a 2020  |2          |.  
+00034710: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00034720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00034730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00034740: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00034750: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00034760: 5f74 6f5f 636f 6c5f 6966 5f73 7472 5f6f  _to_col_if_str_o
+00034770: 725f 696e 7428 652c 2022 6e74 696c 6522  r_int(e, "ntile"
+00034780: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00034790: 6c74 696e 2822 6e74 696c 6522 2928 6329  ltin("ntile")(c)
+000347a0: 0a0a 0a64 6566 2070 6572 6365 6e74 696c  ...def percentil
+000347b0: 655f 636f 6e74 2870 6572 6365 6e74 696c  e_cont(percentil
+000347c0: 653a 2066 6c6f 6174 2920 2d3e 2043 6f6c  e: float) -> Col
+000347d0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+000347e0: 2052 6574 7572 6e20 6120 7065 7263 656e   Return a percen
+000347f0: 7469 6c65 2076 616c 7565 2062 6173 6564  tile value based
+00034800: 206f 6e20 6120 636f 6e74 696e 756f 7573   on a continuous
+00034810: 2064 6973 7472 6962 7574 696f 6e20 6f66   distribution of
+00034820: 2074 6865 0a20 2020 2069 6e70 7574 2063   the.    input c
+00034830: 6f6c 756d 6e2e 2049 6620 6e6f 2069 6e70  olumn. If no inp
+00034840: 7574 2072 6f77 206c 6965 7320 6578 6163  ut row lies exac
+00034850: 746c 7920 6174 2074 6865 2064 6573 6972  tly at the desir
+00034860: 6564 2070 6572 6365 6e74 696c 652c 0a20  ed percentile,. 
+00034870: 2020 2074 6865 2072 6573 756c 7420 6973     the result is
+00034880: 2063 616c 6375 6c61 7465 6420 7573 696e   calculated usin
+00034890: 6720 6c69 6e65 6172 2069 6e74 6572 706f  g linear interpo
+000348a0: 6c61 7469 6f6e 206f 6620 7468 6520 7477  lation of the tw
+000348b0: 6f20 6e65 6172 6573 740a 2020 2020 696e  o nearest.    in
+000348c0: 7075 7420 7661 6c75 6573 2e20 4e55 4c4c  put values. NULL
+000348d0: 2076 616c 7565 7320 6172 6520 6967 6e6f   values are igno
+000348e0: 7265 6420 696e 2074 6865 2063 616c 6375  red in the calcu
+000348f0: 6c61 7469 6f6e 2e0a 0a20 2020 2041 7267  lation...    Arg
+00034900: 733a 0a20 2020 2020 2020 2070 6572 6365  s:.        perce
+00034910: 6e74 696c 653a 2074 6865 2070 6572 6365  ntile: the perce
+00034920: 6e74 696c 6520 6f66 2074 6865 2076 616c  ntile of the val
+00034930: 7565 2074 6861 7420 796f 7520 7761 6e74  ue that you want
+00034940: 2074 6f20 6669 6e64 2e0a 2020 2020 2020   to find..      
+00034950: 2020 2020 2020 5468 6520 7065 7263 656e        The percen
+00034960: 7469 6c65 206d 7573 7420 6265 2061 2063  tile must be a c
+00034970: 6f6e 7374 616e 7420 6265 7477 6565 6e20  onstant between 
+00034980: 302e 3020 616e 6420 312e 302e 2046 6f72  0.0 and 1.0. For
+00034990: 2065 7861 6d70 6c65 2c0a 2020 2020 2020   example,.      
+000349a0: 2020 2020 2020 6966 2079 6f75 2077 616e        if you wan
+000349b0: 7420 746f 2066 696e 6420 7468 6520 7661  t to find the va
+000349c0: 6c75 6520 6174 2074 6865 2039 3074 6820  lue at the 90th 
+000349d0: 7065 7263 656e 7469 6c65 2c20 7370 6563  percentile, spec
+000349e0: 6966 7920 302e 392e 0a0a 2020 2020 4578  ify 0.9...    Ex
+000349f0: 616d 706c 653a 0a0a 2020 2020 2020 2020  ample:..        
+00034a00: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00034a10: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00034a20: 6528 5b0a 2020 2020 2020 2020 2e2e 2e20  e([.        ... 
+00034a30: 2020 2020 2830 2c20 3029 2c20 2830 2c20      (0, 0), (0, 
+00034a40: 3130 292c 2028 302c 2032 3029 2c20 2830  10), (0, 20), (0
+00034a50: 2c20 3330 292c 2028 302c 2034 3029 2c0a  , 30), (0, 40),.
+00034a60: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00034a70: 2831 2c20 3130 292c 2028 312c 2032 3029  (1, 10), (1, 20)
+00034a80: 2c20 2832 2c20 3130 292c 2028 322c 2032  , (2, 10), (2, 2
+00034a90: 3029 2c20 2832 2c20 3235 292c 0a20 2020  0), (2, 25),.   
+00034aa0: 2020 2020 202e 2e2e 2020 2020 2028 322c       ...     (2,
+00034ab0: 2033 3029 2c20 2833 2c20 3630 292c 2028   30), (3, 60), (
+00034ac0: 342c 204e 6f6e 6529 0a20 2020 2020 2020  4, None).       
+00034ad0: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
+00034ae0: 226b 222c 2022 7622 5d29 0a20 2020 2020  "k", "v"]).     
+00034af0: 2020 203e 3e3e 2064 662e 6772 6f75 705f     >>> df.group_
+00034b00: 6279 2822 6b22 292e 6167 6728 7065 7263  by("k").agg(perc
+00034b10: 656e 7469 6c65 5f63 6f6e 7428 302e 3235  entile_cont(0.25
+00034b20: 292e 7769 7468 696e 5f67 726f 7570 2822  ).within_group("
+00034b30: 7622 292e 6173 5f28 2270 6572 6365 6e74  v").as_("percent
+00034b40: 696c 6522 2929 2e73 6f72 7428 226b 2229  ile")).sort("k")
+00034b50: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00034b60: 2020 205b 526f 7728 4b3d 302c 2050 4552     [Row(K=0, PER
+00034b70: 4345 4e54 494c 453d 4465 6369 6d61 6c28  CENTILE=Decimal(
+00034b80: 2731 302e 3030 3027 2929 2c20 5c0a 526f  '10.000')), \.Ro
+00034b90: 7728 4b3d 312c 2050 4552 4345 4e54 494c  w(K=1, PERCENTIL
+00034ba0: 453d 4465 6369 6d61 6c28 2731 322e 3530  E=Decimal('12.50
+00034bb0: 3027 2929 2c20 5c0a 526f 7728 4b3d 322c  0')), \.Row(K=2,
+00034bc0: 2050 4552 4345 4e54 494c 453d 4465 6369   PERCENTILE=Deci
+00034bd0: 6d61 6c28 2731 372e 3530 3027 2929 2c20  mal('17.500')), 
+00034be0: 5c0a 526f 7728 4b3d 332c 2050 4552 4345  \.Row(K=3, PERCE
+00034bf0: 4e54 494c 453d 4465 6369 6d61 6c28 2736  NTILE=Decimal('6
+00034c00: 302e 3030 3027 2929 2c20 5c0a 526f 7728  0.000')), \.Row(
+00034c10: 4b3d 342c 2050 4552 4345 4e54 494c 453d  K=4, PERCENTILE=
+00034c20: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
+00034c30: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00034c40: 6e28 2270 6572 6365 6e74 696c 655f 636f  n("percentile_co
+00034c50: 6e74 2229 2870 6572 6365 6e74 696c 6529  nt")(percentile)
+00034c60: 0a0a 0a64 6566 2067 7265 6174 6573 7428  ...def greatest(
+00034c70: 2a63 6f6c 756d 6e73 3a20 436f 6c75 6d6e  *columns: Column
+00034c80: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00034c90: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00034ca0: 6574 7572 6e73 2074 6865 206c 6172 6765  eturns the large
+00034cb0: 7374 2076 616c 7565 2066 726f 6d20 6120  st value from a 
+00034cc0: 6c69 7374 206f 6620 6578 7072 6573 7369  list of expressi
+00034cd0: 6f6e 732e 0a20 2020 2049 6620 616e 7920  ons..    If any 
+00034ce0: 6f66 2074 6865 2061 7267 756d 656e 7420  of the argument 
+00034cf0: 7661 6c75 6573 2069 7320 4e55 4c4c 2c20  values is NULL, 
+00034d00: 7468 6520 7265 7375 6c74 2069 7320 4e55  the result is NU
+00034d10: 4c4c 2e0a 2020 2020 4752 4541 5445 5354  LL..    GREATEST
+00034d20: 2073 7570 706f 7274 7320 616c 6c20 6461   supports all da
+00034d30: 7461 2074 7970 6573 2c20 696e 636c 7564  ta types, includ
+00034d40: 696e 6720 5641 5249 414e 542e 0a0a 2020  ing VARIANT...  
+00034d50: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
+00034d60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00034d70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00034d80: 7461 6672 616d 6528 5b5b 312c 2032 2c20  taframe([[1, 2, 
+00034d90: 335d 2c20 5b32 2c20 342c 202d 315d 2c20  3], [2, 4, -1], 
+00034da0: 5b33 2c20 362c 204e 6f6e 655d 5d2c 2073  [3, 6, None]], s
+00034db0: 6368 656d 613d 5b22 6122 2c20 2262 222c  chema=["a", "b",
+00034dc0: 2022 6322 5d29 0a20 2020 2020 2020 203e   "c"]).        >
+00034dd0: 3e3e 2064 662e 7365 6c65 6374 2867 7265  >> df.select(gre
+00034de0: 6174 6573 7428 6466 5b22 6122 5d2c 2064  atest(df["a"], d
+00034df0: 665b 2262 225d 2c20 6466 5b22 6322 5d29  f["b"], df["c"])
+00034e00: 2e61 6c69 6173 2822 6772 6561 7465 7374  .alias("greatest
+00034e10: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00034e20: 2020 2020 2020 5b52 6f77 2847 5245 4154        [Row(GREAT
+00034e30: 4553 543d 3329 2c20 526f 7728 4752 4541  EST=3), Row(GREA
+00034e40: 5445 5354 3d34 292c 2052 6f77 2847 5245  TEST=4), Row(GRE
+00034e50: 4154 4553 543d 4e6f 6e65 295d 0a20 2020  ATEST=None)].   
+00034e60: 2022 2222 0a20 2020 2063 203d 205b 5f74   """.    c = [_t
+00034e70: 6f5f 636f 6c5f 6966 5f73 7472 2865 782c  o_col_if_str(ex,
+00034e80: 2022 6772 6561 7465 7374 2229 2066 6f72   "greatest") for
+00034e90: 2065 7820 696e 2063 6f6c 756d 6e73 5d0a   ex in columns].
+00034ea0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00034eb0: 696e 2822 6772 6561 7465 7374 2229 282a  in("greatest")(*
+00034ec0: 6329 0a0a 0a64 6566 206c 6561 7374 282a  c)...def least(*
+00034ed0: 636f 6c75 6d6e 733a 2043 6f6c 756d 6e4f  columns: ColumnO
+00034ee0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00034ef0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00034f00: 7475 726e 7320 7468 6520 736d 616c 6c65  turns the smalle
+00034f10: 7374 2076 616c 7565 2066 726f 6d20 6120  st value from a 
+00034f20: 6c69 7374 206f 6620 6578 7072 6573 7369  list of expressi
+00034f30: 6f6e 732e 0a20 2020 2049 6620 616e 7920  ons..    If any 
+00034f40: 6f66 2074 6865 2061 7267 756d 656e 7420  of the argument 
+00034f50: 7661 6c75 6573 2069 7320 4e55 4c4c 2c20  values is NULL, 
+00034f60: 7468 6520 7265 7375 6c74 2069 7320 4e55  the result is NU
+00034f70: 4c4c 2e0a 2020 2020 4c45 4153 5420 7375  LL..    LEAST su
+00034f80: 7070 6f72 7473 2061 6c6c 2064 6174 6120  pports all data 
+00034f90: 7479 7065 732c 2069 6e63 6c75 6469 6e67  types, including
+00034fa0: 2056 4152 4941 4e54 2e0a 0a20 2020 2045   VARIANT...    E
+00034fb0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00034fc0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00034fd0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00034fe0: 616d 6528 5b5b 312c 2032 2c20 335d 2c20  ame([[1, 2, 3], 
+00034ff0: 5b32 2c20 342c 202d 315d 2c20 5b33 2c20  [2, 4, -1], [3, 
+00035000: 362c 204e 6f6e 655d 5d2c 2073 6368 656d  6, None]], schem
+00035010: 613d 5b22 6122 2c20 2262 222c 2022 6322  a=["a", "b", "c"
+00035020: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00035030: 662e 7365 6c65 6374 286c 6561 7374 2864  f.select(least(d
+00035040: 665b 2261 225d 2c20 6466 5b22 6222 5d2c  f["a"], df["b"],
+00035050: 2064 665b 2263 225d 292e 616c 6961 7328   df["c"]).alias(
+00035060: 226c 6561 7374 2229 292e 636f 6c6c 6563  "least")).collec
+00035070: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00035080: 284c 4541 5354 3d31 292c 2052 6f77 284c  (LEAST=1), Row(L
+00035090: 4541 5354 3d2d 3129 2c20 526f 7728 4c45  EAST=-1), Row(LE
+000350a0: 4153 543d 4e6f 6e65 295d 0a20 2020 2022  AST=None)].    "
+000350b0: 2222 0a20 2020 2063 203d 205b 5f74 6f5f  "".    c = [_to_
+000350c0: 636f 6c5f 6966 5f73 7472 2865 782c 2022  col_if_str(ex, "
+000350d0: 6c65 6173 7422 2920 666f 7220 6578 2069  least") for ex i
+000350e0: 6e20 636f 6c75 6d6e 735d 0a20 2020 2072  n columns].    r
+000350f0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
+00035100: 6561 7374 2229 282a 6329 0a0a 0a64 6566  east")(*c)...def
+00035110: 206c 6973 7461 6767 2865 3a20 436f 6c75   listagg(e: Colu
+00035120: 6d6e 4f72 4e61 6d65 2c20 6465 6c69 6d69  mnOrName, delimi
+00035130: 7465 723a 2073 7472 203d 2022 222c 2069  ter: str = "", i
+00035140: 735f 6469 7374 696e 6374 3a20 626f 6f6c  s_distinct: bool
+00035150: 203d 2046 616c 7365 2920 2d3e 2043 6f6c   = False) -> Col
+00035160: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00035170: 2052 6574 7572 6e73 2074 6865 2063 6f6e   Returns the con
+00035180: 6361 7465 6e61 7465 6420 696e 7075 7420  catenated input 
+00035190: 7661 6c75 6573 2c20 7365 7061 7261 7465  values, separate
+000351a0: 6420 6279 2060 6465 6c69 6d69 7465 7260  d by `delimiter`
+000351b0: 2073 7472 696e 672e 0a20 2020 2053 6565   string..    See
+000351c0: 2060 4c49 5354 4147 4720 3c68 7474 7073   `LISTAGG <https
+000351d0: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
+000351e0: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
+000351f0: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
+00035200: 2f6c 6973 7461 6767 2e68 746d 6c3e 605f  /listagg.html>`_
+00035210: 2066 6f72 2064 6574 6169 6c73 2e0a 0a20   for details... 
+00035220: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00035230: 2065 3a20 4120 3a63 6c61 7373 3a60 436f   e: A :class:`Co
+00035240: 6c75 6d6e 6020 6f62 6a65 6374 206f 7220  lumn` object or 
+00035250: 636f 6c75 6d6e 206e 616d 6520 7468 6174  column name that
+00035260: 2064 6574 6572 6d69 6e65 7320 7468 6520   determines the 
+00035270: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
+00035280: 2020 2074 6f20 6265 2070 7574 2069 6e74     to be put int
+00035290: 6f20 7468 6520 6c69 7374 2e0a 2020 2020  o the list..    
+000352a0: 2020 2020 6465 6c69 6d69 7465 723a 2041      delimiter: A
+000352b0: 2073 7472 696e 6720 6465 6c69 6d69 7465   string delimite
+000352c0: 722e 0a20 2020 2020 2020 2069 735f 6469  r..        is_di
+000352d0: 7374 696e 6374 3a20 5768 6574 6865 7220  stinct: Whether 
+000352e0: 7468 6520 696e 7075 7420 6578 7072 6573  the input expres
+000352f0: 7369 6f6e 2069 7320 6469 7374 696e 6374  sion is distinct
+00035300: 2e0a 0a20 2020 2045 7861 6d70 6c65 733a  ...    Examples:
+00035310: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00035320: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00035330: 7465 5f64 6174 6166 7261 6d65 285b 312c  te_dataframe([1,
+00035340: 2032 2c20 332c 2032 2c20 342c 2035 5d2c   2, 3, 2, 4, 5],
+00035350: 2073 6368 656d 613d 5b22 636f 6c22 5d29   schema=["col"])
+00035360: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00035370: 7365 6c65 6374 286c 6973 7461 6767 2822  select(listagg("
+00035380: 636f 6c22 2c20 222c 2229 2e77 6974 6869  col", ",").withi
+00035390: 6e5f 6772 6f75 7028 6466 5b22 636f 6c22  n_group(df["col"
+000353a0: 5d2e 6173 6328 2929 2e61 735f 2822 7265  ].asc()).as_("re
+000353b0: 7375 6c74 2229 292e 636f 6c6c 6563 7428  sult")).collect(
+000353c0: 290a 2020 2020 2020 2020 5b52 6f77 2852  ).        [Row(R
+000353d0: 4553 554c 543d 2731 2c32 2c32 2c33 2c34  ESULT='1,2,2,3,4
+000353e0: 2c35 2729 5d0a 2020 2020 2222 220a 2020  ,5')].    """.  
+000353f0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00035400: 5f73 7472 2865 2c20 226c 6973 7461 6767  _str(e, "listagg
+00035410: 2229 0a20 2020 2072 6574 7572 6e20 436f  ").    return Co
+00035420: 6c75 6d6e 284c 6973 7441 6767 2863 2e5f  lumn(ListAgg(c._
+00035430: 6578 7072 6573 7369 6f6e 2c20 6465 6c69  expression, deli
+00035440: 6d69 7465 722c 2069 735f 6469 7374 696e  miter, is_distin
+00035450: 6374 2929 0a0a 0a64 6566 2077 6865 6e5f  ct))...def when_
+00035460: 6d61 7463 6865 6428 0a20 2020 2063 6f6e  matched(.    con
+00035470: 6469 7469 6f6e 3a20 4f70 7469 6f6e 616c  dition: Optional
+00035480: 5b43 6f6c 756d 6e5d 203d 204e 6f6e 652c  [Column] = None,
+00035490: 0a29 202d 3e20 2273 6e6f 7766 6c61 6b65  .) -> "snowflake
+000354a0: 2e73 6e6f 7770 6172 6b2e 7461 626c 652e  .snowpark.table.
+000354b0: 5768 656e 4d61 7463 6865 6443 6c61 7573  WhenMatchedClaus
+000354c0: 6522 3a0a 2020 2020 2222 220a 2020 2020  e":.    """.    
+000354d0: 5370 6563 6966 6965 7320 6120 6d61 7463  Specifies a matc
+000354e0: 6865 6420 636c 6175 7365 2066 6f72 2074  hed clause for t
+000354f0: 6865 203a 6d65 7468 3a60 5461 626c 652e  he :meth:`Table.
+00035500: 6d65 7267 6520 3c73 6e6f 7766 6c61 6b65  merge <snowflake
+00035510: 2e73 6e6f 7770 6172 6b2e 5461 626c 652e  .snowpark.Table.
+00035520: 6d65 7267 653e 6020 6163 7469 6f6e 2e0a  merge>` action..
+00035530: 2020 2020 5365 6520 3a63 6c61 7373 3a60      See :class:`
+00035540: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+00035550: 6172 6b2e 7461 626c 652e 5768 656e 4d61  ark.table.WhenMa
+00035560: 7463 6865 6443 6c61 7573 6560 2066 6f72  tchedClause` for
+00035570: 2064 6574 6169 6c73 2e0a 0a20 2020 2043   details...    C
+00035580: 6f6e 7665 6e69 656e 6365 2066 756e 6374  onvenience funct
+00035590: 696f 6e20 746f 2063 7265 6174 6520 6120  ion to create a 
+000355a0: 6e65 7720 5768 656e 4d61 7463 6865 6443  new WhenMatchedC
+000355b0: 6c61 7573 6520 696e 7374 616e 6365 2077  lause instance w
+000355c0: 6869 6368 2069 7320 7265 7175 6972 6564  hich is required
+000355d0: 2074 6f67 6574 6865 7220 7769 7468 2061   together with a
+000355e0: 6e20 6163 7469 6f6e 2077 6865 6e20 6d65  n action when me
+000355f0: 7267 696e 670a 2020 2020 6120 536e 6f77  rging.    a Snow
+00035600: 7061 726b 2074 6162 6c65 2077 6974 6820  park table with 
+00035610: 6120 536e 6f77 7061 726b 2044 6174 6146  a Snowpark DataF
+00035620: 7261 6d65 2028 7365 6520 736e 6f77 666c  rame (see snowfl
+00035630: 616b 652e 736e 6f77 7061 726b 2e54 6162  ake.snowpark.Tab
+00035640: 6c65 2e6d 6572 6765 2066 6f72 206d 6f72  le.merge for mor
+00035650: 6520 6465 7461 696c 7329 2e0a 0a20 2020  e details)...   
+00035660: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00035670: 2020 2020 3e3e 3e20 7461 7267 6574 5f64      >>> target_d
+00035680: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00035690: 7465 5f64 6174 6166 7261 6d65 285b 2831  te_dataframe([(1
+000356a0: 302c 2022 6f6c 6422 292c 2028 3130 2c20  0, "old"), (10, 
+000356b0: 2274 6f6f 5f6f 6c64 2229 2c20 2831 312c  "too_old"), (11,
+000356c0: 2022 6f6c 6422 295d 2c20 7363 6865 6d61   "old")], schema
+000356d0: 3d5b 226b 6579 222c 2022 7661 6c75 6522  =["key", "value"
+000356e0: 5d29 0a20 2020 2020 2020 203e 3e3e 2074  ]).        >>> t
+000356f0: 6172 6765 745f 6466 2e77 7269 7465 2e73  arget_df.write.s
+00035700: 6176 655f 6173 5f74 6162 6c65 2822 6d79  ave_as_table("my
+00035710: 5f74 6162 6c65 222c 206d 6f64 653d 226f  _table", mode="o
+00035720: 7665 7277 7269 7465 222c 2074 6162 6c65  verwrite", table
+00035730: 5f74 7970 653d 2274 656d 706f 7261 7279  _type="temporary
+00035740: 2229 0a20 2020 2020 2020 203e 3e3e 2074  ").        >>> t
+00035750: 6172 6765 7420 3d20 7365 7373 696f 6e2e  arget = session.
+00035760: 7461 626c 6528 226d 795f 7461 626c 6522  table("my_table"
+00035770: 290a 2020 2020 2020 2020 3e3e 3e20 736f  ).        >>> so
+00035780: 7572 6365 203d 2073 6573 7369 6f6e 2e63  urce = session.c
+00035790: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+000357a0: 5b28 3130 2c20 226e 6577 2229 2c20 2831  [(10, "new"), (1
+000357b0: 322c 2022 6e65 7722 292c 2028 3133 2c20  2, "new"), (13, 
+000357c0: 226f 6c64 2229 5d2c 2073 6368 656d 613d  "old")], schema=
+000357d0: 5b22 6b65 7922 2c20 2276 616c 7565 225d  ["key", "value"]
+000357e0: 290a 2020 2020 2020 2020 3e3e 3e20 7461  ).        >>> ta
+000357f0: 7267 6574 2e6d 6572 6765 2873 6f75 7263  rget.merge(sourc
+00035800: 652c 2028 7461 7267 6574 5b22 6b65 7922  e, (target["key"
+00035810: 5d20 3d3d 2073 6f75 7263 655b 226b 6579  ] == source["key
+00035820: 225d 2920 2620 2874 6172 6765 745b 2276  "]) & (target["v
+00035830: 616c 7565 225d 203d 3d20 2274 6f6f 5f6f  alue"] == "too_o
+00035840: 6c64 2229 2c0a 2020 2020 2020 2020 2e2e  ld"),.        ..
+00035850: 2e20 2020 2020 2020 2020 2020 2020 205b  .              [
+00035860: 7768 656e 5f6d 6174 6368 6564 2829 2e75  when_matched().u
+00035870: 7064 6174 6528 7b22 7661 6c75 6522 3a20  pdate({"value": 
+00035880: 736f 7572 6365 5b22 7661 6c75 6522 5d7d  source["value"]}
+00035890: 295d 290a 2020 2020 2020 2020 4d65 7267  )]).        Merg
+000358a0: 6552 6573 756c 7428 726f 7773 5f69 6e73  eResult(rows_ins
+000358b0: 6572 7465 643d 302c 2072 6f77 735f 7570  erted=0, rows_up
+000358c0: 6461 7465 643d 312c 2072 6f77 735f 6465  dated=1, rows_de
+000358d0: 6c65 7465 643d 3029 0a20 2020 2020 2020  leted=0).       
+000358e0: 203e 3e3e 2074 6172 6765 742e 636f 6c6c   >>> target.coll
+000358f0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00035900: 6f77 284b 4559 3d31 302c 2056 414c 5545  ow(KEY=10, VALUE
+00035910: 3d27 6f6c 6427 292c 2052 6f77 284b 4559  ='old'), Row(KEY
+00035920: 3d31 302c 2056 414c 5545 3d27 6e65 7727  =10, VALUE='new'
+00035930: 292c 2052 6f77 284b 4559 3d31 312c 2056  ), Row(KEY=11, V
+00035940: 414c 5545 3d27 6f6c 6427 295d 0a0a 2020  ALUE='old')]..  
+00035950: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00035960: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00035970: 6172 6b2e 7461 626c 652e 5768 656e 4d61  ark.table.WhenMa
+00035980: 7463 6865 6443 6c61 7573 6528 636f 6e64  tchedClause(cond
+00035990: 6974 696f 6e29 0a0a 0a64 6566 2077 6865  ition)...def whe
+000359a0: 6e5f 6e6f 745f 6d61 7463 6865 6428 0a20  n_not_matched(. 
+000359b0: 2020 2063 6f6e 6469 7469 6f6e 3a20 4f70     condition: Op
+000359c0: 7469 6f6e 616c 5b43 6f6c 756d 6e5d 203d  tional[Column] =
+000359d0: 204e 6f6e 652c 0a29 202d 3e20 2273 6e6f   None,.) -> "sno
+000359e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000359f0: 7461 626c 652e 5768 656e 4e6f 744d 6174  table.WhenNotMat
+00035a00: 6368 6564 436c 6175 7365 223a 0a20 2020  chedClause":.   
+00035a10: 2022 2222 0a20 2020 2053 7065 6369 6669   """.    Specifi
+00035a20: 6573 2061 206e 6f74 2d6d 6174 6368 6564  es a not-matched
+00035a30: 2063 6c61 7573 6520 666f 7220 7468 6520   clause for the 
+00035a40: 3a6d 6574 683a 6054 6162 6c65 2e6d 6572  :meth:`Table.mer
+00035a50: 6765 203c 736e 6f77 666c 616b 652e 736e  ge <snowflake.sn
+00035a60: 6f77 7061 726b 2e54 6162 6c65 2e6d 6572  owpark.Table.mer
+00035a70: 6765 3e60 2061 6374 696f 6e2e 0a20 2020  ge>` action..   
+00035a80: 2053 6565 203a 636c 6173 733a 607e 736e   See :class:`~sn
+00035a90: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00035aa0: 2e74 6162 6c65 2e57 6865 6e4e 6f74 4d61  .table.WhenNotMa
+00035ab0: 7463 6865 6443 6c61 7573 6560 2066 6f72  tchedClause` for
+00035ac0: 2064 6574 6169 6c73 2e0a 0a20 2020 2043   details...    C
+00035ad0: 6f6e 7665 6e69 656e 6365 2066 756e 6374  onvenience funct
+00035ae0: 696f 6e20 746f 2063 7265 6174 6520 6120  ion to create a 
+00035af0: 6e65 7720 5768 656e 4e6f 744d 6174 6368  new WhenNotMatch
+00035b00: 6564 436c 6175 7365 2069 6e73 7461 6e63  edClause instanc
+00035b10: 6520 7768 6963 6820 6973 2072 6571 7569  e which is requi
+00035b20: 7265 6420 746f 6765 7468 6572 2077 6974  red together wit
+00035b30: 6820 616e 2061 6374 696f 6e20 7768 656e  h an action when
+00035b40: 206d 6572 6769 6e67 0a20 2020 2061 2053   merging.    a S
+00035b50: 6e6f 7770 6172 6b20 7461 626c 6520 7769  nowpark table wi
+00035b60: 7468 2061 2053 6e6f 7770 6172 6b20 4461  th a Snowpark Da
+00035b70: 7461 4672 616d 6520 2873 6565 2073 6e6f  taFrame (see sno
+00035b80: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00035b90: 5461 626c 652e 6d65 7267 6520 666f 7220  Table.merge for 
+00035ba0: 6d6f 7265 2064 6574 6169 6c73 292e 0a0a  more details)...
+00035bb0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00035bc0: 2020 2020 2020 203e 3e3e 2074 6172 6765         >>> targe
+00035bd0: 745f 6466 203d 2073 6573 7369 6f6e 2e63  t_df = session.c
+00035be0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00035bf0: 5b28 3130 2c20 226f 6c64 2229 2c20 2831  [(10, "old"), (1
+00035c00: 302c 2022 746f 6f5f 6f6c 6422 292c 2028  0, "too_old"), (
+00035c10: 3131 2c20 226f 6c64 2229 5d2c 2073 6368  11, "old")], sch
+00035c20: 656d 613d 5b22 6b65 7922 2c20 2276 616c  ema=["key", "val
+00035c30: 7565 225d 290a 2020 2020 2020 2020 3e3e  ue"]).        >>
+00035c40: 3e20 7461 7267 6574 5f64 662e 7772 6974  > target_df.writ
+00035c50: 652e 7361 7665 5f61 735f 7461 626c 6528  e.save_as_table(
+00035c60: 226d 795f 7461 626c 6522 2c20 6d6f 6465  "my_table", mode
+00035c70: 3d22 6f76 6572 7772 6974 6522 2c20 7461  ="overwrite", ta
+00035c80: 626c 655f 7479 7065 3d22 7465 6d70 6f72  ble_type="tempor
+00035c90: 6172 7922 290a 2020 2020 2020 2020 3e3e  ary").        >>
+00035ca0: 3e20 7461 7267 6574 203d 2073 6573 7369  > target = sessi
+00035cb0: 6f6e 2e74 6162 6c65 2822 6d79 5f74 6162  on.table("my_tab
+00035cc0: 6c65 2229 0a20 2020 2020 2020 203e 3e3e  le").        >>>
+00035cd0: 2073 6f75 7263 6520 3d20 7365 7373 696f   source = sessio
+00035ce0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00035cf0: 6d65 285b 2831 302c 2022 6e65 7722 292c  me([(10, "new"),
+00035d00: 2028 3132 2c20 226e 6577 2229 2c20 2831   (12, "new"), (1
+00035d10: 332c 2022 6f6c 6422 295d 2c20 7363 6865  3, "old")], sche
+00035d20: 6d61 3d5b 226b 6579 222c 2022 7661 6c75  ma=["key", "valu
+00035d30: 6522 5d29 0a20 2020 2020 2020 203e 3e3e  e"]).        >>>
+00035d40: 2074 6172 6765 742e 6d65 7267 6528 736f   target.merge(so
+00035d50: 7572 6365 2c20 2874 6172 6765 745b 226b  urce, (target["k
+00035d60: 6579 225d 203d 3d20 736f 7572 6365 5b22  ey"] == source["
+00035d70: 6b65 7922 5d29 2026 2028 7461 7267 6574  key"]) & (target
+00035d80: 5b22 7661 6c75 6522 5d20 3d3d 2022 746f  ["value"] == "to
+00035d90: 6f5f 6f6c 6422 292c 0a20 2020 2020 2020  o_old"),.       
+00035da0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+00035db0: 2020 5b77 6865 6e5f 6e6f 745f 6d61 7463    [when_not_matc
+00035dc0: 6865 6428 292e 696e 7365 7274 287b 226b  hed().insert({"k
+00035dd0: 6579 223a 2073 6f75 7263 655b 226b 6579  ey": source["key
+00035de0: 225d 7d29 5d29 0a20 2020 2020 2020 204d  "]})]).        M
+00035df0: 6572 6765 5265 7375 6c74 2872 6f77 735f  ergeResult(rows_
+00035e00: 696e 7365 7274 6564 3d32 2c20 726f 7773  inserted=2, rows
+00035e10: 5f75 7064 6174 6564 3d30 2c20 726f 7773  _updated=0, rows
+00035e20: 5f64 656c 6574 6564 3d30 290a 2020 2020  _deleted=0).    
+00035e30: 2020 2020 3e3e 3e20 7461 7267 6574 2e73      >>> target.s
+00035e40: 6f72 7428 636f 6c28 226b 6579 2229 2c20  ort(col("key"), 
+00035e50: 636f 6c28 2276 616c 7565 2229 292e 636f  col("value")).co
+00035e60: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00035e70: 5b52 6f77 284b 4559 3d31 302c 2056 414c  [Row(KEY=10, VAL
+00035e80: 5545 3d27 6f6c 6427 292c 2052 6f77 284b  UE='old'), Row(K
+00035e90: 4559 3d31 302c 2056 414c 5545 3d27 746f  EY=10, VALUE='to
+00035ea0: 6f5f 6f6c 6427 292c 2052 6f77 284b 4559  o_old'), Row(KEY
+00035eb0: 3d31 312c 2056 414c 5545 3d27 6f6c 6427  =11, VALUE='old'
+00035ec0: 292c 2052 6f77 284b 4559 3d31 322c 2056  ), Row(KEY=12, V
+00035ed0: 414c 5545 3d4e 6f6e 6529 2c20 526f 7728  ALUE=None), Row(
+00035ee0: 4b45 593d 3133 2c20 5641 4c55 453d 4e6f  KEY=13, VALUE=No
+00035ef0: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
+00035f00: 2072 6574 7572 6e20 736e 6f77 666c 616b   return snowflak
+00035f10: 652e 736e 6f77 7061 726b 2e74 6162 6c65  e.snowpark.table
+00035f20: 2e57 6865 6e4e 6f74 4d61 7463 6865 6443  .WhenNotMatchedC
+00035f30: 6c61 7573 6528 636f 6e64 6974 696f 6e29  lause(condition)
+00035f40: 0a0a 0a64 6566 2075 6466 280a 2020 2020  ...def udf(.    
+00035f50: 6675 6e63 3a20 4f70 7469 6f6e 616c 5b43  func: Optional[C
+00035f60: 616c 6c61 626c 655d 203d 204e 6f6e 652c  allable] = None,
+00035f70: 0a20 2020 202a 2c0a 2020 2020 7265 7475  .    *,.    retu
+00035f80: 726e 5f74 7970 653a 204f 7074 696f 6e61  rn_type: Optiona
+00035f90: 6c5b 4461 7461 5479 7065 5d20 3d20 4e6f  l[DataType] = No
+00035fa0: 6e65 2c0a 2020 2020 696e 7075 745f 7479  ne,.    input_ty
+00035fb0: 7065 733a 204f 7074 696f 6e61 6c5b 4c69  pes: Optional[Li
+00035fc0: 7374 5b44 6174 6154 7970 655d 5d20 3d20  st[DataType]] = 
+00035fd0: 4e6f 6e65 2c0a 2020 2020 6e61 6d65 3a20  None,.    name: 
+00035fe0: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b73  Optional[Union[s
+00035ff0: 7472 2c20 4974 6572 6162 6c65 5b73 7472  tr, Iterable[str
+00036000: 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ]]] = None,.    
+00036010: 6973 5f70 6572 6d61 6e65 6e74 3a20 626f  is_permanent: bo
+00036020: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00036030: 7374 6167 655f 6c6f 6361 7469 6f6e 3a20  stage_location: 
+00036040: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00036050: 4e6f 6e65 2c0a 2020 2020 696d 706f 7274  None,.    import
+00036060: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+00036070: 5b55 6e69 6f6e 5b73 7472 2c20 5475 706c  [Union[str, Tupl
+00036080: 655b 7374 722c 2073 7472 5d5d 5d5d 203d  e[str, str]]]] =
+00036090: 204e 6f6e 652c 0a20 2020 2070 6163 6b61   None,.    packa
+000360a0: 6765 733a 204f 7074 696f 6e61 6c5b 4c69  ges: Optional[Li
+000360b0: 7374 5b55 6e69 6f6e 5b73 7472 2c20 4d6f  st[Union[str, Mo
+000360c0: 6475 6c65 5479 7065 5d5d 5d20 3d20 4e6f  duleType]]] = No
+000360d0: 6e65 2c0a 2020 2020 7265 706c 6163 653a  ne,.    replace:
+000360e0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+000360f0: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
+00036100: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00036110: 2020 2020 7365 7373 696f 6e3a 204f 7074      session: Opt
+00036120: 696f 6e61 6c5b 2273 6e6f 7766 6c61 6b65  ional["snowflake
+00036130: 2e73 6e6f 7770 6172 6b2e 7365 7373 696f  .snowpark.sessio
+00036140: 6e2e 5365 7373 696f 6e22 5d20 3d20 4e6f  n.Session"] = No
+00036150: 6e65 2c0a 2020 2020 7061 7261 6c6c 656c  ne,.    parallel
+00036160: 3a20 696e 7420 3d20 342c 0a20 2020 206d  : int = 4,.    m
+00036170: 6178 5f62 6174 6368 5f73 697a 653a 204f  ax_batch_size: O
+00036180: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00036190: 6f6e 652c 0a20 2020 2073 7461 7465 6d65  one,.    stateme
+000361a0: 6e74 5f70 6172 616d 733a 204f 7074 696f  nt_params: Optio
+000361b0: 6e61 6c5b 4469 6374 5b73 7472 2c20 7374  nal[Dict[str, st
+000361c0: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+000361d0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
+000361e0: 6c61 793a 2062 6f6f 6c20 3d20 5472 7565  lay: bool = True
+000361f0: 2c0a 2020 2020 7374 7269 6374 3a20 626f  ,.    strict: bo
+00036200: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00036210: 7365 6375 7265 3a20 626f 6f6c 203d 2046  secure: bool = F
+00036220: 616c 7365 2c0a 2920 2d3e 2055 6e69 6f6e  alse,.) -> Union
+00036230: 5b55 7365 7244 6566 696e 6564 4675 6e63  [UserDefinedFunc
+00036240: 7469 6f6e 2c20 6675 6e63 746f 6f6c 732e  tion, functools.
+00036250: 7061 7274 6961 6c5d 3a0a 2020 2020 2222  partial]:.    ""
+00036260: 2252 6567 6973 7465 7273 2061 2050 7974  "Registers a Pyt
+00036270: 686f 6e20 6675 6e63 7469 6f6e 2061 7320  hon function as 
+00036280: 6120 536e 6f77 666c 616b 6520 5079 7468  a Snowflake Pyth
+00036290: 6f6e 2055 4446 2061 6e64 2072 6574 7572  on UDF and retur
+000362a0: 6e73 2074 6865 2055 4446 2e0a 0a20 2020  ns the UDF...   
+000362b0: 2049 7420 6361 6e20 6265 2075 7365 6420   It can be used 
+000362c0: 6173 2065 6974 6865 7220 6120 6675 6e63  as either a func
+000362d0: 7469 6f6e 2063 616c 6c20 6f72 2061 2064  tion call or a d
+000362e0: 6563 6f72 6174 6f72 2e20 496e 206d 6f73  ecorator. In mos
+000362f0: 7420 6361 7365 7320 796f 7520 776f 726b  t cases you work
+00036300: 2077 6974 6820 6120 7369 6e67 6c65 2073   with a single s
+00036310: 6573 7369 6f6e 2e0a 2020 2020 5468 6973  ession..    This
+00036320: 2066 756e 6374 696f 6e20 7573 6573 2074   function uses t
+00036330: 6861 7420 7365 7373 696f 6e20 746f 2072  hat session to r
+00036340: 6567 6973 7465 7220 7468 6520 5544 462e  egister the UDF.
+00036350: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
+00036360: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
+00036370: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
+00036380: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
+00036390: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
+000363a0: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
+000363b0: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
+000363c0: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
+000363d0: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
+000363e0: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
+000363f0: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
+00036400: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
+00036410: 7365 2060 6073 6573 7369 6f6e 2e75 6466  se ``session.udf
+00036420: 2e72 6567 6973 7465 7260 6020 696e 7374  .register`` inst
+00036430: 6561 642e 2053 6565 2065 7861 6d70 6c65  ead. See example
+00036440: 730a 2020 2020 696e 203a 636c 6173 733a  s.    in :class:
+00036450: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+00036460: 7061 726b 2e75 6466 2e55 4446 5265 6769  park.udf.UDFRegi
+00036470: 7374 7261 7469 6f6e 602e 0a0a 2020 2020  stration`...    
+00036480: 4172 6773 3a0a 2020 2020 2020 2020 6675  Args:.        fu
+00036490: 6e63 3a20 4120 5079 7468 6f6e 2066 756e  nc: A Python fun
+000364a0: 6374 696f 6e20 7573 6564 2066 6f72 2063  ction used for c
+000364b0: 7265 6174 696e 6720 7468 6520 5544 462e  reating the UDF.
+000364c0: 0a20 2020 2020 2020 2072 6574 7572 6e5f  .        return_
+000364d0: 7479 7065 3a20 4120 3a63 6c61 7373 3a60  type: A :class:`
+000364e0: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+000364f0: 6172 6b2e 7479 7065 732e 4461 7461 5479  ark.types.DataTy
+00036500: 7065 6020 7265 7072 6573 656e 7469 6e67  pe` representing
+00036510: 2074 6865 2072 6574 7572 6e20 6461 7461   the return data
+00036520: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
+00036530: 6520 6f66 2074 6865 2055 4446 2e20 4f70  e of the UDF. Op
+00036540: 7469 6f6e 616c 2069 6620 7479 7065 2068  tional if type h
+00036550: 696e 7473 2061 7265 2070 726f 7669 6465  ints are provide
+00036560: 642e 0a20 2020 2020 2020 2069 6e70 7574  d..        input
+00036570: 5f74 7970 6573 3a20 4120 6c69 7374 206f  _types: A list o
+00036580: 6620 3a63 6c61 7373 3a60 7e73 6e6f 7766  f :class:`~snowf
+00036590: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
+000365a0: 7065 732e 4461 7461 5479 7065 600a 2020  pes.DataType`.  
+000365b0: 2020 2020 2020 2020 2020 7265 7072 6573            repres
+000365c0: 656e 7469 6e67 2074 6865 2069 6e70 7574  enting the input
+000365d0: 2064 6174 6120 7479 7065 7320 6f66 2074   data types of t
+000365e0: 6865 2055 4446 2e20 4f70 7469 6f6e 616c  he UDF. Optional
+000365f0: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
+00036600: 7479 7065 2068 696e 7473 2061 7265 2070  type hints are p
+00036610: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
+00036620: 206e 616d 653a 2041 2073 7472 696e 6720   name: A string 
+00036630: 6f72 206c 6973 7420 6f66 2073 7472 696e  or list of strin
+00036640: 6773 2074 6861 7420 7370 6563 6966 7920  gs that specify 
+00036650: 7468 6520 6e61 6d65 206f 7220 6675 6c6c  the name or full
+00036660: 792d 7175 616c 6966 6965 640a 2020 2020  y-qualified.    
+00036670: 2020 2020 2020 2020 6f62 6a65 6374 2069          object i
+00036680: 6465 6e74 6966 6965 7220 2864 6174 6162  dentifier (datab
+00036690: 6173 6520 6e61 6d65 2c20 7363 6865 6d61  ase name, schema
+000366a0: 206e 616d 652c 2061 6e64 2066 756e 6374   name, and funct
+000366b0: 696f 6e20 6e61 6d65 2920 666f 720a 2020  ion name) for.  
+000366c0: 2020 2020 2020 2020 2020 7468 6520 5544            the UD
+000366d0: 4620 696e 2053 6e6f 7766 6c61 6b65 2c20  F in Snowflake, 
+000366e0: 7768 6963 6820 616c 6c6f 7773 2079 6f75  which allows you
+000366f0: 2074 6f20 6361 6c6c 2074 6869 7320 5544   to call this UD
+00036700: 4620 696e 2061 2053 514c 0a20 2020 2020  F in a SQL.     
+00036710: 2020 2020 2020 2063 6f6d 6d61 6e64 206f         command o
+00036720: 7220 7669 6120 3a66 756e 633a 6063 616c  r via :func:`cal
+00036730: 6c5f 7564 6628 2960 2e20 4966 2069 7420  l_udf()`. If it 
+00036740: 6973 206e 6f74 2070 726f 7669 6465 642c  is not provided,
+00036750: 2061 206e 616d 6520 7769 6c6c 0a20 2020   a name will.   
+00036760: 2020 2020 2020 2020 2062 6520 6175 746f           be auto
+00036770: 6d61 7469 6361 6c6c 7920 6765 6e65 7261  matically genera
+00036780: 7465 6420 666f 7220 7468 6520 5544 462e  ted for the UDF.
+00036790: 2041 206e 616d 6520 6d75 7374 2062 6520   A name must be 
+000367a0: 7370 6563 6966 6965 6420 7768 656e 0a20  specified when. 
+000367b0: 2020 2020 2020 2020 2020 2060 6069 735f             ``is_
+000367c0: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
+000367d0: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
+000367e0: 2069 735f 7065 726d 616e 656e 743a 2057   is_permanent: W
+000367f0: 6865 7468 6572 2074 6f20 6372 6561 7465  hether to create
+00036800: 2061 2070 6572 6d61 6e65 6e74 2055 4446   a permanent UDF
+00036810: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+00036820: 2060 6046 616c 7365 6060 2e0a 2020 2020   ``False``..    
+00036830: 2020 2020 2020 2020 4966 2069 7420 6973          If it is
+00036840: 2060 6054 7275 6560 602c 2061 2076 616c   ``True``, a val
+00036850: 6964 2060 6073 7461 6765 5f6c 6f63 6174  id ``stage_locat
+00036860: 696f 6e60 6020 6d75 7374 2062 6520 7072  ion`` must be pr
+00036870: 6f76 6964 6564 2e0a 2020 2020 2020 2020  ovided..        
+00036880: 7374 6167 655f 6c6f 6361 7469 6f6e 3a20  stage_location: 
+00036890: 5468 6520 7374 6167 6520 6c6f 6361 7469  The stage locati
+000368a0: 6f6e 2077 6865 7265 2074 6865 2050 7974  on where the Pyt
+000368b0: 686f 6e20 6669 6c65 2066 6f72 2074 6865  hon file for the
+000368c0: 2055 4446 0a20 2020 2020 2020 2020 2020   UDF.           
+000368d0: 2061 6e64 2069 7473 2064 6570 656e 6465   and its depende
+000368e0: 6e63 6965 7320 7368 6f75 6c64 2062 6520  ncies should be 
+000368f0: 7570 6c6f 6164 6564 2e20 5468 6520 7374  uploaded. The st
+00036900: 6167 6520 6c6f 6361 7469 6f6e 206d 7573  age location mus
+00036910: 7420 6265 2073 7065 6369 6669 6564 0a20  t be specified. 
+00036920: 2020 2020 2020 2020 2020 2077 6865 6e20             when 
+00036930: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
+00036940: 2069 7320 6060 5472 7565 6060 2c20 616e   is ``True``, an
+00036950: 6420 6974 2077 696c 6c20 6265 2069 676e  d it will be ign
+00036960: 6f72 6564 2077 6865 6e0a 2020 2020 2020  ored when.      
+00036970: 2020 2020 2020 6060 6973 5f70 6572 6d61        ``is_perma
+00036980: 6e65 6e74 6060 2069 7320 6060 4661 6c73  nent`` is ``Fals
+00036990: 6560 602e 2049 7420 6361 6e20 6265 2061  e``. It can be a
+000369a0: 6e79 2073 7461 6765 206f 7468 6572 2074  ny stage other t
+000369b0: 6861 6e20 7465 6d70 6f72 6172 790a 2020  han temporary.  
+000369c0: 2020 2020 2020 2020 2020 7374 6167 6573            stages
+000369d0: 2061 6e64 2065 7874 6572 6e61 6c20 7374   and external st
+000369e0: 6167 6573 2e0a 2020 2020 2020 2020 696d  ages..        im
+000369f0: 706f 7274 733a 2041 206c 6973 7420 6f66  ports: A list of
+00036a00: 2069 6d70 6f72 7473 2074 6861 7420 6f6e   imports that on
+00036a10: 6c79 2061 7070 6c79 2074 6f20 7468 6973  ly apply to this
+00036a20: 2055 4446 2e20 596f 7520 6361 6e20 7573   UDF. You can us
+00036a30: 6520 6120 7374 7269 6e67 2074 6f0a 2020  e a string to.  
+00036a40: 2020 2020 2020 2020 2020 7265 7072 6573            repres
+00036a50: 656e 7420 6120 6669 6c65 2070 6174 6820  ent a file path 
+00036a60: 2873 696d 696c 6172 2074 6f20 7468 6520  (similar to the 
+00036a70: 6060 7061 7468 6060 2061 7267 756d 656e  ``path`` argumen
+00036a80: 7420 696e 0a20 2020 2020 2020 2020 2020  t in.           
+00036a90: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
+00036aa0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
+00036ab0: 696f 6e2e 6164 645f 696d 706f 7274 6029  ion.add_import`)
+00036ac0: 2069 6e20 7468 6973 206c 6973 742c 206f   in this list, o
+00036ad0: 7220 6120 7475 706c 6520 6f66 2074 776f  r a tuple of two
+00036ae0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00036af0: 696e 6773 2074 6f20 7265 7072 6573 656e  ings to represen
+00036b00: 7420 6120 6669 6c65 2070 6174 6820 616e  t a file path an
+00036b10: 6420 616e 2069 6d70 6f72 7420 7061 7468  d an import path
+00036b20: 2028 7369 6d69 6c61 7220 746f 2074 6865   (similar to the
+00036b30: 2060 6069 6d70 6f72 745f 7061 7468 6060   ``import_path``
+00036b40: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+00036b50: 756d 656e 7420 696e 203a 6d65 7468 3a60  ument in :meth:`
+00036b60: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+00036b70: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
+00036b80: 696d 706f 7274 6029 2e20 5468 6573 6520  import`). These 
+00036b90: 5544 462d 6c65 7665 6c20 696d 706f 7274  UDF-level import
+00036ba0: 730a 2020 2020 2020 2020 2020 2020 7769  s.            wi
+00036bb0: 6c6c 206f 7665 7272 6964 6520 7468 6520  ll override the 
+00036bc0: 7365 7373 696f 6e2d 6c65 7665 6c20 696d  session-level im
+00036bd0: 706f 7274 7320 6164 6465 6420 6279 0a20  ports added by. 
+00036be0: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
+00036bf0: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+00036c00: 7770 6172 6b2e 5365 7373 696f 6e2e 6164  wpark.Session.ad
+00036c10: 645f 696d 706f 7274 602e 204e 6f74 6520  d_import`. Note 
+00036c20: 7468 6174 2061 6e20 656d 7074 7920 6c69  that an empty li
+00036c30: 7374 206d 6561 6e73 0a20 2020 2020 2020  st means.       
+00036c40: 2020 2020 206e 6f20 696d 706f 7274 2066       no import f
+00036c50: 6f72 2074 6869 7320 5544 462c 2061 6e64  or this UDF, and
+00036c60: 2060 604e 6f6e 6560 6020 6f72 206e 6f74   ``None`` or not
+00036c70: 2073 7065 6369 6679 696e 6720 7468 6973   specifying this
+00036c80: 2070 6172 616d 6574 6572 206d 6561 6e73   parameter means
+00036c90: 2075 7369 6e67 0a20 2020 2020 2020 2020   using.         
+00036ca0: 2020 2073 6573 7369 6f6e 2d6c 6576 656c     session-level
+00036cb0: 2069 6d70 6f72 7473 2e0a 2020 2020 2020   imports..      
+00036cc0: 2020 7061 636b 6167 6573 3a20 4120 6c69    packages: A li
+00036cd0: 7374 206f 6620 7061 636b 6167 6573 2074  st of packages t
+00036ce0: 6861 7420 6f6e 6c79 2061 7070 6c79 2074  hat only apply t
+00036cf0: 6f20 7468 6973 2055 4446 2e20 5468 6573  o this UDF. Thes
+00036d00: 6520 5544 462d 6c65 7665 6c20 7061 636b  e UDF-level pack
+00036d10: 6167 6573 0a20 2020 2020 2020 2020 2020  ages.           
+00036d20: 2077 696c 6c20 6f76 6572 7269 6465 2074   will override t
+00036d30: 6865 2073 6573 7369 6f6e 2d6c 6576 656c  he session-level
+00036d40: 2070 6163 6b61 6765 7320 6164 6465 6420   packages added 
+00036d50: 6279 0a20 2020 2020 2020 2020 2020 203a  by.            :
+00036d60: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
+00036d70: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
+00036d80: 6e2e 6164 645f 7061 636b 6167 6573 6020  n.add_packages` 
+00036d90: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+00036da0: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+00036db0: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+00036dc0: 6f6e 2e61 6464 5f72 6571 7569 7265 6d65  on.add_requireme
+00036dd0: 6e74 7360 2e20 4e6f 7465 2074 6861 7420  nts`. Note that 
+00036de0: 616e 2065 6d70 7479 206c 6973 7420 6d65  an empty list me
+00036df0: 616e 730a 2020 2020 2020 2020 2020 2020  ans.            
+00036e00: 6e6f 2070 6163 6b61 6765 2066 6f72 2074  no package for t
+00036e10: 6869 7320 5544 462c 2061 6e64 2060 604e  his UDF, and ``N
+00036e20: 6f6e 6560 6020 6f72 206e 6f74 2073 7065  one`` or not spe
+00036e30: 6369 6679 696e 6720 7468 6973 2070 6172  cifying this par
+00036e40: 616d 6574 6572 206d 6561 6e73 2075 7369  ameter means usi
+00036e50: 6e67 0a20 2020 2020 2020 2020 2020 2073  ng.            s
+00036e60: 6573 7369 6f6e 2d6c 6576 656c 2070 6163  ession-level pac
+00036e70: 6b61 6765 732e 0a20 2020 2020 2020 2072  kages..        r
+00036e80: 6570 6c61 6365 3a20 5768 6574 6865 7220  eplace: Whether 
+00036e90: 746f 2072 6570 6c61 6365 2061 2055 4446  to replace a UDF
+00036ea0: 2074 6861 7420 616c 7265 6164 7920 7761   that already wa
+00036eb0: 7320 7265 6769 7374 6572 6564 2e20 5468  s registered. Th
+00036ec0: 6520 6465 6661 756c 7420 6973 2060 6046  e default is ``F
+00036ed0: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
+00036ee0: 2020 2020 4966 2069 7420 6973 2060 6046      If it is ``F
+00036ef0: 616c 7365 6060 2c20 6174 7465 6d70 7469  alse``, attempti
+00036f00: 6e67 2074 6f20 7265 6769 7374 6572 2061  ng to register a
+00036f10: 2055 4446 2077 6974 6820 6120 6e61 6d65   UDF with a name
+00036f20: 2074 6861 7420 616c 7265 6164 7920 6578   that already ex
+00036f30: 6973 7473 0a20 2020 2020 2020 2020 2020  ists.           
+00036f40: 2072 6573 756c 7473 2069 6e20 6120 6060   results in a ``
+00036f50: 536e 6f77 7061 726b 5351 4c45 7863 6570  SnowparkSQLExcep
+00036f60: 7469 6f6e 6060 2065 7863 6570 7469 6f6e  tion`` exception
+00036f70: 2062 6569 6e67 2074 6872 6f77 6e2e 2049   being thrown. I
+00036f80: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
+00036f90: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
+00036fa0: 2065 7869 7374 696e 6720 5544 4620 7769   existing UDF wi
+00036fb0: 7468 2074 6865 2073 616d 6520 6e61 6d65  th the same name
+00036fc0: 2069 7320 6f76 6572 7772 6974 7465 6e2e   is overwritten.
+00036fd0: 0a20 2020 2020 2020 2069 665f 6e6f 745f  .        if_not_
+00036fe0: 6578 6973 7473 3a20 5768 6574 6865 7220  exists: Whether 
+00036ff0: 746f 2073 6b69 7020 6372 6561 7469 6f6e  to skip creation
+00037000: 206f 6620 6120 5544 4620 7768 656e 206f   of a UDF when o
+00037010: 6e65 2077 6974 6820 7468 6520 7361 6d65  ne with the same
+00037020: 2073 6967 6e61 7475 7265 2061 6c72 6561   signature alrea
+00037030: 6479 2065 7869 7374 732e 0a20 2020 2020  dy exists..     
+00037040: 2020 2020 2020 2054 6865 2064 6566 6175         The defau
+00037050: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
+00037060: 2060 6069 665f 6e6f 745f 6578 6973 7473   ``if_not_exists
+00037070: 6060 2061 6e64 2060 6072 6570 6c61 6365  `` and ``replace
+00037080: 6060 2061 7265 206d 7574 7561 6c6c 7920  `` are mutually 
+00037090: 6578 636c 7573 6976 650a 2020 2020 2020  exclusive.      
+000370a0: 2020 2020 2020 616e 6420 6120 6060 5661        and a ``Va
+000370b0: 6c75 6545 7272 6f72 6060 2069 7320 7261  lueError`` is ra
+000370c0: 6973 6564 2077 6865 6e20 626f 7468 2061  ised when both a
+000370d0: 7265 2073 6574 2e20 4966 2069 7420 6973  re set. If it is
+000370e0: 2060 6054 7275 6560 6020 616e 6420 6120   ``True`` and a 
+000370f0: 5544 4620 7769 7468 0a20 2020 2020 2020  UDF with.       
+00037100: 2020 2020 2074 6865 2073 616d 6520 7369       the same si
+00037110: 676e 6174 7572 6520 6578 6973 7473 2c20  gnature exists, 
+00037120: 7468 6520 5544 4620 6372 6561 7469 6f6e  the UDF creation
+00037130: 2069 7320 736b 6970 7065 642e 0a20 2020   is skipped..   
+00037140: 2020 2020 2073 6573 7369 6f6e 3a20 5573       session: Us
+00037150: 6520 7468 6973 2073 6573 7369 6f6e 2074  e this session t
+00037160: 6f20 7265 6769 7374 6572 2074 6865 2055  o register the U
+00037170: 4446 2e20 4966 2069 7427 7320 6e6f 7420  DF. If it's not 
+00037180: 7370 6563 6966 6965 642c 2074 6865 2073  specified, the s
+00037190: 6573 7369 6f6e 2074 6861 7420 796f 7520  ession that you 
+000371a0: 6372 6561 7465 6420 6265 666f 7265 2063  created before c
+000371b0: 616c 6c69 6e67 2074 6869 7320 6675 6e63  alling this func
+000371c0: 7469 6f6e 2077 696c 6c20 6265 2075 7365  tion will be use
+000371d0: 642e 0a20 2020 2020 2020 2020 2020 2059  d..            Y
+000371e0: 6f75 206e 6565 6420 746f 2073 7065 6369  ou need to speci
+000371f0: 6679 2074 6869 7320 7061 7261 6d65 7465  fy this paramete
+00037200: 7220 6966 2079 6f75 2068 6176 6520 6372  r if you have cr
+00037210: 6561 7465 6420 6d75 6c74 6970 6c65 2073  eated multiple s
+00037220: 6573 7369 6f6e 7320 6265 666f 7265 2063  essions before c
+00037230: 616c 6c69 6e67 2074 6869 7320 6d65 7468  alling this meth
+00037240: 6f64 2e0a 2020 2020 2020 2020 7061 7261  od..        para
+00037250: 6c6c 656c 3a20 5468 6520 6e75 6d62 6572  llel: The number
+00037260: 206f 6620 7468 7265 6164 7320 746f 2075   of threads to u
+00037270: 7365 2066 6f72 2075 706c 6f61 6469 6e67  se for uploading
+00037280: 2055 4446 2066 696c 6573 2077 6974 6820   UDF files with 
+00037290: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+000372a0: 6050 5554 203c 6874 7470 733a 2f2f 646f  `PUT <https://do
+000372b0: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
+000372c0: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
+000372d0: 652f 7371 6c2f 7075 742e 6874 6d6c 2370  e/sql/put.html#p
+000372e0: 7574 3e60 5f0a 2020 2020 2020 2020 2020  ut>`_.          
+000372f0: 2020 636f 6d6d 616e 642e 2054 6865 2064    command. The d
+00037300: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
+00037310: 3420 616e 6420 7375 7070 6f72 7465 6420  4 and supported 
+00037320: 7661 6c75 6573 2061 7265 2066 726f 6d20  values are from 
+00037330: 3120 746f 2039 392e 0a20 2020 2020 2020  1 to 99..       
+00037340: 2020 2020 2049 6e63 7265 6173 696e 6720       Increasing 
+00037350: 7468 6520 6e75 6d62 6572 206f 6620 7468  the number of th
+00037360: 7265 6164 7320 6361 6e20 696d 7072 6f76  reads can improv
+00037370: 6520 7065 7266 6f72 6d61 6e63 6520 7768  e performance wh
+00037380: 656e 2075 706c 6f61 6469 6e67 0a20 2020  en uploading.   
+00037390: 2020 2020 2020 2020 206c 6172 6765 2055           large U
+000373a0: 4446 2066 696c 6573 2e0a 2020 2020 2020  DF files..      
+000373b0: 2020 6d61 785f 6261 7463 685f 7369 7a65    max_batch_size
+000373c0: 3a20 5468 6520 6d61 7869 6d75 6d20 6e75  : The maximum nu
+000373d0: 6d62 6572 206f 6620 726f 7773 2070 6572  mber of rows per
+000373e0: 2069 6e70 7574 2050 616e 6461 7320 4461   input Pandas Da
+000373f0: 7461 4672 616d 6520 6f72 2050 616e 6461  taFrame or Panda
+00037400: 7320 5365 7269 6573 0a20 2020 2020 2020  s Series.       
+00037410: 2020 2020 2069 6e73 6964 6520 6120 7665       inside a ve
+00037420: 6374 6f72 697a 6564 2055 4446 2e20 4265  ctorized UDF. Be
+00037430: 6361 7573 6520 6120 7665 6374 6f72 697a  cause a vectoriz
+00037440: 6564 2055 4446 2077 696c 6c20 6265 2065  ed UDF will be e
+00037450: 7865 6375 7465 6420 7769 7468 696e 2061  xecuted within a
+00037460: 2074 696d 6520 6c69 6d69 742c 0a20 2020   time limit,.   
+00037470: 2020 2020 2020 2020 2077 6869 6368 2069           which i
+00037480: 7320 6036 3060 2073 6563 6f6e 6473 2c20  s `60` seconds, 
+00037490: 7468 6973 206f 7074 696f 6e61 6c20 6172  this optional ar
+000374a0: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+000374b0: 6564 2074 6f20 7265 6475 6365 2074 6865  ed to reduce the
+000374c0: 2072 756e 6e69 6e67 2074 696d 6520 6f66   running time of
+000374d0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
+000374e0: 7279 2062 6174 6368 2062 7920 7365 7474  ry batch by sett
+000374f0: 696e 6720 6120 736d 616c 6c65 7220 6261  ing a smaller ba
+00037500: 7463 6820 7369 7a65 2e20 4e6f 7465 2074  tch size. Note t
+00037510: 6861 7420 7365 7474 696e 6720 6120 6c61  hat setting a la
+00037520: 7267 6572 2076 616c 7565 2064 6f65 7320  rger value does 
+00037530: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
+00037540: 6775 6172 616e 7465 6520 7468 6174 2053  guarantee that S
+00037550: 6e6f 7766 6c61 6b65 2077 696c 6c20 656e  nowflake will en
+00037560: 636f 6465 2062 6174 6368 6573 2077 6974  code batches wit
+00037570: 6820 7468 6520 7370 6563 6966 6965 6420  h the specified 
+00037580: 6e75 6d62 6572 206f 6620 726f 7773 2e20  number of rows. 
+00037590: 4974 2077 696c 6c0a 2020 2020 2020 2020  It will.        
+000375a0: 2020 2020 6265 2069 676e 6f72 6564 2077      be ignored w
+000375b0: 6865 6e20 7265 6769 7374 6572 696e 6720  hen registering 
+000375c0: 6120 6e6f 6e2d 7665 6374 6f72 697a 6564  a non-vectorized
+000375d0: 2055 4446 2e0a 2020 2020 2020 2020 7374   UDF..        st
+000375e0: 6174 656d 656e 745f 7061 7261 6d73 3a20  atement_params: 
+000375f0: 4469 6374 696f 6e61 7279 206f 6620 7374  Dictionary of st
+00037600: 6174 656d 656e 7420 6c65 7665 6c20 7061  atement level pa
+00037610: 7261 6d65 7465 7273 2074 6f20 6265 2073  rameters to be s
+00037620: 6574 2077 6869 6c65 2065 7865 6375 7469  et while executi
+00037630: 6e67 2074 6869 7320 6163 7469 6f6e 2e0a  ng this action..
+00037640: 2020 2020 2020 2020 736f 7572 6365 5f63          source_c
+00037650: 6f64 655f 6469 7370 6c61 793a 2044 6973  ode_display: Dis
+00037660: 706c 6179 2074 6865 2073 6f75 7263 6520  play the source 
+00037670: 636f 6465 206f 6620 7468 6520 5544 4620  code of the UDF 
+00037680: 6066 756e 6360 2061 7320 636f 6d6d 656e  `func` as commen
+00037690: 7473 2069 6e20 7468 6520 6765 6e65 7261  ts in the genera
+000376a0: 7465 6420 7363 7269 7074 2e0a 2020 2020  ted script..    
+000376b0: 2020 2020 2020 2020 5468 6520 736f 7572          The sour
+000376c0: 6365 2063 6f64 6520 6973 2064 796e 616d  ce code is dynam
+000376d0: 6963 616c 6c79 2067 656e 6572 6174 6564  ically generated
+000376e0: 2074 6865 7265 666f 7265 2069 7420 6d61   therefore it ma
+000376f0: 7920 6e6f 7420 6265 2069 6465 6e74 6963  y not be identic
+00037700: 616c 2074 6f20 686f 7720 7468 650a 2020  al to how the.  
+00037710: 2020 2020 2020 2020 2020 6066 756e 6360            `func`
+00037720: 2069 7320 6f72 6967 696e 616c 6c79 2064   is originally d
+00037730: 6566 696e 6564 2e20 5468 6520 6465 6661  efined. The defa
+00037740: 756c 7420 6973 2060 6054 7275 6560 602e  ult is ``True``.
+00037750: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00037760: 6974 2069 7320 6060 4661 6c73 6560 602c  it is ``False``,
+00037770: 2073 6f75 7263 6520 636f 6465 2077 696c   source code wil
+00037780: 6c20 6e6f 7420 6265 2067 656e 6572 6174  l not be generat
+00037790: 6564 206f 7220 6469 7370 6c61 7965 642e  ed or displayed.
+000377a0: 0a20 2020 2020 2020 2073 7472 6963 743a  .        strict:
+000377b0: 2057 6865 7468 6572 2074 6865 2063 7265   Whether the cre
+000377c0: 6174 6564 2055 4446 2069 7320 7374 7269  ated UDF is stri
+000377d0: 6374 2e20 4120 7374 7269 6374 2055 4446  ct. A strict UDF
+000377e0: 2077 696c 6c20 6e6f 7420 696e 766f 6b65   will not invoke
+000377f0: 2074 6865 2055 4446 2069 6620 616e 7920   the UDF if any 
+00037800: 696e 7075 7420 6973 0a20 2020 2020 2020  input is.       
+00037810: 2020 2020 206e 756c 6c2e 2049 6e73 7465       null. Inste
+00037820: 6164 2c20 6120 6e75 6c6c 2076 616c 7565  ad, a null value
+00037830: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
+00037840: 7265 7475 726e 6564 2066 6f72 2074 6861  returned for tha
+00037850: 7420 726f 772e 204e 6f74 6520 7468 6174  t row. Note that
+00037860: 2074 6865 2055 4446 206d 6967 6874 0a20   the UDF might. 
+00037870: 2020 2020 2020 2020 2020 2073 7469 6c6c             still
+00037880: 2072 6574 7572 6e20 6e75 6c6c 2066 6f72   return null for
+00037890: 206e 6f6e 2d6e 756c 6c20 696e 7075 7473   non-null inputs
+000378a0: 2e0a 2020 2020 2020 2020 7365 6375 7265  ..        secure
+000378b0: 3a20 5768 6574 6865 7220 7468 6520 6372  : Whether the cr
+000378c0: 6561 7465 6420 5544 4620 6973 2073 6563  eated UDF is sec
+000378d0: 7572 652e 2046 6f72 206d 6f72 6520 696e  ure. For more in
+000378e0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
+000378f0: 7365 6375 7265 2066 756e 6374 696f 6e73  secure functions
+00037900: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+00037910: 6520 6053 6563 7572 6520 5544 4673 203c  e `Secure UDFs <
+00037920: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
+00037930: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
+00037940: 6c2d 7265 6665 7265 6e63 652f 7564 662d  l-reference/udf-
+00037950: 7365 6375 7265 2e68 746d 6c3e 605f 2e0a  secure.html>`_..
+00037960: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+00037970: 2020 2020 2020 4120 5544 4620 6675 6e63        A UDF func
+00037980: 7469 6f6e 2074 6861 7420 6361 6e20 6265  tion that can be
+00037990: 2063 616c 6c65 6420 7769 7468 203a 636c   called with :cl
+000379a0: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
+000379b0: 736e 6f77 7061 726b 2e43 6f6c 756d 6e60  snowpark.Column`
+000379c0: 2065 7870 7265 7373 696f 6e73 2e0a 0a20   expressions... 
+000379d0: 2020 204e 6f74 653a 0a20 2020 2020 2020     Note:.       
+000379e0: 2031 2e20 5768 656e 2074 7970 6520 6869   1. When type hi
+000379f0: 6e74 7320 6172 6520 7072 6f76 6964 6564  nts are provided
+00037a00: 2061 6e64 2061 7265 2063 6f6d 706c 6574   and are complet
+00037a10: 6520 666f 7220 6120 6675 6e63 7469 6f6e  e for a function
+00037a20: 2c0a 2020 2020 2020 2020 6060 7265 7475  ,.        ``retu
+00037a30: 726e 5f74 7970 6560 6020 616e 6420 6060  rn_type`` and ``
+00037a40: 696e 7075 745f 7479 7065 7360 6020 6172  input_types`` ar
+00037a50: 6520 6f70 7469 6f6e 616c 2061 6e64 2077  e optional and w
+00037a60: 696c 6c20 6265 2069 676e 6f72 6564 2e0a  ill be ignored..
+00037a70: 2020 2020 2020 2020 5365 6520 6465 7461          See deta
+00037a80: 696c 7320 6f66 2073 7570 706f 7274 6564  ils of supported
+00037a90: 2064 6174 6120 7479 7065 7320 666f 7220   data types for 
+00037aa0: 5544 4673 2069 6e0a 2020 2020 2020 2020  UDFs in.        
+00037ab0: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
+00037ac0: 6b65 2e73 6e6f 7770 6172 6b2e 7564 662e  ke.snowpark.udf.
+00037ad0: 5544 4652 6567 6973 7472 6174 696f 6e60  UDFRegistration`
+00037ae0: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00037af0: 2059 6f75 2063 616e 2075 7365 2075 7365   You can use use
+00037b00: 203a 6174 7472 3a60 7e73 6e6f 7766 6c61   :attr:`~snowfla
+00037b10: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+00037b20: 732e 5661 7269 616e 7460 2074 6f0a 2020  s.Variant` to.  
+00037b30: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
+00037b40: 7461 7465 2061 2076 6172 6961 6e74 2c20  tate a variant, 
+00037b50: 616e 6420 7573 6520 3a61 7474 723a 607e  and use :attr:`~
+00037b60: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00037b70: 726b 2e74 7970 6573 2e47 656f 6772 6170  rk.types.Geograp
+00037b80: 6879 600a 2020 2020 2020 2020 2020 2020  hy`.            
+00037b90: 2020 746f 2061 6e6e 6f74 6174 6520 6120    to annotate a 
+00037ba0: 6765 6f67 7261 7068 7920 7768 656e 2064  geography when d
+00037bb0: 6566 696e 696e 6720 6120 5544 462e 0a0a  efining a UDF...
+00037bc0: 2020 2020 2020 2020 2020 2020 2d20 596f              - Yo
+00037bd0: 7520 6361 6e20 7573 6520 7573 6520 3a61  u can use use :a
+00037be0: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
+00037bf0: 736e 6f77 7061 726b 2e74 7970 6573 2e50  snowpark.types.P
+00037c00: 616e 6461 7353 6572 6965 7360 2074 6f20  andasSeries` to 
+00037c10: 616e 6e6f 7461 7465 0a20 2020 2020 2020  annotate.       
+00037c20: 2020 2020 2020 2061 2050 616e 6461 7320         a Pandas 
+00037c30: 5365 7269 6573 2c20 616e 6420 7573 6520  Series, and use 
+00037c40: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
+00037c50: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00037c60: 2e50 616e 6461 7344 6174 6146 7261 6d65  .PandasDataFrame
+00037c70: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
+00037c80: 746f 2061 6e6e 6f74 6174 6520 6120 5061  to annotate a Pa
+00037c90: 6e64 6173 2044 6174 6146 7261 6d65 2077  ndas DataFrame w
+00037ca0: 6865 6e20 6465 6669 6e69 6e67 2061 2076  hen defining a v
+00037cb0: 6563 746f 7269 7a65 6420 5544 462e 0a20  ectorized UDF.. 
+00037cc0: 2020 2020 2020 2020 2020 2020 204e 6f74               Not
+00037cd0: 6520 7468 6174 2074 6865 7920 6172 6520  e that they are 
+00037ce0: 6765 6e65 7269 6320 7479 7065 7320 736f  generic types so
+00037cf0: 2079 6f75 2063 616e 2073 7065 6369 6679   you can specify
+00037d00: 2074 6865 2065 6c65 6d65 6e74 2074 7970   the element typ
+00037d10: 6520 696e 2061 0a20 2020 2020 2020 2020  e in a.         
+00037d20: 2020 2020 2050 616e 6461 7320 5365 7269       Pandas Seri
+00037d30: 6573 2061 6e64 2044 6174 6146 7261 6d65  es and DataFrame
+00037d40: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00037d50: 203a 636c 6173 733a 6074 7970 696e 672e   :class:`typing.
+00037d60: 556e 696f 6e60 2069 7320 6e6f 7420 6120  Union` is not a 
+00037d70: 7661 6c69 6420 7479 7065 2061 6e6e 6f74  valid type annot
+00037d80: 6174 696f 6e20 666f 7220 5544 4673 2c0a  ation for UDFs,.
+00037d90: 2020 2020 2020 2020 2020 2020 2020 6275                bu
+00037da0: 7420 3a63 6c61 7373 3a60 7479 7069 6e67  t :class:`typing
+00037db0: 2e4f 7074 696f 6e61 6c60 2063 616e 2062  .Optional` can b
+00037dc0: 6520 7573 6564 2074 6f20 696e 6469 6361  e used to indica
+00037dd0: 7465 2074 6865 206f 7074 696f 6e61 6c20  te the optional 
+00037de0: 7479 7065 2e0a 0a20 2020 2020 2020 2020  type...         
+00037df0: 2020 202d 2054 7970 6520 6869 6e74 7320     - Type hints 
+00037e00: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
+00037e10: 6420 6f6e 2066 756e 6374 696f 6e73 2064  d on functions d
+00037e20: 6563 6f72 6174 6564 2077 6974 6820 6465  ecorated with de
+00037e30: 636f 7261 746f 7273 2e0a 0a20 2020 2020  corators...     
+00037e40: 2020 2032 2e20 4120 7465 6d70 6f72 6172     2. A temporar
+00037e50: 7920 5544 4620 2877 6865 6e20 6060 6973  y UDF (when ``is
+00037e60: 5f70 6572 6d61 6e65 6e74 6060 2069 7320  _permanent`` is 
+00037e70: 6060 4661 6c73 6560 6029 2069 7320 7363  ``False``) is sc
+00037e80: 6f70 6564 2074 6f20 7468 6973 2060 6073  oped to this ``s
+00037e90: 6573 7369 6f6e 6060 0a20 2020 2020 2020  ession``.       
+00037ea0: 2061 6e64 2061 6c6c 2055 4446 2072 656c   and all UDF rel
+00037eb0: 6174 6564 2066 696c 6573 2077 696c 6c20  ated files will 
+00037ec0: 6265 2075 706c 6f61 6465 6420 746f 2061  be uploaded to a
+00037ed0: 2074 656d 706f 7261 7279 2073 6573 7369   temporary sessi
+00037ee0: 6f6e 2073 7461 6765 0a20 2020 2020 2020  on stage.       
+00037ef0: 2028 3a66 756e 633a 6073 6573 7369 6f6e   (:func:`session
+00037f00: 2e67 6574 5f73 6573 7369 6f6e 5f73 7461  .get_session_sta
+00037f10: 6765 2829 203c 736e 6f77 666c 616b 652e  ge() <snowflake.
+00037f20: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
+00037f30: 2e67 6574 5f73 6573 7369 6f6e 5f73 7461  .get_session_sta
+00037f40: 6765 3e60 292e 0a20 2020 2020 2020 2046  ge>`)..        F
+00037f50: 6f72 2061 2070 6572 6d61 6e65 6e74 2055  or a permanent U
+00037f60: 4446 2c20 7468 6573 6520 6669 6c65 7320  DF, these files 
+00037f70: 7769 6c6c 2062 6520 7570 6c6f 6164 6564  will be uploaded
+00037f80: 2074 6f20 7468 6520 7374 6167 6520 7468   to the stage th
+00037f90: 6174 2079 6f75 2070 726f 7669 6465 2e0a  at you provide..
+00037fa0: 0a20 2020 2020 2020 2033 2e20 4279 2064  .        3. By d
+00037fb0: 6566 6175 6c74 2c20 5544 4620 7265 6769  efault, UDF regi
+00037fc0: 7374 7261 7469 6f6e 2066 6169 6c73 2069  stration fails i
+00037fd0: 6620 6120 6675 6e63 7469 6f6e 2077 6974  f a function wit
+00037fe0: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+00037ff0: 6973 2061 6c72 6561 6479 0a20 2020 2020  is already.     
+00038000: 2020 2072 6567 6973 7465 7265 642e 2049     registered. I
+00038010: 6e76 6f6b 696e 6720 3a66 756e 633a 6075  nvoking :func:`u
+00038020: 6466 6020 7769 7468 2060 6072 6570 6c61  df` with ``repla
+00038030: 6365 6060 2073 6574 2074 6f20 6060 5472  ce`` set to ``Tr
+00038040: 7565 6060 2077 696c 6c20 6f76 6572 7772  ue`` will overwr
+00038050: 6974 6520 7468 650a 2020 2020 2020 2020  ite the.        
+00038060: 7072 6576 696f 7573 6c79 2072 6567 6973  previously regis
+00038070: 7465 7265 6420 6675 6e63 7469 6f6e 2e0a  tered function..
+00038080: 0a20 2020 2020 2020 2034 2e20 5768 656e  .        4. When
+00038090: 2072 6567 6973 7465 7269 6e67 2061 2076   registering a v
+000380a0: 6563 746f 7269 7a65 6420 5544 462c 2060  ectorized UDF, `
+000380b0: 6070 616e 6461 7360 6020 6c69 6272 6172  `pandas`` librar
+000380c0: 7920 7769 6c6c 2062 6520 6164 6465 6420  y will be added 
+000380d0: 6173 2061 2070 6163 6b61 6765 0a20 2020  as a package.   
+000380e0: 2020 2020 2061 7574 6f6d 6174 6963 616c       automatical
+000380f0: 6c79 2c20 7769 7468 2074 6865 206c 6174  ly, with the lat
+00038100: 6573 7420 7665 7273 696f 6e20 6f6e 2074  est version on t
+00038110: 6865 2053 6e6f 7766 6c61 6b65 2073 6572  he Snowflake ser
+00038120: 7665 722e 2049 6620 796f 7520 646f 6e27  ver. If you don'
+00038130: 7420 7761 6e74 2074 6f0a 2020 2020 2020  t want to.      
+00038140: 2020 7573 6520 7468 6973 2076 6572 7369    use this versi
+00038150: 6f6e 2c20 796f 7520 6361 6e20 6f76 6572  on, you can over
+00038160: 7772 6974 6520 6974 2062 7920 6164 6469  write it by addi
+00038170: 6e67 2060 7061 6e64 6173 6020 7769 7468  ng `pandas` with
+00038180: 2073 7065 6369 6669 6320 7665 7273 696f   specific versio
+00038190: 6e0a 2020 2020 2020 2020 7265 7175 6972  n.        requir
+000381a0: 656d 656e 7420 7573 696e 6720 6060 7061  ement using ``pa
+000381b0: 636b 6167 6560 6020 6172 6775 6d65 6e74  ckage`` argument
+000381c0: 206f 7220 3a6d 6574 683a 607e 736e 6f77   or :meth:`~snow
+000381d0: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
+000381e0: 6573 7369 6f6e 2e61 6464 5f70 6163 6b61  ession.add_packa
+000381f0: 6765 7360 2e0a 0a20 2020 2053 6565 2041  ges`...    See A
+00038200: 6c73 6f3a 0a20 2020 2020 2020 203a 636c  lso:.        :cl
+00038210: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
+00038220: 736e 6f77 7061 726b 2e75 6466 2e55 4446  snowpark.udf.UDF
+00038230: 5265 6769 7374 7261 7469 6f6e 600a 0a20  Registration`.. 
+00038240: 2020 2055 4446 7320 6361 6e20 6265 2063     UDFs can be c
+00038250: 7265 6174 6564 2061 7320 616e 6f6e 796d  reated as anonym
+00038260: 6f75 7320 5544 4673 0a0a 2020 2020 4578  ous UDFs..    Ex
+00038270: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00038280: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00038290: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+000382a0: 6573 2069 6d70 6f72 7420 496e 7465 6765  es import Intege
+000382b0: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
+000382c0: 3e20 6164 645f 6f6e 6520 3d20 7564 6628  > add_one = udf(
+000382d0: 6c61 6d62 6461 2078 3a20 782b 312c 2072  lambda x: x+1, r
+000382e0: 6574 7572 6e5f 7479 7065 3d49 6e74 6567  eturn_type=Integ
+000382f0: 6572 5479 7065 2829 2c20 696e 7075 745f  erType(), input_
+00038300: 7479 7065 733d 5b49 6e74 6567 6572 5479  types=[IntegerTy
+00038310: 7065 2829 5d29 0a20 2020 2020 2020 203e  pe()]).        >
+00038320: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00038330: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00038340: 285b 312c 2032 2c20 335d 2c20 7363 6865  ([1, 2, 3], sche
+00038350: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+00038360: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00038370: 6164 645f 6f6e 6528 636f 6c28 2261 2229  add_one(col("a")
+00038380: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
+00038390: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000383a0: 5b52 6f77 2841 4e53 3d32 292c 2052 6f77  [Row(ANS=2), Row
+000383b0: 2841 4e53 3d33 292c 2052 6f77 2841 4e53  (ANS=3), Row(ANS
+000383c0: 3d34 295d 0a0a 2020 2020 6f72 2061 7320  =4)]..    or as 
+000383d0: 6e61 6d65 6420 5544 4673 2074 6861 7420  named UDFs that 
+000383e0: 6172 6520 6163 6365 7373 6962 6c65 2069  are accessible i
+000383f0: 6e20 7468 6520 7361 6d65 2073 6573 7369  n the same sessi
+00038400: 6f6e 2e20 496e 7374 6561 6420 6f66 2063  on. Instead of c
+00038410: 616c 6c69 6e67 2060 7564 6660 2061 7320  alling `udf` as 
+00038420: 6675 6e63 7469 6f6e 2c20 6974 2063 616e  function, it can
+00038430: 2062 6520 616c 736f 2075 7365 640a 2020   be also used.  
+00038440: 2020 6173 2061 2064 6563 6f72 6174 6f72    as a decorator
+00038450: 3a0a 0a20 2020 2045 7861 6d70 6c65 3a3a  :..    Example::
+00038460: 0a0a 2020 2020 2020 2020 3e3e 3e20 4075  ..        >>> @u
+00038470: 6466 286e 616d 653d 226d 696e 7573 5f6f  df(name="minus_o
+00038480: 6e65 222c 2072 6570 6c61 6365 3d54 7275  ne", replace=Tru
+00038490: 6529 0a20 2020 2020 2020 202e 2e2e 2064  e).        ... d
+000384a0: 6566 206d 696e 7573 5f6f 6e65 2878 3a20  ef minus_one(x: 
+000384b0: 696e 7429 202d 3e20 696e 743a 0a20 2020  int) -> int:.   
+000384c0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+000384d0: 7572 6e20 7820 2d20 310a 2020 2020 2020  urn x - 1.      
+000384e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000384f0: 6d69 6e75 735f 6f6e 6528 636f 6c28 2261  minus_one(col("a
+00038500: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
+00038510: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00038520: 2020 5b52 6f77 2841 4e53 3d30 292c 2052    [Row(ANS=0), R
+00038530: 6f77 2841 4e53 3d31 292c 2052 6f77 2841  ow(ANS=1), Row(A
+00038540: 4e53 3d32 295d 0a20 2020 2020 2020 203e  NS=2)].        >
+00038550: 3e3e 2073 6573 7369 6f6e 2e73 716c 2822  >> session.sql("
+00038560: 5345 4c45 4354 206d 696e 7573 5f6f 6e65  SELECT minus_one
+00038570: 2831 3029 2229 2e63 6f6c 6c65 6374 2829  (10)").collect()
+00038580: 0a20 2020 2020 2020 205b 526f 7728 4d49  .        [Row(MI
+00038590: 4e55 535f 4f4e 4528 3130 293d 3929 5d0a  NUS_ONE(10)=9)].
+000385a0: 0a20 2020 2022 2222 0a20 2020 2073 6573  .    """.    ses
+000385b0: 7369 6f6e 203d 2073 6573 7369 6f6e 206f  sion = session o
+000385c0: 7220 736e 6f77 666c 616b 652e 736e 6f77  r snowflake.snow
+000385d0: 7061 726b 2e73 6573 7369 6f6e 2e5f 6765  park.session._ge
+000385e0: 745f 6163 7469 7665 5f73 6573 7369 6f6e  t_active_session
+000385f0: 2829 0a20 2020 2069 6620 6675 6e63 2069  ().    if func i
+00038600: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00038610: 7265 7475 726e 2066 756e 6374 6f6f 6c73  return functools
+00038620: 2e70 6172 7469 616c 280a 2020 2020 2020  .partial(.      
+00038630: 2020 2020 2020 7365 7373 696f 6e2e 7564        session.ud
+00038640: 662e 7265 6769 7374 6572 2c0a 2020 2020  f.register,.    
+00038650: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
+00038660: 7970 653d 7265 7475 726e 5f74 7970 652c  ype=return_type,
+00038670: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+00038680: 7574 5f74 7970 6573 3d69 6e70 7574 5f74  ut_types=input_t
+00038690: 7970 6573 2c0a 2020 2020 2020 2020 2020  ypes,.          
+000386a0: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
+000386b0: 2020 2020 2020 2020 2069 735f 7065 726d           is_perm
+000386c0: 616e 656e 743d 6973 5f70 6572 6d61 6e65  anent=is_permane
+000386d0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+000386e0: 7374 6167 655f 6c6f 6361 7469 6f6e 3d73  stage_location=s
+000386f0: 7461 6765 5f6c 6f63 6174 696f 6e2c 0a20  tage_location,. 
+00038700: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+00038710: 7473 3d69 6d70 6f72 7473 2c0a 2020 2020  ts=imports,.    
+00038720: 2020 2020 2020 2020 7061 636b 6167 6573          packages
+00038730: 3d70 6163 6b61 6765 732c 0a20 2020 2020  =packages,.     
+00038740: 2020 2020 2020 2072 6570 6c61 6365 3d72         replace=r
+00038750: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
+00038760: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
+00038770: 733d 6966 5f6e 6f74 5f65 7869 7374 732c  s=if_not_exists,
+00038780: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00038790: 616c 6c65 6c3d 7061 7261 6c6c 656c 2c0a  allel=parallel,.
+000387a0: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+000387b0: 6261 7463 685f 7369 7a65 3d6d 6178 5f62  batch_size=max_b
+000387c0: 6174 6368 5f73 697a 652c 0a20 2020 2020  atch_size,.     
+000387d0: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
+000387e0: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
+000387f0: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
+00038800: 2020 2020 2020 736f 7572 6365 5f63 6f64        source_cod
+00038810: 655f 6469 7370 6c61 793d 736f 7572 6365  e_display=source
+00038820: 5f63 6f64 655f 6469 7370 6c61 792c 0a20  _code_display,. 
+00038830: 2020 2020 2020 2020 2020 2073 7472 6963             stric
+00038840: 743d 7374 7269 6374 2c0a 2020 2020 2020  t=strict,.      
+00038850: 2020 2020 2020 7365 6375 7265 3d73 6563        secure=sec
+00038860: 7572 652c 0a20 2020 2020 2020 2029 0a20  ure,.        ). 
+00038870: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00038880: 2072 6574 7572 6e20 7365 7373 696f 6e2e   return session.
+00038890: 7564 662e 7265 6769 7374 6572 280a 2020  udf.register(.  
+000388a0: 2020 2020 2020 2020 2020 6675 6e63 2c0a            func,.
+000388b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000388c0: 726e 5f74 7970 653d 7265 7475 726e 5f74  rn_type=return_t
+000388d0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+000388e0: 2069 6e70 7574 5f74 7970 6573 3d69 6e70   input_types=inp
+000388f0: 7574 5f74 7970 6573 2c0a 2020 2020 2020  ut_types,.      
+00038900: 2020 2020 2020 6e61 6d65 3d6e 616d 652c        name=name,
+00038910: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+00038920: 7065 726d 616e 656e 743d 6973 5f70 6572  permanent=is_per
+00038930: 6d61 6e65 6e74 2c0a 2020 2020 2020 2020  manent,.        
+00038940: 2020 2020 7374 6167 655f 6c6f 6361 7469      stage_locati
+00038950: 6f6e 3d73 7461 6765 5f6c 6f63 6174 696f  on=stage_locatio
+00038960: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
+00038970: 6d70 6f72 7473 3d69 6d70 6f72 7473 2c0a  mports=imports,.
+00038980: 2020 2020 2020 2020 2020 2020 7061 636b              pack
+00038990: 6167 6573 3d70 6163 6b61 6765 732c 0a20  ages=packages,. 
+000389a0: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
+000389b0: 6365 3d72 6570 6c61 6365 2c0a 2020 2020  ce=replace,.    
+000389c0: 2020 2020 2020 2020 6966 5f6e 6f74 5f65          if_not_e
+000389d0: 7869 7374 733d 6966 5f6e 6f74 5f65 7869  xists=if_not_exi
+000389e0: 7374 732c 0a20 2020 2020 2020 2020 2020  sts,.           
+000389f0: 2070 6172 616c 6c65 6c3d 7061 7261 6c6c   parallel=parall
+00038a00: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+00038a10: 6d61 785f 6261 7463 685f 7369 7a65 3d6d  max_batch_size=m
+00038a20: 6178 5f62 6174 6368 5f73 697a 652c 0a20  ax_batch_size,. 
+00038a30: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00038a40: 6d65 6e74 5f70 6172 616d 733d 7374 6174  ment_params=stat
+00038a50: 656d 656e 745f 7061 7261 6d73 2c0a 2020  ement_params,.  
+00038a60: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00038a70: 5f63 6f64 655f 6469 7370 6c61 793d 736f  _code_display=so
+00038a80: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
+00038a90: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
+00038aa0: 7472 6963 743d 7374 7269 6374 2c0a 2020  trict=strict,.  
+00038ab0: 2020 2020 2020 2020 2020 7365 6375 7265            secure
+00038ac0: 3d73 6563 7572 652c 0a20 2020 2020 2020  =secure,.       
+00038ad0: 2029 0a0a 0a64 6566 2075 6474 6628 0a20   )...def udtf(. 
+00038ae0: 2020 2068 616e 646c 6572 3a20 4f70 7469     handler: Opti
+00038af0: 6f6e 616c 5b43 616c 6c61 626c 655d 203d  onal[Callable] =
+00038b00: 204e 6f6e 652c 0a20 2020 202a 2c0a 2020   None,.    *,.  
+00038b10: 2020 6f75 7470 7574 5f73 6368 656d 613a    output_schema:
+00038b20: 2055 6e69 6f6e 5b53 7472 7563 7454 7970   Union[StructTyp
+00038b30: 652c 204c 6973 745b 7374 725d 5d2c 0a20  e, List[str]],. 
+00038b40: 2020 2069 6e70 7574 5f74 7970 6573 3a20     input_types: 
+00038b50: 4f70 7469 6f6e 616c 5b4c 6973 745b 4461  Optional[List[Da
+00038b60: 7461 5479 7065 5d5d 203d 204e 6f6e 652c  taType]] = None,
+00038b70: 0a20 2020 206e 616d 653a 204f 7074 696f  .    name: Optio
+00038b80: 6e61 6c5b 556e 696f 6e5b 7374 722c 2049  nal[Union[str, I
+00038b90: 7465 7261 626c 655b 7374 725d 5d5d 203d  terable[str]]] =
+00038ba0: 204e 6f6e 652c 0a20 2020 2069 735f 7065   None,.    is_pe
+00038bb0: 726d 616e 656e 743a 2062 6f6f 6c20 3d20  rmanent: bool = 
+00038bc0: 4661 6c73 652c 0a20 2020 2073 7461 6765  False,.    stage
+00038bd0: 5f6c 6f63 6174 696f 6e3a 204f 7074 696f  _location: Optio
+00038be0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00038bf0: 0a20 2020 2069 6d70 6f72 7473 3a20 4f70  .    imports: Op
+00038c00: 7469 6f6e 616c 5b4c 6973 745b 556e 696f  tional[List[Unio
+00038c10: 6e5b 7374 722c 2054 7570 6c65 5b73 7472  n[str, Tuple[str
+00038c20: 2c20 7374 725d 5d5d 5d20 3d20 4e6f 6e65  , str]]]] = None
+00038c30: 2c0a 2020 2020 7061 636b 6167 6573 3a20  ,.    packages: 
+00038c40: 4f70 7469 6f6e 616c 5b4c 6973 745b 556e  Optional[List[Un
+00038c50: 696f 6e5b 7374 722c 204d 6f64 756c 6554  ion[str, ModuleT
+00038c60: 7970 655d 5d5d 203d 204e 6f6e 652c 0a20  ype]]] = None,. 
+00038c70: 2020 2072 6570 6c61 6365 3a20 626f 6f6c     replace: bool
+00038c80: 203d 2046 616c 7365 2c0a 2020 2020 6966   = False,.    if
+00038c90: 5f6e 6f74 5f65 7869 7374 733a 2062 6f6f  _not_exists: boo
+00038ca0: 6c20 3d20 4661 6c73 652c 0a20 2020 2073  l = False,.    s
+00038cb0: 6573 7369 6f6e 3a20 4f70 7469 6f6e 616c  ession: Optional
+00038cc0: 5b22 736e 6f77 666c 616b 652e 736e 6f77  ["snowflake.snow
+00038cd0: 7061 726b 2e73 6573 7369 6f6e 2e53 6573  park.session.Ses
+00038ce0: 7369 6f6e 225d 203d 204e 6f6e 652c 0a20  sion"] = None,. 
+00038cf0: 2020 2070 6172 616c 6c65 6c3a 2069 6e74     parallel: int
+00038d00: 203d 2034 2c0a 2020 2020 7374 6174 656d   = 4,.    statem
+00038d10: 656e 745f 7061 7261 6d73 3a20 4f70 7469  ent_params: Opti
+00038d20: 6f6e 616c 5b44 6963 745b 7374 722c 2073  onal[Dict[str, s
+00038d30: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+00038d40: 2073 7472 6963 743a 2062 6f6f 6c20 3d20   strict: bool = 
+00038d50: 4661 6c73 652c 0a20 2020 2073 6563 7572  False,.    secur
+00038d60: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+00038d70: 0a29 202d 3e20 556e 696f 6e5b 5573 6572  .) -> Union[User
+00038d80: 4465 6669 6e65 6454 6162 6c65 4675 6e63  DefinedTableFunc
+00038d90: 7469 6f6e 2c20 6675 6e63 746f 6f6c 732e  tion, functools.
+00038da0: 7061 7274 6961 6c5d 3a0a 2020 2020 2222  partial]:.    ""
+00038db0: 2252 6567 6973 7465 7273 2061 2050 7974  "Registers a Pyt
+00038dc0: 686f 6e20 636c 6173 7320 6173 2061 2053  hon class as a S
+00038dd0: 6e6f 7766 6c61 6b65 2050 7974 686f 6e20  nowflake Python 
+00038de0: 5544 5446 2061 6e64 2072 6574 7572 6e73  UDTF and returns
+00038df0: 2074 6865 2055 4454 462e 0a0a 2020 2020   the UDTF...    
+00038e00: 4974 2063 616e 2062 6520 7573 6564 2061  It can be used a
+00038e10: 7320 6569 7468 6572 2061 2066 756e 6374  s either a funct
+00038e20: 696f 6e20 6361 6c6c 206f 7220 6120 6465  ion call or a de
+00038e30: 636f 7261 746f 722e 2049 6e20 6d6f 7374  corator. In most
+00038e40: 2063 6173 6573 2079 6f75 2077 6f72 6b20   cases you work 
+00038e50: 7769 7468 2061 2073 696e 676c 6520 7365  with a single se
+00038e60: 7373 696f 6e2e 0a20 2020 2054 6869 7320  ssion..    This 
+00038e70: 6675 6e63 7469 6f6e 2075 7365 7320 7468  function uses th
+00038e80: 6174 2073 6573 7369 6f6e 2074 6f20 7265  at session to re
+00038e90: 6769 7374 6572 2074 6865 2055 4454 462e  gister the UDTF.
+00038ea0: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
+00038eb0: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
+00038ec0: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
+00038ed0: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
+00038ee0: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
+00038ef0: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
+00038f00: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
+00038f10: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
+00038f20: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
+00038f30: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
+00038f40: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
+00038f50: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
+00038f60: 7365 2060 6073 6573 7369 6f6e 2e75 6474  se ``session.udt
+00038f70: 662e 7265 6769 7374 6572 6060 2069 6e73  f.register`` ins
+00038f80: 7465 6164 2e20 5365 6520 6578 616d 706c  tead. See exampl
+00038f90: 6573 0a20 2020 2069 6e20 3a63 6c61 7373  es.    in :class
+00038fa0: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+00038fb0: 7770 6172 6b2e 7564 7466 2e55 4454 4652  wpark.udtf.UDTFR
+00038fc0: 6567 6973 7472 6174 696f 6e60 2e0a 0a20  egistration`... 
+00038fd0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00038fe0: 2068 616e 646c 6572 3a20 4120 5079 7468   handler: A Pyth
+00038ff0: 6f6e 2063 6c61 7373 2075 7365 6420 666f  on class used fo
+00039000: 7220 6372 6561 7469 6e67 2074 6865 2055  r creating the U
+00039010: 4454 462e 0a20 2020 2020 2020 206f 7574  DTF..        out
+00039020: 7075 745f 7363 6865 6d61 3a20 4120 6c69  put_schema: A li
+00039030: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
+00039040: 6573 2c20 6f72 2061 203a 636c 6173 733a  es, or a :class:
+00039050: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+00039060: 7061 726b 2e74 7970 6573 2e53 7472 7563  park.types.Struc
+00039070: 7454 7970 6560 2069 6e73 7461 6e63 6520  tType` instance 
+00039080: 7468 6174 2072 6570 7265 7365 6e74 7320  that represents 
+00039090: 7468 6520 7461 626c 6520 6675 6e63 7469  the table functi
+000390a0: 6f6e 2773 2063 6f6c 756d 6e73 2e0a 2020  on's columns..  
+000390b0: 2020 2020 2020 2049 6620 6120 6c69 7374         If a list
+000390c0: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
+000390d0: 2069 7320 7072 6f76 6964 6564 2c20 7468   is provided, th
+000390e0: 6520 6060 7072 6f63 6573 7360 6020 6d65  e ``process`` me
+000390f0: 7468 6f64 206f 6620 7468 6520 6861 6e64  thod of the hand
+00039100: 6c65 7220 636c 6173 7320 6d75 7374 2068  ler class must h
+00039110: 6176 6520 7265 7475 726e 2074 7970 6520  ave return type 
+00039120: 6869 6e74 7320 746f 2069 6e64 6963 6174  hints to indicat
+00039130: 6520 7468 6520 6f75 7470 7574 2073 6368  e the output sch
+00039140: 656d 6120 6461 7461 2074 7970 6573 2e0a  ema data types..
+00039150: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
+00039160: 7065 733a 2041 206c 6973 7420 6f66 203a  pes: A list of :
+00039170: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+00039180: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00039190: 2e44 6174 6154 7970 6560 0a20 2020 2020  .DataType`.     
+000391a0: 2020 2020 2020 2072 6570 7265 7365 6e74         represent
+000391b0: 696e 6720 7468 6520 696e 7075 7420 6461  ing the input da
+000391c0: 7461 2074 7970 6573 206f 6620 7468 6520  ta types of the 
+000391d0: 5544 5446 2e20 4f70 7469 6f6e 616c 2069  UDTF. Optional i
+000391e0: 660a 2020 2020 2020 2020 2020 2020 7479  f.            ty
+000391f0: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
+00039200: 7669 6465 642e 0a20 2020 2020 2020 206e  vided..        n
+00039210: 616d 653a 2041 2073 7472 696e 6720 6f72  ame: A string or
+00039220: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
+00039230: 2074 6861 7420 7370 6563 6966 7920 7468   that specify th
+00039240: 6520 6e61 6d65 206f 7220 6675 6c6c 792d  e name or fully-
+00039250: 7175 616c 6966 6965 640a 2020 2020 2020  qualified.      
+00039260: 2020 2020 2020 6f62 6a65 6374 2069 6465        object ide
+00039270: 6e74 6966 6965 7220 2864 6174 6162 6173  ntifier (databas
+00039280: 6520 6e61 6d65 2c20 7363 6865 6d61 206e  e name, schema n
+00039290: 616d 652c 2061 6e64 2066 756e 6374 696f  ame, and functio
+000392a0: 6e20 6e61 6d65 2920 666f 720a 2020 2020  n name) for.    
+000392b0: 2020 2020 2020 2020 7468 6520 5544 5446          the UDTF
+000392c0: 2069 6e20 536e 6f77 666c 616b 652c 2077   in Snowflake, w
+000392d0: 6869 6368 2061 6c6c 6f77 7320 796f 7520  hich allows you 
+000392e0: 746f 2063 616c 6c20 7468 6973 2055 4454  to call this UDT
+000392f0: 4620 696e 2061 2053 514c 0a20 2020 2020  F in a SQL.     
+00039300: 2020 2020 2020 2063 6f6d 6d61 6e64 206f         command o
+00039310: 7220 7669 6120 3a66 756e 633a 6063 616c  r via :func:`cal
+00039320: 6c5f 7564 7466 2829 602e 2049 6620 6974  l_udtf()`. If it
+00039330: 2069 7320 6e6f 7420 7072 6f76 6964 6564   is not provided
+00039340: 2c20 6120 6e61 6d65 2077 696c 6c0a 2020  , a name will.  
+00039350: 2020 2020 2020 2020 2020 6265 2061 7574            be aut
+00039360: 6f6d 6174 6963 616c 6c79 2067 656e 6572  omatically gener
+00039370: 6174 6564 2066 6f72 2074 6865 2055 4454  ated for the UDT
+00039380: 462e 2041 206e 616d 6520 6d75 7374 2062  F. A name must b
+00039390: 6520 7370 6563 6966 6965 6420 7768 656e  e specified when
+000393a0: 0a20 2020 2020 2020 2020 2020 2060 6069  .            ``i
+000393b0: 735f 7065 726d 616e 656e 7460 6020 6973  s_permanent`` is
+000393c0: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
+000393d0: 2020 2069 735f 7065 726d 616e 656e 743a     is_permanent:
+000393e0: 2057 6865 7468 6572 2074 6f20 6372 6561   Whether to crea
+000393f0: 7465 2061 2070 6572 6d61 6e65 6e74 2055  te a permanent U
+00039400: 4454 462e 2054 6865 2064 6566 6175 6c74  DTF. The default
+00039410: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
+00039420: 2020 2020 2020 2020 2020 2049 6620 6974             If it
+00039430: 2069 7320 6060 5472 7565 6060 2c20 6120   is ``True``, a 
+00039440: 7661 6c69 6420 6060 7374 6167 655f 6c6f  valid ``stage_lo
+00039450: 6361 7469 6f6e 6060 206d 7573 7420 6265  cation`` must be
+00039460: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
+00039470: 2020 2073 7461 6765 5f6c 6f63 6174 696f     stage_locatio
+00039480: 6e3a 2054 6865 2073 7461 6765 206c 6f63  n: The stage loc
+00039490: 6174 696f 6e20 7768 6572 6520 7468 6520  ation where the 
+000394a0: 5079 7468 6f6e 2066 696c 6520 666f 7220  Python file for 
+000394b0: 7468 6520 5544 5446 0a20 2020 2020 2020  the UDTF.       
+000394c0: 2020 2020 2061 6e64 2069 7473 2064 6570       and its dep
+000394d0: 656e 6465 6e63 6965 7320 7368 6f75 6c64  endencies should
+000394e0: 2062 6520 7570 6c6f 6164 6564 2e20 5468   be uploaded. Th
+000394f0: 6520 7374 6167 6520 6c6f 6361 7469 6f6e  e stage location
+00039500: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+00039510: 6564 0a20 2020 2020 2020 2020 2020 2077  ed.            w
+00039520: 6865 6e20 6060 6973 5f70 6572 6d61 6e65  hen ``is_permane
+00039530: 6e74 6060 2069 7320 6060 5472 7565 6060  nt`` is ``True``
+00039540: 2c20 616e 6420 6974 2077 696c 6c20 6265  , and it will be
+00039550: 2069 676e 6f72 6564 2077 6865 6e0a 2020   ignored when.  
+00039560: 2020 2020 2020 2020 2020 6060 6973 5f70            ``is_p
+00039570: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
+00039580: 4661 6c73 6560 602e 2049 7420 6361 6e20  False``. It can 
+00039590: 6265 2061 6e79 2073 7461 6765 206f 7468  be any stage oth
+000395a0: 6572 2074 6861 6e20 7465 6d70 6f72 6172  er than temporar
+000395b0: 790a 2020 2020 2020 2020 2020 2020 7374  y.            st
+000395c0: 6167 6573 2061 6e64 2065 7874 6572 6e61  ages and externa
+000395d0: 6c20 7374 6167 6573 2e0a 2020 2020 2020  l stages..      
+000395e0: 2020 696d 706f 7274 733a 2041 206c 6973    imports: A lis
+000395f0: 7420 6f66 2069 6d70 6f72 7473 2074 6861  t of imports tha
+00039600: 7420 6f6e 6c79 2061 7070 6c79 2074 6f20  t only apply to 
+00039610: 7468 6973 2055 4454 462e 2059 6f75 2063  this UDTF. You c
+00039620: 616e 2075 7365 2061 2073 7472 696e 6720  an use a string 
+00039630: 746f 0a20 2020 2020 2020 2020 2020 2072  to.            r
+00039640: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
+00039650: 7061 7468 2028 7369 6d69 6c61 7220 746f  path (similar to
+00039660: 2074 6865 2060 6070 6174 6860 6020 6172   the ``path`` ar
+00039670: 6775 6d65 6e74 2069 6e0a 2020 2020 2020  gument in.      
+00039680: 2020 2020 2020 3a6d 6574 683a 607e 736e        :meth:`~sn
+00039690: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+000396a0: 2e53 6573 7369 6f6e 2e61 6464 5f69 6d70  .Session.add_imp
+000396b0: 6f72 7460 2920 696e 2074 6869 7320 6c69  ort`) in this li
+000396c0: 7374 2c20 6f72 2061 2074 7570 6c65 206f  st, or a tuple o
+000396d0: 6620 7477 6f0a 2020 2020 2020 2020 2020  f two.          
+000396e0: 2020 7374 7269 6e67 7320 746f 2072 6570    strings to rep
+000396f0: 7265 7365 6e74 2061 2066 696c 6520 7061  resent a file pa
+00039700: 7468 2061 6e64 2061 6e20 696d 706f 7274  th and an import
+00039710: 2070 6174 6820 2873 696d 696c 6172 2074   path (similar t
+00039720: 6f20 7468 6520 6060 696d 706f 7274 5f70  o the ``import_p
+00039730: 6174 6860 600a 2020 2020 2020 2020 2020  ath``.          
+00039740: 2020 6172 6775 6d65 6e74 2069 6e20 3a6d    argument in :m
+00039750: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
+00039760: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
+00039770: 2e61 6464 5f69 6d70 6f72 7460 292e 2054  .add_import`). T
+00039780: 6865 7365 2055 4454 462d 6c65 7665 6c20  hese UDTF-level 
+00039790: 696d 706f 7274 730a 2020 2020 2020 2020  imports.        
+000397a0: 2020 2020 7769 6c6c 206f 7665 7272 6964      will overrid
+000397b0: 6520 7468 6520 7365 7373 696f 6e2d 6c65  e the session-le
+000397c0: 7665 6c20 696d 706f 7274 7320 6164 6465  vel imports adde
+000397d0: 6420 6279 0a20 2020 2020 2020 2020 2020  d by.           
+000397e0: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
+000397f0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
+00039800: 696f 6e2e 6164 645f 696d 706f 7274 602e  ion.add_import`.
+00039810: 0a20 2020 2020 2020 2070 6163 6b61 6765  .        package
+00039820: 733a 2041 206c 6973 7420 6f66 2070 6163  s: A list of pac
+00039830: 6b61 6765 7320 7468 6174 206f 6e6c 7920  kages that only 
+00039840: 6170 706c 7920 746f 2074 6869 7320 5544  apply to this UD
+00039850: 5446 2e20 5468 6573 6520 5544 5446 2d6c  TF. These UDTF-l
+00039860: 6576 656c 2070 6163 6b61 6765 730a 2020  evel packages.  
+00039870: 2020 2020 2020 2020 2020 7769 6c6c 206f            will o
+00039880: 7665 7272 6964 6520 7468 6520 7365 7373  verride the sess
+00039890: 696f 6e2d 6c65 7665 6c20 7061 636b 6167  ion-level packag
+000398a0: 6573 2061 6464 6564 2062 790a 2020 2020  es added by.    
+000398b0: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
+000398c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000398d0: 726b 2e53 6573 7369 6f6e 2e61 6464 5f70  rk.Session.add_p
+000398e0: 6163 6b61 6765 7360 2061 6e64 0a20 2020  ackages` and.   
+000398f0: 2020 2020 2020 2020 203a 6d65 7468 3a60           :meth:`
+00039900: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+00039910: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
+00039920: 7265 7175 6972 656d 656e 7473 602e 0a20  requirements`.. 
+00039930: 2020 2020 2020 2072 6570 6c61 6365 3a20         replace: 
+00039940: 5768 6574 6865 7220 746f 2072 6570 6c61  Whether to repla
+00039950: 6365 2061 2055 4454 4620 7468 6174 2061  ce a UDTF that a
+00039960: 6c72 6561 6479 2077 6173 2072 6567 6973  lready was regis
+00039970: 7465 7265 642e 2054 6865 2064 6566 6175  tered. The defau
+00039980: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
+00039990: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+000399a0: 6974 2069 7320 6060 4661 6c73 6560 602c  it is ``False``,
+000399b0: 2061 7474 656d 7074 696e 6720 746f 2072   attempting to r
+000399c0: 6567 6973 7465 7220 6120 5544 5446 2077  egister a UDTF w
+000399d0: 6974 6820 6120 6e61 6d65 2074 6861 7420  ith a name that 
+000399e0: 616c 7265 6164 7920 6578 6973 7473 0a20  already exists. 
+000399f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00039a00: 7473 2069 6e20 6120 6060 536e 6f77 7061  ts in a ``Snowpa
+00039a10: 726b 5351 4c45 7863 6570 7469 6f6e 6060  rkSQLException``
+00039a20: 2065 7863 6570 7469 6f6e 2062 6569 6e67   exception being
+00039a30: 2074 6872 6f77 6e2e 2049 6620 6974 2069   thrown. If it i
+00039a40: 7320 6060 5472 7565 6060 2c0a 2020 2020  s ``True``,.    
+00039a50: 2020 2020 2020 2020 616e 2065 7869 7374          an exist
+00039a60: 696e 6720 5544 5446 2077 6974 6820 7468  ing UDTF with th
+00039a70: 6520 7361 6d65 206e 616d 6520 6973 206f  e same name is o
+00039a80: 7665 7277 7269 7474 656e 2e0a 2020 2020  verwritten..    
+00039a90: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
+00039aa0: 733a 2057 6865 7468 6572 2074 6f20 736b  s: Whether to sk
+00039ab0: 6970 2063 7265 6174 696f 6e20 6f66 2061  ip creation of a
+00039ac0: 2055 4454 4620 7768 656e 206f 6e65 2077   UDTF when one w
+00039ad0: 6974 6820 7468 6520 7361 6d65 2073 6967  ith the same sig
+00039ae0: 6e61 7475 7265 2061 6c72 6561 6479 2065  nature already e
+00039af0: 7869 7374 732e 0a20 2020 2020 2020 2020  xists..         
+00039b00: 2020 2054 6865 2064 6566 6175 6c74 2069     The default i
+00039b10: 7320 6060 4661 6c73 6560 602e 2060 6069  s ``False``. ``i
+00039b20: 665f 6e6f 745f 6578 6973 7473 6060 2061  f_not_exists`` a
+00039b30: 6e64 2060 6072 6570 6c61 6365 6060 2061  nd ``replace`` a
+00039b40: 7265 206d 7574 7561 6c6c 7920 6578 636c  re mutually excl
+00039b50: 7573 6976 650a 2020 2020 2020 2020 2020  usive.          
+00039b60: 2020 616e 6420 6120 6060 5661 6c75 6545    and a ``ValueE
+00039b70: 7272 6f72 6060 2069 7320 7261 6973 6564  rror`` is raised
+00039b80: 2077 6865 6e20 626f 7468 2061 7265 2073   when both are s
+00039b90: 6574 2e20 4966 2069 7420 6973 2060 6054  et. If it is ``T
+00039ba0: 7275 6560 6020 616e 6420 6120 5544 5446  rue`` and a UDTF
+00039bb0: 2077 6974 680a 2020 2020 2020 2020 2020   with.          
+00039bc0: 2020 7468 6520 7361 6d65 2073 6967 6e61    the same signa
+00039bd0: 7475 7265 2065 7869 7374 732c 2074 6865  ture exists, the
+00039be0: 2055 4454 4620 6372 6561 7469 6f6e 2069   UDTF creation i
+00039bf0: 7320 736b 6970 7065 642e 0a20 2020 2020  s skipped..     
+00039c00: 2020 2073 6573 7369 6f6e 3a20 5573 6520     session: Use 
+00039c10: 7468 6973 2073 6573 7369 6f6e 2074 6f20  this session to 
+00039c20: 7265 6769 7374 6572 2074 6865 2055 4454  register the UDT
+00039c30: 462e 2049 6620 6974 2773 206e 6f74 2073  F. If it's not s
+00039c40: 7065 6369 6669 6564 2c20 7468 6520 7365  pecified, the se
+00039c50: 7373 696f 6e20 7468 6174 2079 6f75 2063  ssion that you c
+00039c60: 7265 6174 6564 2062 6566 6f72 6520 6361  reated before ca
+00039c70: 6c6c 696e 6720 7468 6973 2066 756e 6374  lling this funct
+00039c80: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
+00039c90: 2e0a 2020 2020 2020 2020 2020 2020 596f  ..            Yo
+00039ca0: 7520 6e65 6564 2074 6f20 7370 6563 6966  u need to specif
+00039cb0: 7920 7468 6973 2070 6172 616d 6574 6572  y this parameter
+00039cc0: 2069 6620 796f 7520 6861 7665 2063 7265   if you have cre
+00039cd0: 6174 6564 206d 756c 7469 706c 6520 7365  ated multiple se
+00039ce0: 7373 696f 6e73 2062 6566 6f72 6520 6361  ssions before ca
+00039cf0: 6c6c 696e 6720 7468 6973 206d 6574 686f  lling this metho
+00039d00: 642e 0a20 2020 2020 2020 2070 6172 616c  d..        paral
+00039d10: 6c65 6c3a 2054 6865 206e 756d 6265 7220  lel: The number 
+00039d20: 6f66 2074 6872 6561 6473 2074 6f20 7573  of threads to us
+00039d30: 6520 666f 7220 7570 6c6f 6164 696e 6720  e for uploading 
+00039d40: 5544 5446 2066 696c 6573 2077 6974 6820  UDTF files with 
+00039d50: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00039d60: 6050 5554 203c 6874 7470 733a 2f2f 646f  `PUT <https://do
+00039d70: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
+00039d80: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
+00039d90: 652f 7371 6c2f 7075 742e 6874 6d6c 2370  e/sql/put.html#p
+00039da0: 7574 3e60 5f0a 2020 2020 2020 2020 2020  ut>`_.          
+00039db0: 2020 636f 6d6d 616e 642e 2054 6865 2064    command. The d
+00039dc0: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
+00039dd0: 3420 616e 6420 7375 7070 6f72 7465 6420  4 and supported 
+00039de0: 7661 6c75 6573 2061 7265 2066 726f 6d20  values are from 
+00039df0: 3120 746f 2039 392e 0a20 2020 2020 2020  1 to 99..       
+00039e00: 2020 2020 2049 6e63 7265 6173 696e 6720       Increasing 
+00039e10: 7468 6520 6e75 6d62 6572 206f 6620 7468  the number of th
+00039e20: 7265 6164 7320 6361 6e20 696d 7072 6f76  reads can improv
+00039e30: 6520 7065 7266 6f72 6d61 6e63 6520 7768  e performance wh
+00039e40: 656e 2075 706c 6f61 6469 6e67 0a20 2020  en uploading.   
+00039e50: 2020 2020 2020 2020 206c 6172 6765 2055           large U
+00039e60: 4454 4620 6669 6c65 732e 0a20 2020 2020  DTF files..     
+00039e70: 2020 2073 7461 7465 6d65 6e74 5f70 6172     statement_par
+00039e80: 616d 733a 2044 6963 7469 6f6e 6172 7920  ams: Dictionary 
+00039e90: 6f66 2073 7461 7465 6d65 6e74 206c 6576  of statement lev
+00039ea0: 656c 2070 6172 616d 6574 6572 7320 746f  el parameters to
+00039eb0: 2062 6520 7365 7420 7768 696c 6520 6578   be set while ex
+00039ec0: 6563 7574 696e 6720 7468 6973 2061 6374  ecuting this act
+00039ed0: 696f 6e2e 0a20 2020 2020 2020 2073 7472  ion..        str
+00039ee0: 6963 743a 2057 6865 7468 6572 2074 6865  ict: Whether the
+00039ef0: 2063 7265 6174 6564 2055 4454 4620 6973   created UDTF is
+00039f00: 2073 7472 6963 742e 2041 2073 7472 6963   strict. A stric
+00039f10: 7420 5544 5446 2077 696c 6c20 6e6f 7420  t UDTF will not 
+00039f20: 696e 766f 6b65 2074 6865 2055 4454 4620  invoke the UDTF 
+00039f30: 6966 2061 6e79 2069 6e70 7574 2069 730a  if any input is.
+00039f40: 2020 2020 2020 2020 2020 2020 6e75 6c6c              null
+00039f50: 2e20 496e 7374 6561 642c 2061 206e 756c  . Instead, a nul
+00039f60: 6c20 7661 6c75 6520 7769 6c6c 2061 6c77  l value will alw
+00039f70: 6179 7320 6265 2072 6574 7572 6e65 6420  ays be returned 
+00039f80: 666f 7220 7468 6174 2072 6f77 2e20 4e6f  for that row. No
+00039f90: 7465 2074 6861 7420 7468 6520 5544 5446  te that the UDTF
+00039fa0: 206d 6967 6874 0a20 2020 2020 2020 2020   might.         
+00039fb0: 2020 2073 7469 6c6c 2072 6574 7572 6e20     still return 
+00039fc0: 6e75 6c6c 2066 6f72 206e 6f6e 2d6e 756c  null for non-nul
+00039fd0: 6c20 696e 7075 7473 2e0a 2020 2020 2020  l inputs..      
+00039fe0: 2020 7365 6375 7265 3a20 5768 6574 6865    secure: Whethe
+00039ff0: 7220 7468 6520 6372 6561 7465 6420 5544  r the created UD
+0003a000: 5446 2069 7320 7365 6375 7265 2e20 466f  TF is secure. Fo
+0003a010: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+0003a020: 6f6e 2061 626f 7574 2073 6563 7572 6520  on about secure 
+0003a030: 6675 6e63 7469 6f6e 732c 0a20 2020 2020  functions,.     
+0003a040: 2020 2020 2020 2073 6565 2060 5365 6375         see `Secu
+0003a050: 7265 2055 4446 7320 3c68 7474 7073 3a2f  re UDFs <https:/
+0003a060: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
+0003a070: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
+0003a080: 656e 6365 2f75 6466 2d73 6563 7572 652e  ence/udf-secure.
+0003a090: 6874 6d6c 3e60 5f2e 0a0a 2020 2020 5265  html>`_...    Re
+0003a0a0: 7475 726e 733a 0a20 2020 2020 2020 2041  turns:.        A
+0003a0b0: 2055 4454 4620 6675 6e63 7469 6f6e 2074   UDTF function t
+0003a0c0: 6861 7420 6361 6e20 6265 2063 616c 6c65  hat can be calle
+0003a0d0: 6420 7769 7468 203a 636c 6173 733a 607e  d with :class:`~
+0003a0e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003a0f0: 726b 2e43 6f6c 756d 6e60 2065 7870 7265  rk.Column` expre
+0003a100: 7373 696f 6e73 2e0a 0a20 2020 204e 6f74  ssions...    Not
+0003a110: 653a 0a20 2020 2020 2020 2031 2e20 5768  e:.        1. Wh
+0003a120: 656e 2074 7970 6520 6869 6e74 7320 6172  en type hints ar
+0003a130: 6520 7072 6f76 6964 6564 2061 6e64 2061  e provided and a
+0003a140: 7265 2063 6f6d 706c 6574 6520 666f 7220  re complete for 
+0003a150: 6120 6675 6e63 7469 6f6e 2c0a 2020 2020  a function,.    
+0003a160: 2020 2020 6060 7265 7475 726e 5f74 7970      ``return_typ
+0003a170: 6560 6020 616e 6420 6060 696e 7075 745f  e`` and ``input_
+0003a180: 7479 7065 7360 6020 6172 6520 6f70 7469  types`` are opti
+0003a190: 6f6e 616c 2061 6e64 2077 696c 6c20 6265  onal and will be
+0003a1a0: 2069 676e 6f72 6564 2e0a 2020 2020 2020   ignored..      
+0003a1b0: 2020 5365 6520 6465 7461 696c 7320 6f66    See details of
+0003a1c0: 2073 7570 706f 7274 6564 2064 6174 6120   supported data 
+0003a1d0: 7479 7065 7320 666f 7220 5544 5446 7320  types for UDTFs 
+0003a1e0: 696e 0a20 2020 2020 2020 203a 636c 6173  in.        :clas
+0003a1f0: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
+0003a200: 6f77 7061 726b 2e75 6474 662e 5544 5446  owpark.udtf.UDTF
+0003a210: 5265 6769 7374 7261 7469 6f6e 602e 0a0a  Registration`...
+0003a220: 2020 2020 2020 2020 2020 2020 2d20 596f              - Yo
+0003a230: 7520 6361 6e20 7573 6520 7573 6520 3a61  u can use use :a
+0003a240: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
+0003a250: 736e 6f77 7061 726b 2e74 7970 6573 2e56  snowpark.types.V
+0003a260: 6172 6961 6e74 6020 746f 0a20 2020 2020  ariant` to.     
+0003a270: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
+0003a280: 6520 6120 7661 7269 616e 742c 2061 6e64  e a variant, and
+0003a290: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
+0003a2a0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003a2b0: 7479 7065 732e 4765 6f67 7261 7068 7960  types.Geography`
+0003a2c0: 0a20 2020 2020 2020 2020 2020 2020 2074  .              t
+0003a2d0: 6f20 616e 6e6f 7461 7465 2061 2067 656f  o annotate a geo
+0003a2e0: 6772 6170 6879 2077 6865 6e20 6465 6669  graphy when defi
+0003a2f0: 6e69 6e67 2061 2055 4454 462e 0a0a 2020  ning a UDTF...  
+0003a300: 2020 2020 2020 2020 2020 2d20 3a63 6c61            - :cla
+0003a310: 7373 3a60 7479 7069 6e67 2e55 6e69 6f6e  ss:`typing.Union
+0003a320: 6020 6973 206e 6f74 2061 2076 616c 6964  ` is not a valid
+0003a330: 2074 7970 6520 616e 6e6f 7461 7469 6f6e   type annotation
+0003a340: 2066 6f72 2055 4454 4673 2c0a 2020 2020   for UDTFs,.    
+0003a350: 2020 2020 2020 2020 2020 6275 7420 3a63            but :c
+0003a360: 6c61 7373 3a60 7479 7069 6e67 2e4f 7074  lass:`typing.Opt
+0003a370: 696f 6e61 6c60 2063 616e 2062 6520 7573  ional` can be us
+0003a380: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
+0003a390: 6865 206f 7074 696f 6e61 6c20 7479 7065  he optional type
+0003a3a0: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
+0003a3b0: 2054 7970 6520 6869 6e74 7320 6172 6520   Type hints are 
+0003a3c0: 6e6f 7420 7375 7070 6f72 7465 6420 6f6e  not supported on
+0003a3d0: 2066 756e 6374 696f 6e73 2064 6563 6f72   functions decor
+0003a3e0: 6174 6564 2077 6974 6820 6465 636f 7261  ated with decora
+0003a3f0: 746f 7273 2e0a 0a20 2020 2020 2020 2032  tors...        2
+0003a400: 2e20 4120 7465 6d70 6f72 6172 7920 5544  . A temporary UD
+0003a410: 5446 2028 7768 656e 2060 6069 735f 7065  TF (when ``is_pe
+0003a420: 726d 616e 656e 7460 6020 6973 2060 6046  rmanent`` is ``F
+0003a430: 616c 7365 6060 2920 6973 2073 636f 7065  alse``) is scope
+0003a440: 6420 746f 2074 6869 7320 6060 7365 7373  d to this ``sess
+0003a450: 696f 6e60 600a 2020 2020 2020 2020 616e  ion``.        an
+0003a460: 6420 616c 6c20 5544 5446 2072 656c 6174  d all UDTF relat
+0003a470: 6564 2066 696c 6573 2077 696c 6c20 6265  ed files will be
+0003a480: 2075 706c 6f61 6465 6420 746f 2061 2074   uploaded to a t
+0003a490: 656d 706f 7261 7279 2073 6573 7369 6f6e  emporary session
+0003a4a0: 2073 7461 6765 0a20 2020 2020 2020 2028   stage.        (
+0003a4b0: 3a66 756e 633a 6073 6573 7369 6f6e 2e67  :func:`session.g
+0003a4c0: 6574 5f73 6573 7369 6f6e 5f73 7461 6765  et_session_stage
+0003a4d0: 2829 203c 736e 6f77 666c 616b 652e 736e  () <snowflake.sn
+0003a4e0: 6f77 7061 726b 2e53 6573 7369 6f6e 2e67  owpark.Session.g
+0003a4f0: 6574 5f73 6573 7369 6f6e 5f73 7461 6765  et_session_stage
+0003a500: 3e60 292e 0a20 2020 2020 2020 2046 6f72  >`)..        For
+0003a510: 2061 2070 6572 6d61 6e65 6e74 2055 4454   a permanent UDT
+0003a520: 462c 2074 6865 7365 2066 696c 6573 2077  F, these files w
+0003a530: 696c 6c20 6265 2075 706c 6f61 6465 6420  ill be uploaded 
+0003a540: 746f 2074 6865 2073 7461 6765 2074 6861  to the stage tha
+0003a550: 7420 796f 7520 7370 6563 6966 792e 0a0a  t you specify...
+0003a560: 2020 2020 2020 2020 332e 2042 7920 6465          3. By de
+0003a570: 6661 756c 742c 2055 4454 4620 7265 6769  fault, UDTF regi
+0003a580: 7374 7261 7469 6f6e 2066 6169 6c73 2069  stration fails i
+0003a590: 6620 6120 6675 6e63 7469 6f6e 2077 6974  f a function wit
+0003a5a0: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+0003a5b0: 6973 2061 6c72 6561 6479 0a20 2020 2020  is already.     
+0003a5c0: 2020 2072 6567 6973 7465 7265 642e 2049     registered. I
+0003a5d0: 6e76 6f6b 696e 6720 3a66 756e 633a 6075  nvoking :func:`u
+0003a5e0: 6474 6660 2077 6974 6820 6060 7265 706c  dtf` with ``repl
+0003a5f0: 6163 6560 6020 7365 7420 746f 2060 6054  ace`` set to ``T
+0003a600: 7275 6560 6020 7769 6c6c 206f 7665 7277  rue`` will overw
+0003a610: 7269 7465 2074 6865 0a20 2020 2020 2020  rite the.       
+0003a620: 2070 7265 7669 6f75 736c 7920 7265 6769   previously regi
+0003a630: 7374 6572 6564 2066 756e 6374 696f 6e2e  stered function.
+0003a640: 0a0a 2020 2020 5365 6520 416c 736f 3a0a  ..    See Also:.
+0003a650: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
+0003a660: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+0003a670: 6172 6b2e 7564 7466 2e55 4454 4652 6567  ark.udtf.UDTFReg
+0003a680: 6973 7472 6174 696f 6e60 0a0a 0a20 2020  istration`...   
+0003a690: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0003a6a0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0003a6b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003a6c0: 7479 7065 7320 696d 706f 7274 2049 6e74  types import Int
+0003a6d0: 6567 6572 5479 7065 2c20 5374 7275 6374  egerType, Struct
+0003a6e0: 4669 656c 642c 2053 7472 7563 7454 7970  Field, StructTyp
+0003a6f0: 650a 2020 2020 2020 2020 3e3e 3e20 636c  e.        >>> cl
+0003a700: 6173 7320 5072 696d 6553 6965 7665 3a0a  ass PrimeSieve:.
+0003a710: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003a720: 6465 6620 7072 6f63 6573 7328 7365 6c66  def process(self
+0003a730: 2c20 6e29 3a0a 2020 2020 2020 2020 2e2e  , n):.        ..
+0003a740: 2e20 2020 2020 2020 2020 6973 5f70 7269  .         is_pri
+0003a750: 6d65 203d 205b 5472 7565 5d20 2a20 286e  me = [True] * (n
+0003a760: 202b 2031 290a 2020 2020 2020 2020 2e2e   + 1).        ..
+0003a770: 2e20 2020 2020 2020 2020 6973 5f70 7269  .         is_pri
+0003a780: 6d65 5b30 5d20 3d20 4661 6c73 650a 2020  me[0] = False.  
+0003a790: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0003a7a0: 2020 6973 5f70 7269 6d65 5b31 5d20 3d20    is_prime[1] = 
+0003a7b0: 4661 6c73 650a 2020 2020 2020 2020 2e2e  False.        ..
+0003a7c0: 2e20 2020 2020 2020 2020 7020 3d20 320a  .         p = 2.
+0003a7d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003a7e0: 2020 2020 7768 696c 6520 7020 2a20 7020      while p * p 
+0003a7f0: 3c3d 206e 3a0a 2020 2020 2020 2020 2e2e  <= n:.        ..
+0003a800: 2e20 2020 2020 2020 2020 2020 2020 6966  .             if
+0003a810: 2069 735f 7072 696d 655b 705d 3a0a 2020   is_prime[p]:.  
+0003a820: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0003a830: 2020 2020 2020 2020 2020 2320 7365 7420            # set 
+0003a840: 616c 6c20 6d75 6c74 6970 6c65 7320 6f66  all multiples of
+0003a850: 2070 2074 6f20 4661 6c73 650a 2020 2020   p to False.    
+0003a860: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0003a870: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0003a880: 2072 616e 6765 2870 202a 2070 2c20 6e20   range(p * p, n 
+0003a890: 2b20 312c 2070 293a 0a20 2020 2020 2020  + 1, p):.       
+0003a8a0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+0003a8b0: 2020 2020 2020 2020 2069 735f 7072 696d           is_prim
+0003a8c0: 655b 695d 203d 2046 616c 7365 0a20 2020  e[i] = False.   
+0003a8d0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003a8e0: 2020 2020 2070 202b 3d20 310a 2020 2020       p += 1.    
+0003a8f0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0003a900: 2320 7969 656c 6420 616c 6c20 7072 696d  # yield all prim
+0003a910: 6520 6e75 6d62 6572 730a 2020 2020 2020  e numbers.      
+0003a920: 2020 2e2e 2e20 2020 2020 2020 2020 666f    ...         fo
+0003a930: 7220 7020 696e 2072 616e 6765 2832 2c20  r p in range(2, 
+0003a940: 6e20 2b20 3129 3a0a 2020 2020 2020 2020  n + 1):.        
+0003a950: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+0003a960: 6966 2069 735f 7072 696d 655b 705d 3a0a  if is_prime[p]:.
+0003a970: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003a980: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
+0003a990: 6420 2870 2c29 0a20 2020 2020 2020 203e  d (p,).        >
+0003a9a0: 3e3e 2070 7269 6d65 5f75 6474 6620 3d20  >> prime_udtf = 
+0003a9b0: 7564 7466 2850 7269 6d65 5369 6576 652c  udtf(PrimeSieve,
+0003a9c0: 206f 7574 7075 745f 7363 6865 6d61 3d53   output_schema=S
+0003a9d0: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
+0003a9e0: 7446 6965 6c64 2822 6e75 6d62 6572 222c  tField("number",
+0003a9f0: 2049 6e74 6567 6572 5479 7065 2829 295d   IntegerType())]
+0003aa00: 292c 2069 6e70 7574 5f74 7970 6573 3d5b  ), input_types=[
+0003aa10: 496e 7465 6765 7254 7970 6528 295d 290a  IntegerType()]).
+0003aa20: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
+0003aa30: 696f 6e2e 7461 626c 655f 6675 6e63 7469  ion.table_functi
+0003aa40: 6f6e 2870 7269 6d65 5f75 6474 6628 6c69  on(prime_udtf(li
+0003aa50: 7428 3230 2929 292e 636f 6c6c 6563 7428  t(20))).collect(
+0003aa60: 290a 2020 2020 2020 2020 5b52 6f77 284e  ).        [Row(N
+0003aa70: 554d 4245 523d 3229 2c20 526f 7728 4e55  UMBER=2), Row(NU
+0003aa80: 4d42 4552 3d33 292c 2052 6f77 284e 554d  MBER=3), Row(NUM
+0003aa90: 4245 523d 3529 2c20 526f 7728 4e55 4d42  BER=5), Row(NUMB
+0003aaa0: 4552 3d37 292c 2052 6f77 284e 554d 4245  ER=7), Row(NUMBE
+0003aab0: 523d 3131 292c 2052 6f77 284e 554d 4245  R=11), Row(NUMBE
+0003aac0: 523d 3133 292c 2052 6f77 284e 554d 4245  R=13), Row(NUMBE
+0003aad0: 523d 3137 292c 2052 6f77 284e 554d 4245  R=17), Row(NUMBE
+0003aae0: 523d 3139 295d 0a0a 2020 2020 2020 2020  R=19)]..        
+0003aaf0: 496e 7374 6561 6420 6f66 2063 616c 6c69  Instead of calli
+0003ab00: 6e67 2060 7564 7466 6020 6974 2069 7320  ng `udtf` it is 
+0003ab10: 616c 736f 2070 6f73 7369 626c 6520 746f  also possible to
+0003ab20: 2075 7365 2075 6474 6620 6173 2061 2064   use udtf as a d
+0003ab30: 6563 6f72 6174 6f72 2e0a 0a20 2020 2045  ecorator...    E
+0003ab40: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0003ab50: 2020 3e3e 3e20 4075 6474 6628 6e61 6d65    >>> @udtf(name
+0003ab60: 3d22 616c 745f 696e 7422 2c72 6570 6c61  ="alt_int",repla
+0003ab70: 6365 3d54 7275 652c 206f 7574 7075 745f  ce=True, output_
+0003ab80: 7363 6865 6d61 3d53 7472 7563 7454 7970  schema=StructTyp
+0003ab90: 6528 5b53 7472 7563 7446 6965 6c64 2822  e([StructField("
+0003aba0: 6e75 6d62 6572 222c 2049 6e74 6567 6572  number", Integer
+0003abb0: 5479 7065 2829 295d 292c 2069 6e70 7574  Type())]), input
+0003abc0: 5f74 7970 6573 3d5b 496e 7465 6765 7254  _types=[IntegerT
+0003abd0: 7970 6528 295d 290a 2020 2020 2020 2020  ype()]).        
+0003abe0: 2e2e 2e20 636c 6173 7320 416c 7465 726e  ... class Altern
+0003abf0: 6174 6f72 3a0a 2020 2020 2020 2020 2e2e  ator:.        ..
+0003ac00: 2e20 2020 2020 6465 6620 5f5f 696e 6974  .     def __init
+0003ac10: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+0003ac20: 2020 2e2e 2e20 2020 2020 2020 2020 7365    ...         se
+0003ac30: 6c66 2e5f 706f 7369 7469 7665 203d 2054  lf._positive = T
+0003ac40: 7275 650a 2020 2020 2020 2020 2e2e 2e0a  rue.        ....
+0003ac50: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003ac60: 6465 6620 7072 6f63 6573 7328 7365 6c66  def process(self
+0003ac70: 2c20 6e29 3a0a 2020 2020 2020 2020 2e2e  , n):.        ..
+0003ac80: 2e20 2020 2020 2020 2020 666f 7220 6920  .         for i 
+0003ac90: 696e 2072 616e 6765 286e 293a 0a20 2020  in range(n):.   
+0003aca0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003acb0: 2020 2020 2069 6620 7365 6c66 2e5f 706f       if self._po
+0003acc0: 7369 7469 7665 3a0a 2020 2020 2020 2020  sitive:.        
+0003acd0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+0003ace0: 2020 2020 7969 656c 6420 2831 2c29 0a20      yield (1,). 
+0003acf0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0003ad00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0003ad10: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003ad20: 2020 2020 2020 2020 2079 6965 6c64 2028           yield (
+0003ad30: 2d31 2c29 0a20 2020 2020 2020 202e 2e2e  -1,).        ...
+0003ad40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003ad50: 662e 5f70 6f73 6974 6976 6520 3d20 6e6f  f._positive = no
+0003ad60: 7420 7365 6c66 2e5f 706f 7369 7469 7665  t self._positive
+0003ad70: 0a20 2020 2020 2020 203e 3e3e 2073 6573  .        >>> ses
+0003ad80: 7369 6f6e 2e74 6162 6c65 5f66 756e 6374  sion.table_funct
+0003ad90: 696f 6e28 2261 6c74 5f69 6e74 222c 206c  ion("alt_int", l
+0003ada0: 6974 2833 2929 2e63 6f6c 6c65 6374 2829  it(3)).collect()
+0003adb0: 0a20 2020 2020 2020 205b 526f 7728 4e55  .        [Row(NU
+0003adc0: 4d42 4552 3d31 292c 2052 6f77 284e 554d  MBER=1), Row(NUM
+0003add0: 4245 523d 2d31 292c 2052 6f77 284e 554d  BER=-1), Row(NUM
+0003ade0: 4245 523d 3129 5d0a 2020 2020 2020 2020  BER=1)].        
+0003adf0: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
+0003ae00: 655f 6675 6e63 7469 6f6e 2822 616c 745f  e_function("alt_
+0003ae10: 696e 7422 2c20 6c69 7428 3229 292e 636f  int", lit(2)).co
+0003ae20: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0003ae30: 5b52 6f77 284e 554d 4245 523d 3129 2c20  [Row(NUMBER=1), 
+0003ae40: 526f 7728 4e55 4d42 4552 3d2d 3129 5d0a  Row(NUMBER=-1)].
+0003ae50: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
+0003ae60: 696f 6e2e 7461 626c 655f 6675 6e63 7469  ion.table_functi
+0003ae70: 6f6e 2822 616c 745f 696e 7422 2c20 6c69  on("alt_int", li
+0003ae80: 7428 3129 292e 636f 6c6c 6563 7428 290a  t(1)).collect().
+0003ae90: 2020 2020 2020 2020 5b52 6f77 284e 554d          [Row(NUM
+0003aea0: 4245 523d 3129 5d0a 2020 2020 2222 220a  BER=1)].    """.
+0003aeb0: 2020 2020 7365 7373 696f 6e20 3d20 7365      session = se
+0003aec0: 7373 696f 6e20 6f72 2073 6e6f 7766 6c61  ssion or snowfla
+0003aed0: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
+0003aee0: 696f 6e2e 5f67 6574 5f61 6374 6976 655f  ion._get_active_
+0003aef0: 7365 7373 696f 6e28 290a 2020 2020 6966  session().    if
+0003af00: 2068 616e 646c 6572 2069 7320 4e6f 6e65   handler is None
+0003af10: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0003af20: 2066 756e 6374 6f6f 6c73 2e70 6172 7469   functools.parti
+0003af30: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0003af40: 7365 7373 696f 6e2e 7564 7466 2e72 6567  session.udtf.reg
+0003af50: 6973 7465 722c 0a20 2020 2020 2020 2020  ister,.         
+0003af60: 2020 206f 7574 7075 745f 7363 6865 6d61     output_schema
+0003af70: 3d6f 7574 7075 745f 7363 6865 6d61 2c0a  =output_schema,.
+0003af80: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+0003af90: 745f 7479 7065 733d 696e 7075 745f 7479  t_types=input_ty
+0003afa0: 7065 732c 0a20 2020 2020 2020 2020 2020  pes,.           
+0003afb0: 206e 616d 653d 6e61 6d65 2c0a 2020 2020   name=name,.    
+0003afc0: 2020 2020 2020 2020 6973 5f70 6572 6d61          is_perma
+0003afd0: 6e65 6e74 3d69 735f 7065 726d 616e 656e  nent=is_permanen
+0003afe0: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
+0003aff0: 7461 6765 5f6c 6f63 6174 696f 6e3d 7374  tage_location=st
+0003b000: 6167 655f 6c6f 6361 7469 6f6e 2c0a 2020  age_location,.  
+0003b010: 2020 2020 2020 2020 2020 696d 706f 7274            import
+0003b020: 733d 696d 706f 7274 732c 0a20 2020 2020  s=imports,.     
+0003b030: 2020 2020 2020 2070 6163 6b61 6765 733d         packages=
+0003b040: 7061 636b 6167 6573 2c0a 2020 2020 2020  packages,.      
+0003b050: 2020 2020 2020 7265 706c 6163 653d 7265        replace=re
+0003b060: 706c 6163 652c 0a20 2020 2020 2020 2020  place,.         
+0003b070: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
+0003b080: 3d69 665f 6e6f 745f 6578 6973 7473 2c0a  =if_not_exists,.
+0003b090: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0003b0a0: 6c6c 656c 3d70 6172 616c 6c65 6c2c 0a20  llel=parallel,. 
+0003b0b0: 2020 2020 2020 2020 2020 2073 7461 7465             state
+0003b0c0: 6d65 6e74 5f70 6172 616d 733d 7374 6174  ment_params=stat
+0003b0d0: 656d 656e 745f 7061 7261 6d73 2c0a 2020  ement_params,.  
+0003b0e0: 2020 2020 2020 2020 2020 7374 7269 6374            strict
+0003b0f0: 3d73 7472 6963 742c 0a20 2020 2020 2020  =strict,.       
+0003b100: 2020 2020 2073 6563 7572 653d 7365 6375       secure=secu
+0003b110: 7265 2c0a 2020 2020 2020 2020 290a 2020  re,.        ).  
+0003b120: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003b130: 7265 7475 726e 2073 6573 7369 6f6e 2e75  return session.u
+0003b140: 6474 662e 7265 6769 7374 6572 280a 2020  dtf.register(.  
+0003b150: 2020 2020 2020 2020 2020 6861 6e64 6c65            handle
+0003b160: 722c 0a20 2020 2020 2020 2020 2020 206f  r,.            o
+0003b170: 7574 7075 745f 7363 6865 6d61 3d6f 7574  utput_schema=out
+0003b180: 7075 745f 7363 6865 6d61 2c0a 2020 2020  put_schema,.    
+0003b190: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
+0003b1a0: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
+0003b1b0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0003b1c0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
+0003b1d0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
+0003b1e0: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
+0003b1f0: 2020 2020 2020 2020 2020 2073 7461 6765             stage
+0003b200: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
+0003b210: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
+0003b220: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
+0003b230: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
+0003b240: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
+0003b250: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
+0003b260: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
+0003b270: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0003b280: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
+0003b290: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
+0003b2a0: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
+0003b2b0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
+0003b2c0: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
+0003b2d0: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
+0003b2e0: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
+0003b2f0: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
+0003b300: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+0003b310: 2073 6563 7572 653d 7365 6375 7265 2c0a   secure=secure,.
+0003b320: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+0003b330: 7061 6e64 6173 5f75 6466 280a 2020 2020  pandas_udf(.    
+0003b340: 6675 6e63 3a20 4f70 7469 6f6e 616c 5b43  func: Optional[C
+0003b350: 616c 6c61 626c 655d 203d 204e 6f6e 652c  allable] = None,
+0003b360: 0a20 2020 202a 2c0a 2020 2020 7265 7475  .    *,.    retu
+0003b370: 726e 5f74 7970 653a 204f 7074 696f 6e61  rn_type: Optiona
+0003b380: 6c5b 4461 7461 5479 7065 5d20 3d20 4e6f  l[DataType] = No
+0003b390: 6e65 2c0a 2020 2020 696e 7075 745f 7479  ne,.    input_ty
+0003b3a0: 7065 733a 204f 7074 696f 6e61 6c5b 4c69  pes: Optional[Li
+0003b3b0: 7374 5b44 6174 6154 7970 655d 5d20 3d20  st[DataType]] = 
+0003b3c0: 4e6f 6e65 2c0a 2020 2020 6e61 6d65 3a20  None,.    name: 
+0003b3d0: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b73  Optional[Union[s
+0003b3e0: 7472 2c20 4974 6572 6162 6c65 5b73 7472  tr, Iterable[str
+0003b3f0: 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ]]] = None,.    
+0003b400: 6973 5f70 6572 6d61 6e65 6e74 3a20 626f  is_permanent: bo
+0003b410: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0003b420: 7374 6167 655f 6c6f 6361 7469 6f6e 3a20  stage_location: 
+0003b430: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0003b440: 4e6f 6e65 2c0a 2020 2020 696d 706f 7274  None,.    import
+0003b450: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+0003b460: 5b55 6e69 6f6e 5b73 7472 2c20 5475 706c  [Union[str, Tupl
+0003b470: 655b 7374 722c 2073 7472 5d5d 5d5d 203d  e[str, str]]]] =
+0003b480: 204e 6f6e 652c 0a20 2020 2070 6163 6b61   None,.    packa
+0003b490: 6765 733a 204f 7074 696f 6e61 6c5b 4c69  ges: Optional[Li
+0003b4a0: 7374 5b55 6e69 6f6e 5b73 7472 2c20 4d6f  st[Union[str, Mo
+0003b4b0: 6475 6c65 5479 7065 5d5d 5d20 3d20 4e6f  duleType]]] = No
+0003b4c0: 6e65 2c0a 2020 2020 7265 706c 6163 653a  ne,.    replace:
+0003b4d0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+0003b4e0: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
+0003b4f0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0003b500: 2020 2020 7365 7373 696f 6e3a 204f 7074      session: Opt
+0003b510: 696f 6e61 6c5b 2273 6e6f 7766 6c61 6b65  ional["snowflake
+0003b520: 2e73 6e6f 7770 6172 6b2e 7365 7373 696f  .snowpark.sessio
+0003b530: 6e2e 5365 7373 696f 6e22 5d20 3d20 4e6f  n.Session"] = No
+0003b540: 6e65 2c0a 2020 2020 7061 7261 6c6c 656c  ne,.    parallel
+0003b550: 3a20 696e 7420 3d20 342c 0a20 2020 206d  : int = 4,.    m
+0003b560: 6178 5f62 6174 6368 5f73 697a 653a 204f  ax_batch_size: O
+0003b570: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+0003b580: 6f6e 652c 0a20 2020 2073 7461 7465 6d65  one,.    stateme
+0003b590: 6e74 5f70 6172 616d 733a 204f 7074 696f  nt_params: Optio
+0003b5a0: 6e61 6c5b 4469 6374 5b73 7472 2c20 7374  nal[Dict[str, st
+0003b5b0: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+0003b5c0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
+0003b5d0: 6c61 793a 2062 6f6f 6c20 3d20 5472 7565  lay: bool = True
+0003b5e0: 2c0a 2920 2d3e 2055 6e69 6f6e 5b55 7365  ,.) -> Union[Use
+0003b5f0: 7244 6566 696e 6564 4675 6e63 7469 6f6e  rDefinedFunction
+0003b600: 2c20 6675 6e63 746f 6f6c 732e 7061 7274  , functools.part
+0003b610: 6961 6c5d 3a0a 2020 2020 2222 220a 2020  ial]:.    """.  
+0003b620: 2020 5265 6769 7374 6572 7320 6120 5079    Registers a Py
+0003b630: 7468 6f6e 2066 756e 6374 696f 6e20 6173  thon function as
+0003b640: 2061 2076 6563 746f 7269 7a65 6420 5544   a vectorized UD
+0003b650: 4620 616e 6420 7265 7475 726e 7320 7468  F and returns th
+0003b660: 6520 5544 462e 0a20 2020 2054 6865 2061  e UDF..    The a
+0003b670: 7267 756d 656e 7473 2c20 7265 7475 726e  rguments, return
+0003b680: 2076 616c 7565 2061 6e64 2075 7361 6765   value and usage
+0003b690: 206f 6620 7468 6973 2066 756e 6374 696f   of this functio
+0003b6a0: 6e20 6172 6520 6578 6163 746c 7920 7468  n are exactly th
+0003b6b0: 6520 7361 6d65 2061 730a 2020 2020 3a66  e same as.    :f
+0003b6c0: 756e 633a 6075 6466 602c 2062 7574 2074  unc:`udf`, but t
+0003b6d0: 6869 7320 6675 6e63 7469 6f6e 2063 616e  his function can
+0003b6e0: 206f 6e6c 7920 6265 2075 7365 6420 666f   only be used fo
+0003b6f0: 7220 7265 6769 7374 6572 696e 6720 7665  r registering ve
+0003b700: 6374 6f72 697a 6564 2055 4446 732e 0a20  ctorized UDFs.. 
+0003b710: 2020 2053 6565 2065 7861 6d70 6c65 7320     See examples 
+0003b720: 696e 203a 636c 6173 733a 607e 736e 6f77  in :class:`~snow
+0003b730: 666c 616b 652e 736e 6f77 7061 726b 2e75  flake.snowpark.u
+0003b740: 6466 2e55 4446 5265 6769 7374 7261 7469  df.UDFRegistrati
+0003b750: 6f6e 602e 0a0a 2020 2020 5365 6520 416c  on`...    See Al
+0003b760: 736f 3a0a 2020 2020 2020 2020 2d20 3a66  so:.        - :f
+0003b770: 756e 633a 6075 6466 600a 2020 2020 2020  unc:`udf`.      
+0003b780: 2020 2d20 3a6d 6574 683a 6055 4446 5265    - :meth:`UDFRe
+0003b790: 6769 7374 7261 7469 6f6e 2e72 6567 6973  gistration.regis
+0003b7a0: 7465 7228 2920 3c73 6e6f 7766 6c61 6b65  ter() <snowflake
+0003b7b0: 2e73 6e6f 7770 6172 6b2e 7564 662e 5544  .snowpark.udf.UD
+0003b7c0: 4652 6567 6973 7472 6174 696f 6e2e 7265  FRegistration.re
+0003b7d0: 6769 7374 6572 3e60 0a0a 2020 2020 4578  gister>`..    Ex
+0003b7e0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0003b7f0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0003b800: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0003b810: 6573 2069 6d70 6f72 7420 5061 6e64 6173  es import Pandas
+0003b820: 5365 7269 6573 5479 7065 2c20 5061 6e64  SeriesType, Pand
+0003b830: 6173 4461 7461 4672 616d 6554 7970 652c  asDataFrameType,
+0003b840: 2049 6e74 6567 6572 5479 7065 0a20 2020   IntegerType.   
+0003b850: 2020 2020 203e 3e3e 2061 6464 5f6f 6e65       >>> add_one
+0003b860: 5f64 665f 7061 6e64 6173 5f75 6466 203d  _df_pandas_udf =
+0003b870: 2070 616e 6461 735f 7564 6628 0a20 2020   pandas_udf(.   
+0003b880: 2020 2020 202e 2e2e 2020 2020 206c 616d       ...     lam
+0003b890: 6264 6120 6466 3a20 6466 5b30 5d20 2b20  bda df: df[0] + 
+0003b8a0: 6466 5b31 5d20 2b20 312c 0a20 2020 2020  df[1] + 1,.     
+0003b8b0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+0003b8c0: 6e5f 7479 7065 3d50 616e 6461 7353 6572  n_type=PandasSer
+0003b8d0: 6965 7354 7970 6528 496e 7465 6765 7254  iesType(IntegerT
+0003b8e0: 7970 6528 2929 2c0a 2020 2020 2020 2020  ype()),.        
+0003b8f0: 2e2e 2e20 2020 2020 696e 7075 745f 7479  ...     input_ty
+0003b900: 7065 733d 5b50 616e 6461 7344 6174 6146  pes=[PandasDataF
+0003b910: 7261 6d65 5479 7065 285b 496e 7465 6765  rameType([Intege
+0003b920: 7254 7970 6528 292c 2049 6e74 6567 6572  rType(), Integer
+0003b930: 5479 7065 2829 5d29 5d0a 2020 2020 2020  Type()])].      
+0003b940: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+0003b950: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0003b960: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0003b970: 6528 5b5b 312c 2032 5d2c 205b 332c 2034  e([[1, 2], [3, 4
+0003b980: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
+0003b990: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
+0003b9a0: 3e3e 2064 662e 7365 6c65 6374 2861 6464  >> df.select(add
+0003b9b0: 5f6f 6e65 5f64 665f 7061 6e64 6173 5f75  _one_df_pandas_u
+0003b9c0: 6466 2822 6122 2c20 2262 2229 2e61 6c69  df("a", "b").ali
+0003b9d0: 6173 2822 7265 7375 6c74 2229 292e 6f72  as("result")).or
+0003b9e0: 6465 725f 6279 2822 7265 7375 6c74 2229  der_by("result")
+0003b9f0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0003ba00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0003ba10: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+0003ba20: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0003ba30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0003ba40: 3420 2020 2020 2020 2020 7c0a 2020 2020  4         |.    
+0003ba50: 2020 2020 7c38 2020 2020 2020 2020 207c      |8         |
+0003ba60: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003ba70: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0003ba80: 4c41 4e4b 4c49 4e45 3e0a 0a20 2020 206f  LANKLINE>..    o
+0003ba90: 7220 6173 206e 616d 6564 2050 616e 6461  r as named Panda
+0003baa0: 7320 5544 4673 2074 6861 7420 6172 6520  s UDFs that are 
+0003bab0: 6163 6365 7369 626c 6520 696e 2074 6865  accesible in the
+0003bac0: 2073 616d 6520 7365 7373 696f 6e2e 2049   same session. I
+0003bad0: 6e73 7465 6164 206f 6620 6361 6c6c 696e  nstead of callin
+0003bae0: 6720 6070 616e 6461 735f 7564 6660 2061  g `pandas_udf` a
+0003baf0: 7320 6675 6e63 7469 6f6e 2c0a 2020 2020  s function,.    
+0003bb00: 6974 2063 616e 2062 6520 616c 736f 2075  it can be also u
+0003bb10: 7365 6420 6173 2061 2064 6563 6f72 6174  sed as a decorat
+0003bb20: 6f72 3a0a 0a20 2020 2045 7861 6d70 6c65  or:..    Example
+0003bb30: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0003bb40: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0003bb50: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+0003bb60: 706f 7274 2050 616e 6461 7353 6572 6965  port PandasSerie
+0003bb70: 7354 7970 652c 2050 616e 6461 7344 6174  sType, PandasDat
+0003bb80: 6146 7261 6d65 5479 7065 2c20 496e 7465  aFrameType, Inte
+0003bb90: 6765 7254 7970 650a 2020 2020 2020 2020  gerType.        
+0003bba0: 3e3e 3e20 4070 616e 6461 735f 7564 6628  >>> @pandas_udf(
+0003bbb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003bbc0: 2072 6574 7572 6e5f 7479 7065 3d50 616e   return_type=Pan
+0003bbd0: 6461 7353 6572 6965 7354 7970 6528 496e  dasSeriesType(In
+0003bbe0: 7465 6765 7254 7970 6528 2929 2c0a 2020  tegerType()),.  
+0003bbf0: 2020 2020 2020 2e2e 2e20 2020 2020 696e        ...     in
+0003bc00: 7075 745f 7479 7065 733d 5b50 616e 6461  put_types=[Panda
+0003bc10: 7344 6174 6146 7261 6d65 5479 7065 285b  sDataFrameType([
+0003bc20: 496e 7465 6765 7254 7970 6528 292c 2049  IntegerType(), I
+0003bc30: 6e74 6567 6572 5479 7065 2829 5d29 5d2c  ntegerType()])],
+0003bc40: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+0003bc50: 2020 2020 2020 202e 2e2e 2064 6566 2061         ... def a
+0003bc60: 6464 5f6f 6e65 5f64 665f 7061 6e64 6173  dd_one_df_pandas
+0003bc70: 5f75 6466 2864 6629 3a0a 2020 2020 2020  _udf(df):.      
+0003bc80: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+0003bc90: 2064 665b 305d 202b 2064 665b 315d 202b   df[0] + df[1] +
+0003bca0: 2031 0a20 2020 2020 2020 203e 3e3e 2064   1.        >>> d
+0003bcb0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0003bcc0: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+0003bcd0: 2c20 325d 2c20 5b33 2c20 345d 5d2c 2073  , 2], [3, 4]], s
+0003bce0: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
+0003bcf0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0003bd00: 2e73 656c 6563 7428 6164 645f 6f6e 655f  .select(add_one_
+0003bd10: 6466 5f70 616e 6461 735f 7564 6628 2261  df_pandas_udf("a
+0003bd20: 222c 2022 6222 292e 616c 6961 7328 2272  ", "b").alias("r
+0003bd30: 6573 756c 7422 2929 2e6f 7264 6572 5f62  esult")).order_b
+0003bd40: 7928 2272 6573 756c 7422 292e 7368 6f77  y("result").show
+0003bd50: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0003bd60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0003bd70: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
+0003bd80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0003bd90: 2d0a 2020 2020 2020 2020 7c34 2020 2020  -.        |4    
+0003bda0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0003bdb0: 3820 2020 2020 2020 2020 7c0a 2020 2020  8         |.    
+0003bdc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0003bdd0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0003bde0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0003bdf0: 2073 6573 7369 6f6e 203d 2073 6573 7369   session = sessi
+0003be00: 6f6e 206f 7220 736e 6f77 666c 616b 652e  on or snowflake.
+0003be10: 736e 6f77 7061 726b 2e73 6573 7369 6f6e  snowpark.session
+0003be20: 2e5f 6765 745f 6163 7469 7665 5f73 6573  ._get_active_ses
+0003be30: 7369 6f6e 2829 0a20 2020 2069 6620 6675  sion().    if fu
+0003be40: 6e63 2069 7320 4e6f 6e65 3a0a 2020 2020  nc is None:.    
+0003be50: 2020 2020 7265 7475 726e 2066 756e 6374      return funct
+0003be60: 6f6f 6c73 2e70 6172 7469 616c 280a 2020  ools.partial(.  
+0003be70: 2020 2020 2020 2020 2020 7365 7373 696f            sessio
+0003be80: 6e2e 7564 662e 7265 6769 7374 6572 2c0a  n.udf.register,.
+0003be90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0003bea0: 726e 5f74 7970 653d 7265 7475 726e 5f74  rn_type=return_t
+0003beb0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0003bec0: 2069 6e70 7574 5f74 7970 6573 3d69 6e70   input_types=inp
+0003bed0: 7574 5f74 7970 6573 2c0a 2020 2020 2020  ut_types,.      
+0003bee0: 2020 2020 2020 6e61 6d65 3d6e 616d 652c        name=name,
+0003bef0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+0003bf00: 7065 726d 616e 656e 743d 6973 5f70 6572  permanent=is_per
+0003bf10: 6d61 6e65 6e74 2c0a 2020 2020 2020 2020  manent,.        
+0003bf20: 2020 2020 7374 6167 655f 6c6f 6361 7469      stage_locati
+0003bf30: 6f6e 3d73 7461 6765 5f6c 6f63 6174 696f  on=stage_locatio
+0003bf40: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
+0003bf50: 6d70 6f72 7473 3d69 6d70 6f72 7473 2c0a  mports=imports,.
+0003bf60: 2020 2020 2020 2020 2020 2020 7061 636b              pack
+0003bf70: 6167 6573 3d70 6163 6b61 6765 732c 0a20  ages=packages,. 
+0003bf80: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
+0003bf90: 6365 3d72 6570 6c61 6365 2c0a 2020 2020  ce=replace,.    
+0003bfa0: 2020 2020 2020 2020 6966 5f6e 6f74 5f65          if_not_e
+0003bfb0: 7869 7374 733d 6966 5f6e 6f74 5f65 7869  xists=if_not_exi
+0003bfc0: 7374 732c 0a20 2020 2020 2020 2020 2020  sts,.           
+0003bfd0: 2070 6172 616c 6c65 6c3d 7061 7261 6c6c   parallel=parall
+0003bfe0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+0003bff0: 6d61 785f 6261 7463 685f 7369 7a65 3d6d  max_batch_size=m
+0003c000: 6178 5f62 6174 6368 5f73 697a 652c 0a20  ax_batch_size,. 
+0003c010: 2020 2020 2020 2020 2020 205f 6672 6f6d             _from
+0003c020: 5f70 616e 6461 735f 7564 665f 6675 6e63  _pandas_udf_func
+0003c030: 7469 6f6e 3d54 7275 652c 0a20 2020 2020  tion=True,.     
+0003c040: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
+0003c050: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
+0003c060: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
+0003c070: 2020 2020 2020 736f 7572 6365 5f63 6f64        source_cod
+0003c080: 655f 6469 7370 6c61 793d 736f 7572 6365  e_display=source
+0003c090: 5f63 6f64 655f 6469 7370 6c61 792c 0a20  _code_display,. 
+0003c0a0: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
+0003c0b0: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
+0003c0c0: 6e20 7365 7373 696f 6e2e 7564 662e 7265  n session.udf.re
+0003c0d0: 6769 7374 6572 280a 2020 2020 2020 2020  gister(.        
+0003c0e0: 2020 2020 6675 6e63 2c0a 2020 2020 2020      func,.      
+0003c0f0: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
+0003c100: 653d 7265 7475 726e 5f74 7970 652c 0a20  e=return_type,. 
+0003c110: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0003c120: 5f74 7970 6573 3d69 6e70 7574 5f74 7970  _types=input_typ
+0003c130: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0003c140: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
+0003c150: 2020 2020 2020 2069 735f 7065 726d 616e         is_perman
+0003c160: 656e 743d 6973 5f70 6572 6d61 6e65 6e74  ent=is_permanent
+0003c170: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+0003c180: 6167 655f 6c6f 6361 7469 6f6e 3d73 7461  age_location=sta
+0003c190: 6765 5f6c 6f63 6174 696f 6e2c 0a20 2020  ge_location,.   
+0003c1a0: 2020 2020 2020 2020 2069 6d70 6f72 7473           imports
+0003c1b0: 3d69 6d70 6f72 7473 2c0a 2020 2020 2020  =imports,.      
+0003c1c0: 2020 2020 2020 7061 636b 6167 6573 3d70        packages=p
+0003c1d0: 6163 6b61 6765 732c 0a20 2020 2020 2020  ackages,.       
+0003c1e0: 2020 2020 2072 6570 6c61 6365 3d72 6570       replace=rep
+0003c1f0: 6c61 6365 2c0a 2020 2020 2020 2020 2020  lace,.          
+0003c200: 2020 6966 5f6e 6f74 5f65 7869 7374 733d    if_not_exists=
+0003c210: 6966 5f6e 6f74 5f65 7869 7374 732c 0a20  if_not_exists,. 
+0003c220: 2020 2020 2020 2020 2020 2070 6172 616c             paral
+0003c230: 6c65 6c3d 7061 7261 6c6c 656c 2c0a 2020  lel=parallel,.  
+0003c240: 2020 2020 2020 2020 2020 6d61 785f 6261            max_ba
+0003c250: 7463 685f 7369 7a65 3d6d 6178 5f62 6174  tch_size=max_bat
+0003c260: 6368 5f73 697a 652c 0a20 2020 2020 2020  ch_size,.       
+0003c270: 2020 2020 205f 6672 6f6d 5f70 616e 6461       _from_panda
+0003c280: 735f 7564 665f 6675 6e63 7469 6f6e 3d54  s_udf_function=T
+0003c290: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0003c2a0: 2073 7461 7465 6d65 6e74 5f70 6172 616d   statement_param
+0003c2b0: 733d 7374 6174 656d 656e 745f 7061 7261  s=statement_para
+0003c2c0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+0003c2d0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
+0003c2e0: 6c61 793d 736f 7572 6365 5f63 6f64 655f  lay=source_code_
+0003c2f0: 6469 7370 6c61 792c 0a20 2020 2020 2020  display,.       
+0003c300: 2029 0a0a 0a64 6566 2063 616c 6c5f 7564   )...def call_ud
+0003c310: 6628 0a20 2020 2075 6466 5f6e 616d 653a  f(.    udf_name:
+0003c320: 2073 7472 2c0a 2020 2020 2a61 7267 733a   str,.    *args:
+0003c330: 2043 6f6c 756d 6e4f 724c 6974 6572 616c   ColumnOrLiteral
+0003c340: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
+0003c350: 2020 2022 2222 4361 6c6c 7320 6120 7573     """Calls a us
+0003c360: 6572 2d64 6566 696e 6564 2066 756e 6374  er-defined funct
+0003c370: 696f 6e20 2855 4446 2920 6279 206e 616d  ion (UDF) by nam
+0003c380: 652e 0a0a 2020 2020 4172 6773 3a0a 2020  e...    Args:.  
+0003c390: 2020 2020 2020 7564 665f 6e61 6d65 3a20        udf_name: 
+0003c3a0: 5468 6520 6e61 6d65 206f 6620 5544 4620  The name of UDF 
+0003c3b0: 696e 2053 6e6f 7766 6c61 6b65 2e0a 2020  in Snowflake..  
+0003c3c0: 2020 2020 2020 6172 6773 3a20 4172 6775        args: Argu
+0003c3d0: 6d65 6e74 7320 6361 6e20 6265 2069 6e20  ments can be in 
+0003c3e0: 7477 6f20 7479 7065 733a 0a0a 2020 2020  two types:..    
+0003c3f0: 2020 2020 2020 2020 2d20 3a63 6c61 7373          - :class
+0003c400: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+0003c410: 7770 6172 6b2e 436f 6c75 6d6e 602c 206f  wpark.Column`, o
+0003c420: 720a 2020 2020 2020 2020 2020 2020 2d20  r.            - 
+0003c430: 4261 7369 6320 5079 7468 6f6e 2074 7970  Basic Python typ
+0003c440: 6573 2c20 7768 6963 6820 6172 6520 636f  es, which are co
+0003c450: 6e76 6572 7465 6420 746f 2053 6e6f 7770  nverted to Snowp
+0003c460: 6172 6b20 6c69 7465 7261 6c73 2e0a 0a20  ark literals... 
+0003c470: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+0003c480: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0003c490: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003c4a0: 2e74 7970 6573 2069 6d70 6f72 7420 496e  .types import In
+0003c4b0: 7465 6765 7254 7970 650a 2020 2020 2020  tegerType.      
+0003c4c0: 2020 3e3e 3e20 7564 665f 6465 6620 3d20    >>> udf_def = 
+0003c4d0: 7365 7373 696f 6e2e 7564 662e 7265 6769  session.udf.regi
+0003c4e0: 7374 6572 286c 616d 6264 6120 782c 2079  ster(lambda x, y
+0003c4f0: 3a20 7820 2b20 792c 206e 616d 653d 2261  : x + y, name="a
+0003c500: 6464 5f63 6f6c 756d 6e73 222c 2069 6e70  dd_columns", inp
+0003c510: 7574 5f74 7970 6573 3d5b 496e 7465 6765  ut_types=[Intege
+0003c520: 7254 7970 6528 292c 2049 6e74 6567 6572  rType(), Integer
+0003c530: 5479 7065 2829 5d2c 2072 6574 7572 6e5f  Type()], return_
+0003c540: 7479 7065 3d49 6e74 6567 6572 5479 7065  type=IntegerType
+0003c550: 2829 2c20 7265 706c 6163 653d 5472 7565  (), replace=True
+0003c560: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0003c570: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0003c580: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
+0003c590: 2032 5d5d 2c20 7363 6865 6d61 3d5b 2261   2]], schema=["a
+0003c5a0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+0003c5b0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
+0003c5c0: 616c 6c5f 7564 6628 2261 6464 5f63 6f6c  all_udf("add_col
+0003c5d0: 756d 6e73 222c 2063 6f6c 2822 6122 292c  umns", col("a"),
+0003c5e0: 2063 6f6c 2822 6222 2929 292e 7368 6f77   col("b"))).show
+0003c5f0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0003c600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003c610: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0003c620: 2020 207c 2241 4444 5f43 4f4c 554d 4e53     |"ADD_COLUMNS
+0003c630: 2822 2241 2222 2c20 2222 4222 2229 2220  (""A"", ""B"")" 
+0003c640: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0003c650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003c660: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0003c670: 2020 207c 3320 2020 2020 2020 2020 2020     |3           
+0003c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c690: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0003c6a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003c6b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0003c6c0: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+0003c6d0: 2020 2022 2222 0a0a 2020 2020 7661 6c69     """..    vali
+0003c6e0: 6461 7465 5f6f 626a 6563 745f 6e61 6d65  date_object_name
+0003c6f0: 2875 6466 5f6e 616d 6529 0a20 2020 2072  (udf_name).    r
+0003c700: 6574 7572 6e20 5f63 616c 6c5f 6675 6e63  eturn _call_func
+0003c710: 7469 6f6e 2875 6466 5f6e 616d 652c 2046  tion(udf_name, F
+0003c720: 616c 7365 2c20 2a61 7267 732c 2061 7069  alse, *args, api
+0003c730: 5f63 616c 6c5f 736f 7572 6365 3d22 6675  _call_source="fu
+0003c740: 6e63 7469 6f6e 732e 6361 6c6c 5f75 6466  nctions.call_udf
+0003c750: 2229 0a0a 0a64 6566 2063 616c 6c5f 7461  ")...def call_ta
+0003c760: 626c 655f 6675 6e63 7469 6f6e 280a 2020  ble_function(.  
+0003c770: 2020 6675 6e63 7469 6f6e 5f6e 616d 653a    function_name:
+0003c780: 2073 7472 2c20 2a61 7267 733a 2043 6f6c   str, *args: Col
+0003c790: 756d 6e4f 724c 6974 6572 616c 2c20 2a2a  umnOrLiteral, **
+0003c7a0: 6b77 6172 6773 3a20 436f 6c75 6d6e 4f72  kwargs: ColumnOr
+0003c7b0: 4c69 7465 7261 6c0a 2920 2d3e 2022 736e  Literal.) -> "sn
+0003c7c0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003c7d0: 2e74 6162 6c65 5f66 756e 6374 696f 6e2e  .table_function.
+0003c7e0: 5461 626c 6546 756e 6374 696f 6e43 616c  TableFunctionCal
+0003c7f0: 6c22 3a0a 2020 2020 2222 2249 6e76 6f6b  l":.    """Invok
+0003c800: 6573 2061 2053 6e6f 7766 6c61 6b65 2074  es a Snowflake t
+0003c810: 6162 6c65 2066 756e 6374 696f 6e2c 2069  able function, i
+0003c820: 6e63 6c75 6469 6e67 2073 7973 7465 6d2d  ncluding system-
+0003c830: 6465 6669 6e65 6420 7461 626c 6520 6675  defined table fu
+0003c840: 6e63 7469 6f6e 7320 616e 6420 7573 6572  nctions and user
+0003c850: 2d64 6566 696e 6564 2074 6162 6c65 2066  -defined table f
+0003c860: 756e 6374 696f 6e73 2e0a 0a20 2020 2049  unctions...    I
+0003c870: 7420 7265 7475 726e 7320 6120 3a6d 6574  t returns a :met
+0003c880: 683a 607e 736e 6f77 666c 616b 652e 736e  h:`~snowflake.sn
+0003c890: 6f77 7061 726b 2e74 6162 6c65 5f66 756e  owpark.table_fun
+0003c8a0: 6374 696f 6e2e 5461 626c 6546 756e 6374  ction.TableFunct
+0003c8b0: 696f 6e43 616c 6c60 2073 6f20 796f 7520  ionCall` so you 
+0003c8c0: 6361 6e20 7370 6563 6966 7920 7468 6520  can specify the 
+0003c8d0: 7061 7274 6974 696f 6e20 636c 6175 7365  partition clause
+0003c8e0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+0003c8f0: 2020 2020 2066 756e 6374 696f 6e5f 6e61       function_na
+0003c900: 6d65 3a20 5468 6520 6e61 6d65 206f 6620  me: The name of 
+0003c910: 7468 6520 7461 626c 6520 6675 6e63 7469  the table functi
+0003c920: 6f6e 2e0a 2020 2020 2020 2020 6172 6773  on..        args
+0003c930: 3a20 5468 6520 706f 7369 7469 6f6e 616c  : The positional
+0003c940: 2061 7267 756d 656e 7473 206f 6620 7468   arguments of th
+0003c950: 6520 7461 626c 6520 6675 6e63 7469 6f6e  e table function
+0003c960: 2e0a 2020 2020 2020 2020 2a2a 6b77 6172  ..        **kwar
+0003c970: 6773 3a20 5468 6520 6e61 6d65 6420 6172  gs: The named ar
+0003c980: 6775 6d65 6e74 7320 6f66 2074 6865 2074  guments of the t
+0003c990: 6162 6c65 2066 756e 6374 696f 6e2e 2053  able function. S
+0003c9a0: 6f6d 6520 7461 626c 6520 6675 6e63 7469  ome table functi
+0003c9b0: 6f6e 7320 2865 2e67 2e2c 2060 6066 6c61  ons (e.g., ``fla
+0003c9c0: 7474 656e 6060 2920 6861 7665 206e 616d  tten``) have nam
+0003c9d0: 6564 2061 7267 756d 656e 7473 2069 6e73  ed arguments ins
+0003c9e0: 7465 6164 206f 6620 706f 7369 7469 6f6e  tead of position
+0003c9f0: 616c 206f 6e65 732e 0a0a 2020 2020 4578  al ones...    Ex
+0003ca00: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0003ca10: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0003ca20: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+0003ca30: 7469 6f6e 7320 696d 706f 7274 206c 6974  tions import lit
+0003ca40: 0a20 2020 2020 2020 203e 3e3e 2073 6573  .        >>> ses
+0003ca50: 7369 6f6e 2e74 6162 6c65 5f66 756e 6374  sion.table_funct
+0003ca60: 696f 6e28 6361 6c6c 5f74 6162 6c65 5f66  ion(call_table_f
+0003ca70: 756e 6374 696f 6e28 2273 706c 6974 5f74  unction("split_t
+0003ca80: 6f5f 7461 626c 6522 2c20 6c69 7428 2273  o_table", lit("s
+0003ca90: 706c 6974 2077 6f72 6473 2074 6f20 7461  plit words to ta
+0003caa0: 626c 6522 292c 206c 6974 2822 2022 2929  ble"), lit(" "))
+0003cab0: 2e6f 7665 7228 2929 2e63 6f6c 6c65 6374  .over()).collect
+0003cac0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0003cad0: 5345 513d 312c 2049 4e44 4558 3d31 2c20  SEQ=1, INDEX=1, 
+0003cae0: 5641 4c55 453d 2773 706c 6974 2729 2c20  VALUE='split'), 
+0003caf0: 526f 7728 5345 513d 312c 2049 4e44 4558  Row(SEQ=1, INDEX
+0003cb00: 3d32 2c20 5641 4c55 453d 2777 6f72 6473  =2, VALUE='words
+0003cb10: 2729 2c20 526f 7728 5345 513d 312c 2049  '), Row(SEQ=1, I
+0003cb20: 4e44 4558 3d33 2c20 5641 4c55 453d 2774  NDEX=3, VALUE='t
+0003cb30: 6f27 292c 2052 6f77 2853 4551 3d31 2c20  o'), Row(SEQ=1, 
+0003cb40: 494e 4445 583d 342c 2056 414c 5545 3d27  INDEX=4, VALUE='
+0003cb50: 7461 626c 6527 295d 0a20 2020 2022 2222  table')].    """
+0003cb60: 0a20 2020 2072 6574 7572 6e20 736e 6f77  .    return snow
+0003cb70: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0003cb80: 6162 6c65 5f66 756e 6374 696f 6e2e 5461  able_function.Ta
+0003cb90: 626c 6546 756e 6374 696f 6e43 616c 6c28  bleFunctionCall(
+0003cba0: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
+0003cbb0: 6e5f 6e61 6d65 2c20 2a61 7267 732c 202a  n_name, *args, *
+0003cbc0: 2a6b 7761 7267 730a 2020 2020 290a 0a0a  *kwargs.    )...
+0003cbd0: 6465 6620 7461 626c 655f 6675 6e63 7469  def table_functi
+0003cbe0: 6f6e 2866 756e 6374 696f 6e5f 6e61 6d65  on(function_name
+0003cbf0: 3a20 7374 7229 202d 3e20 4361 6c6c 6162  : str) -> Callab
+0003cc00: 6c65 3a0a 2020 2020 2222 2243 7265 6174  le:.    """Creat
+0003cc10: 6520 6120 6675 6e63 7469 6f6e 206f 626a  e a function obj
+0003cc20: 6563 7420 746f 2069 6e76 6f6b 6520 6120  ect to invoke a 
+0003cc30: 536e 6f77 666c 616b 6520 7461 626c 6520  Snowflake table 
+0003cc40: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2041  function...    A
+0003cc50: 7267 733a 0a20 2020 2020 2020 2066 756e  rgs:.        fun
+0003cc60: 6374 696f 6e5f 6e61 6d65 3a20 5468 6520  ction_name: The 
+0003cc70: 6e61 6d65 206f 6620 7468 6520 7461 626c  name of the tabl
+0003cc80: 6520 6675 6e63 7469 6f6e 2e0a 0a20 2020  e function...   
+0003cc90: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0003cca0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0003ccb0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0003ccc0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0003ccd0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
+0003cce0: 7370 6c69 745f 746f 5f74 6162 6c65 203d  split_to_table =
+0003ccf0: 2074 6162 6c65 5f66 756e 6374 696f 6e28   table_function(
+0003cd00: 2273 706c 6974 5f74 6f5f 7461 626c 6522  "split_to_table"
+0003cd10: 290a 2020 2020 2020 2020 3e3e 3e20 7365  ).        >>> se
+0003cd20: 7373 696f 6e2e 7461 626c 655f 6675 6e63  ssion.table_func
+0003cd30: 7469 6f6e 2873 706c 6974 5f74 6f5f 7461  tion(split_to_ta
+0003cd40: 626c 6528 6c69 7428 2273 706c 6974 2077  ble(lit("split w
+0003cd50: 6f72 6473 2074 6f20 7461 626c 6522 292c  ords to table"),
+0003cd60: 206c 6974 2822 2022 2929 2e6f 7665 7228   lit(" ")).over(
+0003cd70: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0003cd80: 2020 2020 205b 526f 7728 5345 513d 312c       [Row(SEQ=1,
+0003cd90: 2049 4e44 4558 3d31 2c20 5641 4c55 453d   INDEX=1, VALUE=
+0003cda0: 2773 706c 6974 2729 2c20 526f 7728 5345  'split'), Row(SE
+0003cdb0: 513d 312c 2049 4e44 4558 3d32 2c20 5641  Q=1, INDEX=2, VA
+0003cdc0: 4c55 453d 2777 6f72 6473 2729 2c20 526f  LUE='words'), Ro
+0003cdd0: 7728 5345 513d 312c 2049 4e44 4558 3d33  w(SEQ=1, INDEX=3
+0003cde0: 2c20 5641 4c55 453d 2774 6f27 292c 2052  , VALUE='to'), R
+0003cdf0: 6f77 2853 4551 3d31 2c20 494e 4445 583d  ow(SEQ=1, INDEX=
+0003ce00: 342c 2056 414c 5545 3d27 7461 626c 6527  4, VALUE='table'
+0003ce10: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+0003ce20: 6574 7572 6e20 6c61 6d62 6461 202a 6172  eturn lambda *ar
+0003ce30: 6773 2c20 2a2a 6b77 6172 6773 3a20 6361  gs, **kwargs: ca
+0003ce40: 6c6c 5f74 6162 6c65 5f66 756e 6374 696f  ll_table_functio
+0003ce50: 6e28 6675 6e63 7469 6f6e 5f6e 616d 652c  n(function_name,
+0003ce60: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+0003ce70: 290a 0a0a 6465 6620 6361 6c6c 5f66 756e  )...def call_fun
+0003ce80: 6374 696f 6e28 6675 6e63 7469 6f6e 5f6e  ction(function_n
+0003ce90: 616d 653a 2073 7472 2c20 2a61 7267 733a  ame: str, *args:
+0003cea0: 2043 6f6c 756d 6e4f 724c 6974 6572 616c   ColumnOrLiteral
+0003ceb0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0003cec0: 2022 2222 496e 766f 6b65 7320 6120 536e   """Invokes a Sn
+0003ced0: 6f77 666c 616b 6520 6073 7973 7465 6d2d  owflake `system-
+0003cee0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
+0003cef0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+0003cf00: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+0003cf10: 7371 6c2d 7265 6665 7265 6e63 652d 6675  sql-reference-fu
+0003cf20: 6e63 7469 6f6e 732e 6874 6d6c 3e60 5f20  nctions.html>`_ 
+0003cf30: 2862 7569 6c74 2d69 6e20 6675 6e63 7469  (built-in functi
+0003cf40: 6f6e 2920 7769 7468 2074 6865 2073 7065  on) with the spe
+0003cf50: 6369 6669 6564 206e 616d 650a 2020 2020  cified name.    
+0003cf60: 616e 6420 6172 6775 6d65 6e74 732e 0a0a  and arguments...
+0003cf70: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0003cf80: 2020 6675 6e63 7469 6f6e 5f6e 616d 653a    function_name:
+0003cf90: 2054 6865 206e 616d 6520 6f66 2062 7569   The name of bui
+0003cfa0: 6c74 2d69 6e20 6675 6e63 7469 6f6e 2069  lt-in function i
+0003cfb0: 6e20 536e 6f77 666c 616b 650a 2020 2020  n Snowflake.    
+0003cfc0: 2020 2020 6172 6773 3a20 4172 6775 6d65      args: Argume
+0003cfd0: 6e74 7320 6361 6e20 6265 2069 6e20 7477  nts can be in tw
+0003cfe0: 6f20 7479 7065 733a 0a0a 2020 2020 2020  o types:..      
+0003cff0: 2020 2020 2020 2d20 3a63 6c61 7373 3a60        - :class:`
+0003d000: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+0003d010: 6172 6b2e 436f 6c75 6d6e 602c 206f 720a  ark.Column`, or.
+0003d020: 2020 2020 2020 2020 2020 2020 2d20 4261              - Ba
+0003d030: 7369 6320 5079 7468 6f6e 2074 7970 6573  sic Python types
+0003d040: 2c20 7768 6963 6820 6172 6520 636f 6e76  , which are conv
+0003d050: 6572 7465 6420 746f 2053 6e6f 7770 6172  erted to Snowpar
+0003d060: 6b20 6c69 7465 7261 6c73 2e0a 0a20 2020  k literals...   
+0003d070: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0003d080: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0003d090: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0003d0a0: 7261 6d65 285b 312c 2032 2c20 332c 2034  rame([1, 2, 3, 4
+0003d0b0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+0003d0c0: 2020 2320 6120 7369 6e67 6c65 2063 6f6c    # a single col
+0003d0d0: 756d 6e20 7769 7468 2034 2072 6f77 730a  umn with 4 rows.
+0003d0e0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0003d0f0: 656c 6563 7428 6361 6c6c 5f66 756e 6374  elect(call_funct
+0003d100: 696f 6e28 2261 7667 222c 2063 6f6c 2822  ion("avg", col("
+0003d110: 6122 2929 292e 7368 6f77 2829 0a20 2020  a"))).show().   
+0003d120: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0003d130: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0003d140: 4156 4728 2222 4122 2229 2220 207c 0a20  AVG(""A"")"  |. 
+0003d150: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0003d160: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0003d170: 7c32 2e35 3030 3030 3020 2020 2020 207c  |2.500000      |
+0003d180: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003d190: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0003d1a0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20    <BLANKLINE>.. 
+0003d1b0: 2020 2022 2222 0a0a 2020 2020 7265 7475     """..    retu
+0003d1c0: 726e 205f 6361 6c6c 5f66 756e 6374 696f  rn _call_functio
+0003d1d0: 6e28 6675 6e63 7469 6f6e 5f6e 616d 652c  n(function_name,
+0003d1e0: 2046 616c 7365 2c20 2a61 7267 7329 0a0a   False, *args)..
+0003d1f0: 0a64 6566 2066 756e 6374 696f 6e28 6675  .def function(fu
+0003d200: 6e63 7469 6f6e 5f6e 616d 653a 2073 7472  nction_name: str
+0003d210: 2920 2d3e 2043 616c 6c61 626c 653a 0a20  ) -> Callable:. 
+0003d220: 2020 2022 2222 0a20 2020 2046 756e 6374     """.    Funct
+0003d230: 696f 6e20 6f62 6a65 6374 2074 6f20 696e  ion object to in
+0003d240: 766f 6b65 2061 2053 6e6f 7766 6c61 6b65  voke a Snowflake
+0003d250: 2060 7379 7374 656d 2d64 6566 696e 6564   `system-defined
+0003d260: 2066 756e 6374 696f 6e20 3c68 7474 7073   function <https
+0003d270: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
+0003d280: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
+0003d290: 6572 656e 6365 2d66 756e 6374 696f 6e73  erence-functions
+0003d2a0: 2e68 746d 6c3e 605f 2028 6275 696c 742d  .html>`_ (built-
+0003d2b0: 696e 2066 756e 6374 696f 6e29 2e20 5573  in function). Us
+0003d2c0: 6520 7468 6973 2074 6f20 696e 766f 6b65  e this to invoke
+0003d2d0: 0a20 2020 2061 6e79 2062 7569 6c74 2d69  .    any built-i
+0003d2e0: 6e20 6675 6e63 7469 6f6e 7320 6e6f 7420  n functions not 
+0003d2f0: 6578 706c 6963 6974 6c79 206c 6973 7465  explicitly liste
+0003d300: 6420 696e 2074 6869 7320 6f62 6a65 6374  d in this object
+0003d310: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+0003d320: 2020 2020 2066 756e 6374 696f 6e5f 6e61       function_na
+0003d330: 6d65 3a20 5468 6520 6e61 6d65 206f 6620  me: The name of 
+0003d340: 6275 696c 742d 696e 2066 756e 6374 696f  built-in functio
+0003d350: 6e20 696e 2053 6e6f 7766 6c61 6b65 2e0a  n in Snowflake..
+0003d360: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+0003d370: 2020 2020 2020 4120 3a63 6c61 7373 3a60        A :class:`
+0003d380: 4361 6c6c 6162 6c65 6020 6f62 6a65 6374  Callable` object
+0003d390: 2066 6f72 2063 616c 6c69 6e67 2061 2053   for calling a S
+0003d3a0: 6e6f 7766 6c61 6b65 2073 7973 7465 6d2d  nowflake system-
+0003d3b0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
+0003d3c0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0003d3d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0003d3e0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0003d3f0: 5f64 6174 6166 7261 6d65 285b 312c 2032  _dataframe([1, 2
+0003d400: 2c20 332c 2034 5d2c 2073 6368 656d 613d  , 3, 4], schema=
+0003d410: 5b22 6122 5d29 2020 2320 6120 7369 6e67  ["a"])  # a sing
+0003d420: 6c65 2063 6f6c 756d 6e20 7769 7468 2034  le column with 4
+0003d430: 2072 6f77 730a 2020 2020 2020 2020 3e3e   rows.        >>
+0003d440: 3e20 6466 2e73 656c 6563 7428 6361 6c6c  > df.select(call
+0003d450: 5f66 756e 6374 696f 6e28 2261 7667 222c  _function("avg",
+0003d460: 2063 6f6c 2822 6122 2929 292e 7368 6f77   col("a"))).show
+0003d470: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0003d480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0003d490: 2020 2020 7c22 4156 4728 2222 4122 2229      |"AVG(""A"")
+0003d4a0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0003d4b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0003d4c0: 2020 2020 2020 7c32 2e35 3030 3030 3020        |2.500000 
+0003d4d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0003d4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0003d4f0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0003d500: 4e45 3e0a 2020 2020 2020 2020 3e3e 3e20  NE>.        >>> 
+0003d510: 6d79 5f61 7667 203d 2066 756e 6374 696f  my_avg = functio
+0003d520: 6e28 2761 7667 2729 0a20 2020 2020 2020  n('avg').       
+0003d530: 203e 3e3e 2064 662e 7365 6c65 6374 286d   >>> df.select(m
+0003d540: 795f 6176 6728 636f 6c28 2261 2229 2929  y_avg(col("a")))
+0003d550: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0003d560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003d570: 0a20 2020 2020 2020 207c 2241 5647 2822  .        |"AVG("
+0003d580: 2241 2222 2922 2020 7c0a 2020 2020 2020  "A"")"  |.      
+0003d590: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0003d5a0: 2d2d 0a20 2020 2020 2020 207c 322e 3530  --.        |2.50
+0003d5b0: 3030 3030 2020 2020 2020 7c0a 2020 2020  0000      |.    
+0003d5c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0003d5d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0003d5e0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0003d5f0: 0a20 2020 2072 6574 7572 6e20 6c61 6d62  .    return lamb
+0003d600: 6461 202a 6172 6773 3a20 6361 6c6c 5f66  da *args: call_f
+0003d610: 756e 6374 696f 6e28 6675 6e63 7469 6f6e  unction(function
+0003d620: 5f6e 616d 652c 202a 6172 6773 290a 0a0a  _name, *args)...
+0003d630: 6465 6620 5f63 616c 6c5f 6675 6e63 7469  def _call_functi
+0003d640: 6f6e 280a 2020 2020 6e61 6d65 3a20 7374  on(.    name: st
+0003d650: 722c 0a20 2020 2069 735f 6469 7374 696e  r,.    is_distin
+0003d660: 6374 3a20 626f 6f6c 203d 2046 616c 7365  ct: bool = False
+0003d670: 2c0a 2020 2020 2a61 7267 733a 2043 6f6c  ,.    *args: Col
+0003d680: 756d 6e4f 724c 6974 6572 616c 2c0a 2020  umnOrLiteral,.  
+0003d690: 2020 6170 695f 6361 6c6c 5f73 6f75 7263    api_call_sourc
+0003d6a0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+0003d6b0: 203d 204e 6f6e 652c 0a29 202d 3e20 436f   = None,.) -> Co
+0003d6c0: 6c75 6d6e 3a0a 2020 2020 6578 7072 6573  lumn:.    expres
+0003d6d0: 7369 6f6e 7320 3d20 5b43 6f6c 756d 6e2e  sions = [Column.
+0003d6e0: 5f74 6f5f 6578 7072 2861 7267 2920 666f  _to_expr(arg) fo
+0003d6f0: 7220 6172 6720 696e 2070 6172 7365 5f70  r arg in parse_p
+0003d700: 6f73 6974 696f 6e61 6c5f 6172 6773 5f74  ositional_args_t
+0003d710: 6f5f 6c69 7374 282a 6172 6773 295d 0a20  o_list(*args)]. 
+0003d720: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
+0003d730: 280a 2020 2020 2020 2020 4675 6e63 7469  (.        Functi
+0003d740: 6f6e 4578 7072 6573 7369 6f6e 280a 2020  onExpression(.  
+0003d750: 2020 2020 2020 2020 2020 6e61 6d65 2c20            name, 
+0003d760: 6578 7072 6573 7369 6f6e 732c 2069 735f  expressions, is_
+0003d770: 6469 7374 696e 6374 3d69 735f 6469 7374  distinct=is_dist
+0003d780: 696e 6374 2c20 6170 695f 6361 6c6c 5f73  inct, api_call_s
+0003d790: 6f75 7263 653d 6170 695f 6361 6c6c 5f73  ource=api_call_s
+0003d7a0: 6f75 7263 650a 2020 2020 2020 2020 290a  ource.        ).
+0003d7b0: 2020 2020 290a 0a0a 6465 6620 7370 726f      )...def spro
+0003d7c0: 6328 0a20 2020 2066 756e 633a 204f 7074  c(.    func: Opt
+0003d7d0: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
+0003d7e0: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
+0003d7f0: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
+0003d800: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
+0003d810: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
+0003d820: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
+0003d830: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
+0003d840: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
+0003d850: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
+0003d860: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
+0003d870: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
+0003d880: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
+0003d890: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
+0003d8a0: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
+0003d8b0: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
+0003d8c0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0003d8d0: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
+0003d8e0: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
+0003d8f0: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
+0003d900: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
+0003d910: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
+0003d920: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
+0003d930: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
+0003d940: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
+0003d950: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
+0003d960: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
+0003d970: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
+0003d980: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
+0003d990: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
+0003d9a0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003d9b0: 2e53 6573 7369 6f6e 225d 203d 204e 6f6e  .Session"] = Non
+0003d9c0: 652c 0a20 2020 2070 6172 616c 6c65 6c3a  e,.    parallel:
+0003d9d0: 2069 6e74 203d 2034 2c0a 2020 2020 7374   int = 4,.    st
+0003d9e0: 6174 656d 656e 745f 7061 7261 6d73 3a20  atement_params: 
+0003d9f0: 4f70 7469 6f6e 616c 5b44 6963 745b 7374  Optional[Dict[st
+0003da00: 722c 2073 7472 5d5d 203d 204e 6f6e 652c  r, str]] = None,
+0003da10: 0a20 2020 2065 7865 6375 7465 5f61 733a  .    execute_as:
+0003da20: 2074 7970 696e 672e 4c69 7465 7261 6c5b   typing.Literal[
+0003da30: 2263 616c 6c65 7222 2c20 226f 776e 6572  "caller", "owner
+0003da40: 225d 203d 2022 6f77 6e65 7222 2c0a 2020  "] = "owner",.  
+0003da50: 2020 7374 7269 6374 3a20 626f 6f6c 203d    strict: bool =
+0003da60: 2046 616c 7365 2c0a 2020 2020 736f 7572   False,.    sour
+0003da70: 6365 5f63 6f64 655f 6469 7370 6c61 793a  ce_code_display:
+0003da80: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+0003da90: 2020 2a2a 6b77 6172 6773 2c0a 2920 2d3e    **kwargs,.) ->
+0003daa0: 2055 6e69 6f6e 5b53 746f 7265 6450 726f   Union[StoredPro
+0003dab0: 6365 6475 7265 2c20 6675 6e63 746f 6f6c  cedure, functool
+0003dac0: 732e 7061 7274 6961 6c5d 3a0a 2020 2020  s.partial]:.    
+0003dad0: 2222 2252 6567 6973 7465 7273 2061 2050  """Registers a P
+0003dae0: 7974 686f 6e20 6675 6e63 7469 6f6e 2061  ython function a
+0003daf0: 7320 6120 536e 6f77 666c 616b 6520 5079  s a Snowflake Py
+0003db00: 7468 6f6e 2073 746f 7265 6420 7072 6f63  thon stored proc
+0003db10: 6564 7572 6520 616e 6420 7265 7475 726e  edure and return
+0003db20: 7320 7468 6520 7374 6f72 6564 2070 726f  s the stored pro
+0003db30: 6365 6475 7265 2e0a 0a20 2020 2049 7420  cedure...    It 
+0003db40: 6361 6e20 6265 2075 7365 6420 6173 2065  can be used as e
+0003db50: 6974 6865 7220 6120 6675 6e63 7469 6f6e  ither a function
+0003db60: 2063 616c 6c20 6f72 2061 2064 6563 6f72   call or a decor
+0003db70: 6174 6f72 2e20 496e 206d 6f73 7420 6361  ator. In most ca
+0003db80: 7365 7320 796f 7520 776f 726b 2077 6974  ses you work wit
+0003db90: 6820 6120 7369 6e67 6c65 2073 6573 7369  h a single sessi
+0003dba0: 6f6e 2e0a 2020 2020 5468 6973 2066 756e  on..    This fun
+0003dbb0: 6374 696f 6e20 7573 6573 2074 6861 7420  ction uses that 
+0003dbc0: 7365 7373 696f 6e20 746f 2072 6567 6973  session to regis
+0003dbd0: 7465 7220 7468 6520 7374 6f72 6564 2070  ter the stored p
+0003dbe0: 726f 6365 6475 7265 2e20 4966 2079 6f75  rocedure. If you
+0003dbf0: 2068 6176 6520 6d75 6c74 6970 6c65 2073   have multiple s
+0003dc00: 6573 7369 6f6e 732c 2079 6f75 206e 6565  essions, you nee
+0003dc10: 6420 746f 0a20 2020 2065 7870 6c69 6369  d to.    explici
+0003dc20: 746c 7920 7370 6563 6966 7920 7468 6520  tly specify the 
+0003dc30: 6060 7365 7373 696f 6e60 6020 7061 7261  ``session`` para
+0003dc40: 6d65 7465 7220 6f66 2074 6869 7320 6675  meter of this fu
+0003dc50: 6e63 7469 6f6e 2e20 4966 2079 6f75 2068  nction. If you h
+0003dc60: 6176 6520 6120 6675 6e63 7469 6f6e 2061  ave a function a
+0003dc70: 6e64 2077 6f75 6c64 0a20 2020 206c 696b  nd would.    lik
+0003dc80: 6520 746f 2072 6567 6973 7465 7220 6974  e to register it
+0003dc90: 2074 6f20 6d75 6c74 6970 6c65 2064 6174   to multiple dat
+0003dca0: 6162 6173 6573 2c20 7573 6520 6060 7365  abases, use ``se
+0003dcb0: 7373 696f 6e2e 7370 726f 632e 7265 6769  ssion.sproc.regi
+0003dcc0: 7374 6572 6060 2069 6e73 7465 6164 2e20  ster`` instead. 
+0003dcd0: 5365 6520 6578 616d 706c 6573 0a20 2020  See examples.   
+0003dce0: 2069 6e20 3a63 6c61 7373 3a60 7e73 6e6f   in :class:`~sno
+0003dcf0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003dd00: 7374 6f72 6564 5f70 726f 6365 6475 7265  stored_procedure
+0003dd10: 2e53 746f 7265 6450 726f 6365 6475 7265  .StoredProcedure
+0003dd20: 5265 6769 7374 7261 7469 6f6e 602e 0a0a  Registration`...
+0003dd30: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+0003dd40: 6520 6669 7273 7420 7061 7261 6d65 7465  e first paramete
+0003dd50: 7220 6f66 2079 6f75 7220 6675 6e63 7469  r of your functi
+0003dd60: 6f6e 2073 686f 756c 6420 6265 2061 2073  on should be a s
+0003dd70: 6e6f 7770 6172 6b20 5365 7373 696f 6e2e  nowpark Session.
+0003dd80: 2041 6c73 6f2c 2079 6f75 206e 6565 6420   Also, you need 
+0003dd90: 746f 2061 6464 0a20 2020 2060 736e 6f77  to add.    `snow
+0003dda0: 666c 616b 652d 736e 6f77 7061 726b 2d70  flake-snowpark-p
+0003ddb0: 7974 686f 6e60 2070 6163 6b61 6765 2028  ython` package (
+0003ddc0: 7665 7273 696f 6e20 3e3d 2030 2e34 2e30  version >= 0.4.0
+0003ddd0: 2920 746f 2079 6f75 7220 7365 7373 696f  ) to your sessio
+0003dde0: 6e20 6265 666f 7265 2074 7279 696e 6720  n before trying 
+0003ddf0: 746f 2063 7265 6174 6520 610a 2020 2020  to create a.    
+0003de00: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+0003de10: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+0003de20: 2020 2020 2066 756e 633a 2041 2050 7974       func: A Pyt
+0003de30: 686f 6e20 6675 6e63 7469 6f6e 2075 7365  hon function use
+0003de40: 6420 666f 7220 6372 6561 7469 6e67 2074  d for creating t
+0003de50: 6865 2073 746f 7265 6420 7072 6f63 6564  he stored proced
+0003de60: 7572 652e 0a20 2020 2020 2020 2072 6574  ure..        ret
+0003de70: 7572 6e5f 7479 7065 3a20 4120 3a63 6c61  urn_type: A :cla
+0003de80: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
+0003de90: 6e6f 7770 6172 6b2e 7479 7065 732e 4461  nowpark.types.Da
+0003dea0: 7461 5479 7065 6020 7265 7072 6573 656e  taType` represen
+0003deb0: 7469 6e67 2074 6865 2072 6574 7572 6e20  ting the return 
+0003dec0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
+0003ded0: 2074 7970 6520 6f66 2074 6865 2073 746f   type of the sto
+0003dee0: 7265 6420 7072 6f63 6564 7572 652e 204f  red procedure. O
+0003def0: 7074 696f 6e61 6c20 6966 2074 7970 6520  ptional if type 
+0003df00: 6869 6e74 7320 6172 6520 7072 6f76 6964  hints are provid
+0003df10: 6564 2e0a 2020 2020 2020 2020 696e 7075  ed..        inpu
+0003df20: 745f 7479 7065 733a 2041 206c 6973 7420  t_types: A list 
+0003df30: 6f66 203a 636c 6173 733a 607e 736e 6f77  of :class:`~snow
+0003df40: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0003df50: 7970 6573 2e44 6174 6154 7970 6560 0a20  ypes.DataType`. 
+0003df60: 2020 2020 2020 2020 2020 2072 6570 7265             repre
+0003df70: 7365 6e74 696e 6720 7468 6520 696e 7075  senting the inpu
+0003df80: 7420 6461 7461 2074 7970 6573 206f 6620  t data types of 
+0003df90: 7468 6520 7374 6f72 6564 2070 726f 6365  the stored proce
+0003dfa0: 6475 7265 2e20 4f70 7469 6f6e 616c 2069  dure. Optional i
+0003dfb0: 660a 2020 2020 2020 2020 2020 2020 7479  f.            ty
+0003dfc0: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
+0003dfd0: 7669 6465 642e 0a20 2020 2020 2020 206e  vided..        n
+0003dfe0: 616d 653a 2041 2073 7472 696e 6720 6f72  ame: A string or
+0003dff0: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
+0003e000: 2074 6861 7420 7370 6563 6966 7920 7468   that specify th
+0003e010: 6520 6e61 6d65 206f 7220 6675 6c6c 792d  e name or fully-
+0003e020: 7175 616c 6966 6965 640a 2020 2020 2020  qualified.      
+0003e030: 2020 2020 2020 6f62 6a65 6374 2069 6465        object ide
+0003e040: 6e74 6966 6965 7220 2864 6174 6162 6173  ntifier (databas
+0003e050: 6520 6e61 6d65 2c20 7363 6865 6d61 206e  e name, schema n
+0003e060: 616d 652c 2061 6e64 2066 756e 6374 696f  ame, and functio
+0003e070: 6e20 6e61 6d65 2920 666f 720a 2020 2020  n name) for.    
+0003e080: 2020 2020 2020 2020 7468 6520 7374 6f72          the stor
+0003e090: 6564 2070 726f 6365 6475 7265 2069 6e20  ed procedure in 
+0003e0a0: 536e 6f77 666c 616b 652c 2077 6869 6368  Snowflake, which
+0003e0b0: 2061 6c6c 6f77 7320 796f 7520 746f 2063   allows you to c
+0003e0c0: 616c 6c20 7468 6973 2073 746f 7265 6420  all this stored 
+0003e0d0: 7072 6f63 6564 7572 6520 696e 2061 2053  procedure in a S
+0003e0e0: 514c 0a20 2020 2020 2020 2020 2020 2063  QL.            c
+0003e0f0: 6f6d 6d61 6e64 206f 7220 7669 6120 3a66  ommand or via :f
+0003e100: 756e 633a 6073 6573 7369 6f6e 2e63 616c  unc:`session.cal
+0003e110: 6c28 2960 2e20 4966 2069 7420 6973 206e  l()`. If it is n
+0003e120: 6f74 2070 726f 7669 6465 642c 2061 206e  ot provided, a n
+0003e130: 616d 6520 7769 6c6c 0a20 2020 2020 2020  ame will.       
+0003e140: 2020 2020 2062 6520 6175 746f 6d61 7469       be automati
+0003e150: 6361 6c6c 7920 6765 6e65 7261 7465 6420  cally generated 
+0003e160: 666f 7220 7468 6520 7374 6f72 6564 2070  for the stored p
+0003e170: 726f 6365 6475 7265 2e20 4120 6e61 6d65  rocedure. A name
+0003e180: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+0003e190: 6564 2077 6865 6e0a 2020 2020 2020 2020  ed when.        
+0003e1a0: 2020 2020 6060 6973 5f70 6572 6d61 6e65      ``is_permane
+0003e1b0: 6e74 6060 2069 7320 6060 5472 7565 6060  nt`` is ``True``
+0003e1c0: 2e0a 2020 2020 2020 2020 6973 5f70 6572  ..        is_per
+0003e1d0: 6d61 6e65 6e74 3a20 5768 6574 6865 7220  manent: Whether 
+0003e1e0: 746f 2063 7265 6174 6520 6120 7065 726d  to create a perm
+0003e1f0: 616e 656e 7420 7374 6f72 6564 2070 726f  anent stored pro
+0003e200: 6365 6475 7265 2e20 5468 6520 6465 6661  cedure. The defa
+0003e210: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
+0003e220: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0003e230: 2069 7420 6973 2060 6054 7275 6560 602c   it is ``True``,
+0003e240: 2061 2076 616c 6964 2060 6073 7461 6765   a valid ``stage
+0003e250: 5f6c 6f63 6174 696f 6e60 6020 6d75 7374  _location`` must
+0003e260: 2062 6520 7072 6f76 6964 6564 2e0a 2020   be provided..  
+0003e270: 2020 2020 2020 7374 6167 655f 6c6f 6361        stage_loca
+0003e280: 7469 6f6e 3a20 5468 6520 7374 6167 6520  tion: The stage 
+0003e290: 6c6f 6361 7469 6f6e 2077 6865 7265 2074  location where t
+0003e2a0: 6865 2050 7974 686f 6e20 6669 6c65 2066  he Python file f
+0003e2b0: 6f72 2074 6865 2073 746f 7265 6420 7072  or the stored pr
+0003e2c0: 6f63 6564 7572 650a 2020 2020 2020 2020  ocedure.        
+0003e2d0: 2020 2020 616e 6420 6974 7320 6465 7065      and its depe
+0003e2e0: 6e64 656e 6369 6573 2073 686f 756c 6420  ndencies should 
+0003e2f0: 6265 2075 706c 6f61 6465 642e 2054 6865  be uploaded. The
+0003e300: 2073 7461 6765 206c 6f63 6174 696f 6e20   stage location 
+0003e310: 6d75 7374 2062 6520 7370 6563 6966 6965  must be specifie
+0003e320: 640a 2020 2020 2020 2020 2020 2020 7768  d.            wh
+0003e330: 656e 2060 6069 735f 7065 726d 616e 656e  en ``is_permanen
+0003e340: 7460 6020 6973 2060 6054 7275 6560 602c  t`` is ``True``,
+0003e350: 2061 6e64 2069 7420 7769 6c6c 2062 6520   and it will be 
+0003e360: 6967 6e6f 7265 6420 7768 656e 0a20 2020  ignored when.   
+0003e370: 2020 2020 2020 2020 2060 6069 735f 7065           ``is_pe
+0003e380: 726d 616e 656e 7460 6020 6973 2060 6046  rmanent`` is ``F
+0003e390: 616c 7365 6060 2e20 4974 2063 616e 2062  alse``. It can b
+0003e3a0: 6520 616e 7920 7374 6167 6520 6f74 6865  e any stage othe
+0003e3b0: 7220 7468 616e 2074 656d 706f 7261 7279  r than temporary
+0003e3c0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+0003e3d0: 6765 7320 616e 6420 6578 7465 726e 616c  ges and external
+0003e3e0: 2073 7461 6765 732e 0a20 2020 2020 2020   stages..       
+0003e3f0: 2069 6d70 6f72 7473 3a20 4120 6c69 7374   imports: A list
+0003e400: 206f 6620 696d 706f 7274 7320 7468 6174   of imports that
+0003e410: 206f 6e6c 7920 6170 706c 7920 746f 2074   only apply to t
+0003e420: 6869 7320 7374 6f72 6564 2070 726f 6365  his stored proce
+0003e430: 6475 7265 2e20 596f 7520 6361 6e20 7573  dure. You can us
+0003e440: 6520 6120 7374 7269 6e67 2074 6f0a 2020  e a string to.  
+0003e450: 2020 2020 2020 2020 2020 7265 7072 6573            repres
+0003e460: 656e 7420 6120 6669 6c65 2070 6174 6820  ent a file path 
+0003e470: 2873 696d 696c 6172 2074 6f20 7468 6520  (similar to the 
+0003e480: 6060 7061 7468 6060 2061 7267 756d 656e  ``path`` argumen
+0003e490: 7420 696e 0a20 2020 2020 2020 2020 2020  t in.           
+0003e4a0: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
+0003e4b0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
+0003e4c0: 696f 6e2e 6164 645f 696d 706f 7274 6029  ion.add_import`)
+0003e4d0: 2069 6e20 7468 6973 206c 6973 742c 206f   in this list, o
+0003e4e0: 7220 6120 7475 706c 6520 6f66 2074 776f  r a tuple of two
+0003e4f0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+0003e500: 696e 6773 2074 6f20 7265 7072 6573 656e  ings to represen
+0003e510: 7420 6120 6669 6c65 2070 6174 6820 616e  t a file path an
+0003e520: 6420 616e 2069 6d70 6f72 7420 7061 7468  d an import path
+0003e530: 2028 7369 6d69 6c61 7220 746f 2074 6865   (similar to the
+0003e540: 2060 6069 6d70 6f72 745f 7061 7468 6060   ``import_path``
+0003e550: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+0003e560: 756d 656e 7420 696e 203a 6d65 7468 3a60  ument in :meth:`
+0003e570: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+0003e580: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
+0003e590: 696d 706f 7274 6029 2e20 5468 6573 6520  import`). These 
+0003e5a0: 7374 6f72 6564 2d70 726f 632d 6c65 7665  stored-proc-leve
+0003e5b0: 6c20 696d 706f 7274 730a 2020 2020 2020  l imports.      
+0003e5c0: 2020 2020 2020 7769 6c6c 206f 7665 7272        will overr
+0003e5d0: 6964 6520 7468 6520 7365 7373 696f 6e2d  ide the session-
+0003e5e0: 6c65 7665 6c20 696d 706f 7274 7320 6164  level imports ad
+0003e5f0: 6465 6420 6279 0a20 2020 2020 2020 2020  ded by.         
+0003e600: 2020 203a 6d65 7468 3a60 7e73 6e6f 7766     :meth:`~snowf
+0003e610: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5365  lake.snowpark.Se
+0003e620: 7373 696f 6e2e 6164 645f 696d 706f 7274  ssion.add_import
+0003e630: 602e 0a20 2020 2020 2020 2070 6163 6b61  `..        packa
+0003e640: 6765 733a 2041 206c 6973 7420 6f66 2070  ges: A list of p
+0003e650: 6163 6b61 6765 7320 7468 6174 206f 6e6c  ackages that onl
+0003e660: 7920 6170 706c 7920 746f 2074 6869 7320  y apply to this 
+0003e670: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+0003e680: 2e20 5468 6573 6520 7374 6f72 6564 2d70  . These stored-p
+0003e690: 726f 632d 6c65 7665 6c20 7061 636b 6167  roc-level packag
+0003e6a0: 6573 0a20 2020 2020 2020 2020 2020 2077  es.            w
+0003e6b0: 696c 6c20 6f76 6572 7269 6465 2074 6865  ill override the
+0003e6c0: 2073 6573 7369 6f6e 2d6c 6576 656c 2070   session-level p
+0003e6d0: 6163 6b61 6765 7320 6164 6465 6420 6279  ackages added by
+0003e6e0: 0a20 2020 2020 2020 2020 2020 203a 6d65  .            :me
+0003e6f0: 7468 3a60 7e73 6e6f 7766 6c61 6b65 2e73  th:`~snowflake.s
+0003e700: 6e6f 7770 6172 6b2e 5365 7373 696f 6e2e  nowpark.Session.
+0003e710: 6164 645f 7061 636b 6167 6573 6020 616e  add_packages` an
+0003e720: 640a 2020 2020 2020 2020 2020 2020 3a6d  d.            :m
+0003e730: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
+0003e740: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
+0003e750: 2e61 6464 5f72 6571 7569 7265 6d65 6e74  .add_requirement
+0003e760: 7360 2e0a 2020 2020 2020 2020 7265 706c  s`..        repl
+0003e770: 6163 653a 2057 6865 7468 6572 2074 6f20  ace: Whether to 
+0003e780: 7265 706c 6163 6520 6120 7374 6f72 6564  replace a stored
+0003e790: 2070 726f 6365 6475 7265 2074 6861 7420   procedure that 
+0003e7a0: 616c 7265 6164 7920 7761 7320 7265 6769  already was regi
+0003e7b0: 7374 6572 6564 2e20 5468 6520 6465 6661  stered. The defa
+0003e7c0: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
+0003e7d0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0003e7e0: 2069 7420 6973 2060 6046 616c 7365 6060   it is ``False``
+0003e7f0: 2c20 6174 7465 6d70 7469 6e67 2074 6f20  , attempting to 
+0003e800: 7265 6769 7374 6572 2061 2073 746f 7265  register a store
+0003e810: 6420 7072 6f63 6564 7572 6520 7769 7468  d procedure with
+0003e820: 2061 206e 616d 6520 7468 6174 2061 6c72   a name that alr
+0003e830: 6561 6479 2065 7869 7374 730a 2020 2020  eady exists.    
+0003e840: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+0003e850: 696e 2061 2060 6053 6e6f 7770 6172 6b53  in a ``SnowparkS
+0003e860: 514c 4578 6365 7074 696f 6e60 6020 6578  QLException`` ex
+0003e870: 6365 7074 696f 6e20 6265 696e 6720 7468  ception being th
+0003e880: 726f 776e 2e20 4966 2069 7420 6973 2060  rown. If it is `
+0003e890: 6054 7275 6560 602c 0a20 2020 2020 2020  `True``,.       
+0003e8a0: 2020 2020 2061 6e20 6578 6973 7469 6e67       an existing
+0003e8b0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+0003e8c0: 6520 7769 7468 2074 6865 2073 616d 6520  e with the same 
+0003e8d0: 6e61 6d65 2069 7320 6f76 6572 7772 6974  name is overwrit
+0003e8e0: 7465 6e2e 0a20 2020 2020 2020 2069 665f  ten..        if_
+0003e8f0: 6e6f 745f 6578 6973 7473 3a20 5768 6574  not_exists: Whet
+0003e900: 6865 7220 746f 2073 6b69 7020 6372 6561  her to skip crea
+0003e910: 7469 6f6e 206f 6620 6120 7374 6f72 6564  tion of a stored
+0003e920: 2070 726f 6365 6475 7265 2074 6865 2073   procedure the s
+0003e930: 616d 6520 7072 6f63 6564 7572 6520 6973  ame procedure is
+0003e940: 2061 6c72 6561 6479 2072 6567 6973 7465   already registe
+0003e950: 7265 642e 0a20 2020 2020 2020 2020 2020  red..           
+0003e960: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+0003e970: 6060 4661 6c73 6560 602e 2060 6069 665f  ``False``. ``if_
+0003e980: 6e6f 745f 6578 6973 7473 6060 2061 6e64  not_exists`` and
+0003e990: 2060 6072 6570 6c61 6365 6060 2061 7265   ``replace`` are
+0003e9a0: 206d 7574 7561 6c6c 7920 6578 636c 7573   mutually exclus
+0003e9b0: 6976 6520 616e 6420 6120 6060 5661 6c75  ive and a ``Valu
+0003e9c0: 6545 7272 6f72 6060 0a20 2020 2020 2020  eError``.       
+0003e9d0: 2020 2020 2069 7320 7261 6973 6564 2077       is raised w
+0003e9e0: 6865 6e20 626f 7468 2061 7265 2073 6574  hen both are set
+0003e9f0: 2e20 4966 2069 7420 6973 2060 6054 7275  . If it is ``Tru
+0003ea00: 6560 6020 616e 6420 6120 7374 6f72 6564  e`` and a stored
+0003ea10: 2070 726f 6365 6475 7265 2069 7320 616c   procedure is al
+0003ea20: 7265 6164 7920 7265 6769 7374 6572 6564  ready registered
+0003ea30: 2c20 7468 6520 7265 6769 7374 7261 7469  , the registrati
+0003ea40: 6f6e 2069 7320 736b 6970 7065 642e 0a20  on is skipped.. 
+0003ea50: 2020 2020 2020 2073 6573 7369 6f6e 3a20         session: 
+0003ea60: 5573 6520 7468 6973 2073 6573 7369 6f6e  Use this session
+0003ea70: 2074 6f20 7265 6769 7374 6572 2074 6865   to register the
+0003ea80: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+0003ea90: 652e 2049 6620 6974 2773 206e 6f74 2073  e. If it's not s
+0003eaa0: 7065 6369 6669 6564 2c20 7468 6520 7365  pecified, the se
+0003eab0: 7373 696f 6e20 7468 6174 2079 6f75 2063  ssion that you c
+0003eac0: 7265 6174 6564 2062 6566 6f72 6520 6361  reated before ca
+0003ead0: 6c6c 696e 6720 7468 6973 2066 756e 6374  lling this funct
+0003eae0: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
+0003eaf0: 2e0a 2020 2020 2020 2020 2020 2020 596f  ..            Yo
+0003eb00: 7520 6e65 6564 2074 6f20 7370 6563 6966  u need to specif
+0003eb10: 7920 7468 6973 2070 6172 616d 6574 6572  y this parameter
+0003eb20: 2069 6620 796f 7520 6861 7665 2063 7265   if you have cre
+0003eb30: 6174 6564 206d 756c 7469 706c 6520 7365  ated multiple se
+0003eb40: 7373 696f 6e73 2062 6566 6f72 6520 6361  ssions before ca
+0003eb50: 6c6c 696e 6720 7468 6973 206d 6574 686f  lling this metho
+0003eb60: 642e 0a20 2020 2020 2020 2070 6172 616c  d..        paral
+0003eb70: 6c65 6c3a 2054 6865 206e 756d 6265 7220  lel: The number 
+0003eb80: 6f66 2074 6872 6561 6473 2074 6f20 7573  of threads to us
+0003eb90: 6520 666f 7220 7570 6c6f 6164 696e 6720  e for uploading 
+0003eba0: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+0003ebb0: 2066 696c 6573 2077 6974 6820 7468 650a   files with the.
+0003ebc0: 2020 2020 2020 2020 2020 2020 6050 5554              `PUT
+0003ebd0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+0003ebe0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+0003ebf0: 7371 6c2d 7265 6665 7265 6e63 652f 7371  sql-reference/sq
+0003ec00: 6c2f 7075 742e 6874 6d6c 2370 7574 3e60  l/put.html#put>`
+0003ec10: 5f0a 2020 2020 2020 2020 2020 2020 636f  _.            co
+0003ec20: 6d6d 616e 642e 2054 6865 2064 6566 6175  mmand. The defau
+0003ec30: 6c74 2076 616c 7565 2069 7320 3420 616e  lt value is 4 an
+0003ec40: 6420 7375 7070 6f72 7465 6420 7661 6c75  d supported valu
+0003ec50: 6573 2061 7265 2066 726f 6d20 3120 746f  es are from 1 to
+0003ec60: 2039 392e 0a20 2020 2020 2020 2020 2020   99..           
+0003ec70: 2049 6e63 7265 6173 696e 6720 7468 6520   Increasing the 
+0003ec80: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
+0003ec90: 7320 6361 6e20 696d 7072 6f76 6520 7065  s can improve pe
+0003eca0: 7266 6f72 6d61 6e63 6520 7768 656e 2075  rformance when u
+0003ecb0: 706c 6f61 6469 6e67 0a20 2020 2020 2020  ploading.       
+0003ecc0: 2020 2020 206c 6172 6765 2073 746f 7265       large store
+0003ecd0: 6420 7072 6f63 6564 7572 6520 6669 6c65  d procedure file
+0003ece0: 732e 0a20 2020 2020 2020 2065 7865 6375  s..        execu
+0003ecf0: 7465 5f61 733a 2057 6861 7420 7065 726d  te_as: What perm
+0003ed00: 6973 7369 6f6e 7320 7368 6f75 6c64 2074  issions should t
+0003ed10: 6865 2070 726f 6365 6475 7265 2068 6176  he procedure hav
+0003ed20: 6520 7768 696c 6520 6578 6563 7574 696e  e while executin
+0003ed30: 672e 2054 6869 730a 2020 2020 2020 2020  g. This.        
+0003ed40: 2020 2020 7375 7070 6f72 7473 2063 616c      supports cal
+0003ed50: 6c65 722c 206f 7220 6f77 6e65 7220 666f  ler, or owner fo
+0003ed60: 7220 6e6f 772e 2053 6565 2060 6f77 6e65  r now. See `owne
+0003ed70: 7220 616e 6420 6361 6c6c 6572 2072 6967  r and caller rig
+0003ed80: 6874 7320 3c68 7474 7073 3a2f 2f64 6f63  hts <https://doc
+0003ed90: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
+0003eda0: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
+0003edb0: 2f73 746f 7265 642d 7072 6f63 6564 7572  /stored-procedur
+0003edc0: 6573 2d72 6967 6874 732e 6874 6d6c 3e60  es-rights.html>`
+0003edd0: 5f0a 2020 2020 2020 2020 2020 2020 666f  _.            fo
+0003ede0: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+0003edf0: 6f6e 2e0a 2020 2020 2020 2020 7374 6174  on..        stat
+0003ee00: 656d 656e 745f 7061 7261 6d73 3a20 4469  ement_params: Di
+0003ee10: 6374 696f 6e61 7279 206f 6620 7374 6174  ctionary of stat
+0003ee20: 656d 656e 7420 6c65 7665 6c20 7061 7261  ement level para
+0003ee30: 6d65 7465 7273 2074 6f20 6265 2073 6574  meters to be set
+0003ee40: 2077 6869 6c65 2065 7865 6375 7469 6e67   while executing
+0003ee50: 2074 6869 7320 6163 7469 6f6e 2e0a 2020   this action..  
+0003ee60: 2020 2020 2020 7374 7269 6374 3a20 5768        strict: Wh
+0003ee70: 6574 6865 7220 7468 6520 6372 6561 7465  ether the create
+0003ee80: 6420 7374 6f72 6564 2070 726f 6365 6475  d stored procedu
+0003ee90: 7265 2069 7320 7374 7269 6374 2e20 4120  re is strict. A 
+0003eea0: 7374 7269 6374 2073 746f 7265 6420 7072  strict stored pr
+0003eeb0: 6f63 6564 7572 6520 7769 6c6c 206e 6f74  ocedure will not
+0003eec0: 2069 6e76 6f6b 650a 2020 2020 2020 2020   invoke.        
+0003eed0: 2020 2020 7468 6520 7374 6f72 6564 2070      the stored p
+0003eee0: 726f 6365 6475 7265 2069 6620 616e 7920  rocedure if any 
+0003eef0: 696e 7075 7420 6973 206e 756c 6c2e 2049  input is null. I
+0003ef00: 6e73 7465 6164 2c20 6120 6e75 6c6c 2076  nstead, a null v
+0003ef10: 616c 7565 2077 696c 6c20 616c 7761 7973  alue will always
+0003ef20: 2062 6520 7265 7475 726e 6564 2e20 4e6f   be returned. No
+0003ef30: 7465 0a20 2020 2020 2020 2020 2020 2074  te.            t
+0003ef40: 6861 7420 7468 6520 7374 6f72 6564 2070  hat the stored p
+0003ef50: 726f 6365 6475 7265 206d 6967 6874 2073  rocedure might s
+0003ef60: 7469 6c6c 2072 6574 7572 6e20 6e75 6c6c  till return null
+0003ef70: 2066 6f72 206e 6f6e 2d6e 756c 6c20 696e   for non-null in
+0003ef80: 7075 7473 2e0a 2020 2020 2020 2020 736f  puts..        so
+0003ef90: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
+0003efa0: 793a 2044 6973 706c 6179 2074 6865 2073  y: Display the s
+0003efb0: 6f75 7263 6520 636f 6465 206f 6620 7468  ource code of th
+0003efc0: 6520 7374 6f72 6564 2070 726f 6365 6475  e stored procedu
+0003efd0: 7265 2060 6675 6e63 6020 6173 2063 6f6d  re `func` as com
+0003efe0: 6d65 6e74 7320 696e 2074 6865 2067 656e  ments in the gen
+0003eff0: 6572 6174 6564 2073 6372 6970 742e 0a20  erated script.. 
+0003f000: 2020 2020 2020 2020 2020 2054 6865 2073             The s
+0003f010: 6f75 7263 6520 636f 6465 2069 7320 6479  ource code is dy
+0003f020: 6e61 6d69 6361 6c6c 7920 6765 6e65 7261  namically genera
+0003f030: 7465 6420 7468 6572 6566 6f72 6520 6974  ted therefore it
+0003f040: 206d 6179 206e 6f74 2062 6520 6964 656e   may not be iden
+0003f050: 7469 6361 6c20 746f 2068 6f77 2074 6865  tical to how the
+0003f060: 0a20 2020 2020 2020 2020 2020 2060 6675  .            `fu
+0003f070: 6e63 6020 6973 206f 7269 6769 6e61 6c6c  nc` is originall
+0003f080: 7920 6465 6669 6e65 642e 2054 6865 2064  y defined. The d
+0003f090: 6566 6175 6c74 2069 7320 6060 5472 7565  efault is ``True
+0003f0a0: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+0003f0b0: 4966 2069 7420 6973 2060 6046 616c 7365  If it is ``False
+0003f0c0: 6060 2c20 736f 7572 6365 2063 6f64 6520  ``, source code 
+0003f0d0: 7769 6c6c 206e 6f74 2062 6520 6765 6e65  will not be gene
+0003f0e0: 7261 7465 6420 6f72 2064 6973 706c 6179  rated or display
+0003f0f0: 6564 2e0a 0a20 2020 2052 6574 7572 6e73  ed...    Returns
+0003f100: 3a0a 2020 2020 2020 2020 4120 7374 6f72  :.        A stor
+0003f110: 6564 2070 726f 6365 6475 7265 2066 756e  ed procedure fun
+0003f120: 6374 696f 6e20 7468 6174 2063 616e 2062  ction that can b
+0003f130: 6520 6361 6c6c 6564 2077 6974 6820 7079  e called with py
+0003f140: 7468 6f6e 2076 616c 7565 2e0a 0a20 2020  thon value...   
+0003f150: 204e 6f74 653a 0a20 2020 2020 2020 2031   Note:.        1
+0003f160: 2e20 5768 656e 2074 7970 6520 6869 6e74  . When type hint
+0003f170: 7320 6172 6520 7072 6f76 6964 6564 2061  s are provided a
+0003f180: 6e64 2061 7265 2063 6f6d 706c 6574 6520  nd are complete 
+0003f190: 666f 7220 6120 6675 6e63 7469 6f6e 2c0a  for a function,.
+0003f1a0: 2020 2020 2020 2020 6060 7265 7475 726e          ``return
+0003f1b0: 5f74 7970 6560 6020 616e 6420 6060 696e  _type`` and ``in
+0003f1c0: 7075 745f 7479 7065 7360 6020 6172 6520  put_types`` are 
+0003f1d0: 6f70 7469 6f6e 616c 2061 6e64 2077 696c  optional and wil
+0003f1e0: 6c20 6265 2069 676e 6f72 6564 2e0a 2020  l be ignored..  
+0003f1f0: 2020 2020 2020 5365 6520 6465 7461 696c        See detail
+0003f200: 7320 6f66 2073 7570 706f 7274 6564 2064  s of supported d
+0003f210: 6174 6120 7479 7065 7320 666f 7220 7374  ata types for st
+0003f220: 6f72 6564 2070 726f 6365 6475 7265 2069  ored procedure i
+0003f230: 6e0a 2020 2020 2020 2020 3a63 6c61 7373  n.        :class
+0003f240: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+0003f250: 7770 6172 6b2e 7374 6f72 6564 5f70 726f  wpark.stored_pro
+0003f260: 6365 6475 7265 2e53 746f 7265 6450 726f  cedure.StoredPro
+0003f270: 6365 6475 7265 5265 6769 7374 7261 7469  cedureRegistrati
+0003f280: 6f6e 602e 0a0a 2020 2020 2020 2020 2020  on`...          
+0003f290: 2020 2d20 596f 7520 6361 6e20 7573 6520    - You can use 
+0003f2a0: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
+0003f2b0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0003f2c0: 2e56 6172 6961 6e74 6020 746f 0a20 2020  .Variant` to.   
+0003f2d0: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
+0003f2e0: 6174 6520 6120 7661 7269 616e 742c 2061  ate a variant, a
+0003f2f0: 6e64 2075 7365 203a 6174 7472 3a60 7e73  nd use :attr:`~s
+0003f300: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0003f310: 6b2e 7479 7065 732e 4765 6f67 7261 7068  k.types.Geograph
+0003f320: 7960 0a20 2020 2020 2020 2020 2020 2020  y`.             
+0003f330: 2074 6f20 616e 6e6f 7461 7465 2061 2067   to annotate a g
+0003f340: 656f 6772 6170 6879 2077 6865 6e20 6465  eography when de
+0003f350: 6669 6e69 6e67 2061 2073 746f 7265 6420  fining a stored 
+0003f360: 7072 6f63 6564 7572 652e 0a0a 2020 2020  procedure...    
+0003f370: 2020 2020 2020 2020 2d20 3a63 6c61 7373          - :class
+0003f380: 3a60 7479 7069 6e67 2e55 6e69 6f6e 6020  :`typing.Union` 
+0003f390: 6973 206e 6f74 2061 2076 616c 6964 2074  is not a valid t
+0003f3a0: 7970 6520 616e 6e6f 7461 7469 6f6e 2066  ype annotation f
+0003f3b0: 6f72 2073 746f 7265 6420 7072 6f63 6564  or stored proced
+0003f3c0: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
+0003f3d0: 2020 2020 6275 7420 3a63 6c61 7373 3a60      but :class:`
+0003f3e0: 7479 7069 6e67 2e4f 7074 696f 6e61 6c60  typing.Optional`
+0003f3f0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0003f400: 696e 6469 6361 7465 2074 6865 206f 7074  indicate the opt
+0003f410: 696f 6e61 6c20 7479 7065 2e0a 0a20 2020  ional type...   
+0003f420: 2020 2020 2032 2e20 4120 7465 6d70 6f72       2. A tempor
+0003f430: 6172 7920 7374 6f72 6564 2070 726f 6365  ary stored proce
+0003f440: 6475 7265 2028 7768 656e 2060 6069 735f  dure (when ``is_
+0003f450: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
+0003f460: 6046 616c 7365 6060 2920 6973 2073 636f  `False``) is sco
+0003f470: 7065 6420 746f 2074 6869 7320 6060 7365  ped to this ``se
+0003f480: 7373 696f 6e60 600a 2020 2020 2020 2020  ssion``.        
+0003f490: 616e 6420 616c 6c20 7374 6f72 6564 2070  and all stored p
+0003f4a0: 726f 6365 6475 7265 2072 656c 6174 6564  rocedure related
+0003f4b0: 2066 696c 6573 2077 696c 6c20 6265 2075   files will be u
+0003f4c0: 706c 6f61 6465 6420 746f 2061 2074 656d  ploaded to a tem
+0003f4d0: 706f 7261 7279 2073 6573 7369 6f6e 2073  porary session s
+0003f4e0: 7461 6765 0a20 2020 2020 2020 2028 3a66  tage.        (:f
+0003f4f0: 756e 633a 6073 6573 7369 6f6e 2e67 6574  unc:`session.get
+0003f500: 5f73 6573 7369 6f6e 5f73 7461 6765 2829  _session_stage()
+0003f510: 203c 736e 6f77 666c 616b 652e 736e 6f77   <snowflake.snow
+0003f520: 7061 726b 2e53 6573 7369 6f6e 2e67 6574  park.Session.get
+0003f530: 5f73 6573 7369 6f6e 5f73 7461 6765 3e60  _session_stage>`
+0003f540: 292e 0a20 2020 2020 2020 2046 6f72 2061  )..        For a
+0003f550: 2070 6572 6d61 6e65 6e74 2073 746f 7265   permanent store
+0003f560: 6420 7072 6f63 6564 7572 652c 2074 6865  d procedure, the
+0003f570: 7365 2066 696c 6573 2077 696c 6c20 6265  se files will be
+0003f580: 2075 706c 6f61 6465 6420 746f 2074 6865   uploaded to the
+0003f590: 2073 7461 6765 2074 6861 7420 796f 7520   stage that you 
+0003f5a0: 7072 6f76 6964 652e 0a0a 2020 2020 2020  provide...      
+0003f5b0: 2020 332e 2042 7920 6465 6661 756c 742c    3. By default,
+0003f5c0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+0003f5d0: 6520 7265 6769 7374 7261 7469 6f6e 2066  e registration f
+0003f5e0: 6169 6c73 2069 6620 6120 6675 6e63 7469  ails if a functi
+0003f5f0: 6f6e 2077 6974 6820 7468 6520 7361 6d65  on with the same
+0003f600: 206e 616d 6520 6973 2061 6c72 6561 6479   name is already
+0003f610: 0a20 2020 2020 2020 2072 6567 6973 7465  .        registe
+0003f620: 7265 642e 2049 6e76 6f6b 696e 6720 3a66  red. Invoking :f
+0003f630: 756e 633a 6073 7072 6f63 6020 7769 7468  unc:`sproc` with
+0003f640: 2060 6072 6570 6c61 6365 6060 2073 6574   ``replace`` set
+0003f650: 2074 6f20 6060 5472 7565 6060 2077 696c   to ``True`` wil
+0003f660: 6c20 6f76 6572 7772 6974 6520 7468 650a  l overwrite the.
+0003f670: 2020 2020 2020 2020 7072 6576 696f 7573          previous
+0003f680: 6c79 2072 6567 6973 7465 7265 6420 6675  ly registered fu
+0003f690: 6e63 7469 6f6e 2e0a 0a20 2020 2053 6565  nction...    See
+0003f6a0: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
+0003f6b0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+0003f6c0: 652e 736e 6f77 7061 726b 2e73 746f 7265  e.snowpark.store
+0003f6d0: 645f 7072 6f63 6564 7572 652e 5374 6f72  d_procedure.Stor
+0003f6e0: 6564 5072 6f63 6564 7572 6552 6567 6973  edProcedureRegis
+0003f6f0: 7472 6174 696f 6e60 0a0a 2020 2020 4578  tration`..    Ex
+0003f700: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0003f710: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0003f720: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+0003f730: 7320 696d 706f 7274 2049 6e74 6567 6572  s import Integer
+0003f740: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+0003f750: 2040 7370 726f 6328 7265 7475 726e 5f74   @sproc(return_t
+0003f760: 7970 653d 496e 7465 6765 7254 7970 6528  ype=IntegerType(
+0003f770: 292c 2069 6e70 7574 5f74 7970 6573 3d5b  ), input_types=[
+0003f780: 496e 7465 6765 7254 7970 6528 292c 2049  IntegerType(), I
+0003f790: 6e74 6567 6572 5479 7065 2829 5d2c 2070  ntegerType()], p
+0003f7a0: 6163 6b61 6765 733d 5b22 736e 6f77 666c  ackages=["snowfl
+0003f7b0: 616b 652d 736e 6f77 7061 726b 2d70 7974  ake-snowpark-pyt
+0003f7c0: 686f 6e22 5d29 0a20 2020 2020 2020 202e  hon"]).        .
+0003f7d0: 2e2e 2064 6566 2061 6464 5f73 7028 7365  .. def add_sp(se
+0003f7e0: 7373 696f 6e5f 2c20 782c 2079 293a 0a20  ssion_, x, y):. 
+0003f7f0: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
+0003f800: 6574 7572 6e20 7365 7373 696f 6e5f 2e73  eturn session_.s
+0003f810: 716c 2866 2253 454c 4543 5420 7b78 7d20  ql(f"SELECT {x} 
+0003f820: 2b20 7b79 7d22 292e 636f 6c6c 6563 7428  + {y}").collect(
+0003f830: 295b 305d 5b30 5d0a 2020 2020 2020 2020  )[0][0].        
+0003f840: 2e2e 2e0a 2020 2020 2020 2020 3e3e 3e20  ....        >>> 
+0003f850: 6164 645f 7370 2831 2c20 3129 0a20 2020  add_sp(1, 1).   
+0003f860: 2020 2020 2032 0a20 2020 2022 2222 0a20       2.    """. 
+0003f870: 2020 2073 6573 7369 6f6e 203d 2073 6573     session = ses
+0003f880: 7369 6f6e 206f 7220 736e 6f77 666c 616b  sion or snowflak
+0003f890: 652e 736e 6f77 7061 726b 2e73 6573 7369  e.snowpark.sessi
+0003f8a0: 6f6e 2e5f 6765 745f 6163 7469 7665 5f73  on._get_active_s
+0003f8b0: 6573 7369 6f6e 2829 0a20 2020 2069 6620  ession().    if 
+0003f8c0: 6675 6e63 2069 7320 4e6f 6e65 3a0a 2020  func is None:.  
+0003f8d0: 2020 2020 2020 7265 7475 726e 2066 756e        return fun
+0003f8e0: 6374 6f6f 6c73 2e70 6172 7469 616c 280a  ctools.partial(.
+0003f8f0: 2020 2020 2020 2020 2020 2020 7365 7373              sess
+0003f900: 696f 6e2e 7370 726f 632e 7265 6769 7374  ion.sproc.regist
+0003f910: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+0003f920: 7265 7475 726e 5f74 7970 653d 7265 7475  return_type=retu
+0003f930: 726e 5f74 7970 652c 0a20 2020 2020 2020  rn_type,.       
+0003f940: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
+0003f950: 3d69 6e70 7574 5f74 7970 6573 2c0a 2020  =input_types,.  
+0003f960: 2020 2020 2020 2020 2020 6e61 6d65 3d6e            name=n
+0003f970: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0003f980: 2069 735f 7065 726d 616e 656e 743d 6973   is_permanent=is
+0003f990: 5f70 6572 6d61 6e65 6e74 2c0a 2020 2020  _permanent,.    
+0003f9a0: 2020 2020 2020 2020 7374 6167 655f 6c6f          stage_lo
+0003f9b0: 6361 7469 6f6e 3d73 7461 6765 5f6c 6f63  cation=stage_loc
+0003f9c0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
+0003f9d0: 2020 2069 6d70 6f72 7473 3d69 6d70 6f72     imports=impor
+0003f9e0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0003f9f0: 7061 636b 6167 6573 3d70 6163 6b61 6765  packages=package
+0003fa00: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
+0003fa10: 6570 6c61 6365 3d72 6570 6c61 6365 2c0a  eplace=replace,.
+0003fa20: 2020 2020 2020 2020 2020 2020 6966 5f6e              if_n
+0003fa30: 6f74 5f65 7869 7374 733d 6966 5f6e 6f74  ot_exists=if_not
+0003fa40: 5f65 7869 7374 732c 0a20 2020 2020 2020  _exists,.       
+0003fa50: 2020 2020 2070 6172 616c 6c65 6c3d 7061       parallel=pa
+0003fa60: 7261 6c6c 656c 2c0a 2020 2020 2020 2020  rallel,.        
+0003fa70: 2020 2020 7374 6174 656d 656e 745f 7061      statement_pa
+0003fa80: 7261 6d73 3d73 7461 7465 6d65 6e74 5f70  rams=statement_p
+0003fa90: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+0003faa0: 2020 2065 7865 6375 7465 5f61 733d 6578     execute_as=ex
+0003fab0: 6563 7574 655f 6173 2c0a 2020 2020 2020  ecute_as,.      
+0003fac0: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
+0003fad0: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+0003fae0: 2073 6f75 7263 655f 636f 6465 5f64 6973   source_code_dis
+0003faf0: 706c 6179 3d73 6f75 7263 655f 636f 6465  play=source_code
+0003fb00: 5f64 6973 706c 6179 2c0a 2020 2020 2020  _display,.      
+0003fb10: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+0003fb20: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
+0003fb30: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
+0003fb40: 726e 2073 6573 7369 6f6e 2e73 7072 6f63  rn session.sproc
+0003fb50: 2e72 6567 6973 7465 7228 0a20 2020 2020  .register(.     
+0003fb60: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
+0003fb70: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+0003fb80: 7479 7065 3d72 6574 7572 6e5f 7479 7065  type=return_type
+0003fb90: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
+0003fba0: 7075 745f 7479 7065 733d 696e 7075 745f  put_types=input_
+0003fbb0: 7479 7065 732c 0a20 2020 2020 2020 2020  types,.         
+0003fbc0: 2020 206e 616d 653d 6e61 6d65 2c0a 2020     name=name,.  
+0003fbd0: 2020 2020 2020 2020 2020 6973 5f70 6572            is_per
+0003fbe0: 6d61 6e65 6e74 3d69 735f 7065 726d 616e  manent=is_perman
+0003fbf0: 656e 742c 0a20 2020 2020 2020 2020 2020  ent,.           
+0003fc00: 2073 7461 6765 5f6c 6f63 6174 696f 6e3d   stage_location=
+0003fc10: 7374 6167 655f 6c6f 6361 7469 6f6e 2c0a  stage_location,.
+0003fc20: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+0003fc30: 7274 733d 696d 706f 7274 732c 0a20 2020  rts=imports,.   
+0003fc40: 2020 2020 2020 2020 2070 6163 6b61 6765           package
+0003fc50: 733d 7061 636b 6167 6573 2c0a 2020 2020  s=packages,.    
+0003fc60: 2020 2020 2020 2020 7265 706c 6163 653d          replace=
+0003fc70: 7265 706c 6163 652c 0a20 2020 2020 2020  replace,.       
+0003fc80: 2020 2020 2069 665f 6e6f 745f 6578 6973       if_not_exis
+0003fc90: 7473 3d69 665f 6e6f 745f 6578 6973 7473  ts=if_not_exists
+0003fca0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0003fcb0: 7261 6c6c 656c 3d70 6172 616c 6c65 6c2c  rallel=parallel,
+0003fcc0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+0003fcd0: 7465 6d65 6e74 5f70 6172 616d 733d 7374  tement_params=st
+0003fce0: 6174 656d 656e 745f 7061 7261 6d73 2c0a  atement_params,.
+0003fcf0: 2020 2020 2020 2020 2020 2020 6578 6563              exec
+0003fd00: 7574 655f 6173 3d65 7865 6375 7465 5f61  ute_as=execute_a
+0003fd10: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+0003fd20: 7472 6963 743d 7374 7269 6374 2c0a 2020  trict=strict,.  
+0003fd30: 2020 2020 2020 2020 2020 736f 7572 6365            source
+0003fd40: 5f63 6f64 655f 6469 7370 6c61 793d 736f  _code_display=so
+0003fd50: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
+0003fd60: 792c 0a20 2020 2020 2020 2020 2020 202a  y,.            *
+0003fd70: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
+0003fd80: 2029 0a0a 0a23 2041 6464 2074 6865 7365   )...# Add these
+0003fd90: 2061 6c69 6173 2066 6f72 2075 7365 7220   alias for user 
+0003fda0: 636f 6465 206d 6967 7261 7469 6f6e 0a63  code migration.c
+0003fdb0: 616c 6c5f 6275 696c 7469 6e20 3d20 6361  all_builtin = ca
+0003fdc0: 6c6c 5f66 756e 6374 696f 6e0a 6275 696c  ll_function.buil
+0003fdd0: 7469 6e20 3d20 6675 6e63 7469 6f6e 0a63  tin = function.c
+0003fde0: 6f75 6e74 4469 7374 696e 6374 203d 2063  ountDistinct = c
+0003fdf0: 6f75 6e74 5f64 6973 7469 6e63 740a 7375  ount_distinct.su
+0003fe00: 6273 7472 203d 2073 7562 7374 7269 6e67  bstr = substring
+0003fe10: 0a74 6f5f 7661 7263 6861 7220 3d20 746f  .to_varchar = to
+0003fe20: 5f63 6861 720a 6578 7072 203d 2073 716c  _char.expr = sql
+0003fe30: 5f65 7870 720a 6461 7465 5f66 6f72 6d61  _expr.date_forma
+0003fe40: 7420 3d20 746f 5f64 6174 650a 6d6f 6e6f  t = to_date.mono
+0003fe50: 746f 6e69 6361 6c6c 795f 696e 6372 6561  tonically_increa
+0003fe60: 7369 6e67 5f69 6420 3d20 7365 7138 0a66  sing_id = seq8.f
+0003fe70: 726f 6d5f 756e 6978 7469 6d65 203d 2074  rom_unixtime = t
+0003fe80: 6f5f 7469 6d65 7374 616d 700a 0a0a 6465  o_timestamp...de
+0003fe90: 6620 756e 6978 5f74 696d 6573 7461 6d70  f unix_timestamp
+0003fea0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0003feb0: 2c20 666d 743a 204f 7074 696f 6e61 6c5b  , fmt: Optional[
+0003fec0: 2243 6f6c 756d 6e22 5d20 3d20 4e6f 6e65  "Column"] = None
+0003fed0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0003fee0: 2022 2222 0a20 2020 2043 6f6e 7665 7274   """.    Convert
+0003fef0: 7320 6120 7469 6d65 7374 616d 7020 6f72  s a timestamp or
+0003ff00: 2061 2074 696d 6573 7461 6d70 2073 7472   a timestamp str
+0003ff10: 696e 6720 746f 2055 6e69 7820 7469 6d65  ing to Unix time
+0003ff20: 2073 7461 6d70 2028 696e 2073 6563 6f6e   stamp (in secon
+0003ff30: 6473 292e 0a0a 2020 2020 4578 616d 706c  ds)...    Exampl
+0003ff40: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+0003ff50: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
+0003ff60: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0003ff70: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0003ff80: 5f64 6174 6166 7261 6d65 285b 5b22 3230  _dataframe([["20
+0003ff90: 3133 2d30 352d 3038 5432 333a 3339 3a32  13-05-08T23:39:2
+0003ffa0: 302e 3132 332d 3037 3a30 3022 5d5d 2c20  0.123-07:00"]], 
+0003ffb0: 7363 6865 6d61 3d5b 2274 735f 636f 6c22  schema=["ts_col"
+0003ffc0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0003ffd0: 662e 7365 6c65 6374 2875 6e69 785f 7469  f.select(unix_ti
+0003ffe0: 6d65 7374 616d 7028 636f 6c28 2274 735f  mestamp(col("ts_
+0003fff0: 636f 6c22 2929 2e61 6c69 6173 2822 756e  col")).alias("un
+00040000: 6978 5f74 696d 6522 2929 2e73 686f 7728  ix_time")).show(
+00040010: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00040020: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00040030: 2020 7c22 554e 4958 5f54 494d 4522 2020    |"UNIX_TIME"  
+00040040: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00040050: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00040060: 2020 7c31 3336 3830 3536 3336 3020 2020    |1368056360   
+00040070: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00040080: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00040090: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+000400a0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+000400b0: 2064 6174 655f 7061 7274 2822 6570 6f63   date_part("epoc
+000400c0: 685f 7365 636f 6e64 222c 2074 6f5f 7469  h_second", to_ti
+000400d0: 6d65 7374 616d 7028 652c 2066 6d74 2929  mestamp(e, fmt))
+000400e0: 0a                                       .
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/query_history.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/query_history.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/relational_grouped_dataframe.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/relational_grouped_dataframe.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/row.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/row.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/session.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/session.py`

 * *Files 2% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 import logging
 import os
 from array import array
 from functools import reduce
 from logging import getLogger
 from threading import RLock
 from types import ModuleType
-from typing import Any, Dict, List, Literal, Optional, Set, Tuple, Union
+from typing import Any, Dict, List, Literal, Optional, Sequence, Set, Tuple, Union
 
 import cloudpickle
 import pkg_resources
 
 from snowflake.connector import ProgrammingError, SnowflakeConnection
 from snowflake.connector.options import installed_pandas, pandas
 from snowflake.connector.pandas_tools import write_pandas
@@ -57,36 +57,37 @@
     MODULE_NAME_TO_PACKAGE_NAME_MAP,
     STAGE_PREFIX,
     SUPPORTED_TABLE_TYPES,
     PythonObjJSONEncoder,
     TempObjectType,
     calculate_checksum,
     deprecated,
-    experimental,
     get_connector_version,
     get_os_name,
     get_python_version,
     get_stage_file_prefix_length,
     get_temp_type_for_object,
     get_version,
     is_in_stored_procedure,
     normalize_remote_file_or_dir,
     parse_positional_args_to_list,
     random_name_for_temp_object,
+    strip_double_quotes_in_like_statement_in_table_name,
     unwrap_single_quote,
     unwrap_stage_location_single_quote,
     validate_object_name,
     warning,
     zip_file_or_directory_to_stream,
 )
 from snowflake.snowpark.async_job import AsyncJob
 from snowflake.snowpark.column import Column
 from snowflake.snowpark.context import _use_scoped_temp_objects
 from snowflake.snowpark.dataframe import DataFrame
 from snowflake.snowpark.dataframe_reader import DataFrameReader
+from snowflake.snowpark.exceptions import SnowparkClientException
 from snowflake.snowpark.file_operation import FileOperation
 from snowflake.snowpark.functions import (
     array_agg,
     col,
     column,
     lit,
     parse_json,
@@ -148,14 +149,22 @@
             return next(iter(_active_sessions))
         elif len(_active_sessions) > 1:
             raise SnowparkClientExceptionMessages.MORE_THAN_ONE_ACTIVE_SESSIONS()
         else:
             raise SnowparkClientExceptionMessages.SERVER_NO_DEFAULT_SESSION()
 
 
+def _get_active_sessions() -> Set["Session"]:
+    with _session_management_lock:
+        if len(_active_sessions) >= 1:
+            return _active_sessions
+        else:
+            raise SnowparkClientExceptionMessages.SERVER_NO_DEFAULT_SESSION()
+
+
 def _add_session(session: "Session") -> None:
     with _session_management_lock:
         _active_sessions.add(session)
 
 
 def _remove_session(session: "Session") -> None:
     with _session_management_lock:
@@ -201,15 +210,16 @@
     A :class:`Session` object is not thread-safe.
     """
 
     class RuntimeConfig:
         def __init__(self, session: "Session", conf: Dict[str, Any]) -> None:
             self._session = session
             self._conf = {
-                "use_constant_subquery_alias": True
+                "use_constant_subquery_alias": True,
+                "flatten_select_after_filter_and_orderby": True,
             }  # For config that's temporary/to be removed soon
             for key, val in conf.items():
                 if self.is_mutable(key):
                     self.set(key, val)
 
         def get(self, key: str, default=None) -> Any:
             if hasattr(Session, key):
@@ -275,14 +285,24 @@
             return self
 
         def create(self) -> "Session":
             """Creates a new Session."""
             session = self._create_internal(self._options.get("connection"))
             return session
 
+        def getOrCreate(self) -> "Session":
+            """Gets the last created session or creates a new one if needed."""
+            try:
+                return _get_active_session()
+            except SnowparkClientException as ex:
+                if ex.error_code == "1403":  # No session, ok lets create one
+                    return self.create()
+                else:  # Any other reason...
+                    raise ex
+
         def _create_internal(
             self, conn: Optional[SnowflakeConnection] = None
         ) -> "Session":
             # Set paramstyle to qmark by default to be consistent with previous behavior
             if "paramstyle" not in self._options:
                 self._options["paramstyle"] = "qmark"
             new_session = Session(
@@ -609,34 +629,36 @@
                     _logger.debug(
                         f"{filename} exists on {normalized_stage_location}, skipped"
                     )
                 else:
                     # local directory or .py file
                     if os.path.isdir(path) or path.endswith(".py"):
                         with zip_file_or_directory_to_stream(
-                            path, leading_path, add_init_py=True
+                            path, leading_path
                         ) as input_stream:
                             self._conn.upload_stream(
                                 input_stream=input_stream,
                                 stage_location=normalized_stage_location,
                                 dest_filename=filename,
                                 dest_prefix=prefix,
                                 source_compression="DEFLATE",
                                 compress_data=False,
                                 overwrite=True,
                                 is_in_udf=True,
+                                skip_upload_on_content_match=True,
                             )
                     # local file
                     else:
                         self._conn.upload_file(
                             path=path,
                             stage_location=normalized_stage_location,
                             dest_prefix=prefix,
                             compress_data=False,
                             overwrite=True,
+                            skip_upload_on_content_match=True,
                         )
                 resolved_stage_files.append(
                     normalize_remote_file_or_dir(
                         f"{normalized_stage_location}/{filename_with_prefix}"
                     )
                 )
 
@@ -1150,44 +1172,50 @@
             d = DataFrame(
                 self,
                 TableFunctionRelation(func_expr),
             )
         set_api_call_source(d, "Session.generator")
         return d
 
-    def sql(self, query: str) -> DataFrame:
+    def sql(self, query: str, params: Optional[Sequence[Any]] = None) -> DataFrame:
         """
         Returns a new DataFrame representing the results of a SQL query.
         You can use this method to execute a SQL statement. Note that you still
         need to call :func:`DataFrame.collect` to execute this query in Snowflake.
 
         Args:
             query: The SQL statement to execute.
+            params: binding parameters.
 
         Example::
 
             >>> # create a dataframe from a SQL query
             >>> df = session.sql("select 1/2")
             >>> # execute the query
             >>> df.collect()
             [Row(1/2=Decimal('0.500000'))]
         """
+        # TODO(SNOW-796947): Remove this limit once stored proc match parity with client
+        if is_in_stored_procedure() and params:
+            raise NotImplementedError(
+                "Bind variable in stored procedure is not supported yet"
+            )
 
         if self.sql_simplifier_enabled:
             d = DataFrame(
                 self,
                 SelectStatement(
-                    from_=SelectSQL(query, analyzer=self._analyzer),
+                    from_=SelectSQL(query, analyzer=self._analyzer, params=params),
                     analyzer=self._analyzer,
                 ),
             )
         else:
             d = DataFrame(
                 self,
-                self._plan_builder.query(query, None),
+                self._plan_builder.query(query, source_plan=None, params=params),
             )
         set_api_call_source(d, "Session.sql")
         return d
 
     @property
     def read(self) -> "DataFrameReader":
         """Returns a :class:`DataFrameReader` that you can use to read data from various
@@ -1657,15 +1685,14 @@
                 ),
             )
         else:
             df = DataFrame(self, range_plan)
         set_api_call_source(df, "Session.range")
         return df
 
-    @experimental(version="0.12.0")
     def create_async_job(self, query_id: str) -> AsyncJob:
         """
         Creates an :class:`AsyncJob` from a query ID.
 
         See also:
             :class:`AsyncJob`
         """
@@ -1962,49 +1989,53 @@
         ...     res = df.collect()
         >>> assert len(query_history.queries) == 1
         """
         query_listener = QueryHistory(self)
         self._conn.add_query_listener(query_listener)
         return query_listener
 
-    def _table_exists(self, table_name: str):
-        # implementation based upon: https://docs.snowflake.com/en/sql-reference/name-resolution.html
-        validate_object_name(table_name)
-        # note: object name could have dots, e.g, a table could be created via: create table "abc.abc" (id int)
-        # currently validate_object_name does not allow it, but if in the future we want to support the case, we need to
-        # update the implementation accordingly in this method
-        qualified_table_name = table_name.split(".")
-        if len(qualified_table_name) == 1:
-            # name in the form of "table"
-            tables = self._run_query(f"show tables like '{table_name}'")
-        elif len(qualified_table_name) == 2:
-            # name in the form of "schema.table" omitting database
-            # schema: qualified_table_name[0]
-            # table: qualified_table_name[1]
+    def _table_exists(self, raw_table_name: Union[str, Iterable[str]]):
+        """ """
+        if isinstance(raw_table_name, str):
             tables = self._run_query(
-                f"show tables like '{qualified_table_name[1]}' in schema {qualified_table_name[0]}"
-            )
-        elif len(qualified_table_name) == 3:
-            # name in the form of "database.schema.table"
-            # database: qualified_table_name[0]
-            # schema: qualified_table_name[1]
-            # table: qualified_table_name[2]
-            condition = (
-                f"database {qualified_table_name[0]}"
-                if qualified_table_name[1] == ""
-                else f"schema {qualified_table_name[0]}.{qualified_table_name[1]}"
-            )
-            tables = self._run_query(
-                f"show tables like '{qualified_table_name[2]}' in {condition}"
+                f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(raw_table_name)}'"
             )
         else:
-            # we do not support len(qualified_table_name) > 3 for now
-            raise SnowparkClientExceptionMessages.GENERAL_INVALID_OBJECT_NAME(
-                table_name
-            )
+            # implementation based upon: https://docs.snowflake.com/en/sql-reference/name-resolution.html
+            qualified_table_name = list(raw_table_name)
+            if len(qualified_table_name) == 1:
+                # name in the form of "table"
+                tables = self._run_query(
+                    f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[0])}'"
+                )
+            elif len(qualified_table_name) == 2:
+                # name in the form of "schema.table" omitting database
+                # schema: qualified_table_name[0]
+                # table: qualified_table_name[1]
+                tables = self._run_query(
+                    f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[1])}' in schema {qualified_table_name[0]}"
+                )
+            elif len(qualified_table_name) == 3:
+                # name in the form of "database.schema.table"
+                # database: qualified_table_name[0]
+                # schema: qualified_table_name[1]
+                # table: qualified_table_name[2]
+                condition = (
+                    f"database {qualified_table_name[0]}"
+                    if qualified_table_name[1] == ""
+                    else f"schema {qualified_table_name[0]}.{qualified_table_name[1]}"
+                )
+                tables = self._run_query(
+                    f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[2])}' in {condition}"
+                )
+            else:
+                # we do not support len(qualified_table_name) > 3 for now
+                raise SnowparkClientExceptionMessages.GENERAL_INVALID_OBJECT_NAME(
+                    ".".join(raw_table_name)
+                )
 
         return tables is not None and len(tables) > 0
 
     def _explain_query(self, query: str) -> Optional[str]:
         try:
             return self._run_query(f"explain using text {query}")[0][0]
         # return None for queries which can't be explained
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/stored_procedure.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/stored_procedure.py`

 * *Files 2% similar despite different names*

```diff
@@ -502,14 +502,15 @@
         replace: bool = False,
         if_not_exists: bool = False,
         parallel: int = 4,
         strict: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         source_code_display: bool = True,
+        skip_upload_on_content_match: bool = False,
     ) -> StoredProcedure:
         """
         Registers a Python function as a Snowflake Python stored procedure from a Python or zip file,
         and returns the stored procedure. Apart from ``file_path`` and ``func_name``, the input arguments
         of this method are the same as :meth:`register`. See examples in
         :class:`~snowflake.snowpark.stored_procedure.StoredProcedureRegistration`.
 
@@ -568,14 +569,17 @@
                 the stored procedure if any input is null. Instead, a null value will always be returned. Note
                 that the stored procedure might still return null for non-null inputs.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
             source_code_display: Display the source code of the stored procedure `func` as comments in the generated script.
                 The source code is dynamically generated therefore it may not be identical to how the
                 `func` is originally defined. The default is ``True``.
                 If it is ``False``, source code will not be generated or displayed.
+            skip_upload_on_content_match: When set to ``True`` and a version of source file already exists on stage, the given source
+                file will be uploaded to stage only if the contents of the current file differ from the remote file on stage. Defaults
+                to ``False``.
 
         Note::
             The type hints can still be extracted from the source Python file if they
             are provided, but currently are not working for a zip file. Therefore,
             you have to provide ``return_type`` and ``input_types`` when ``path``
             points to a zip file.
 
@@ -600,14 +604,15 @@
             replace,
             if_not_exists,
             parallel,
             strict,
             statement_params=statement_params,
             api_call_source="StoredProcedureRegistration.register_from_file",
             source_code_display=source_code_display,
+            skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
     def _do_register_sp(
         self,
         func: Union[Callable, Tuple[str, str]],
         return_type: DataType,
         input_types: List[DataType],
@@ -621,14 +626,15 @@
         strict: bool,
         *,
         source_code_display: bool = False,
         statement_params: Optional[Dict[str, str]] = None,
         execute_as: typing.Literal["caller", "owner"] = "owner",
         anonymous: bool = False,
         api_call_source: str,
+        skip_upload_on_content_match: bool = False,
     ) -> StoredProcedure:
         (
             udf_name,
             is_pandas_udf,
             is_dataframe_input,
             return_type,
             input_types,
@@ -664,14 +670,15 @@
             udf_name,
             stage_location,
             imports,
             packages,
             parallel,
             statement_params=statement_params,
             source_code_display=source_code_display,
+            skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
         anonymous_sp_sql = None
         if anonymous:
             anonymous_sp_sql = generate_anonymous_python_sp_sql(
                 return_type=return_type,
                 input_args=input_args,
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/table.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table.py`

 * *Files 2% similar despite different names*

```diff
@@ -94,16 +94,16 @@
             >>> from snowflake.snowpark.functions import when_matched, lit
             >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=["key", "value"])
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target = session.table("my_table")
             >>> source = session.create_dataframe([(10, "new")], schema=["key", "value"])
             >>> target.merge(source, (target["key"] == source["key"]) & (target["value"] == lit("too_old")), [when_matched().update({"value": source["value"]})])
             MergeResult(rows_inserted=0, rows_updated=1, rows_deleted=0)
-            >>> target.collect() # the value in the table is updated
-            [Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='new'), Row(KEY=11, VALUE='old')]
+            >>> target.sort("key", "value").collect() # the value in the table is updated
+            [Row(KEY=10, VALUE='new'), Row(KEY=10, VALUE='old'), Row(KEY=11, VALUE='old')]
 
         Note:
             An exception will be raised if this method or :meth:`WhenMatchedClause.delete`
             is called more than once on the same :class:`WhenMatchedClause` object.
         """
         if self._clause:
             raise SnowparkClientExceptionMessages.MERGE_TABLE_ACTION_ALREADY_SPECIFIED(
@@ -193,24 +193,24 @@
             >>> from snowflake.snowpark.functions import when_not_matched
             >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=["key", "value"])
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target = session.table("my_table")
             >>> source = session.create_dataframe([(12, "new")], schema=["key", "value"])
             >>> target.merge(source, target["key"] == source["key"], [when_not_matched().insert([source["key"], source["value"]])])
             MergeResult(rows_inserted=1, rows_updated=0, rows_deleted=0)
-            >>> target.collect() # the rows are inserted
-            [Row(KEY=12, VALUE='new'), Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='too_old'), Row(KEY=11, VALUE='old')]
+            >>> target.sort("key", "value").collect() # the rows are inserted
+            [Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='too_old'), Row(KEY=11, VALUE='old'), Row(KEY=12, VALUE='new')]
 
             >>> # For all such rows, insert a row into target whose key is
             >>> # assigned to the key of the not matched row.
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target.merge(source, target["key"] == source["key"], [when_not_matched().insert({"key": source["key"]})])
             MergeResult(rows_inserted=1, rows_updated=0, rows_deleted=0)
-            >>> target.collect() # the rows are inserted
-            [Row(KEY=12, VALUE=None), Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='too_old'), Row(KEY=11, VALUE='old')]
+            >>> target.sort("key", "value").collect() # the rows are inserted
+            [Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='too_old'), Row(KEY=11, VALUE='old'), Row(KEY=12, VALUE=None)]
 
         Note:
             An exception will be raised if this method is called more than once
             on the same :class:`WhenNotMatchedClause` object.
         """
         if self._clause:
             raise SnowparkClientExceptionMessages.MERGE_TABLE_ACTION_ALREADY_SPECIFIED(
@@ -396,31 +396,31 @@
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> t = session.table("my_table")
 
             >>> # update all rows in column "b" to 0 and all rows in column "a"
             >>> # to the summation of column "a" and column "b"
             >>> t.update({"b": 0, "a": t.a + t.b})
             UpdateResult(rows_updated=6, multi_joined_rows_updated=0)
-            >>> t.collect()
+            >>> t.sort("a", "b").collect()
             [Row(A=2, B=0), Row(A=3, B=0), Row(A=3, B=0), Row(A=4, B=0), Row(A=4, B=0), Row(A=5, B=0)]
 
             >>> # update all rows in column "b" to 0 where column "a" has value 1
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> t.update({"b": 0}, t["a"] == 1)
             UpdateResult(rows_updated=2, multi_joined_rows_updated=0)
-            >>> t.collect()
+            >>> t.sort("a", "b").collect()
             [Row(A=1, B=0), Row(A=1, B=0), Row(A=2, B=1), Row(A=2, B=2), Row(A=3, B=1), Row(A=3, B=2)]
 
             >>> # update all rows in column "b" to 0 where column "a" in this
             >>> # table is equal to column "a" in another dataframe
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> source_df = session.create_dataframe([1, 2, 3, 4], schema=["a"])
             >>> t.update({"b": 0}, t["a"] == source_df.a, source_df)
             UpdateResult(rows_updated=6, multi_joined_rows_updated=0)
-            >>> t.collect()
+            >>> t.sort("a", "b").collect()
             [Row(A=1, B=0), Row(A=1, B=0), Row(A=2, B=0), Row(A=2, B=0), Row(A=3, B=0), Row(A=3, B=0)]
         """
         if source:
             assert (
                 condition is not None
             ), "condition should also be provided if source is provided"
 
@@ -501,24 +501,24 @@
             >>> t.collect()
             []
 
             >>> # delete all rows where column "a" has value 1
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> t.delete(t["a"] == 1)
             DeleteResult(rows_deleted=2)
-            >>> t.collect()
+            >>> t.sort("a", "b").collect()
             [Row(A=2, B=1), Row(A=2, B=2), Row(A=3, B=1), Row(A=3, B=2)]
 
             >>> # delete all rows in this table where column "a" in this
             >>> # table is equal to column "a" in another dataframe
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> source_df = session.create_dataframe([2, 3, 4, 5], schema=["a"])
             >>> t.delete(t["a"] == source_df.a, source_df)
             DeleteResult(rows_deleted=4)
-            >>> t.collect()
+            >>> t.sort("a", "b").collect()
             [Row(A=1, B=1), Row(A=1, B=2)]
         """
         if source:
             assert (
                 condition is not None
             ), "condition should also be provided if source is provided"
 
@@ -601,16 +601,16 @@
             >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=["key", "value"])
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target = session.table("my_table")
             >>> source = session.create_dataframe([(10, "new"), (12, "new"), (13, "old")], schema=["key", "value"])
             >>> target.merge(source, (target["key"] == source["key"]) & (target["value"] == "too_old"),
             ...              [when_matched().update({"value": source["value"]}), when_not_matched().insert({"key": source["key"]})])
             MergeResult(rows_inserted=2, rows_updated=1, rows_deleted=0)
-            >>> target.collect()
-            [Row(KEY=12, VALUE=None), Row(KEY=13, VALUE=None), Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='new'), Row(KEY=11, VALUE='old')]
+            >>> target.sort("key", "value").collect()
+            [Row(KEY=10, VALUE='new'), Row(KEY=10, VALUE='old'), Row(KEY=11, VALUE='old'), Row(KEY=12, VALUE=None), Row(KEY=13, VALUE=None)]
         """
         inserted, updated, deleted = False, False, False
         merge_exprs = []
         for c in clauses:
             if isinstance(c, WhenMatchedClause):
                 if isinstance(c._clause, UpdateMergeExpression):
                     updated = True
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/table_function.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table_function.py`

 * *Files 26% similar despite different names*

```diff
@@ -12,14 +12,15 @@
     PosArgumentsTableFunction,
     TableFunctionExpression,
     TableFunctionPartitionSpecDefinition,
 )
 from snowflake.snowpark._internal.type_utils import ColumnOrName
 from snowflake.snowpark._internal.utils import validate_object_name
 from snowflake.snowpark.column import Column, _to_col_if_str
+from snowflake.snowpark.types import ArrayType, MapType
 
 from ._internal.analyzer.snowflake_plan import SnowflakePlan
 
 
 class TableFunctionCall:
     """Represents a table function call.
     A table function call has the function names, positional arguments, named arguments and the partitioning information.
@@ -35,14 +36,15 @@
         func_name: Union[str, Iterable[str]],
         *func_arguments: ColumnOrName,
         **func_named_arguments: ColumnOrName,
     ) -> None:
         if func_arguments and func_named_arguments:
             raise ValueError("A table function shouldn't have both args and named args")
         self.name: str = func_name  #: The table function name
+        self.user_visible_name: str = func_name
         self.arguments: Iterable[
             ColumnOrName
         ] = func_arguments  #: The positional arguments used to call this table function.
         self.named_arguments: Dict[
             str, ColumnOrName
         ] = func_named_arguments  #: The named arguments used to call this table function.
         self._over = False
@@ -127,14 +129,26 @@
 
         self._aliases = canon_aliases
         return self
 
     as_ = alias
 
 
+class _ExplodeFunctionCall(TableFunctionCall):
+    """Internal class to identify explode function call as a special instance of TableFunctionCall"""
+
+    def __init__(self, col: ColumnOrName) -> None:
+        super().__init__("flatten", col)
+        if isinstance(col, Column):
+            self.col = col._expression.name
+        else:
+            self.col = quote_name(col)
+        self.user_visible_name: str = "explode"
+
+
 def _create_order_by_expression(e: Union[str, Column]) -> SortOrder:
     if isinstance(e, str):
         return SortOrder(Column(e)._expression, Ascending())
     elif isinstance(e, Column):
         if isinstance(e._expression, SortOrder):
             return e._expression
         else:  # isinstance(e._expression, Expression):
@@ -229,7 +243,43 @@
             Column(col).alias(alias_col)._named()
             for col, alias_col in zip(new_cols, aliases)
         ]
     else:
         new_cols = [Column(col)._named() for col in new_cols]
 
     return old_cols, new_cols
+
+
+def _get_cols_after_explode_join(
+    func: _ExplodeFunctionCall, plan: SnowflakePlan
+) -> List:
+    explode_col_type = plan.output_dict.get(func.col, [None])[0]
+
+    cols = []
+    if isinstance(explode_col_type, ArrayType):
+        if func._aliases:
+            if len(func._aliases) != 1:
+                raise ValueError(
+                    f"Invalid number of aliases given for explode. Expecting 1, got {len(func._aliases)}"
+                )
+            cols.append(Column("VALUE").alias(func._aliases[0])._named())
+        else:
+            cols.append(Column("VALUE")._named())
+    elif isinstance(explode_col_type, MapType):
+        if func._aliases:
+            if len(func._aliases) != 2:
+                raise ValueError(
+                    f"Invalid number of aliases given for explode. Expecting 2, got {len(func._aliases)}"
+                )
+            cols.extend(
+                [
+                    Column("KEY").as_(func._aliases[0])._named(),
+                    Column("VALUE").as_(func._aliases[1])._named(),
+                ]
+            )
+        else:
+            cols.extend([Column("KEY")._named(), Column("VALUE")._named()])
+    else:
+        raise ValueError(
+            f"Invalid column type for explode({func.col}). Expected ArrayType() or MapType(), got {explode_col_type}"
+        )
+    return cols
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/types.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/types.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/udf.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udf.py`

 * *Files 1% similar despite different names*

```diff
@@ -96,15 +96,15 @@
 
         return Column(self._create_udf_expression(exprs))
 
     def _create_udf_expression(self, exprs: List[Expression]) -> SnowflakeUDF:
         if len(exprs) != len(self._input_types):
             raise ValueError(
                 f"Incorrect number of arguments passed to the UDF:"
-                f" Expected: {len(exprs)}, Found: {len(self._input_types)}"
+                f" Expected: {len(self._input_types)}, Found: {len(exprs)}"
             )
         return SnowflakeUDF(
             self.name,
             exprs,
             self._return_type,
             nullable=self._is_return_nullable,
             api_call_source="UserDefinedFunction.__call__",
@@ -623,14 +623,15 @@
         if_not_exists: bool = False,
         parallel: int = 4,
         strict: bool = False,
         secure: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         source_code_display: bool = True,
+        skip_upload_on_content_match: bool = False,
     ) -> UserDefinedFunction:
         """
         Registers a Python function as a Snowflake Python UDF from a Python or zip file,
         and returns the UDF. Apart from ``file_path`` and ``func_name``, the input arguments
         of this method are the same as :meth:`register`. See examples in
         :class:`~snowflake.snowpark.udf.UDFRegistration`.
 
@@ -696,14 +697,17 @@
             secure: Whether the created UDF is secure. For more information about secure functions,
                 see `Secure UDFs <https://docs.snowflake.com/en/sql-reference/udf-secure.html>`_.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
             source_code_display: Display the source code of the UDF `func` as comments in the generated script.
                 The source code is dynamically generated therefore it may not be identical to how the
                 `func` is originally defined. The default is ``True``.
                 If it is ``False``, source code will not be generated or displayed.
+            skip_upload_on_content_match: When set to ``True`` and a version of source file already exists on stage, the given source
+                file will be uploaded to stage only if the contents of the current file differ from the remote file on stage. Defaults
+                to ``False``.
 
         Note::
             The type hints can still be extracted from the source Python file if they
             are provided, but currently are not working for a zip file. Therefore,
             you have to provide ``return_type`` and ``input_types`` when ``path``
             points to a zip file.
 
@@ -729,14 +733,15 @@
             if_not_exists,
             parallel,
             strict,
             secure,
             statement_params=statement_params,
             source_code_display=source_code_display,
             api_call_source="UDFRegistration.register_from_file",
+            skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
     def _do_register_udf(
         self,
         func: Union[Callable, Tuple[str, str]],
         return_type: Optional[DataType],
         input_types: Optional[List[DataType]],
@@ -751,14 +756,15 @@
         from_pandas_udf_function: bool = False,
         strict: bool = False,
         secure: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         source_code_display: bool = True,
         api_call_source: str,
+        skip_upload_on_content_match: bool = False,
     ) -> UserDefinedFunction:
         # get the udf name, return and input types
         (
             udf_name,
             is_pandas_udf,
             is_dataframe_input,
             return_type,
@@ -797,14 +803,15 @@
             packages,
             parallel,
             is_pandas_udf,
             is_dataframe_input,
             max_batch_size,
             statement_params=statement_params,
             source_code_display=source_code_display,
+            skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
         raised = False
         try:
             create_python_udf_or_sp(
                 session=self._session,
                 return_type=return_type,
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/udtf.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udtf.py`

 * *Files 2% similar despite different names*

```diff
@@ -442,14 +442,15 @@
         replace: bool = False,
         if_not_exists: bool = False,
         parallel: int = 4,
         strict: bool = False,
         secure: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
+        skip_upload_on_content_match: bool = False,
     ) -> UserDefinedTableFunction:
         """
         Registers a Python class as a Snowflake Python UDTF from a Python or zip file,
         and returns the UDTF. Apart from ``file_path`` and ``func_name``, the input arguments
         of this method are the same as :meth:`register`. See examples in
         :class:`~snowflake.snowpark.udtf.UDTFRegistration`.
 
@@ -507,14 +508,17 @@
                 large UDTF files.
             strict: Whether the created UDTF is strict. A strict UDTF will not invoke the UDTF if any input is
                 null. Instead, a null value will always be returned for that row. Note that the UDTF might
                 still return null for non-null inputs.
             secure: Whether the created UDTF is secure. For more information about secure functions,
                 see `Secure UDFs <https://docs.snowflake.com/en/sql-reference/udf-secure.html>`_.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
+            skip_upload_on_content_match: When set to ``True`` and a version of source file already exists on stage, the given source
+                file will be uploaded to stage only if the contents of the current file differ from the remote file on stage. Defaults
+                to ``False``.
 
         Note::
             The type hints can still be extracted from the source Python file if they
             are provided, but currently are not working for a zip file. Therefore,
             you have to provide ``output_schema`` and ``input_types`` when ``path``
             points to a zip file.
 
@@ -539,14 +543,15 @@
             replace,
             if_not_exists,
             parallel,
             strict,
             secure,
             statement_params=statement_params,
             api_call_source="UDTFRegistration.register_from_file",
+            skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
     def _do_register_udtf(
         self,
         handler: Union[Callable, Tuple[str, str]],
         output_schema: Union[StructType, Iterable[str]],
         input_types: Optional[List[DataType]],
@@ -558,14 +563,15 @@
         if_not_exists: bool = False,
         parallel: int = 4,
         strict: bool = False,
         secure: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         api_call_source: str,
+        skip_upload_on_content_match: bool = False,
     ) -> UserDefinedTableFunction:
         if not isinstance(output_schema, (Iterable, StructType)):
             raise ValueError(
                 f"'output_schema' must be a list of column names or StructType instance to create a UDTF. Got {type(output_schema)}."
             )
         if isinstance(output_schema, StructType):
             _validate_output_schema_names(output_schema.names)
@@ -664,14 +670,15 @@
             stage_location,
             imports,
             packages,
             parallel,
             False,
             False,
             statement_params=statement_params,
+            skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
         raised = False
         try:
             create_python_udf_or_sp(
                 session=self._session,
                 return_type=output_schema,
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake/snowpark/window.py` & `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/window.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/PKG-INFO` & `snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: snowflake-snowpark-python
-Version: 1.3.0
+Version: 1.4.0
 Summary: Snowflake Snowpark for Python
 Home-page: https://www.snowflake.com/
 Author: Snowflake, Inc
 Author-email: snowflake-python-libraries-dl@snowflake.com
 License: Apache License, Version 2.0
 Project-URL: Documentation, https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html
 Project-URL: Source, https://github.com/snowflakedb/snowpark-python
@@ -130,20 +130,49 @@
 [snowflake lab sample code]: https://github.com/Snowflake-Labs/snowpark-python-demos
 [samples]: https://github.com/snowflakedb/snowpark-python/blob/main/README.md#samples
 [contributing]: https://github.com/snowflakedb/snowpark-python/blob/main/CONTRIBUTING.md
 
 
 # Release History
 
+## 1.4.0 (2023-04-24)
+
+### New Features
+
+- Added support for `session.getOrCreate`.
+- Added support for alias `Column.getField`.
+- Added support for new functions in `snowflake.snowpark.functions`:
+  - `date_add` and `date_sub` to make add and subtract operations easier.
+  - `daydiff`
+  - `explode`
+  - `array_distinct`.
+  - `regexp_extract`.
+  - `struct`.
+  - `format_number`.
+  - `bround`.
+  - `substring_index`
+- Added parameter `skip_upload_on_content_match` when creating UDFs, UDTFs and stored procedures using `register_from_file` to skip uploading files to a stage if the same version of the files are already on the stage.
+- Added support for `DataFrame.save_as_table` method to take table names that contain dots.
+- Flattened generated SQL when `DataFrame.filter()` or `DataFrame.order_by()` is followed by a projection statement (e.g. `DataFrame.select()`, `DataFrame.with_column()`).
+- Added support for creating dynamic tables _(in private preview)_ using `Dataframe.create_or_replace_dynamic_table`.
+- Added an optional argument `params` in `session.sql()` to support binding variables. Note that this is not supported in stored procedures yet.
+
+### Bug Fixes
+
+- Fixed a bug in `strtok_to_array` where an exception was thrown when a delimiter was passed in.
+- Fixed a bug in `session.add_import` where the module had the same namespace as other dependencies.
+
 ## 1.3.0 (2023-03-28)
 
 ### New Features
 
 - Added support for `delimiters` parameter in `functions.initcap()`.
 - Added support for `functions.hash()` to accept a variable number of input expressions.
+- Added API `Session.RuntimeConfig` for getting/setting/checking the mutability of any runtime configuration.
+- Added support managing case sensitivity in `Row` results from `DataFrame.collect` using `case_sensitive` parameter.
 - Added API `Session.conf` for getting, setting or checking the mutability of any runtime configuration.
 - Added support for managing case sensitivity in `Row` results from `DataFrame.collect` using `case_sensitive` parameter.
 - Added indexer support for `snowflake.snowpark.types.StructType`.
 - Added a keyword argument `log_on_exception` to `Dataframe.collect` and `Dataframe.collect_no_wait` to optionally disable error logging for SQL exceptions.
 
 ### Bug Fixes
 
@@ -152,263 +181,295 @@
 
 ### Improvements
 
 - Simplified JOIN queries to use constant subquery aliases (`SNOWPARK_LEFT`, `SNOWPARK_RIGHT`) by default. Users can disable this at runtime with `session.conf.set('use_constant_subquery_alias', False)` to use randomly generated alias names instead.
 - Allowed specifying statement parameters in `session.call()`.
 - Enabled the uploading of large pandas DataFrames in stored procedures by defaulting to a chunk size of 100,000 rows.
 
-
 ## 1.2.0 (2023-03-02)
 
 ### New Features
 
 - Added support for displaying source code as comments in the generated scripts when registering stored procedures. This
-is enabled by default, turn off by specifying `source_code_display=False` at registration.
+  is enabled by default, turn off by specifying `source_code_display=False` at registration.
 - Added a parameter `if_not_exists` when creating a UDF, UDTF or Stored Procedure from Snowpark Python to ignore creating the specified function or procedure if it already exists.
 - Accept integers when calling `snowflake.snowpark.functions.get` to extract value from array.
 - Added `functions.reverse` in functions to open access to Snowflake built-in function
-[reverse](https://docs.snowflake.com/en/sql-reference/functions/reverse).
+  [reverse](https://docs.snowflake.com/en/sql-reference/functions/reverse).
 - Added parameter `require_scoped_url` in snowflake.snowflake.files.SnowflakeFile.open() `(in Private Preview)` to replace `is_owner_file` is marked for deprecation.
 
 ### Bug Fixes
 
 - Fixed a bug that overwrote `paramstyle` to `qmark` when creating a Snowpark session.
 - Fixed a bug where `df.join(..., how="cross")` fails with `SnowparkJoinException: (1112): Unsupported using join type 'Cross'`.
 - Fixed a bug where querying a `DataFrame` column created from chained function calls used a wrong column name.
 
 ## 1.1.0 (2023-01-26)
 
 ### New Features:
+
 - Added `asc`, `asc_nulls_first`, `asc_nulls_last`, `desc`, `desc_nulls_first`, `desc_nulls_last`, `date_part` and `unix_timestamp` in functions.
 - Added the property `DataFrame.dtypes` to return a list of column name and data type pairs.
 - Added the following aliases:
   - `functions.expr()` for `functions.sql_expr()`.
   - `functions.date_format()` for `functions.to_date()`.
   - `functions.monotonically_increasing_id()` for `functions.seq8()`
   - `functions.from_unixtime()` for `functions.to_timestamp()`
 
 ### Bug Fixes:
+
 - Fixed a bug in SQL simplifier that didn’t handle Column alias and join well in some cases. See https://github.com/snowflakedb/snowpark-python/issues/658 for details.
 - Fixed a bug in SQL simplifier that generated wrong column names for function calls, NaN and INF.
 
 ### Improvements
-- The session parameter `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` is `True` after Snowflake 7.3 was released. In snowpark-python, `session.sql_simplifier_enabled` reads the value of `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` by default, meaning that the SQL simplfier is enabled by default after the Snowflake 7.3 release. To turn this off, set `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` in Snowflake to `False` or run `session.sql_simplifier_enabled = False` from Snowpark. It is recommended to use the SQL simplifier because it helps to generate more concise SQL.
 
+- The session parameter `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` is `True` after Snowflake 7.3 was released. In snowpark-python, `session.sql_simplifier_enabled` reads the value of `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` by default, meaning that the SQL simplfier is enabled by default after the Snowflake 7.3 release. To turn this off, set `PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER` in Snowflake to `False` or run `session.sql_simplifier_enabled = False` from Snowpark. It is recommended to use the SQL simplifier because it helps to generate more concise SQL.
 
 ## 1.0.0 (2022-11-01)
+
 ### New Features
+
 - Added `Session.generator()` to create a new `DataFrame` using the Generator table function.
 - Added a parameter `secure` to the functions that create a secure UDF or UDTF.
 
-
 ## 0.12.0 (2022-10-14)
+
 ### New Features
+
 - Added new APIs for async job:
   - `Session.create_async_job()` to create an `AsyncJob` instance from a query id.
   - `AsyncJob.result()` now accepts argument `result_type` to return the results in different formats.
   - `AsyncJob.to_df()` returns a `DataFrame` built from the result of this asynchronous job.
   - `AsyncJob.query()` returns the SQL text of the executed query.
 - `DataFrame.agg()` and `RelationalGroupedDataFrame.agg()` now accept variable-length arguments.
 - Added parameters `lsuffix` and `rsuffix` to `DataFram.join()` and `DataFrame.cross_join()` to conveniently rename overlapping columns.
 - Added `Table.drop_table()` so you can drop the temp table after `DataFrame.cache_result()`. `Table` is also a context manager so you can use the `with` statement to drop the cache temp table after use.
 - Added `Session.use_secondary_roles()`.
 - Added functions `first_value()` and `last_value()`. (contributed by @chasleslr)
 - Added `on` as an alias for `using_columns` and `how` as an alias for `join_type` in `DataFrame.join()`.
 
 ### Bug Fixes
+
 - Fixed a bug in `Session.create_dataframe()` that raised an error when `schema` names had special characters.
 - Fixed a bug in which options set in `Session.read.option()` were not passed to `DataFrame.copy_into_table()` as default values.
 - Fixed a bug in which `DataFrame.copy_into_table()` raises an error when a copy option has single quotes in the value.
 
 ## 0.11.0 (2022-09-28)
 
 ### Behavior Changes
+
 - `Session.add_packages()` now raises `ValueError` when the version of a package cannot be found in Snowflake Anaconda channel. Previously, `Session.add_packages()` succeeded, and a `SnowparkSQLException` exception was raised later in the UDF/SP registration step.
 
 ### New Features:
+
 - Added method `FileOperation.get_stream()` to support downloading stage files as stream.
 - Added support in `functions.ntiles()` to accept int argument.
 - Added the following aliases:
   - `functions.call_function()` for `functions.call_builtin()`.
   - `functions.function()` for `functions.builtin()`.
   - `DataFrame.order_by()` for `DataFrame.sort()`
   - `DataFrame.orderBy()` for `DataFrame.sort()`
 - Improved `DataFrame.cache_result()` to return a more accurate `Table` class instead of a `DataFrame` class.
 - Added support to allow `session` as the first argument when calling `StoredProcedure`.
 
 ### Improvements
+
 - Improved nested query generation by flattening queries when applicable.
   - This improvement could be enabled by setting `Session.sql_simplifier_enabled = True`.
   - `DataFrame.select()`, `DataFrame.with_column()`, `DataFrame.drop()` and other select-related APIs have more flattened SQLs.
   - `DataFrame.union()`, `DataFrame.union_all()`, `DataFrame.except_()`, `DataFrame.intersect()`, `DataFrame.union_by_name()` have flattened SQLs generated when multiple set operators are chained.
 - Improved type annotations for async job APIs.
 
 ### Bug Fixes
+
 - Fixed a bug in which `Table.update()`, `Table.delete()`, `Table.merge()` try to reference a temp table that does not exist.
 
 ## 0.10.0 (2022-09-16)
 
 ### New Features:
+
 - Added experimental APIs for evaluating Snowpark dataframes with asynchronous queries:
   - Added keyword argument `block` to the following action APIs on Snowpark dataframes (which execute queries) to allow asynchronous evaluations:
     - `DataFrame.collect()`, `DataFrame.to_local_iterator()`, `DataFrame.to_pandas()`, `DataFrame.to_pandas_batches()`, `DataFrame.count()`, `DataFrame.first()`.
     - `DataFrameWriter.save_as_table()`, `DataFrameWriter.copy_into_location()`.
     - `Table.delete()`, `Table.update()`, `Table.merge()`.
   - Added method `DataFrame.collect_nowait()` to allow asynchronous evaluations.
   - Added class `AsyncJob` to retrieve results from asynchronously executed queries and check their status.
 - Added support for `table_type` in `Session.write_pandas()`. You can now choose from these `table_type` options: `"temporary"`, `"temp"`, and `"transient"`.
 - Added support for using Python structured data (`list`, `tuple` and `dict`) as literal values in Snowpark.
 - Added keyword argument `execute_as` to `functions.sproc()` and `session.sproc.register()` to allow registering a stored procedure as a caller or owner.
 - Added support for specifying a pre-configured file format when reading files from a stage in Snowflake.
 
 ### Improvements:
+
 - Added support for displaying details of a Snowpark session.
 
 ### Bug Fixes:
+
 - Fixed a bug in which `DataFrame.copy_into_table()` and `DataFrameWriter.save_as_table()` mistakenly created a new table if the table name is fully qualified, and the table already exists.
 
 ### Deprecations:
+
 - Deprecated keyword argument `create_temp_table` in `Session.write_pandas()`.
 - Deprecated invoking UDFs using arguments wrapped in a Python list or tuple. You can use variable-length arguments without a list or tuple.
 
 ### Dependency updates
+
 - Updated ``snowflake-connector-python`` to 2.7.12.
 
 ## 0.9.0 (2022-08-30)
 
 ### New Features:
+
 - Added support for displaying source code as comments in the generated scripts when registering UDFs.
-This feature is turned on by default. To turn it off, pass the new keyword argument `source_code_display` as `False` when calling `register()` or `@udf()`.
+  This feature is turned on by default. To turn it off, pass the new keyword argument `source_code_display` as `False` when calling `register()` or `@udf()`.
 - Added support for calling table functions from `DataFrame.select()`, `DataFrame.with_column()` and `DataFrame.with_columns()` which now take parameters of type `table_function.TableFunctionCall` for columns.
 - Added keyword argument `overwrite` to `session.write_pandas()` to allow overwriting contents of a Snowflake table with that of a Pandas DataFrame.
 - Added keyword argument `column_order` to `df.write.save_as_table()` to specify the matching rules when inserting data into table in append mode.
 - Added method `FileOperation.put_stream()` to upload local files to a stage via file stream.
 - Added methods `TableFunctionCall.alias()` and `TableFunctionCall.as_()` to allow aliasing the names of columns that come from the output of table function joins.
 - Added function `get_active_session()` in module `snowflake.snowpark.context` to get the current active Snowpark session.
 
 ### Bug Fixes:
+
 - Fixed a bug in which batch insert should not raise an error when `statement_params` is not passed to the function.
 - Fixed a bug in which column names should be quoted when `session.create_dataframe()` is called with dicts and a given schema.
 - Fixed a bug in which creation of table should be skipped if the table already exists and is in append mode when calling `df.write.save_as_table()`.
 - Fixed a bug in which third-party packages with underscores cannot be added when registering UDFs.
 
 ### Improvements:
+
 - Improved function `function.uniform()` to infer the types of inputs `max_` and `min_` and cast the limits to `IntegerType` or `FloatType` correspondingly.
 
 ## 0.8.0 (2022-07-22)
 
 ### New Features:
+
 - Added keyword only argument `statement_params` to the following methods to allow for specifying statement level parameters:
   - `collect`, `to_local_iterator`, `to_pandas`, `to_pandas_batches`,
-  `count`, `copy_into_table`, `show`, `create_or_replace_view`, `create_or_replace_temp_view`, `first`, `cache_result`
-  and `random_split` on class `snowflake.snowpark.Dateframe`.
+    `count`, `copy_into_table`, `show`, `create_or_replace_view`, `create_or_replace_temp_view`, `first`, `cache_result`
+    and `random_split` on class `snowflake.snowpark.Dateframe`.
   - `update`, `delete` and `merge` on class `snowflake.snowpark.Table`.
   - `save_as_table` and `copy_into_location` on class `snowflake.snowpark.DataFrameWriter`.
   - `approx_quantile`, `statement_params`, `cov` and `crosstab` on class `snowflake.snowpark.DataFrameStatFunctions`.
   - `register` and `register_from_file` on class `snowflake.snowpark.udf.UDFRegistration`.
   - `register` and `register_from_file` on class `snowflake.snowpark.udtf.UDTFRegistration`.
   - `register` and `register_from_file` on class `snowflake.snowpark.stored_procedure.StoredProcedureRegistration`.
   - `udf`, `udtf` and `sproc` in `snowflake.snowpark.functions`.
 - Added support for `Column` as an input argument to `session.call()`.
 - Added support for `table_type` in `df.write.save_as_table()`. You can now choose from these `table_type` options: `"temporary"`, `"temp"`, and `"transient"`.
 
 ### Improvements:
+
 - Added validation of object name in `session.use_*` methods.
 - Updated the query tag in SQL to escape it when it has special characters.
 - Added a check to see if Anaconda terms are acknowledged when adding missing packages.
 
 ### Bug Fixes:
+
 - Fixed the limited length of the string column in `session.create_dataframe()`.
 - Fixed a bug in which `session.create_dataframe()` mistakenly converted 0 and `False` to `None` when the input data was only a list.
 - Fixed a bug in which calling `session.create_dataframe()` using a large local dataset sometimes created a temp table twice.
 - Aligned the definition of `function.trim()` with the SQL function definition.
 - Fixed an issue where snowpark-python would hang when using the Python system-defined (built-in function) `sum` vs. the Snowpark `function.sum()`.
 
 ### Deprecations:
-- Deprecated keyword argument `create_temp_table` in `df.write.save_as_table()`.
 
+- Deprecated keyword argument `create_temp_table` in `df.write.save_as_table()`.
 
 ## 0.7.0 (2022-05-25)
 
 ### New Features:
+
 - Added support for user-defined table functions (UDTFs).
   - Use function `snowflake.snowpark.functions.udtf()` to register a UDTF, or use it as a decorator to register the UDTF.
     - You can also use `Session.udtf.register()` to register a UDTF.
   - Use `Session.udtf.register_from_file()` to register a UDTF from a Python file.
 - Updated APIs to query a table function, including both Snowflake built-in table functions and UDTFs.
   - Use function `snowflake.snowpark.functions.table_function()` to create a callable representing a table function and use it to call the table function in a query.
   - Alternatively, use function `snowflake.snowpark.functions.call_table_function()` to call a table function.
   - Added support for `over` clause that specifies `partition by` and `order by` when lateral joining a table function.
   - Updated `Session.table_function()` and `DataFrame.join_table_function()` to accept `TableFunctionCall` instances.
 
 ### Breaking Changes:
+
 - When creating a function with `functions.udf()` and `functions.sproc()`, you can now specify an empty list for the `imports` or `packages` argument to indicate that no import or package is used for this UDF or stored procedure. Previously, specifying an empty list meant that the function would use session-level imports or packages.
 - Improved the `__repr__` implementation of data types in `types.py`. The unused `type_name` property has been removed.
 - Added a Snowpark-specific exception class for SQL errors. This replaces the previous `ProgrammingError` from the Python connector.
 
 ### Improvements:
+
 - Added a lock to a UDF or UDTF when it is called for the first time per thread.
 - Improved the error message for pickling errors that occurred during UDF creation.
 - Included the query ID when logging the failed query.
 
 ### Bug Fixes:
+
 - Fixed a bug in which non-integral data (such as timestamps) was occasionally converted to integer when calling `DataFrame.to_pandas()`.
 - Fixed a bug in which `DataFrameReader.parquet()` failed to read a parquet file when its column contained spaces.
 - Fixed a bug in which `DataFrame.copy_into_table()` failed when the dataframe is created by reading a file with inferred schemas.
 
 ### Deprecations
+
 `Session.flatten()` and `DataFrame.flatten()`.
 
 ### Dependency Updates:
-- Restricted the version of `cloudpickle` <= `2.0.0`.
 
+- Restricted the version of `cloudpickle` <= `2.0.0`.
 
 ## 0.6.0 (2022-04-27)
 
 ### New Features:
+
 - Added support for vectorized UDFs with the input as a Pandas DataFrame or Pandas Series and the output as a Pandas Series. This improves the performance of UDFs in Snowpark.
 - Added support for inferring the schema of a DataFrame by default when it is created by reading a Parquet, Avro, or ORC file in the stage.
 - Added functions `current_session()`, `current_statement()`, `current_user()`, `current_version()`, `current_warehouse()`, `date_from_parts()`, `date_trunc()`, `dayname()`, `dayofmonth()`, `dayofweek()`, `dayofyear()`, `grouping()`, `grouping_id()`, `hour()`, `last_day()`, `minute()`, `next_day()`, `previous_day()`, `second()`, `month()`, `monthname()`, `quarter()`, `year()`, `current_database()`, `current_role()`, `current_schema()`, `current_schemas()`, `current_region()`, `current_avaliable_roles()`, `add_months()`, `any_value()`, `bitnot()`, `bitshiftleft()`, `bitshiftright()`, `convert_timezone()`, `uniform()`, `strtok_to_array()`, `sysdate()`, `time_from_parts()`,  `timestamp_from_parts()`, `timestamp_ltz_from_parts()`, `timestamp_ntz_from_parts()`, `timestamp_tz_from_parts()`, `weekofyear()`, `percentile_cont()` to `snowflake.snowflake.functions`.
 
 ### Breaking Changes:
+
 - Expired deprecations:
   - Removed the following APIs that were deprecated in 0.4.0: `DataFrame.groupByGroupingSets()`, `DataFrame.naturalJoin()`, `DataFrame.joinTableFunction`, `DataFrame.withColumns()`, `Session.getImports()`, `Session.addImport()`, `Session.removeImport()`, `Session.clearImports()`, `Session.getSessionStage()`, `Session.getDefaultDatabase()`, `Session.getDefaultSchema()`, `Session.getCurrentDatabase()`, `Session.getCurrentSchema()`, `Session.getFullyQualifiedCurrentSchema()`.
 
 ### Improvements:
+
 - Added support for creating an empty `DataFrame` with a specific schema using the `Session.create_dataframe()` method.
 - Changed the logging level from `INFO` to `DEBUG` for several logs (e.g., the executed query) when evaluating a dataframe.
 - Improved the error message when failing to create a UDF due to pickle errors.
 
 ### Bug Fixes:
+
 - Removed pandas hard dependencies in the `Session.create_dataframe()` method.
 
 ### Dependency Updates:
-- Added `typing-extension` as a new dependency with the version >= `4.1.0`.
 
+- Added `typing-extension` as a new dependency with the version >= `4.1.0`.
 
 ## 0.5.0 (2022-03-22)
 
 ### New Features
+
 - Added stored procedures API.
   - Added `Session.sproc` property and `sproc()` to `snowflake.snowpark.functions`, so you can register stored procedures.
   - Added `Session.call` to call stored procedures by name.
 - Added `UDFRegistration.register_from_file()` to allow registering UDFs from Python source files or zip files directly.
 - Added `UDFRegistration.describe()` to describe a UDF.
 - Added `DataFrame.random_split()` to provide a way to randomly split a dataframe.
 - Added functions `md5()`, `sha1()`, `sha2()`, `ascii()`, `initcap()`, `length()`, `lower()`, `lpad()`, `ltrim()`, `rpad()`, `rtrim()`, `repeat()`, `soundex()`, `regexp_count()`, `replace()`, `charindex()`, `collate()`, `collation()`, `insert()`, `left()`, `right()`, `endswith()` to `snowflake.snowpark.functions`.
 - Allowed `call_udf()` to accept literal values.
 - Provided a `distinct` keyword in `array_agg()`.
 
 ### Bug Fixes:
+
 - Fixed an issue that caused `DataFrame.to_pandas()` to have a string column if `Column.cast(IntegerType())` was used.
 - Fixed a bug in `DataFrame.describe()` when there is more than one string column.
 
 ## 0.4.0 (2022-02-15)
 
 ### New Features
+
 - You can now specify which Anaconda packages to use when defining UDFs.
   - Added `add_packages()`, `get_packages()`, `clear_packages()`, and `remove_package()`, to class `Session`.
   - Added `add_requirements()` to `Session` so you can use a requirements file to specify which packages this session will use.
   - Added parameter `packages` to function `snowflake.snowpark.functions.udf()` and method `UserDefinedFunction.register()` to indicate UDF-level Anaconda package dependencies when creating a UDF.
   - Added parameter `imports` to `snowflake.snowpark.functions.udf()` and `UserDefinedFunction.register()` to specify UDF-level code imports.
 - Added a parameter `session` to function `udf()` and `UserDefinedFunction.register()` so you can specify which session to use to create a UDF if you have multiple sessions.
 - Added types `Geography` and `Variant` to `snowflake.snowpark.types` to be used as type hints for Geography and Variant data when defining a UDF.
@@ -428,49 +489,57 @@
 - Added `DataFrame.unpivot()`.
 - Added `Column.within_group()` for sorting the rows by columns with some aggregation functions.
 - Added functions `listagg()`, `mode()`, `div0()`, `acos()`, `asin()`, `atan()`, `atan2()`, `cos()`, `cosh()`, `sin()`, `sinh()`, `tan()`, `tanh()`, `degrees()`, `radians()`, `round()`, `trunc()`, and `factorial()` to `snowflake.snowflake.functions`.
 - Added an optional argument `ignore_nulls` in function `lead()` and `lag()`.
 - The `condition` parameter of function `when()` and `iff()` now accepts SQL expressions.
 
 ### Improvements
+
 - All function and method names have been renamed to use the snake case naming style, which is more Pythonic. For convenience, some camel case names are kept as aliases to the snake case APIs. It is recommended to use the snake case APIs.
   - Deprecated these methods on class `Session` and replaced them with their snake case equivalents: `getImports()`, `addImports()`, `removeImport()`, `clearImports()`, `getSessionStage()`, `getDefaultSchema()`, `getDefaultSchema()`, `getCurrentDatabase()`, `getFullyQualifiedCurrentSchema()`.
   - Deprecated these methods on class `DataFrame` and replaced them with their snake case equivalents: `groupingByGroupingSets()`, `naturalJoin()`, `withColumns()`, `joinTableFunction()`.
 - Property `DataFrame.columns` is now consistent with `DataFrame.schema.names` and the Snowflake database `Identifier Requirements`.
 - `Column.__bool__()` now raises a `TypeError`. This will ban the use of logical operators `and`, `or`, `not` on `Column` object, for instance `col("a") > 1 and col("b") > 2` will raise the `TypeError`. Use `(col("a") > 1) & (col("b") > 2)` instead.
 - Changed `PutResult` and `GetResult` to subclass `NamedTuple`.
 - Fixed a bug which raised an error when the local path or stage location has a space or other special characters.
 - Changed `DataFrame.describe()` so that non-numeric and non-string columns are ignored instead of raising an exception.
 
 ### Dependency updates
+
 - Updated ``snowflake-connector-python`` to 2.7.4.
 
 ## 0.3.0 (2022-01-09)
+
 ### New Features
+
 - Added `Column.isin()`, with an alias `Column.in_()`.
 - Added `Column.try_cast()`, which is a special version of `cast()`. It tries to cast a string expression to other types and returns `null` if the cast is not possible.
 - Added `Column.startswith()` and `Column.substr()` to process string columns.
 - `Column.cast()` now also accepts a `str` value to indicate the cast type in addition to a `DataType` instance.
 - Added `DataFrame.describe()` to summarize stats of a `DataFrame`.
 - Added `DataFrame.explain()` to print the query plan of a `DataFrame`.
 - `DataFrame.filter()` and `DataFrame.select_expr()` now accepts a sql expression.
 - Added a new `bool` parameter `create_temp_table` to methods `DataFrame.saveAsTable()` and `Session.write_pandas()` to optionally create a temp table.
 - Added `DataFrame.minus()` and `DataFrame.subtract()` as aliases to `DataFrame.except_()`.
 - Added `regexp_replace()`, `concat()`, `concat_ws()`, `to_char()`, `current_timestamp()`, `current_date()`, `current_time()`, `months_between()`, `cast()`, `try_cast()`, `greatest()`, `least()`, and `hash()` to module `snowflake.snowpark.functions`.
 
 ### Bug Fixes
+
 - Fixed an issue where `Session.createDataFrame(pandas_df)` and `Session.write_pandas(pandas_df)` raise an exception when the `Pandas DataFrame` has spaces in the column name.
 - `DataFrame.copy_into_table()` sometimes prints an `error` level log entry while it actually works. It's fixed now.
 - Fixed an API docs issue where some `DataFrame` APIs are missing from the docs.
 
 ### Dependency updates
+
 - Update ``snowflake-connector-python`` to 2.7.2, which upgrades ``pyarrow`` dependency to 6.0.x. Refer to the [python connector 2.7.2 release notes](https://pypi.org/project/snowflake-connector-python/2.7.2/) for more details.
 
 ## 0.2.0 (2021-12-02)
+
 ### New Features
+
 - Updated the `Session.createDataFrame()` method for creating a `DataFrame` from a Pandas DataFrame.
 - Added the `Session.write_pandas()` method for writing a `Pandas DataFrame` to a table in Snowflake and getting a `Snowpark DataFrame` object back.
 - Added new classes and methods for calling window functions.
 - Added the new functions `cume_dist()`, to find the cumulative distribution of a value with regard to other values within a window partition,
   and `row_number()`, which returns a unique row number for each row within a window partition.
 - Added functions for computing statistics for DataFrames in the `DataFrameStatFunctions` class.
 - Added functions for handling missing values in a DataFrame in the `DataFrameNaFunctions` class.
@@ -481,18 +550,20 @@
 - Added the `DataFrame.copy_into_table()`
   method for loading data from files in a stage into a table.
 - In CASE expressions, the functions `when()` and `otherwise()`
   now accept Python types in addition to `Column` objects.
 - When you register a UDF you can now optionally set the `replace` parameter to `True` to overwrite an existing UDF with the same name.
 
 ### Improvements
+
 - UDFs are now compressed before they are uploaded to the server. This makes them about 10 times smaller, which can help
   when you are using large ML model files.
 - When the size of a UDF is less than 8196 bytes, it will be uploaded as in-line code instead of uploaded to a stage.
 
 ### Bug Fixes
+
 - Fixed an issue where the statement `df.select(when(col("a") == 1, 4).otherwise(col("a"))), [Row(4), Row(2), Row(3)]` raised an exception.
 - Fixed an issue where `df.toPandas()` raised an exception when a DataFrame was created from large local data.
 
 ## 0.1.0 (2021-10-26)
 
 Start of Private Preview
```

### Comparing `snowflake-snowpark-python-1.3.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt` & `snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt`

 * *Files identical despite different names*

