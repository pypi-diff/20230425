# Comparing `tmp/odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3-py3-none-any.whl.zip` & `tmp/odoo14_addon_stock_move_source_relocate-14.0.1.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,24 +1,25 @@
-Zip file size: 33779 bytes, number of entries: 22
--rw-r--r--  2.0 unx     4864 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/README.rst
--rw-r--r--  2.0 unx       21 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/__init__.py
--rw-r--r--  2.0 unx      621 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/__manifest__.py
--rw-r--r--  2.0 unx     7787 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/i18n/es_AR.po
--rw-r--r--  2.0 unx     6468 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/i18n/stock_move_source_relocate.pot
--rw-r--r--  2.0 unx       61 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/models/__init__.py
--rw-r--r--  2.0 unx     3037 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/models/stock_move.py
--rw-r--r--  2.0 unx     5538 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/models/stock_source_relocate.py
--rw-r--r--  2.0 unx      583 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx      118 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       87 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/readme/CREDITS.rst
--rw-r--r--  2.0 unx     1215 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      358 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/security/ir.model.access.csv
--rw-r--r--  2.0 unx     9455 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/static/description/icon.png
--rw-r--r--  2.0 unx    14897 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/static/description/index.html
--rw-r--r--  2.0 unx       35 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/tests/__init__.py
--rw-r--r--  2.0 unx     9340 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/tests/test_source_relocate.py
--rw-r--r--  2.0 unx     4052 b- defN 21-Sep-22 08:58 odoo/addons/stock_move_source_relocate/views/stock_source_relocate_views.xml
--rw-r--r--  2.0 unx     5475 b- defN 21-Sep-22 08:58 odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 21-Sep-22 08:58 odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 21-Sep-22 08:58 odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2585 b- defN 21-Sep-22 08:58 odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/RECORD
-22 files, 76694 bytes uncompressed, 29283 bytes compressed:  61.8%
+Zip file size: 34199 bytes, number of entries: 23
+-rw-r--r--  2.0 unx     4864 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/__init__.py
+-rw-r--r--  2.0 unx      621 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/__manifest__.py
+-rw-r--r--  2.0 unx     7787 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/i18n/es_AR.po
+-rw-r--r--  2.0 unx     6468 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/i18n/stock_move_source_relocate.pot
+-rw-r--r--  2.0 unx       61 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/models/__init__.py
+-rw-r--r--  2.0 unx     2894 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/models/stock_move.py
+-rw-r--r--  2.0 unx     5538 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/models/stock_source_relocate.py
+-rw-r--r--  2.0 unx      583 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx      118 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       87 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/readme/CREDITS.rst
+-rw-r--r--  2.0 unx     1215 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      358 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/security/ir.model.access.csv
+-rw-r--r--  2.0 unx     9455 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/static/description/icon.png
+-rw-r--r--  2.0 unx    14897 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/static/description/index.html
+-rw-r--r--  2.0 unx       35 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/tests/__init__.py
+-rw-r--r--  2.0 unx     2497 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/tests/common.py
+-rw-r--r--  2.0 unx     6943 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/tests/test_source_relocate.py
+-rw-r--r--  2.0 unx     4052 b- defN 23-Apr-25 08:52 odoo/addons/stock_move_source_relocate/views/stock_source_relocate_views.xml
+-rw-r--r--  2.0 unx     5508 b- defN 23-Apr-25 08:52 odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-25 08:52 odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Apr-25 08:52 odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2676 b- defN 23-Apr-25 08:52 odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/RECORD
+23 files, 76775 bytes uncompressed, 29559 bytes compressed:  61.5%
```

## zipnote {}

```diff
@@ -42,26 +42,29 @@
 
 Filename: odoo/addons/stock_move_source_relocate/static/description/index.html
 Comment: 
 
 Filename: odoo/addons/stock_move_source_relocate/tests/__init__.py
 Comment: 
 
+Filename: odoo/addons/stock_move_source_relocate/tests/common.py
+Comment: 
+
 Filename: odoo/addons/stock_move_source_relocate/tests/test_source_relocate.py
 Comment: 
 
 Filename: odoo/addons/stock_move_source_relocate/views/stock_source_relocate_views.xml
 Comment: 
 
-Filename: odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/METADATA
+Filename: odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/WHEEL
+Filename: odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/top_level.txt
+Filename: odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/RECORD
+Filename: odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/stock_move_source_relocate/__manifest__.py

```diff
@@ -1,13 +1,13 @@
 # Copyright 2020 Camptocamp SA
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl)
 {
     "name": "Stock Move Source Relocation",
     "summary": "Change source location of unavailable moves",
-    "version": "14.0.1.0.0",
+    "version": "14.0.1.1.0",
     "development_status": "Alpha",
     "category": "Warehouse Management",
     "website": "https://github.com/OCA/wms",
     "author": "Camptocamp, Odoo Community Association (OCA)",
     "license": "AGPL-3",
     "application": False,
     "installable": True,
```

## odoo/addons/stock_move_source_relocate/models/stock_move.py

```diff
@@ -1,12 +1,13 @@
 # Copyright 2020 Camptocamp SA
+# Copyright 2023 Michael Tietz (MT Software) <mtietz@mt-software.de>
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl)
 
 from odoo import models
-from odoo.tools.float_utils import float_is_zero
+from odoo.tools.float_utils import float_compare
 
 
 class StockMove(models.Model):
     _inherit = "stock.move"
 
     def _action_assign(self):
         unconfirmed_moves = self.filtered(
@@ -31,41 +32,34 @@
             if not relocation or relocation.relocate_location_id == move.location_id:
                 continue
             move._apply_source_relocate_rule(
                 relocation, reserved_availability, roundings
             )
 
     def _apply_source_relocate_rule(self, relocation, reserved_availability, roundings):
-        relocated = self.env["stock.move"].browse()
-
+        self.ensure_one()
         rounding = roundings[self]
-        if not reserved_availability[self]:
+        qty_reserved = reserved_availability[self]
+        if float_compare(qty_reserved, 0, precision_rounding=rounding) == 0:
             # nothing could be reserved, however, we want to source the
             # move on the specific relocation (for replenishment), so
             # update it's source location
             self.location_id = relocation.relocate_location_id
-            relocated = self
-        else:
-            missing_reserved_uom_quantity = (
-                self.product_uom_qty - reserved_availability[self]
-            )
-            need = self.product_uom._compute_quantity(
-                missing_reserved_uom_quantity,
-                self.product_id.uom_id,
-                rounding_method="HALF-UP",
-            )
+            return self
 
-            if float_is_zero(need, precision_rounding=rounding):
-                return relocated
+        missing_reserved_uom_quantity = self.product_uom_qty - qty_reserved
+        need = self.product_uom._compute_quantity(
+            missing_reserved_uom_quantity,
+            self.product_id.uom_id,
+            rounding_method="HALF-UP",
+        )
+        if float_compare(need, 0, precision_rounding=rounding) <= 0:
+            return self.env["stock.move"].browse()
 
-            # A part of the quantity could be reserved in the original
-            # location, so keep this part in the move and split the rest
-            # in a new move, where will take the goods in the relocation
-            new_move = self  # fallback if no split occurs
-            new_move_vals = self._split(need)
-            if new_move_vals:
-                new_move = self.create(new_move_vals)
-                new_move._action_confirm(merge=False)
-            new_move.location_id = relocation.relocate_location_id
-            self._action_assign()
-            relocated = new_move
-        return relocated
+        # A part of the quantity could be reserved in the original
+        # location, so keep this part in the move and split the rest
+        # in a new move, where will take the goods in the relocation
+        new_move = self.create(self._split(need))
+        new_move._action_confirm(merge=False)
+        new_move.location_id = relocation.relocate_location_id
+        self._action_assign()
+        return new_move
```

## odoo/addons/stock_move_source_relocate/tests/test_source_relocate.py

```diff
@@ -1,74 +1,12 @@
 # Copyright 2020 Camptocamp (https://www.camptocamp.com)
 
 from odoo import exceptions
-from odoo.tests import common
 
-
-class SourceRelocateCommon(common.SavepointCase):
-    @classmethod
-    def setUpClass(cls):
-        super().setUpClass()
-        cls.partner_delta = cls.env.ref("base.res_partner_4")
-        cls.wh = cls.env["stock.warehouse"].create(
-            {
-                "name": "Base Warehouse",
-                "reception_steps": "one_step",
-                "delivery_steps": "pick_ship",
-                "code": "WHTEST",
-            }
-        )
-        cls.customer_loc = cls.env.ref("stock.stock_location_customers")
-
-        cls.loc_shelf = cls.env["stock.location"].create(
-            {"name": "Shelves", "location_id": cls.wh.lot_stock_id.id}
-        )
-        cls.loc_shelf_1 = cls.env["stock.location"].create(
-            {"name": "Shelf 1", "location_id": cls.loc_shelf.id}
-        )
-        cls.loc_shelf_2 = cls.env["stock.location"].create(
-            {"name": "Shelf 2", "location_id": cls.loc_shelf.id}
-        )
-        cls.loc_replenish = cls.env["stock.location"].create(
-            {"name": "Replenish", "location_id": cls.loc_shelf.id}
-        )
-
-        cls.product = cls.env["product.product"].create(
-            {"name": "Product", "type": "product"}
-        )
-        cls.product2 = cls.env["product.product"].create(
-            {"name": "Product2", "type": "product"}
-        )
-
-    def _create_single_move(self, product, picking_type):
-        move_vals = {
-            "name": product.name,
-            "picking_type_id": picking_type.id,
-            "product_id": product.id,
-            "product_uom_qty": 10.0,
-            "product_uom": product.uom_id.id,
-            "location_id": picking_type.default_location_src_id.id,
-            "location_dest_id": picking_type.default_location_dest_id.id,
-            "state": "confirmed",
-            "procure_method": "make_to_stock",
-        }
-        return self.env["stock.move"].create(move_vals)
-
-    def _create_relocate_rule(self, location, relocation, picking_type, domain=None):
-        self.env["stock.source.relocate"].create(
-            {
-                "location_id": location.id,
-                "picking_type_id": picking_type.id,
-                "relocate_location_id": relocation.id,
-                "rule_domain": domain or "[]",
-            }
-        )
-
-    def _update_qty_in_location(self, location, product, quantity):
-        self.env["stock.quant"]._update_available_quantity(product, location, quantity)
+from .common import SourceRelocateCommon
 
 
 class TestSourceRelocate(SourceRelocateCommon):
     def test_relocate_child_of_location(self):
         # relocate location is a child, valid
         self.env["stock.source.relocate"].create(
             {
```

## Comparing `odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/METADATA` & `odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,18 +1,19 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-stock-move-source-relocate
-Version: 14.0.1.0.1.dev3
+Version: 14.0.1.1.0
 Summary: Change source location of unavailable moves
 Home-page: https://github.com/OCA/wms
 Author: Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
+Classifier: Framework :: Odoo :: 14.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
 Classifier: Development Status :: 3 - Alpha
 Requires-Python: >=3.6
 Requires-Dist: odoo14-addon-stock-helper
 Requires-Dist: odoo (<14.1dev,>=14.0a)
 
 ============================
```

## Comparing `odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/RECORD` & `odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,22 +1,23 @@
 odoo/addons/stock_move_source_relocate/README.rst,sha256=HWG024sxAI-6-SEbrmfMYDgc3Hn4vJi9lukgWjj33Bs,4864
 odoo/addons/stock_move_source_relocate/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/stock_move_source_relocate/__manifest__.py,sha256=qy6BpuUtJJGV-JyZk4S9HFaZKhQ34dlnHH1gRsEetnI,621
+odoo/addons/stock_move_source_relocate/__manifest__.py,sha256=HBEzPCVGhloTDu2YLB_G2puwynPQvq4yTsWAiCN57UA,621
 odoo/addons/stock_move_source_relocate/i18n/es_AR.po,sha256=99-6XyK-WUnXZ3_5RikuMzClUmtrfpuMT3CmT_dPXRU,7787
 odoo/addons/stock_move_source_relocate/i18n/stock_move_source_relocate.pot,sha256=tOEMp9EoiUXRTmYSf_7uhJDEpYvfTv5mJY4Jm1FkTk8,6468
 odoo/addons/stock_move_source_relocate/models/__init__.py,sha256=A8M-sQzzwNaJ1ABCzjltEonrNhn6gE77c-PvD8HS3Lo,61
-odoo/addons/stock_move_source_relocate/models/stock_move.py,sha256=ePWUI6-CEw3fK8ChKcc3OMJ7hCecmYH8m6k8FJUtpLk,3037
+odoo/addons/stock_move_source_relocate/models/stock_move.py,sha256=Sy6EHZgLoASkKNl8K36P9itF366NjIf1dN8rtLHMCOg,2894
 odoo/addons/stock_move_source_relocate/models/stock_source_relocate.py,sha256=04s6ecpcnJHPrjXUDmGyBVVuCxJJi2vOzSEvQYvBYLw,5538
 odoo/addons/stock_move_source_relocate/readme/CONFIGURE.rst,sha256=2RxmZTG7blN03AwIyGGLIqq6P6i0lBlB-1wn-KCWkbc,583
 odoo/addons/stock_move_source_relocate/readme/CONTRIBUTORS.rst,sha256=C45t42mCcww742emfXVO16tTXOHFczPdA7Mtjnb9vUg,118
 odoo/addons/stock_move_source_relocate/readme/CREDITS.rst,sha256=V5SbCUX8Ao5JnoPiawEaxzhbVdUrIZl2iS1jRL3JPFg,87
 odoo/addons/stock_move_source_relocate/readme/DESCRIPTION.rst,sha256=4CFMt09RJF9yplBO6sMstpMfJ5UgmlYUJRL0lr1zWM4,1215
 odoo/addons/stock_move_source_relocate/security/ir.model.access.csv,sha256=oVcA1pZXjF6LaTmiNHrViTQG_zTaxKFSApzRHA0Ln9U,358
 odoo/addons/stock_move_source_relocate/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/stock_move_source_relocate/static/description/index.html,sha256=JB1gs4Btiu4sc0-GzMCnILIEq6Ln5Hq3G5KILGDWhUM,14897
 odoo/addons/stock_move_source_relocate/tests/__init__.py,sha256=cp9LeAANpFnYgx832FdNCS_4JIdHszxUnV4fscJOja8,35
-odoo/addons/stock_move_source_relocate/tests/test_source_relocate.py,sha256=u4Kp8Eg7e0l42dC8nulyQeMy6lJB2VrwnI5VKb-3eUc,9340
+odoo/addons/stock_move_source_relocate/tests/common.py,sha256=fW7D9sL7a2YgeS3nmoVBnusrIpOttB2lj6DaTUmJyUQ,2497
+odoo/addons/stock_move_source_relocate/tests/test_source_relocate.py,sha256=4Lx78RXsIk6lsItn26IB2Es0bXc_DucnebWrem2sE9k,6943
 odoo/addons/stock_move_source_relocate/views/stock_source_relocate_views.xml,sha256=5-ehlw6L_xRvYjWgWKJRtees44XQ-H8R7T_Ofbsnusw,4052
-odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/METADATA,sha256=i2IsfD0x6WI1IAycohziXMU4mi-1XJJLW6geMKFb0Q4,5475
-odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_stock_move_source_relocate-14.0.1.0.1.dev3.dist-info/RECORD,,
+odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/METADATA,sha256=cnnuHwifEF2DUwmkm1mJoNJRjr7vvslyBBVtnY4CQ_c,5508
+odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_stock_move_source_relocate-14.0.1.1.0.dist-info/RECORD,,
```

